/* 2022-09-22 */
(function(e,t){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=e.document?t(e,true):function(e){if(!e.document){throw new Error("jQuery requires a window with a document")}return t(e)}}else{t(e)}})(typeof window!=="undefined"?window:this,function(E,e){"use strict";var t=[];var n=Object.getPrototypeOf;var s=t.slice;var p=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)};var l=t.push;var i=t.indexOf;var r={};var a=r.toString;var g=r.hasOwnProperty;var o=g.toString;var u=o.call(Object);var m={};var y=function e(t){return typeof t==="function"&&typeof t.nodeType!=="number"&&typeof t.item!=="function"};var b=function e(t){return t!=null&&t===t.window};var k=E.document;var f={type:true,src:true,nonce:true,noModule:true};function w(e,t,r){r=r||k;var n,i,a=r.createElement("script");a.text=e;if(t){for(n in f){i=t[n]||t.getAttribute&&t.getAttribute(n);if(i){a.setAttribute(n,i)}}}r.head.appendChild(a).parentNode.removeChild(a)}function C(e){if(e==null){return e+""}return typeof e==="object"||typeof e==="function"?r[a.call(e)]||"object":typeof e}var c="3.6.0",T=function(e,t){return new T.fn.init(e,t)};T.fn=T.prototype={jquery:c,constructor:T,length:0,toArray:function(){return s.call(this)},get:function(e){if(e==null){return s.call(this)}return e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=T.merge(this.constructor(),e);t.prevObject=this;return t},each:function(e){return T.each(this,e)},map:function(r){return this.pushStack(T.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(T.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(r>=0&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:l,sort:t.sort,splice:t.splice};T.extend=T.fn.extend=function(){var e,t,r,n,i,a,o=arguments[0]||{},s=1,l=arguments.length,u=false;if(typeof o==="boolean"){u=o;o=arguments[s]||{};s++}if(typeof o!=="object"&&!y(o)){o={}}if(s===l){o=this;s--}for(;s<l;s++){if((e=arguments[s])!=null){for(t in e){n=e[t];if(t==="__proto__"||o===n){continue}if(u&&n&&(T.isPlainObject(n)||(i=Array.isArray(n)))){r=o[t];if(i&&!Array.isArray(r)){a=[]}else if(!i&&!T.isPlainObject(r)){a={}}else{a=r}i=false;o[t]=T.extend(u,a,n)}else if(n!==undefined){o[t]=n}}}}return o};T.extend({expando:"jQuery"+(c+Math.random()).replace(/\D/g,""),isReady:true,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,r;if(!e||a.call(e)!=="[object Object]"){return false}t=n(e);if(!t){return true}r=g.call(t,"constructor")&&t.constructor;return typeof r==="function"&&o.call(r)===u},isEmptyObject:function(e){var t;for(t in e){return false}return true},globalEval:function(e,t,r){w(e,{nonce:t&&t.nonce},r)},each:function(e,t){var r,n=0;if(d(e)){r=e.length;for(;n<r;n++){if(t.call(e[n],n,e[n])===false){break}}}else{for(n in e){if(t.call(e[n],n,e[n])===false){break}}}return e},makeArray:function(e,t){var r=t||[];if(e!=null){if(d(Object(e))){T.merge(r,typeof e==="string"?[e]:e)}else{l.call(r,e)}}return r},inArray:function(e,t,r){return t==null?-1:i.call(t,e,r)},merge:function(e,t){var r=+t.length,n=0,i=e.length;for(;n<r;n++){e[i++]=t[n]}e.length=i;return e},grep:function(e,t,r){var n,i=[],a=0,o=e.length,s=!r;for(;a<o;a++){n=!t(e[a],a);if(n!==s){i.push(e[a])}}return i},map:function(e,t,r){var n,i,a=0,o=[];if(d(e)){n=e.length;for(;a<n;a++){i=t(e[a],a,r);if(i!=null){o.push(i)}}}else{for(a in e){i=t(e[a],a,r);if(i!=null){o.push(i)}}}return p(o)},guid:1,support:m});if(typeof Symbol==="function"){T.fn[Symbol.iterator]=t[Symbol.iterator]}T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){r["[object "+t+"]"]=t.toLowerCase()});function d(e){var t=!!e&&"length"in e&&e.length,r=C(e);if(y(e)||b(e)){return false}return r==="array"||t===0||typeof t==="number"&&t>0&&t-1 in e}var h=function(r){var e,h,w,a,i,v,c,p,C,l,u,S,E,o,k,g,s,f,m,T="sizzle"+1*new Date,d=r.document,_=0,n=0,y=le(),b=le(),x=le(),D=le(),R=function(e,t){if(e===t){u=true}return 0},I={}.hasOwnProperty,t=[],O=t.pop,A=t.push,N=t.push,M=t.slice,L=function(e,t){var r=0,n=e.length;for(;r<n;r++){if(e[r]===t){return r}}return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|"+"ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}"+F+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",H="\\["+F+"*("+B+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+F+"*\\]",$=":("+B+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+H+")*)|"+".*"+")\\)|)",W=new RegExp(F+"+","g"),U=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),j=new RegExp("^"+F+"*,"+F+"*"),V=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),z=new RegExp(F+"|>"),q=new RegExp($),Y=new RegExp("^"+B+"$"),G={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+$),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+F+"?|\\\\([^\\r\\n\\f])","g"),re=function(e,t){var r="0x"+e.slice(1)-65536;return t?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)},ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){if(t){if(e==="\0"){return"ï¿½"}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e},ae=function(){S()},oe=we(function(e){return e.disabled===true&&e.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{N.apply(t=M.call(d.childNodes),d.childNodes);t[d.childNodes.length].nodeType}catch(e){N={apply:t.length?function(e,t){A.apply(e,M.call(t))}:function(e,t){var r=e.length,n=0;while(e[r++]=t[n++]){}e.length=r-1}}}function se(t,e,r,n){var i,a,o,s,l,u,f,c=e&&e.ownerDocument,d=e?e.nodeType:9;r=r||[];if(typeof t!=="string"||!t||d!==1&&d!==9&&d!==11){return r}if(!n){S(e);e=e||E;if(k){if(d!==11&&(l=Z.exec(t))){if(i=l[1]){if(d===9){if(o=e.getElementById(i)){if(o.id===i){r.push(o);return r}}else{return r}}else{if(c&&(o=c.getElementById(i))&&m(e,o)&&o.id===i){r.push(o);return r}}}else if(l[2]){N.apply(r,e.getElementsByTagName(t));return r}else if((i=l[3])&&h.getElementsByClassName&&e.getElementsByClassName){N.apply(r,e.getElementsByClassName(i));return r}}if(h.qsa&&!D[t+" "]&&(!g||!g.test(t))&&(d!==1||e.nodeName.toLowerCase()!=="object")){f=t;c=e;if(d===1&&(z.test(t)||V.test(t))){c=ee.test(t)&&me(e.parentNode)||e;if(c!==e||!h.scope){if(s=e.getAttribute("id")){s=s.replace(ne,ie)}else{e.setAttribute("id",s=T)}}u=v(t);a=u.length;while(a--){u[a]=(s?"#"+s:":scope")+" "+be(u[a])}f=u.join(",")}try{N.apply(r,c.querySelectorAll(f));return r}catch(e){D(t,true)}finally{if(s===T){e.removeAttribute("id")}}}}}return p(t.replace(U,"$1"),e,r,n)}function le(){var r=[];function n(e,t){if(r.push(e+" ")>w.cacheLength){delete n[r.shift()]}return n[e+" "]=t}return n}function ue(e){e[T]=true;return e}function fe(e){var t=E.createElement("fieldset");try{return!!e(t)}catch(e){return false}finally{if(t.parentNode){t.parentNode.removeChild(t)}t=null}}function ce(e,t){var r=e.split("|"),n=r.length;while(n--){w.attrHandle[r[n]]=t}}function de(e,t){var r=t&&e,n=r&&e.nodeType===1&&t.nodeType===1&&e.sourceIndex-t.sourceIndex;if(n){return n}if(r){while(r=r.nextSibling){if(r===t){return-1}}}return e?1:-1}function he(r){return function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type===r}}function ve(r){return function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&e.type===r}}function pe(t){return function(e){if("form"in e){if(e.parentNode&&e.disabled===false){if("label"in e){if("label"in e.parentNode){return e.parentNode.disabled===t}else{return e.disabled===t}}return e.isDisabled===t||e.isDisabled!==!t&&oe(e)===t}return e.disabled===t}else if("label"in e){return e.disabled===t}return false}}function ge(o){return ue(function(a){a=+a;return ue(function(e,t){var r,n=o([],e.length,a),i=n.length;while(i--){if(e[r=n[i]]){e[r]=!(t[r]=e[r])}}})})}function me(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}h=se.support={};i=se.isXML=function(e){var t=e&&e.namespaceURI,r=e&&(e.ownerDocument||e).documentElement;return!X.test(t||r&&r.nodeName||"HTML")};S=se.setDocument=function(e){var t,r,n=e?e.ownerDocument||e:d;if(n==E||n.nodeType!==9||!n.documentElement){return E}E=n;o=E.documentElement;k=!i(E);if(d!=E&&(r=E.defaultView)&&r.top!==r){if(r.addEventListener){r.addEventListener("unload",ae,false)}else if(r.attachEvent){r.attachEvent("onunload",ae)}}h.scope=fe(function(e){o.appendChild(e).appendChild(E.createElement("div"));return typeof e.querySelectorAll!=="undefined"&&!e.querySelectorAll(":scope fieldset div").length});h.attributes=fe(function(e){e.className="i";return!e.getAttribute("className")});h.getElementsByTagName=fe(function(e){e.appendChild(E.createComment(""));return!e.getElementsByTagName("*").length});h.getElementsByClassName=Q.test(E.getElementsByClassName);h.getById=fe(function(e){o.appendChild(e).id=T;return!E.getElementsByName||!E.getElementsByName(T).length});if(h.getById){w.filter["ID"]=function(e){var t=e.replace(te,re);return function(e){return e.getAttribute("id")===t}};w.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&k){var r=t.getElementById(e);return r?[r]:[]}}}else{w.filter["ID"]=function(e){var r=e.replace(te,re);return function(e){var t=typeof e.getAttributeNode!=="undefined"&&e.getAttributeNode("id");return t&&t.value===r}};w.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&k){var r,n,i,a=t.getElementById(e);if(a){r=a.getAttributeNode("id");if(r&&r.value===e){return[a]}i=t.getElementsByName(e);n=0;while(a=i[n++]){r=a.getAttributeNode("id");if(r&&r.value===e){return[a]}}}return[]}}}w.find["TAG"]=h.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=="undefined"){return t.getElementsByTagName(e)}else if(h.qsa){return t.querySelectorAll(e)}}:function(e,t){var r,n=[],i=0,a=t.getElementsByTagName(e);if(e==="*"){while(r=a[i++]){if(r.nodeType===1){n.push(r)}}return n}return a};w.find["CLASS"]=h.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!=="undefined"&&k){return t.getElementsByClassName(e)}};s=[];g=[];if(h.qsa=Q.test(E.querySelectorAll)){fe(function(e){var t;o.appendChild(e).innerHTML="<a id='"+T+"'></a>"+"<select id='"+T+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(e.querySelectorAll("[msallowcapture^='']").length){g.push("[*^$]="+F+"*(?:''|\"\")")}if(!e.querySelectorAll("[selected]").length){g.push("\\["+F+"*(?:value|"+P+")")}if(!e.querySelectorAll("[id~="+T+"-]").length){g.push("~=")}t=E.createElement("input");t.setAttribute("name","");e.appendChild(t);if(!e.querySelectorAll("[name='']").length){g.push("\\["+F+"*name"+F+"*="+F+"*(?:''|\"\")")}if(!e.querySelectorAll(":checked").length){g.push(":checked")}if(!e.querySelectorAll("a#"+T+"+*").length){g.push(".#.+[+~]")}e.querySelectorAll("\\\f");g.push("[\\r\\n\\f]")});fe(function(e){e.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var t=E.createElement("input");t.setAttribute("type","hidden");e.appendChild(t).setAttribute("name","D");if(e.querySelectorAll("[name=d]").length){g.push("name"+F+"*[*^$|!~]?=")}if(e.querySelectorAll(":enabled").length!==2){g.push(":enabled",":disabled")}o.appendChild(e).disabled=true;if(e.querySelectorAll(":disabled").length!==2){g.push(":enabled",":disabled")}e.querySelectorAll("*,:x");g.push(",.*:")})}if(h.matchesSelector=Q.test(f=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector)){fe(function(e){h.disconnectedMatch=f.call(e,"*");f.call(e,"[s!='']:x");s.push("!=",$)})}g=g.length&&new RegExp(g.join("|"));s=s.length&&new RegExp(s.join("|"));t=Q.test(o.compareDocumentPosition);m=t||Q.test(o.contains)?function(e,t){var r=e.nodeType===9?e.documentElement:e,n=t&&t.parentNode;return e===n||!!(n&&n.nodeType===1&&(r.contains?r.contains(n):e.compareDocumentPosition&&e.compareDocumentPosition(n)&16))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return true}}}return false};R=t?function(e,t){if(e===t){u=true;return 0}var r=!e.compareDocumentPosition-!t.compareDocumentPosition;if(r){return r}r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1;if(r&1||!h.sortDetached&&t.compareDocumentPosition(e)===r){if(e==E||e.ownerDocument==d&&m(d,e)){return-1}if(t==E||t.ownerDocument==d&&m(d,t)){return 1}return l?L(l,e)-L(l,t):0}return r&4?-1:1}:function(e,t){if(e===t){u=true;return 0}var r,n=0,i=e.parentNode,a=t.parentNode,o=[e],s=[t];if(!i||!a){return e==E?-1:t==E?1:i?-1:a?1:l?L(l,e)-L(l,t):0}else if(i===a){return de(e,t)}r=e;while(r=r.parentNode){o.unshift(r)}r=t;while(r=r.parentNode){s.unshift(r)}while(o[n]===s[n]){n++}return n?de(o[n],s[n]):o[n]==d?-1:s[n]==d?1:0};return E};se.matches=function(e,t){return se(e,null,null,t)};se.matchesSelector=function(e,t){S(e);if(h.matchesSelector&&k&&!D[t+" "]&&(!s||!s.test(t))&&(!g||!g.test(t))){try{var r=f.call(e,t);if(r||h.disconnectedMatch||e.document&&e.document.nodeType!==11){return r}}catch(e){D(t,true)}}return se(t,E,null,[e]).length>0};se.contains=function(e,t){if((e.ownerDocument||e)!=E){S(e)}return m(e,t)};se.attr=function(e,t){if((e.ownerDocument||e)!=E){S(e)}var r=w.attrHandle[t.toLowerCase()],n=r&&I.call(w.attrHandle,t.toLowerCase())?r(e,t,!k):undefined;return n!==undefined?n:h.attributes||!k?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null};se.escape=function(e){return(e+"").replace(ne,ie)};se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};se.uniqueSort=function(e){var t,r=[],n=0,i=0;u=!h.detectDuplicates;l=!h.sortStable&&e.slice(0);e.sort(R);if(u){while(t=e[i++]){if(t===e[i]){n=r.push(i)}}while(n--){e.splice(r[n],1)}}l=null;return e};a=se.getText=function(e){var t,r="",n=0,i=e.nodeType;if(!i){while(t=e[n++]){r+=a(t)}}else if(i===1||i===9||i===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){r+=a(e)}}}else if(i===3||i===4){return e.nodeValue}return r};w=se.selectors={cacheLength:50,createPseudo:ue,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(te,re);e[3]=(e[3]||e[4]||e[5]||"").replace(te,re);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){se.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){se.error(e[0])}return e},PSEUDO:function(e){var t,r=!e[6]&&e[2];if(G["CHILD"].test(e[0])){return null}if(e[3]){e[2]=e[4]||e[5]||""}else if(r&&q.test(r)&&(t=v(r,true))&&(t=r.indexOf(")",r.length-t)-r.length)){e[0]=e[0].slice(0,t);e[2]=r.slice(0,t)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(te,re).toLowerCase();return e==="*"?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=y[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&y(e,function(e){return t.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!=="undefined"&&e.getAttribute("class")||"")})},ATTR:function(r,n,i){return function(e){var t=se.attr(e,r);if(t==null){return n==="!="}if(!n){return true}t+="";return n==="="?t===i:n==="!="?t!==i:n==="^="?i&&t.indexOf(i)===0:n==="*="?i&&t.indexOf(i)>-1:n==="$="?i&&t.slice(-i.length)===i:n==="~="?(" "+t.replace(W," ")+" ").indexOf(i)>-1:n==="|="?t===i||t.slice(0,i.length+1)===i+"-":false}},CHILD:function(v,e,t,p,g){var m=v.slice(0,3)!=="nth",y=v.slice(-4)!=="last",b=e==="of-type";return p===1&&g===0?function(e){return!!e.parentNode}:function(e,t,r){var n,i,a,o,s,l,u=m!==y?"nextSibling":"previousSibling",f=e.parentNode,c=b&&e.nodeName.toLowerCase(),d=!r&&!b,h=false;if(f){if(m){while(u){o=e;while(o=o[u]){if(b?o.nodeName.toLowerCase()===c:o.nodeType===1){return false}}l=u=v==="only"&&!l&&"nextSibling"}return true}l=[y?f.firstChild:f.lastChild];if(y&&d){o=f;a=o[T]||(o[T]={});i=a[o.uniqueID]||(a[o.uniqueID]={});n=i[v]||[];s=n[0]===_&&n[1];h=s&&n[2];o=s&&f.childNodes[s];while(o=++s&&o&&o[u]||(h=s=0)||l.pop()){if(o.nodeType===1&&++h&&o===e){i[v]=[_,s,h];break}}}else{if(d){o=e;a=o[T]||(o[T]={});i=a[o.uniqueID]||(a[o.uniqueID]={});n=i[v]||[];s=n[0]===_&&n[1];h=s}if(h===false){while(o=++s&&o&&o[u]||(h=s=0)||l.pop()){if((b?o.nodeName.toLowerCase()===c:o.nodeType===1)&&++h){if(d){a=o[T]||(o[T]={});i=a[o.uniqueID]||(a[o.uniqueID]={});i[v]=[_,h]}if(o===e){break}}}}}h-=g;return h===p||h%p===0&&h/p>=0}}},PSEUDO:function(e,a){var t,o=w.pseudos[e]||w.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);if(o[T]){return o(a)}if(o.length>1){t=[e,e,"",a];return w.setFilters.hasOwnProperty(e.toLowerCase())?ue(function(e,t){var r,n=o(e,a),i=n.length;while(i--){r=L(e,n[i]);e[r]=!(t[r]=n[i])}}):function(e){return o(e,0,t)}}return o}},pseudos:{not:ue(function(e){var n=[],i=[],s=c(e.replace(U,"$1"));return s[T]?ue(function(e,t,r,n){var i,a=s(e,null,n,[]),o=e.length;while(o--){if(i=a[o]){e[o]=!(t[o]=i)}}}):function(e,t,r){n[0]=e;s(n,null,r,i);n[0]=null;return!i.pop()}}),has:ue(function(t){return function(e){return se(t,e).length>0}}),contains:ue(function(t){t=t.replace(te,re);return function(e){return(e.textContent||a(e)).indexOf(t)>-1}}),lang:ue(function(r){if(!Y.test(r||"")){se.error("unsupported lang: "+r)}r=r.replace(te,re).toLowerCase();return function(e){var t;do{if(t=k?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang")){t=t.toLowerCase();return t===r||t.indexOf(r+"-")===0}}while((e=e.parentNode)&&e.nodeType===1);return false}}),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===o},focus:function(e){return e===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:pe(false),disabled:pe(true),checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeType<6){return false}}return true},parent:function(e){return!w.pseudos["empty"](e)},header:function(e){return J.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:ge(function(){return[0]}),last:ge(function(e,t){return[t-1]}),eq:ge(function(e,t,r){return[r<0?r+t:r]}),even:ge(function(e,t){var r=0;for(;r<t;r+=2){e.push(r)}return e}),odd:ge(function(e,t){var r=1;for(;r<t;r+=2){e.push(r)}return e}),lt:ge(function(e,t,r){var n=r<0?r+t:r>t?t:r;for(;--n>=0;){e.push(n)}return e}),gt:ge(function(e,t,r){var n=r<0?r+t:r;for(;++n<t;){e.push(n)}return e})}};w.pseudos["nth"]=w.pseudos["eq"];for(e in{radio:true,checkbox:true,file:true,password:true,image:true}){w.pseudos[e]=he(e)}for(e in{submit:true,reset:true}){w.pseudos[e]=ve(e)}function ye(){}ye.prototype=w.filters=w.pseudos;w.setFilters=new ye;v=se.tokenize=function(e,t){var r,n,i,a,o,s,l,u=b[e+" "];if(u){return t?0:u.slice(0)}o=e;s=[];l=w.preFilter;while(o){if(!r||(n=j.exec(o))){if(n){o=o.slice(n[0].length)||o}s.push(i=[])}r=false;if(n=V.exec(o)){r=n.shift();i.push({value:r,type:n[0].replace(U," ")});o=o.slice(r.length)}for(a in w.filter){if((n=G[a].exec(o))&&(!l[a]||(n=l[a](n)))){r=n.shift();i.push({value:r,type:a,matches:n});o=o.slice(r.length)}}if(!r){break}}return t?o.length:o?se.error(e):b(e,s).slice(0)};function be(e){var t=0,r=e.length,n="";for(;t<r;t++){n+=e[t].value}return n}function we(s,e,t){var l=e.dir,u=e.next,f=u||l,c=t&&f==="parentNode",d=n++;return e.first?function(e,t,r){while(e=e[l]){if(e.nodeType===1||c){return s(e,t,r)}}return false}:function(e,t,r){var n,i,a,o=[_,d];if(r){while(e=e[l]){if(e.nodeType===1||c){if(s(e,t,r)){return true}}}}else{while(e=e[l]){if(e.nodeType===1||c){a=e[T]||(e[T]={});i=a[e.uniqueID]||(a[e.uniqueID]={});if(u&&u===e.nodeName.toLowerCase()){e=e[l]||e}else if((n=i[f])&&n[0]===_&&n[1]===d){return o[2]=n[2]}else{i[f]=o;if(o[2]=s(e,t,r)){return true}}}}}return false}}function Ce(i){return i.length>1?function(e,t,r){var n=i.length;while(n--){if(!i[n](e,t,r)){return false}}return true}:i[0]}function Se(e,t,r){var n=0,i=t.length;for(;n<i;n++){se(e,t[n],r)}return r}function Ee(e,t,r,n,i){var a,o=[],s=0,l=e.length,u=t!=null;for(;s<l;s++){if(a=e[s]){if(!r||r(a,n,i)){o.push(a);if(u){t.push(s)}}}}return o}function ke(h,v,p,g,m,e){if(g&&!g[T]){g=ke(g)}if(m&&!m[T]){m=ke(m,e)}return ue(function(e,t,r,n){var i,a,o,s=[],l=[],u=t.length,f=e||Se(v||"*",r.nodeType?[r]:r,[]),c=h&&(e||!v)?Ee(f,s,h,r,n):f,d=p?m||(e?h:u||g)?[]:t:c;if(p){p(c,d,r,n)}if(g){i=Ee(d,l);g(i,[],r,n);a=i.length;while(a--){if(o=i[a]){d[l[a]]=!(c[l[a]]=o)}}}if(e){if(m||h){if(m){i=[];a=d.length;while(a--){if(o=d[a]){i.push(c[a]=o)}}m(null,d=[],i,n)}a=d.length;while(a--){if((o=d[a])&&(i=m?L(e,o):s[a])>-1){e[i]=!(t[i]=o)}}}}else{d=Ee(d===t?d.splice(u,d.length):d);if(m){m(null,t,d,n)}else{N.apply(t,d)}}})}function Te(e){var i,t,r,n=e.length,a=w.relative[e[0].type],o=a||w.relative[" "],s=a?1:0,l=we(function(e){return e===i},o,true),u=we(function(e){return L(i,e)>-1},o,true),f=[function(e,t,r){var n=!a&&(r||t!==C)||((i=t).nodeType?l(e,t,r):u(e,t,r));i=null;return n}];for(;s<n;s++){if(t=w.relative[e[s].type]){f=[we(Ce(f),t)]}else{t=w.filter[e[s].type].apply(null,e[s].matches);if(t[T]){r=++s;for(;r<n;r++){if(w.relative[e[r].type]){break}}return ke(s>1&&Ce(f),s>1&&be(e.slice(0,s-1).concat({value:e[s-2].type===" "?"*":""})).replace(U,"$1"),t,s<r&&Te(e.slice(s,r)),r<n&&Te(e=e.slice(r)),r<n&&be(e))}f.push(t)}}return Ce(f)}function _e(g,m){var y=m.length>0,b=g.length>0,e=function(e,t,r,n,i){var a,o,s,l=0,u="0",f=e&&[],c=[],d=C,h=e||b&&w.find["TAG"]("*",i),v=_+=d==null?1:Math.random()||.1,p=h.length;if(i){C=t==E||t||i}for(;u!==p&&(a=h[u])!=null;u++){if(b&&a){o=0;if(!t&&a.ownerDocument!=E){S(a);r=!k}while(s=g[o++]){if(s(a,t||E,r)){n.push(a);break}}if(i){_=v}}if(y){if(a=!s&&a){l--}if(e){f.push(a)}}}l+=u;if(y&&u!==l){o=0;while(s=m[o++]){s(f,c,t,r)}if(e){if(l>0){while(u--){if(!(f[u]||c[u])){c[u]=O.call(n)}}}c=Ee(c)}N.apply(n,c);if(i&&!e&&c.length>0&&l+m.length>1){se.uniqueSort(n)}}if(i){_=v;C=d}return f};return y?ue(e):e}c=se.compile=function(e,t){var r,n=[],i=[],a=x[e+" "];if(!a){if(!t){t=v(e)}r=t.length;while(r--){a=Te(t[r]);if(a[T]){n.push(a)}else{i.push(a)}}a=x(e,_e(i,n));a.selector=e}return a};p=se.select=function(e,t,r,n){var i,a,o,s,l,u=typeof e==="function"&&e,f=!n&&v(e=u.selector||e);r=r||[];if(f.length===1){a=f[0]=f[0].slice(0);if(a.length>2&&(o=a[0]).type==="ID"&&t.nodeType===9&&k&&w.relative[a[1].type]){t=(w.find["ID"](o.matches[0].replace(te,re),t)||[])[0];if(!t){return r}else if(u){t=t.parentNode}e=e.slice(a.shift().value.length)}i=G["needsContext"].test(e)?0:a.length;while(i--){o=a[i];if(w.relative[s=o.type]){break}if(l=w.find[s]){if(n=l(o.matches[0].replace(te,re),ee.test(a[0].type)&&me(t.parentNode)||t)){a.splice(i,1);e=n.length&&be(a);if(!e){N.apply(r,n);return r}break}}}}(u||c(e,f))(n,t,!k,r,!t||ee.test(e)&&me(t.parentNode)||t);return r};h.sortStable=T.split("").sort(R).join("")===T;h.detectDuplicates=!!u;S();h.sortDetached=fe(function(e){return e.compareDocumentPosition(E.createElement("fieldset"))&1});if(!fe(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){ce("type|href|height|width",function(e,t,r){if(!r){return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}})}if(!h.attributes||!fe(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){ce("value",function(e,t,r){if(!r&&e.nodeName.toLowerCase()==="input"){return e.defaultValue}})}if(!fe(function(e){return e.getAttribute("disabled")==null})){ce(P,function(e,t,r){var n;if(!r){return e[t]===true?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}})}return se}(E);T.find=h;T.expr=h.selectors;T.expr[":"]=T.expr.pseudos;T.uniqueSort=T.unique=h.uniqueSort;T.text=h.getText;T.isXMLDoc=h.isXML;T.contains=h.contains;T.escapeSelector=h.escape;var v=function(e,t,r){var n=[],i=r!==undefined;while((e=e[t])&&e.nodeType!==9){if(e.nodeType===1){if(i&&T(e).is(r)){break}n.push(e)}}return n};var S=function(e,t){var r=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==t){r.push(e)}}return r};var _=T.expr.match.needsContext;function x(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var D=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function R(e,r,n){if(y(r)){return T.grep(e,function(e,t){return!!r.call(e,t,e)!==n})}if(r.nodeType){return T.grep(e,function(e){return e===r!==n})}if(typeof r!=="string"){return T.grep(e,function(e){return i.call(r,e)>-1!==n})}return T.filter(r,e,n)}T.filter=function(e,t,r){var n=t[0];if(r){e=":not("+e+")"}if(t.length===1&&n.nodeType===1){return T.find.matchesSelector(n,e)?[n]:[]}return T.find.matches(e,T.grep(t,function(e){return e.nodeType===1}))};T.fn.extend({find:function(e){var t,r,n=this.length,i=this;if(typeof e!=="string"){return this.pushStack(T(e).filter(function(){for(t=0;t<n;t++){if(T.contains(i[t],this)){return true}}}))}r=this.pushStack([]);for(t=0;t<n;t++){T.find(e,i[t],r)}return n>1?T.uniqueSort(r):r},filter:function(e){return this.pushStack(R(this,e||[],false))},not:function(e){return this.pushStack(R(this,e||[],true))},is:function(e){return!!R(this,typeof e==="string"&&_.test(e)?T(e):e||[],false).length}});var I,O=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,A=T.fn.init=function(e,t,r){var n,i;if(!e){return this}r=r||I;if(typeof e==="string"){if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3){n=[null,e,null]}else{n=O.exec(e)}if(n&&(n[1]||!t)){if(n[1]){t=t instanceof T?t[0]:t;T.merge(this,T.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:k,true));if(D.test(n[1])&&T.isPlainObject(t)){for(n in t){if(y(this[n])){this[n](t[n])}else{this.attr(n,t[n])}}}return this}else{i=k.getElementById(n[2]);if(i){this[0]=i;this.length=1}return this}}else if(!t||t.jquery){return(t||r).find(e)}else{return this.constructor(t).find(e)}}else if(e.nodeType){this[0]=e;this.length=1;return this}else if(y(e)){return r.ready!==undefined?r.ready(e):e(T)}return T.makeArray(e,this)};A.prototype=T.fn;I=T(k);var N=/^(?:parents|prev(?:Until|All))/,M={children:true,contents:true,next:true,prev:true};T.fn.extend({has:function(e){var t=T(e,this),r=t.length;return this.filter(function(){var e=0;for(;e<r;e++){if(T.contains(this,t[e])){return true}}})},closest:function(e,t){var r,n=0,i=this.length,a=[],o=typeof e!=="string"&&T(e);if(!_.test(e)){for(;n<i;n++){for(r=this[n];r&&r!==t;r=r.parentNode){if(r.nodeType<11&&(o?o.index(r)>-1:r.nodeType===1&&T.find.matchesSelector(r,e))){a.push(r);break}}}}return this.pushStack(a.length>1?T.uniqueSort(a):a)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return i.call(T(e),this[0])}return i.call(this,e.jquery?e[0]:e)},add:function(e,t){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function L(e,t){while((e=e[t])&&e.nodeType!==1){}return e}T.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v(e,"parentNode")},parentsUntil:function(e,t,r){return v(e,"parentNode",r)},next:function(e){return L(e,"nextSibling")},prev:function(e){return L(e,"previousSibling")},nextAll:function(e){return v(e,"nextSibling")},prevAll:function(e){return v(e,"previousSibling")},nextUntil:function(e,t,r){return v(e,"nextSibling",r)},prevUntil:function(e,t,r){return v(e,"previousSibling",r)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){if(e.contentDocument!=null&&n(e.contentDocument)){return e.contentDocument}if(x(e,"template")){e=e.content||e}return T.merge([],e.childNodes)}},function(n,i){T.fn[n]=function(e,t){var r=T.map(this,i,e);if(n.slice(-5)!=="Until"){t=e}if(t&&typeof t==="string"){r=T.filter(t,r)}if(this.length>1){if(!M[n]){T.uniqueSort(r)}if(N.test(n)){r.reverse()}}return this.pushStack(r)}});var P=/[^\x20\t\r\n\f]+/g;function F(e){var r={};T.each(e.match(P)||[],function(e,t){r[t]=true});return r}T.Callbacks=function(n){n=typeof n==="string"?F(n):T.extend({},n);var r,e,t,i,a=[],o=[],s=-1,l=function(){i=i||n.once;t=r=true;for(;o.length;s=-1){e=o.shift();while(++s<a.length){if(a[s].apply(e[0],e[1])===false&&n.stopOnFalse){s=a.length;e=false}}}if(!n.memory){e=false}r=false;if(i){if(e){a=[]}else{a=""}}},u={add:function(){if(a){if(e&&!r){s=a.length-1;o.push(e)}(function r(e){T.each(e,function(e,t){if(y(t)){if(!n.unique||!u.has(t)){a.push(t)}}else if(t&&t.length&&C(t)!=="string"){r(t)}})})(arguments);if(e&&!r){l()}}return this},remove:function(){T.each(arguments,function(e,t){var r;while((r=T.inArray(t,a,r))>-1){a.splice(r,1);if(r<=s){s--}}});return this},has:function(e){return e?T.inArray(e,a)>-1:a.length>0},empty:function(){if(a){a=[]}return this},disable:function(){i=o=[];a=e="";return this},disabled:function(){return!a},lock:function(){i=o=[];if(!e&&!r){a=e=""}return this},locked:function(){return!!i},fireWith:function(e,t){if(!i){t=t||[];t=[e,t.slice?t.slice():t];o.push(t);if(!r){l()}}return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!t}};return u};function B(e){return e}function H(e){throw e}function $(e,t,r,n){var i;try{if(e&&y(i=e.promise)){i.call(e).done(t).fail(r)}else if(e&&y(i=e.then)){i.call(e,t,r)}else{t.apply(undefined,[e].slice(n))}}catch(e){r.apply(undefined,[e])}}T.extend({Deferred:function(e){var a=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],i="pending",o={state:function(){return i},always:function(){s.done(arguments).fail(arguments);return this},catch:function(e){return o.then(null,e)},pipe:function(){var i=arguments;return T.Deferred(function(n){T.each(a,function(e,t){var r=y(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=r&&r.apply(this,arguments);if(e&&y(e.promise)){e.promise().progress(n.notify).done(n.resolve).fail(n.reject)}else{n[t[0]+"With"](this,r?[e]:arguments)}})});i=null}).promise()},then:function(t,r,n){var l=0;function u(i,a,o,s){return function(){var r=this,n=arguments,e=function(){var e,t;if(i<l){return}e=o.apply(r,n);if(e===a.promise()){throw new TypeError("Thenable self-resolution")}t=e&&(typeof e==="object"||typeof e==="function")&&e.then;if(y(t)){if(s){t.call(e,u(l,a,B,s),u(l,a,H,s))}else{l++;t.call(e,u(l,a,B,s),u(l,a,H,s),u(l,a,B,a.notifyWith))}}else{if(o!==B){r=undefined;n=[e]}(s||a.resolveWith)(r,n)}},t=s?e:function(){try{e()}catch(e){if(T.Deferred.exceptionHook){T.Deferred.exceptionHook(e,t.stackTrace)}if(i+1>=l){if(o!==H){r=undefined;n=[e]}a.rejectWith(r,n)}}};if(i){t()}else{if(T.Deferred.getStackHook){t.stackTrace=T.Deferred.getStackHook()}E.setTimeout(t)}}}return T.Deferred(function(e){a[0][3].add(u(0,e,y(n)?n:B,e.notifyWith));a[1][3].add(u(0,e,y(t)?t:B));a[2][3].add(u(0,e,y(r)?r:H))}).promise()},promise:function(e){return e!=null?T.extend(e,o):o}},s={};T.each(a,function(e,t){var r=t[2],n=t[5];o[t[1]]=r.add;if(n){r.add(function(){i=n},a[3-e][2].disable,a[3-e][3].disable,a[0][2].lock,a[0][3].lock)}r.add(t[3].fire);s[t[0]]=function(){s[t[0]+"With"](this===s?undefined:this,arguments);return this};s[t[0]+"With"]=r.fireWith});o.promise(s);if(e){e.call(s,s)}return s},when:function(e){var r=arguments.length,t=r,n=Array(t),i=s.call(arguments),a=T.Deferred(),o=function(t){return function(e){n[t]=this;i[t]=arguments.length>1?s.call(arguments):e;if(!--r){a.resolveWith(n,i)}}};if(r<=1){$(e,a.done(o(t)).resolve,a.reject,!r);if(a.state()==="pending"||y(i[t]&&i[t].then)){return a.then()}}while(t--){$(i[t],o(t),a.reject)}return a.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHook=function(e,t){if(E.console&&E.console.warn&&e&&W.test(e.name)){E.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)}};T.readyException=function(e){E.setTimeout(function(){throw e})};var U=T.Deferred();T.fn.ready=function(e){U.then(e).catch(function(e){T.readyException(e)});return this};T.extend({isReady:false,readyWait:1,ready:function(e){if(e===true?--T.readyWait:T.isReady){return}T.isReady=true;if(e!==true&&--T.readyWait>0){return}U.resolveWith(k,[T])}});T.ready.then=U.then;function j(){k.removeEventListener("DOMContentLoaded",j);E.removeEventListener("load",j);T.ready()}if(k.readyState==="complete"||k.readyState!=="loading"&&!k.documentElement.doScroll){E.setTimeout(T.ready)}else{k.addEventListener("DOMContentLoaded",j);E.addEventListener("load",j)}var V=function(e,t,r,n,i,a,o){var s=0,l=e.length,u=r==null;if(C(r)==="object"){i=true;for(s in r){V(e,t,s,r[s],true,a,o)}}else if(n!==undefined){i=true;if(!y(n)){o=true}if(u){if(o){t.call(e,n);t=null}else{u=t;t=function(e,t,r){return u.call(T(e),r)}}}if(t){for(;s<l;s++){t(e[s],r,o?n:n.call(e[s],s,t(e[s],r)))}}}if(i){return e}if(u){return t.call(e)}return l?t(e[0],r):a};var z=/^-ms-/,q=/-([a-z])/g;function Y(e,t){return t.toUpperCase()}function G(e){return e.replace(z,"ms-").replace(q,Y)}var X=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function K(){this.expando=T.expando+K.uid++}K.uid=1;K.prototype={cache:function(e){var t=e[this.expando];if(!t){t={};if(X(e)){if(e.nodeType){e[this.expando]=t}else{Object.defineProperty(e,this.expando,{value:t,configurable:true})}}}return t},set:function(e,t,r){var n,i=this.cache(e);if(typeof t==="string"){i[G(t)]=r}else{for(n in t){i[G(n)]=t[n]}}return i},get:function(e,t){return t===undefined?this.cache(e):e[this.expando]&&e[this.expando][G(t)]},access:function(e,t,r){if(t===undefined||t&&typeof t==="string"&&r===undefined){return this.get(e,t)}this.set(e,t,r);return r!==undefined?r:t},remove:function(e,t){var r,n=e[this.expando];if(n===undefined){return}if(t!==undefined){if(Array.isArray(t)){t=t.map(G)}else{t=G(t);t=t in n?[t]:t.match(P)||[]}r=t.length;while(r--){delete n[t[r]]}}if(t===undefined||T.isEmptyObject(n)){if(e.nodeType){e[this.expando]=undefined}else{delete e[this.expando]}}},hasData:function(e){var t=e[this.expando];return t!==undefined&&!T.isEmptyObject(t)}};var J=new K;var Q=new K;var Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ee=/[A-Z]/g;function te(e){if(e==="true"){return true}if(e==="false"){return false}if(e==="null"){return null}if(e===+e+""){return+e}if(Z.test(e)){return JSON.parse(e)}return e}function re(e,t,r){var n;if(r===undefined&&e.nodeType===1){n="data-"+t.replace(ee,"-$&").toLowerCase();r=e.getAttribute(n);if(typeof r==="string"){try{r=te(r)}catch(e){}Q.set(e,t,r)}else{r=undefined}}return r}T.extend({hasData:function(e){return Q.hasData(e)||J.hasData(e)},data:function(e,t,r){return Q.access(e,t,r)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,r){return J.access(e,t,r)},_removeData:function(e,t){J.remove(e,t)}});T.fn.extend({data:function(r,e){var t,n,i,a=this[0],o=a&&a.attributes;if(r===undefined){if(this.length){i=Q.get(a);if(a.nodeType===1&&!J.get(a,"hasDataAttrs")){t=o.length;while(t--){if(o[t]){n=o[t].name;if(n.indexOf("data-")===0){n=G(n.slice(5));re(a,n,i[n])}}}J.set(a,"hasDataAttrs",true)}}return i}if(typeof r==="object"){return this.each(function(){Q.set(this,r)})}return V(this,function(e){var t;if(a&&e===undefined){t=Q.get(a,r);if(t!==undefined){return t}t=re(a,r);if(t!==undefined){return t}return}this.each(function(){Q.set(this,r,e)})},null,e,arguments.length>1,null,true)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}});T.extend({queue:function(e,t,r){var n;if(e){t=(t||"fx")+"queue";n=J.get(e,t);if(r){if(!n||Array.isArray(r)){n=J.access(e,t,T.makeArray(r))}else{n.push(r)}}return n||[]}},dequeue:function(e,t){t=t||"fx";var r=T.queue(e,t),n=r.length,i=r.shift(),a=T._queueHooks(e,t),o=function(){T.dequeue(e,t)};if(i==="inprogress"){i=r.shift();n--}if(i){if(t==="fx"){r.unshift("inprogress")}delete a.stop;i.call(e,o,a)}if(!n&&a){a.empty.fire()}},_queueHooks:function(e,t){var r=t+"queueHooks";return J.get(e,r)||J.access(e,r,{empty:T.Callbacks("once memory").add(function(){J.remove(e,[t+"queue",r])})})}});T.fn.extend({queue:function(t,r){var e=2;if(typeof t!=="string"){r=t;t="fx";e--}if(arguments.length<e){return T.queue(this[0],t)}return r===undefined?this:this.each(function(){var e=T.queue(this,t,r);T._queueHooks(this,t);if(t==="fx"&&e[0]!=="inprogress"){T.dequeue(this,t)}})},dequeue:function(e){return this.each(function(){T.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,n=1,i=T.Deferred(),a=this,o=this.length,s=function(){if(!--n){i.resolveWith(a,[a])}};if(typeof e!=="string"){t=e;e=undefined}e=e||"fx";while(o--){r=J.get(a[o],e+"queueHooks");if(r&&r.empty){n++;r.empty.add(s)}}s();return i.promise(t)}});var ne=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var ie=new RegExp("^(?:([+-])=|)("+ne+")([a-z%]*)$","i");var ae=["Top","Right","Bottom","Left"];var oe=k.documentElement;var se=function(e){return T.contains(e.ownerDocument,e)},le={composed:true};if(oe.getRootNode){se=function(e){return T.contains(e.ownerDocument,e)||e.getRootNode(le)===e.ownerDocument}}var ue=function(e,t){e=t||e;return e.style.display==="none"||e.style.display===""&&se(e)&&T.css(e,"display")==="none"};function fe(e,t,r,n){var i,a,o=20,s=n?function(){return n.cur()}:function(){return T.css(e,t,"")},l=s(),u=r&&r[3]||(T.cssNumber[t]?"":"px"),f=e.nodeType&&(T.cssNumber[t]||u!=="px"&&+l)&&ie.exec(T.css(e,t));if(f&&f[3]!==u){l=l/2;u=u||f[3];f=+l||1;while(o--){T.style(e,t,f+u);if((1-a)*(1-(a=s()/l||.5))<=0){o=0}f=f/a}f=f*2;T.style(e,t,f+u);r=r||[]}if(r){f=+f||+l||0;i=r[1]?f+(r[1]+1)*r[2]:+r[2];if(n){n.unit=u;n.start=f;n.end=i}}return i}var ce={};function de(e){var t,r=e.ownerDocument,n=e.nodeName,i=ce[n];if(i){return i}t=r.body.appendChild(r.createElement(n));i=T.css(t,"display");t.parentNode.removeChild(t);if(i==="none"){i="block"}ce[n]=i;return i}function he(e,t){var r,n,i=[],a=0,o=e.length;for(;a<o;a++){n=e[a];if(!n.style){continue}r=n.style.display;if(t){if(r==="none"){i[a]=J.get(n,"display")||null;if(!i[a]){n.style.display=""}}if(n.style.display===""&&ue(n)){i[a]=de(n)}}else{if(r!=="none"){i[a]="none";J.set(n,"display",r)}}}for(a=0;a<o;a++){if(i[a]!=null){e[a].style.display=i[a]}}return e}T.fn.extend({show:function(){return he(this,true)},hide:function(){return he(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each(function(){if(ue(this)){T(this).show()}else{T(this).hide()}})}});var ve=/^(?:checkbox|radio)$/i;var pe=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i;var ge=/^$|^module$|\/(?:java|ecma)script/i;(function(){var e=k.createDocumentFragment(),t=e.appendChild(k.createElement("div")),r=k.createElement("input");r.setAttribute("type","radio");r.setAttribute("checked","checked");r.setAttribute("name","t");t.appendChild(r);m.checkClone=t.cloneNode(true).cloneNode(true).lastChild.checked;t.innerHTML="<textarea>x</textarea>";m.noCloneChecked=!!t.cloneNode(true).lastChild.defaultValue;t.innerHTML="<option></option>";m.option=!!t.lastChild})();var me={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};me.tbody=me.tfoot=me.colgroup=me.caption=me.thead;me.th=me.td;if(!m.option){me.optgroup=me.option=[1,"<select multiple='multiple'>","</select>"]}function ye(e,t){var r;if(typeof e.getElementsByTagName!=="undefined"){r=e.getElementsByTagName(t||"*")}else if(typeof e.querySelectorAll!=="undefined"){r=e.querySelectorAll(t||"*")}else{r=[]}if(t===undefined||t&&x(e,t)){return T.merge([e],r)}return r}function be(e,t){var r=0,n=e.length;for(;r<n;r++){J.set(e[r],"globalEval",!t||J.get(t[r],"globalEval"))}}var we=/<|&#?\w+;/;function Ce(e,t,r,n,i){var a,o,s,l,u,f,c=t.createDocumentFragment(),d=[],h=0,v=e.length;for(;h<v;h++){a=e[h];if(a||a===0){if(C(a)==="object"){T.merge(d,a.nodeType?[a]:a)}else if(!we.test(a)){d.push(t.createTextNode(a))}else{o=o||c.appendChild(t.createElement("div"));s=(pe.exec(a)||["",""])[1].toLowerCase();l=me[s]||me._default;o.innerHTML=l[1]+T.htmlPrefilter(a)+l[2];f=l[0];while(f--){o=o.lastChild}T.merge(d,o.childNodes);o=c.firstChild;o.textContent=""}}}c.textContent="";h=0;while(a=d[h++]){if(n&&T.inArray(a,n)>-1){if(i){i.push(a)}continue}u=se(a);o=ye(c.appendChild(a),"script");if(u){be(o)}if(r){f=0;while(a=o[f++]){if(ge.test(a.type||"")){r.push(a)}}}}return c}var Se=/^([^.]*)(?:\.(.+)|)/;function Ee(){return true}function ke(){return false}function Te(e,t){return e===_e()===(t==="focus")}function _e(){try{return k.activeElement}catch(e){}}function xe(e,t,r,n,i,a){var o,s;if(typeof t==="object"){if(typeof r!=="string"){n=n||r;r=undefined}for(s in t){xe(e,s,r,n,t[s],a)}return e}if(n==null&&i==null){i=r;n=r=undefined}else if(i==null){if(typeof r==="string"){i=n;n=undefined}else{i=n;n=r;r=undefined}}if(i===false){i=ke}else if(!i){return e}if(a===1){o=i;i=function(e){T().off(e);return o.apply(this,arguments)};i.guid=o.guid||(o.guid=T.guid++)}return e.each(function(){T.event.add(this,t,i,n,r)})}T.event={global:{},add:function(t,e,r,n,i){var a,o,s,l,u,f,c,d,h,v,p,g=J.get(t);if(!X(t)){return}if(r.handler){a=r;r=a.handler;i=a.selector}if(i){T.find.matchesSelector(oe,i)}if(!r.guid){r.guid=T.guid++}if(!(l=g.events)){l=g.events=Object.create(null)}if(!(o=g.handle)){o=g.handle=function(e){return typeof T!=="undefined"&&T.event.triggered!==e.type?T.event.dispatch.apply(t,arguments):undefined}}e=(e||"").match(P)||[""];u=e.length;while(u--){s=Se.exec(e[u])||[];h=p=s[1];v=(s[2]||"").split(".").sort();if(!h){continue}c=T.event.special[h]||{};h=(i?c.delegateType:c.bindType)||h;c=T.event.special[h]||{};f=T.extend({type:h,origType:p,data:n,handler:r,guid:r.guid,selector:i,needsContext:i&&T.expr.match.needsContext.test(i),namespace:v.join(".")},a);if(!(d=l[h])){d=l[h]=[];d.delegateCount=0;if(!c.setup||c.setup.call(t,n,v,o)===false){if(t.addEventListener){t.addEventListener(h,o)}}}if(c.add){c.add.call(t,f);if(!f.handler.guid){f.handler.guid=r.guid}}if(i){d.splice(d.delegateCount++,0,f)}else{d.push(f)}T.event.global[h]=true}},remove:function(e,t,r,n,i){var a,o,s,l,u,f,c,d,h,v,p,g=J.hasData(e)&&J.get(e);if(!g||!(l=g.events)){return}t=(t||"").match(P)||[""];u=t.length;while(u--){s=Se.exec(t[u])||[];h=p=s[1];v=(s[2]||"").split(".").sort();if(!h){for(h in l){T.event.remove(e,h+t[u],r,n,true)}continue}c=T.event.special[h]||{};h=(n?c.delegateType:c.bindType)||h;d=l[h]||[];s=s[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)");o=a=d.length;while(a--){f=d[a];if((i||p===f.origType)&&(!r||r.guid===f.guid)&&(!s||s.test(f.namespace))&&(!n||n===f.selector||n==="**"&&f.selector)){d.splice(a,1);if(f.selector){d.delegateCount--}if(c.remove){c.remove.call(e,f)}}}if(o&&!d.length){if(!c.teardown||c.teardown.call(e,v,g.handle)===false){T.removeEvent(e,h,g.handle)}delete l[h]}}if(T.isEmptyObject(l)){J.remove(e,"handle events")}},dispatch:function(e){var t,r,n,i,a,o,s=new Array(arguments.length),l=T.event.fix(e),u=(J.get(this,"events")||Object.create(null))[l.type]||[],f=T.event.special[l.type]||{};s[0]=l;for(t=1;t<arguments.length;t++){s[t]=arguments[t]}l.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,l)===false){return}o=T.event.handlers.call(this,l,u);t=0;while((i=o[t++])&&!l.isPropagationStopped()){l.currentTarget=i.elem;r=0;while((a=i.handlers[r++])&&!l.isImmediatePropagationStopped()){if(!l.rnamespace||a.namespace===false||l.rnamespace.test(a.namespace)){l.handleObj=a;l.data=a.data;n=((T.event.special[a.origType]||{}).handle||a.handler).apply(i.elem,s);if(n!==undefined){if((l.result=n)===false){l.preventDefault();l.stopPropagation()}}}}}if(f.postDispatch){f.postDispatch.call(this,l)}return l.result},handlers:function(e,t){var r,n,i,a,o,s=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!(e.type==="click"&&e.button>=1)){for(;u!==this;u=u.parentNode||this){if(u.nodeType===1&&!(e.type==="click"&&u.disabled===true)){a=[];o={};for(r=0;r<l;r++){n=t[r];i=n.selector+" ";if(o[i]===undefined){o[i]=n.needsContext?T(i,this).index(u)>-1:T.find(i,this,null,[u]).length}if(o[i]){a.push(n)}}if(a.length){s.push({elem:u,handlers:a})}}}}u=this;if(l<t.length){s.push({elem:u,handlers:t.slice(l)})}return s},addProp:function(t,e){Object.defineProperty(T.Event.prototype,t,{enumerable:true,configurable:true,get:y(e)?function(){if(this.originalEvent){return e(this.originalEvent)}}:function(){if(this.originalEvent){return this.originalEvent[t]}},set:function(e){Object.defineProperty(this,t,{enumerable:true,configurable:true,writable:true,value:e})}})},fix:function(e){return e[T.expando]?e:new T.Event(e)},special:{load:{noBubble:true},click:{setup:function(e){var t=this||e;if(ve.test(t.type)&&t.click&&x(t,"input")){De(t,"click",Ee)}return false},trigger:function(e){var t=this||e;if(ve.test(t.type)&&t.click&&x(t,"input")){De(t,"click")}return true},_default:function(e){var t=e.target;return ve.test(t.type)&&t.click&&x(t,"input")&&J.get(t,"click")||x(t,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==undefined&&e.originalEvent){e.originalEvent.returnValue=e.result}}}}};function De(e,i,a){if(!a){if(J.get(e,i)===undefined){T.event.add(e,i,Ee)}return}J.set(e,i,false);T.event.add(e,i,{namespace:false,handler:function(e){var t,r,n=J.get(this,i);if(e.isTrigger&1&&this[i]){if(!n.length){n=s.call(arguments);J.set(this,i,n);t=a(this,i);this[i]();r=J.get(this,i);if(n!==r||t){J.set(this,i,false)}else{r={}}if(n!==r){e.stopImmediatePropagation();e.preventDefault();return r&&r.value}}else if((T.event.special[i]||{}).delegateType){e.stopPropagation()}}else if(n.length){J.set(this,i,{value:T.event.trigger(T.extend(n[0],T.Event.prototype),n.slice(1),this)});e.stopImmediatePropagation()}}})}T.removeEvent=function(e,t,r){if(e.removeEventListener){e.removeEventListener(t,r)}};T.Event=function(e,t){if(!(this instanceof T.Event)){return new T.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===false?Ee:ke;this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target;this.currentTarget=e.currentTarget;this.relatedTarget=e.relatedTarget}else{this.type=e}if(t){T.extend(this,t)}this.timeStamp=e&&e.timeStamp||Date.now();this[T.expando]=true};T.Event.prototype={constructor:T.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ee;if(e&&!this.isSimulated){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ee;if(e&&!this.isSimulated){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ee;if(e&&!this.isSimulated){e.stopImmediatePropagation()}this.stopPropagation()}};T.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,char:true,code:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:true},T.event.addProp);T.each({focus:"focusin",blur:"focusout"},function(e,t){T.event.special[e]={setup:function(){De(this,e,Te);return false},trigger:function(){De(this,e);return true},_default:function(){return true},delegateType:t}});T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,a){T.event.special[e]={delegateType:a,bindType:a,handle:function(e){var t,r=this,n=e.relatedTarget,i=e.handleObj;if(!n||n!==r&&!T.contains(r,n)){e.type=i.origType;t=i.handler.apply(this,arguments);e.type=a}return t}}});T.fn.extend({on:function(e,t,r,n){return xe(this,e,t,r,n)},one:function(e,t,r,n){return xe(this,e,t,r,n,1)},off:function(e,t,r){var n,i;if(e&&e.preventDefault&&e.handleObj){n=e.handleObj;T(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler);return this}if(typeof e==="object"){for(i in e){this.off(i,t,e[i])}return this}if(t===false||typeof t==="function"){r=t;t=undefined}if(r===false){r=ke}return this.each(function(){T.event.remove(this,e,r,t)})}});var Re=/<script|<style|<link/i,Ie=/checked\s*(?:[^=]|=\s*.checked.)/i,Oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ae(e,t){if(x(e,"table")&&x(t.nodeType!==11?t:t.firstChild,"tr")){return T(e).children("tbody")[0]||e}return e}function Ne(e){e.type=(e.getAttribute("type")!==null)+"/"+e.type;return e}function Me(e){if((e.type||"").slice(0,5)==="true/"){e.type=e.type.slice(5)}else{e.removeAttribute("type")}return e}function Le(e,t){var r,n,i,a,o,s,l;if(t.nodeType!==1){return}if(J.hasData(e)){a=J.get(e);l=a.events;if(l){J.remove(t,"handle events");for(i in l){for(r=0,n=l[i].length;r<n;r++){T.event.add(t,i,l[i][r])}}}}if(Q.hasData(e)){o=Q.access(e);s=T.extend({},o);Q.set(t,s)}}function Pe(e,t){var r=t.nodeName.toLowerCase();if(r==="input"&&ve.test(e.type)){t.checked=e.checked}else if(r==="input"||r==="textarea"){t.defaultValue=e.defaultValue}}function Fe(r,n,i,a){n=p(n);var e,t,o,s,l,u,f=0,c=r.length,d=c-1,h=n[0],v=y(h);if(v||c>1&&typeof h==="string"&&!m.checkClone&&Ie.test(h)){return r.each(function(e){var t=r.eq(e);if(v){n[0]=h.call(this,e,t.html())}Fe(t,n,i,a)})}if(c){e=Ce(n,r[0].ownerDocument,false,r,a);t=e.firstChild;if(e.childNodes.length===1){e=t}if(t||a){o=T.map(ye(e,"script"),Ne);s=o.length;for(;f<c;f++){l=e;if(f!==d){l=T.clone(l,true,true);if(s){T.merge(o,ye(l,"script"))}}i.call(r[f],l,f)}if(s){u=o[o.length-1].ownerDocument;T.map(o,Me);for(f=0;f<s;f++){l=o[f];if(ge.test(l.type||"")&&!J.access(l,"globalEval")&&T.contains(u,l)){if(l.src&&(l.type||"").toLowerCase()!=="module"){if(T._evalUrl&&!l.noModule){T._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},u)}}else{w(l.textContent.replace(Oe,""),l,u)}}}}}}return r}function Be(e,t,r){var n,i=t?T.filter(t,e):e,a=0;for(;(n=i[a])!=null;a++){if(!r&&n.nodeType===1){T.cleanData(ye(n))}if(n.parentNode){if(r&&se(n)){be(ye(n,"script"))}n.parentNode.removeChild(n)}}return e}T.extend({htmlPrefilter:function(e){return e},clone:function(e,t,r){var n,i,a,o,s=e.cloneNode(true),l=se(e);if(!m.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!T.isXMLDoc(e)){o=ye(s);a=ye(e);for(n=0,i=a.length;n<i;n++){Pe(a[n],o[n])}}if(t){if(r){a=a||ye(e);o=o||ye(s);for(n=0,i=a.length;n<i;n++){Le(a[n],o[n])}}else{Le(e,s)}}o=ye(s,"script");if(o.length>0){be(o,!l&&ye(e,"script"))}return s},cleanData:function(e){var t,r,n,i=T.event.special,a=0;for(;(r=e[a])!==undefined;a++){if(X(r)){if(t=r[J.expando]){if(t.events){for(n in t.events){if(i[n]){T.event.remove(r,n)}else{T.removeEvent(r,n,t.handle)}}}r[J.expando]=undefined}if(r[Q.expando]){r[Q.expando]=undefined}}}}});T.fn.extend({detach:function(e){return Be(this,e,true)},remove:function(e){return Be(this,e)},text:function(e){return V(this,function(e){return e===undefined?T.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=e}})},null,e,arguments.length)},append:function(){return Fe(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Ae(this,e);t.appendChild(e)}})},prepend:function(){return Fe(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Ae(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Fe(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return Fe(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}})},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){if(e.nodeType===1){T.cleanData(ye(e,false));e.textContent=""}}return this},clone:function(e,t){e=e==null?false:e;t=t==null?e:t;return this.map(function(){return T.clone(this,e,t)})},html:function(e){return V(this,function(e){var t=this[0]||{},r=0,n=this.length;if(e===undefined&&t.nodeType===1){return t.innerHTML}if(typeof e==="string"&&!Re.test(e)&&!me[(pe.exec(e)||["",""])[1].toLowerCase()]){e=T.htmlPrefilter(e);try{for(;r<n;r++){t=this[r]||{};if(t.nodeType===1){T.cleanData(ye(t,false));t.innerHTML=e}}t=0}catch(e){}}if(t){this.empty().append(e)}},null,e,arguments.length)},replaceWith:function(){var r=[];return Fe(this,arguments,function(e){var t=this.parentNode;if(T.inArray(this,r)<0){T.cleanData(ye(this));if(t){t.replaceChild(e,this)}}},r)}});T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,o){T.fn[e]=function(e){var t,r=[],n=T(e),i=n.length-1,a=0;for(;a<=i;a++){t=a===i?this:this.clone(true);T(n[a])[o](t);l.apply(r,t.get())}return this.pushStack(r)}});var He=new RegExp("^("+ne+")(?!px)[a-z%]+$","i");var $e=function(e){var t=e.ownerDocument.defaultView;if(!t||!t.opener){t=E}return t.getComputedStyle(e)};var We=function(e,t,r){var n,i,a={};for(i in t){a[i]=e.style[i];e.style[i]=t[i]}n=r.call(e);for(i in t){e.style[i]=a[i]}return n};var Ue=new RegExp(ae.join("|"),"i");(function(){function e(){if(!u){return}l.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";oe.appendChild(l).appendChild(u);var e=E.getComputedStyle(u);r=e.top!=="1%";s=t(e.marginLeft)===12;u.style.right="60%";a=t(e.right)===36;n=t(e.width)===36;u.style.position="absolute";i=t(u.offsetWidth/3)===12;oe.removeChild(l);u=null}function t(e){return Math.round(parseFloat(e))}var r,n,i,a,o,s,l=k.createElement("div"),u=k.createElement("div");if(!u.style){return}u.style.backgroundClip="content-box";u.cloneNode(true).style.backgroundClip="";m.clearCloneStyle=u.style.backgroundClip==="content-box";T.extend(m,{boxSizingReliable:function(){e();return n},pixelBoxStyles:function(){e();return a},pixelPosition:function(){e();return r},reliableMarginLeft:function(){e();return s},scrollboxSize:function(){e();return i},reliableTrDimensions:function(){var e,t,r,n;if(o==null){e=k.createElement("table");t=k.createElement("tr");r=k.createElement("div");e.style.cssText="position:absolute;left:-11111px;border-collapse:separate";t.style.cssText="border:1px solid";t.style.height="1px";r.style.height="9px";r.style.display="block";oe.appendChild(e).appendChild(t).appendChild(r);n=E.getComputedStyle(t);o=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===t.offsetHeight;oe.removeChild(e)}return o}})})();function je(e,t,r){var n,i,a,o,s=e.style;r=r||$e(e);if(r){o=r.getPropertyValue(t)||r[t];if(o===""&&!se(e)){o=T.style(e,t)}if(!m.pixelBoxStyles()&&He.test(o)&&Ue.test(t)){n=s.width;i=s.minWidth;a=s.maxWidth;s.minWidth=s.maxWidth=s.width=o;o=r.width;s.width=n;s.minWidth=i;s.maxWidth=a}}return o!==undefined?o+"":o}function Ve(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}var ze=["Webkit","Moz","ms"],qe=k.createElement("div").style,Ye={};function Ge(e){var t=e[0].toUpperCase()+e.slice(1),r=ze.length;while(r--){e=ze[r]+t;if(e in qe){return e}}}function Xe(e){var t=T.cssProps[e]||Ye[e];if(t){return t}if(e in qe){return e}return Ye[e]=Ge(e)||e}var Ke=/^(none|table(?!-c[ea]).+)/,Je=/^--/,Qe={position:"absolute",visibility:"hidden",display:"block"},Ze={letterSpacing:"0",fontWeight:"400"};function et(e,t,r){var n=ie.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function tt(e,t,r,n,i,a){var o=t==="width"?1:0,s=0,l=0;if(r===(n?"border":"content")){return 0}for(;o<4;o+=2){if(r==="margin"){l+=T.css(e,r+ae[o],true,i)}if(!n){l+=T.css(e,"padding"+ae[o],true,i);if(r!=="padding"){l+=T.css(e,"border"+ae[o]+"Width",true,i)}else{s+=T.css(e,"border"+ae[o]+"Width",true,i)}}else{if(r==="content"){l-=T.css(e,"padding"+ae[o],true,i)}if(r!=="margin"){l-=T.css(e,"border"+ae[o]+"Width",true,i)}}}if(!n&&a>=0){l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-l-s-.5))||0}return l}function rt(e,t,r){var n=$e(e),i=!m.boxSizingReliable()||r,a=i&&T.css(e,"boxSizing",false,n)==="border-box",o=a,s=je(e,t,n),l="offset"+t[0].toUpperCase()+t.slice(1);if(He.test(s)){if(!r){return s}s="auto"}if((!m.boxSizingReliable()&&a||!m.reliableTrDimensions()&&x(e,"tr")||s==="auto"||!parseFloat(s)&&T.css(e,"display",false,n)==="inline")&&e.getClientRects().length){a=T.css(e,"boxSizing",false,n)==="border-box";o=l in e;if(o){s=e[l]}}s=parseFloat(s)||0;return s+tt(e,t,r||(a?"border":"content"),o,n,s)+"px"}T.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=je(e,"opacity");return r===""?"1":r}}}},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,gridArea:true,gridColumn:true,gridColumnEnd:true,gridColumnStart:true,gridRow:true,gridRowEnd:true,gridRowStart:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{},style:function(e,t,r,n){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var i,a,o,s=G(t),l=Je.test(t),u=e.style;if(!l){t=Xe(s)}o=T.cssHooks[t]||T.cssHooks[s];if(r!==undefined){a=typeof r;if(a==="string"&&(i=ie.exec(r))&&i[1]){r=fe(e,t,i);a="number"}if(r==null||r!==r){return}if(a==="number"&&!l){r+=i&&i[3]||(T.cssNumber[s]?"":"px")}if(!m.clearCloneStyle&&r===""&&t.indexOf("background")===0){u[t]="inherit"}if(!o||!("set"in o)||(r=o.set(e,r,n))!==undefined){if(l){u.setProperty(t,r)}else{u[t]=r}}}else{if(o&&"get"in o&&(i=o.get(e,false,n))!==undefined){return i}return u[t]}},css:function(e,t,r,n){var i,a,o,s=G(t),l=Je.test(t);if(!l){t=Xe(s)}o=T.cssHooks[t]||T.cssHooks[s];if(o&&"get"in o){i=o.get(e,true,r)}if(i===undefined){i=je(e,t,n)}if(i==="normal"&&t in Ze){i=Ze[t]}if(r===""||r){a=parseFloat(i);return r===true||isFinite(a)?a||0:i}return i}});T.each(["height","width"],function(e,u){T.cssHooks[u]={get:function(e,t,r){if(t){return Ke.test(T.css(e,"display"))&&(!e.getClientRects().length||!e.getBoundingClientRect().width)?We(e,Qe,function(){return rt(e,u,r)}):rt(e,u,r)}},set:function(e,t,r){var n,i=$e(e),a=!m.scrollboxSize()&&i.position==="absolute",o=a||r,s=o&&T.css(e,"boxSizing",false,i)==="border-box",l=r?tt(e,u,r,s,i):0;if(s&&a){l-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-tt(e,u,"border",false,i)-.5)}if(l&&(n=ie.exec(t))&&(n[3]||"px")!=="px"){e.style[u]=t;t=T.css(e,u)}return et(e,t,l)}}});T.cssHooks.marginLeft=Ve(m.reliableMarginLeft,function(e,t){if(t){return(parseFloat(je(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}});T.each({margin:"",padding:"",border:"Width"},function(i,a){T.cssHooks[i+a]={expand:function(e){var t=0,r={},n=typeof e==="string"?e.split(" "):[e];for(;t<4;t++){r[i+ae[t]+a]=n[t]||n[t-2]||n[0]}return r}};if(i!=="margin"){T.cssHooks[i+a].set=et}});T.fn.extend({css:function(e,t){return V(this,function(e,t,r){var n,i,a={},o=0;if(Array.isArray(t)){n=$e(e);i=t.length;for(;o<i;o++){a[t[o]]=T.css(e,t[o],false,n)}return a}return r!==undefined?T.style(e,t,r):T.css(e,t)},e,t,arguments.length>1)}});function nt(e,t,r,n,i){return new nt.prototype.init(e,t,r,n,i)}T.Tween=nt;nt.prototype={constructor:nt,init:function(e,t,r,n,i,a){this.elem=e;this.prop=r;this.easing=i||T.easing._default;this.options=t;this.start=this.now=this.cur();this.end=n;this.unit=a||(T.cssNumber[r]?"":"px")},cur:function(){var e=nt.propHooks[this.prop];return e&&e.get?e.get(this):nt.propHooks._default.get(this)},run:function(e){var t,r=nt.propHooks[this.prop];if(this.options.duration){this.pos=t=T.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=t=e}this.now=(this.end-this.start)*t+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(r&&r.set){r.set(this)}else{nt.propHooks._default.set(this)}return this}};nt.prototype.init.prototype=nt.prototype;nt.propHooks={_default:{get:function(e){var t;if(e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null){return e.elem[e.prop]}t=T.css(e.elem,e.prop,"");return!t||t==="auto"?0:t},set:function(e){if(T.fx.step[e.prop]){T.fx.step[e.prop](e)}else if(e.elem.nodeType===1&&(T.cssHooks[e.prop]||e.elem.style[Xe(e.prop)]!=null)){T.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};nt.propHooks.scrollTop=nt.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};T.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"};T.fx=nt.prototype.init;T.fx.step={};var it,at,ot=/^(?:toggle|show|hide)$/,st=/queueHooks$/;function lt(){if(at){if(k.hidden===false&&E.requestAnimationFrame){E.requestAnimationFrame(lt)}else{E.setTimeout(lt,T.fx.interval)}T.fx.tick()}}function ut(){E.setTimeout(function(){it=undefined});return it=Date.now()}function ft(e,t){var r,n=0,i={height:e};t=t?1:0;for(;n<4;n+=2-t){r=ae[n];i["margin"+r]=i["padding"+r]=e}if(t){i.opacity=i.width=e}return i}function ct(e,t,r){var n,i=(vt.tweeners[t]||[]).concat(vt.tweeners["*"]),a=0,o=i.length;for(;a<o;a++){if(n=i[a].call(r,t,e)){return n}}}function dt(e,t,r){var n,i,a,o,s,l,u,f,c="width"in t||"height"in t,d=this,h={},v=e.style,p=e.nodeType&&ue(e),g=J.get(e,"fxshow");if(!r.queue){o=T._queueHooks(e,"fx");if(o.unqueued==null){o.unqueued=0;s=o.empty.fire;o.empty.fire=function(){if(!o.unqueued){s()}}}o.unqueued++;d.always(function(){d.always(function(){o.unqueued--;if(!T.queue(e,"fx").length){o.empty.fire()}})})}for(n in t){i=t[n];if(ot.test(i)){delete t[n];a=a||i==="toggle";if(i===(p?"hide":"show")){if(i==="show"&&g&&g[n]!==undefined){p=true}else{continue}}h[n]=g&&g[n]||T.style(e,n)}}l=!T.isEmptyObject(t);if(!l&&T.isEmptyObject(h)){return}if(c&&e.nodeType===1){r.overflow=[v.overflow,v.overflowX,v.overflowY];u=g&&g.display;if(u==null){u=J.get(e,"display")}f=T.css(e,"display");if(f==="none"){if(u){f=u}else{he([e],true);u=e.style.display||u;f=T.css(e,"display");he([e])}}if(f==="inline"||f==="inline-block"&&u!=null){if(T.css(e,"float")==="none"){if(!l){d.done(function(){v.display=u});if(u==null){f=v.display;u=f==="none"?"":f}}v.display="inline-block"}}}if(r.overflow){v.overflow="hidden";d.always(function(){v.overflow=r.overflow[0];v.overflowX=r.overflow[1];v.overflowY=r.overflow[2]})}l=false;for(n in h){if(!l){if(g){if("hidden"in g){p=g.hidden}}else{g=J.access(e,"fxshow",{display:u})}if(a){g.hidden=!p}if(p){he([e],true)}d.done(function(){if(!p){he([e])}J.remove(e,"fxshow");for(n in h){T.style(e,n,h[n])}})}l=ct(p?g[n]:0,n,d);if(!(n in g)){g[n]=l.start;if(p){l.end=l.start;l.start=0}}}}function ht(e,t){var r,n,i,a,o;for(r in e){n=G(r);i=t[n];a=e[r];if(Array.isArray(a)){i=a[1];a=e[r]=a[0]}if(r!==n){e[n]=a;delete e[r]}o=T.cssHooks[n];if(o&&"expand"in o){a=o.expand(a);delete e[n];for(r in a){if(!(r in e)){e[r]=a[r];t[r]=i}}}else{t[n]=i}}}function vt(o,e,t){var r,s,n=0,i=vt.prefilters.length,l=T.Deferred().always(function(){delete a.elem}),a=function(){if(s){return false}var e=it||ut(),t=Math.max(0,u.startTime+u.duration-e),r=t/u.duration||0,n=1-r,i=0,a=u.tweens.length;for(;i<a;i++){u.tweens[i].run(n)}l.notifyWith(o,[u,n,t]);if(n<1&&a){return t}if(!a){l.notifyWith(o,[u,1,0])}l.resolveWith(o,[u]);return false},u=l.promise({elem:o,props:T.extend({},e),opts:T.extend(true,{specialEasing:{},easing:T.easing._default},t),originalProperties:e,originalOptions:t,startTime:it||ut(),duration:t.duration,tweens:[],createTween:function(e,t){var r=T.Tween(o,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);u.tweens.push(r);return r},stop:function(e){var t=0,r=e?u.tweens.length:0;if(s){return this}s=true;for(;t<r;t++){u.tweens[t].run(1)}if(e){l.notifyWith(o,[u,1,0]);l.resolveWith(o,[u,e])}else{l.rejectWith(o,[u,e])}return this}}),f=u.props;ht(f,u.opts.specialEasing);for(;n<i;n++){r=vt.prefilters[n].call(u,o,f,u.opts);if(r){if(y(r.stop)){T._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)}return r}}T.map(f,ct,u);if(y(u.opts.start)){u.opts.start.call(o,u)}u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always);T.fx.timer(T.extend(a,{elem:o,anim:u,queue:u.opts.queue}));return u}T.Animation=T.extend(vt,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);fe(r.elem,e,ie.exec(t),r);return r}]},tweener:function(e,t){if(y(e)){t=e;e=["*"]}else{e=e.match(P)}var r,n=0,i=e.length;for(;n<i;n++){r=e[n];vt.tweeners[r]=vt.tweeners[r]||[];vt.tweeners[r].unshift(t)}},prefilters:[dt],prefilter:function(e,t){if(t){vt.prefilters.unshift(e)}else{vt.prefilters.push(e)}}});T.speed=function(e,t,r){var n=e&&typeof e==="object"?T.extend({},e):{complete:r||!r&&t||y(e)&&e,duration:e,easing:r&&t||t&&!y(t)&&t};if(T.fx.off){n.duration=0}else{if(typeof n.duration!=="number"){if(n.duration in T.fx.speeds){n.duration=T.fx.speeds[n.duration]}else{n.duration=T.fx.speeds._default}}}if(n.queue==null||n.queue===true){n.queue="fx"}n.old=n.complete;n.complete=function(){if(y(n.old)){n.old.call(this)}if(n.queue){T.dequeue(this,n.queue)}};return n};T.fn.extend({fadeTo:function(e,t,r,n){return this.filter(ue).css("opacity",0).show().end().animate({opacity:t},e,r,n)},animate:function(t,e,r,n){var i=T.isEmptyObject(t),a=T.speed(e,r,n),o=function(){var e=vt(this,T.extend({},t),a);if(i||J.get(this,"finish")){e.stop(true)}};o.finish=o;return i||a.queue===false?this.each(o):this.queue(a.queue,o)},stop:function(i,e,a){var o=function(e){var t=e.stop;delete e.stop;t(a)};if(typeof i!=="string"){a=e;e=i;i=undefined}if(e){this.queue(i||"fx",[])}return this.each(function(){var e=true,t=i!=null&&i+"queueHooks",r=T.timers,n=J.get(this);if(t){if(n[t]&&n[t].stop){o(n[t])}}else{for(t in n){if(n[t]&&n[t].stop&&st.test(t)){o(n[t])}}}for(t=r.length;t--;){if(r[t].elem===this&&(i==null||r[t].queue===i)){r[t].anim.stop(a);e=false;r.splice(t,1)}}if(e||!a){T.dequeue(this,i)}})},finish:function(o){if(o!==false){o=o||"fx"}return this.each(function(){var e,t=J.get(this),r=t[o+"queue"],n=t[o+"queueHooks"],i=T.timers,a=r?r.length:0;t.finish=true;T.queue(this,o,[]);if(n&&n.stop){n.stop.call(this,true)}for(e=i.length;e--;){if(i[e].elem===this&&i[e].queue===o){i[e].anim.stop(true);i.splice(e,1)}}for(e=0;e<a;e++){if(r[e]&&r[e].finish){r[e].finish.call(this)}}delete t.finish})}});T.each(["toggle","show","hide"],function(e,n){var i=T.fn[n];T.fn[n]=function(e,t,r){return e==null||typeof e==="boolean"?i.apply(this,arguments):this.animate(ft(n,true),e,t,r)}});T.each({slideDown:ft("show"),slideUp:ft("hide"),slideToggle:ft("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){T.fn[e]=function(e,t,r){return this.animate(n,e,t,r)}});T.timers=[];T.fx.tick=function(){var e,t=0,r=T.timers;it=Date.now();for(;t<r.length;t++){e=r[t];if(!e()&&r[t]===e){r.splice(t--,1)}}if(!r.length){T.fx.stop()}it=undefined};T.fx.timer=function(e){T.timers.push(e);T.fx.start()};T.fx.interval=13;T.fx.start=function(){if(at){return}at=true;lt()};T.fx.stop=function(){at=null};T.fx.speeds={slow:600,fast:200,_default:400};T.fn.delay=function(n,e){n=T.fx?T.fx.speeds[n]||n:n;e=e||"fx";return this.queue(e,function(e,t){var r=E.setTimeout(e,n);t.stop=function(){E.clearTimeout(r)}})};(function(){var e=k.createElement("input"),t=k.createElement("select"),r=t.appendChild(k.createElement("option"));e.type="checkbox";m.checkOn=e.value!=="";m.optSelected=r.selected;e=k.createElement("input");e.value="t";e.type="radio";m.radioValue=e.value==="t"})();var pt,gt=T.expr.attrHandle;T.fn.extend({attr:function(e,t){return V(this,T.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){T.removeAttr(this,e)})}});T.extend({attr:function(e,t,r){var n,i,a=e.nodeType;if(a===3||a===8||a===2){return}if(typeof e.getAttribute==="undefined"){return T.prop(e,t,r)}if(a!==1||!T.isXMLDoc(e)){i=T.attrHooks[t.toLowerCase()]||(T.expr.match.bool.test(t)?pt:undefined)}if(r!==undefined){if(r===null){T.removeAttr(e,t);return}if(i&&"set"in i&&(n=i.set(e,r,t))!==undefined){return n}e.setAttribute(t,r+"");return r}if(i&&"get"in i&&(n=i.get(e,t))!==null){return n}n=T.find.attr(e,t);return n==null?undefined:n},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&t==="radio"&&x(e,"input")){var r=e.value;e.setAttribute("type",t);if(r){e.value=r}return t}}}},removeAttr:function(e,t){var r,n=0,i=t&&t.match(P);if(i&&e.nodeType===1){while(r=i[n++]){e.removeAttribute(r)}}}});pt={set:function(e,t,r){if(t===false){T.removeAttr(e,r)}else{e.setAttribute(r,r)}return r}};T.each(T.expr.match.bool.source.match(/\w+/g),function(e,t){var o=gt[t]||T.find.attr;gt[t]=function(e,t,r){var n,i,a=t.toLowerCase();if(!r){i=gt[a];gt[a]=n;n=o(e,t,r)!=null?a:null;gt[a]=i}return n}});var mt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;T.fn.extend({prop:function(e,t){return V(this,T.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[T.propFix[e]||e]})}});T.extend({prop:function(e,t,r){var n,i,a=e.nodeType;if(a===3||a===8||a===2){return}if(a!==1||!T.isXMLDoc(e)){t=T.propFix[t]||t;i=T.propHooks[t]}if(r!==undefined){if(i&&"set"in i&&(n=i.set(e,r,t))!==undefined){return n}return e[t]=r}if(i&&"get"in i&&(n=i.get(e,t))!==null){return n}return e[t]},propHooks:{tabIndex:{get:function(e){var t=T.find.attr(e,"tabindex");if(t){return parseInt(t,10)}if(mt.test(e.nodeName)||yt.test(e.nodeName)&&e.href){return 0}return-1}}},propFix:{for:"htmlFor",class:"className"}});if(!m.optSelected){T.propHooks.selected={get:function(e){var t=e.parentNode;if(t&&t.parentNode){t.parentNode.selectedIndex}return null},set:function(e){var t=e.parentNode;if(t){t.selectedIndex;if(t.parentNode){t.parentNode.selectedIndex}}}}}T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){T.propFix[this.toLowerCase()]=this});function bt(e){var t=e.match(P)||[];return t.join(" ")}function wt(e){return e.getAttribute&&e.getAttribute("class")||""}function Ct(e){if(Array.isArray(e)){return e}if(typeof e==="string"){return e.match(P)||[]}return[]}T.fn.extend({addClass:function(t){var e,r,n,i,a,o,s,l=0;if(y(t)){return this.each(function(e){T(this).addClass(t.call(this,e,wt(this)))})}e=Ct(t);if(e.length){while(r=this[l++]){i=wt(r);n=r.nodeType===1&&" "+bt(i)+" ";if(n){o=0;while(a=e[o++]){if(n.indexOf(" "+a+" ")<0){n+=a+" "}}s=bt(n);if(i!==s){r.setAttribute("class",s)}}}}return this},removeClass:function(t){var e,r,n,i,a,o,s,l=0;if(y(t)){return this.each(function(e){T(this).removeClass(t.call(this,e,wt(this)))})}if(!arguments.length){return this.attr("class","")}e=Ct(t);if(e.length){while(r=this[l++]){i=wt(r);n=r.nodeType===1&&" "+bt(i)+" ";if(n){o=0;while(a=e[o++]){while(n.indexOf(" "+a+" ")>-1){n=n.replace(" "+a+" "," ")}}s=bt(n);if(i!==s){r.setAttribute("class",s)}}}}return this},toggleClass:function(i,t){var a=typeof i,o=a==="string"||Array.isArray(i);if(typeof t==="boolean"&&o){return t?this.addClass(i):this.removeClass(i)}if(y(i)){return this.each(function(e){T(this).toggleClass(i.call(this,e,wt(this),t),t)})}return this.each(function(){var e,t,r,n;if(o){t=0;r=T(this);n=Ct(i);while(e=n[t++]){if(r.hasClass(e)){r.removeClass(e)}else{r.addClass(e)}}}else if(i===undefined||a==="boolean"){e=wt(this);if(e){J.set(this,"__className__",e)}if(this.setAttribute){this.setAttribute("class",e||i===false?"":J.get(this,"__className__")||"")}}})},hasClass:function(e){var t,r,n=0;t=" "+e+" ";while(r=this[n++]){if(r.nodeType===1&&(" "+bt(wt(r))+" ").indexOf(t)>-1){return true}}return false}});var St=/\r/g;T.fn.extend({val:function(r){var n,e,i,t=this[0];if(!arguments.length){if(t){n=T.valHooks[t.type]||T.valHooks[t.nodeName.toLowerCase()];if(n&&"get"in n&&(e=n.get(t,"value"))!==undefined){return e}e=t.value;if(typeof e==="string"){return e.replace(St,"")}return e==null?"":e}return}i=y(r);return this.each(function(e){var t;if(this.nodeType!==1){return}if(i){t=r.call(this,e,T(this).val())}else{t=r}if(t==null){t=""}else if(typeof t==="number"){t+=""}else if(Array.isArray(t)){t=T.map(t,function(e){return e==null?"":e+""})}n=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,t,"value")===undefined){this.value=t}})}});T.extend({valHooks:{option:{get:function(e){var t=T.find.attr(e,"value");return t!=null?t:bt(T.text(e))}},select:{get:function(e){var t,r,n,i=e.options,a=e.selectedIndex,o=e.type==="select-one",s=o?null:[],l=o?a+1:i.length;if(a<0){n=l}else{n=o?a:0}for(;n<l;n++){r=i[n];if((r.selected||n===a)&&!r.disabled&&(!r.parentNode.disabled||!x(r.parentNode,"optgroup"))){t=T(r).val();if(o){return t}s.push(t)}}return s},set:function(e,t){var r,n,i=e.options,a=T.makeArray(t),o=i.length;while(o--){n=i[o];if(n.selected=T.inArray(T.valHooks.option.get(n),a)>-1){r=true}}if(!r){e.selectedIndex=-1}return a}}}});T.each(["radio","checkbox"],function(){T.valHooks[this]={set:function(e,t){if(Array.isArray(t)){return e.checked=T.inArray(T(e).val(),t)>-1}}};if(!m.checkOn){T.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}});m.focusin="onfocusin"in E;var Et=/^(?:focusinfocus|focusoutblur)$/,kt=function(e){e.stopPropagation()};T.extend(T.event,{trigger:function(e,t,r,n){var i,a,o,s,l,u,f,c,d=[r||k],h=g.call(e,"type")?e.type:e,v=g.call(e,"namespace")?e.namespace.split("."):[];a=c=o=r=r||k;if(r.nodeType===3||r.nodeType===8){return}if(Et.test(h+T.event.triggered)){return}if(h.indexOf(".")>-1){v=h.split(".");h=v.shift();v.sort()}l=h.indexOf(":")<0&&"on"+h;e=e[T.expando]?e:new T.Event(h,typeof e==="object"&&e);e.isTrigger=n?2:3;e.namespace=v.join(".");e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;e.result=undefined;if(!e.target){e.target=r}t=t==null?[e]:T.makeArray(t,[e]);f=T.event.special[h]||{};if(!n&&f.trigger&&f.trigger.apply(r,t)===false){return}if(!n&&!f.noBubble&&!b(r)){s=f.delegateType||h;if(!Et.test(s+h)){a=a.parentNode}for(;a;a=a.parentNode){d.push(a);o=a}if(o===(r.ownerDocument||k)){d.push(o.defaultView||o.parentWindow||E)}}i=0;while((a=d[i++])&&!e.isPropagationStopped()){c=a;e.type=i>1?s:f.bindType||h;u=(J.get(a,"events")||Object.create(null))[e.type]&&J.get(a,"handle");if(u){u.apply(a,t)}u=l&&a[l];if(u&&u.apply&&X(a)){e.result=u.apply(a,t);if(e.result===false){e.preventDefault()}}}e.type=h;if(!n&&!e.isDefaultPrevented()){if((!f._default||f._default.apply(d.pop(),t)===false)&&X(r)){if(l&&y(r[h])&&!b(r)){o=r[l];if(o){r[l]=null}T.event.triggered=h;if(e.isPropagationStopped()){c.addEventListener(h,kt)}r[h]();if(e.isPropagationStopped()){c.removeEventListener(h,kt)}T.event.triggered=undefined;if(o){r[l]=o}}}}return e.result},simulate:function(e,t,r){var n=T.extend(new T.Event,r,{type:e,isSimulated:true});T.event.trigger(n,null,t)}});T.fn.extend({trigger:function(e,t){return this.each(function(){T.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r){return T.event.trigger(e,t,r,true)}}});if(!m.focusin){T.each({focus:"focusin",blur:"focusout"},function(r,n){var i=function(e){T.event.simulate(n,e.target,T.event.fix(e))};T.event.special[n]={setup:function(){var e=this.ownerDocument||this.document||this,t=J.access(e,n);if(!t){e.addEventListener(r,i,true)}J.access(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=J.access(e,n)-1;if(!t){e.removeEventListener(r,i,true);J.remove(e,n)}else{J.access(e,n,t)}}}})}var Tt=E.location;var _t={guid:Date.now()};var xt=/\?/;T.parseXML=function(e){var t,r;if(!e||typeof e!=="string"){return null}try{t=(new E.DOMParser).parseFromString(e,"text/xml")}catch(e){}r=t&&t.getElementsByTagName("parsererror")[0];if(!t||r){T.error("Invalid XML: "+(r?T.map(r.childNodes,function(e){return e.textContent}).join("\n"):e))}return t};var Dt=/\[\]$/,Rt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;function At(r,e,n,i){var t;if(Array.isArray(e)){T.each(e,function(e,t){if(n||Dt.test(r)){i(r,t)}else{At(r+"["+(typeof t==="object"&&t!=null?e:"")+"]",t,n,i)}})}else if(!n&&C(e)==="object"){for(t in e){At(r+"["+t+"]",e[t],n,i)}}else{i(r,e)}}T.param=function(e,t){var r,n=[],i=function(e,t){var r=y(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(r==null?"":r)};if(e==null){return""}if(Array.isArray(e)||e.jquery&&!T.isPlainObject(e)){T.each(e,function(){i(this.name,this.value)})}else{for(r in e){At(r,e[r],t,i)}}return n.join("&")};T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=T.prop(this,"elements");return e?T.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!T(this).is(":disabled")&&Ot.test(this.nodeName)&&!It.test(e)&&(this.checked||!ve.test(e))}).map(function(e,t){var r=T(this).val();if(r==null){return null}if(Array.isArray(r)){return T.map(r,function(e){return{name:t.name,value:e.replace(Rt,"\r\n")}})}return{name:t.name,value:r.replace(Rt,"\r\n")}}).get()}});var Nt=/%20/g,Mt=/#.*$/,Lt=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Bt=/^(?:GET|HEAD)$/,Ht=/^\/\//,$t={},Wt={},Ut="*/".concat("*"),jt=k.createElement("a");jt.href=Tt.href;function Vt(a){return function(e,t){if(typeof e!=="string"){t=e;e="*"}var r,n=0,i=e.toLowerCase().match(P)||[];if(y(t)){while(r=i[n++]){if(r[0]==="+"){r=r.slice(1)||"*";(a[r]=a[r]||[]).unshift(t)}else{(a[r]=a[r]||[]).push(t)}}}}}function zt(t,i,a,o){var s={},l=t===Wt;function u(e){var n;s[e]=true;T.each(t[e]||[],function(e,t){var r=t(i,a,o);if(typeof r==="string"&&!l&&!s[r]){i.dataTypes.unshift(r);u(r);return false}else if(l){return!(n=r)}});return n}return u(i.dataTypes[0])||!s["*"]&&u("*")}function qt(e,t){var r,n,i=T.ajaxSettings.flatOptions||{};for(r in t){if(t[r]!==undefined){(i[r]?e:n||(n={}))[r]=t[r]}}if(n){T.extend(true,e,n)}return e}function Yt(e,t,r){var n,i,a,o,s=e.contents,l=e.dataTypes;while(l[0]==="*"){l.shift();if(n===undefined){n=e.mimeType||t.getResponseHeader("Content-Type")}}if(n){for(i in s){if(s[i]&&s[i].test(n)){l.unshift(i);break}}}if(l[0]in r){a=l[0]}else{for(i in r){if(!l[0]||e.converters[i+" "+l[0]]){a=i;break}if(!o){o=i}}a=a||o}if(a){if(a!==l[0]){l.unshift(a)}return r[a]}}function Gt(e,t,r,n){var i,a,o,s,l,u={},f=e.dataTypes.slice();if(f[1]){for(o in e.converters){u[o.toLowerCase()]=e.converters[o]}}a=f.shift();while(a){if(e.responseFields[a]){r[e.responseFields[a]]=t}if(!l&&n&&e.dataFilter){t=e.dataFilter(t,e.dataType)}l=a;a=f.shift();if(a){if(a==="*"){a=l}else if(l!=="*"&&l!==a){o=u[l+" "+a]||u["* "+a];if(!o){for(i in u){s=i.split(" ");if(s[1]===a){o=u[l+" "+s[0]]||u["* "+s[0]];if(o){if(o===true){o=u[i]}else if(u[i]!==true){a=s[0];f.unshift(s[1])}break}}}}if(o!==true){if(o&&e.throws){t=o(t)}else{try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+a}}}}}}}return{state:"success",data:t}}T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:Ft.test(Tt.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,t){return t?qt(qt(e,T.ajaxSettings),t):qt(T.ajaxSettings,e)},ajaxPrefilter:Vt($t),ajaxTransport:Vt(Wt),ajax:function(e,t){if(typeof e==="object"){t=e;e=undefined}t=t||{};var f,c,d,r,h,n,v,p,i,a,g=T.ajaxSetup({},t),m=g.context||g,y=g.context&&(m.nodeType||m.jquery)?T(m):T.event,b=T.Deferred(),w=T.Callbacks("once memory"),C=g.statusCode||{},o={},s={},l="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(v){if(!r){r={};while(t=Pt.exec(d)){r[t[1].toLowerCase()+" "]=(r[t[1].toLowerCase()+" "]||[]).concat(t[2])}}t=r[e.toLowerCase()+" "]}return t==null?null:t.join(", ")},getAllResponseHeaders:function(){return v?d:null},setRequestHeader:function(e,t){if(v==null){e=s[e.toLowerCase()]=s[e.toLowerCase()]||e;o[e]=t}return this},overrideMimeType:function(e){if(v==null){g.mimeType=e}return this},statusCode:function(e){var t;if(e){if(v){S.always(e[S.status])}else{for(t in e){C[t]=[C[t],e[t]]}}}return this},abort:function(e){var t=e||l;if(f){f.abort(t)}u(0,t);return this}};b.promise(S);g.url=((e||g.url||Tt.href)+"").replace(Ht,Tt.protocol+"//");g.type=t.method||t.type||g.method||g.type;g.dataTypes=(g.dataType||"*").toLowerCase().match(P)||[""];if(g.crossDomain==null){n=k.createElement("a");try{n.href=g.url;n.href=n.href;g.crossDomain=jt.protocol+"//"+jt.host!==n.protocol+"//"+n.host}catch(e){g.crossDomain=true}}if(g.data&&g.processData&&typeof g.data!=="string"){g.data=T.param(g.data,g.traditional)}zt($t,g,t,S);if(v){return S}p=T.event&&g.global;if(p&&T.active++===0){T.event.trigger("ajaxStart")}g.type=g.type.toUpperCase();g.hasContent=!Bt.test(g.type);c=g.url.replace(Mt,"");if(!g.hasContent){a=g.url.slice(c.length);if(g.data&&(g.processData||typeof g.data==="string")){c+=(xt.test(c)?"&":"?")+g.data;delete g.data}if(g.cache===false){c=c.replace(Lt,"$1");a=(xt.test(c)?"&":"?")+"_="+_t.guid+++a}g.url=c+a}else if(g.data&&g.processData&&(g.contentType||"").indexOf("application/x-www-form-urlencoded")===0){g.data=g.data.replace(Nt,"+")}if(g.ifModified){if(T.lastModified[c]){S.setRequestHeader("If-Modified-Since",T.lastModified[c])}if(T.etag[c]){S.setRequestHeader("If-None-Match",T.etag[c])}}if(g.data&&g.hasContent&&g.contentType!==false||t.contentType){S.setRequestHeader("Content-Type",g.contentType)}S.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+(g.dataTypes[0]!=="*"?", "+Ut+"; q=0.01":""):g.accepts["*"]);for(i in g.headers){S.setRequestHeader(i,g.headers[i])}if(g.beforeSend&&(g.beforeSend.call(m,S,g)===false||v)){return S.abort()}l="abort";w.add(g.complete);S.done(g.success);S.fail(g.error);f=zt(Wt,g,t,S);if(!f){u(-1,"No Transport")}else{S.readyState=1;if(p){y.trigger("ajaxSend",[S,g])}if(v){return S}if(g.async&&g.timeout>0){h=E.setTimeout(function(){S.abort("timeout")},g.timeout)}try{v=false;f.send(o,u)}catch(e){if(v){throw e}u(-1,e)}}function u(e,t,r,n){var i,a,o,s,l,u=t;if(v){return}v=true;if(h){E.clearTimeout(h)}f=undefined;d=n||"";S.readyState=e>0?4:0;i=e>=200&&e<300||e===304;if(r){s=Yt(g,S,r)}if(!i&&T.inArray("script",g.dataTypes)>-1&&T.inArray("json",g.dataTypes)<0){g.converters["text script"]=function(){}}s=Gt(g,s,S,i);if(i){if(g.ifModified){l=S.getResponseHeader("Last-Modified");if(l){T.lastModified[c]=l}l=S.getResponseHeader("etag");if(l){T.etag[c]=l}}if(e===204||g.type==="HEAD"){u="nocontent"}else if(e===304){u="notmodified"}else{u=s.state;a=s.data;o=s.error;i=!o}}else{o=u;if(e||!u){u="error";if(e<0){e=0}}}S.status=e;S.statusText=(t||u)+"";if(i){b.resolveWith(m,[a,u,S])}else{b.rejectWith(m,[S,u,o])}S.statusCode(C);C=undefined;if(p){y.trigger(i?"ajaxSuccess":"ajaxError",[S,g,i?a:o])}w.fireWith(m,[S,u]);if(p){y.trigger("ajaxComplete",[S,g]);if(!--T.active){T.event.trigger("ajaxStop")}}}return S},getJSON:function(e,t,r){return T.get(e,t,r,"json")},getScript:function(e,t){return T.get(e,undefined,t,"script")}});T.each(["get","post"],function(e,i){T[i]=function(e,t,r,n){if(y(t)){n=n||r;r=t;t=undefined}return T.ajax(T.extend({url:e,type:i,dataType:n,data:t,success:r},T.isPlainObject(e)&&e))}});T.ajaxPrefilter(function(e){var t;for(t in e.headers){if(t.toLowerCase()==="content-type"){e.contentType=e.headers[t]||""}}});T._evalUrl=function(e,t,r){return T.ajax({url:e,type:"GET",dataType:"script",cache:true,async:false,global:false,converters:{"text script":function(){}},dataFilter:function(e){T.globalEval(e,t,r)}})};T.fn.extend({wrapAll:function(e){var t;if(this[0]){if(y(e)){e=e.call(this[0])}t=T(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){t.insertBefore(this[0])}t.map(function(){var e=this;while(e.firstElementChild){e=e.firstElementChild}return e}).append(this)}return this},wrapInner:function(r){if(y(r)){return this.each(function(e){T(this).wrapInner(r.call(this,e))})}return this.each(function(){var e=T(this),t=e.contents();if(t.length){t.wrapAll(r)}else{e.append(r)}})},wrap:function(t){var r=y(t);return this.each(function(e){T(this).wrapAll(r?t.call(this,e):t)})},unwrap:function(e){this.parent(e).not("body").each(function(){T(this).replaceWith(this.childNodes)});return this}});T.expr.pseudos.hidden=function(e){return!T.expr.pseudos.visible(e)};T.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};T.ajaxSettings.xhr=function(){try{return new E.XMLHttpRequest}catch(e){}};var Xt={0:200,1223:204},Kt=T.ajaxSettings.xhr();m.cors=!!Kt&&"withCredentials"in Kt;m.ajax=Kt=!!Kt;T.ajaxTransport(function(i){var a,o;if(m.cors||Kt&&!i.crossDomain){return{send:function(e,t){var r,n=i.xhr();n.open(i.type,i.url,i.async,i.username,i.password);if(i.xhrFields){for(r in i.xhrFields){n[r]=i.xhrFields[r]}}if(i.mimeType&&n.overrideMimeType){n.overrideMimeType(i.mimeType)}if(!i.crossDomain&&!e["X-Requested-With"]){e["X-Requested-With"]="XMLHttpRequest"}for(r in e){n.setRequestHeader(r,e[r])}a=function(e){return function(){if(a){a=o=n.onload=n.onerror=n.onabort=n.ontimeout=n.onreadystatechange=null;if(e==="abort"){n.abort()}else if(e==="error"){if(typeof n.status!=="number"){t(0,"error")}else{t(n.status,n.statusText)}}else{t(Xt[n.status]||n.status,n.statusText,(n.responseType||"text")!=="text"||typeof n.responseText!=="string"?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders())}}}};n.onload=a();o=n.onerror=n.ontimeout=a("error");if(n.onabort!==undefined){n.onabort=o}else{n.onreadystatechange=function(){if(n.readyState===4){E.setTimeout(function(){if(a){o()}})}}}a=a("abort");try{n.send(i.hasContent&&i.data||null)}catch(e){if(a){throw e}}},abort:function(){if(a){a()}}}}});T.ajaxPrefilter(function(e){if(e.crossDomain){e.contents.script=false}});T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){T.globalEval(e);return e}}});T.ajaxPrefilter("script",function(e){if(e.cache===undefined){e.cache=false}if(e.crossDomain){e.type="GET"}});T.ajaxTransport("script",function(r){if(r.crossDomain||r.scriptAttrs){var n,i;return{send:function(e,t){n=T("<script>").attr(r.scriptAttrs||{}).prop({charset:r.scriptCharset,src:r.url}).on("load error",i=function(e){n.remove();i=null;if(e){t(e.type==="error"?404:200,e.type)}});k.head.appendChild(n[0])},abort:function(){if(i){i()}}}}});var Jt=[],Qt=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Jt.pop()||T.expando+"_"+_t.guid++;this[e]=true;return e}});T.ajaxPrefilter("json jsonp",function(e,t,r){var n,i,a,o=e.jsonp!==false&&(Qt.test(e.url)?"url":typeof e.data==="string"&&(e.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Qt.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp"){n=e.jsonpCallback=y(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback;if(o){e[o]=e[o].replace(Qt,"$1"+n)}else if(e.jsonp!==false){e.url+=(xt.test(e.url)?"&":"?")+e.jsonp+"="+n}e.converters["script json"]=function(){if(!a){T.error(n+" was not called")}return a[0]};e.dataTypes[0]="json";i=E[n];E[n]=function(){a=arguments};r.always(function(){if(i===undefined){T(E).removeProp(n)}else{E[n]=i}if(e[n]){e.jsonpCallback=t.jsonpCallback;Jt.push(n)}if(a&&y(i)){i(a[0])}a=i=undefined});return"script"}});m.createHTMLDocument=function(){var e=k.implementation.createHTMLDocument("").body;e.innerHTML="<form></form><form></form>";return e.childNodes.length===2}();T.parseHTML=function(e,t,r){if(typeof e!=="string"){return[]}if(typeof t==="boolean"){r=t;t=false}var n,i,a;if(!t){if(m.createHTMLDocument){t=k.implementation.createHTMLDocument("");n=t.createElement("base");n.href=k.location.href;t.head.appendChild(n)}else{t=k}}i=D.exec(e);a=!r&&[];if(i){return[t.createElement(i[1])]}i=Ce([e],t,a);if(a&&a.length){T(a).remove()}return T.merge([],i.childNodes)};T.fn.load=function(e,t,r){var n,i,a,o=this,s=e.indexOf(" ");if(s>-1){n=bt(e.slice(s));e=e.slice(0,s)}if(y(t)){r=t;t=undefined}else if(t&&typeof t==="object"){i="POST"}if(o.length>0){T.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){a=arguments;o.html(n?T("<div>").append(T.parseHTML(e)).find(n):e)}).always(r&&function(e,t){o.each(function(){r.apply(this,a||[e.responseText,t,e])})})}return this};T.expr.pseudos.animated=function(t){return T.grep(T.timers,function(e){return t===e.elem}).length};T.offset={setOffset:function(e,t,r){var n,i,a,o,s,l,u,f=T.css(e,"position"),c=T(e),d={};if(f==="static"){e.style.position="relative"}s=c.offset();a=T.css(e,"top");l=T.css(e,"left");u=(f==="absolute"||f==="fixed")&&(a+l).indexOf("auto")>-1;if(u){n=c.position();o=n.top;i=n.left}else{o=parseFloat(a)||0;i=parseFloat(l)||0}if(y(t)){t=t.call(e,r,T.extend({},s))}if(t.top!=null){d.top=t.top-s.top+o}if(t.left!=null){d.left=t.left-s.left+i}if("using"in t){t.using.call(e,d)}else{c.css(d)}}};T.fn.extend({offset:function(t){if(arguments.length){return t===undefined?this:this.each(function(e){T.offset.setOffset(this,t,e)})}var e,r,n=this[0];if(!n){return}if(!n.getClientRects().length){return{top:0,left:0}}e=n.getBoundingClientRect();r=n.ownerDocument.defaultView;return{top:e.top+r.pageYOffset,left:e.left+r.pageXOffset}},position:function(){if(!this[0]){return}var e,t,r,n=this[0],i={top:0,left:0};if(T.css(n,"position")==="fixed"){t=n.getBoundingClientRect()}else{t=this.offset();r=n.ownerDocument;e=n.offsetParent||r.documentElement;while(e&&(e===r.body||e===r.documentElement)&&T.css(e,"position")==="static"){e=e.parentNode}if(e&&e!==n&&e.nodeType===1){i=T(e).offset();i.top+=T.css(e,"borderTopWidth",true);i.left+=T.css(e,"borderLeftWidth",true)}}return{top:t.top-i.top-T.css(n,"marginTop",true),left:t.left-i.left-T.css(n,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&T.css(e,"position")==="static"){e=e.offsetParent}return e||oe})}});T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var a="pageYOffset"===i;T.fn[t]=function(e){return V(this,function(e,t,r){var n;if(b(e)){n=e}else if(e.nodeType===9){n=e.defaultView}if(r===undefined){return n?n[i]:e[t]}if(n){n.scrollTo(!a?r:n.pageXOffset,a?r:n.pageYOffset)}else{e[t]=r}},t,e,arguments.length)}});T.each(["top","left"],function(e,r){T.cssHooks[r]=Ve(m.pixelPosition,function(e,t){if(t){t=je(e,r);return He.test(t)?T(e).position()[r]+"px":t}})});T.each({Height:"height",Width:"width"},function(o,s){T.each({padding:"inner"+o,content:s,"":"outer"+o},function(n,a){T.fn[a]=function(e,t){var r=arguments.length&&(n||typeof e!=="boolean"),i=n||(e===true||t===true?"margin":"border");return V(this,function(e,t,r){var n;if(b(e)){return a.indexOf("outer")===0?e["inner"+o]:e.document.documentElement["client"+o]}if(e.nodeType===9){n=e.documentElement;return Math.max(e.body["scroll"+o],n["scroll"+o],e.body["offset"+o],n["offset"+o],n["client"+o])}return r===undefined?T.css(e,t,i):T.style(e,t,r,i)},s,r?e:undefined,r)}})});T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){T.fn[t]=function(e){return this.on(t,e)}});T.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",r)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});T.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(e,r){T.fn[r]=function(e,t){return arguments.length>0?this.on(r,null,e,t):this.trigger(r)}});var Zt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;T.proxy=function(e,t){var r,n,i;if(typeof t==="string"){r=e[t];t=e;e=r}if(!y(e)){return undefined}n=s.call(arguments,2);i=function(){return e.apply(t||this,n.concat(s.call(arguments)))};i.guid=e.guid=e.guid||T.guid++;return i};T.holdReady=function(e){if(e){T.readyWait++}else{T.ready(true)}};T.isArray=Array.isArray;T.parseJSON=JSON.parse;T.nodeName=x;T.isFunction=y;T.isWindow=b;T.camelCase=G;T.type=C;T.now=Date.now;T.isNumeric=function(e){var t=T.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))};T.trim=function(e){return e==null?"":(e+"").replace(Zt,"")};if(typeof define==="function"&&define.amd){define("jquery",[],function(){return T})}var er=E.jQuery,tr=E.$;T.noConflict=function(e){if(E.$===T){E.$=tr}if(e&&E.jQuery===T){E.jQuery=er}return T};if(typeof e==="undefined"){E.jQuery=E.$=T}return T});(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(i){var r=[],n=i(document),e=false&&typeof window["XMLHttpRequest"]!=="object",t=false,a=null,o=i(window),d=[];i.alert=function(e,t){return i.alert.impl.init(e,t)};i.alert.close=function(){i.alert.impl.close()};i.alert.focus=function(e){i.alert.impl.focus(e)};i.alert.setContainerDimensions=function(){i.alert.impl.setContainerDimensions()};i.alert.setPosition=function(){i.alert.impl.setPosition()};i.alert.update=function(e,t){i.alert.impl.update(e,t)};i.fn.alert=function(e){return i.alert.impl.init(this,e)};i.alert.defaults={appendTo:"body",focus:true,opacity:50,overlayId:"alertmodal-overlay",overlayCss:{},containerId:"alertmodal-container",containerCss:{},dataId:"alertmodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:false,autoPosition:true,zIndex:20200,close:true,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"alertmodal-close",escClose:false,overlayClose:false,fixed:true,position:null,persist:false,alert:true,onOpen:null,onShow:null,onClose:null};i.alert.impl={d:{},init:function(e,t){var r=this;if(r.d.data){return false}a=!i.boxModel;r.o=i.extend({},i.alert.defaults,t);r.zIndex=r.o.zIndex;r.occb=false;if(typeof e==="object"){e=e instanceof jQuery?e:i(e);r.d.placeholder=false;if(e.parent().parent().length>0){e.before(i("<span></span>").attr("id","alertmodal-placeholder").css({display:"none"}));r.d.placeholder=true;r.display=e.css("display");if(!r.o.persist){r.d.orig=e.clone(true)}}}else{if(typeof e==="string"||typeof e==="number"){e=i("<div></div>").html(e)}else{alert("AlertModal Error: Unsupported data type: "+typeof e);return r}}r.create(e);e=null;r.open();if(i.isFunction(r.o.onShow)){r.o.onShow.apply(r,[r.d])}return r},create:function(e){var t=this;t.getDimensions();if(t.o.alert&&$b.isIE6){t.d.iframe=i('<iframe src="javascript:false;"></iframe>').css(i.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:d[0],width:d[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)}t.d.overlay=i("<div></div>").attr("id",t.o.overlayId).addClass("alertmodal-overlay").css(i.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.alert?r[0]:0,width:t.o.alert?r[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo);t.d.container=i("<div></div>").attr("id",t.o.containerId).addClass("alertmodal-container").css(i.extend({position:"fixed"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})).append(t.o.close&&t.o.closeHTML?i(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo);t.d.wrap=i("<div></div>").attr("tabIndex",-1).addClass("alertmodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container);t.d.data=e.attr("id",e.attr("id")||t.o.dataId).addClass("alertmodal-data").css(i.extend(t.o.dataCss,{display:"none"})).appendTo("body");e=null;t.setContainerDimensions();t.d.data.appendTo(t.d.wrap);if(syn.$b.isIE6){t.fixIE()}},bindEvents:function(){var t=this;i("."+t.o.closeClass).bind("click.alertmodal",function(e){e.preventDefault();t.close()});if(t.o.alert&&t.o.close&&t.o.overlayClose){t.d.overlay.bind("click.alertmodal",function(e){e.preventDefault();t.close()})}n.bind("keydown.alertmodal",function(e){if(t.o.alert&&e.keyCode===9){t.watchTab(e)}else{if(t.o.close&&t.o.escClose&&e.keyCode===27){e.preventDefault();t.close()}}});o.bind("resize.alertmodal orientationchange.alertmodal",function(){t.getDimensions();t.o.autoResize?t.setContainerDimensions():t.o.autoPosition&&t.setPosition();if(syn.$b.isIE6){t.fixIE()}else{if(t.o.alert){t.d.iframe&&t.d.iframe.css({height:d[0],width:d[1]});t.d.overlay.css({height:r[0],width:r[1]})}}})},unbindEvents:function(){i("."+this.o.closeClass).unbind("click.alertmodal");n.unbind("keydown.alertmodal");o.unbind(".alertmodal");this.d.overlay.unbind("click.alertmodal")},fixIE:function(){var e=this,m=e.o.position;i.each([e.d.iframe||null,!e.o.alert?null:e.d.overlay,e.d.container.css("position")==="fixed"?e.d.container:null],function(e,t){if(t){var r="document.body.clientHeight",n="document.body.clientWidth",i="document.body.scrollHeight",a="document.body.scrollLeft",o="document.body.scrollTop",s="document.body.scrollWidth",l="document.documentElement.clientHeight",u="document.documentElement.clientWidth",f="document.documentElement.scrollLeft",c="document.documentElement.scrollTop",d=t[0].style;d.position="absolute";if(e<2){d.removeExpression("height");d.removeExpression("width");d.setExpression("height",""+i+" > "+r+" ? "+i+" : "+r+' + "px"');d.setExpression("width",""+s+" > "+n+" ? "+s+" : "+n+' + "px"')}else{var h,v;if(m&&m.constructor===Array){var p=m[0]?typeof m[0]==="number"?m[0].toString():m[0].replace(/px/,""):t.css("top").replace(/px/,"");h=p.indexOf("%")===-1?p+" + (t = "+c+" ? "+c+" : "+o+') + "px"':parseInt(p.replace(/%/,""))+" * (("+l+" || "+r+") / 100) + (t = "+c+" ? "+c+" : "+o+') + "px"';if(m[1]){var g=typeof m[1]==="number"?m[1].toString():m[1].replace(/px/,"");v=g.indexOf("%")===-1?g+" + (t = "+f+" ? "+f+" : "+a+') + "px"':parseInt(g.replace(/%/,""))+" * (("+u+" || "+n+") / 100) + (t = "+f+" ? "+f+" : "+a+') + "px"'}}else{h="("+l+" || "+r+") / 2 - (this.offsetHeight / 2) + (t = "+c+" ? "+c+" : "+o+') + "px"';v="("+u+" || "+n+") / 2 - (this.offsetWidth / 2) + (t = "+f+" ? "+f+" : "+a+') + "px"'}d.removeExpression("top");d.removeExpression("left");d.setExpression("top",h);d.setExpression("left",v)}}})},focus:function(e){var t=this,r=e&&i.inArray(e,["first","last"])!==-1?e:"first";var n=i(":input:enabled:visible:"+r,t.d.wrap);setTimeout(function(){n.length>0?n.focus():t.d.wrap.focus()},10)},getDimensions:function(){var e=this,t=o.height();r=[n.height(),n.width()];d=[t,o.width()]},getVal:function(e,t){return e?typeof e==="number"?e:e==="auto"?0:e.indexOf("%")>0?parseInt(e.replace(/%/,""))/100*(t==="h"?d[0]:d[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var r=this;if(!r.d.data){return false}r.d.origHeight=r.getVal(e,"h");r.d.origWidth=r.getVal(t,"w");r.d.data.hide();e&&r.d.container.css("height",e);t&&r.d.container.css("width",t);r.setContainerDimensions();r.d.data.show();r.o.focus&&r.focus();r.unbindEvents();r.bindEvents()},setContainerDimensions:function(){var e=this,t=$b.isIE6||$b.isIE7;var r=e.getVal(e.d.container.css("height"),"h"),n=e.getVal(e.d.container.css("width"),"h"),i=e.d.data.outerHeight(true),a=e.d.data.outerWidth(true);e.d.origHeight=e.d.origHeight||r;e.d.origWidth=e.d.origWidth||n;var o=e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null,s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,l=o&&o<d[0]?o:d[0],u=s&&s<d[1]?s:d[1];var f=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto";if(r&&r>f){if(!i){r=f}else{if(i>l){r=l}else{if(e.o.minHeight&&f!=="auto"&&i<f){r=f}else{r=i}}}}else{r=e.o.autoResize&&r>l?l:r<f?f:r}var c=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto";if(n&&n>c){if(!a){n=c}else{if(a>u){n=u}else{if(e.o.minWidth&&c!=="auto"&&a<c){n=c}else{n=a}}}}else{n=e.o.autoResize&&n>u?u:n<c?c:n}e.d.container.css({height:r,width:n});e.d.wrap.css({overflow:i>r||a>n?"auto":"visible"});e.o.autoPosition&&e.setPosition()},setPosition:function(){var e=this,t,r,n=d[0]/2-e.d.container.outerHeight(true)/2,i=d[1]/2-e.d.container.outerWidth(true)/2,a=e.d.container.css("position")!=="fixed"?o.scrollTop():0;if(e.o.position&&Object.prototype.toString.call(e.o.position)==="[object Array]"){t=a+(e.o.position[0]||n);r=e.o.position[1]||i}else{t=a+n;r=i}e.d.container.css({left:r,top:t})},watchTab:function(e){var t=this;if(i(e.target).parents(".alertmodal-container").length>0){t.inputs=i(":input:enabled:visible:first, :input:enabled:visible:last",t.d.data[0]);if(!e.shiftKey&&e.target===t.inputs[t.inputs.length-1]||e.shiftKey&&e.target===t.inputs[0]||t.inputs.length===0){e.preventDefault();var r=e.shiftKey?"last":"first";t.focus(r)}}else{e.preventDefault();t.focus()}},open:function(){var e=this;e.d.iframe&&e.d.iframe.show();if(i.isFunction(e.o.onOpen)){e.o.onOpen.apply(e,[e.d])}else{e.d.overlay.show();e.d.container.show();e.d.data.show()}e.o.focus&&e.focus();e.bindEvents()},close:function(){var e=this;if(!e.d.data){return false}e.unbindEvents();if(i.isFunction(e.o.onClose)&&!e.occb){e.occb=true;e.o.onClose.apply(e,[e.d])}else{if(e.d.placeholder){var t=i("#alertmodal-placeholder");if(e.o.persist){t.replaceWith(e.d.data.removeClass("alertmodal-data").css("display",e.display))}else{e.d.data.hide().remove();t.replaceWith(e.d.orig)}}else{e.d.data.hide().remove()}e.d.container.hide().remove();e.d.overlay.hide();e.d.iframe&&e.d.iframe.hide().remove();e.d.overlay.remove();e.d={}}}}});(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(i){var r=[],n=i(document),a=null,o=i(window),d=[];i.modal=function(e,t){return i.modal.impl.init(e,t)};i.modal.close=function(){i.modal.impl.close()};i.modal.focus=function(e){i.modal.impl.focus(e)};i.modal.setContainerDimensions=function(){i.modal.impl.setContainerDimensions()};i.modal.setPosition=function(){i.modal.impl.setPosition()};i.modal.update=function(e,t){i.modal.impl.update(e,t)};i.fn.modal=function(e){return i.modal.impl.init(this,e)};i.modal.defaults={appendTo:"body",focus:true,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:false,autoPosition:true,zIndex:20100,close:true,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:true,overlayClose:false,fixed:true,position:null,persist:false,modal:true,onOpen:null,onShow:null,onClose:null};i.modal.impl={d:{},init:function(e,t){var r=this;if(r.d.data){return false}a=!i.boxModel;r.o=i.extend({},i.modal.defaults,t);r.zIndex=r.o.zIndex;r.occb=false;if(typeof e==="object"){e=e instanceof jQuery?e:i(e);r.d.placeholder=false;if(e.parent().parent().length>0){e.before(i("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"}));r.d.placeholder=true;r.display=e.css("display");if(!r.o.persist){r.d.orig=e.clone(true)}}}else if(typeof e==="string"||typeof e==="number"){e=i("<div></div>").html(e)}else{alert("SimpleModal Error: Unsupported data type: "+typeof e);return r}r.create(e);e=null;r.open();if(i.isFunction(r.o.onShow)){r.o.onShow.apply(r,[r.d])}return r},create:function(e){var t=this;t.getDimensions();if(t.o.modal&&$b.isIE6){t.d.iframe=i('<iframe src="javascript:false;"></iframe>').css(i.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:d[0],width:d[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)}t.d.overlay=i("<div></div>").attr("id",t.o.overlayId).addClass("simplemodal-overlay").css(i.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.modal?r[0]:0,width:t.o.modal?r[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo);t.d.container=i("<div></div>").attr("id",t.o.containerId).addClass("simplemodal-container").css(i.extend({position:"fixed"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})).append(t.o.close&&t.o.closeHTML?i(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo);t.d.wrap=i("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container);t.d.data=e.attr("id",e.attr("id")||t.o.dataId).addClass("simplemodal-data").css(i.extend(t.o.dataCss,{display:"none"})).appendTo("body");e=null;t.setContainerDimensions();t.d.data.appendTo(t.d.wrap);if(syn.$b.isIE6){t.fixIE()}},bindEvents:function(){var t=this;i("."+t.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault();t.close()});if(t.o.modal&&t.o.close&&t.o.overlayClose){t.d.overlay.bind("click.simplemodal",function(e){e.preventDefault();t.close()})}n.bind("keydown.simplemodal",function(e){if(t.o.modal&&e.keyCode===9){t.watchTab(e)}else if(t.o.close&&t.o.escClose&&e.keyCode===27){e.preventDefault();t.close()}});o.bind("resize.simplemodal orientationchange.simplemodal",function(){t.getDimensions();t.o.autoResize?t.setContainerDimensions():t.o.autoPosition&&t.setPosition();if(syn.$b.isIE6){t.fixIE()}else if(t.o.modal){t.d.iframe&&t.d.iframe.css({height:d[0],width:d[1]});t.d.overlay.css({height:r[0],width:r[1]})}})},unbindEvents:function(){i("."+this.o.closeClass).unbind("click.simplemodal");n.unbind("keydown.simplemodal");o.unbind(".simplemodal");this.d.overlay.unbind("click.simplemodal")},fixIE:function(){return;var e=this,m=e.o.position;i.each([e.d.iframe||null,!e.o.modal?null:e.d.overlay,e.d.container.css("position")==="fixed"?e.d.container:null],function(e,t){if(t){var r="document.body.clientHeight",n="document.body.clientWidth",i="document.body.scrollHeight",a="document.body.scrollLeft",o="document.body.scrollTop",s="document.body.scrollWidth",l="document.documentElement.clientHeight",u="document.documentElement.clientWidth",f="document.documentElement.scrollLeft",c="document.documentElement.scrollTop",d=t[0].style;d.position="absolute";if(e<2){d.removeExpression("height");d.removeExpression("width");d.setExpression("height",""+i+" > "+r+" ? "+i+" : "+r+' + "px"');d.setExpression("width",""+s+" > "+n+" ? "+s+" : "+n+' + "px"')}else{var h,v;if(m&&m.constructor===Array){var p=m[0]?typeof m[0]==="number"?m[0].toString():m[0].replace(/px/,""):t.css("top").replace(/px/,"");h=p.indexOf("%")===-1?p+" + (t = "+c+" ? "+c+" : "+o+') + "px"':parseInt(p.replace(/%/,""))+" * (("+l+" || "+r+") / 100) + (t = "+c+" ? "+c+" : "+o+') + "px"';if(m[1]){var g=typeof m[1]==="number"?m[1].toString():m[1].replace(/px/,"");v=g.indexOf("%")===-1?g+" + (t = "+f+" ? "+f+" : "+a+') + "px"':parseInt(g.replace(/%/,""))+" * (("+u+" || "+n+") / 100) + (t = "+f+" ? "+f+" : "+a+') + "px"'}}else{h="("+l+" || "+r+") / 2 - (this.offsetHeight / 2) + (t = "+c+" ? "+c+" : "+o+') + "px"';v="("+u+" || "+n+") / 2 - (this.offsetWidth / 2) + (t = "+f+" ? "+f+" : "+a+') + "px"'}d.removeExpression("top");d.removeExpression("left");d.setExpression("top",h);d.setExpression("left",v)}}})},focus:function(e){var t=this,r=e&&i.inArray(e,["first","last"])!==-1?e:"first";var n=i(":input:enabled:visible:"+r,t.d.wrap);setTimeout(function(){n.length>0?n.focus():t.d.wrap.focus()},10)},getDimensions:function(){var e=this,t=o.height?o[0].innerHeight:o.height();r=[n.height(),n.width()];d=[t,o.width()]},getVal:function(e,t){return e?typeof e==="number"?e:e==="auto"?0:e.indexOf("%")>0?parseInt(e.replace(/%/,""))/100*(t==="h"?d[0]:d[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var r=this;if(!r.d.data){return false}r.d.origHeight=r.getVal(e,"h");r.d.origWidth=r.getVal(t,"w");r.d.data.hide();e&&r.d.container.css("height",e);t&&r.d.container.css("width",t);r.setContainerDimensions();r.d.data.show();r.o.focus&&r.focus();r.unbindEvents();r.bindEvents()},setContainerDimensions:function(){var e=this,t=$b.isIE6||$b.isIE7;var r=e.getVal(e.d.container.css("height"),"h"),n=e.getVal(e.d.container.css("width"),"h"),i=e.d.data.outerHeight(true),a=e.d.data.outerWidth(true);e.d.origHeight=e.d.origHeight||r;e.d.origWidth=e.d.origWidth||n;var o=e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null,s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,l=o&&o<d[0]?o:d[0],u=s&&s<d[1]?s:d[1];var f=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto";if(r&&r>f){if(!i){r=f}else{if(i>l){r=l}else if(e.o.minHeight&&f!=="auto"&&i<f){r=f}else{r=i}}}else{r=e.o.autoResize&&r>l?l:r<f?f:r}var c=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto";if(n&&n>c){if(!a){n=c}else{if(a>u){n=u}else if(e.o.minWidth&&c!=="auto"&&a<c){n=c}else{n=a}}}else{n=e.o.autoResize&&n>u?u:n<c?c:n}e.d.container.css({height:r,width:n});e.d.wrap.css({overflow:i>r||a>n?"auto":"visible"});e.o.autoPosition&&e.setPosition()},setPosition:function(){var e=this,t,r,n=d[0]/2-e.d.container.outerHeight(true)/2,i=d[1]/2-e.d.container.outerWidth(true)/2,a=e.d.container.css("position")!=="fixed"?o.scrollTop():0;if(e.o.position&&Object.prototype.toString.call(e.o.position)==="[object Array]"){t=a+(e.o.position[0]||n);r=e.o.position[1]||i}else{t=a+n;r=i}e.d.container.css({left:r,top:t})},watchTab:function(e){var t=this;if(i(e.target).parents(".simplemodal-container").length>0){t.inputs=i(":input:enabled:visible:first, :input:enabled:visible:last",t.d.data[0]);if(!e.shiftKey&&e.target===t.inputs[t.inputs.length-1]||e.shiftKey&&e.target===t.inputs[0]||t.inputs.length===0){e.preventDefault();var r=e.shiftKey?"last":"first";t.focus(r)}}else{e.preventDefault();t.focus()}},open:function(){var e=this;e.d.iframe&&e.d.iframe.show();if(i.isFunction(e.o.onOpen)){e.o.onOpen.apply(e,[e.d])}else{e.d.overlay.show();e.d.container.show();e.d.data.show()}e.o.focus&&e.focus();e.bindEvents()},close:function(){var e=this;if(!e.d.data){return false}e.unbindEvents();if(i.isFunction(e.o.onClose)&&!e.occb){e.occb=true;e.o.onClose.apply(e,[e.d])}else{if(e.d.placeholder){var t=i("#simplemodal-placeholder");if(e.o.persist){t.replaceWith(e.d.data.removeClass("simplemodal-data").css("display",e.display))}else{e.d.data.hide().remove();t.replaceWith(e.d.orig)}}else{e.d.data.hide().remove()}e.d.container.hide().remove();e.d.overlay.hide();e.d.iframe&&e.d.iframe.hide().remove();e.d.overlay.remove();e.d={}}}}});(function(i){var w=(false?"paste":"input")+".mask";var C=window.orientation!=undefined;i.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"};i.fn.extend({caret:function(t,r){if(this.length==0)return;if(typeof t=="number"){r=typeof r=="number"?r:t;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(t,r)}else if(this.createTextRange){var e=this.createTextRange();e.collapse(true);e.moveEnd("character",r);e.moveStart("character",t);e.select()}})}else{if(this[0].setSelectionRange){t=this[0].selectionStart;r=this[0].selectionEnd}else if(document.selection&&document.selection.createRange){var e=document.selection.createRange();t=0-e.duplicate().moveStart("character",-1e5);r=t+e.text.length}return{begin:t,end:r}}},unmask:function(){return this.trigger("unmask")},mask:function(r,p){if(!r&&this.length>0){var e=i(this[0]);return e.data(i.mask.dataName)()}p=i.extend({placeholder:"_",completed:null},p);var n=i.mask.definitions;var g=[];var m=r.length;var y=null;var b=r.length;i.each(r.split(""),function(e,t){if(t=="?"){b--;m=e}else if(n[t]){g.push(new RegExp(n[t]));if(y==null)y=g.length-1}else{g.push(null)}});return this.trigger("unmask").each(function(){var o=i(this);var s=i.map(r.split(""),function(e,t){if(e!="?")return n[e]?p.placeholder:e});var a=o.val();function l(e){while(++e<=b&&!g[e]);return e}function u(e){while(--e>=0&&!g[e]);return e}function f(e,t){if(e<0)return;for(var r=e,n=l(t);r<b;r++){if(g[r]){if(n<b&&g[r].test(s[n])){s[r]=s[n];s[n]=p.placeholder}else break;n=l(n)}}h();o.caret(Math.max(y,e))}function c(e){for(var t=e,r=p.placeholder;t<b;t++){if(g[t]){var n=l(t);var i=s[t];s[t]=r;if(n<b&&g[n].test(i))r=i;else break}}}function e(e){var t=e.which;if(t==8||t==46||C&&t==127){var r=o.caret(),n=r.begin,i=r.end;if(i-n==0){n=t!=46?u(n):i=l(n-1);i=t==46?l(i):i}d(n,i);f(n,i-1);return false}else if(t==27){o.val(a);o.caret(0,v());return false}}function t(e){var t=e.which,r=o.caret();if(e.ctrlKey||e.altKey||e.metaKey||t<32){return true}else if(t){if(r.end-r.begin!=0){d(r.begin,r.end);f(r.begin,r.end-1)}var n=l(r.begin-1);if(n<b){var i=String.fromCharCode(t);if(g[n].test(i)){c(n);s[n]=i;h();var a=l(n);o.caret(a);if(p.completed&&a>=b)p.completed.call(o)}}return false}}function d(e,t){for(var r=e;r<t&&r<b;r++){if(g[r])s[r]=p.placeholder}}function h(){return o.val(s.join("")).val()}function v(e){var t=o.val();var r=-1;for(var n=0,i=0;n<b;n++){if(g[n]){s[n]=p.placeholder;while(i++<t.length){var a=t.charAt(i-1);if(g[n].test(a)){s[n]=a;r=n;break}}if(i>t.length)break}else if(s[n]==t.charAt(i)&&n!=m){i++;r=n}}if(!e&&r+1<m){o.val("");d(0,b)}else if(e||r+1>=m){h();if(!e)o.val(o.val().substring(0,r+1))}return m?n:y}o.data(i.mask.dataName,function(){return i.map(s,function(e,t){return g[t]&&e!=p.placeholder?e:null}).join("")});if(!o.attr("readonly"))o.one("unmask",function(){o.unbind(".mask").removeData(i.mask.dataName)}).bind("focus.mask",function(){a=o.val();var e=v();h();var t=function(){if(e==r.length)o.caret(0,e);else o.caret(e)};(false?t:function(){setTimeout(t,0)})()}).bind("blur.mask",function(){v();if(o.val()!=a)o.change()}).bind("keydown.mask",e).bind("keypress.mask",t).bind(w,function(){setTimeout(function(){o.caret(v(true))},0)});v()})}})})(jQuery);(function(f){var n,i,a,r=1e4,o,s=160,c=50,l=navigator.userAgent.match(/MSIE/),d='<div class=window><div class=windowtitlebar><img src=/favicon.ico width=16 height=16 class=titlebaricon><div class=titlebartext></div><div class=horizbuts><div class=minimizebut title="hidden"></div><div class=restorebut style="display:none;" title=restore></div><div class="maximizebut" style="display: none;" title=close></div><div class=closebut title=close></div></div></div><div class=windowcontent></div><div class=resizer-tl></div><div class=resizer-t></div><div class=resizer-tr></div><div class=resizer-r></div><div class=resizer-br></div><div class=resizer-b></div><div class=resizer-bl></div><div class=resizer-l></div></div>',u=f("<div id=resizerproxy>").mousemove(function(e){if(p&1){v.top+=(a-e.pageY)*-1;var t=v.parentH-v.top-v.bottom-o;if(t<0)v.top+=t}else if(p&4){v.bottom+=a-e.pageY;var t=v.parentH-v.top-v.bottom-o;if(t<0)v.bottom+=t}if(p&8){v.left+=(i-e.pageX)*-1;var t=v.parentW-v.left-v.right-s;if(t<0)v.left+=t}else if(p&2){v.right+=i-e.pageX;var t=v.parentW-v.left-v.right-s;if(t<0)v.left+=t}i=e.pageX;a=e.pageY;h.css(v);return false}).mouseup(function(){u.hide();n.css(v).WM_ensure_viewable();n=undefined;return false}),h=f("<div>").appendTo(u),v=null,p=null,g=function(e){var t=this.className.match(/resizer\-(\w+)/);if(t.length!=2)return true;var r=t[1];p=0;if(r[0]=="t")p|=1;else if(r[0]=="b")p|=4;if(r.match(/l/))p|=8;else if(r.match(/r/))p|=2;n=f(this).closest(".window").removeClass("minimized").removeClass("maximized").removeData("oldPos");o=n.find("> .windowtitlebar").height()+5;v=S(n);v.right=v.parentW-n.outerWidth()-v.left;v.bottom=v.parentH-n.outerHeight()-v.top;v.width=v.height="auto";i=e.pageX;a=e.pageY;h.css(v);u.show();return false},m=f("<div id=moverproxy>").mousemove(function(e){y.top+=(a-e.pageY)*-1;y.left+=(i-e.pageX)*-1;i=e.pageX;a=e.pageY;b.css(y);return false}).mouseup(function(){m.hide();n.css(y).WM_ensure_viewable().removeClass("moving");n=undefined;return false}),y={left:0,top:0,right:"auto",bottom:"auto",width:0,height:0},b=f("<div>").appendTo(m),w=0,C=function(e){n=f(this).closest(".window");if(!l)var t=(new Date).getTime();if(t-w<=250){w=0;n.triggerHandler("dblclick");return false}w=t;n.WM_raise();y=S(n);y.width=n.width();y.height=n.height();y.bottom=y.right="auto";b.css(y);m.show();i=e.pageX;a=e.pageY;return false},S=function(e){var t=e.offset();t.top-=f(document).scrollTop();t.left-=f(document).scrollLeft();t.parentW=f(window).width();t.parentH=f(window).height();return t},E=function(e){if(!e.data("oldPos")){var t=S(e);e.data("oldPos",{top:t.top,left:t.left,right:"auto",bottom:"auto",width:e.width(),height:e.height()})}},k=function(){return false},T=function(){f(this).closest(".window").WM_raise();return true},_=function(){f(this).closest(".window").WM_minimize();return false},x=function(){f(this).closest(".window").WM_restore();return false},D=function(){f(this).closest(".window").WM_maximize();return false},R=function(){var e=f(this).closest(".window");var t=e.attr("id");var r=$w.iframeChannels.filter(function(e){return e.elID==t});if(r.length>0){var n=r[0];var e=n.windowHandle;var i=n.channel;i.destroy();var a=e.attr("baseELID");if(a!=""){f("#"+a).closest(".window").WM_raise()}var o=e.attr("id")+"_overlay";f("#"+o).remove();e.WM_close()}return false},e=function(){var e=f(this).closest(".window");if(e.hasClass("maximized"))e.WM_restore();else e.WM_maximize();return false};m[0].onselectstart=k;f.fn.WM_ensure_viewable=function(){this.filter(".window").each(function(){var e=f(this);var t=S(e);if(t.top<0)e.css("top",0);else if(t.parentH-t.top<20)e.css("top",t.parentH-20);if(t.left+e.width()<80)e.css({left:e.width()*-1+80,width:e.width(),right:"auto"});else if(t.parentW-t.left<30)e.css("left",t.parentW-30)});return this};f.fn.WM_minimize=function(){this.each(function(){var e=f(this);if(!e.is(".window"))return true;e.removeClass("maximized");E(e);o=e.find(">.windowtitlebar").height()+5;e.css({left:"auto",top:"auto",right:0,width:300,height:o,zIndex:1e4}).removeClass("focused").addClass("minimized")});f.WM_retileMin();return this};f.WM_retileMin=function(){f(".window.minimized").each(function(e){var t=e*(o+2);if(f(this).css("bottom")!=t)f(this).css("bottom",t)});return this};f.fn.WM_maximize=function(){var t;this.each(function(){var e=f(this);if(!e.is(".window"))return true;if(e.hasClass("minimized")){e.removeClass("minimized");t=1}E(e);e.css({left:0,top:0,bottom:0,right:0,width:"auto",height:"auto"}).WM_raise().addClass("maximized")});if(t)f.WM_retileMin();return this};f.fn.WM_restore=function(){var t;this.each(function(){var e=f(this);if(!e.is(".window"))return true;if(e.hasClass("minimized")){e.removeClass("minimized");t=1}else e.removeClass("maximized");e.css(e.data("oldPos")).removeData("oldPos").WM_ensure_viewable()});if(t)f.WM_retileMin();this.WM_raise();return this};f.fn.WM_raise=function(){var e=this.filter(".window:first");if(e.length==0||e.hasClass("focused"))return this;f(".window.focused").removeClass("focused");e.addClass("focused");var t=e.attr("baseELID");if(t){if(e.attr("id")!=t){e.css("zIndex",++r)}}else{if(t!=""){e.css("zIndex",++r)}}return this};f.fn.WM_close=function(){var t=this.attr("channelID");if(t){var e=$w.iframeChannels.find(function(e){return e.id==t});var r=$w.iframeChannels.indexOf(e);if(r>-1){$w.iframeChannels.splice(r,1)}}return this.filter(".window").remove()};f.WM_open=function(e,t,r,n){if(!n)n={};var i=f(d);i[0].id=e;var a=n.name||n.title||r||t;if(t){a=t.replace(/^https?:\/\/[^\/]+\//,"").replace(/\.\w+$/,"").replace(/[^A-Za-z0-9]/g,"")}if(!a)a="default";i.addClass("windowname_"+a);c+=10;if(c>400){c=50}if(n.width){i.css("width",n.width)}if(n.height){i.css("height",n.height)}if(n.top){i.css("top",n.top)}else{i.css("top",c)}if(n.left){i.css("left",n.left)}else{i.css("left",c)}f(".resizer-tl,.resizer-t,.resizer-tr,.resizer-r,.resizer-br,.resizer-b,"+".resizer-bl,.resizer-l",i).mousedown(g);i.click(T);var o=f(".windowtitlebar",i);o.mousedown(C);var s=o.find("> .horizbuts").mousedown(k).children();s.eq(0).click(_);s.eq(1).click(x);s.eq(2).click(D);s.eq(3).click(R);var l=o.children(".titlebartext").text(n.title||t||"");l[0].onselectstart=k;l[0].unselectable="on";f(window.document.body).append(i);if(!t){}else if(typeof t=="string"){var u=t.match(/^(https?\:\/\/)([^\/]+)/);if(u&&u[2]!=document.location.hostname)i.find(".titlebaricon").attr("src",u[1]+u[2]+"/favicon.ico");f('<iframe src="'+t+'" target="'+r+'"></iframe>'+"<div class=iframecover></div>").appendTo(i.find(".windowcontent"))}else i.find(".windowcontent").append(t);i.WM_raise();return i};f(document).delegate("a","click",function(e){if((!e.button||e.button==0)&&this.target.match(/^\_child\b/)){var t=f(this);window.jQuery.WM_open(this.href,this.target,{title:t.attr("title")||t.text().substr(0,100)});return false}return true});f(window).resize(function(){f(".window").WM_ensure_viewable();return true});f(function(){if(l)f(document.body).addClass("IE");f(document.body).append(m).append(u)})})(jQuery);(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(_){_.ui=_.ui||{};var e=_.ui.version="1.12.1";var r=0;var s=Array.prototype.slice;_.cleanData=function(i){return function(e){var t,r,n;for(n=0;(r=e[n])!=null;n++){try{t=_._data(r,"events");if(t&&t.remove){_(r).triggerHandler("remove")}}catch(e){}}i(e)}}(_.cleanData);_.widget=function(e,r,t){var n,i,a;var o={};var s=e.split(".")[0];e=e.split(".")[1];var l=s+"-"+e;if(!t){t=r;r=_.Widget}if(_.isArray(t)){t=_.extend.apply(null,[{}].concat(t))}_.expr[":"][l.toLowerCase()]=function(e){return!!_.data(e,l)};_[s]=_[s]||{};n=_[s][e];i=_[s][e]=function(e,t){if(!this._createWidget){return new i(e,t)}if(arguments.length){this._createWidget(e,t)}};_.extend(i,n,{version:t.version,_proto:_.extend({},t),_childConstructors:[]});a=new r;a.options=_.widget.extend({},a.options);_.each(t,function(t,a){if(!_.isFunction(a)){o[t]=a;return}o[t]=function(){function n(){return r.prototype[t].apply(this,arguments)}function i(e){return r.prototype[t].apply(this,e)}return function(){var e=this._super;var t=this._superApply;var r;this._super=n;this._superApply=i;r=a.apply(this,arguments);this._super=e;this._superApply=t;return r}}()});i.prototype=_.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},o,{constructor:i,namespace:s,widgetName:e,widgetFullName:l});if(n){_.each(n._childConstructors,function(e,t){var r=t.prototype;_.widget(r.namespace+"."+r.widgetName,i,t._proto)});delete n._childConstructors}else{r._childConstructors.push(i)}_.widget.bridge(e,i);return i};_.widget.extend=function(e){var t=s.call(arguments,1);var r=0;var n=t.length;var i;var a;for(;r<n;r++){for(i in t[r]){a=t[r][i];if(t[r].hasOwnProperty(i)&&a!==undefined){if(_.isPlainObject(a)){e[i]=_.isPlainObject(e[i])?_.widget.extend({},e[i],a):_.widget.extend({},a)}else{e[i]=a}}}}return e};_.widget.bridge=function(a,t){var o=t.prototype.widgetFullName||a;_.fn[a]=function(r){var e=typeof r==="string";var n=s.call(arguments,1);var i=this;if(e){if(!this.length&&r==="instance"){i=undefined}else{this.each(function(){var e;var t=_.data(this,o);if(r==="instance"){i=t;return false}if(!t){return _.error("cannot call methods on "+a+" prior to initialization; "+"attempted to call method '"+r+"'")}if(!_.isFunction(t[r])||r.charAt(0)==="_"){return _.error("no such method '"+r+"' for "+a+" widget instance")}e=t[r].apply(t,n);if(e!==t&&e!==undefined){i=e&&e.jquery?i.pushStack(e.get()):e;return false}})}}else{if(n.length){r=_.widget.extend.apply(null,[r].concat(n))}this.each(function(){var e=_.data(this,o);if(e){e.option(r||{});if(e._init){e._init()}}else{_.data(this,o,new t(r,this))}})}return i}};_.Widget=function(){};_.Widget._childConstructors=[];_.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:false,create:null},_createWidget:function(e,t){t=_(t||this.defaultElement||this)[0];this.element=_(t);this.uuid=r++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=_();this.hoverable=_();this.focusable=_();this.classesElementLookup={};if(t!==this){_.data(t,this.widgetFullName,this);this._on(true,this.element,{remove:function(e){if(e.target===t){this.destroy()}}});this.document=_(t.style?t.ownerDocument:t.document||t);this.window=_(this.document[0].defaultView||this.document[0].parentWindow)}this.options=_.widget.extend({},this.options,this._getCreateOptions(),e);this._create();if(this.options.disabled){this._setOptionDisabled(this.options.disabled)}this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:_.noop,_create:_.noop,_init:_.noop,destroy:function(){var r=this;this._destroy();_.each(this.classesElementLookup,function(e,t){r._removeClass(t,e)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:_.noop,widget:function(){return this.element},option:function(e,t){var r=e;var n;var i;var a;if(arguments.length===0){return _.widget.extend({},this.options)}if(typeof e==="string"){r={};n=e.split(".");e=n.shift();if(n.length){i=r[e]=_.widget.extend({},this.options[e]);for(a=0;a<n.length-1;a++){i[n[a]]=i[n[a]]||{};i=i[n[a]]}e=n.pop();if(arguments.length===1){return i[e]===undefined?null:i[e]}i[e]=t}else{if(arguments.length===1){return this.options[e]===undefined?null:this.options[e]}r[e]=t}}this._setOptions(r);return this},_setOptions:function(e){var t;for(t in e){this._setOption(t,e[t])}return this},_setOption:function(e,t){if(e==="classes"){this._setOptionClasses(t)}this.options[e]=t;if(e==="disabled"){this._setOptionDisabled(t)}return this},_setOptionClasses:function(e){var t,r,n;for(t in e){n=this.classesElementLookup[t];if(e[t]===this.options.classes[t]||!n||!n.length){continue}r=_(n.get());this._removeClass(n,t);r.addClass(this._classes({element:r,keys:t,classes:e,add:true}))}},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e);if(e){this._removeClass(this.hoverable,null,"ui-state-hover");this._removeClass(this.focusable,null,"ui-state-focus")}},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_classes:function(i){var a=[];var o=this;i=_.extend({element:this.element,classes:this.options.classes||{}},i);function e(e,t){var r,n;for(n=0;n<e.length;n++){r=o.classesElementLookup[e[n]]||_();if(i.add){r=_(_.unique(r.get().concat(i.element.get())))}else{r=_(r.not(i.element).get())}o.classesElementLookup[e[n]]=r;a.push(e[n]);if(t&&i.classes[e[n]]){a.push(i.classes[e[n]])}}}this._on(i.element,{remove:"_untrackClassesElement"});if(i.keys){e(i.keys.match(/\S+/g)||[],true)}if(i.extra){e(i.extra.match(/\S+/g)||[])}return a.join(" ")},_untrackClassesElement:function(r){var n=this;_.each(n.classesElementLookup,function(e,t){if(_.inArray(r.target,t)!==-1){n.classesElementLookup[e]=_(t.not(r.target).get())}})},_removeClass:function(e,t,r){return this._toggleClass(e,t,r,false)},_addClass:function(e,t,r){return this._toggleClass(e,t,r,true)},_toggleClass:function(e,t,r,n){n=typeof n==="boolean"?n:r;var i=typeof e==="string"||e===null,a={extra:i?t:r,keys:i?e:t,element:i?this.element:e,add:n};a.element.toggleClass(this._classes(a),n);return this},_on:function(o,s,e){var l;var u=this;if(typeof o!=="boolean"){e=s;s=o;o=false}if(!e){e=s;s=this.element;l=this.widget()}else{s=l=_(s);this.bindings=this.bindings.add(s)}_.each(e,function(e,t){function r(){if(!o&&(u.options.disabled===true||_(this).hasClass("ui-state-disabled"))){return}return(typeof t==="string"?u[t]:t).apply(u,arguments)}if(typeof t!=="string"){r.guid=t.guid=t.guid||r.guid||_.guid++}var n=e.match(/^([\w:-]*)\s*(.*)$/);var i=n[1]+u.eventNamespace;var a=n[2];if(a){l.on(i,a,r)}else{s.on(i,r)}})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.off(t).off(t);this.bindings=_(this.bindings.not(e).get());this.focusable=_(this.focusable.not(e).get());this.hoverable=_(this.hoverable.not(e).get())},_delay:function(e,t){function r(){return(typeof e==="string"?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(r,t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){this._addClass(_(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(_(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){this._addClass(_(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(_(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,t,r){var n,i;var a=this.options[e];r=r||{};t=_.Event(t);t.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();t.target=this.element[0];i=t.originalEvent;if(i){for(n in i){if(!(n in t)){t[n]=i[n]}}}this.element.trigger(t,r);return!(_.isFunction(a)&&a.apply(this.element[0],[t].concat(r))===false||t.isDefaultPrevented())}};_.each({show:"fadeIn",hide:"fadeOut"},function(a,o){_.Widget.prototype["_"+a]=function(t,e,r){if(typeof e==="string"){e={effect:e}}var n;var i=!e?a:e===true||typeof e==="number"?o:e.effect||o;e=e||{};if(typeof e==="number"){e={duration:e}}n=!_.isEmptyObject(e);e.complete=r;if(e.delay){t.delay(e.delay)}if(n&&_.effects&&_.effects.effect[i]){t[a](e)}else if(i!==a&&t[i]){t[i](e.duration,e.easing,r)}else{t.queue(function(e){_(this)[a]();if(r){r.call(t[0])}e()})}}});var t=_.widget;(function(){var i,S=Math.max,E=Math.abs,n=/left|center|right/,a=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,t=_.fn.position;function k(e,t,r){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?r/100:1)]}function T(e,t){return parseInt(_.css(e,t),10)||0}function r(e){var t=e[0];if(t.nodeType===9){return{width:e.width(),height:e.height(),offset:{top:0,left:0}}}if(_.isWindow(t)){return{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}}if(t.preventDefault){return{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}}return{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}_.position={scrollbarWidth:function(){if(i!==undefined){return i}var e,t,r=_("<div "+"style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'>"+"<div style='height:100px;width:auto;'></div></div>"),n=r.children()[0];_("body").append(r);e=n.offsetWidth;r.css("overflow","scroll");t=n.offsetWidth;if(e===t){t=r[0].clientWidth}r.remove();return i=e-t},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),r=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n=t==="scroll"||t==="auto"&&e.width<e.element[0].scrollWidth,i=r==="scroll"||r==="auto"&&e.height<e.element[0].scrollHeight;return{width:i?_.position.scrollbarWidth():0,height:n?_.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=_(e||window),r=_.isWindow(t[0]),n=!!t[0]&&t[0].nodeType===9,i=!r&&!n;return{element:t,isWindow:r,isDocument:n,offset:i?_(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}};_.fn.position=function(c){if(!c||!c.of){return t.apply(this,arguments)}c=_.extend({},c);var d,h,v,p,g,e,m=_(c.of),y=_.position.getWithinInfo(c.within),b=_.position.getScrollInfo(y),w=(c.collision||"flip").split(" "),C={};e=r(m);if(m[0].preventDefault){c.at="left top"}h=e.width;v=e.height;p=e.offset;g=_.extend({},p);_.each(["my","at"],function(){var e=(c[this]||"").split(" "),t,r;if(e.length===1){e=n.test(e[0])?e.concat(["center"]):a.test(e[0])?["center"].concat(e):["center","center"]}e[0]=n.test(e[0])?e[0]:"center";e[1]=a.test(e[1])?e[1]:"center";t=o.exec(e[0]);r=o.exec(e[1]);C[this]=[t?t[0]:0,r?r[0]:0];c[this]=[s.exec(e[0])[0],s.exec(e[1])[0]]});if(w.length===1){w[1]=w[0]}if(c.at[0]==="right"){g.left+=h}else if(c.at[0]==="center"){g.left+=h/2}if(c.at[1]==="bottom"){g.top+=v}else if(c.at[1]==="center"){g.top+=v/2}d=k(C.at,h,v);g.left+=d[0];g.top+=d[1];return this.each(function(){var r,e,o=_(this),s=o.outerWidth(),l=o.outerHeight(),t=T(this,"marginLeft"),n=T(this,"marginTop"),i=s+t+T(this,"marginRight")+b.width,a=l+n+T(this,"marginBottom")+b.height,u=_.extend({},g),f=k(C.my,o.outerWidth(),o.outerHeight());if(c.my[0]==="right"){u.left-=s}else if(c.my[0]==="center"){u.left-=s/2}if(c.my[1]==="bottom"){u.top-=l}else if(c.my[1]==="center"){u.top-=l/2}u.left+=f[0];u.top+=f[1];r={marginLeft:t,marginTop:n};_.each(["left","top"],function(e,t){if(_.ui.position[w[e]]){_.ui.position[w[e]][t](u,{targetWidth:h,targetHeight:v,elemWidth:s,elemHeight:l,collisionPosition:r,collisionWidth:i,collisionHeight:a,offset:[d[0]+f[0],d[1]+f[1]],my:c.my,at:c.at,within:y,elem:o})}});if(c.using){e=function(e){var t=p.left-u.left,r=t+h-s,n=p.top-u.top,i=n+v-l,a={target:{element:m,left:p.left,top:p.top,width:h,height:v},element:{element:o,left:u.left,top:u.top,width:s,height:l},horizontal:r<0?"left":t>0?"right":"center",vertical:i<0?"top":n>0?"bottom":"middle"};if(h<s&&E(t+r)<h){a.horizontal="center"}if(v<l&&E(n+i)<v){a.vertical="middle"}if(S(E(t),E(r))>S(E(n),E(i))){a.important="horizontal"}else{a.important="vertical"}c.using.call(this,e,a)}}o.offset(_.extend(u,{using:e}))})};_.ui.position={fit:{left:function(e,t){var r=t.within,n=r.isWindow?r.scrollLeft:r.offset.left,i=r.width,a=e.left-t.collisionPosition.marginLeft,o=n-a,s=a+t.collisionWidth-i-n,l;if(t.collisionWidth>i){if(o>0&&s<=0){l=e.left+o+t.collisionWidth-i-n;e.left+=o-l}else if(s>0&&o<=0){e.left=n}else{if(o>s){e.left=n+i-t.collisionWidth}else{e.left=n}}}else if(o>0){e.left+=o}else if(s>0){e.left-=s}else{e.left=S(e.left-a,e.left)}},top:function(e,t){var r=t.within,n=r.isWindow?r.scrollTop:r.offset.top,i=t.within.height,a=e.top-t.collisionPosition.marginTop,o=n-a,s=a+t.collisionHeight-i-n,l;if(t.collisionHeight>i){if(o>0&&s<=0){l=e.top+o+t.collisionHeight-i-n;e.top+=o-l}else if(s>0&&o<=0){e.top=n}else{if(o>s){e.top=n+i-t.collisionHeight}else{e.top=n}}}else if(o>0){e.top+=o}else if(s>0){e.top-=s}else{e.top=S(e.top-a,e.top)}}},flip:{left:function(e,t){var r=t.within,n=r.offset.left+r.scrollLeft,i=r.width,a=r.isWindow?r.scrollLeft:r.offset.left,o=e.left-t.collisionPosition.marginLeft,s=o-a,l=o+t.collisionWidth-i-a,u=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,f=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,c=-2*t.offset[0],d,h;if(s<0){d=e.left+u+f+c+t.collisionWidth-i-n;if(d<0||d<E(s)){e.left+=u+f+c}}else if(l>0){h=e.left-t.collisionPosition.marginLeft+u+f+c-a;if(h>0||E(h)<l){e.left+=u+f+c}}},top:function(e,t){var r=t.within,n=r.offset.top+r.scrollTop,i=r.height,a=r.isWindow?r.scrollTop:r.offset.top,o=e.top-t.collisionPosition.marginTop,s=o-a,l=o+t.collisionHeight-i-a,u=t.my[1]==="top",f=u?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,c=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,d=-2*t.offset[1],h,v;if(s<0){v=e.top+f+c+d+t.collisionHeight-i-n;if(v<0||v<E(s)){e.top+=f+c+d}}else if(l>0){h=e.top-t.collisionPosition.marginTop+f+c+d-a;if(h>0||E(h)<l){e.top+=f+c+d}}}},flipfit:{left:function(){_.ui.position.flip.left.apply(this,arguments);_.ui.position.fit.left.apply(this,arguments)},top:function(){_.ui.position.flip.top.apply(this,arguments);_.ui.position.fit.top.apply(this,arguments)}}}})();var n=_.ui.position;var i=_.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};var a=_.fn.extend({uniqueId:function(){var e=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++e}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){_(this).removeAttr("id")}})}});var o=_.ui.safeActiveElement=function(t){var r;try{r=t.activeElement}catch(e){r=t.body}if(!r){r=t.body}if(!r.nodeName){r=t.body}return r};var l=_.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().attr({role:this.options.role,tabIndex:0});this._addClass("ui-menu","ui-widget ui-widget-content");this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(e){var t=_(e.target);var r=_(_.ui.safeActiveElement(this.document[0]));if(!this.mouseHandled&&t.not(".ui-state-disabled").length){this.select(e);if(!e.isPropagationStopped()){this.mouseHandled=true}if(t.has(".ui-menu").length){this.expand(e)}else if(!this.element.is(":focus")&&r.closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer)}}}},"mouseenter .ui-menu-item":function(e){if(this.previousFilter){return}var t=_(e.target).closest(".ui-menu-item"),r=_(e.currentTarget);if(t[0]!==r[0]){return}this._removeClass(r.siblings().children(".ui-state-active"),null,"ui-state-active");this.focus(e,r)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var r=this.active||this.element.find(this.options.items).eq(0);if(!t){this.focus(e,r)}},blur:function(t){this._delay(function(){var e=!_.contains(this.element[0],_.ui.safeActiveElement(this.document[0]));if(e){this.collapseAll(t)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(e){if(this._closeOnDocumentClick(e)){this.collapseAll(e)}this.mouseHandled=false}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),t=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled "+"tabIndex").removeUniqueId().show();t.children().each(function(){var e=_(this);if(e.data("ui-menu-submenu-caret")){e.remove()}})},_keydown:function(e){var t,r,n,i,a=true;switch(e.keyCode){case _.ui.keyCode.PAGE_UP:this.previousPage(e);break;case _.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case _.ui.keyCode.HOME:this._move("first","first",e);break;case _.ui.keyCode.END:this._move("last","last",e);break;case _.ui.keyCode.UP:this.previous(e);break;case _.ui.keyCode.DOWN:this.next(e);break;case _.ui.keyCode.LEFT:this.collapse(e);break;case _.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(e)}break;case _.ui.keyCode.ENTER:case _.ui.keyCode.SPACE:this._activate(e);break;case _.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=false;r=this.previousFilter||"";i=false;n=e.keyCode>=96&&e.keyCode<=105?(e.keyCode-96).toString():String.fromCharCode(e.keyCode);clearTimeout(this.filterTimer);if(n===r){i=true}else{n=r+n}t=this._filterMenuItems(n);t=i&&t.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):t;if(!t.length){n=String.fromCharCode(e.keyCode);t=this._filterMenuItems(n)}if(t.length){this.focus(e,t);this.previousFilter=n;this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)}else{delete this.previousFilter}}if(a){e.preventDefault()}},_activate:function(e){if(this.active&&!this.active.is(".ui-state-disabled")){if(this.active.children("[aria-haspopup='true']").length){this.expand(e)}else{this.select(e)}}},refresh:function(){var e,t,r,n,i,a=this,o=this.options.icons.submenu,s=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length);r=s.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=_(this),t=e.prev(),r=_("<span>").data("ui-menu-submenu-caret",true);a._addClass(r,"ui-menu-icon","ui-icon "+o);t.attr("aria-haspopup","true").prepend(r);e.attr("aria-labelledby",t.attr("id"))});this._addClass(r,"ui-menu","ui-widget ui-widget-content ui-front");e=s.add(this.element);t=e.find(this.options.items);t.not(".ui-menu-item").each(function(){var e=_(this);if(a._isDivider(e)){a._addClass(e,"ui-menu-divider","ui-widget-content")}});n=t.not(".ui-menu-item, .ui-menu-divider");i=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()});this._addClass(n,"ui-menu-item")._addClass(i,"ui-menu-item-wrapper");t.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!_.contains(this.element[0],this.active[0])){this.blur()}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if(e==="icons"){var r=this.element.find(".ui-menu-icon");this._removeClass(r,null,this.options.icons.submenu)._addClass(r,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",String(e));this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var r,n,i;this.blur(e,e&&e.type==="focus");this._scrollIntoView(t);this.active=t.first();n=this.active.children(".ui-menu-item-wrapper");this._addClass(n,null,"ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",n.attr("id"))}i=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper");this._addClass(i,null,"ui-state-active");if(e&&e.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}r=t.children(".ui-menu");if(r.length&&e&&/^mouse/.test(e.type)){this._startOpening(r)}this.activeMenu=t.parent();this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,r,n,i,a,o;if(this._hasScroll()){t=parseFloat(_.css(this.activeMenu[0],"borderTopWidth"))||0;r=parseFloat(_.css(this.activeMenu[0],"paddingTop"))||0;n=e.offset().top-this.activeMenu.offset().top-t-r;i=this.activeMenu.scrollTop();a=this.activeMenu.height();o=e.outerHeight();if(n<0){this.activeMenu.scrollTop(i+n)}else if(n+o>a){this.activeMenu.scrollTop(i+n-a+o)}}},blur:function(e,t){if(!t){clearTimeout(this.timer)}if(!this.active){return}this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active");this._trigger("blur",e,{item:this.active});this.active=null},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(e)},this.delay)},_open:function(e){var t=_.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true");e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,r){clearTimeout(this.timer);this.timer=this._delay(function(){var e=r?this.element:_(t&&t.target).closest(this.element.find(".ui-menu"));if(!e.length){e=this.element}this._close(e);this.blur(t);this._removeClass(e.find(".ui-state-active"),null,"ui-state-active");this.activeMenu=e},this.delay)},_close:function(e){if(!e){e=this.active?this.active.parent():this.element}e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!_(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(t&&t.length){this._close();this.focus(e,t)}},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();if(t&&t.length){this._open(t.parent());this._delay(function(){this.focus(e,t)})}},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,r){var n;if(this.active){if(e==="first"||e==="last"){n=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1)}else{n=this.active[e+"All"](".ui-menu-item").eq(0)}}if(!n||!n.length||!this.active){n=this.activeMenu.find(this.options.items)[t]()}this.focus(r,n)},nextPage:function(e){var t,r,n;if(!this.active){this.next(e);return}if(this.isLastItem()){return}if(this._hasScroll()){r=this.active.offset().top;n=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){t=_(this);return t.offset().top-r-n<0});this.focus(e,t)}else{this.focus(e,this.activeMenu.find(this.options.items)[!this.active?"first":"last"]())}},previousPage:function(e){var t,r,n;if(!this.active){this.next(e);return}if(this.isFirstItem()){return}if(this._hasScroll()){r=this.active.offset().top;n=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){t=_(this);return t.offset().top-r+n>0});this.focus(e,t)}else{this.focus(e,this.activeMenu.find(this.options.items).first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||_(e.target).closest(".ui-menu-item");var t={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(e,true)}this._trigger("select",e,t)},_filterMenuItems:function(e){var t=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),r=new RegExp("^"+t,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return r.test(_.trim(_(this).children(".ui-menu-item-wrapper").text()))})}})});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","jquery-ui/ui/widgets/menu"],e)}else{e(jQuery)}})(function(u){"use strict";var i="onselectstart"in document.createElement("div"),e=u.ui.menu.version.match(/^(\d)\.(\d+)/),t={major:parseInt(e[1],10),minor:parseInt(e[2],10)},a=t.major<2&&t.minor<=10,o=t.major<2&&t.minor<=11;u.widget("moogle.contextmenu",{version:"@VERSION",options:{addClass:"ui-contextmenu",closeOnWindowBlur:true,autoFocus:false,autoTrigger:true,delegate:null,hide:{effect:"fadeOut",duration:"fast"},ignoreParentSelect:true,menu:null,position:null,preventContextMenuForPopup:false,preventSelect:false,show:{effect:"slideDown",duration:"fast"},taphold:false,uiMenuOptions:{},beforeOpen:u.noop,blur:u.noop,close:u.noop,create:u.noop,createMenu:u.noop,focus:u.noop,open:u.noop,select:u.noop},_create:function(){var t,e,r,n=this.options;this.$headStyle=null;this.$menu=null;this.menuIsTemp=false;this.currentTarget=null;this.extraData={};this.previousFocus=null;if(n.delegate==null){u.error("ui-contextmenu: Missing required option `delegate`.")}if(n.preventSelect){r=(u(this.element).is(document)?u("body"):this.element).uniqueId().attr("id");t="#"+r+" "+n.delegate+" { "+"-webkit-user-select: none; "+"-khtml-user-select: none; "+"-moz-user-select: none; "+"-ms-user-select: none; "+"user-select: none; "+"}";this.$headStyle=u("<style class='moogle-contextmenu-style' />").prop("type","text/css").appendTo("head");try{this.$headStyle.html(t)}catch(e){this.$headStyle[0].styleSheet.cssText=t}if(i){this.element.on("selectstart"+this.eventNamespace,n.delegate,function(e){e.preventDefault()})}}this._createUiMenu(n.menu);e="contextmenu"+this.eventNamespace;if(n.taphold){e+=" taphold"+this.eventNamespace}this.element.on(e,n.delegate,u.proxy(this._openMenu,this))},_destroy:function(){this.element.off(this.eventNamespace);this._createUiMenu(null);if(this.$headStyle){this.$headStyle.remove();this.$headStyle=null}},_createUiMenu:function(e){var t,r,a=this.options;if(this.isOpen()){t=this.currentTarget;r=this.extraData;this._closeMenu(true);this.currentTarget=t;this.extraData=r}if(this.menuIsTemp){this.$menu.remove()}else if(this.$menu){this.$menu.menu("destroy").removeClass(this.options.addClass).hide()}this.$menu=null;this.menuIsTemp=false;if(!e){return}else if(u.isArray(e)){this.$menu=u.moogle.contextmenu.createMenuMarkup(e);this.menuIsTemp=true}else if(typeof e==="string"){this.$menu=u(e)}else{this.$menu=e}this.$menu.hide().addClass(a.addClass).menu(u.extend(true,{},a.uiMenuOptions,{items:"> :not(.ui-widget-header)",blur:u.proxy(a.blur,this),create:u.proxy(a.createMenu,this),focus:u.proxy(a.focus,this),select:u.proxy(function(e,t){var r,n=u.moogle.contextmenu.isMenu(t.item),i=t.item.data("actionHandler");t.cmd=t.item.attr("data-command");t.target=u(this.currentTarget);t.extraData=this.extraData;if(!n||!a.ignoreParentSelect){r=this._trigger.call(this,"select",e,t);if(i){r=i.call(this,e,t)}if(r!==false){this._closeMenu.call(this)}e.preventDefault()}},this)}))},_openMenu:function(t,e){var r,n,i,a=this.options,o=a.position,s=this,l=!!t.isTrigger;if(!a.autoTrigger&&!l){return}t.preventDefault();this.currentTarget=t.target;this.extraData=t._extraData||{};i={menu:this.$menu,target:u(this.currentTarget),extraData:this.extraData,originalEvent:t,result:null};if(!e){r=this._trigger("beforeOpen",t,i);n=i.result&&u.isFunction(i.result.promise)?i.result:null;i.result=null;if(r===false){this.currentTarget=null;return false}else if(n){n.done(function(){s._openMenu(t,true)});this.currentTarget=null;return false}i.menu=this.$menu}u(document).on("keydown"+this.eventNamespace,function(e){if(e.which===u.ui.keyCode.ESCAPE){s._closeMenu()}}).on("mousedown"+this.eventNamespace+" touchstart"+this.eventNamespace,function(e){if(!u(e.target).closest(".ui-menu-item").length){s._closeMenu()}});u(window).on("blur"+this.eventNamespace,function(e){if(a.closeOnWindowBlur){s._closeMenu()}});if(u.isFunction(o)){o=o(t,i)}o=u.extend({my:"left top",at:"left bottom",of:t.pageX===undefined?t.target:t,collision:"fit"},o);this._updateEntries(this.$menu);this.$menu.show().css({position:"absolute",left:0,top:0}).position(o).hide();if(a.preventContextMenuForPopup){this.$menu.on("contextmenu"+this.eventNamespace,function(e){e.preventDefault()})}this._show(this.$menu,a.show,function(){var e;if(a.autoFocus){s.previousFocus=u(t.target);e=s.$menu.children("li.ui-menu-item").not(".ui-state-disabled").first();s.$menu.menu("focus",null,e).focus()}s._trigger.call(s,"open",t,i)})},_closeMenu:function(e){var t=this,r=e?false:this.options.hide,n={menu:this.$menu,target:u(this.currentTarget),extraData:this.extraData};u(document).off("mousedown"+this.eventNamespace).off("touchstart"+this.eventNamespace).off("keydown"+this.eventNamespace);u(window).off("blur"+this.eventNamespace);t.currentTarget=null;t.extraData={};if(this.$menu){this.$menu.off("contextmenu"+this.eventNamespace);this._hide(this.$menu,r,function(){if(t.previousFocus){t.previousFocus.focus();t.previousFocus=null}t._trigger("close",null,n)})}else{t._trigger("close",null,n)}},_setOption:function(e,t){switch(e){case"menu":this.replaceMenu(t);break}u.Widget.prototype._setOption.apply(this,arguments)},_getMenuEntry:function(e){return this.$menu.find("li[data-command="+e+"]")},close:function(){if(this.isOpen()){this._closeMenu()}},_updateEntries:function(){var a=this,o={menu:this.$menu,target:u(this.currentTarget),extraData:this.extraData};u.each(this.$menu.find(".ui-menu-item"),function(e,t){var r=u(t),n=r.data("disabledHandler"),i=n?n({type:"disabled"},o):null;o.item=r;o.cmd=r.attr("data-command");if(i!=null){a.enableEntry(o.cmd,!i);a.showEntry(o.cmd,i!=="hide")}n=r.data("titleHandler"),i=n?n({type:"title"},o):null;if(i!=null){a.setTitle(o.cmd,""+i)}n=r.data("tooltipHandler"),i=n?n({type:"tooltip"},o):null;if(i!=null){r.attr("title",""+i)}})},enableEntry:function(e,t){this._getMenuEntry(e).toggleClass("ui-state-disabled",t===false)},getEntry:function(e){return this._getMenuEntry(e)},getEntryWrapper:function(e){return this._getMenuEntry(e).find(">[role=menuitem]").addBack("[role=menuitem]")},getMenu:function(){return this.$menu},isOpen:function(){return!!this.$menu&&!!this.currentTarget},open:function(e,t){t=t||{};var r=e&&e.type&&e.target,n=r?e:{},i=r?e.target:e,a=jQuery.Event("contextmenu",{target:u(i).get(0),pageX:n.pageX,pageY:n.pageY,originalEvent:r?e:undefined,_extraData:t});return this.element.trigger(a)},replaceMenu:function(e){this._createUiMenu(e)},setEntry:function(e,t){var r,n=this._getMenuEntry(e);if(typeof t==="string"){window.console&&window.console.warn("setEntry(cmd, t) with a plain string title is deprecated since v1.18."+"Use setTitle(cmd, '"+t+"') instead.");return this.setTitle(e,t)}n.empty();t.cmd=t.cmd||e;u.moogle.contextmenu.createEntryMarkup(t,n);if(u.isArray(t.children)){r=u("<ul/>").appendTo(n);u.moogle.contextmenu.createMenuMarkup(t.children,r)}n.removeClass("ui-menu-item");this.getMenu().menu("refresh")},setIcon:function(e,t){return this.updateEntry(e,{uiIcon:t})},setTitle:function(e,t){return this.updateEntry(e,{title:t})},showEntry:function(e,t){this._getMenuEntry(e).toggle(t!==false)},updateEntry:function(e,t){var r,n,i=this._getMenuEntry(e);if(t.title!==undefined){u.moogle.contextmenu.updateTitle(i,""+t.title)}if(t.tooltip!==undefined){if(t.tooltip===null){i.removeAttr("title")}else{i.attr("title",t.tooltip)}}if(t.uiIcon!==undefined){n=this.getEntryWrapper(e),r=n.find("span.ui-icon").not(".ui-menu-icon");r.remove();if(t.uiIcon){n.append(u("<span class='ui-icon' />").addClass(t.uiIcon))}}if(t.hide!==undefined){i.toggle(!t.hide)}else if(t.show!==undefined){i.toggle(!!t.show)}if(t.data!==undefined){i.data(t.data)}if(t.disabled===undefined){t.disabled=i.hasClass("ui-state-disabled")}if(t.setClass){if(i.hasClass("ui-menu-item")){t.setClass+=" ui-menu-item"}i.removeClass();i.addClass(t.setClass)}else if(t.addClass){i.addClass(t.addClass)}i.toggleClass("ui-state-disabled",!!t.disabled)}});u.extend(u.moogle.contextmenu,{createEntryMarkup:function(r,n){var e=null;n.attr("data-command",r.cmd);if(!/[^\-\u2014\u2013\s]/.test(r.title)){n.text(r.title)}else{if(a){e=u("<a/>",{html:""+r.title,href:"#"}).appendTo(n)}else if(o){n.html(""+r.title);e=n}else{e=u("<div/>",{html:""+r.title}).appendTo(n)}if(r.uiIcon){e.append(u("<span class='ui-icon' />").addClass(r.uiIcon))}u.each(["action","disabled","title","tooltip"],function(e,t){if(u.isFunction(r[t])){n.data(t+"Handler",r[t])}});if(r.disabled===true){n.addClass("ui-state-disabled")}if(r.isHeader){n.addClass("ui-widget-header")}if(r.addClass){n.addClass(r.addClass)}if(u.isPlainObject(r.data)){n.data(r.data)}if(typeof r.tooltip==="string"){n.attr("title",r.tooltip)}}},createMenuMarkup:function(e,t){var r,n,i,a;if(t==null){t=u("<ul class='ui-helper-hidden' />").appendTo("body")}for(r=0;r<e.length;r++){n=e[r];a=u("<li/>").appendTo(t);u.moogle.contextmenu.createEntryMarkup(n,a);if(u.isArray(n.children)){i=u("<ul/>").appendTo(a);u.moogle.contextmenu.createMenuMarkup(n.children,i)}}return t},isMenu:function(e){if(a){return e.has(">a[aria-haspopup='true']").length>0}else if(o){return e.is("[aria-haspopup='true']")}else{return e.has(">div[aria-haspopup='true']").length>0}},replaceFirstTextNodeChild:function(e,t){var r=e.find(">span.ui-icon,>ul.ui-menu").detach();e.empty().html(t).append(r)},updateTitle:function(e,t){if(a){u.moogle.contextmenu.replaceFirstTextNodeChild(u("a",e),t)}else if(o){u.moogle.contextmenu.replaceFirstTextNodeChild(e,t)}else{u.moogle.contextmenu.replaceFirstTextNodeChild(u("div",e),t)}}})});"use strict";(function(e){if(typeof module==="object"&&typeof module.exports==="object"){e(require("jquery"),window,document)}else{e(jQuery,window,document)}})(function(h,v,p,u){var t=function(e,t){this.$chartContainer=h(e);this.opts=t;this.defaultOptions={nodeTitle:"name",nodeId:"id",toggleSiblingsResp:false,visibleLevel:999,chartClass:"",exportButton:false,exportButtonName:"Export",exportFilename:"OrgChart",exportFileextension:"png",parentNodeSymbol:"oci-leader",draggable:false,direction:"t2b",pan:false,zoom:false,zoominLimit:7,zoomoutLimit:.5}};t.prototype={init:function(e){var n=this;this.options=h.extend({},this.defaultOptions,this.opts,e);var t=this.$chartContainer;if(this.$chart){this.$chart.remove()}var r=this.options.data;var i=this.$chart=h("<div>",{data:{options:this.options},class:"orgchart"+(this.options.chartClass!==""?" "+this.options.chartClass:"")+(this.options.direction!=="t2b"?" "+this.options.direction:""),click:function(e){if(!h(e.target).closest(".node").length){i.find(".node.focused").removeClass("focused")}}});if(typeof MutationObserver!=="undefined"){this.triggerInitEvent()}var a=i.append(h('<ul class="nodes"><li class="hierarchy"></li></ul>')).find(".hierarchy");if(h.type(r)==="object"){if(r instanceof h){this.buildHierarchy(a,this.buildJsonDS(r.children()),0,this.options)}else{this.buildHierarchy(a,this.options.ajaxURL?r:this.attachRel(r,"00"))}}else{i.append('<i class="oci oci-spinner spinner"></i>');h.ajax({url:r,dataType:"json"}).done(function(e,t,r){n.buildHierarchy(a,n.options.ajaxURL?e:n.attachRel(e,"00"),0,n.options)}).fail(function(e,t,r){console.log(r)}).always(function(){i.children(".spinner").remove()})}t.append(i);if(this.options.exportButton&&!h(".oc-export-btn").length){this.attachExportButton()}if(this.options.pan){this.bindPan()}if(this.options.zoom){this.bindZoom()}return this},triggerInitEvent:function(){var i=this;var a=new MutationObserver(function(e){a.disconnect();e:for(var t=0;t<e.length;t++){for(var r=0;r<e[t].addedNodes.length;r++){if(e[t].addedNodes[r].classList.contains("orgchart")){if(i.options.initCompleted&&typeof i.options.initCompleted==="function"){i.options.initCompleted(i.$chart)}var n=h.Event("init.orgchart");i.$chart.trigger(n);break e}}}});a.observe(this.$chartContainer[0],{childList:true})},triggerLoadEvent:function(e,t){var r=h.Event("load-"+t+".orgchart");e.trigger(r)},triggerShowEvent:function(e,t){var r=h.Event("show-"+t+".orgchart");e.trigger(r)},triggerHideEvent:function(e,t){var r=h.Event("hide-"+t+".orgchart");e.trigger(r)},attachExportButton:function(){var t=this;var e=h("<button>",{class:"oc-export-btn",text:this.options.exportButtonName,click:function(e){e.preventDefault();t.export()}});this.$chartContainer.after(e)},setOptions:function(e,t){if(typeof e==="string"){if(e==="pan"){if(t){this.bindPan()}else{this.unbindPan()}}if(e==="zoom"){if(t){this.bindZoom()}else{this.unbindZoom()}}}if(typeof e==="object"){if(e.data){this.init(e)}else{if(typeof e.pan!=="undefined"){if(e.pan){this.bindPan()}else{this.unbindPan()}}if(typeof e.zoom!=="undefined"){if(e.zoom){this.bindZoom()}else{this.unbindZoom()}}}}return this},panStartHandler:function(e){var a=h(e.delegateTarget);if(h(e.target).closest(".node").length||e.touches&&e.touches.length>1){a.data("panning",false);return}else{a.css("cursor","move").data("panning",true)}var t=0;var r=0;var n=a.css("transform");if(n!=="none"){var i=n.split(",");if(n.indexOf("3d")===-1){t=parseInt(i[4]);r=parseInt(i[5])}else{t=parseInt(i[12]);r=parseInt(i[13])}}var o=0;var s=0;if(!e.targetTouches){o=e.pageX-t;s=e.pageY-r}else if(e.targetTouches.length===1){o=e.targetTouches[0].pageX-t;s=e.targetTouches[0].pageY-r}else if(e.targetTouches.length>1){return}a.on("mousemove touchmove",function(e){if(!a.data("panning")){return}var t=0;var r=0;if(!e.targetTouches){t=e.pageX-o;r=e.pageY-s}else if(e.targetTouches.length===1){t=e.targetTouches[0].pageX-o;r=e.targetTouches[0].pageY-s}else if(e.targetTouches.length>1){return}var n=a.css("transform");if(n==="none"){if(n.indexOf("3d")===-1){a.css("transform","matrix(1, 0, 0, 1, "+t+", "+r+")")}else{a.css("transform","matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+r+", 0, 1)")}}else{var i=n.split(",");if(n.indexOf("3d")===-1){i[4]=" "+t;i[5]=" "+r+")"}else{i[12]=" "+t;i[13]=" "+r}a.css("transform",i.join(","))}})},panEndHandler:function(e){if(e.data.chart.data("panning")){e.data.chart.data("panning",false).css("cursor","default").off("mousemove")}},bindPan:function(){this.$chartContainer.css("overflow","hidden");this.$chart.on("mousedown touchstart",this.panStartHandler);h(p).on("mouseup touchend",{chart:this.$chart},this.panEndHandler)},unbindPan:function(){this.$chartContainer.css("overflow","auto");this.$chart.off("mousedown touchstart",this.panStartHandler);h(p).off("mouseup touchend",this.panEndHandler)},zoomWheelHandler:function(e){var t=e.data.oc;e.preventDefault();var r=1+(e.originalEvent.deltaY>0?-.2:.2);t.setChartScale(t.$chart,r)},zoomStartHandler:function(e){if(e.touches&&e.touches.length===2){var t=e.data.oc;t.$chart.data("pinching",true);var r=t.getPinchDist(e);t.$chart.data("pinchDistStart",r)}},zoomingHandler:function(e){var t=e.data.oc;if(t.$chart.data("pinching")){var r=t.getPinchDist(e);t.$chart.data("pinchDistEnd",r)}},zoomEndHandler:function(e){var t=e.data.oc;if(t.$chart.data("pinching")){t.$chart.data("pinching",false);var r=t.$chart.data("pinchDistEnd")-t.$chart.data("pinchDistStart");if(r>0){t.setChartScale(t.$chart,1.2)}else if(r<0){t.setChartScale(t.$chart,.8)}}},bindZoom:function(){this.$chartContainer.on("wheel",{oc:this},this.zoomWheelHandler);this.$chartContainer.on("touchstart",{oc:this},this.zoomStartHandler);h(p).on("touchmove",{oc:this},this.zoomingHandler);h(p).on("touchend",{oc:this},this.zoomEndHandler)},unbindZoom:function(){this.$chartContainer.off("wheel",this.zoomWheelHandler);this.$chartContainer.off("touchstart",this.zoomStartHandler);h(p).off("touchmove",this.zoomingHandler);h(p).off("touchend",this.zoomEndHandler)},getPinchDist:function(e){return Math.sqrt((e.touches[0].clientX-e.touches[1].clientX)*(e.touches[0].clientX-e.touches[1].clientX)+(e.touches[0].clientY-e.touches[1].clientY)*(e.touches[0].clientY-e.touches[1].clientY))},setChartScale:function(e,t){var r=e.data("options");var n=e.css("transform");var i="";var a=1;if(n==="none"){e.css("transform","scale("+t+","+t+")")}else{i=n.split(",");if(n.indexOf("3d")===-1){a=Math.abs(v.parseFloat(i[3])*t);if(a>r.zoomoutLimit&&a<r.zoominLimit){e.css("transform",n+" scale("+t+","+t+")")}}else{a=Math.abs(v.parseFloat(i[1])*t);if(a>r.zoomoutLimit&&a<r.zoominLimit){e.css("transform",n+" scale3d("+t+","+t+", 1)")}}}},buildJsonDS:function(e){var t=this;var r={name:e.contents().eq(0).text().trim(),relationship:(e.parent().parent().is("li")?"1":"0")+(e.siblings("li").length?1:0)+(e.children("ul").length?1:0)};h.each(e.data(),function(e,t){r[e]=t});e.children("ul").children().each(function(){if(!r.children){r.children=[]}r.children.push(t.buildJsonDS(h(this)))});return r},attachRel:function(t,e){var r=this;t.relationship=e+(t.children&&t.children.length>0?1:0);if(t.children){t.children.forEach(function(e){r.attachRel(e,"1"+(t.children.length>1?1:0))})}return t},loopChart:function(e,t){t=t!==null&&t!==u?t:false;var r=this;var n=e.find(".node:first");var i={id:n[0].id};if(t){h.each(n.data("nodeData"),function(e,t){i[e]=t})}n.siblings(".nodes").children().each(function(){if(!i.children){i.children=[]}i.children.push(r.loopChart(h(this),t))});return i},getHierarchy:function(e){e=e!==null&&e!==u?e:false;if(typeof this.$chart==="undefined"){return"Error: orgchart does not exist"}else{if(!this.$chart.find(".node").length){return"Error: nodes do not exist"}else{var t=true;this.$chart.find(".node").each(function(){if(!this.id){t=false;return false}});if(!t){return"Error: All nodes of orghcart to be exported must have data-id attribute!"}}}return this.loopChart(this.$chart,e)},getNodeState:function(e,t){var r={};var n=!!e.closest("vertical").length;var t=t||"self";if(t==="parent"){if(n){r=e.closest("ul").parents("ul");if(!r.length){r=e.closest(".nodes");if(!r.length){r=e.closest(".vertical").siblings(":first")}}}else{r=e.closest(".nodes").siblings(".node")}if(r.length){if(r.is(".hidden")||!r.is(".hidden")&&r.closest(".nodes").is(".hidden")||!r.is(".hidden")&&r.closest(".vertical").is(".hidden")){return{exist:true,visible:false}}return{exist:true,visible:true}}}else if(t==="children"){r=n?e.parent().children("ul"):e.siblings(".nodes");if(r.length){if(!r.is(".hidden")){return{exist:true,visible:true}}return{exist:true,visible:false}}}else if(t==="siblings"){r=n?e.closest("ul"):e.parent().siblings();if(r.length&&(!n||r.children("li").length>1)){if(!r.is(".hidden")&&!r.parent().is(".hidden")&&(!n||!r.closest(".vertical").is(".hidden"))){return{exist:true,visible:true}}return{exist:true,visible:false}}}else{r=e;if(r.length){if(!(r.closest(".nodes").length&&r.closest(".nodes").is(".hidden")||r.closest(".hierarchy").length&&r.closest(".hierarchy").is(".hidden")||r.closest(".vertical").length&&(r.closest(".nodes").is(".hidden")||r.closest(".vertical").is(".hidden")))){return{exist:true,visible:true}}return{exist:true,visible:false}}}return{exist:false,visible:false}},getRelatedNodes:function(e,t){if(!e||!(e instanceof h)||!e.is(".node")){return h()}if(t==="parent"){return e.closest(".nodes").siblings(".node")}else if(t==="children"){return e.siblings(".nodes").children(".hierarchy").find(".node:first")}else if(t==="siblings"){return e.closest(".hierarchy").siblings().find(".node:first")}else{return h()}},hideParentEnd:function(e){h(e.target).removeClass("sliding");e.data.parent.addClass("hidden")},hideParent:function(e){var t=e.closest(".nodes").siblings(".node");if(t.find(".spinner").length){e.closest(".orgchart").data("inAjax",false)}if(this.getNodeState(e,"siblings").visible){this.hideSiblings(e)}e.parent().addClass("isAncestorsCollapsed");if(this.getNodeState(t).visible){t.addClass("sliding slide-down").one("transitionend",{parent:t},this.hideParentEnd)}if(this.getNodeState(t,"parent").visible){this.hideParent(t)}},showParentEnd:function(e){var t=e.data.node;h(e.target).removeClass("sliding");if(this.isInAction(t)){this.switchVerticalArrow(t.children(".topEdge"))}},showParent:function(e){var t=e.closest(".nodes").siblings(".node").removeClass("hidden");e.closest(".hierarchy").removeClass("isAncestorsCollapsed");this.repaint(t[0]);t.addClass("sliding").removeClass("slide-down").one("transitionend",{node:e},this.showParentEnd.bind(this))},stopAjax:function(e){if(e.find(".spinner").length){e.closest(".orgchart").data("inAjax",false)}},isVisibleNode:function(e,t){return this.getNodeState(h(t)).visible},hideChildrenEnd:function(e){var t=e.data.node;e.data.animatedNodes.removeClass("sliding");e.data.animatedNodes.closest(".nodes").addClass("hidden");if(this.isInAction(t)){this.switchVerticalArrow(t.children(".bottomEdge"))}},hideChildren:function(e){e.closest(".hierarchy").addClass("isChildrenCollapsed");var t=e.siblings(".nodes");this.stopAjax(t);var r=t.find(".node").filter(this.isVisibleNode.bind(this));var n=t.is(".vertical");if(!n){r.closest(".hierarchy").addClass("isCollapsedDescendant")}if(t.is(".vertical")||t.find(".vertical").length){r.find(".oci-minus-square").removeClass("oci-minus-square").addClass("oci-plus-square")}this.repaint(r.get(0));r.addClass("sliding slide-up").eq(0).one("transitionend",{animatedNodes:r,lowerLevel:t,node:e},this.hideChildrenEnd.bind(this))},showChildrenEnd:function(e){var t=e.data.node;e.data.animatedNodes.removeClass("sliding");if(this.isInAction(t)){this.switchVerticalArrow(t.children(".bottomEdge"))}},showChildren:function(e){var t=this;e.closest(".hierarchy").removeClass("isChildrenCollapsed");var r=e.siblings(".nodes");var n=r.is(".vertical");var i=n?r.removeClass("hidden").find(".node").filter(this.isVisibleNode.bind(this)):r.removeClass("hidden").children(".hierarchy").find(".node:first").filter(this.isVisibleNode.bind(this));if(!n){i.filter(":not(:only-child)").closest(".hierarchy").addClass("isChildrenCollapsed");i.closest(".hierarchy").removeClass("isCollapsedDescendant")}this.repaint(i.get(0));i.addClass("sliding").removeClass("slide-up").eq(0).one("transitionend",{node:e,animatedNodes:i},this.showChildrenEnd.bind(this))},hideSiblingsEnd:function(e){var t=e.data.node;var r=e.data.nodeContainer;var n=e.data.direction;var i=n?n==="left"?r.prevAll(":not(.hidden)"):r.nextAll(":not(.hidden)"):r.siblings();e.data.animatedNodes.removeClass("sliding");i.find(".node:gt(0)").filter(this.isVisibleNode.bind(this)).removeClass("slide-left slide-right").addClass("slide-up");i.find(".nodes, .vertical").addClass("hidden").end().addClass("hidden");if(this.isInAction(t)){this.switchHorizontalArrow(t)}},hideSiblings:function(e,t){var r=this;var n=e.closest(".hierarchy").addClass("isSiblingsCollapsed");if(n.siblings().find(".spinner").length){e.closest(".orgchart").data("inAjax",false)}if(t){if(t==="left"){n.addClass("left-sibs").prevAll(".isSiblingsCollapsed").removeClass("isSiblingsCollapsed left-sibs").end().prevAll().addClass("isCollapsedSibling isChildrenCollapsed").find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-right")}else{n.addClass("right-sibs").nextAll(".isSiblingsCollapsed").removeClass("isSiblingsCollapsed right-sibs").end().nextAll().addClass("isCollapsedSibling isChildrenCollapsed").find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-left")}}else{n.prevAll().find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-right");n.nextAll().find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-left");n.siblings().addClass("isCollapsedSibling isChildrenCollapsed")}var i=n.siblings().find(".sliding");i.eq(0).one("transitionend",{node:e,nodeContainer:n,direction:t,animatedNodes:i},this.hideSiblingsEnd.bind(this))},showSiblingsEnd:function(e){var t=e.data.node;e.data.visibleNodes.removeClass("sliding");if(this.isInAction(t)){this.switchHorizontalArrow(t);t.children(".topEdge").removeClass("oci-chevron-up").addClass("oci-chevron-down")}},showRelatedParentEnd:function(e){h(e.target).removeClass("sliding")},showSiblings:function(e,t){var r=this;var n=h();var i=e.closest(".hierarchy");if(t){if(t==="left"){n=i.prevAll().removeClass("hidden")}else{n=i.nextAll().removeClass("hidden")}}else{n=e.closest(".hierarchy").siblings().removeClass("hidden")}var a=e.closest(".nodes").siblings(".node");if(t){i.removeClass(t+"-sibs");if(!i.is("[class*=-sibs]")){i.removeClass("isSiblingsCollapsed")}n.removeClass("isCollapsedSibling "+t+"-sibs")}else{e.closest(".hierarchy").removeClass("isSiblingsCollapsed");n.removeClass("isCollapsedSibling")}if(!this.getNodeState(e,"parent").visible){e.closest(".hierarchy").removeClass("isAncestorsCollapsed");a.removeClass("hidden");this.repaint(a[0]);a.addClass("sliding").removeClass("slide-down").one("transitionend",this.showRelatedParentEnd)}var o=n.find(".node").filter(this.isVisibleNode.bind(this));this.repaint(o.get(0));o.addClass("sliding").removeClass("slide-left slide-right");o.eq(0).one("transitionend",{node:e,visibleNodes:o},this.showSiblingsEnd.bind(this))},startLoading:function(e){var t=this.$chart;if(typeof t.data("inAjax")!=="undefined"&&t.data("inAjax")===true){return false}e.addClass("hidden");e.parent().append('<i class="oci oci-spinner spinner"></i>').children().not(".spinner").css("opacity",.2);t.data("inAjax",true);h(".oc-export-btn").prop("disabled",true);return true},endLoading:function(e){var t=e.parent();e.removeClass("hidden");t.find(".spinner").remove();t.children().removeAttr("style");this.$chart.data("inAjax",false);h(".oc-export-btn").prop("disabled",false)},isInAction:function(e){return e.children(".edge").attr("class").indexOf("oci-")>-1?true:false},switchVerticalArrow:function(e){e.toggleClass("oci-chevron-up").toggleClass("oci-chevron-down")},switchHorizontalArrow:function(e){var t=this.options;if(t.toggleSiblingsResp&&(typeof t.ajaxURL==="undefined"||e.closest(".nodes").data("siblingsLoaded"))){var r=e.parent().prev();if(r.length){if(r.is(".hidden")){e.children(".leftEdge").addClass("oci-chevron-left").removeClass("oci-chevron-right")}else{e.children(".leftEdge").addClass("oci-chevron-right").removeClass("oci-chevron-left")}}var n=e.parent().next();if(n.length){if(n.is(".hidden")){e.children(".rightEdge").addClass("oci-chevron-right").removeClass("oci-chevron-left")}else{e.children(".rightEdge").addClass("oci-chevron-left").removeClass("oci-chevron-right")}}}else{var i=e.parent().siblings();var a=i.length?!i.is(".hidden"):false;e.children(".leftEdge").toggleClass("oci-chevron-right",a).toggleClass("oci-chevron-left",!a);e.children(".rightEdge").toggleClass("oci-chevron-left",a).toggleClass("oci-chevron-right",!a)}},repaint:function(e){if(e){e.style.offsetWidth=e.offsetWidth}},nodeEnterLeaveHandler:function(e){var t=h(e.delegateTarget);var r=false;if(t.closest(".nodes.vertical").length){var n=t.children(".toggleBtn");if(e.type==="mouseenter"){if(t.children(".toggleBtn").length){r=this.getNodeState(t,"children").visible;n.toggleClass("oci-plus-square",!r).toggleClass("oci-minus-square",r)}}else{n.removeClass("oci-plus-square oci-minus-square")}}else{var i=t.children(".topEdge");var a=t.children(".rightEdge");var o=t.children(".bottomEdge");var s=t.children(".leftEdge");if(e.type==="mouseenter"){if(i.length){r=this.getNodeState(t,"parent").visible;i.toggleClass("oci-chevron-up",!r).toggleClass("oci-chevron-down",r)}if(o.length){r=this.getNodeState(t,"children").visible;o.toggleClass("oci-chevron-down",!r).toggleClass("oci-chevron-up",r)}if(s.length){this.switchHorizontalArrow(t)}}else{t.children(".edge").removeClass("oci-chevron-up oci-chevron-down oci-chevron-right oci-chevron-left")}}},nodeClickHandler:function(e){this.$chart.find(".focused").removeClass("focused");h(e.delegateTarget).addClass("focused")},loadNodes:function(t,e,r){var n=this;var i=this.options;h.ajax({url:e,dataType:"json"}).done(function(e){if(n.$chart.data("inAjax")){if(t==="parent"){if(!h.isEmptyObject(e)){n.addParent(r.parent(),e)}}else if(t==="children"){if(e.children.length){n.addChildren(r.parent(),e[t])}}else{n.addSiblings(r.parent(),e.siblings?e.siblings:e)}n.triggerLoadEvent(r.parent(),t)}}).fail(function(){console.log("Failed to get "+t+" data")}).always(function(){n.endLoading(r)})},HideFirstParentEnd:function(e){var t=e.data.topEdge;var r=t.parent();if(this.isInAction(r)){this.switchVerticalArrow(t);this.switchHorizontalArrow(r)}},topEdgeClickHandler:function(e){e.stopPropagation();var t=this;var r=h(e.target);var n=h(e.delegateTarget);var i=this.getNodeState(n,"parent");if(i.exist){var a=n.closest(".nodes").siblings(".node");if(a.is(".sliding")){return}if(i.visible){this.hideParent(n);a.one("transitionend",{topEdge:r},this.HideFirstParentEnd.bind(this));this.triggerHideEvent(n,"parent")}else{this.showParent(n);this.triggerShowEvent(n,"parent")}}else{if(this.startLoading(r)){var o=this.options;var s=h.isFunction(o.ajaxURL.parent)?o.ajaxURL.parent(n.data("nodeData")):o.ajaxURL.parent+n[0].id;this.loadNodes("parent",s,r)}}},bottomEdgeClickHandler:function(e){e.stopPropagation();var t=h(e.target);var r=h(e.delegateTarget);var n=this.getNodeState(r,"children");if(n.exist){var i=r.siblings(".nodes").children().children(".node");if(i.is(".sliding")){return}if(n.visible){this.hideChildren(r);this.triggerHideEvent(r,"children")}else{this.showChildren(r);this.triggerShowEvent(r,"children")}}else{if(this.startLoading(t)){var a=this.options;var o=h.isFunction(a.ajaxURL.children)?a.ajaxURL.children(r.data("nodeData")):a.ajaxURL.children+r[0].id;this.loadNodes("children",o,t)}}},hEdgeClickHandler:function(e){e.stopPropagation();var t=h(e.target);var r=h(e.delegateTarget);var n=this.options;var i=this.getNodeState(r,"siblings");if(i.exist){var a=r.closest(".hierarchy").siblings();if(a.find(".sliding").length){return}if(n.toggleSiblingsResp){var o=r.closest(".hierarchy").prev();var s=r.closest(".hierarchy").next();if(t.is(".leftEdge")){if(o.is(".hidden")){this.showSiblings(r,"left");this.triggerShowEvent(r,"siblings")}else{this.hideSiblings(r,"left");this.triggerHideEvent(r,"siblings")}}else{if(s.is(".hidden")){this.showSiblings(r,"right");this.triggerShowEvent(r,"siblings")}else{this.hideSiblings(r,"right");this.triggerHideEvent(r,"siblings")}}}else{if(i.visible){this.hideSiblings(r);this.triggerHideEvent(r,"siblings")}else{this.showSiblings(r);this.triggerShowEvent(r,"siblings")}}}else{if(this.startLoading(t)){var l=r[0].id;var u=this.getNodeState(r,"parent").exist?h.isFunction(n.ajaxURL.siblings)?n.ajaxURL.siblings(r.data("nodeData")):n.ajaxURL.siblings+l:h.isFunction(n.ajaxURL.families)?n.ajaxURL.families(r.data("nodeData")):n.ajaxURL.families+l;this.loadNodes("siblings",u,t)}}},expandVNodesEnd:function(e){e.data.vNodes.removeClass("sliding")},collapseVNodesEnd:function(e){e.data.vNodes.removeClass("sliding").closest("ul").addClass("hidden")},toggleVNodes:function(e){var t=h(e.target);var r=t.parent().next();var n=r.find(".node");var i=r.children().children(".node");if(i.is(".sliding")){return}t.toggleClass("oci-plus-square oci-minus-square");if(n.eq(0).is(".slide-up")){r.removeClass("hidden");this.repaint(i.get(0));i.addClass("sliding").removeClass("slide-up").eq(0).one("transitionend",{vNodes:i},this.expandVNodesEnd)}else{n.addClass("sliding slide-up").eq(0).one("transitionend",{vNodes:n},this.collapseVNodesEnd);n.find(".toggleBtn").removeClass("oci-minus-square").addClass("oci-plus-square")}},createGhostNode:function(e){var t=h(e.target);var r=this.options;var n=e.originalEvent;var i=/firefox/.test(v.navigator.userAgent.toLowerCase());var a,o;if(!p.querySelector(".ghost-node")){a=p.createElementNS("http://www.w3.org/2000/svg","svg");if(!a.classList)return;a.classList.add("ghost-node");o=p.createElementNS("http://www.w3.org/2000/svg","rect");a.appendChild(o);t.closest(".orgchart").append(a)}else{a=t.closest(".orgchart").children(".ghost-node").get(0);o=h(a).children().get(0)}var s=t.closest(".orgchart").css("transform").split(",");var l=r.direction==="t2b"||r.direction==="b2t";var u=Math.abs(v.parseFloat(l?s[0].slice(s[0].indexOf("(")+1):s[1]));a.setAttribute("width",l?t.outerWidth(false):t.outerHeight(false));a.setAttribute("height",l?t.outerHeight(false):t.outerWidth(false));o.setAttribute("x",5*u);o.setAttribute("y",5*u);o.setAttribute("width",120*u);o.setAttribute("height",40*u);o.setAttribute("rx",4*u);o.setAttribute("ry",4*u);o.setAttribute("stroke-width",1*u);var f=n.offsetX*u;var c=n.offsetY*u;if(r.direction==="l2r"){f=n.offsetY*u;c=n.offsetX*u}else if(r.direction==="r2l"){f=t.outerWidth(false)-n.offsetY*u;c=n.offsetX*u}else if(r.direction==="b2t"){f=t.outerWidth(false)-n.offsetX*u;c=t.outerHeight(false)-n.offsetY*u}if(i){o.setAttribute("fill","rgb(255, 255, 255)");o.setAttribute("stroke","rgb(191, 0, 0)");var d=p.createElement("img");d.src="data:image/svg+xml;utf8,"+(new XMLSerializer).serializeToString(a);n.dataTransfer.setDragImage(d,f,c)}else{if(n.dataTransfer.setDragImage)n.dataTransfer.setDragImage(a,f,c)}},filterAllowedDropNodes:function(r){var n=this.options;var i=r.closest("[draggable]").hasClass("node");var a=r.closest(".nodes").siblings(".node");var o=r.closest(".hierarchy").find(".node");this.$chart.data("dragged",r).find(".node").each(function(e,t){if(!i||o.index(t)===-1){if(n.dropCriteria){if(n.dropCriteria(r,a,h(t))){h(t).addClass("allowedDrop")}}else{h(t).addClass("allowedDrop")}}})},dragstartHandler:function(e){e.originalEvent.dataTransfer.setData("text/html","hack for firefox");if(this.$chart.css("transform")!=="none"){this.createGhostNode(e)}this.filterAllowedDropNodes(h(e.target))},dragoverHandler:function(e){if(!h(e.delegateTarget).is(".allowedDrop")){e.originalEvent.dataTransfer.dropEffect="none"}else{e.preventDefault()}},dragendHandler:function(e){this.$chart.find(".allowedDrop").removeClass("allowedDrop")},dropHandler:function(e){var t=h(e.delegateTarget);var r=this.$chart.data("dragged");if(!r.hasClass("node")){this.$chart.triggerHandler({type:"otherdropped.orgchart",draggedItem:r,dropZone:t});return}if(!t.hasClass("allowedDrop")){return}var n=r.closest(".nodes").siblings(".node");var i=h.Event("nodedrop.orgchart");this.$chart.trigger(i,{draggedNode:r,dragZone:n,dropZone:t});if(i.isDefaultPrevented()){return}if(!t.siblings(".nodes").length){t.append('<i class="edge verticalEdge bottomEdge oci"></i>').after('<ul class="nodes"></ul>').siblings(".nodes").append(r.find(".horizontalEdge").remove().end().closest(".hierarchy"));if(t.children(".title").length){t.children(".title").prepend('<i class="oci '+this.$chart.data("options").parentNodeSymbol+' symbol"></i>')}}else{var a='<i class="edge horizontalEdge rightEdge oci"></i><i class="edge horizontalEdge leftEdge oci"></i>';if(!r.find(".horizontalEdge").length){r.append(a)}t.siblings(".nodes").append(r.closest(".hierarchy"));var o=r.closest(".hierarchy").siblings().find(".node:first");if(o.length===1){o.append(a)}}if(n.siblings(".nodes").children(".hierarchy").length===1){n.siblings(".nodes").children(".hierarchy").find(".node:first").find(".horizontalEdge").remove()}else if(n.siblings(".nodes").children(".hierarchy").length===0){n.find(".bottomEdge, .symbol").remove().end().siblings(".nodes").remove()}},touchstartHandler:function(e){if(this.touchHandled)return;if(e.touches&&e.touches.length>1)return;this.touchHandled=true;this.touchMoved=false;e.preventDefault()},touchmoveHandler:function(e){if(!this.touchHandled)return;if(e.touches&&e.touches.length>1)return;e.preventDefault();if(!this.touchMoved){this.filterAllowedDropNodes(h(e.currentTarget));this.touchDragImage=this.createDragImage(e,this.$chart.data("dragged")[0])}this.touchMoved=true;this.moveDragImage(e,this.touchDragImage);var t=h(p.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY));var r=t.closest("div.node");if(r.length>0){var n=r[0];if(r.is(".allowedDrop")){this.touchTargetNode=n}else{this.touchTargetNode=null}}else{this.touchTargetNode=null}},touchendHandler:function(e){if(!this.touchHandled){return}this.destroyDragImage();if(this.touchMoved){if(this.touchTargetNode){var t={delegateTarget:this.touchTargetNode};this.dropHandler(t);this.touchTargetNode=null}this.dragendHandler(e)}else{var r=e.changedTouches[0];var n=p.createEvent("MouseEvents");n.initMouseEvent("click",true,true,v,1,r.screenX,r.screenY,r.clientX,r.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);e.target.dispatchEvent(n)}this.touchHandled=false},createDragImage:function(e,t){var r=t.cloneNode(true);this.copyStyle(t,r);r.style.top=r.style.left="-9999px";var n=t.getBoundingClientRect();var i=this.getTouchPoint(e);this.touchDragImageOffset={x:i.x-n.left,y:i.y-n.top};r.style.opacity="0.5";p.body.appendChild(r);return r},destroyDragImage:function(){if(this.touchDragImage&&this.touchDragImage.parentElement)this.touchDragImage.parentElement.removeChild(this.touchDragImage);this.touchDragImageOffset=null;this.touchDragImage=null},copyStyle:function(e,t){var r=["id","class","style","draggable"];r.forEach(function(e){t.removeAttribute(e)});if(e instanceof HTMLCanvasElement){var n=e,i=t;i.width=n.width;i.height=n.height;i.getContext("2d").drawImage(n,0,0)}var a=getComputedStyle(e);for(var o=0;o<a.length;o++){var s=a[o];if(s.indexOf("transition")<0){t.style[s]=a[s]}}t.style.pointerEvents="none";for(var o=0;o<e.children.length;o++){this.copyStyle(e.children[o],t.children[o])}},getTouchPoint:function(e){if(e&&e.touches){e=e.touches[0]}return{x:e.clientX,y:e.clientY}},moveDragImage:function(r,n){if(!r||!n)return;var i=this;requestAnimationFrame(function(){var e=i.getTouchPoint(r);var t=n.style;t.position="absolute";t.pointerEvents="none";t.zIndex="999999";if(i.touchDragImageOffset){t.left=Math.round(e.x-i.touchDragImageOffset.x)+"px";t.top=Math.round(e.y-i.touchDragImageOffset.y)+"px"}})},bindDragDrop:function(e){e.on("dragstart",this.dragstartHandler.bind(this)).on("dragover",this.dragoverHandler.bind(this)).on("dragend",this.dragendHandler.bind(this)).on("drop",this.dropHandler.bind(this)).on("touchstart",this.touchstartHandler.bind(this)).on("touchmove",this.touchmoveHandler.bind(this)).on("touchend",this.touchendHandler.bind(this))},createNode:function(r){var e=this;var n=this.options;var t=r.level;if(r.children&&r[n.nodeId]){h.each(r.children,function(e,t){t.parentId=r[n.nodeId]})}var i=h("<div"+(n.draggable?' draggable="true"':"")+(r[n.nodeId]?' id="'+r[n.nodeId]+'"':"")+(r.parentId?' data-parent="'+r.parentId+'"':"")+">").addClass("node "+(r.className||"")+(t>n.visibleLevel?" slide-up":""));if(n.nodeTemplate){i.append(n.nodeTemplate(r))}else{i.append('<div class="title">'+r[n.nodeTitle]+"</div>").append(typeof n.nodeContent!=="undefined"?'<div class="content">'+(r[n.nodeContent]||"")+"</div>":"")}var a=h.extend({},r);delete a.children;i.data("nodeData",a);var o=r.relationship||"";if(n.verticalLevel&&t>=n.verticalLevel){if(t+1>n.verticalLevel&&Number(o.substr(2,1))){i.append('<i class="toggleBtn oci"></i>').children(".title").prepend('<i class="oci '+n.parentNodeSymbol+' symbol"></i>')}}else{if(Number(o.substr(0,1))){i.append('<i class="edge verticalEdge topEdge oci"></i>')}if(Number(o.substr(1,1))){i.append('<i class="edge horizontalEdge rightEdge oci"></i>'+'<i class="edge horizontalEdge leftEdge oci"></i>')}if(Number(o.substr(2,1))){i.append('<i class="edge verticalEdge bottomEdge oci"></i>').children(".title").prepend('<i class="oci '+n.parentNodeSymbol+' symbol"></i>')}}i.on("mouseenter mouseleave",this.nodeEnterLeaveHandler.bind(this));i.on("click",this.nodeClickHandler.bind(this));i.on("click",".topEdge",this.topEdgeClickHandler.bind(this));i.on("click",".bottomEdge",this.bottomEdgeClickHandler.bind(this));i.on("click",".leftEdge, .rightEdge",this.hEdgeClickHandler.bind(this));i.on("click",".toggleBtn",this.toggleVNodes.bind(this));if(n.draggable){this.bindDragDrop(i);this.touchHandled=false;this.touchMoved=false;this.touchTargetNode=null}if(n.createNode){n.createNode(i,r)}return i},buildHierarchy:function(e,t){var r=this;var n=this.options;var i=0;if(t.level){i=t.level}else{i=t.level=e.parentsUntil(".orgchart",".nodes").length}if(Object.keys(t).length>2){var a=this.createNode(t);if(n.verticalLevel&&i>=n.verticalLevel){e.append(a)}else{e.append(a)}}if(t.children&&t.children.length){var o=i+1>n.visibleLevel||t.collapsed!==u&&t.collapsed;var s=n.verticalLevel&&i+1>=n.verticalLevel;var l;if(s){l=h('<ul class="nodes">');if(o&&i+1>=n.verticalLevel){l.addClass("hidden")}if(i+1===n.verticalLevel){e.addClass("hybrid").append(l.addClass("vertical"))}else{e.append(l)}}else{l=h('<ul class="nodes'+(o?" hidden":"")+'">');if(Object.keys(t).length===2){e.append(l)}else{if(o){e.addClass("isChildrenCollapsed")}e.append(l)}}h.each(t.children,function(){var e=h('<li class="hierarchy">');l.append(e);this.level=i+1;r.buildHierarchy(e,this)})}},buildChildNode:function(e,t){this.buildHierarchy(e,{children:t})},addChildren:function(e,t){this.buildChildNode(e.closest(".hierarchy"),t);if(!e.find(".symbol").length){e.children(".title").prepend('<i class="oci '+this.options.parentNodeSymbol+' symbol"></i>')}if(e.closest(".nodes.vertical").length){if(!e.children(".toggleBtn").length){e.append('<i class="toggleBtn oci"></i>')}}else{if(!e.children(".bottomEdge").length){e.append('<i class="edge verticalEdge bottomEdge oci"></i>')}}if(this.isInAction(e)){this.switchVerticalArrow(e.children(".bottomEdge"))}},buildParentNode:function(e,t){t.relationship=t.relationship||"001";var r=h('<ul class="nodes"><li class="hierarchy"></li></ul>').find(".hierarchy").append(this.createNode(t)).end();this.$chart.prepend(r).find(".hierarchy:first").append(e.closest("ul").addClass("nodes"))},addParent:function(e,t){this.buildParentNode(e,t);if(!e.children(".topEdge").length){e.children(".title").after('<i class="edge verticalEdge topEdge oci"></i>')}if(this.isInAction(e)){this.switchVerticalArrow(e.children(".topEdge"))}},buildSiblingNode:function(e,t){var r=h.isArray(t)?t.length:t.children.length;var n=e.parent().is(".nodes")?e.siblings().length+1:1;var i=n+r;var a=i>1?Math.floor(i/2-1):0;if(e.closest(".nodes").parent().is(".hierarchy")){this.buildChildNode(e.parent().closest(".hierarchy"),t);var o=e.parent().closest(".hierarchy").children(".nodes:last").children(".hierarchy");if(n>1){o.eq(0).before(e.siblings().addBack().unwrap())}else{o.eq(a).after(e.unwrap())}}else{this.buildHierarchy(e.parent().prepend(h('<li class="hierarchy">')).children(".hierarchy:first"),t);e.prevAll(".hierarchy").children(".nodes").children().eq(a).after(e)}},addSiblings:function(e,t){this.buildSiblingNode(e.closest(".hierarchy"),t);e.closest(".nodes").data("siblingsLoaded",true);if(!e.children(".leftEdge").length){e.children(".topEdge").after('<i class="edge horizontalEdge rightEdge oci"></i><i class="edge horizontalEdge leftEdge oci"></i>')}if(this.isInAction(e)){this.switchHorizontalArrow(e);e.children(".topEdge").removeClass("oci-chevron-up").addClass("oci-chevron-down")}},removeNodes:function(e){var t=e.closest(".hierarchy").parent();if(t.parent().is(".hierarchy")){if(this.getNodeState(e,"siblings").exist){e.closest(".hierarchy").remove();if(t.children().length===1){t.find(".node:first .horizontalEdge").remove()}}else{t.siblings(".node").find(".bottomEdge").remove().end().end().remove()}}else{t.closest(".orgchart").remove()}},hideDropZones:function(){var e=this;e.$chart.find(".allowedDrop").removeClass("allowedDrop")},showDropZones:function(e){var t=this;t.$chart.find(".node").each(function(e,t){h(t).addClass("allowedDrop")});t.$chart.data("dragged",h(e))},processExternalDrop:function(e,t){if(t){this.$chart.data("dragged",h(t))}var r=e.closest(".node");r.triggerHandler({type:"drop"})},exportPDF:function(e,t){var r={};var n=Math.floor(e.width);var i=Math.floor(e.height);if(!v.jsPDF){v.jsPDF=v.jspdf.jsPDF}if(n>i){r=new jsPDF({orientation:"landscape",unit:"px",format:[n,i]})}else{r=new jsPDF({orientation:"portrait",unit:"px",format:[i,n]})}r.addImage(e.toDataURL(),"png",0,0);r.save(t+".pdf")},exportPNG:function(e,t){var r=this;var n="WebkitAppearance"in p.documentElement.style;var i=!!v.sidebar;var a=navigator.appName==="Microsoft Internet Explorer"||navigator.appName==="Netscape"&&navigator.appVersion.indexOf("Edge")>-1;var o=this.$chartContainer;if(!n&&!i||a){v.navigator.msSaveBlob(e.msToBlob(),t+".png")}else{var s=".oci-download-btn"+(r.options.chartClass!==""?"."+r.options.chartClass:"");if(!o.find(s).length){o.append('<a class="oci-download-btn'+(r.options.chartClass!==""?" "+r.options.chartClass:"")+'"'+' download="'+t+'.png"></a>')}o.find(s).attr("href",e.toDataURL())[0].click()}},export:function(t,r){var n=this;t=typeof t!=="undefined"?t:this.options.exportFilename;r=typeof r!=="undefined"?r:this.options.exportFileextension;if(h(this).children(".spinner").length){return false}var i=this.$chartContainer;var e=i.find(".mask");if(!e.length){i.append('<div class="mask"><i class="oci oci-spinner spinner"></i></div>')}else{e.removeClass("hidden")}var a=i.addClass("canvasContainer").find('.orgchart:not(".hidden")').get(0);var o=n.options.direction==="l2r"||n.options.direction==="r2l";html2canvas(a,{width:o?a.clientHeight:a.clientWidth,height:o?a.clientWidth:a.clientHeight,onclone:function(e){h(e).find(".canvasContainer").css("overflow","visible").find('.orgchart:not(".hidden"):first').css("transform","")}}).then(function(e){i.find(".mask").addClass("hidden");if(r.toLowerCase()==="pdf"){n.exportPDF(e,t)}else{n.exportPNG(e,t)}i.removeClass("canvasContainer")},function(){i.removeClass("canvasContainer")})}};h.fn.orgchart=function(e){return new t(this,e).init()}});(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof module==="object"&&module.exports){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(_){_.ui=_.ui||{};var e=_.ui.version="1.12.1";var r=0;var s=Array.prototype.slice;_.cleanData=_.cleanData||function(i){return function(e){var t,r,n;for(n=0;(r=e[n])!=null;n++){try{t=_._data(r,"events");if(t&&t.remove){_(r).triggerHandler("remove")}}catch(e){}}i(e)}}(_.cleanData);_.widget=_.widget||function(e,r,t){var n,i,a;var o={};var s=e.split(".")[0];e=e.split(".")[1];var l=s+"-"+e;if(!t){t=r;r=_.Widget}if(_.isArray(t)){t=_.extend.apply(null,[{}].concat(t))}_.expr[":"][l.toLowerCase()]=function(e){return!!_.data(e,l)};_[s]=_[s]||{};n=_[s][e];i=_[s][e]=function(e,t){if(!this._createWidget){return new i(e,t)}if(arguments.length){this._createWidget(e,t)}};_.extend(i,n,{version:t.version,_proto:_.extend({},t),_childConstructors:[]});a=new r;a.options=_.widget.extend({},a.options);_.each(t,function(t,a){if(!_.isFunction(a)){o[t]=a;return}o[t]=function(){function n(){return r.prototype[t].apply(this,arguments)}function i(e){return r.prototype[t].apply(this,e)}return function(){var e=this._super;var t=this._superApply;var r;this._super=n;this._superApply=i;r=a.apply(this,arguments);this._super=e;this._superApply=t;return r}}()});i.prototype=_.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},o,{constructor:i,namespace:s,widgetName:e,widgetFullName:l});if(n){_.each(n._childConstructors,function(e,t){var r=t.prototype;_.widget(r.namespace+"."+r.widgetName,i,t._proto)});delete n._childConstructors}else{r._childConstructors.push(i)}_.widget.bridge(e,i);return i};_.widget.extend=function(e){var t=s.call(arguments,1);var r=0;var n=t.length;var i;var a;for(;r<n;r++){for(i in t[r]){a=t[r][i];if(t[r].hasOwnProperty(i)&&a!==undefined){if(_.isPlainObject(a)){e[i]=_.isPlainObject(e[i])?_.widget.extend({},e[i],a):_.widget.extend({},a)}else{e[i]=a}}}}return e};_.widget.bridge=function(a,t){var o=t.prototype.widgetFullName||a;_.fn[a]=function(r){var e=typeof r==="string";var n=s.call(arguments,1);var i=this;if(e){if(!this.length&&r==="instance"){i=undefined}else{this.each(function(){var e;var t=_.data(this,o);if(r==="instance"){i=t;return false}if(!t){return _.error("cannot call methods on "+a+" prior to initialization; "+"attempted to call method '"+r+"'")}if(!_.isFunction(t[r])||r.charAt(0)==="_"){return _.error("no such method '"+r+"' for "+a+" widget instance")}e=t[r].apply(t,n);if(e!==t&&e!==undefined){i=e&&e.jquery?i.pushStack(e.get()):e;return false}})}}else{if(n.length){r=_.widget.extend.apply(null,[r].concat(n))}this.each(function(){var e=_.data(this,o);if(e){e.option(r||{});if(e._init){e._init()}}else{_.data(this,o,new t(r,this))}})}return i}};_.Widget=_.Widget||function(){};_.Widget._childConstructors=[];_.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:false,create:null},_createWidget:function(e,t){t=_(t||this.defaultElement||this)[0];this.element=_(t);this.uuid=r++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=_();this.hoverable=_();this.focusable=_();this.classesElementLookup={};if(t!==this){_.data(t,this.widgetFullName,this);this._on(true,this.element,{remove:function(e){if(e.target===t){this.destroy()}}});this.document=_(t.style?t.ownerDocument:t.document||t);this.window=_(this.document[0].defaultView||this.document[0].parentWindow)}this.options=_.widget.extend({},this.options,this._getCreateOptions(),e);this._create();if(this.options.disabled){this._setOptionDisabled(this.options.disabled)}this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:_.noop,_create:_.noop,_init:_.noop,destroy:function(){var r=this;this._destroy();_.each(this.classesElementLookup,function(e,t){r._removeClass(t,e)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:_.noop,widget:function(){return this.element},option:function(e,t){var r=e;var n;var i;var a;if(arguments.length===0){return _.widget.extend({},this.options)}if(typeof e==="string"){r={};n=e.split(".");e=n.shift();if(n.length){i=r[e]=_.widget.extend({},this.options[e]);for(a=0;a<n.length-1;a++){i[n[a]]=i[n[a]]||{};i=i[n[a]]}e=n.pop();if(arguments.length===1){return i[e]===undefined?null:i[e]}i[e]=t}else{if(arguments.length===1){return this.options[e]===undefined?null:this.options[e]}r[e]=t}}this._setOptions(r);return this},_setOptions:function(e){var t;for(t in e){this._setOption(t,e[t])}return this},_setOption:function(e,t){if(e==="classes"){this._setOptionClasses(t)}this.options[e]=t;if(e==="disabled"){this._setOptionDisabled(t)}return this},_setOptionClasses:function(e){var t,r,n;for(t in e){n=this.classesElementLookup[t];if(e[t]===this.options.classes[t]||!n||!n.length){continue}r=_(n.get());this._removeClass(n,t);r.addClass(this._classes({element:r,keys:t,classes:e,add:true}))}},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e);if(e){this._removeClass(this.hoverable,null,"ui-state-hover");this._removeClass(this.focusable,null,"ui-state-focus")}},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_classes:function(i){var a=[];var o=this;i=_.extend({element:this.element,classes:this.options.classes||{}},i);function e(e,t){var r,n;for(n=0;n<e.length;n++){r=o.classesElementLookup[e[n]]||_();if(i.add){r=_(_.unique(r.get().concat(i.element.get())))}else{r=_(r.not(i.element).get())}o.classesElementLookup[e[n]]=r;a.push(e[n]);if(t&&i.classes[e[n]]){a.push(i.classes[e[n]])}}}this._on(i.element,{remove:"_untrackClassesElement"});if(i.keys){e(i.keys.match(/\S+/g)||[],true)}if(i.extra){e(i.extra.match(/\S+/g)||[])}return a.join(" ")},_untrackClassesElement:function(r){var n=this;_.each(n.classesElementLookup,function(e,t){if(_.inArray(r.target,t)!==-1){n.classesElementLookup[e]=_(t.not(r.target).get())}})},_removeClass:function(e,t,r){return this._toggleClass(e,t,r,false)},_addClass:function(e,t,r){return this._toggleClass(e,t,r,true)},_toggleClass:function(e,t,r,n){n=typeof n==="boolean"?n:r;var i=typeof e==="string"||e===null,a={extra:i?t:r,keys:i?e:t,element:i?this.element:e,add:n};a.element.toggleClass(this._classes(a),n);return this},_on:function(o,s,e){var l;var u=this;if(typeof o!=="boolean"){e=s;s=o;o=false}if(!e){e=s;s=this.element;l=this.widget()}else{s=l=_(s);this.bindings=this.bindings.add(s)}_.each(e,function(e,t){function r(){if(!o&&(u.options.disabled===true||_(this).hasClass("ui-state-disabled"))){return}return(typeof t==="string"?u[t]:t).apply(u,arguments)}if(typeof t!=="string"){r.guid=t.guid=t.guid||r.guid||_.guid++}var n=e.match(/^([\w:-]*)\s*(.*)$/);var i=n[1]+u.eventNamespace;var a=n[2];if(a){l.on(i,a,r)}else{s.on(i,r)}})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.off(t).off(t);this.bindings=_(this.bindings.not(e).get());this.focusable=_(this.focusable.not(e).get());this.hoverable=_(this.hoverable.not(e).get())},_delay:function(e,t){function r(){return(typeof e==="string"?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(r,t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){this._addClass(_(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(_(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){this._addClass(_(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(_(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,t,r){var n,i;var a=this.options[e];r=r||{};t=_.Event(t);t.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();t.target=this.element[0];i=t.originalEvent;if(i){for(n in i){if(!(n in t)){t[n]=i[n]}}}this.element.trigger(t,r);return!(_.isFunction(a)&&a.apply(this.element[0],[t].concat(r))===false||t.isDefaultPrevented())}};_.each({show:"fadeIn",hide:"fadeOut"},function(a,o){_.Widget.prototype["_"+a]=function(t,e,r){if(typeof e==="string"){e={effect:e}}var n;var i=!e?a:e===true||typeof e==="number"?o:e.effect||o;e=e||{};if(typeof e==="number"){e={duration:e}}n=!_.isEmptyObject(e);e.complete=r;if(e.delay){t.delay(e.delay)}if(n&&_.effects&&_.effects.effect[i]){t[a](e)}else if(i!==a&&t[i]){t[i](e.duration,e.easing,r)}else{t.queue(function(e){_(this)[a]();if(r){r.call(t[0])}e()})}}});var t=_.widget;(function(){var i,S=Math.max,E=Math.abs,n=/left|center|right/,a=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,t=_.fn.position;function k(e,t,r){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?r/100:1)]}function T(e,t){return parseInt(_.css(e,t),10)||0}function r(e){var t=e[0];if(t.nodeType===9){return{width:e.width(),height:e.height(),offset:{top:0,left:0}}}if(_.isWindow(t)){return{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}}if(t.preventDefault){return{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}}return{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}_.position=_.position||{scrollbarWidth:function(){if(i!==undefined){return i}var e,t,r=_("<div "+"style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'>"+"<div style='height:100px;width:auto;'></div></div>"),n=r.children()[0];_("body").append(r);e=n.offsetWidth;r.css("overflow","scroll");t=n.offsetWidth;if(e===t){t=r[0].clientWidth}r.remove();return i=e-t},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),r=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n=t==="scroll"||t==="auto"&&e.width<e.element[0].scrollWidth,i=r==="scroll"||r==="auto"&&e.height<e.element[0].scrollHeight;return{width:i?_.position.scrollbarWidth():0,height:n?_.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=_(e||window),r=_.isWindow(t[0]),n=!!t[0]&&t[0].nodeType===9,i=!r&&!n;return{element:t,isWindow:r,isDocument:n,offset:i?_(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}};_.fn.position=function(c){if(!c||!c.of){return t.apply(this,arguments)}c=_.extend({},c);var d,h,v,p,g,e,m=_(c.of),y=_.position.getWithinInfo(c.within),b=_.position.getScrollInfo(y),w=(c.collision||"flip").split(" "),C={};e=r(m);if(m[0].preventDefault){c.at="left top"}h=e.width;v=e.height;p=e.offset;g=_.extend({},p);_.each(["my","at"],function(){var e=(c[this]||"").split(" "),t,r;if(e.length===1){e=n.test(e[0])?e.concat(["center"]):a.test(e[0])?["center"].concat(e):["center","center"]}e[0]=n.test(e[0])?e[0]:"center";e[1]=a.test(e[1])?e[1]:"center";t=o.exec(e[0]);r=o.exec(e[1]);C[this]=[t?t[0]:0,r?r[0]:0];c[this]=[s.exec(e[0])[0],s.exec(e[1])[0]]});if(w.length===1){w[1]=w[0]}if(c.at[0]==="right"){g.left+=h}else if(c.at[0]==="center"){g.left+=h/2}if(c.at[1]==="bottom"){g.top+=v}else if(c.at[1]==="center"){g.top+=v/2}d=k(C.at,h,v);g.left+=d[0];g.top+=d[1];return this.each(function(){var r,e,o=_(this),s=o.outerWidth(),l=o.outerHeight(),t=T(this,"marginLeft"),n=T(this,"marginTop"),i=s+t+T(this,"marginRight")+b.width,a=l+n+T(this,"marginBottom")+b.height,u=_.extend({},g),f=k(C.my,o.outerWidth(),o.outerHeight());if(c.my[0]==="right"){u.left-=s}else if(c.my[0]==="center"){u.left-=s/2}if(c.my[1]==="bottom"){u.top-=l}else if(c.my[1]==="center"){u.top-=l/2}u.left+=f[0];u.top+=f[1];r={marginLeft:t,marginTop:n};_.each(["left","top"],function(e,t){if(_.ui.position[w[e]]){_.ui.position[w[e]][t](u,{targetWidth:h,targetHeight:v,elemWidth:s,elemHeight:l,collisionPosition:r,collisionWidth:i,collisionHeight:a,offset:[d[0]+f[0],d[1]+f[1]],my:c.my,at:c.at,within:y,elem:o})}});if(c.using){e=function(e){var t=p.left-u.left,r=t+h-s,n=p.top-u.top,i=n+v-l,a={target:{element:m,left:p.left,top:p.top,width:h,height:v},element:{element:o,left:u.left,top:u.top,width:s,height:l},horizontal:r<0?"left":t>0?"right":"center",vertical:i<0?"top":n>0?"bottom":"middle"};if(h<s&&E(t+r)<h){a.horizontal="center"}if(v<l&&E(n+i)<v){a.vertical="middle"}if(S(E(t),E(r))>S(E(n),E(i))){a.important="horizontal"}else{a.important="vertical"}c.using.call(this,e,a)}}o.offset(_.extend(u,{using:e}))})};_.ui.position={fit:{left:function(e,t){var r=t.within,n=r.isWindow?r.scrollLeft:r.offset.left,i=r.width,a=e.left-t.collisionPosition.marginLeft,o=n-a,s=a+t.collisionWidth-i-n,l;if(t.collisionWidth>i){if(o>0&&s<=0){l=e.left+o+t.collisionWidth-i-n;e.left+=o-l}else if(s>0&&o<=0){e.left=n}else{if(o>s){e.left=n+i-t.collisionWidth}else{e.left=n}}}else if(o>0){e.left+=o}else if(s>0){e.left-=s}else{e.left=S(e.left-a,e.left)}},top:function(e,t){var r=t.within,n=r.isWindow?r.scrollTop:r.offset.top,i=t.within.height,a=e.top-t.collisionPosition.marginTop,o=n-a,s=a+t.collisionHeight-i-n,l;if(t.collisionHeight>i){if(o>0&&s<=0){l=e.top+o+t.collisionHeight-i-n;e.top+=o-l}else if(s>0&&o<=0){e.top=n}else{if(o>s){e.top=n+i-t.collisionHeight}else{e.top=n}}}else if(o>0){e.top+=o}else if(s>0){e.top-=s}else{e.top=S(e.top-a,e.top)}}},flip:{left:function(e,t){var r=t.within,n=r.offset.left+r.scrollLeft,i=r.width,a=r.isWindow?r.scrollLeft:r.offset.left,o=e.left-t.collisionPosition.marginLeft,s=o-a,l=o+t.collisionWidth-i-a,u=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,f=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,c=-2*t.offset[0],d,h;if(s<0){d=e.left+u+f+c+t.collisionWidth-i-n;if(d<0||d<E(s)){e.left+=u+f+c}}else if(l>0){h=e.left-t.collisionPosition.marginLeft+u+f+c-a;if(h>0||E(h)<l){e.left+=u+f+c}}},top:function(e,t){var r=t.within,n=r.offset.top+r.scrollTop,i=r.height,a=r.isWindow?r.scrollTop:r.offset.top,o=e.top-t.collisionPosition.marginTop,s=o-a,l=o+t.collisionHeight-i-a,u=t.my[1]==="top",f=u?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,c=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,d=-2*t.offset[1],h,v;if(s<0){v=e.top+f+c+d+t.collisionHeight-i-n;if(v<0||v<E(s)){e.top+=f+c+d}}else if(l>0){h=e.top-t.collisionPosition.marginTop+f+c+d-a;if(h>0||E(h)<l){e.top+=f+c+d}}}},flipfit:{left:function(){_.ui.position.flip.left.apply(this,arguments);_.ui.position.fit.left.apply(this,arguments)},top:function(){_.ui.position.flip.top.apply(this,arguments);_.ui.position.fit.top.apply(this,arguments)}}}})();var n=_.ui.position;var i=_.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};var a=_.fn.scrollParent=function(e){var t=this.css("position"),r=t==="absolute",n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,i=this.parents().filter(function(){var e=_(this);if(r&&e.css("position")==="static"){return false}return n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return t==="fixed"||!i.length?_(this[0].ownerDocument||document):i};var o=_.fn.extend({uniqueId:function(){var e=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++e}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){_(this).removeAttr("id")}})}})});(function(e){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fancytree.ui-deps"],e)}else if(typeof module==="object"&&module.exports){require("./jquery.fancytree.ui-deps");module.exports=e(require("jquery"))}else{e(jQuery)}})(function(C){"use strict";if(C.ui&&C.ui.fancytree){C.ui.fancytree.warn("Fancytree: ignored duplicate include");return}var a,e,g=null,m=new RegExp(/\.|\//),t=/[&<>"'/]/g,r=/[<>"'/]/g,d="$recursive_request",h="$request_target_invalid",n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},i={16:true,17:true,18:true},y={8:"backspace",9:"tab",10:"return",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},b={16:"shift",17:"ctrl",18:"alt",91:"meta",93:"meta"},o={0:"",1:"left",2:"middle",3:"right"},w="active expanded focus folder lazy radiogroup selected unselectable unselectableIgnore".split(" "),S={},v="columns types".split(" "),E="checkbox expanded extraClasses folder icon iconTooltip key lazy partsel radiogroup refKey selected statusNodeType title tooltip type unselectable unselectableIgnore unselectableStatus".split(" "),s={},k={},l={active:true,children:true,data:true,focus:true};for(a=0;a<w.length;a++){S[w[a]]=true}for(a=0;a<E.length;a++){e=E[a];s[e]=true;if(e!==e.toLowerCase()){k[e.toLowerCase()]=e}}function T(e,t){if(!e){t=t?": "+t:"";t="Fancytree assertion failed"+t;C.ui.fancytree.error(t);C.error(t)}}T(C.ui,"Fancytree requires jQuery UI (http://jqueryui.com)");function u(e,t){var r,n,i=window.console?window.console[e]:null;if(i){try{i.apply(window.console,t)}catch(e){n="";for(r=0;r<t.length;r++){n+=t[r]}i(n)}}}if(!Date.now){Date.now=function e(){return(new Date).getTime()}}function _(e){return!!(e.tree&&e.statusNodeType!==undefined)}function f(e,t,r,n){var i,a,o,s=C.map(C.trim(e).split("."),function(e){return parseInt(e,10)}),l=C.map(Array.prototype.slice.call(arguments,1),function(e){return parseInt(e,10)});for(i=0;i<l.length;i++){a=s[i]||0;o=l[i]||0;if(a!==o){return a>o}}return true}function c(){var e,t,r,n,i,a=arguments[0]||{},o=1,s=arguments.length;if(typeof a!=="object"&&!C.isFunction(a)){a={}}if(o===s){throw Error("need at least two args")}for(;o<s;o++){if((e=arguments[o])!=null){for(t in e){if(e.hasOwnProperty(t)){r=a[t];n=e[t];if(a===n){continue}if(n&&C.isPlainObject(n)){i=r&&C.isPlainObject(r)?r:{};a[t]=c(i,n)}else if(n!==undefined){a[t]=n}}}}}return a}function p(e,s,t,r,l){var n=function(){var t=s[e],n=r[e],i=s.ext[l],a=function(){return t.apply(s,arguments)},o=function(e){return t.apply(s,e)};return function(){var e=s._local,t=s._super,r=s._superApply;try{s._local=i;s._super=a;s._superApply=o;return n.apply(s,arguments)}finally{s._local=e;s._super=t;s._superApply=r}}}();return n}function x(e,t,r,n){for(var i in r){if(typeof r[i]==="function"){if(typeof e[i]==="function"){e[i]=p(i,e,t,r,n)}else if(i.charAt(0)==="_"){e.ext[n][i]=p(i,e,t,r,n)}else{C.error("Could not override tree."+i+". Use prefix '_' to create tree."+n+"._"+i)}}else{if(i!=="options"){e.ext[n][i]=r[i]}}}}function D(e,t){if(e===undefined){return C.Deferred(function(){this.resolve()}).promise()}return C.Deferred(function(){this.resolveWith(e,t)}).promise()}function R(e,t){if(e===undefined){return C.Deferred(function(){this.reject()}).promise()}return C.Deferred(function(){this.rejectWith(e,t)}).promise()}function I(e,t){return function(){e.resolveWith(t)}}function O(e){var t=C.extend({},e.data()),r=t.json;delete t.fancytree;delete t.uiFancytree;if(r){delete t.json;t=C.extend(t,r)}return t}function A(e){return(""+e).replace(r,function(e){return n[e]})}function N(t){t=t.toLowerCase();return function(e){return e.title.toLowerCase().indexOf(t)>=0}}function M(e){var t=new RegExp("^"+e,"i");return function(e){return t.test(e.title)}}function L(e,t){var r,n,i,a;this.parent=e;this.tree=e.tree;this.ul=null;this.li=null;this.statusNodeType=null;this._isLoading=false;this._error=null;this.data={};for(r=0,n=E.length;r<n;r++){i=E[r];this[i]=t[i]}if(this.unselectableIgnore!=null||this.unselectableStatus!=null){this.unselectable=true}if(t.hideCheckbox){C.error("'hideCheckbox' node option was removed in v2.23.0: use 'checkbox: false'")}if(t.data){C.extend(this.data,t.data)}for(i in t){if(!s[i]&&(this.tree.options.copyFunctionsToData||!C.isFunction(t[i]))&&!l[i]){this.data[i]=t[i]}}if(this.key==null){if(this.tree.options.defaultKey){this.key=""+this.tree.options.defaultKey(this);T(this.key,"defaultKey() must return a unique key")}else{this.key="_"+g._nextNodeKey++}}else{this.key=""+this.key}if(t.active){T(this.tree.activeNode===null,"only one active node allowed");this.tree.activeNode=this}if(t.selected){this.tree.lastSelectedNode=this}a=t.children;if(a){if(a.length){this._setChildren(a)}else{this.children=this.lazy?[]:null}}else{this.children=null}this.tree._callHook("treeRegisterNode",this.tree,true,this)}L.prototype={_findDirectChild:function(e){var t,r,n=this.children;if(n){if(typeof e==="string"){for(t=0,r=n.length;t<r;t++){if(n[t].key===e){return n[t]}}}else if(typeof e==="number"){return this.children[e]}else if(e.parent===this){return e}}return null},_setChildren:function(e){T(e&&(!this.children||this.children.length===0),"only init supported");this.children=[];for(var t=0,r=e.length;t<r;t++){this.children.push(new L(this,e[t]))}this.tree._callHook("treeStructureChanged",this.tree,"setChildren")},addChildren:function(e,t){var r,n,i,a=this.getFirstChild(),o=this.getLastChild(),s=null,l=[];if(C.isPlainObject(e)){e=[e]}if(!this.children){this.children=[]}for(r=0,n=e.length;r<n;r++){l.push(new L(this,e[r]))}s=l[0];if(t==null){this.children=this.children.concat(l)}else{t=this._findDirectChild(t);i=C.inArray(t,this.children);T(i>=0,"insertBefore must be an existing child");this.children.splice.apply(this.children,[i,0].concat(l))}if(a&&!t){for(r=0,n=l.length;r<n;r++){l[r].render()}if(a!==this.getFirstChild()){a.renderStatus()}if(o!==this.getLastChild()){o.renderStatus()}}else if(!this.parent||this.parent.ul||this.tr){this.render()}if(this.tree.options.selectMode===3){this.fixSelection3FromEndNodes()}this.triggerModifyChild("add",l.length===1?l[0]:null);return s},addClass:function(e){return this.toggleClass(e,true)},addNode:function(e,t){if(t===undefined||t==="over"){t="child"}switch(t){case"after":return this.getParent().addChildren(e,this.getNextSibling());case"before":return this.getParent().addChildren(e,this);case"firstChild":var r=this.children?this.children[0]:null;return this.addChildren(e,r);case"child":case"over":return this.addChildren(e)}T(false,"Invalid mode: "+t)},addPagingNode:function(e,t){var r,n;t=t||"child";if(e===false){for(r=this.children.length-1;r>=0;r--){n=this.children[r];if(n.statusNodeType==="paging"){this.removeChild(n)}}this.partload=false;return}e=C.extend({title:this.tree.options.strings.moreData,statusNodeType:"paging",icon:false},e);this.partload=true;return this.addNode(e,t)},appendSibling:function(e){return this.addNode(e,"after")},applyCommand:function(e,t){return this.tree.applyCommand(e,this,t)},applyPatch:function(e){if(e===null){this.remove();return D(this)}var t,r,n,i={children:true,expanded:true,parent:true};for(t in e){if(e.hasOwnProperty(t)){n=e[t];if(!i[t]&&!C.isFunction(n)){if(s[t]){this[t]=n}else{this.data[t]=n}}}}if(e.hasOwnProperty("children")){this.removeChildren();if(e.children){this._setChildren(e.children)}}if(this.isVisible()){this.renderTitle();this.renderStatus()}if(e.hasOwnProperty("expanded")){r=this.setExpanded(e.expanded)}else{r=D(this)}return r},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(e,t,r){return e.addNode(this.toDict(true,r),t)},countChildren:function(e){var t=this.children,r,n,i;if(!t){return 0}i=t.length;if(e!==false){for(r=0,n=i;r<n;r++){i+=t[r].countChildren()}}return i},debug:function(e){if(this.tree.options.debugLevel>=4){Array.prototype.unshift.call(arguments,this.toString());u("log",arguments)}},discard:function(){this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead.");return this.resetLazy()},discardMarkup:function(e){var t=e?"nodeRemoveMarkup":"nodeRemoveChildMarkup";this.tree._callHook(t,this)},error:function(e){if(this.tree.options.debugLevel>=1){Array.prototype.unshift.call(arguments,this.toString());u("error",arguments)}},findAll:function(t){t=C.isFunction(t)?t:N(t);var r=[];this.visit(function(e){if(t(e)){r.push(e)}});return r},findFirst:function(t){t=C.isFunction(t)?t:N(t);var r=null;this.visit(function(e){if(t(e)){r=e;return false}});return r},findRelatedNode:function(e,t){return this.tree.findRelatedNode(this,e,t)},_changeSelectStatusAttrs:function(e){var t=false,r=this.tree.options,n=g.evalOption("unselectable",this,this,r,false),i=g.evalOption("unselectableStatus",this,this,r,undefined);if(n&&i!=null){e=i}switch(e){case false:t=this.selected||this.partsel;this.selected=false;this.partsel=false;break;case true:t=!this.selected||!this.partsel;this.selected=true;this.partsel=true;break;case undefined:t=this.selected||!this.partsel;this.selected=false;this.partsel=true;break;default:T(false,"invalid state: "+e)}if(t){this.renderStatus()}return t},fixSelection3AfterClick:function(e){var t=this.isSelected();this.visit(function(e){e._changeSelectStatusAttrs(t);if(e.radiogroup){return"skip"}});this.fixSelection3FromEndNodes(e)},fixSelection3FromEndNodes:function(e){var c=this.tree.options;T(c.selectMode===3,"expected selectMode 3");function d(e){var t,r,n,i,a,o,s,l,u,f=e.children;if(f&&f.length){o=true;s=false;for(t=0,r=f.length;t<r;t++){n=f[t];i=d(n);l=g.evalOption("unselectableIgnore",n,n,c,false);if(!l){if(i!==false){s=true}if(i!==true){o=false}}}a=o?true:s?undefined:false}else{u=g.evalOption("unselectableStatus",e,e,c,undefined);a=u==null?!!e.selected:!!u}if(e.partsel&&!e.selected&&e.lazy&&e.children==null){a=undefined}e._changeSelectStatusAttrs(a);return a}d(this);this.visitParents(function(e){var t,r,n,i,a,o,s=e.children,l=true,u=false;for(t=0,r=s.length;t<r;t++){n=s[t];a=g.evalOption("unselectableIgnore",n,n,c,false);if(!a){o=g.evalOption("unselectableStatus",n,n,c,undefined);i=o==null?!!n.selected:!!o;if(i||n.partsel){u=true}if(!i){l=false}}}i=l?true:u?undefined:false;e._changeSelectStatusAttrs(i)})},fromDict:function(e){for(var t in e){if(s[t]){this[t]=e[t]}else if(t==="data"){C.extend(this.data,e.data)}else if(!C.isFunction(e[t])&&!l[t]){this.data[t]=e[t]}}if(e.children){this.removeChildren();this.addChildren(e.children)}this.renderTitle()},getChildren:function(){if(this.hasChildren()===undefined){return undefined}return this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return C.inArray(this,this.parent.children)},getIndexHier:function(e,r){e=e||".";var n,i=[];C.each(this.getParentList(false,true),function(e,t){n=""+(t.getIndex()+1);if(r){n=("0000000"+n).substr(-r)}i.push(n)});return i.join(e)},getKeyPath:function(e){var t=this.tree.options.keyPathSeparator;return t+this.getPath(!e,"key",t)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){var e=0,t=this.parent;while(t){e++;t=t.parent}return e},getNextSibling:function(){if(this.parent){var e,t,r=this.parent.children;for(e=0,t=r.length-1;e<t;e++){if(r[e]===this){return r[e+1]}}}return null},getParent:function(){return this.parent},getParentList:function(e,t){var r=[],n=t?this:this.parent;while(n){if(e||n.parent){r.unshift(n)}n=n.parent}return r},getPath:function(e,t,r){e=e!==false;t=t||"title";r=r||"/";var n,i=[],a=C.isFunction(t);this.visitParents(function(e){if(e.parent){n=a?t(e):e[t];i.unshift(n)}},e);return i.join(r)},getPrevSibling:function(){if(this.parent){var e,t,r=this.parent.children;for(e=1,t=r.length;e<t;e++){if(r[e]===this){return r[e-1]}}}return null},getSelectedNodes:function(t){var r=[];this.visit(function(e){if(e.selected){r.push(e);if(t===true){return"skip"}}});return r},hasChildren:function(){if(this.lazy){if(this.children==null){return undefined}else if(this.children.length===0){return false}else if(this.children.length===1&&this.children[0].isStatusNode()){return undefined}return true}return!!(this.children&&this.children.length)},hasClass:function(e){return(" "+(this.extraClasses||"")+" ").indexOf(" "+e+" ")>=0},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(e){if(this.tree.options.debugLevel>=3){Array.prototype.unshift.call(arguments,this.toString());u("info",arguments)}},isActive:function(){return this.tree.activeNode===this},isBelowOf:function(e){return this.getIndexHier(".",5)>e.getIndexHier(".",5)},isChildOf:function(e){return this.parent&&this.parent===e},isDescendantOf:function(e){if(!e||e.tree!==this.tree){return false}var t=this.parent;while(t){if(t===e){return true}if(t===t.parent){C.error("Recursive parent link: "+t)}t=t.parent}return false},isExpanded:function(){return!!this.expanded},isFirstSibling:function(){var e=this.parent;return!e||e.children[0]===this},isFolder:function(){return!!this.folder},isLastSibling:function(){var e=this.parent;return!e||e.children[e.children.length-1]===this},isLazy:function(){return!!this.lazy},isLoaded:function(){return!this.lazy||this.hasChildren()!==undefined},isLoading:function(){return!!this._isLoading},isRoot:function(){return this.isRootNode()},isPartsel:function(){return!this.selected&&!!this.partsel},isPartload:function(){return!!this.partload},isRootNode:function(){return this.tree.rootNode===this},isSelected:function(){return!!this.selected},isStatusNode:function(){return!!this.statusNodeType},isPagingNode:function(){return this.statusNodeType==="paging"},isTopLevel:function(){return this.tree.rootNode===this.parent},isUndefined:function(){return this.hasChildren()===undefined},isVisible:function(){var e,t,r,n=this.tree.enableFilter,i=this.getParentList(false,false);if(n&&!this.match&&!this.subMatchCount){return false}for(e=0,t=i.length;e<t;e++){r=i[e];if(!r.expanded){return false}}return true},lazyLoad:function(e){C.error("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead.")},load:function(e){var t,r,n=this,i=this.isExpanded();T(this.isLazy(),"load() requires a lazy node");if(!e&&!this.isUndefined()){return D(this)}if(this.isLoaded()){this.resetLazy()}r=this.tree._triggerNodeEvent("lazyLoad",this);if(r===false){return D(this)}T(typeof r!=="boolean","lazyLoad event must return source in data.result");t=this.tree._callHook("nodeLoadChildren",this,r);if(i){this.expanded=true;t.always(function(){n.render()})}else{t.always(function(){n.renderStatus()})}return t},makeVisible:function(e){var t,r=this,n=[],i=new C.Deferred,a=this.getParentList(false,false),o=a.length,s=!(e&&e.noAnimation===true),l=!(e&&e.scrollIntoView===false);for(t=o-1;t>=0;t--){n.push(a[t].setExpanded(true,e))}C.when.apply(C,n).done(function(){if(l){r.scrollIntoView(s).done(function(){i.resolve()})}else{i.resolve()}});return i.promise()},moveTo:function(t,e,r){if(e===undefined||e==="over"){e="child"}else if(e==="firstChild"){if(t.children&&t.children.length){e="before";t=t.children[0]}else{e="child"}}var n,i=this.tree,a=this.parent,o=e==="child"?t:t.parent;if(this===t){return}else if(!this.parent){C.error("Cannot move system root")}else if(o.isDescendantOf(this)){C.error("Cannot move a node to its own descendant")}if(o!==a){a.triggerModifyChild("remove",this)}if(this.parent.children.length===1){if(this.parent===o){return}this.parent.children=this.parent.lazy?[]:null;this.parent.expanded=false}else{n=C.inArray(this,this.parent.children);T(n>=0,"invalid source parent");this.parent.children.splice(n,1)}this.parent=o;if(o.hasChildren()){switch(e){case"child":o.children.push(this);break;case"before":n=C.inArray(t,o.children);T(n>=0,"invalid target parent");o.children.splice(n,0,this);break;case"after":n=C.inArray(t,o.children);T(n>=0,"invalid target parent");o.children.splice(n+1,0,this);break;default:C.error("Invalid mode "+e)}}else{o.children=[this]}if(r){t.visit(r,true)}if(o===a){o.triggerModifyChild("move",this)}else{o.triggerModifyChild("add",this)}if(i!==t.tree){this.warn("Cross-tree moveTo is experimental!");this.visit(function(e){e.tree=t.tree},true)}i._callHook("treeStructureChanged",i,"moveTo");if(!a.isDescendantOf(o)){a.render()}if(!o.isDescendantOf(a)&&o!==a){o.render()}},navigate:function(e,t){var r,n=C.ui.keyCode;switch(e){case"left":case n.LEFT:if(this.expanded){return this.setExpanded(false)}break;case"right":case n.RIGHT:if(!this.expanded&&(this.children||this.lazy)){return this.setExpanded()}break}r=this.findRelatedNode(e);if(r){try{r.makeVisible({scrollIntoView:false})}catch(e){}if(t===false){r.setFocus();return D()}return r.setActive()}this.warn("Could not find related node '"+e+"'.");return D()},remove:function(){return this.parent.removeChild(this)},removeChild:function(e){return this.tree._callHook("nodeRemoveChild",this,e)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},removeClass:function(e){return this.toggleClass(e,false)},render:function(e,t){return this.tree._callHook("nodeRender",this,e,t)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},replaceWith:function(e){var t,r=this.parent,n=C.inArray(this,r.children),i=this;T(this.isPagingNode(),"replaceWith() currently requires a paging status node");t=this.tree._callHook("nodeLoadChildren",this,e);t.done(function(e){var t=i.children;for(a=0;a<t.length;a++){t[a].parent=r}r.children.splice.apply(r.children,[n+1,0].concat(t));i.children=null;i.remove();r.render()}).fail(function(){i.setExpanded()});return t},resetLazy:function(){this.removeChildren();this.expanded=false;this.lazy=true;this.children=undefined;this.renderStatus()},scheduleAction:function(e,t){if(this.tree.timer){clearTimeout(this.tree.timer);this.tree.debug("clearTimeout(%o)",this.tree.timer)}this.tree.timer=null;var r=this;switch(e){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){r.tree.debug("setTimeout: trigger expand");r.setExpanded(true)},t);break;case"activate":this.tree.timer=setTimeout(function(){r.tree.debug("setTimeout: trigger activate");r.setActive(true)},t);break;default:C.error("Invalid mode "+e)}},scrollIntoView:function(e,t){if(t!==undefined&&_(t)){throw Error("scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead.")}var r=C.extend({effects:e===true?{duration:200,queue:false}:e,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent,topNode:null},t),n=r.scrollParent,i=this.tree.$container,a=i.css("overflow-y");if(!n){if(this.tree.tbody){n=i.scrollParent()}else if(a==="scroll"||a==="auto"){n=i}else{n=i.scrollParent()}}else if(!n.jquery){n=C(n)}if(n[0]===document||n[0]===document.body){this.debug("scrollIntoView(): normalizing scrollParent to 'window':",n[0]);n=C(window)}var o,s,l,u,f=new C.Deferred,c=this,d=C(this.span).height(),h=r.scrollOfs.top||0,v=r.scrollOfs.bottom||0,p=n.height(),g=n.scrollTop(),m=n,y=n[0]===window,b=r.topNode||null,w=null;if(this.isRootNode()||!this.isVisible()){this.info("scrollIntoView(): node is invisible.");return D()}if(y){s=C(this.span).offset().top;o=b&&b.span?C(b.span).offset().top:0;m=C("html,body")}else{T(n[0]!==document&&n[0]!==document.body,"scrollParent should be a simple element or `window`, not document or body.");u=n.offset().top;s=C(this.span).offset().top-u+g;o=b?C(b.span).offset().top-u+g:0;l=Math.max(0,n.innerHeight()-n[0].clientHeight);p-=l}if(s<g+h){w=s-h}else if(s+d>g+p-v){w=s+d-p+v;if(b){T(b.isRootNode()||b.isVisible(),"topNode must be visible");if(o<w){w=o-h}}}if(w===null){f.resolveWith(this)}else{if(r.effects){r.effects.complete=function(){f.resolveWith(c)};m.stop(true).animate({scrollTop:w},r.effects)}else{m[0].scrollTop=w;f.resolveWith(this)}}return f.promise()},setActive:function(e,t){return this.tree._callHook("nodeSetActive",this,e,t)},setExpanded:function(e,t){return this.tree._callHook("nodeSetExpanded",this,e,t)},setFocus:function(e){return this.tree._callHook("nodeSetFocus",this,e)},setSelected:function(e,t){return this.tree._callHook("nodeSetSelected",this,e,t)},setStatus:function(e,t,r){return this.tree._callHook("nodeSetStatus",this,e,t,r)},setTitle:function(e){this.title=e;this.renderTitle();this.triggerModify("rename")},sortChildren:function(e,t){var r,n,i=this.children;if(!i){return}e=e||function(e,t){var r=e.title.toLowerCase(),n=t.title.toLowerCase();return r===n?0:r>n?1:-1};i.sort(e);if(t){for(r=0,n=i.length;r<n;r++){if(i[r].children){i[r].sortChildren(e,"$norender$")}}}if(t!=="$norender$"){this.render()}this.triggerModifyChild("sort")},toDict:function(e,t){var r,n,i,a,o={},s=this;C.each(E,function(e,t){if(s[t]||s[t]===false){o[t]=s[t]}});if(!C.isEmptyObject(this.data)){o.data=C.extend({},this.data);if(C.isEmptyObject(o.data)){delete o.data}}if(t){a=t(o,s);if(a===false){return false}if(a==="skip"){e=false}}if(e){if(C.isArray(this.children)){o.children=[];for(r=0,n=this.children.length;r<n;r++){i=this.children[r];if(!i.isStatusNode()){a=i.toDict(true,t);if(a!==false){o.children.push(a)}}}}}return o},toggleClass:function(e,t){var r,n,i=/\S+/g,a=e.match(i)||[],o=0,s=false,l=this[this.tree.statusClassPropName],u=" "+(this.extraClasses||"")+" ";if(l){C(l).toggleClass(e,t)}while(r=a[o++]){n=u.indexOf(" "+r+" ")>=0;t=t===undefined?!n:!!t;if(t){if(!n){u+=r+" ";s=true}}else{while(u.indexOf(" "+r+" ")>-1){u=u.replace(" "+r+" "," ")}}}this.extraClasses=C.trim(u);return s},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"FancytreeNode@"+this.key+"[title='"+this.title+"']"},triggerModifyChild:function(e,t,r){var n,i=this.tree.options.modifyChild;if(i){if(t&&t.parent!==this){C.error("childNode "+t+" is not a child of "+this)}n={node:this,tree:this.tree,operation:e,childNode:t||null};if(r){C.extend(n,r)}i({type:"modifyChild"},n)}},triggerModify:function(e,t){this.parent.triggerModifyChild(e,this,t)},visit:function(e,t){var r,n,i=true,a=this.children;if(t===true){i=e(this);if(i===false||i==="skip"){return i}}if(a){for(r=0,n=a.length;r<n;r++){i=a[r].visit(e,true);if(i===false){break}}}return i},visitAndLoad:function(r,e,t){var n,i,a,o=this;if(r&&e===true){i=r(o);if(i===false||i==="skip"){return t?i:D()}}if(!o.children&&!o.lazy){return D()}n=new C.Deferred;a=[];o.load().done(function(){for(var e=0,t=o.children.length;e<t;e++){i=o.children[e].visitAndLoad(r,true,true);if(i===false){n.reject();break}else if(i!=="skip"){a.push(i)}}C.when.apply(this,a).then(function(){n.resolve()})});return n.promise()},visitParents:function(e,t){if(t&&e(this)===false){return false}var r=this.parent;while(r){if(e(r)===false){return false}r=r.parent}return true},visitSiblings:function(e,t){var r,n,i,a=this.parent.children;for(r=0,n=a.length;r<n;r++){i=a[r];if(t||i!==this){if(e(i)===false){return false}}}return true},warn:function(e){if(this.tree.options.debugLevel>=2){Array.prototype.unshift.call(arguments,this.toString());u("warn",arguments)}}};function P(e){this.widget=e;this.$div=e.element;this.options=e.options;if(this.options){if(this.options.lazyload!==undefined){C.error("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead.")}if(this.options.loaderror!==undefined){C.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead.")}if(this.options.fx!==undefined){C.error("The 'fx' option was replaced by 'toggleEffect' since 2014-11-30.")}if(this.options.removeNode!==undefined){C.error("The 'removeNode' event was replaced by 'modifyChild' since 2.20 (2016-09-10).")}}this.ext={};this.types={};this.columns={};this.data=O(this.$div);this._id=""+(this.options.treeId||C.ui.fancytree._nextId++);this._ns=".fancytree-"+this._id;this.activeNode=null;this.focusNode=null;this._hasFocus=null;this._tempCache={};this._lastMousedownNode=null;this._enableUpdate=true;this.lastSelectedNode=null;this.systemFocusElement=null;this.lastQuicksearchTerm="";this.lastQuicksearchTime=0;this.viewport=null;this.statusClassPropName="span";this.ariaPropName="li";this.nodeContainerAttrName="li";this.$div.find(">ul.fancytree-container").remove();var t={tree:this},r;this.rootNode=new L(t,{title:"root",key:"root_"+this._id,children:null,expanded:true});this.rootNode.parent=null;r=C("<ul>",{id:"ft-id-"+this._id,class:"ui-fancytree fancytree-container fancytree-plain"}).appendTo(this.$div);this.$container=r;this.rootNode.ul=r[0];if(this.options.debugLevel==null){this.options.debugLevel=g.debugLevel}}P.prototype={_makeHookContext:function(e,t,r){var n,i;if(e.node!==undefined){if(t&&e.originalEvent!==t){C.error("invalid args")}n=e}else if(e.tree){i=e.tree;n={node:e,tree:i,widget:i.widget,options:i.widget.options,originalEvent:t,typeInfo:i.types[e.type]||{}}}else if(e.widget){n={node:null,tree:e,widget:e.widget,options:e.widget.options,originalEvent:t}}else{C.error("invalid args")}if(r){C.extend(n,r)}return n},_callHook:function(e,t,r){var n=this._makeHookContext(t),i=this[e],a=Array.prototype.slice.call(arguments,2);if(!C.isFunction(i)){C.error("_callHook('"+e+"') is not a function")}a.unshift(n);return i.apply(this,a)},_setExpiringValue:function(e,t,r){this._tempCache[e]={value:t,expire:Date.now()+(+r||50)}},_getExpiringValue:function(e){var t=this._tempCache[e];if(t&&t.expire>Date.now()){return t.value}delete this._tempCache[e];return null},_usesExtension:function(e){return C.inArray(e,this.options.extensions)>=0},_requireExtension:function(e,t,r,n){if(r!=null){r=!!r}var i=this._local.name,a=this.options.extensions,o=C.inArray(e,a)<C.inArray(i,a),s=t&&this.ext[e]==null,l=!s&&r!=null&&r!==o;T(i&&i!==e,"invalid or same name '"+i+"' (require yourself?)");if(s||l){if(!n){if(s||t){n="'"+i+"' extension requires '"+e+"'";if(l){n+=" to be registered "+(r?"before":"after")+" itself"}}else{n="If used together, `"+e+"` must be registered "+(r?"before":"after")+" `"+i+"`"}}C.error(n);return false}return true},activateKey:function(e,t){var r=this.getNodeByKey(e);if(r){r.setActive(true,t)}else if(this.activeNode){this.activeNode.setActive(false,t)}return r},addPagingNode:function(e,t){return this.rootNode.addPagingNode(e,t)},applyCommand:function(e,t,r){var n;t=t||this.getActiveNode();switch(e){case"moveUp":n=t.getPrevSibling();if(n){t.moveTo(n,"before");t.setActive()}break;case"moveDown":n=t.getNextSibling();if(n){t.moveTo(n,"after");t.setActive()}break;case"indent":n=t.getPrevSibling();if(n){t.moveTo(n,"child");n.setExpanded();t.setActive()}break;case"outdent":if(!t.isTopLevel()){t.moveTo(t.getParent(),"after");t.setActive()}break;case"remove":n=t.getPrevSibling()||t.getParent();t.remove();if(n){n.setActive()}break;case"addChild":t.editCreateNode("child","");break;case"addSibling":t.editCreateNode("after","");break;case"rename":t.editStart();break;case"down":case"first":case"last":case"left":case"parent":case"right":case"up":return t.navigate(e);default:C.error("Unhandled command: '"+e+"'")}},applyPatch:function(e){var t,r,n,i,a,o,s=e.length,l=[];for(r=0;r<s;r++){n=e[r];T(n.length===2,"patchList must be an array of length-2-arrays");i=n[0];a=n[1];o=i===null?this.rootNode:this.getNodeByKey(i);if(o){t=new C.Deferred;l.push(t);o.applyPatch(a).always(I(t,o))}else{this.warn("could not find node with key '"+i+"'")}}return C.when.apply(C,l).promise()},clear:function(e){this._callHook("treeClear",this)},count:function(){return this.rootNode.countChildren()},debug:function(e){if(this.options.debugLevel>=4){Array.prototype.unshift.call(arguments,this.toString());u("log",arguments)}},destroy:function(){this.widget.destroy()},enable:function(e){if(e===false){this.widget.disable()}else{this.widget.enable()}},enableUpdate:function(e){e=e!==false;if(!!this._enableUpdate===!!e){return e}this._enableUpdate=e;if(e){this.debug("enableUpdate(true): redraw ");this._callHook("treeStructureChanged",this,"enableUpdate");this.render()}else{this.debug("enableUpdate(false)...")}return!e},error:function(e){if(this.options.debugLevel>=1){Array.prototype.unshift.call(arguments,this.toString());u("error",arguments)}},expandAll:function(t,r){var e=this.enableUpdate(false);t=t!==false;this.visit(function(e){if(e.hasChildren()!==false&&e.isExpanded()!==t){e.setExpanded(t,r)}});this.enableUpdate(e)},findAll:function(e){return this.rootNode.findAll(e)},findFirst:function(e){return this.rootNode.findFirst(e)},findNextNode:function(t,r){var n=null,e=this.getFirstChild();t=typeof t==="string"?M(t):t;r=r||e;function i(e){if(t(e)){n=e}if(n||e===r){return false}}this.visitRows(i,{start:r,includeSelf:false});if(!n&&r!==e){this.visitRows(i,{start:e,includeSelf:true})}return n},findRelatedNode:function(e,t,r){var n=null,i=C.ui.keyCode;switch(t){case"parent":case i.BACKSPACE:if(e.parent&&e.parent.parent){n=e.parent}break;case"first":case i.HOME:this.visit(function(e){if(e.isVisible()){n=e;return false}});break;case"last":case i.END:this.visit(function(e){if(e.isVisible()){n=e}});break;case"left":case i.LEFT:if(e.expanded){e.setExpanded(false)}else if(e.parent&&e.parent.parent){n=e.parent}break;case"right":case i.RIGHT:if(!e.expanded&&(e.children||e.lazy)){e.setExpanded();n=e}else if(e.children&&e.children.length){n=e.children[0]}break;case"up":case i.UP:this.visitRows(function(e){n=e;return false},{start:e,reverse:true,includeSelf:false});break;case"down":case i.DOWN:this.visitRows(function(e){n=e;return false},{start:e,includeSelf:false});break;default:this.tree.warn("Unknown relation '"+t+"'.")}return n},generateFormElements:function(e,t,r){r=r||{};var n,i=typeof e==="string"?e:"ft_"+this._id+"[]",a=typeof t==="string"?t:"ft_"+this._id+"_active",o="fancytree_result_"+this._id,s=C("#"+o),l=this.options.selectMode===3&&r.stopOnParents!==false;if(s.length){s.empty()}else{s=C("<div>",{id:o}).hide().insertAfter(this.$container)}if(t!==false&&this.activeNode){s.append(C("<input>",{type:"radio",name:a,value:this.activeNode.key,checked:true}))}function u(e){s.append(C("<input>",{type:"checkbox",name:i,value:e.key,checked:true}))}if(r.filter){this.visit(function(e){var t=r.filter(e);if(t==="skip"){return t}if(t!==false){u(e)}})}else if(e!==false){n=this.getSelectedNodes(l);C.each(n,function(e,t){u(t)})}},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(){return this.focusNode},getOption:function(e){return this.widget.option(e)},getNodeByKey:function(t,e){var r,n;if(!e){r=document.getElementById(this.options.idPrefix+t);if(r){return r.ftnode?r.ftnode:null}}e=e||this.rootNode;n=null;t=""+t;e.visit(function(e){if(e.key===t){n=e;return false}},true);return n},getRootNode:function(){return this.rootNode},getSelectedNodes:function(e){return this.rootNode.getSelectedNodes(e)},hasFocus:function(){return!!this._hasFocus},info:function(e){if(this.options.debugLevel>=3){Array.prototype.unshift.call(arguments,this.toString());u("info",arguments)}},isLoading:function(){var t=false;this.rootNode.visit(function(e){if(e._isLoading||e._requestId){t=true;return false}},true);return t},loadKeyPath:function(e,t){var n,r,i,a=this,o=new C.Deferred,s=this.getRootNode(),l=this.options.keyPathSeparator,u=[],f=C.extend({},t);if(typeof t==="function"){n=t}else if(t&&t.callback){n=t.callback}f.callback=function(e,t,r){if(n){n.call(e,t,r)}o.notifyWith(e,[{node:t,status:r}])};if(f.matchKey==null){f.matchKey=function(e,t){return e.key===t}}if(!C.isArray(e)){e=[e]}for(r=0;r<e.length;r++){i=e[r];if(i.charAt(0)===l){i=i.substr(1)}u.push(i.split(l))}setTimeout(function(){a._loadKeyPathImpl(o,f,s,u).done(function(){o.resolve()})},0);return o.promise()},_loadKeyPathImpl:function(e,a,t,r){var n,i,o,s,l,u,f,c,d,h,v=this;function p(e,t){var r,n,i=e.children;if(i){for(r=0,n=i.length;r<n;r++){if(a.matchKey(i[r],t)){return i[r]}}}return null}f={};for(i=0;i<r.length;i++){d=r[i];c=t;while(d.length){o=d.shift();s=p(c,o);if(!s){this.warn("loadKeyPath: key not found: "+o+" (parent: "+c+")");a.callback(this,o,"error");break}else if(d.length===0){a.callback(this,s,"ok");break}else if(!s.lazy||s.hasChildren()!==undefined){a.callback(this,s,"loaded");c=s}else{a.callback(this,s,"loaded");o=s.key;if(f[o]){f[o].pathSegList.push(d)}else{f[o]={parent:s,pathSegList:[d]}}break}}}n=[];function g(t,r,e){a.callback(v,r,"loading");r.load().done(function(){v._loadKeyPathImpl.call(v,t,a,r,e).always(I(t,v))}).fail(function(e){v.warn("loadKeyPath: error loading lazy "+r);a.callback(v,s,"error");t.rejectWith(v)})}for(l in f){if(f.hasOwnProperty(l)){u=f[l];h=new C.Deferred;n.push(h);g(h,u.parent,u.pathSegList)}}return C.when.apply(C,n).promise()},reactivate:function(e){var t,r=this.activeNode;if(!r){return D()}this.activeNode=null;t=r.setActive(true,{noFocus:true});if(e){r.setFocus()}return t},reload:function(e){this._callHook("treeClear",this);return this._callHook("treeLoad",this,e)},render:function(e,t){return this.rootNode.render(e,t)},selectAll:function(t){this.visit(function(e){e.setSelected(t)})},setFocus:function(e){return this._callHook("treeSetFocus",this,e)},setOption:function(e,t){return this.widget.option(e,t)},debugTime:function(e){if(this.options.debugLevel>=4){window.console.time(this+" - "+e)}},debugTimeEnd:function(e){if(this.options.debugLevel>=4){window.console.timeEnd(this+" - "+e)}},toDict:function(e,t){var r=this.rootNode.toDict(true,t);return e?r:r.children},toString:function(){return"Fancytree@"+this._id},_triggerNodeEvent:function(e,t,r,n){var i=this._makeHookContext(t,r,n),a=this.widget._trigger(e,r,i);if(a!==false&&i.result!==undefined){return i.result}return a},_triggerTreeEvent:function(e,t,r){var n=this._makeHookContext(this,t,r),i=this.widget._trigger(e,t,n);if(i!==false&&n.result!==undefined){return n.result}return i},visit:function(e){return this.rootNode.visit(e,false)},visitRows:function(t,e){if(!this.rootNode.hasChildren()){return false}if(e&&e.reverse){delete e.reverse;return this._visitRowsUp(t,e)}e=e||{};var r,n,i,a,o,s=0,l=e.includeSelf===false,u=!!e.includeHidden,f=!u&&this.enableFilter,c=e.start||this.rootNode.children[0];i=c.parent;while(i){o=i.children;n=o.indexOf(c)+s;T(n>=0,"Could not find "+c+" in parent's children: "+i);for(r=n;r<o.length;r++){c=o[r];if(f&&!c.match&&!c.subMatchCount){continue}if(!l&&t(c)===false){return false}l=false;if(c.children&&c.children.length&&(u||c.expanded)){a=c.visit(function(e){if(f&&!e.match&&!e.subMatchCount){return"skip"}if(t(e)===false){return false}if(!u&&e.children&&!e.expanded){return"skip"}},false);if(a===false){return false}}}c=i;i=i.parent;s=1}return true},_visitRowsUp:function(e,t){var r,n,i,a=!!t.includeHidden,o=t.start||this.rootNode.children[0];while(true){i=o.parent;r=i.children;if(r[0]===o){o=i;if(!o.parent){break}r=i.children}else{n=r.indexOf(o);o=r[n-1];while((a||o.expanded)&&o.children&&o.children.length){r=o.children;i=o;o=r[r.length-1]}}if(!a&&!o.isVisible()){continue}if(e(o)===false){return false}}},warn:function(e){if(this.options.debugLevel>=2){Array.prototype.unshift.call(arguments,this.toString());u("warn",arguments)}}};C.extend(P.prototype,{nodeClick:function(e){var t,r,n=e.targetType,i=e.node;if(n==="expander"){if(i.isLoading()){i.debug("Got 2nd click while loading: ignored");return}this._callHook("nodeToggleExpanded",e)}else if(n==="checkbox"){this._callHook("nodeToggleSelected",e);if(e.options.focusOnSelect){this._callHook("nodeSetFocus",e,true)}}else{r=false;t=true;if(i.folder){switch(e.options.clickFolderMode){case 2:r=true;t=false;break;case 3:t=true;r=true;break}}if(t){this.nodeSetFocus(e);this._callHook("nodeSetActive",e,true)}if(r){if(!t){}this._callHook("nodeToggleExpanded",e)}}},nodeCollapseSiblings:function(e,t){var r,n,i,a=e.node;if(a.parent){r=a.parent.children;for(n=0,i=r.length;n<i;n++){if(r[n]!==a&&r[n].expanded){this._callHook("nodeSetExpanded",r[n],false,t)}}}},nodeDblclick:function(e){if(e.targetType==="title"&&e.options.clickFolderMode===4){this._callHook("nodeToggleExpanded",e)}if(e.targetType==="title"){e.originalEvent.preventDefault()}},nodeKeydown:function(e){var t,r,n,i,a=e.originalEvent,o=e.node,s=e.tree,l=e.options,u=a.which,f=a.key||String.fromCharCode(u),c=!!(a.altKey||a.ctrlKey||a.metaKey),d=!b[u]&&!y[u]&&!c,h=C(a.target),v=true,p=!(a.ctrlKey||!l.autoActivate);if(!o){i=this.getActiveNode()||this.getFirstChild();if(i){i.setFocus();o=e.node=this.focusNode;o.debug("Keydown force focus on active node")}}if(l.quicksearch&&d&&!h.is(":input:enabled")){r=Date.now();if(r-s.lastQuicksearchTime>500){s.lastQuicksearchTerm=""}s.lastQuicksearchTime=r;s.lastQuicksearchTerm+=f;t=s.findNextNode(s.lastQuicksearchTerm,s.getActiveNode());if(t){t.setActive()}a.preventDefault();return}switch(g.eventToString(a)){case"+":case"=":s.nodeSetExpanded(e,true);break;case"-":s.nodeSetExpanded(e,false);break;case"space":if(o.isPagingNode()){s._triggerNodeEvent("clickPaging",e,a)}else if(g.evalOption("checkbox",o,o,l,false)){s.nodeToggleSelected(e)}else{s.nodeSetActive(e,true)}break;case"return":s.nodeSetActive(e,true);break;case"home":case"end":case"backspace":case"left":case"right":case"up":case"down":n=o.navigate(a.which,p);break;default:v=false}if(v){a.preventDefault()}},nodeLoadChildren:function(a,o){var t,r,e=null,s,n=true,l=a.tree,u=a.node,f=u.parent,i="nodeLoadChildren",c=Date.now();if(C.isFunction(o)){o=o.call(l,{type:"source"},a);T(!C.isFunction(o),"source callback must not return another function")}if(C.isFunction(o.then)){e=o}else if(o.url){t=C.extend({},a.options.ajax,o);if(t.debugDelay){r=t.debugDelay;delete t.debugDelay;if(C.isArray(r)){r=r[0]+Math.random()*(r[1]-r[0])}u.warn("nodeLoadChildren waiting debugDelay "+Math.round(r)+" ms ...");e=C.Deferred(function(e){setTimeout(function(){C.ajax(t).done(function(){e.resolveWith(this,arguments)}).fail(function(){e.rejectWith(this,arguments)})},r)})}else{e=C.ajax(t)}}else if(C.isPlainObject(o)||C.isArray(o)){e={then:function(e,t){e(o,null,null)}};n=false}else{C.error("Invalid source type: "+o)}if(u._requestId){u.warn("Recursive load request #"+c+" while #"+u._requestId+" is pending.");u._requestId=c}if(n){l.debugTime(i);l.nodeSetStatus(a,"loading")}s=new C.Deferred;e.then(function(e,t,r){var n,i;if((o.dataType==="json"||o.dataType==="jsonp")&&typeof e==="string"){C.error("Ajax request returned a string (did you get the JSON dataType wrong?).")}if(u._requestId&&u._requestId>c){s.rejectWith(this,[d]);return}if(u.parent===null&&f!==null){s.rejectWith(this,[h]);return}if(a.options.postProcess){try{i=l._triggerNodeEvent("postProcess",a,a.originalEvent,{response:e,error:null,dataType:o.dataType});if(i.error){l.warn("postProcess returned error:",i)}}catch(e){i={error:e,message:""+e,details:"postProcess failed"}}if(i.error){n=C.isPlainObject(i.error)?i.error:{message:i.error};n=l._makeHookContext(u,null,n);s.rejectWith(this,[n]);return}if(C.isArray(i)||C.isPlainObject(i)&&C.isArray(i.children)){e=i}}else if(e&&e.hasOwnProperty("d")&&a.options.enableAspx){if(a.options.enableAspx===42){l.warn("The default for enableAspx will change to `false` in the fututure. "+"Pass `enableAspx: true` or implement postProcess to silence this warning.")}e=typeof e.d==="string"?C.parseJSON(e.d):e.d}s.resolveWith(this,[e])},function(e,t,r){var n=l._makeHookContext(u,null,{error:e,args:Array.prototype.slice.call(arguments),message:r,details:e.status+": "+r});s.rejectWith(this,[n])});s.done(function(e){l.nodeSetStatus(a,"ok");var t,r,n;if(C.isPlainObject(e)){T(u.isRootNode(),"source may only be an object for root nodes (expecting an array of child objects otherwise)");T(C.isArray(e.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')");r=e;t=e.children;delete r.children;C.each(v,function(e,t){if(r[t]!==undefined){l[t]=r[t];delete r[t]}});C.extend(l.data,r)}else{t=e}T(C.isArray(t),"expected array of children");u._setChildren(t);if(l.options.nodata&&t.length===0){if(C.isFunction(l.options.nodata)){n=l.options.nodata.call(l,{type:"nodata"},a)}else if(l.options.nodata===true&&u.isRootNode()){n=l.options.strings.noData}else if(typeof l.options.nodata==="string"&&u.isRootNode()){n=l.options.nodata}if(n){u.setStatus("nodata",n)}}l._triggerNodeEvent("loadChildren",u)}).fail(function(e){var t;if(e===d){u.warn("Ignored response for obsolete load request #"+c+" (expected #"+u._requestId+")");return}else if(e===h){u.warn("Lazy parent node was removed while loading: discarding response.");return}else if(e.node&&e.error&&e.message){t=e}else{t=l._makeHookContext(u,null,{error:e,args:Array.prototype.slice.call(arguments),message:e?e.message||e.toString():""});if(t.message==="[object Object]"){t.message=""}}u.warn("Load children failed ("+t.message+")",t);if(l._triggerNodeEvent("loadError",t,null)!==false){l.nodeSetStatus(a,"error",t.message,t.details)}}).always(function(){u._requestId=null;if(n){l.debugTimeEnd(i)}});return s.promise()},nodeLoadKeyPath:function(e,t){},nodeRemoveChild:function(e,t){var r,n=e.node,i=C.extend({},e,{node:t}),a=n.children;if(a.length===1){T(t===a[0],"invalid single child");return this.nodeRemoveChildren(e)}if(this.activeNode&&(t===this.activeNode||this.activeNode.isDescendantOf(t))){this.activeNode.setActive(false)}if(this.focusNode&&(t===this.focusNode||this.focusNode.isDescendantOf(t))){this.focusNode=null}this.nodeRemoveMarkup(i);this.nodeRemoveChildren(i);r=C.inArray(t,a);T(r>=0,"invalid child");n.triggerModifyChild("remove",t);t.visit(function(e){e.parent=null},true);this._callHook("treeRegisterNode",this,false,t);a.splice(r,1)},nodeRemoveChildMarkup:function(e){var t=e.node;if(t.ul){if(t.isRootNode()){C(t.ul).empty()}else{C(t.ul).remove();t.ul=null}t.visit(function(e){e.li=e.ul=null})}},nodeRemoveChildren:function(e){var t=e.tree,r=e.node,n=r.children;if(!n){return}if(this.activeNode&&this.activeNode.isDescendantOf(r)){this.activeNode.setActive(false)}if(this.focusNode&&this.focusNode.isDescendantOf(r)){this.focusNode=null}this.nodeRemoveChildMarkup(e);r.triggerModifyChild("remove",null);r.visit(function(e){e.parent=null;t._callHook("treeRegisterNode",t,false,e)});if(r.lazy){r.children=[]}else{r.children=null}if(!r.isRootNode()){r.expanded=false}this.nodeRenderStatus(e)},nodeRemoveMarkup:function(e){var t=e.node;if(t.li){C(t.li).remove();t.li=null}this.nodeRemoveChildMarkup(e)},nodeRender:function(e,t,r,n,i){var a,o,s,l,u,f,c,d=e.node,h=e.tree,v=e.options,p=v.aria,g=false,m=d.parent,y=!m,b=d.children,w=null;if(h._enableUpdate===false){return}if(!y&&!m.ul){return}T(y||m.ul,"parent UL must exist");if(!y){if(d.li&&(t||d.li.parentNode!==d.parent.ul)){if(d.li.parentNode===d.parent.ul){w=d.li.nextSibling}else{this.debug("Unlinking "+d+" (must be child of "+d.parent+")")}this.nodeRemoveMarkup(e)}if(d.li){this.nodeRenderStatus(e)}else{g=true;d.li=document.createElement("li");d.li.ftnode=d;if(d.key&&v.generateIds){d.li.id=v.idPrefix+d.key}d.span=document.createElement("span");d.span.className="fancytree-node";if(p&&!d.tr){C(d.li).attr("role","treeitem")}d.li.appendChild(d.span);this.nodeRenderTitle(e);if(v.createNode){v.createNode.call(h,{type:"createNode"},e)}}if(v.renderNode){v.renderNode.call(h,{type:"renderNode"},e)}}if(b){if(y||d.expanded||r===true){if(!d.ul){d.ul=document.createElement("ul");if(n===true&&!i||!d.expanded){d.ul.style.display="none"}if(p){C(d.ul).attr("role","group")}if(d.li){d.li.appendChild(d.ul)}else{d.tree.$div.append(d.ul)}}for(l=0,u=b.length;l<u;l++){c=C.extend({},e,{node:b[l]});this.nodeRender(c,t,r,false,true)}a=d.ul.firstChild;while(a){s=a.ftnode;if(s&&s.parent!==d){d.debug("_fixParent: remove missing "+s,a);f=a.nextSibling;a.parentNode.removeChild(a);a=f}else{a=a.nextSibling}}a=d.ul.firstChild;for(l=0,u=b.length-1;l<u;l++){o=b[l];s=a.ftnode;if(o===s){a=a.nextSibling}else{d.ul.insertBefore(o.li,s.li)}}}}else{if(d.ul){this.warn("remove child markup for "+d);this.nodeRemoveChildMarkup(e)}}if(!y){if(g){m.ul.insertBefore(d.li,w)}}},nodeRenderTitle:function(e,t){var r,n,i,a,o,s,l,u,f=e.node,c=e.tree,d=e.options,h=d.aria,v=f.getLevel(),p=[];if(t!==undefined){f.title=t}if(!f.span||c._enableUpdate===false){return}o=h&&f.hasChildren()!==false?" role='button'":"";if(v<d.minExpandLevel){if(!f.lazy){f.expanded=true}if(v>1){p.push("<span "+o+" class='fancytree-expander fancytree-expander-fixed'></span>")}}else{p.push("<span "+o+" class='fancytree-expander'></span>")}r=g.evalOption("checkbox",f,f,d,false);if(r&&!f.isStatusNode()){o=h?" role='checkbox'":"";n="fancytree-checkbox";if(r==="radio"||f.parent&&f.parent.radiogroup){n+=" fancytree-radio"}p.push("<span "+o+" class='"+n+"'></span>")}if(f.data.iconClass!==undefined){if(f.icon){C.error("'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead")}else{f.warn("'iconClass' node option is deprecated since v2.14.0: use 'icon' instead");f.icon=f.data.iconClass}}i=g.evalOption("icon",f,f,d,true);if(i!==false){o=h?" role='presentation'":"";u=g.evalOption("iconTooltip",f,f,d,null);u=u?" title='"+A(u)+"'":"";if(typeof i==="string"){if(m.test(i)){i=i.charAt(0)==="/"?i:(d.imagePath||"")+i;p.push("<img src='"+i+"' class='fancytree-icon'"+u+" alt='' />")}else{p.push("<span "+o+" class='fancytree-custom-icon "+i+"'"+u+"></span>")}}else if(i.text){p.push("<span "+o+" class='fancytree-custom-icon "+(i.addClass||"")+"'"+u+">"+g.escapeHtml(i.text)+"</span>")}else if(i.html){p.push("<span "+o+" class='fancytree-custom-icon "+(i.addClass||"")+"'"+u+">"+i.html+"</span>")}else{p.push("<span "+o+" class='fancytree-icon'"+u+"></span>")}}a="";if(d.renderTitle){a=d.renderTitle.call(c,{type:"renderTitle"},e)||""}if(!a){l=g.evalOption("tooltip",f,f,d,null);if(l===true){l=f.title}l=l?" title='"+A(l)+"'":"";s=d.titlesTabbable?" tabindex='0'":"";a="<span class='fancytree-title'"+l+s+">"+(d.escapeTitles?g.escapeHtml(f.title):f.title)+"</span>"}p.push(a);f.span.innerHTML=p.join("");this.nodeRenderStatus(e);if(d.enhanceTitle){e.$title=C(">span.fancytree-title",f.span);a=d.enhanceTitle.call(c,{type:"enhanceTitle"},e)||""}},nodeRenderStatus:function(e){var t,r=e.node,n=e.tree,i=e.options,a=r.hasChildren(),o=r.isLastSibling(),s=i.aria,l=i._classNames,u=[],f=r[n.statusClassPropName];if(!f||n._enableUpdate===false){return}if(s){t=C(r.tr||r.li)}u.push(l.node);if(n.activeNode===r){u.push(l.active)}if(n.focusNode===r){u.push(l.focused)}if(r.expanded){u.push(l.expanded)}if(s){if(a===false){t.removeAttr("aria-expanded")}else{t.attr("aria-expanded",Boolean(r.expanded))}}if(r.folder){u.push(l.folder)}if(a!==false){u.push(l.hasChildren)}if(o){u.push(l.lastsib)}if(r.lazy&&r.children==null){u.push(l.lazy)}if(r.partload){u.push(l.partload)}if(r.partsel){u.push(l.partsel)}if(g.evalOption("unselectable",r,r,i,false)){u.push(l.unselectable)}if(r._isLoading){u.push(l.loading)}if(r._error){u.push(l.error)}if(r.statusNodeType){u.push(l.statusNodePrefix+r.statusNodeType)}if(r.selected){u.push(l.selected);if(s){t.attr("aria-selected",true)}}else if(s){t.attr("aria-selected",false)}if(r.extraClasses){u.push(r.extraClasses)}if(a===false){u.push(l.combinedExpanderPrefix+"n"+(o?"l":""))}else{u.push(l.combinedExpanderPrefix+(r.expanded?"e":"c")+(r.lazy&&r.children==null?"d":"")+(o?"l":""))}u.push(l.combinedIconPrefix+(r.expanded?"e":"c")+(r.folder?"f":""));f.className=u.join(" ");if(r.li){C(r.li).toggleClass(l.lastsib,o)}},nodeSetActive:function(e,t,r){r=r||{};var n,i=e.node,a=e.tree,o=e.options,s=r.noEvents===true,l=r.noFocus===true,u=r.scrollIntoView!==false,f=i===a.activeNode;t=t!==false;if(f===t){return D(i)}if(u&&e.originalEvent&&C(e.originalEvent.target).is("a,:checkbox")){i.info("Not scrolling while clicking an embedded link.");u=false}if(t&&!s&&this._triggerNodeEvent("beforeActivate",i,e.originalEvent)===false){return R(i,["rejected"])}if(t){if(a.activeNode){T(a.activeNode!==i,"node was active (inconsistency)");n=C.extend({},e,{node:a.activeNode});a.nodeSetActive(n,false);T(a.activeNode===null,"deactivate was out of sync?")}if(o.activeVisible){i.makeVisible({scrollIntoView:u})}a.activeNode=i;a.nodeRenderStatus(e);if(!l){a.nodeSetFocus(e)}if(!s){a._triggerNodeEvent("activate",i,e.originalEvent)}}else{T(a.activeNode===i,"node was not active (inconsistency)");a.activeNode=null;this.nodeRenderStatus(e);if(!s){e.tree._triggerNodeEvent("deactivate",i,e.originalEvent)}}return D(i)},nodeSetExpanded:function(a,o,e){e=e||{};var t,r,n,i,s,l,u=a.node,f=a.tree,c=a.options,d=e.noAnimation===true,h=e.noEvents===true;o=o!==false;if(C(u.li).hasClass(c._classNames.animating)){u.warn("setExpanded("+o+") while animating: ignored.");return R(u,["recursion"])}if(u.expanded&&o||!u.expanded&&!o){return D(u)}else if(o&&!u.lazy&&!u.hasChildren()){return D(u)}else if(!o&&u.getLevel()<c.minExpandLevel){return R(u,["locked"])}else if(!h&&this._triggerNodeEvent("beforeExpand",u,a.originalEvent)===false){return R(u,["rejected"])}if(!d&&!u.isVisible()){d=e.noAnimation=true}r=new C.Deferred;if(o&&!u.expanded&&c.autoCollapse){s=u.getParentList(false,true);l=c.autoCollapse;try{c.autoCollapse=false;for(n=0,i=s.length;n<i;n++){this._callHook("nodeCollapseSiblings",s[n],e)}}finally{c.autoCollapse=l}}r.done(function(){var e=u.getLastChild();if(o&&c.autoScroll&&!d&&e&&f._enableUpdate){e.scrollIntoView(true,{topNode:u}).always(function(){if(!h){a.tree._triggerNodeEvent(o?"expand":"collapse",a)}})}else{if(!h){a.tree._triggerNodeEvent(o?"expand":"collapse",a)}}});t=function(e){var t=c._classNames,r,n,i=c.toggleEffect;u.expanded=o;f._callHook("treeStructureChanged",a,o?"expand":"collapse");f._callHook("nodeRender",a,false,false,true);if(u.ul){r=u.ul.style.display!=="none";n=!!u.expanded;if(r===n){u.warn("nodeSetExpanded: UL.style.display already set")}else if(!i||d){u.ul.style.display=u.expanded||!parent?"":"none"}else{C(u.li).addClass(t.animating);if(C.isFunction(C(u.ul)[i.effect])){C(u.ul)[i.effect]({duration:i.duration,always:function(){C(this).removeClass(t.animating);C(u.li).removeClass(t.animating);e()}})}else{C(u.ul).stop(true,true);C(u.ul).parent().find(".ui-effects-placeholder").remove();C(u.ul).toggle(i.effect,i.options,i.duration,function(){C(this).removeClass(t.animating);C(u.li).removeClass(t.animating);e()})}return}}e()};if(o&&u.lazy&&u.hasChildren()===undefined){u.load().done(function(){if(r.notifyWith){r.notifyWith(u,["loaded"])}t(function(){r.resolveWith(u)})}).fail(function(e){t(function(){r.rejectWith(u,["load failed ("+e+")"])})})}else{t(function(){r.resolveWith(u)})}return r.promise()},nodeSetFocus:function(e,t){var r,n=e.tree,i=e.node,a=n.options,o=e.originalEvent?C(e.originalEvent.target).is(":input"):false;t=t!==false;if(n.focusNode){if(n.focusNode===i&&t){return}r=C.extend({},e,{node:n.focusNode});n.focusNode=null;this._triggerNodeEvent("blur",r);this._callHook("nodeRenderStatus",r)}if(t){if(!this.hasFocus()){i.debug("nodeSetFocus: forcing container focus");this._callHook("treeSetFocus",e,true,{calledByNode:true})}i.makeVisible({scrollIntoView:false});n.focusNode=i;if(a.titlesTabbable){if(!o){C(i.span).find(".fancytree-title").focus()}}if(a.aria){C(n.$container).attr("aria-activedescendant",C(i.tr||i.li).uniqueId().attr("id"))}this._triggerNodeEvent("focus",e);var s=document.activeElement===n.$container.get(0)||C(document.activeElement,n.$container).length>=1;if(!s){C(n.$container).focus()}if(a.autoScroll){i.scrollIntoView()}this._callHook("nodeRenderStatus",e)}},nodeSetSelected:function(e,t,r){r=r||{};var n=e.node,i=e.tree,a=e.options,o=r.noEvents===true,s=n.parent;t=t!==false;if(g.evalOption("unselectable",n,n,a,false)){return}n._lastSelectIntent=t;if(!!n.selected===t){if(a.selectMode===3&&n.partsel&&!t){}else{return t}}if(!o&&this._triggerNodeEvent("beforeSelect",n,e.originalEvent)===false){return!!n.selected}if(t&&a.selectMode===1){if(i.lastSelectedNode){i.lastSelectedNode.setSelected(false)}n.selected=t}else if(a.selectMode===3&&s&&!s.radiogroup&&!n.radiogroup){n.selected=t;n.fixSelection3AfterClick(r)}else if(s&&s.radiogroup){n.visitSiblings(function(e){e._changeSelectStatusAttrs(t&&e===n)},true)}else{n.selected=t}this.nodeRenderStatus(e);i.lastSelectedNode=t?n:null;if(!o){i._triggerNodeEvent("select",e)}},nodeSetStatus:function(n,e,t,r){var i=n.node,a=n.tree;function o(){var e=i.children?i.children[0]:null;if(e&&e.isStatusNode()){try{if(i.ul){i.ul.removeChild(e.li);e.li=null}}catch(e){}if(i.children.length===1){i.children=[]}else{i.children.shift()}a._callHook("treeStructureChanged",n,"clearStatusNode")}}function s(e,t){var r=i.children?i.children[0]:null;if(r&&r.isStatusNode()){C.extend(r,e);r.statusNodeType=t;a._callHook("nodeRenderTitle",r)}else{i._setChildren([e]);a._callHook("treeStructureChanged",n,"setStatusNode");i.children[0].statusNodeType=t;a.render()}return i.children[0]}switch(e){case"ok":o();i._isLoading=false;i._error=null;i.renderStatus();break;case"loading":if(!i.parent){s({title:a.options.strings.loading+(t?" ("+t+")":""),checkbox:false,tooltip:r},e)}i._isLoading=true;i._error=null;i.renderStatus();break;case"error":s({title:a.options.strings.loadError+(t?" ("+t+")":""),checkbox:false,tooltip:r},e);i._isLoading=false;i._error={message:t,details:r};i.renderStatus();break;case"nodata":s({title:t||a.options.strings.noData,checkbox:false,tooltip:r},e);i._isLoading=false;i._error=null;i.renderStatus();break;default:C.error("invalid node status "+e)}},nodeToggleExpanded:function(e){return this.nodeSetExpanded(e,!e.node.expanded)},nodeToggleSelected:function(e){var t=e.node,r=!t.selected;if(t.partsel&&!t.selected&&t._lastSelectIntent===true){r=false;t.selected=true}t._lastSelectIntent=r;return this.nodeSetSelected(e,r)},treeClear:function(e){var t=e.tree;t.activeNode=null;t.focusNode=null;t.$div.find(">ul.fancytree-container").empty();t.rootNode.children=null;t._callHook("treeStructureChanged",e,"clear")},treeCreate:function(e){},treeDestroy:function(e){this.$div.find(">ul.fancytree-container").remove();if(this.$source){this.$source.removeClass("fancytree-helper-hidden")}},treeInit:function(e){var r=e.tree,n=r.options;r.$container.attr("tabindex",n.tabindex);C.each(v,function(e,t){if(n[t]!==undefined){r.info("Move option "+t+" to tree");r[t]=n[t];delete n[t]}});if(n.checkboxAutoHide){r.$container.addClass("fancytree-checkbox-auto-hide")}if(n.rtl){r.$container.attr("DIR","RTL").addClass("fancytree-rtl")}else{r.$container.removeAttr("DIR").removeClass("fancytree-rtl")}if(n.aria){r.$container.attr("role","tree");if(n.selectMode!==1){r.$container.attr("aria-multiselectable",true)}}this.treeLoad(e)},treeLoad:function(e,t){var r,n,i,a=e.tree,o=e.widget.element,s,l=C.extend({},e,{node:this.rootNode});if(a.rootNode.children){this.treeClear(e)}t=t||this.options.source;if(!t){n=o.data("type")||"html";switch(n){case"html":i=o.find(">ul").not(".fancytree-container").first();if(i.length){i.addClass("ui-fancytree-source fancytree-helper-hidden");t=C.ui.fancytree.parseHtml(i);this.data=C.extend(this.data,O(i))}else{g.warn("No `source` option was passed and container does not contain `<ul>`: assuming `source: []`.");t=[]}break;case"json":t=C.parseJSON(o.text());o.contents().filter(function(){return this.nodeType===3}).remove();if(C.isPlainObject(t)){T(C.isArray(t.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')");r=t;t=t.children;delete r.children;C.each(v,function(e,t){if(r[t]!==undefined){a[t]=r[t];delete r[t]}});C.extend(a.data,r)}break;default:C.error("Invalid data-type: "+n)}}else if(typeof t==="string"){C.error("Not implemented")}a._triggerTreeEvent("preInit",null);s=this.nodeLoadChildren(l,t).done(function(){a._callHook("treeStructureChanged",e,"loadChildren");a.render();if(e.options.selectMode===3){a.rootNode.fixSelection3FromEndNodes()}if(a.activeNode&&a.options.activeVisible){a.activeNode.makeVisible()}a._triggerTreeEvent("init",null,{status:true})}).fail(function(){a.render();a._triggerTreeEvent("init",null,{status:false})});return s},treeRegisterNode:function(e,t,r){e.tree._callHook("treeStructureChanged",e,t?"addNode":"removeNode")},treeSetFocus:function(e,t,r){var n;t=t!==false;if(t!==this.hasFocus()){this._hasFocus=t;if(!t&&this.focusNode){this.focusNode.setFocus(false)}else if(t&&(!r||!r.calledByNode)){C(this.$container).focus()}this.$container.toggleClass("fancytree-treefocus",t);this._triggerTreeEvent(t?"focusTree":"blurTree");if(t&&!this.activeNode){n=this._lastMousedownNode||this.getFirstChild();if(n){n.setFocus()}}}},treeSetOption:function(e,t,r){var n=e.tree,i=true,a=false,o=false;switch(t){case"aria":case"checkbox":case"icon":case"minExpandLevel":case"tabindex":a=true;o=true;break;case"checkboxAutoHide":n.$container.toggleClass("fancytree-checkbox-auto-hide",!!r);break;case"escapeTitles":case"tooltip":o=true;break;case"rtl":if(r===false){n.$container.removeAttr("DIR").removeClass("fancytree-rtl")}else{n.$container.attr("DIR","RTL").addClass("fancytree-rtl")}o=true;break;case"source":i=false;n._callHook("treeLoad",n,r);o=true;break}n.debug("set option "+t+"="+r+" <"+typeof r+">");if(i){if(this.widget._super){this.widget._super.call(this.widget,t,r)}else{C.Widget.prototype._setOption.call(this.widget,t,r)}}if(a){n._callHook("treeCreate",n)}if(o){n.render(true,false)}},treeStructureChanged:function(e,t){}});C.widget("ui.fancytree",{options:{activeVisible:true,ajax:{type:"GET",cache:false,dataType:"json"},aria:true,autoActivate:true,autoCollapse:false,autoScroll:false,checkbox:false,clickFolderMode:4,copyFunctionsToData:false,debugLevel:null,disabled:false,enableAspx:42,escapeTitles:false,extensions:[],focusOnSelect:false,generateIds:false,icon:true,idPrefix:"ft_",keyboard:true,keyPathSeparator:"/",minExpandLevel:1,nodata:true,quicksearch:false,rtl:false,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading...",loadError:"Load error!",moreData:"More...",noData:"No data."},tabindex:"0",titlesTabbable:false,toggleEffect:{effect:"slideToggle",duration:200},tooltip:false,treeId:null,_classNames:{active:"fancytree-active",animating:"fancytree-animating",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",error:"fancytree-error",expanded:"fancytree-expanded",focused:"fancytree-focused",folder:"fancytree-folder",hasChildren:"fancytree-has-children",lastsib:"fancytree-lastsib",lazy:"fancytree-lazy",loading:"fancytree-loading",node:"fancytree-node",partload:"fancytree-partload",partsel:"fancytree-partsel",radio:"fancytree-radio",selected:"fancytree-selected",statusNodePrefix:"fancytree-statusnode-",unselectable:"fancytree-unselectable"},lazyLoad:null,postProcess:null},_deprecationWarning:function(e){var t=this.tree;if(t&&t.options.debugLevel>=3){t.warn("$().fancytree('"+e+"') is deprecated (see https://wwwendt.de/tech/fancytree/doc/jsdoc/Fancytree_Widget.html")}},_create:function(){this.tree=new P(this);this.$source=this.source||this.element.data("type")==="json"?this.element:this.element.find(">ul").first();var e,t,r,n=this.options,i=n.extensions,a=this.tree;for(r=0;r<i.length;r++){t=i[r];e=C.ui.fancytree._extensions[t];if(!e){C.error("Could not apply extension '"+t+"' (it is not registered, did you forget to include it?)")}this.tree.options[t]=c({},e.options,this.tree.options[t]);T(this.tree.ext[t]===undefined,"Extension name must not exist as Fancytree.ext attribute: '"+t+"'");this.tree.ext[t]={};x(this.tree,a,e,t);a=e}if(n.icons!==undefined){if(n.icon===true){this.tree.warn("'icons' tree option is deprecated since v2.14.0: use 'icon' instead");n.icon=n.icons}else{C.error("'icons' tree option is deprecated since v2.14.0: use 'icon' only instead")}}if(n.iconClass!==undefined){if(n.icon){C.error("'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead")}else{this.tree.warn("'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead");n.icon=n.iconClass}}if(n.tabbable!==undefined){n.tabindex=n.tabbable?"0":"-1";this.tree.warn("'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='"+n.tabindex+"' instead")}this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree);this._bind()},_setOption:function(e,t){return this.tree._callHook("treeSetOption",this.tree,e,t)},_destroy:function(){this._unbind();this.tree._callHook("treeDestroy",this.tree)},_unbind:function(){var e=this.tree._ns;this.element.off(e);this.tree.$container.off(e);C(document).off(e)},_bind:function(){var o=this,s=this.options,a=this.tree,e=a._ns;this._unbind();a.$container.on("focusin"+e+" focusout"+e,function(e){var t=g.getNode(e),r=e.type==="focusin";if(!r&&t&&C(e.target).is("a")){t.debug("Ignored focusout on embedded <a> element.");return}if(r){if(a._getExpiringValue("focusin")){a.debug("Ignored double focusin.");return}a._setExpiringValue("focusin",true,50);if(!t){t=a._getExpiringValue("mouseDownNode");if(t){a.debug("Reconstruct mouse target for focusin from recent event.")}}}if(t){a._callHook("nodeSetFocus",a._makeHookContext(t,e),r)}else{if(a.tbody&&C(e.target).parents("table.fancytree-container > thead").length){a.debug("Ignore focus event outside table body.",e)}else{a._callHook("treeSetFocus",a,r)}}}).on("selectstart"+e,"span.fancytree-title",function(e){e.preventDefault()}).on("keydown"+e,function(e){if(s.disabled||s.keyboard===false){return true}var t,r=a.focusNode,n=a._makeHookContext(r||a,e),i=a.phase;try{a.phase="userEvent";if(r){t=a._triggerNodeEvent("keydown",r,e)}else{t=a._triggerTreeEvent("keydown",e)}if(t==="preventNav"){t=true}else if(t!==false){t=a._callHook("nodeKeydown",n)}return t}finally{a.phase=i}}).on("mousedown"+e,function(e){var t=g.getEventTarget(e);a._lastMousedownNode=t?t.node:null;a._setExpiringValue("mouseDownNode",a._lastMousedownNode)}).on("click"+e+" dblclick"+e,function(e){if(s.disabled){return true}var t,r=g.getEventTarget(e),n=r.node,i=o.tree,a=i.phase;if(!n){return true}t=i._makeHookContext(n,e);try{i.phase="userEvent";switch(e.type){case"click":t.targetType=r.type;if(n.isPagingNode()){return i._triggerNodeEvent("clickPaging",t,e)===true}return i._triggerNodeEvent("click",t,e)===false?false:i._callHook("nodeClick",t);case"dblclick":t.targetType=r.type;return i._triggerNodeEvent("dblclick",t,e)===false?false:i._callHook("nodeDblclick",t)}}finally{i.phase=a}})},getActiveNode:function(){this._deprecationWarning("getActiveNode");return this.tree.activeNode},getNodeByKey:function(e){this._deprecationWarning("getNodeByKey");return this.tree.getNodeByKey(e)},getRootNode:function(){this._deprecationWarning("getRootNode");return this.tree.rootNode},getTree:function(){this._deprecationWarning("getTree");return this.tree}});g=C.ui.fancytree;C.extend(C.ui.fancytree,{version:"2.38.0",buildType:"production",debugLevel:3,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:P,_FancytreeNodeClass:L,jquerySupports:{positionMyOfs:f(C.ui.version,1,9)},assert:function(e,t){return T(e,t)},createTree:function(e,t){var r=C(e).fancytree(t);return g.getTree(r)},debounce:function(t,r,n,i){var a;if(arguments.length===3&&typeof n!=="boolean"){i=n;n=false}return function(){var e=arguments;i=i||this;n&&!a&&r.apply(i,e);clearTimeout(a);a=setTimeout(function(){n||r.apply(i,e);a=null},t)}},debug:function(e){if(C.ui.fancytree.debugLevel>=4){u("log",arguments)}},error:function(e){if(C.ui.fancytree.debugLevel>=1){u("error",arguments)}},escapeHtml:function(e){return(""+e).replace(t,function(e){return n[e]})},fixPositionOptions:function(e){if(e.offset||(""+e.my+e.at).indexOf("%")>=0){C.error("expected new position syntax (but '%' is not supported)")}if(!C.ui.fancytree.jquerySupports.positionMyOfs){var t=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(e.my),r=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(e.at),n=(t[2]?+t[2]:0)+(r[2]?+r[2]:0),i=(t[4]?+t[4]:0)+(r[4]?+r[4]:0);e=C.extend({},e,{my:t[1]+" "+t[3],at:r[1]+" "+r[3]});if(n||i){e.offset=""+n+" "+i}}return e},getEventTarget:function(e){var t,r,n=e&&e.target?e.target.className:"",i={node:this.getNode(e.target),type:undefined};if(/\bfancytree-title\b/.test(n)){i.type="title"}else if(/\bfancytree-expander\b/.test(n)){i.type=i.node.hasChildren()===false?"prefix":"expander"}else if(/\bfancytree-checkbox\b/.test(n)){i.type="checkbox"}else if(/\bfancytree(-custom)?-icon\b/.test(n)){i.type="icon"}else if(/\bfancytree-node\b/.test(n)){i.type="title"}else if(e&&e.target){t=C(e.target);if(t.is("ul[role=group]")){r=i.node&&i.node.tree;(r||g).debug("Ignoring click on outer UL.");i.node=null}else if(t.closest(".fancytree-title").length){i.type="title"}else if(t.closest(".fancytree-checkbox").length){i.type="checkbox"}else if(t.closest(".fancytree-expander").length){i.type="expander"}}return i},getEventTargetType:function(e){return this.getEventTarget(e).type},getNode:function(e){if(e instanceof L){return e}else if(e instanceof C){e=e[0]}else if(e.originalEvent!==undefined){e=e.target}while(e){if(e.ftnode){return e.ftnode}e=e.parentNode}return null},getTree:function(e){var t,r=e;if(e instanceof P){return e}if(e===undefined){e=0}if(typeof e==="number"){e=C(".fancytree-container").eq(e)}else if(typeof e==="string"){e=C("#ft-id-"+r).eq(0);if(!e.length){e=C(r).eq(0)}}else if(e instanceof Element||e instanceof HTMLDocument){e=C(e)}else if(e instanceof C){e=e.eq(0)}else if(e.originalEvent!==undefined){e=C(e.target)}e=e.closest(":ui-fancytree");t=e.data("ui-fancytree")||e.data("fancytree");return t?t.tree:null},evalOption:function(e,t,r,n,i){var a,o,s=t.tree,l=n[e],u=r[e];if(C.isFunction(l)){a={node:t,tree:s,widget:s.widget,options:s.widget.options,typeInfo:s.types[t.type]||{}};o=l.call(s,{type:e},a);if(o==null){o=u}}else{o=u==null?l:u}if(o==null){o=i}return o},setSpanIcon:function(e,t,r){var n=C(e);if(typeof r==="string"){n.attr("class",t+" "+r)}else{if(r.text){n.text(""+r.text)}else if(r.html){e.innerHTML=r.html}n.attr("class",t+" "+(r.addClass||""))}},eventToString:function(e){var t=e.which,r=e.type,n=[];if(e.altKey){n.push("alt")}if(e.ctrlKey){n.push("ctrl")}if(e.metaKey){n.push("meta")}if(e.shiftKey){n.push("shift")}if(r==="click"||r==="dblclick"){n.push(o[e.button]+r)}else if(r==="wheel"){n.push(r)}else if(!i[t]){n.push(y[t]||String.fromCharCode(t).toLowerCase())}return n.join("+")},info:function(e){if(C.ui.fancytree.debugLevel>=3){u("info",arguments)}},keyEventToString:function(e){this.warn("keyEventToString() is deprecated: use eventToString()");return this.eventToString(e)},overrideMethod:function(e,t,r,n){var i,a=e[t]||C.noop;e[t]=function(){var e=n||this;try{i=e._super;e._super=a;return r.apply(e,arguments)}finally{e._super=i}}},parseHtml:function(o){var s,l,u,f,c,d,h,v,e=o.find(">li"),p=[];e.each(function(){var e,t,r=C(this),n=r.find(">span",this).first(),i=n.length?null:r.find(">a").first(),a={tooltip:null,data:{}};if(n.length){a.title=n.html()}else if(i&&i.length){a.title=i.html();a.data.href=i.attr("href");a.data.target=i.attr("target");a.tooltip=i.attr("title")}else{a.title=r.html();c=a.title.search(/<ul/i);if(c>=0){a.title=a.title.substring(0,c)}}a.title=C.trim(a.title);for(f=0,d=w.length;f<d;f++){a[w[f]]=undefined}s=this.className.split(" ");u=[];for(f=0,d=s.length;f<d;f++){l=s[f];if(S[l]){a[l]=true}else{u.push(l)}}a.extraClasses=u.join(" ");h=r.attr("title");if(h){a.tooltip=h}h=r.attr("id");if(h){a.key=h}if(r.attr("hideCheckbox")){a.checkbox=false}e=O(r);if(e&&!C.isEmptyObject(e)){for(t in k){if(e.hasOwnProperty(t)){e[k[t]]=e[t];delete e[t]}}for(f=0,d=E.length;f<d;f++){h=E[f];v=e[h];if(v!=null){delete e[h];a[h]=v}}C.extend(a.data,e)}o=r.find(">ul").first();if(o.length){a.children=C.ui.fancytree.parseHtml(o)}else{a.children=a.lazy?undefined:null}p.push(a)});return p},registerExtension:function(e){T(e.name!=null,"extensions must have a `name` property.");T(e.version!=null,"extensions must have a `version` property.");C.ui.fancytree._extensions[e.name]=e},unescapeHtml:function(e){var t=document.createElement("div");t.innerHTML=e;return t.childNodes.length===0?"":t.childNodes[0].nodeValue},warn:function(e){if(C.ui.fancytree.debugLevel>=2){u("warn",arguments)}}});return C.ui.fancytree});(function(e){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fancytree"],e)}else if(typeof module==="object"&&module.exports){require("./jquery.fancytree");module.exports=e(require("jquery"))}else{e(jQuery)}})(function(h){"use strict";var t=null,r=null,n=null,i=h.ui.fancytree.assert,d="active",v="expanded",p="focus",g="selected";try{i(window.localStorage&&window.localStorage.getItem);r={get:function(e){return window.localStorage.getItem(e)},set:function(e,t){window.localStorage.setItem(e,t)},remove:function(e){window.localStorage.removeItem(e)}}}catch(e){h.ui.fancytree.warn("Could not access window.localStorage",e)}try{i(window.sessionStorage&&window.sessionStorage.getItem);n={get:function(e){return window.sessionStorage.getItem(e)},set:function(e,t){window.sessionStorage.setItem(e,t)},remove:function(e){window.sessionStorage.removeItem(e)}}}catch(e){h.ui.fancytree.warn("Could not access window.sessionStorage",e)}if(typeof Cookies==="function"){t={get:Cookies.get,set:function(e,t){Cookies.set(e,t,this.options.persist.cookie)},remove:Cookies.remove}}else if(h&&typeof h.cookie==="function"){t={get:h.cookie,set:function(e,t){h.cookie.set(e,t,this.options.persist.cookie)},remove:h.removeCookie}}function m(e,t,r,n,i){var a,o,s,l,u=false,f=e.options.persist.expandOpts,c=[],d=[];r=r||[];i=i||h.Deferred();for(a=0,s=r.length;a<s;a++){o=r[a];l=e.getNodeByKey(o);if(l){if(n&&l.isUndefined()){u=true;e.debug("_loadLazyNodes: "+l+" is lazy: loading...");if(n==="expand"){c.push(l.setExpanded(true,f))}else{c.push(l.load())}}else{e.debug("_loadLazyNodes: "+l+" already loaded.");l.setExpanded(true,f)}}else{d.push(o);e.debug("_loadLazyNodes: "+l+" was not yet found.")}}h.when.apply(h,c).always(function(){if(u&&d.length>0){m(e,t,d,n,i)}else{if(d.length){e.warn("_loadLazyNodes: could not load those keys: ",d);for(a=0,s=d.length;a<s;a++){o=r[a];t._appendKey(v,r[a],false)}}i.resolve()}});return i}h.ui.fancytree._FancytreeClass.prototype.clearPersistData=function(e){var t=this.ext.persist,r=t.cookiePrefix;e=e||"active expanded focus selected";if(e.indexOf(d)>=0){t._data(r+d,null)}if(e.indexOf(v)>=0){t._data(r+v,null)}if(e.indexOf(p)>=0){t._data(r+p,null)}if(e.indexOf(g)>=0){t._data(r+g,null)}};h.ui.fancytree._FancytreeClass.prototype.clearCookies=function(e){this.warn("'tree.clearCookies()' is deprecated since v2.27.0: use 'clearPersistData()' instead.");return this.clearPersistData(e)};h.ui.fancytree._FancytreeClass.prototype.getPersistData=function(){var e=this.ext.persist,t=e.cookiePrefix,r=e.cookieDelimiter,n={};n[d]=e._data(t+d);n[v]=(e._data(t+v)||"").split(r);n[g]=(e._data(t+g)||"").split(r);n[p]=e._data(t+p);return n};h.ui.fancytree.registerExtension({name:"persist",version:"2.38.0",options:{cookieDelimiter:"~",cookiePrefix:undefined,cookie:{raw:false,expires:"",path:"",domain:"",secure:false},expandLazy:false,expandOpts:undefined,fireActivate:true,overrideSource:true,store:"auto",types:"active expanded focus selected"},_data:function(e,t){var r=this._local.store;if(t===undefined){return r.get.call(this,e)}else if(t===null){r.remove.call(this,e)}else{r.set.call(this,e,t)}},_appendKey:function(e,t,r){t=""+t;var n=this._local,i=this.options.persist,a=i.cookieDelimiter,o=n.cookiePrefix+e,s=n._data(o),l=s?s.split(a):[],u=h.inArray(t,l);if(u>=0){l.splice(u,1)}if(r){l.push(t)}n._data(o,l.join(a))},treeInit:function(e){var l=e.tree,u=e.options,f=this._local,c=this.options.persist;f.cookiePrefix=c.cookiePrefix||"fancytree-"+l._id+"-";f.storeActive=c.types.indexOf(d)>=0;f.storeExpanded=c.types.indexOf(v)>=0;f.storeSelected=c.types.indexOf(g)>=0;f.storeFocus=c.types.indexOf(p)>=0;f.store=null;if(c.store==="auto"){c.store=r?"local":"cookie"}if(h.isPlainObject(c.store)){f.store=c.store}else if(c.store==="cookie"){f.store=t}else if(c.store==="local"){f.store=c.store==="local"?r:n}else if(c.store==="session"){f.store=c.store==="local"?r:n}i(f.store,"Need a valid store.");l.$div.on("fancytreeinit",function(e){if(l._triggerTreeEvent("beforeRestore",null,{})===false){return}var t,r,n,i,a,o=f._data(f.cookiePrefix+p),s=c.fireActivate===false;t=f._data(f.cookiePrefix+v);i=t&&t.split(c.cookieDelimiter);if(f.storeExpanded){r=m(l,f,i,c.expandLazy?"expand":false,null)}else{r=(new h.Deferred).resolve()}r.done(function(){if(f.storeSelected){t=f._data(f.cookiePrefix+g);if(t){i=t.split(c.cookieDelimiter);for(n=0;n<i.length;n++){a=l.getNodeByKey(i[n]);if(a){if(a.selected===undefined||c.overrideSource&&a.selected===false){a.selected=true;a.renderStatus()}}else{f._appendKey(g,i[n],false)}}}if(l.options.selectMode===3){l.visit(function(e){if(e.selected){e.fixSelection3AfterClick();return"skip"}})}}if(f.storeActive){t=f._data(f.cookiePrefix+d);if(t&&(u.persist.overrideSource||!l.activeNode)){a=l.getNodeByKey(t);if(a){a.debug("persist: set active",t);a.setActive(true,{noFocus:true,noEvents:s})}}}if(f.storeFocus&&o){a=l.getNodeByKey(o);if(a){if(l.options.titlesTabbable){h(a.span).find(".fancytree-title").focus()}else{h(l.$container).focus()}}}l._triggerTreeEvent("restore",null,{})})});return this._superApply(arguments)},nodeSetActive:function(e,t,r){var n,i=this._local;t=t!==false;n=this._superApply(arguments);if(i.storeActive){i._data(i.cookiePrefix+d,this.activeNode?this.activeNode.key:null)}return n},nodeSetExpanded:function(e,t,r){var n,i=e.node,a=this._local;t=t!==false;n=this._superApply(arguments);if(a.storeExpanded){a._appendKey(v,i.key,t)}return n},nodeSetFocus:function(e,t){var r,n=this._local;t=t!==false;r=this._superApply(arguments);if(n.storeFocus){n._data(n.cookiePrefix+p,this.focusNode?this.focusNode.key:null)}return r},nodeSetSelected:function(e,t,r){var n,i,a=e.tree,o=e.node,s=this._local;t=t!==false;n=this._superApply(arguments);if(s.storeSelected){if(a.options.selectMode===3){i=h.map(a.getSelectedNodes(true),function(e){return e.key});i=i.join(e.options.persist.cookieDelimiter);s._data(s.cookiePrefix+g,i)}else{s._appendKey(g,o.key,o.selected)}}return n}});return h.ui.fancytree});(function(e){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fancytree"],e)}else if(typeof module==="object"&&module.exports){require("./jquery.fancytree");module.exports=e(require("jquery"))}else{e(jQuery)}})(function(s){"use strict";s.ui.fancytree.registerExtension({name:"multi",version:"2.38.0",options:{allowNoSelect:false,mode:"sameParent"},treeInit:function(e){this._superApply(arguments);this.$container.addClass("fancytree-ext-multi");if(e.options.selectMode===1){s.error("Fancytree ext-multi: selectMode: 1 (single) is not compatible.")}},nodeClick:function(e){var t=e.tree,r=e.node,n=t.getActiveNode()||t.getFirstChild(),i=e.targetType==="checkbox",a=e.targetType==="expander",o=s.ui.fancytree.eventToString(e.originalEvent);switch(o){case"click":if(a){break}if(!i){t.selectAll(false);r.setSelected()}break;case"shift+click":t.visitRows(function(e){e.setSelected();if(e===r){return false}},{start:n,reverse:n.isBelowOf(r)});break;case"ctrl+click":case"meta+click":r.toggleSelected();return}return this._superApply(arguments)},nodeKeydown:function(e){var t=e.tree,r=e.node,n=e.originalEvent,i=s.ui.fancytree.eventToString(n);switch(i){case"up":case"down":t.selectAll(false);r.navigate(n.which,true);t.getActiveNode().setSelected();break;case"shift+up":case"shift+down":r.navigate(n.which,true);t.getActiveNode().setSelected();break}return this._superApply(arguments)}});return s.ui.fancytree});(function(e){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fancytree"],e)}else if(typeof module==="object"&&module.exports){require("./jquery.fancytree");module.exports=e(require("jquery"))}else{e(jQuery)}})(function(g){"use strict";var m=g.ui.fancytree,i=/Mac/.test(navigator.platform),l="fancytree-drag-source",u="fancytree-drag-remove",y="fancytree-drop-accept",b="fancytree-drop-after",w="fancytree-drop-before",C="fancytree-drop-over",S="fancytree-drop-reject",E="fancytree-drop-target",p="application/x-fancytree-node",k=null,f,c,T=null,_=null,d=null,x=null,a=null,o=null,s=null,D=null,R=null;function I(){x=null;R=null;o=null;s=null;a=null;T=null;_=null;if(d){d.removeClass(l+" "+u)}d=null;if(k){k.hide()}if(c){c.remove();c=null}}function O(e){return e===0?"":e>0?"+"+e:""+e}function A(e){var t;if(!e){return false}if(g.isPlainObject(e)){t={over:!!e.over,before:!!e.before,after:!!e.after}}else if(g.isArray(e)){t={over:g.inArray("over",e)>=0,before:g.inArray("before",e)>=0,after:g.inArray("after",e)>=0}}else{t={over:e===true||e==="over",before:e===true||e==="before",after:e===true||e==="after"}}if(Object.keys(t).length===0){return false}return t}function N(e,t){var r,n,i,a=e.options.dnd5,o=e.$scrollParent[0],s=a.scrollSensitivity,l=a.scrollSpeed,u=0;if(o!==document&&o.tagName!=="HTML"){r=e.$scrollParent.offset();n=o.scrollTop;if(r.top+o.offsetHeight-t.pageY<s){i=o.scrollHeight-e.$scrollParent.innerHeight()-n;if(i>0){o.scrollTop=u=n+l}}else if(n>0&&t.pageY-r.top<s){o.scrollTop=u=n-l}}else{n=g(document).scrollTop();if(n>0&&t.pageY-n<s){u=n-l;g(document).scrollTop(u)}else if(g(window).height()-(t.pageY-n)<s){u=n+l;g(document).scrollTop(u)}}if(u){e.debug("autoScroll: "+u+"px")}return u}function h(e,t,r){var n=r;if(i){if(t.metaKey&&t.altKey){n="link"}else if(t.ctrlKey){n="link"}else if(t.metaKey){n="move"}else if(t.altKey){n="copy"}}else{if(t.ctrlKey){n="copy"}else if(t.shiftKey){n="move"}else if(t.altKey){n="link"}}if(n!==a){e.info("evalEffectModifiers: "+t.type+" - evalEffectModifiers(): "+a+" -> "+n)}a=n;return n}function M(e,t){var r=t.tree,n=t.dataTransfer;if(e.type==="dragstart"){t.effectAllowed=r.options.dnd5.effectAllowed;t.dropEffect=r.options.dnd5.dropEffectDefault}else{t.effectAllowed=s;t.dropEffect=o}t.dropEffectSuggested=h(r,e,r.options.dnd5.dropEffectDefault);t.isMove=t.dropEffect==="move";t.files=n.files||[]}function L(e,t,r){var n=t.tree,i=t.dataTransfer;if(e.type!=="dragstart"&&s!==t.effectAllowed){n.warn("effectAllowed should only be changed in dragstart event: "+e.type+": data.effectAllowed changed from "+s+" -> "+t.effectAllowed)}if(r===false){n.info("applyDropEffectCallback: allowDrop === false");t.effectAllowed="none";t.dropEffect="none"}t.isMove=t.dropEffect==="move";if(e.type==="dragstart"){s=t.effectAllowed;o=t.dropEffect}i.effectAllowed=s;i.dropEffect=o;return o}function P(e,t){if(t.options.dnd5.scroll){N(t.tree,e)}if(!t.node){t.tree.warn("Ignored dragover for non-node");return D}var r,n,i,a,o=null,s=t.tree,l=s.options,u=l.dnd5,f=t.node,c=t.otherNode,d="center",h=g(f.span),v=h.find("span.fancytree-title");if(x===false){s.debug("Ignored dragover, since dragenter returned false.");return false}else if(typeof x==="string"){g.error("assert failed: dragenter returned string")}n=h.offset();a=(e.pageY-n.top)/h.height();if(e.pageY===undefined){s.warn("event.pageY is undefined: see issue #1013.")}if(x.after&&a>.75){o="after"}else if(!x.over&&x.after&&a>.5){o="after"}else if(x.before&&a<=.25){o="before"}else if(!x.over&&x.before&&a<=.5){o="before"}else if(x.over){o="over"}if(u.preventVoidMoves&&t.dropEffect==="move"){if(f===c){f.debug("Drop over source node prevented.");o=null}else if(o==="before"&&c&&f===c.getNextSibling()){f.debug("Drop after source node prevented.");o=null}else if(o==="after"&&c&&f===c.getPrevSibling()){f.debug("Drop before source node prevented.");o=null}else if(o==="over"&&c&&c.parent===f&&c.isLastSibling()){f.debug("Drop last child over own parent prevented.");o=null}}t.hitMode=o;if(o&&u.dragOver){M(e,t);u.dragOver(f,t);var p=!!o;L(e,t,p);o=t.hitMode}D=o;if(o==="after"||o==="before"||o==="over"){r=u.dropMarkerOffsetX||0;switch(o){case"before":d="top";r+=u.dropMarkerInsertOffsetX||0;break;case"after":d="bottom";r+=u.dropMarkerInsertOffsetX||0;break}i={my:"left"+O(r)+" center",at:"left "+d,of:v};if(l.rtl){i.my="right"+O(-r)+" center";i.at="right "+d}k.toggleClass(b,o==="after").toggleClass(C,o==="over").toggleClass(w,o==="before").show().position(m.fixPositionOptions(i))}else{k.hide()}g(f.span).toggleClass(E,o==="after"||o==="before"||o==="over").toggleClass(b,o==="after").toggleClass(w,o==="before").toggleClass(y,o==="over").toggleClass(S,o===false);return o}function v(e){var t,r=this,n=r.options.dnd5,i=m.getNode(e),a=e.dataTransfer||e.originalEvent.dataTransfer,o={tree:r,node:i,options:r.options,originalEvent:e.originalEvent,widget:r.widget,dataTransfer:a,useDefaultImage:true,dropEffect:undefined,dropEffectSuggested:undefined,effectAllowed:undefined,files:undefined,isCancelled:undefined,isMove:undefined};switch(e.type){case"dragstart":if(!i){r.info("Ignored dragstart on a non-node.");return false}T=i;if(n.multiSource===false){_=[i]}else if(n.multiSource===true){if(i.isSelected()){_=r.getSelectedNodes()}else{_=[i]}}else{_=n.multiSource(i,o)}d=g(g.map(_,function(e){return e.span}));d.addClass(l);var s=i.toDict(true,n.sourceCopyHook);s.treeId=i.tree._id;t=JSON.stringify(s);try{a.setData(p,t);a.setData("text/html",g(i.span).html());a.setData("text/plain",i.title)}catch(e){r.warn("Could not set data (IE only accepts 'text') - "+e)}if(n.setTextTypeJson){a.setData("text",t)}else{a.setData("text",i.title)}M(e,o);if(n.dragStart(i,o)===false){I();return false}L(e,o);c=null;if(o.useDefaultImage){f=g(i.span).find(".fancytree-title");if(_&&_.length>1){c=g("<span class='fancytree-childcounter'/>").text("+"+(_.length-1)).appendTo(f)}if(a.setDragImage){a.setDragImage(f[0],-10,-10)}}return true;case"drag":M(e,o);n.dragDrag(i,o);L(e,o);d.toggleClass(u,o.isMove);break;case"dragend":M(e,o);I();o.isCancelled=!D;n.dragEnd(i,o,!D);break}}function F(e){var t,r,n,i,a,o,s=this,l=s.options.dnd5,u=null,f=m.getNode(e),c=e.dataTransfer||e.originalEvent.dataTransfer,d={tree:s,node:f,options:s.options,originalEvent:e.originalEvent,widget:s.widget,hitMode:x,dataTransfer:c,otherNode:T||null,otherNodeList:_||null,otherNodeData:null,useDefaultImage:true,dropEffect:undefined,dropEffectSuggested:undefined,effectAllowed:undefined,files:null,isCancelled:undefined,isMove:undefined};switch(e.type){case"dragenter":R=null;if(!f){s.debug("Ignore non-node "+e.type+": "+e.target.tagName+"."+e.target.className);x=false;break}g(f.span).addClass(C).removeClass(y+" "+S);i=g.inArray(p,c.types)>=0;if(l.preventNonNodes&&!i){f.debug("Reject dropping a non-node.");x=false;break}else if(l.preventForeignNodes&&(!T||T.tree!==f.tree)){f.debug("Reject dropping a foreign node.");x=false;break}else if(l.preventSameParent&&d.otherNode&&d.otherNode.tree===f.tree&&f.parent===d.otherNode.parent){f.debug("Reject dropping as sibling (same parent).");x=false;break}else if(l.preventRecursion&&d.otherNode&&d.otherNode.tree===f.tree&&f.isDescendantOf(d.otherNode)){f.debug("Reject dropping below own ancestor.");x=false;break}else if(l.preventLazyParents&&!f.isLoaded()){f.warn("Drop over unloaded target node prevented.");x=false;break}k.show();M(e,d);a=l.dragEnter(f,d);o=A(a);x=o;u=o&&(o.over||o.before||o.after);L(e,d,u);break;case"dragover":if(!f){s.debug("Ignore non-node "+e.type+": "+e.target.tagName+"."+e.target.className);break}M(e,d);D=P(e,d);u=!!D;r=D==="over"||D===false;if(r&&!f.expanded&&f.hasChildren()!==false){if(!R){R=Date.now()}else if(l.autoExpandMS&&Date.now()-R>l.autoExpandMS&&!f.isLoading()&&(!l.dragExpand||l.dragExpand(f,d)!==false)){f.setExpanded()}}else{R=null}break;case"dragleave":if(!f){s.debug("Ignore non-node "+e.type+": "+e.target.tagName+"."+e.target.className);break}if(!g(f.span).hasClass(C)){f.debug("Ignore dragleave (multi).");break}g(f.span).removeClass(C+" "+y+" "+S);f.scheduleAction("cancel");l.dragLeave(f,d);k.hide();break;case"drop":if(g.inArray(p,c.types)>=0){n=c.getData(p);s.info(e.type+": getData('application/x-fancytree-node'): '"+n+"'")}if(!n){n=c.getData("text");s.info(e.type+": getData('text'): '"+n+"'")}if(n){try{t=JSON.parse(n);if(t.title!==undefined){d.otherNodeData=t}}catch(e){}}s.debug(e.type+": nodeData: '"+n+"', otherNodeData: ",d.otherNodeData);g(f.span).removeClass(C+" "+y+" "+S);d.hitMode=D;M(e,d,!D);d.isCancelled=!D;var h=T&&T.span,v=T&&T.tree;l.dragDrop(f,d);e.preventDefault();if(h&&!document.body.contains(h)){if(v===s){s.debug("Drop handler removed source element: generating dragEnd.");l.dragEnd(T,d)}else{s.warn("Drop handler removed source element: dragend event may be lost.")}}I();break}if(u){e.preventDefault();return false}}g.ui.fancytree.getDragNodeList=function(){return _||[]};g.ui.fancytree.getDragNode=function(){return T};g.ui.fancytree.registerExtension({name:"dnd5",version:"2.38.0",options:{autoExpandMS:1500,dropMarkerInsertOffsetX:-16,dropMarkerOffsetX:-24,dropMarkerParent:"body",multiSource:false,effectAllowed:"all",dropEffectDefault:"move",preventForeignNodes:false,preventLazyParents:true,preventNonNodes:false,preventRecursion:true,preventSameParent:false,preventVoidMoves:true,scroll:true,scrollSensitivity:20,scrollSpeed:5,setTextTypeJson:false,sourceCopyHook:null,dragStart:null,dragDrag:g.noop,dragEnd:g.noop,dragEnter:null,dragOver:g.noop,dragExpand:g.noop,dragDrop:g.noop,dragLeave:g.noop},treeInit:function(e){var t,r=e.tree,n=e.options,i=n.glyph||null,a=n.dnd5;if(g.inArray("dnd",n.extensions)>=0){g.error("Extensions 'dnd' and 'dnd5' are mutually exclusive.")}if(a.dragStop){g.error("dragStop is not used by ext-dnd5. Use dragEnd instead.")}if(a.preventRecursiveMoves!=null){g.error("preventRecursiveMoves was renamed to preventRecursion.")}if(a.dragStart){m.overrideMethod(e.options,"createNode",function(e,t){this._super.apply(this,arguments);if(t.node.span){t.node.span.draggable=true}else{t.node.warn("Cannot add `draggable`: no span tag")}})}this._superApply(arguments);this.$container.addClass("fancytree-ext-dnd5");t=g("<span>").appendTo(this.$container);this.$scrollParent=t.scrollParent();t.remove();k=g("#fancytree-drop-marker");if(!k.length){k=g("<div id='fancytree-drop-marker'></div>").hide().css({"z-index":1e3,"pointer-events":"none"}).prependTo(a.dropMarkerParent);if(i){m.setSpanIcon(k[0],i.map._addClass,i.map.dropMarker)}}k.toggleClass("fancytree-rtl",!!n.rtl);if(a.dragStart){r.$container.on("dragstart drag dragend",v.bind(r))}if(a.dragEnter){r.$container.on("dragenter dragover dragleave drop",F.bind(r))}}});return g.ui.fancytree});(function(e){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fancytree"],e)}else if(typeof module==="object"&&module.exports){require("./jquery.fancytree");module.exports=e(require("jquery"))}else{e(jQuery)}})(function(y){"use strict";var b="__not_found__",w=y.ui.fancytree.escapeHtml,C="ï¿·",S="ï¿¸";function E(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function k(e){if(e.indexOf(">")>=0){return y("<div/>").html(e).text()}return e}function T(e,t,r){var n=[];for(var i=1;i<t.length;i++){var a=t[i].length+(i===1?0:1)+(n[n.length-1]||0);n.push(a)}var o=e.split("");if(r){n.forEach(function(e){o[e]=C+o[e]+S})}else{n.forEach(function(e){o[e]="<mark>"+o[e]+"</mark>"})}return o.join("")}y.ui.fancytree._FancytreeClass.prototype._applyFilterImpl=function(n,i,e){var t,r,a,o,s,l,u,f,c=0,d=this.options,h=d.escapeTitles,v=d.autoCollapse,p=y.extend({},d.filter,e),g=p.mode==="hide",m=!!p.leavesOnly&&!i;if(typeof n==="string"){if(n===""){this.warn("Fancytree passing an empty string as a filter is handled as clearFilter().");this.clearFilter();return}if(p.fuzzy){t=n.split("").map(E).reduce(function(e,t){return e+"([^"+t+"]*)"+t},"")}else{t=E(n)}a=new RegExp(t,"i");o=new RegExp(E(n),"gi");if(h){s=new RegExp(E(C),"g");l=new RegExp(E(S),"g")}n=function(e){if(!e.title){return false}var t=h?e.title:k(e.title),r=t.match(a);if(r&&p.highlight){if(h){if(p.fuzzy){u=T(t,r,h)}else{u=t.replace(o,function(e){return C+e+S})}e.titleWithHighlight=w(u).replace(s,"<mark>").replace(l,"</mark>")}else{if(p.fuzzy){e.titleWithHighlight=T(t,r)}else{e.titleWithHighlight=t.replace(o,function(e){return"<mark>"+e+"</mark>"})}}}return!!r}}this.enableFilter=true;this.lastFilterArgs=arguments;f=this.enableUpdate(false);this.$div.addClass("fancytree-ext-filter");if(g){this.$div.addClass("fancytree-ext-filter-hide")}else{this.$div.addClass("fancytree-ext-filter-dimm")}this.$div.toggleClass("fancytree-ext-filter-hide-expanders",!!p.hideExpanders);this.rootNode.subMatchCount=0;this.visit(function(e){delete e.match;delete e.titleWithHighlight;e.subMatchCount=0});r=this.getRootNode()._findDirectChild(b);if(r){r.remove()}d.autoCollapse=false;this.visit(function(t){if(m&&t.children!=null){return}var e=n(t),r=false;if(e==="skip"){t.visit(function(e){e.match=false},true);return"skip"}if(!e&&(i||e==="branch")&&t.parent.match){e=true;r=true}if(e){c++;t.match=true;t.visitParents(function(e){if(e!==t){e.subMatchCount+=1}if(p.autoExpand&&!r&&!e.expanded){e.setExpanded(true,{noAnimation:true,noEvents:true,scrollIntoView:false});e._filterAutoExpanded=true}},true)}});d.autoCollapse=v;if(c===0&&p.nodata&&g){r=p.nodata;if(y.isFunction(r)){r=r()}if(r===true){r={}}else if(typeof r==="string"){r={title:r}}r=y.extend({statusNodeType:"nodata",key:b,title:this.options.strings.noData},r);this.getRootNode().addNode(r).match=true}this._callHook("treeStructureChanged",this,"applyFilter");this.enableUpdate(f);return c};y.ui.fancytree._FancytreeClass.prototype.filterNodes=function(e,t){if(typeof t==="boolean"){t={leavesOnly:t};this.warn("Fancytree.filterNodes() leavesOnly option is deprecated since 2.9.0 / 2015-04-19. Use opts.leavesOnly instead.")}return this._applyFilterImpl(e,false,t)};y.ui.fancytree._FancytreeClass.prototype.filterBranches=function(e,t){return this._applyFilterImpl(e,true,t)};y.ui.fancytree._FancytreeClass.prototype.updateFilter=function(){if(this.enableFilter&&this.lastFilterArgs&&this.options.filter.autoApply){this._applyFilterImpl.apply(this,this.lastFilterArgs)}else{this.warn("updateFilter(): no filter active.")}};y.ui.fancytree._FancytreeClass.prototype.clearFilter=function(){var t,e=this.getRootNode()._findDirectChild(b),r=this.options.escapeTitles,n=this.options.enhanceTitle,i=this.enableUpdate(false);if(e){e.remove()}delete this.rootNode.match;delete this.rootNode.subMatchCount;this.visit(function(e){if(e.match&&e.span){t=y(e.span).find(">span.fancytree-title");if(r){t.text(e.title)}else{t.html(e.title)}if(n){n({type:"enhanceTitle"},{node:e,$title:t})}}delete e.match;delete e.subMatchCount;delete e.titleWithHighlight;if(e.$subMatchBadge){e.$subMatchBadge.remove();delete e.$subMatchBadge}if(e._filterAutoExpanded&&e.expanded){e.setExpanded(false,{noAnimation:true,noEvents:true,scrollIntoView:false})}delete e._filterAutoExpanded});this.enableFilter=false;this.lastFilterArgs=null;this.$div.removeClass("fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide");this._callHook("treeStructureChanged",this,"clearFilter");this.enableUpdate(i)};y.ui.fancytree._FancytreeClass.prototype.isFilterActive=function(){return!!this.enableFilter};y.ui.fancytree._FancytreeNodeClass.prototype.isMatched=function(){return!(this.tree.enableFilter&&!this.match)};y.ui.fancytree.registerExtension({name:"filter",version:"2.38.0",options:{autoApply:true,autoExpand:false,counter:true,fuzzy:false,hideExpandedCounter:true,hideExpanders:false,highlight:true,leavesOnly:false,nodata:true,mode:"dimm"},nodeLoadChildren:function(e,t){var r=e.tree;return this._superApply(arguments).done(function(){if(r.enableFilter&&r.lastFilterArgs&&e.options.filter.autoApply){r._applyFilterImpl.apply(r,r.lastFilterArgs)}})},nodeSetExpanded:function(e,t,r){var n=e.node;delete n._filterAutoExpanded;if(!t&&e.options.filter.hideExpandedCounter&&n.$subMatchBadge){n.$subMatchBadge.show()}return this._superApply(arguments)},nodeRenderStatus:function(e){var t,r=e.node,n=e.tree,i=e.options.filter,a=y(r.span).find("span.fancytree-title"),o=y(r[n.statusClassPropName]),s=e.options.enhanceTitle,l=e.options.escapeTitles;t=this._super(e);if(!o.length||!n.enableFilter){return t}o.toggleClass("fancytree-match",!!r.match).toggleClass("fancytree-submatch",!!r.subMatchCount).toggleClass("fancytree-hide",!(r.match||r.subMatchCount));if(i.counter&&r.subMatchCount&&(!r.isExpanded()||!i.hideExpandedCounter)){if(!r.$subMatchBadge){r.$subMatchBadge=y("<span class='fancytree-childcounter'/>");y("span.fancytree-icon, span.fancytree-custom-icon",r.span).append(r.$subMatchBadge)}r.$subMatchBadge.show().text(r.subMatchCount)}else if(r.$subMatchBadge){r.$subMatchBadge.hide()}if(r.span&&(!r.isEditing||!r.isEditing.call(r))){if(r.titleWithHighlight){a.html(r.titleWithHighlight)}else if(l){a.text(r.title)}else{a.html(r.title)}if(s){s({type:"enhanceTitle"},{node:r,$title:a})}}return t}});return y.ui.fancytree});(function(e){"use strict";var t=".nanobar{width:100%;height:4px;z-index:9999;top:0}.bar{width:0;height:100%;transition:height .3s;background:#000}";function o(){var e=document.getElementById("nanobarcss");if(e===null){e=document.createElement("style");e.type="text/css";e.id="nanobarcss";document.head.insertBefore(e,document.head.firstChild);if(!e.styleSheet)return e.appendChild(document.createTextNode(t));e.styleSheet.cssText=t}}function u(e,t){if(e.classList)e.classList.add(t);else e.className+=" "+t}function s(t){var r=document.createElement("div"),n=0,i=0,a=0,e={el:r,go:l};u(r,"bar");function o(){var e=n-i;if(e<.1&&e>-.1){s(i);a=0;if(n>=100){r.style.height=0;setTimeout(function(){t(r)},300)}}else{s(n-e/4);setTimeout(l,16)}}function s(e){n=e;r.style.width=n+"%"}function l(e){if(e>=0){i=e;if(!a){a=1;o()}}else if(a){o()}}return e}function r(e){e=e||{};var t=document.createElement("div"),r,n={el:t,go:function(e){r(e);if(e>=100){a()}}};function i(e){t.removeChild(e)}function a(){var e=s(i);t.appendChild(e.el);r=e.go}o();u(t,"nanobar");if(e.id)t.id=e.id;if(e.classname)u(t,e.classname);if(e.target){t.style.position="relative";e.target.insertBefore(t,e.target.firstChild)}else{t.style.position="fixed";document.getElementsByTagName("body")[0].appendChild(t)}a();return n}if(typeof exports==="object"){module.exports=r}else if(typeof define==="function"&&define.amd){define([],function(){return r})}else{e.Nanobar=r}})(this);var NotifierjsConfig={defaultTimeOut:3e3,position:["bottom","right"],notificationStyles:{padding:"12px 18px",margin:"0 0 6px 0","background-color":"#000",opacity:.8,"-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=80)",filter:"alpha(opacity = 80)",color:"#fff","border-radius":"3px","box-shadow":"#999 0 0 12px","max-width":"800px","min-width":"240px"},notificationStylesHover:{opacity:1,"-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)",filter:"alpha(opacity = 100)","box-shadow":"#000 0 0 12px"},container:$("<div></div>")};$(document).ready(function(){NotifierjsConfig.container.css("position","fixed");NotifierjsConfig.container.css("z-index",9999);NotifierjsConfig.container.css(NotifierjsConfig.position[0],"12px");NotifierjsConfig.container.css(NotifierjsConfig.position[1],"12px");$("body").append(NotifierjsConfig.container)});function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;").replace(/'/g,"&#39;")}function getNotificationElement(){var e=$("<div></div>");e.css(NotifierjsConfig.notificationStyles);e.hover(function(){$(this).css(NotifierjsConfig.notificationStylesHover)},function(){$(this).css(NotifierjsConfig.notificationStyles)});return e}var Notifier={};Notifier.notify=function(e,t,r,n){var i=getNotificationElement();if(r){var a=$("<img/>");a.attr("src",r);a.css("width","36px");a.css("height","36px");a.css("display","inline-block");a.css("vertical-align","middle");i.append(a)}var o=$("<div/>");o.css("display","inline-block");o.css("vertical-align","middle");o.css("padding","0 12px");if(t){var s=$("<div/>");s.append(escapeHtml(t));s.css("font-weight","bold");s.css("margin-bottom","2px");o.append(s)}if(e){var l=$("<div/>");l.append(escapeHtml(e));o.append(l)}if(!n){n=NotifierjsConfig.defaultTimeOut}i.delay(n).fadeOut(300,function(){$(this).remove()});i.bind("click",function(){i.remove()});i.append(o);NotifierjsConfig.container.prepend(i)};Notifier.info=function(e,t){Notifier.notify(e,t,"/assets/bundle/img/icon/ico_notification_information.png")};Notifier.warning=function(e,t){Notifier.notify(e,t,"/assets/bundle/img/icon/ico_notification_warning.png")};Notifier.error=function(e,t){Notifier.notify(e,t,"/assets/bundle/img/icon/ico_notification_error.png")};Notifier.question=function(e,t){Notifier.notify(e,t,"/assets/bundle/img/icon/ico_notification_question.png")};(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof module==="object"&&typeof exports!=="undefined"){module.exports=t()}else{e.Papa=t()}})(this,function r(){"use strict";var l=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof l!=="undefined"){return l}return{}}();function n(){var e=l.URL||l.webkitURL||null;var t=r.toString();return x.BLOB_URL||(x.BLOB_URL=e.createObjectURL(new Blob(["(",t,")();"],{type:"text/javascript"})))}var i=!l.document&&!!l.postMessage,s=i&&/blob:/i.test((l.location||{}).protocol);var u={},a=0;var x={};x.parse=e;x.unparse=t;x.RECORD_SEP=String.fromCharCode(30);x.UNIT_SEP=String.fromCharCode(31);x.BYTE_ORDER_MARK="\ufeff";x.BAD_DELIMITERS=["\r","\n",'"',x.BYTE_ORDER_MARK];x.WORKERS_SUPPORTED=!i&&!!l.Worker;x.NODE_STREAM_INPUT=1;x.LocalChunkSize=1024*1024*10;x.RemoteChunkSize=1024*1024*5;x.DefaultDelimiter=",";x.Parser=D;x.ParserHandle=g;x.NetworkStreamer=o;x.FileStreamer=d;x.StringStreamer=h;x.ReadableStreamStreamer=v;if(typeof PAPA_BROWSER_CONTEXT==="undefined"){x.DuplexStreamStreamer=p}if(l.jQuery){var f=l.jQuery;f.fn.parse=function(i){var n=i.config||{};var a=[];this.each(function(e){var t=f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&l.FileReader;if(!t||!this.files||this.files.length===0)return true;for(var r=0;r<this.files.length;r++){a.push({file:this.files[r],inputElem:this,instanceConfig:f.extend({},n)})}});e();return this;function e(){if(a.length===0){if(H(i.complete))i.complete();return}var t=a[0];if(H(i.before)){var e=i.before(t.file,t.inputElem);if(typeof e==="object"){if(e.action==="abort"){o("AbortError",t.file,t.inputElem,e.reason);return}else if(e.action==="skip"){s();return}else if(typeof e.config==="object")t.instanceConfig=f.extend(t.instanceConfig,e.config)}else if(e==="skip"){s();return}}var r=t.instanceConfig.complete;t.instanceConfig.complete=function(e){if(H(r))r(e,t.file,t.inputElem);s()};x.parse(t.file,t.instanceConfig)}function o(e,t,r,n){if(H(i.error))i.error({name:e},t,r,n)}function s(){a.splice(0,1);e()}}}if(s){l.onmessage=C}function e(e,t){t=t||{};var r=t.dynamicTyping||false;if(H(r)){t.dynamicTypingFunction=r;r={}}t.dynamicTyping=r;t.transform=H(t.transform)?t.transform:false;if(t.worker&&x.WORKERS_SUPPORTED){var n=m();n.userStep=t.step;n.userChunk=t.chunk;n.userComplete=t.complete;n.userError=t.error;t.step=H(t.step);t.chunk=H(t.chunk);t.complete=H(t.complete);t.error=H(t.error);delete t.worker;n.postMessage({input:e,config:t,workerId:n.id});return}var i=null;if(e===x.NODE_STREAM_INPUT&&typeof PAPA_BROWSER_CONTEXT==="undefined"){i=new p(t);return i.getStream()}else if(typeof e==="string"){if(t.download)i=new o(t);else i=new h(t)}else if(e.readable===true&&H(e.read)&&H(e.on)){i=new v(t)}else if(l.File&&e instanceof File||e instanceof Object)i=new d(t);return i.stream(e)}function t(e,t){var i=false;var g=true;var m=",";var y="\r\n";var a='"';var o=a+a;var r=false;var n=null;var s=false;u();var l=new RegExp(B(a),"g");if(typeof e==="string")e=JSON.parse(e);if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,r);else if(typeof e[0]==="object")return f(n||Object.keys(e[0]),e,r)}else if(typeof e==="object"){if(typeof e.data==="string")e.data=JSON.parse(e.data);if(Array.isArray(e.data)){if(!e.fields)e.fields=e.meta&&e.meta.fields;if(!e.fields)e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]==="object"?Object.keys(e.data[0]):[];if(!Array.isArray(e.data[0])&&typeof e.data[0]!=="object")e.data=[e.data]}return f(e.fields||[],e.data||[],r)}throw new Error("Unable to serialize unrecognized input");function u(){if(typeof t!=="object")return;if(typeof t.delimiter==="string"&&!x.BAD_DELIMITERS.filter(function(e){return t.delimiter.indexOf(e)!==-1}).length){m=t.delimiter}if(typeof t.quotes==="boolean"||typeof t.quotes==="function"||Array.isArray(t.quotes))i=t.quotes;if(typeof t.skipEmptyLines==="boolean"||typeof t.skipEmptyLines==="string")r=t.skipEmptyLines;if(typeof t.newline==="string")y=t.newline;if(typeof t.quoteChar==="string")a=t.quoteChar;if(typeof t.header==="boolean")g=t.header;if(Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");n=t.columns}if(t.escapeChar!==undefined){o=t.escapeChar+a}if(typeof t.escapeFormulae==="boolean")s=t.escapeFormulae}function f(e,t,r){var n="";if(typeof e==="string")e=JSON.parse(e);if(typeof t==="string")t=JSON.parse(t);var i=Array.isArray(e)&&e.length>0;var a=!Array.isArray(t[0]);if(i&&g){for(var o=0;o<e.length;o++){if(o>0)n+=m;n+=b(e[o],o)}if(t.length>0)n+=y}for(var s=0;s<t.length;s++){var l=i?e.length:t[s].length;var u=false;var f=i?Object.keys(t[s]).length===0:t[s].length===0;if(r&&!i){u=r==="greedy"?t[s].join("").trim()==="":t[s].length===1&&t[s][0].length===0}if(r==="greedy"&&i){var c=[];for(var d=0;d<l;d++){var h=a?e[d]:d;c.push(t[s][h])}u=c.join("").trim()===""}if(!u){for(var v=0;v<l;v++){if(v>0&&!f)n+=m;var p=i&&a?e[v]:v;n+=b(t[s][p],v)}if(s<t.length-1&&(!r||l>0&&!f)){n+=y}}}return n}function b(e,t){if(typeof e==="undefined"||e===null)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);if(s===true&&typeof e==="string"&&e.match(/^[=+\-@].*$/)!==null){e="'"+e}var r=e.toString().replace(l,o);var n=typeof i==="boolean"&&i||typeof i==="function"&&i(e,t)||Array.isArray(i)&&i[t]||c(r,x.BAD_DELIMITERS)||r.indexOf(m)>-1||r.charAt(0)===" "||r.charAt(r.length-1)===" ";return n?a+r+a:r}function c(e,t){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return true;return false}}function c(e){this._handle=null;this._finished=false;this._completed=false;this._halted=false;this._input=null;this._baseIndex=0;this._partialLine="";this._rowCount=0;this._start=0;this._nextChunk=null;this.isFirstChunk=true;this._completeResults={data:[],errors:[],meta:{}};t.call(this,e);this.parseChunk=function(e,t){if(this.isFirstChunk&&H(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);if(r!==undefined)e=r}this.isFirstChunk=false;this._halted=false;var n=this._partialLine+e;this._partialLine="";var i=this._handle.parse(n,this._baseIndex,!this._finished);if(this._handle.paused()||this._handle.aborted()){this._halted=true;return}var a=i.meta.cursor;if(!this._finished){this._partialLine=n.substring(a-this._baseIndex);this._baseIndex=a}if(i&&i.data)this._rowCount+=i.data.length;var o=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s){l.postMessage({results:i,workerId:x.WORKER_ID,finished:o})}else if(H(this._config.chunk)&&!t){this._config.chunk(i,this._handle);if(this._handle.paused()||this._handle.aborted()){this._halted=true;return}i=undefined;this._completeResults=undefined}if(!this._config.step&&!this._config.chunk){this._completeResults.data=this._completeResults.data.concat(i.data);this._completeResults.errors=this._completeResults.errors.concat(i.errors);this._completeResults.meta=i.meta}if(!this._completed&&o&&H(this._config.complete)&&(!i||!i.meta.aborted)){this._config.complete(this._completeResults,this._input);this._completed=true}if(!o&&(!i||!i.meta.paused))this._nextChunk();return i};this._sendError=function(e){if(H(this._config.error))this._config.error(e);else if(s&&this._config.error){l.postMessage({workerId:x.WORKER_ID,error:e,finished:false})}};function t(e){var t=R(e);t.chunkSize=parseInt(t.chunkSize);if(!e.step&&!e.chunk)t.chunkSize=null;this._handle=new g(t);this._handle.streamer=this;this._config=t}}function o(e){e=e||{};if(!e.chunkSize)e.chunkSize=x.RemoteChunkSize;c.call(this,e);var n;if(i){this._nextChunk=function(){this._readChunk();this._chunkLoaded()}}else{this._nextChunk=function(){this._readChunk()}}this.stream=function(e){this._input=e;this._nextChunk()};this._readChunk=function(){if(this._finished){this._chunkLoaded();return}n=new XMLHttpRequest;if(this._config.withCredentials){n.withCredentials=this._config.withCredentials}if(!i){n.onload=S(this._chunkLoaded,this);n.onerror=S(this._chunkError,this)}n.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i);if(this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e){n.setRequestHeader(t,e[t])}}if(this._config.chunkSize){var r=this._start+this._config.chunkSize-1;n.setRequestHeader("Range","bytes="+this._start+"-"+r)}try{n.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}if(i&&n.status===0)this._chunkError()};this._chunkLoaded=function(){if(n.readyState!==4)return;if(n.status<200||n.status>=400){this._chunkError();return}this._start+=this._config.chunkSize?this._config.chunkSize:n.responseText.length;this._finished=!this._config.chunkSize||this._start>=t(n);this.parseChunk(n.responseText)};this._chunkError=function(e){var t=n.statusText||e;this._sendError(new Error(t))};function t(e){var t=e.getResponseHeader("Content-Range");if(t===null){return-1}return parseInt(t.substring(t.lastIndexOf("/")+1))}}o.prototype=Object.create(c.prototype);o.prototype.constructor=o;function d(e){e=e||{};if(!e.chunkSize)e.chunkSize=x.LocalChunkSize;c.call(this,e);var n,i;var a=typeof FileReader!=="undefined";this.stream=function(e){this._input=e;i=e.slice||e.webkitSlice||e.mozSlice;if(a){n=new FileReader;n.onload=S(this._chunkLoaded,this);n.onerror=S(this._chunkError,this)}else n=new FileReaderSync;this._nextChunk()};this._nextChunk=function(){if(!this._finished&&(!this._config.preview||this._rowCount<this._config.preview))this._readChunk()};this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=i.call(e,this._start,t)}var r=n.readAsText(e,this._config.encoding);if(!a)this._chunkLoaded({target:{result:r}})};this._chunkLoaded=function(e){this._start+=this._config.chunkSize;this._finished=!this._config.chunkSize||this._start>=this._input.size;this.parseChunk(e.target.result)};this._chunkError=function(){this._sendError(n.error)}}d.prototype=Object.create(c.prototype);d.prototype.constructor=d;function h(e){e=e||{};c.call(this,e);var r;this.stream=function(e){r=e;return this._nextChunk()};this._nextChunk=function(){if(this._finished)return;var e=this._config.chunkSize;var t;if(e){t=r.substring(0,e);r=r.substring(e)}else{t=r;r=""}this._finished=!r;return this.parseChunk(t)}}h.prototype=Object.create(h.prototype);h.prototype.constructor=h;function v(e){e=e||{};c.call(this,e);var t=[];var r=true;var n=false;this.pause=function(){c.prototype.pause.apply(this,arguments);this._input.pause()};this.resume=function(){c.prototype.resume.apply(this,arguments);this._input.resume()};this.stream=function(e){this._input=e;this._input.on("data",this._streamData);this._input.on("end",this._streamEnd);this._input.on("error",this._streamError)};this._checkIsFinished=function(){if(n&&t.length===1){this._finished=true}};this._nextChunk=function(){this._checkIsFinished();if(t.length){this.parseChunk(t.shift())}else{r=true}};this._streamData=S(function(e){try{t.push(typeof e==="string"?e:e.toString(this._config.encoding));if(r){r=false;this._checkIsFinished();this.parseChunk(t.shift())}}catch(e){this._streamError(e)}},this);this._streamError=S(function(e){this._streamCleanUp();this._sendError(e)},this);this._streamEnd=S(function(){this._streamCleanUp();n=true;this._streamData("")},this);this._streamCleanUp=S(function(){this._input.removeListener("data",this._streamData);this._input.removeListener("end",this._streamEnd);this._input.removeListener("error",this._streamError)},this)}v.prototype=Object.create(c.prototype);v.prototype.constructor=v;function p(e){var t=require("stream").Duplex;var r=R(e);var n=true;var i=false;var a=[];var o=null;this._onCsvData=function(e){var t=e.data;if(!o.push(t)&&!this._handle.paused()){this._handle.pause()}};this._onCsvComplete=function(){o.push(null)};r.step=S(this._onCsvData,this);r.complete=S(this._onCsvComplete,this);c.call(this,r);this._nextChunk=function(){if(i&&a.length===1){this._finished=true}if(a.length){a.shift()()}else{n=true}};this._addToParseQueue=function(e,t){a.push(S(function(){this.parseChunk(typeof e==="string"?e:e.toString(r.encoding));if(H(t)){return t()}},this));if(n){n=false;this._nextChunk()}};this._onRead=function(){if(this._handle.paused()){this._handle.resume()}};this._onWrite=function(e,t,r){this._addToParseQueue(e,r)};this._onWriteComplete=function(){i=true;this._addToParseQueue("")};this.getStream=function(){return o};o=new t({readableObjectMode:true,decodeStrings:false,read:S(this._onRead,this),write:S(this._onWrite,this)});o.once("finish",S(this._onWriteComplete,this))}if(typeof PAPA_BROWSER_CONTEXT==="undefined"){p.prototype=Object.create(c.prototype);p.prototype.constructor=p}function g(m){var r=Math.pow(2,53);var n=-r;var i=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/;var a=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/;var t=this;var o=0;var s=0;var l;var u;var f=false;var e=false;var c;var d=[];var h={data:[],errors:[],meta:{}};if(H(m.step)){var v=m.step;m.step=function(e){h=e;if(b())g();else{g();if(h.data.length===0)return;o+=e.data.length;if(m.preview&&o>m.preview)u.abort();else{h.data=h.data[0];v(h,t)}}}}this.parse=function(e,t,r){var n=m.quoteChar||'"';if(!m.newline)m.newline=T(e,n);c=false;if(!m.delimiter){var i=k(e,m.newline,m.skipEmptyLines,m.comments,m.delimitersToGuess);if(i.successful)m.delimiter=i.bestDelimiter;else{c=true;m.delimiter=x.DefaultDelimiter}h.meta.delimiter=m.delimiter}else if(H(m.delimiter)){m.delimiter=m.delimiter(e);h.meta.delimiter=m.delimiter}var a=R(m);if(m.preview&&m.header)a.preview++;l=e;u=new D(a);h=u.parse(l,t,r);g();return f?{meta:{paused:true}}:h||{meta:{paused:false}}};this.paused=function(){return f};this.pause=function(){f=true;u.abort();l=H(m.chunk)?"":l.substring(u.getCharIndex())};this.resume=function(){if(t.streamer._halted){f=false;t.streamer.parseChunk(l,true)}else{setTimeout(t.resume,3)}};this.aborted=function(){return e};this.abort=function(){e=true;u.abort();h.meta.aborted=true;if(H(m.complete))m.complete(h);l=""};function y(e){return m.skipEmptyLines==="greedy"?e.join("").trim()==="":e.length===1&&e[0].length===0}function p(e){if(i.test(e)){var t=parseFloat(e);if(t>n&&t<r){return true}}return false}function g(){if(h&&c){_("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+x.DefaultDelimiter+"'");c=false}if(m.skipEmptyLines){for(var e=0;e<h.data.length;e++)if(y(h.data[e]))h.data.splice(e--,1)}if(b())w();return E()}function b(){return m.header&&d.length===0}function w(){if(!h)return;function e(e,t){if(H(m.transformHeader))e=m.transformHeader(e,t);d.push(e)}if(Array.isArray(h.data[0])){for(var t=0;b()&&t<h.data.length;t++)h.data[t].forEach(e);h.data.splice(0,1)}else h.data.forEach(e)}function C(e){if(m.dynamicTypingFunction&&m.dynamicTyping[e]===undefined){m.dynamicTyping[e]=m.dynamicTypingFunction(e)}return(m.dynamicTyping[e]||m.dynamicTyping)===true}function S(e,t){if(C(e)){if(t==="true"||t==="TRUE")return true;else if(t==="false"||t==="FALSE")return false;else if(p(t))return parseFloat(t);else if(a.test(t))return new Date(t);else return t===""?null:t}return t}function E(){if(!h||!m.header&&!m.dynamicTyping&&!m.transform)return h;function e(e,t){var r=m.header?{}:[];var n;for(n=0;n<e.length;n++){var i=n;var a=e[n];if(m.header)i=n>=d.length?"__parsed_extra":d[n];if(m.transform)a=m.transform(a,i);a=S(i,a);if(i==="__parsed_extra"){r[i]=r[i]||[];r[i].push(a)}else r[i]=a}if(m.header){if(n>d.length)_("FieldMismatch","TooManyFields","Too many fields: expected "+d.length+" fields but parsed "+n,s+t);else if(n<d.length)_("FieldMismatch","TooFewFields","Too few fields: expected "+d.length+" fields but parsed "+n,s+t)}return r}var t=1;if(!h.data.length||Array.isArray(h.data[0])){h.data=h.data.map(e);t=h.data.length}else h.data=e(h.data,0);if(m.header&&h.meta)h.meta.fields=d;s+=t;return h}function k(e,t,r,n,i){var a,o,s,l;i=i||[",","\t","|",";",x.RECORD_SEP,x.UNIT_SEP];for(var u=0;u<i.length;u++){var f=i[u];var c=0,d=0,h=0;s=undefined;var v=new D({comments:n,delimiter:f,newline:t,preview:10}).parse(e);for(var p=0;p<v.data.length;p++){if(r&&y(v.data[p])){h++;continue}var g=v.data[p].length;d+=g;if(typeof s==="undefined"){s=g;continue}else if(g>0){c+=Math.abs(g-s);s=g}}if(v.data.length>0)d/=v.data.length-h;if((typeof o==="undefined"||c<=o)&&(typeof l==="undefined"||d>l)&&d>1.99){o=c;a=f;l=d}}m.delimiter=a;return{successful:!!a,bestDelimiter:a}}function T(e,t){e=e.substring(0,1024*1024);var r=new RegExp(B(t)+"([^]*?)"+B(t),"gm");e=e.replace(r,"");var n=e.split("\r");var i=e.split("\n");var a=i.length>1&&i[0].length<n[0].length;if(n.length===1||a)return"\n";var o=0;for(var s=0;s<n.length;s++){if(n[s][0]==="\n")o++}return o>=n.length/2?"\r\n":"\r"}function _(e,t,r,n){var i={type:e,code:t,message:r};if(n!==undefined){i.row=n}h.errors.push(i)}}function B(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function D(e){e=e||{};var D=e.delimiter;var R=e.newline;var I=e.comments;var O=e.step;var A=e.preview;var N=e.fastMode;var M;if(e.quoteChar===undefined){M='"'}else{M=e.quoteChar}var L=M;if(e.escapeChar!==undefined){L=e.escapeChar}if(typeof D!=="string"||x.BAD_DELIMITERS.indexOf(D)>-1)D=",";if(I===D)throw new Error("Comment character same as delimiter");else if(I===true)I="#";else if(typeof I!=="string"||x.BAD_DELIMITERS.indexOf(I)>-1)I=false;if(R!=="\n"&&R!=="\r"&&R!=="\r\n")R="\n";var P=0;var F=false;this.parse=function(n,t,r){if(typeof n!=="string")throw new Error("Input must be a string");var i=n.length,e=D.length,a=R.length,o=I.length;var s=H(O);P=0;var l=[],u=[],f=[],c=0;if(!n)return _();if(N||N!==false&&n.indexOf(M)===-1){var d=n.split(R);for(var h=0;h<d.length;h++){f=d[h];P+=f.length;if(h!==d.length-1)P+=R.length;else if(r)return _();if(I&&f.substring(0,o)===I)continue;if(s){l=[];S(f.split(D));x();if(F)return _()}else S(f.split(D));if(A&&h>=A){l=l.slice(0,A);return _(true)}}return _()}var v=n.indexOf(D,P);var p=n.indexOf(R,P);var g=new RegExp(B(L)+B(M),"g");var m=n.indexOf(M,P);for(;;){if(n[P]===M){m=P;P++;for(;;){m=n.indexOf(M,m+1);if(m===-1){if(!r){u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:l.length,index:P})}return k()}if(m===i-1){var y=n.substring(P,m).replace(g,M);return k(y)}if(M===L&&n[m+1]===L){m++;continue}if(M!==L&&m!==0&&n[m-1]===L){continue}if(v!==-1&&v<m+1){v=n.indexOf(D,m+1)}if(p!==-1&&p<m+1){p=n.indexOf(R,m+1)}var b=p===-1?v:Math.min(v,p);var w=E(b);if(n[m+1+w]===D){f.push(n.substring(P,m).replace(g,M));P=m+1+w+e;if(n[m+1+w+e]!==M){m=n.indexOf(M,P)}v=n.indexOf(D,P);p=n.indexOf(R,P);break}var C=E(p);if(n.substring(m+1+C,m+1+C+a)===R){f.push(n.substring(P,m).replace(g,M));T(m+1+C+a);v=n.indexOf(D,P);m=n.indexOf(M,P);if(s){x();if(F)return _()}if(A&&l.length>=A)return _(true);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:l.length,index:P});m++;continue}continue}if(I&&f.length===0&&n.substring(P,P+o)===I){if(p===-1)return _();P=p+a;p=n.indexOf(R,P);v=n.indexOf(D,P);continue}if(v!==-1&&(v<p||p===-1)){f.push(n.substring(P,v));P=v+e;v=n.indexOf(D,P);continue}if(p!==-1){f.push(n.substring(P,p));T(p+a);if(s){x();if(F)return _()}if(A&&l.length>=A)return _(true);continue}break}return k();function S(e){l.push(e);c=P}function E(e){var t=0;if(e!==-1){var r=n.substring(m+1,e);if(r&&r.trim()===""){t=r.length}}return t}function k(e){if(r)return _();if(typeof e==="undefined")e=n.substring(P);f.push(e);P=i;S(f);if(s)x();return _()}function T(e){P=e;S(f);f=[];p=n.indexOf(R,P)}function _(e){return{data:l,errors:u,meta:{delimiter:D,linebreak:R,aborted:F,truncated:!!e,cursor:c+(t||0)}}}function x(){O(_());l=[];u=[]}};this.abort=function(){F=true};this.getCharIndex=function(){return P}}function m(){if(!x.WORKERS_SUPPORTED)return false;var e=n();var t=new l.Worker(e);t.onmessage=y;t.id=a++;u[t.id]=t;return t}function y(e){var t=e.data;var r=u[t.workerId];var n=false;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i=function(){n=true;b(t.workerId,{data:[],errors:[],meta:{aborted:true}})};var a={abort:i,pause:w,resume:w};if(H(r.userStep)){for(var o=0;o<t.results.data.length;o++){r.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},a);if(n)break}delete t.results}else if(H(r.userChunk)){r.userChunk(t.results,a,t.file);delete t.results}}if(t.finished&&!n)b(t.workerId,t.results)}function b(e,t){var r=u[e];if(H(r.userComplete))r.userComplete(t);r.terminate();delete u[e]}function w(){throw new Error("Not implemented.")}function C(e){var t=e.data;if(typeof x.WORKER_ID==="undefined"&&t)x.WORKER_ID=t.workerId;if(typeof t.input==="string"){l.postMessage({workerId:x.WORKER_ID,results:x.parse(t.input,t.config),finished:true})}else if(l.File&&t.input instanceof File||t.input instanceof Object){var r=x.parse(t.input,t.config);if(r)l.postMessage({workerId:x.WORKER_ID,results:r,finished:true})}}function R(e){if(typeof e!=="object"||e===null)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=R(e[r]);return t}function S(e,t){return function(){e.apply(t,arguments)}}function H(e){return typeof e==="function"}return x});var DO_NOT_EXPORT_CODEPAGE=true;var DO_NOT_EXPORT_JSZIP=true;(function(e){if("object"==typeof exports&&"undefined"!=typeof module&&"undefined"==typeof DO_NOT_EXPORT_JSZIP)module.exports=e();else if("function"==typeof define&&define.amd&&"undefined"==typeof DO_NOT_EXPORT_JSZIP){JSZipSync=e();define([],e)}else{var t;"undefined"!=typeof globalThis?t=globalThis:"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof $&&$.global?t=$.global:"undefined"!=typeof self&&(t=self),t.JSZipSync=e()}})(function(){var e,t,r;return function i(a,o,s){function l(r,e){if(!o[r]){if(!a[r]){var t=typeof require=="function"&&require;if(!e&&t)return t(r,!0);if(u)return u(r,!0);throw new Error("Cannot find module '"+r+"'")}var n=o[r]={exports:{}};a[r][0].call(n.exports,function(e){var t=a[r][1][e];return l(t?t:e)},n,n.exports,i,a,o,s)}return o[r].exports}var u=typeof require=="function"&&require;for(var e=0;e<s.length;e++)l(s[e]);return l}({1:[function(e,t,r){"use strict";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e,t){var r="";var n,i,a,o,s,l,u;var f=0;while(f<e.length){n=e.charCodeAt(f++);i=e.charCodeAt(f++);a=e.charCodeAt(f++);o=n>>2;s=(n&3)<<4|i>>4;l=(i&15)<<2|a>>6;u=a&63;if(isNaN(i)){l=u=64}else if(isNaN(a)){u=64}r=r+c.charAt(o)+c.charAt(s)+c.charAt(l)+c.charAt(u)}return r};r.decode=function(e,t){var r="";var n,i,a;var o,s,l,u;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){o=c.indexOf(e.charAt(f++));s=c.indexOf(e.charAt(f++));l=c.indexOf(e.charAt(f++));u=c.indexOf(e.charAt(f++));n=o<<2|s>>4;i=(s&15)<<4|l>>2;a=(l&3)<<6|u;r=r+String.fromCharCode(n);if(l!=64){r=r+String.fromCharCode(i)}if(u!=64){r=r+String.fromCharCode(a)}}return r}},{}],2:[function(e,t,r){"use strict";function n(){this.compressedSize=0;this.uncompressedSize=0;this.crc32=0;this.compressionMethod=null;this.compressedContent=null}n.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};t.exports=n},{}],3:[function(e,t,r){"use strict";r.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null};r.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t,r){"use strict";var l=e("./utils");var u=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function e(t,r){if(typeof t==="undefined"||!t.length){return 0}var n=l.getTypeOf(t)!=="string";if(typeof r=="undefined"){r=0}var e=0;var i=0;var a=0;r=r^-1;for(var o=0,s=t.length;o<s;o++){a=n?t[o]:t.charCodeAt(o);i=(r^a)&255;e=u[i];r=r>>>8^e}return r^-1}},{"./utils":21}],5:[function(e,t,r){"use strict";var n=e("./utils");function i(e){this.data=null;this.length=0;this.index=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0){throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")}},setIndex:function(e){this.checkIndex(e);this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t=0,r;this.checkOffset(e);for(r=this.index+e-1;r>=this.index;r--){t=(t<<8)+this.byteAt(r)}this.index+=e;return t},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};t.exports=i},{"./utils":21}],6:[function(e,t,r){"use strict";r.base64=false;r.binary=false;r.dir=false;r.createFolders=false;r.date=null;r.compression=null;r.comment=null},{}],7:[function(e,t,r){"use strict";var n=e("./utils");r.string2binary=function(e){return n.string2binary(e)};r.string2Uint8Array=function(e){return n.transformTo("uint8array",e)};r.uint8Array2String=function(e){return n.transformTo("string",e)};r.string2Blob=function(e){var t=n.transformTo("arraybuffer",e);return n.arrayBuffer2Blob(t)};r.arrayBuffer2Blob=function(e){return n.arrayBuffer2Blob(e)};r.transformTo=function(e,t){return n.transformTo(e,t)};r.getTypeOf=function(e){return n.getTypeOf(e)};r.checkSupport=function(e){return n.checkSupport(e)};r.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS;r.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS;r.pretty=function(e){return n.pretty(e)};r.findCompression=function(e){return n.findCompression(e)};r.isRegExp=function(e){return n.isRegExp(e)}},{"./utils":21}],8:[function(e,t,r){"use strict";var n=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined";var i=e("pako");r.uncompressInputType=n?"uint8array":"array";r.compressInputType=n?"uint8array":"array";r.magic="\b\0";r.compress=function(e){return i.deflateRaw(e)};r.uncompress=function(e){return i.inflateRaw(e)}},{pako:24}],9:[function(e,t,r){"use strict";var n=e("./base64");function i(e,t){if(!(this instanceof i))return new i(e,t);this.files={};this.comment=null;this.root="";if(e){this.load(e,t)}this.clone=function(){var e=new i;for(var t in this){if(typeof this[t]!=="function"){e[t]=this[t]}}return e}}i.prototype=e("./object");i.prototype.load=e("./load");i.support=e("./support");i.defaults=e("./defaults");i.utils=e("./deprecatedPublicUtils");i.base64={encode:function(e){return n.encode(e)},decode:function(e){return n.decode(e)}};i.compressions=e("./compressions");t.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t,r){"use strict";var o=e("./base64");var s=e("./zipEntries");t.exports=function(e,t){var r,n,i,a;t=t||{};if(t.base64){e=o.decode(e)}n=new s(e,t);r=n.files;for(i=0;i<r.length;i++){a=r[i];this.file(a.fileName,a.decompressed,{binary:true,optimizedBinaryString:true,date:a.date,dir:a.dir,comment:a.fileComment.length?a.fileComment:null,createFolders:t.createFolders})}if(n.zipComment.length){this.comment=n.zipComment}return this}},{"./base64":1,"./zipEntries":22}],11:[function(e,i,t){(function(r){"use strict";var n=function(){};if(typeof r!=="undefined"){var t=!r.from;if(!t)try{r.from("foo","utf8")}catch(e){t=true}n=t?function(e,t){return t?new r(e,t):new r(e)}:r.from.bind(r);if(!r.alloc)r.alloc=function(e){return new r(e)}}i.exports=function(e,t){return typeof e=="number"?r.alloc(e):n(e,t)};i.exports.test=function(e){return r.isBuffer(e)}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],12:[function(e,t,r){"use strict";var n=e("./uint8ArrayReader");function i(e){this.data=e;this.length=this.data.length;this.index=0}i.prototype=new n;i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);this.index+=e;return t};t.exports=i},{"./uint8ArrayReader":18}],13:[function(e,t,r){"use strict";var n=e("./support");var C=e("./utils");var S=e("./crc32");var E=e("./signature");var i=e("./defaults");var g=e("./base64");var m=e("./compressions");var o=e("./compressedObject");var a=e("./nodeBuffer");var k=e("./utf8");var y=e("./stringWriter");var b=e("./uint8ArrayWriter");var s=function(e){if(e._data instanceof o){e._data=e._data.getContent();e.options.binary=true;e.options.base64=false;if(C.getTypeOf(e._data)==="uint8array"){var t=e._data;e._data=new Uint8Array(t.length);if(t.length!==0){e._data.set(t,0)}}}return e._data};var l=function(e){var t=s(e),r=C.getTypeOf(t);if(r==="string"){if(!e.options.binary){if(n.nodebuffer){return a(t,"utf-8")}}return e.asBinary()}return t};var u=function(e){var t=s(this);if(t===null||typeof t==="undefined"){return""}if(this.options.base64){t=g.decode(t)}if(e&&this.options.binary){t=p.utf8decode(t)}else{t=C.transformTo("string",t)}if(!e&&!this.options.binary){t=C.transformTo("string",p.utf8encode(t))}return t};var f=function(e,t,r){this.name=e;this.dir=r.dir;this.date=r.date;this.comment=r.comment;this._data=t;this.options=r;this._initialMetadata={dir:r.dir,date:r.date}};f.prototype={asText:function(){return u.call(this,true)},asBinary:function(){return u.call(this,false)},asNodeBuffer:function(){var e=l(this);return C.transformTo("nodebuffer",e)},asUint8Array:function(){var e=l(this);return C.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var T=function(e,t){var r="",n;for(n=0;n<t;n++){r+=String.fromCharCode(e&255);e=e>>>8}return r};var w=function(){var e={},t,r;for(t=0;t<arguments.length;t++){for(r in arguments[t]){if(arguments[t].hasOwnProperty(r)&&typeof e[r]==="undefined"){e[r]=arguments[t][r]}}}return e};var c=function(e){e=e||{};if(e.base64===true&&(e.binary===null||e.binary===undefined)){e.binary=true}e=w(e,i);e.date=e.date||new Date;if(e.compression!==null)e.compression=e.compression.toUpperCase();return e};var d=function(e,t,r){var n=C.getTypeOf(t),i;r=c(r);if(r.createFolders&&(i=h(e))){v.call(this,i,true)}if(r.dir||t===null||typeof t==="undefined"){r.base64=false;r.binary=false;t=null}else if(n==="string"){if(r.binary&&!r.base64){if(r.optimizedBinaryString!==true){t=C.string2binary(t)}}}else{r.base64=false;r.binary=true;if(!n&&!(t instanceof o)){throw new Error("The data of '"+e+"' is in an unsupported format !")}if(n==="arraybuffer"){t=C.transformTo("uint8array",t)}}var a=new f(e,t,r);this.files[e]=a;return a};var h=function(e){if(e.slice(-1)=="/"){e=e.substring(0,e.length-1)}var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""};var v=function(e,t){if(e.slice(-1)!="/"){e+="/"}t=typeof t!=="undefined"?t:false;if(!this.files[e]){d.call(this,e,null,{dir:true,createFolders:t})}return this.files[e]};var _=function(e,t){var r=new o,n;if(e._data instanceof o){r.uncompressedSize=e._data.uncompressedSize;r.crc32=e._data.crc32;if(r.uncompressedSize===0||e.dir){t=m["STORE"];r.compressedContent="";r.crc32=0}else if(e._data.compressionMethod===t.magic){r.compressedContent=e._data.getCompressedContent()}else{n=e._data.getContent();r.compressedContent=t.compress(C.transformTo(t.compressInputType,n))}}else{n=l(e);if(!n||n.length===0||e.dir){t=m["STORE"];n=""}r.uncompressedSize=n.length;r.crc32=S(n);r.compressedContent=t.compress(C.transformTo(t.compressInputType,n))}r.compressedSize=r.compressedContent.length;r.compressionMethod=t.magic;return r};var x=function(e,t,r,n){var i=r.compressedContent,a=C.transformTo("string",k.utf8encode(t.name)),o=t.comment||"",s=C.transformTo("string",k.utf8encode(o)),l=a.length!==t.name.length,u=s.length!==o.length,f=t.options,c,d,h="",v="",p="",g,m;if(t._initialMetadata.dir!==t.dir){g=t.dir}else{g=f.dir}if(t._initialMetadata.date!==t.date){m=t.date}else{m=f.date}c=m.getHours();c=c<<6;c=c|m.getMinutes();c=c<<5;c=c|m.getSeconds()/2;d=m.getFullYear()-1980;d=d<<4;d=d|m.getMonth()+1;d=d<<5;d=d|m.getDate();if(l){v=T(1,1)+T(S(a),4)+a;h+="up"+T(v.length,2)+v}if(u){p=T(1,1)+T(this.crc32(s),4)+s;h+="uc"+T(p.length,2)+p}var y="";y+="\n\0";y+=l||u?"\0\b":"\0\0";y+=r.compressionMethod;y+=T(c,2);y+=T(d,2);y+=T(r.crc32,4);y+=T(r.compressedSize,4);y+=T(r.uncompressedSize,4);y+=T(a.length,2);y+=T(h.length,2);var b=E.LOCAL_FILE_HEADER+y+a+h;var w=E.CENTRAL_FILE_HEADER+"\0"+y+T(s.length,2)+"\0\0"+"\0\0"+(g===true?"\0\0\0":"\0\0\0\0")+T(n,4)+a+h+s;return{fileRecord:b,dirRecord:w,compressedObject:r}};var p={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t=[],r,n,i,a;for(r in this.files){if(!this.files.hasOwnProperty(r)){continue}i=this.files[r];a=new f(i.name,i._data,w(i.options));n=r.slice(this.root.length,r.length);if(r.slice(0,this.root.length)===this.root&&e(n,a)){t.push(a)}}return t},file:function(r,e,t){if(arguments.length===1){if(C.isRegExp(r)){var n=r;return this.filter(function(e,t){return!t.dir&&n.test(e)})}else{return this.filter(function(e,t){return!t.dir&&e===r})[0]||null}}else{r=this.root+r;d.call(this,r,e,t)}return this},folder:function(r){if(!r){return this}if(C.isRegExp(r)){return this.filter(function(e,t){return t.dir&&r.test(e)})}var e=this.root+r;var t=v.call(this,e);var n=this.clone();n.root=t.name;return n},remove:function(r){r=this.root+r;var e=this.files[r];if(!e){if(r.slice(-1)!="/"){r+="/"}e=this.files[r]}if(e&&!e.dir){delete this.files[r]}else{var t=this.filter(function(e,t){return t.name.slice(0,r.length)===r});for(var n=0;n<t.length;n++){delete this.files[t[n].name]}}return this},generate:function(e){e=w(e||{},{base64:true,compression:"STORE",type:"base64",comment:null});C.checkSupport(e.type);var t=[],r=0,n=0,i,a,o=C.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var s in this.files){if(!this.files.hasOwnProperty(s)){continue}var l=this.files[s];var u=l.options.compression||e.compression.toUpperCase();var f=m[u];if(!f){throw new Error(u+" is not a valid compression method !")}var c=_.call(this,l,f);var d=x.call(this,s,l,c,r);r+=d.fileRecord.length+c.compressedSize;n+=d.dirRecord.length;t.push(d)}var h="";h=E.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+T(t.length,2)+T(t.length,2)+T(n,4)+T(r,4)+T(o.length,2)+o;var v=e.type.toLowerCase();if(v==="uint8array"||v==="arraybuffer"||v==="blob"||v==="nodebuffer"){i=new b(r+n+h.length)}else{i=new y(r+n+h.length)}for(a=0;a<t.length;a++){i.append(t[a].fileRecord);i.append(t[a].compressedObject.compressedContent)}for(a=0;a<t.length;a++){i.append(t[a].dirRecord)}i.append(h);var p=i.finalize();switch(e.type.toLowerCase()){case"uint8array":;case"arraybuffer":;case"nodebuffer":return C.transformTo(e.type.toLowerCase(),p);case"blob":return C.arrayBuffer2Blob(C.transformTo("arraybuffer",p));case"base64":return e.base64?g.encode(p):p;default:return p}},crc32:function(e,t){return S(e,t)},utf8encode:function(e){return C.transformTo("string",k.utf8encode(e))},utf8decode:function(e){return k.utf8decode(e)}};t.exports=p},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK";r.CENTRAL_FILE_HEADER="PK";r.CENTRAL_DIRECTORY_END="PK";r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK";r.ZIP64_CENTRAL_DIRECTORY_END="PK";r.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t,r){"use strict";var n=e("./dataReader");var i=e("./utils");function a(e,t){this.data=e;if(!t){this.data=i.string2binary(this.data)}this.length=this.data.length;this.index=0}a.prototype=new n;a.prototype.byteAt=function(e){return this.data.charCodeAt(e)};a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)};a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);this.index+=e;return t};t.exports=a},{"./dataReader":5,"./utils":21}],16:[function(e,t,r){"use strict";var n=e("./utils");var i=function(){this.data=[]};i.prototype={append:function(e){e=n.transformTo("string",e);this.data.push(e)},finalize:function(){return this.data.join("")}};t.exports=i},{"./utils":21}],17:[function(e,t,i){(function(e){"use strict";i.base64=true;i.array=true;i.string=true;i.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";i.nodebuffer=typeof e!=="undefined";i.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined"){i.blob=false}else{var t=new ArrayBuffer(0);try{i.blob=new Blob([t],{type:"application/zip"}).size===0}catch(e){try{var r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var n=new r;n.append(t);i.blob=n.getBlob("application/zip").size===0}catch(e){i.blob=false}}}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],18:[function(e,t,r){"use strict";var n=e("./dataReader");function i(e){if(e){this.data=e;this.length=this.data.length;this.index=0}}i.prototype=new n;i.prototype.byteAt=function(e){return this.data[e]};i.prototype.lastIndexOfSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3);for(var a=this.length-4;a>=0;--a){if(this.data[a]===t&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===i){return a}}return-1};i.prototype.readData=function(e){this.checkOffset(e);if(e===0){return new Uint8Array(0)}var t=this.data.subarray(this.index,this.index+e);this.index+=e;return t};t.exports=i},{"./dataReader":5}],19:[function(e,t,r){"use strict";var n=e("./utils");var i=function(e){this.data=new Uint8Array(e);this.index=0};i.prototype={append:function(e){if(e.length!==0){e=n.transformTo("uint8array",e);this.data.set(e,this.index);this.index+=e.length}},finalize:function(){return this.data}};t.exports=i},{"./utils":21}],20:[function(e,t,r){"use strict";var l=e("./utils");var u=e("./support");var n=e("./nodeBuffer");var f=new Array(256);for(var i=0;i<256;i++){f[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1}f[254]=f[254]=1;var a=function(e){var t,r,n,i,a,o=e.length,s=0;for(i=0;i<o;i++){r=e.charCodeAt(i);if((r&64512)===55296&&i+1<o){n=e.charCodeAt(i+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);i++}}s+=r<128?1:r<2048?2:r<65536?3:4}if(u.uint8array){t=new Uint8Array(s)}else{t=new Array(s)}for(a=0,i=0;a<s;i++){r=e.charCodeAt(i);if((r&64512)===55296&&i+1<o){n=e.charCodeAt(i+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);i++}}if(r<128){t[a++]=r}else if(r<2048){t[a++]=192|r>>>6;t[a++]=128|r&63}else if(r<65536){t[a++]=224|r>>>12;t[a++]=128|r>>>6&63;t[a++]=128|r&63}else{t[a++]=240|r>>>18;t[a++]=128|r>>>12&63;t[a++]=128|r>>>6&63;t[a++]=128|r&63}}return t};var s=function(e,t){var r;t=t||e.length;if(t>e.length){t=e.length}r=t-1;while(r>=0&&(e[r]&192)===128){r--}if(r<0){return t}if(r===0){return t}return r+f[e[r]]>t?r:t};var c=function(e){var t,r,n,i,a;var o=e.length;var s=new Array(o*2);for(n=0,r=0;r<o;){i=e[r++];if(i<128){s[n++]=i;continue}a=f[i];if(a>4){s[n++]=65533;r+=a-1;continue}i&=a===2?31:a===3?15:7;while(a>1&&r<o){i=i<<6|e[r++]&63;a--}if(a>1){s[n++]=65533;continue}if(i<65536){s[n++]=i}else{i-=65536;s[n++]=55296|i>>10&1023;s[n++]=56320|i&1023}}if(s.length!==n){if(s.subarray){s=s.subarray(0,n)}else{s.length=n}}return l.applyFromCharCode(s)};r.utf8encode=function e(t){if(u.nodebuffer){return n(t,"utf-8")}return a(t)};r.utf8decode=function e(t){if(u.nodebuffer){return l.transformTo("nodebuffer",t).toString("utf-8")}t=l.transformTo(u.uint8array?"uint8array":"array",t);var r=[],n=0,i=t.length,a=65536;while(n<i){var o=s(t,Math.min(n+a,i));if(u.uint8array){r.push(c(t.subarray(n,o)))}else{r.push(c(t.slice(n,o)))}n=o}return r.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,u){"use strict";var r=e("./support");var n=e("./compressions");var f=e("./nodeBuffer");u.string2binary=function(e){var t="";for(var r=0;r<e.length;r++){t+=String.fromCharCode(e.charCodeAt(r)&255)}return t};u.arrayBuffer2Blob=function(t){u.checkSupport("blob");try{return new Blob([t],{type:"application/zip"})}catch(e){try{var r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var n=new r;n.append(t);return n.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}};function i(e){return e}function a(e,t){for(var r=0;r<e.length;++r){t[r]=e.charCodeAt(r)&255}return t}function o(e){var t=65536;var r=[],n=e.length,i=u.getTypeOf(e),a=0,o=true;try{switch(i){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,f(0));break}}catch(e){o=false}if(!o){var s="";for(var l=0;l<e.length;l++){s+=String.fromCharCode(e[l])}return s}while(a<n&&t>1){try{if(i==="array"||i==="nodebuffer"){r.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+t,n))))}else{r.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+t,n))))}a+=t}catch(e){t=Math.floor(t/2)}}return r.join("")}u.applyFromCharCode=o;function s(e,t){for(var r=0;r<e.length;r++){t[r]=e[r]}return t}var l={};l["string"]={string:i,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return l["string"]["uint8array"](e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,f(e.length))}};l["array"]={string:o,array:i,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return f(e)}};l["arraybuffer"]={string:function(e){return o(new Uint8Array(e))},array:function(e){return s(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:i,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return f(new Uint8Array(e))}};l["uint8array"]={string:o,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:i,nodebuffer:function(e){return f(e)}};l["nodebuffer"]={string:o,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return l["nodebuffer"]["uint8array"](e).buffer},uint8array:function(e){return s(e,new Uint8Array(e.length))},nodebuffer:i};u.transformTo=function(e,t){if(!t){t=""}if(!e){return t}u.checkSupport(e);var r=u.getTypeOf(t);var n=l[r][e](t);return n};u.getTypeOf=function(e){if(typeof e==="string"){return"string"}if(Object.prototype.toString.call(e)==="[object Array]"){return"array"}if(r.nodebuffer&&f.test(e)){return"nodebuffer"}if(r.uint8array&&e instanceof Uint8Array){return"uint8array"}if(r.arraybuffer&&e instanceof ArrayBuffer){return"arraybuffer"}};u.checkSupport=function(e){var t=r[e.toLowerCase()];if(!t){throw new Error(e+" is not supported by this browser")}};u.MAX_VALUE_16BITS=65535;u.MAX_VALUE_32BITS=-1;u.pretty=function(e){var t="",r,n;for(n=0;n<(e||"").length;n++){r=e.charCodeAt(n);t+="\\x"+(r<16?"0":"")+r.toString(16).toUpperCase()}return t};u.findCompression=function(e){for(var t in n){if(!n.hasOwnProperty(t)){continue}if(n[t].magic===e){return n[t]}}return null};u.isRegExp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t,r){"use strict";var n=e("./stringReader");var i=e("./nodeBufferReader");var a=e("./uint8ArrayReader");var o=e("./utils");var s=e("./signature");var l=e("./zipEntry");var u=e("./support");var f=e("./object");function c(e,t){this.files=[];this.loadOptions=t;if(e){this.load(e)}}c.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e){throw new Error("Corrupted zip or bug : unexpected signature "+"("+o.pretty(t)+", expected "+o.pretty(e)+")")}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength);this.zipComment=f.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var e=this.zip64EndOfCentralSize-44,t=0,r,n,i;while(t<e){r=this.reader.readInt(2);n=this.reader.readInt(4);i=this.reader.readString(n);this.zip64ExtensibleData[r]={id:r,length:n,value:i}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++){t=this.files[e];this.reader.setIndex(t.localHeaderOffset);this.checkSignature(s.LOCAL_FILE_HEADER);t.readLocalPart(this.reader);t.handleUTF8()}},readCentralDir:function(){var e;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===s.CENTRAL_FILE_HEADER){e=new l({zip64:this.zip64},this.loadOptions);e.readCentralPart(this.reader);this.files.push(e)}},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e===-1){throw new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(e);this.checkSignature(s.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){this.zip64=true;e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(e===-1){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator")}this.reader.setIndex(e);this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=o.getTypeOf(e);if(t==="string"&&!u.uint8array){this.reader=new n(e,this.loadOptions.optimizedBinaryString)}else if(t==="nodebuffer"){this.reader=new i(e)}else{this.reader=new a(o.transformTo("uint8array",e))}},load:function(e){this.prepareReader(e);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};t.exports=c},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t,r){"use strict";var n=e("./stringReader");var a=e("./utils");var i=e("./compressedObject");var o=e("./object");function s(e,t){this.options=e;this.loadOptions=t}s.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(r,n,i){return function(){var e=r.index;r.setIndex(n);var t=r.readData(i);r.setIndex(e);return t}},prepareContent:function(e,t,r,n,i){return function(){var e=a.transformTo(n.uncompressInputType,this.getCompressedContent());var t=n.uncompress(e);if(t.length!==i){throw new Error("Bug : uncompressed data size mismatch")}return t}},readLocalPart:function(e){var t,r;e.skip(22);this.fileNameLength=e.readInt(2);r=e.readInt(2);this.fileName=e.readString(this.fileNameLength);e.skip(r);if(this.compressedSize==-1||this.uncompressedSize==-1){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory "+"(compressedSize == -1 || uncompressedSize == -1)")}t=a.findCompression(this.compressionMethod);if(t===null){throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")}this.decompressed=new i;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t);this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize);if(this.loadOptions.checkCRC32){this.decompressed=a.transformTo("string",this.decompressed.getContent());if(o.crc32(this.decompressed)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}}},readCentralPart:function(e){this.versionMadeBy=e.readString(2);this.versionNeeded=e.readInt(2);this.bitFlag=e.readInt(2);this.compressionMethod=e.readString(2);this.date=e.readDate();this.crc32=e.readInt(4);this.compressedSize=e.readInt(4);this.uncompressedSize=e.readInt(4);this.fileNameLength=e.readInt(2);this.extraFieldsLength=e.readInt(2);this.fileCommentLength=e.readInt(2);this.diskNumberStart=e.readInt(2);this.internalFileAttributes=e.readInt(2);this.externalFileAttributes=e.readInt(4);this.localHeaderOffset=e.readInt(4);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}this.fileName=e.readString(this.fileNameLength);this.readExtraFields(e);this.parseZIP64ExtraField(e);this.fileComment=e.readString(this.fileCommentLength);this.dir=this.externalFileAttributes&16?true:false},parseZIP64ExtraField:function(e){if(!this.extraFields[1]){return}var t=new n(this.extraFields[1].value);if(this.uncompressedSize===a.MAX_VALUE_32BITS){this.uncompressedSize=t.readInt(8)}if(this.compressedSize===a.MAX_VALUE_32BITS){this.compressedSize=t.readInt(8)}if(this.localHeaderOffset===a.MAX_VALUE_32BITS){this.localHeaderOffset=t.readInt(8)}if(this.diskNumberStart===a.MAX_VALUE_32BITS){this.diskNumberStart=t.readInt(4)}},readExtraFields:function(e){var t=e.index,r,n,i;this.extraFields=this.extraFields||{};while(e.index<t+this.extraFieldsLength){r=e.readInt(2);n=e.readInt(2);i=e.readString(n);this.extraFields[r]={id:r,length:n,value:i}}},handleUTF8:function(){if(this.useUTF8()){this.fileName=o.utf8decode(this.fileName);this.fileComment=o.utf8decode(this.fileComment)}else{var e=this.findExtraFieldUnicodePath();if(e!==null){this.fileName=e}var t=this.findExtraFieldUnicodeComment();if(t!==null){this.fileComment=t}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);if(t.readInt(1)!==1){return null}if(o.crc32(this.fileName)!==t.readInt(4)){return null}return o.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new n(e.value);if(t.readInt(1)!==1){return null}if(o.crc32(this.fileComment)!==t.readInt(4)){return null}return o.utf8decode(t.readString(e.length-5))}return null}};t.exports=s},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t,r){"use strict";var n=e("./lib/utils/common").assign;var i=e("./lib/deflate");var a=e("./lib/inflate");var o=e("./lib/zlib/constants");var s={};n(s,i,a,o);t.exports=s},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,r){"use strict";var o=e("./zlib/deflate.js");var s=e("./utils/common");var l=e("./utils/strings");var n=e("./zlib/messages");var i=e("./zlib/zstream");var u=0;var f=4;var c=0;var d=1;var a=-1;var h=0;var v=8;var p=function(e){this.options=s.assign({level:a,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>0){t.windowBits=-t.windowBits}else if(t.gzip&&t.windowBits>0&&t.windowBits<16){t.windowBits+=16}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new i;this.strm.avail_out=0;var r=o.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==c){throw new Error(n[r])}if(t.header){o.deflateSetHeader(this.strm,t.header)}};p.prototype.push=function(e,t){var r=this.strm;var n=this.options.chunkSize;var i,a;if(this.ended){return false}a=t===~~t?t:t===true?f:u;if(typeof e==="string"){r.input=l.string2buf(e)}else{r.input=e}r.next_in=0;r.avail_in=r.input.length;do{if(r.avail_out===0){r.output=new s.Buf8(n);r.next_out=0;r.avail_out=n}i=o.deflate(r,a);if(i!==d&&i!==c){this.onEnd(i);this.ended=true;return false}if(r.avail_out===0||r.avail_in===0&&a===f){if(this.options.to==="string"){this.onData(l.buf2binstring(s.shrinkBuf(r.output,r.next_out)))}else{this.onData(s.shrinkBuf(r.output,r.next_out))}}}while((r.avail_in>0||r.avail_out===0)&&i!==d);if(a===f){i=o.deflateEnd(this.strm);this.onEnd(i);this.ended=true;return i===c}return true};p.prototype.onData=function(e){this.chunks.push(e)};p.prototype.onEnd=function(e){if(e===c){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=s.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function g(e,t){var r=new p(t);r.push(e,true);if(r.err){throw r.msg}return r.result}function m(e,t){t=t||{};t.raw=true;return g(e,t)}function y(e,t){t=t||{};t.gzip=true;return g(e,t)}r.Deflate=p;r.deflate=g;r.deflateRaw=m;r.gzip=y},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,r){"use strict";var u=e("./zlib/inflate.js");var f=e("./utils/common");var c=e("./utils/strings");var d=e("./zlib/constants");var n=e("./zlib/messages");var i=e("./zlib/zstream");var a=e("./zlib/gzheader");var o=function(e){this.options=f.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>=0&&t.windowBits<16){t.windowBits=-t.windowBits;if(t.windowBits===0){t.windowBits=-15}}if(t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)){t.windowBits+=32}if(t.windowBits>15&&t.windowBits<48){if((t.windowBits&15)===0){t.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new i;this.strm.avail_out=0;var r=u.inflateInit2(this.strm,t.windowBits);if(r!==d.Z_OK){throw new Error(n[r])}this.header=new a;u.inflateGetHeader(this.strm,this.header)};o.prototype.push=function(e,t){var r=this.strm;var n=this.options.chunkSize;var i,a;var o,s,l;if(this.ended){return false}a=t===~~t?t:t===true?d.Z_FINISH:d.Z_NO_FLUSH;if(typeof e==="string"){r.input=c.binstring2buf(e)}else{r.input=e}r.next_in=0;r.avail_in=r.input.length;do{if(r.avail_out===0){r.output=new f.Buf8(n);r.next_out=0;r.avail_out=n}i=u.inflate(r,d.Z_NO_FLUSH);if(i!==d.Z_STREAM_END&&i!==d.Z_OK){this.onEnd(i);this.ended=true;return false}if(r.next_out){if(r.avail_out===0||i===d.Z_STREAM_END||r.avail_in===0&&a===d.Z_FINISH){if(this.options.to==="string"){o=c.utf8border(r.output,r.next_out);s=r.next_out-o;l=c.buf2string(r.output,o);r.next_out=s;r.avail_out=n-s;if(s){f.arraySet(r.output,r.output,o,s,0)}this.onData(l)}else{this.onData(f.shrinkBuf(r.output,r.next_out))}}}}while(r.avail_in>0&&i!==d.Z_STREAM_END);if(i===d.Z_STREAM_END){a=d.Z_FINISH}if(a===d.Z_FINISH){i=u.inflateEnd(this.strm);this.onEnd(i);this.ended=true;return i===d.Z_OK}return true};o.prototype.onData=function(e){this.chunks.push(e)};o.prototype.onEnd=function(e){if(e===d.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=f.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function s(e,t){var r=new o(t);r.push(e,true);if(r.err){throw r.msg}return r.result}function l(e,t){t=t||{};t.raw=true;return s(e,t)}r.Inflate=o;r.inflate=s;r.inflateRaw=l;r.ungzip=s},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,r){"use strict";var n=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";r.assign=function(e){var t=Array.prototype.slice.call(arguments,1);while(t.length){var r=t.shift();if(!r){continue}if(typeof r!=="object"){throw new TypeError(r+"must be non-object")}for(var n in r){if(r.hasOwnProperty(n)){e[n]=r[n]}}}return e};r.shrinkBuf=function(e,t){if(e.length===t){return e}if(e.subarray){return e.subarray(0,t)}e.length=t;return e};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray){e.set(t.subarray(r,r+n),i);return}for(var a=0;a<n;a++){e[i+a]=t[r+a]}},flattenChunks:function(e){var t,r,n,i,a,o;n=0;for(t=0,r=e.length;t<r;t++){n+=e[t].length}o=new Uint8Array(n);i=0;for(t=0,r=e.length;t<r;t++){a=e[t];o.set(a,i);i+=a.length}return o}};var a={arraySet:function(e,t,r,n,i){for(var a=0;a<n;a++){e[i+a]=t[r+a]}},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){if(e){r.Buf8=Uint8Array;r.Buf16=Uint16Array;r.Buf32=Int32Array;r.assign(r,i)}else{r.Buf8=Array;r.Buf16=Array;r.Buf32=Array;r.assign(r,a)}};r.setTyped(n)},{}],28:[function(e,t,r){"use strict";var l=e("./common");var i=true;var a=true;try{String.fromCharCode.apply(null,[0])}catch(e){i=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=false}var u=new l.Buf8(256);for(var n=0;n<256;n++){u[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1}u[254]=u[254]=1;r.string2buf=function(e){var t,r,n,i,a,o=e.length,s=0;for(i=0;i<o;i++){r=e.charCodeAt(i);if((r&64512)===55296&&i+1<o){n=e.charCodeAt(i+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);i++}}s+=r<128?1:r<2048?2:r<65536?3:4}t=new l.Buf8(s);for(a=0,i=0;a<s;i++){r=e.charCodeAt(i);if((r&64512)===55296&&i+1<o){n=e.charCodeAt(i+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);i++}}if(r<128){t[a++]=r}else if(r<2048){t[a++]=192|r>>>6;t[a++]=128|r&63}else if(r<65536){t[a++]=224|r>>>12;t[a++]=128|r>>>6&63;t[a++]=128|r&63}else{t[a++]=240|r>>>18;t[a++]=128|r>>>12&63;t[a++]=128|r>>>6&63;t[a++]=128|r&63}}return t};function f(e,t){if(t<65537){if(e.subarray&&a||!e.subarray&&i){return String.fromCharCode.apply(null,l.shrinkBuf(e,t))}}var r="";for(var n=0;n<t;n++){r+=String.fromCharCode(e[n])}return r}r.buf2binstring=function(e){return f(e,e.length)};r.binstring2buf=function(e){var t=new l.Buf8(e.length);for(var r=0,n=t.length;r<n;r++){t[r]=e.charCodeAt(r)}return t};r.buf2string=function(e,t){var r,n,i,a;var o=t||e.length;var s=new Array(o*2);for(n=0,r=0;r<o;){i=e[r++];if(i<128){s[n++]=i;continue}a=u[i];if(a>4){s[n++]=65533;r+=a-1;continue}i&=a===2?31:a===3?15:7;while(a>1&&r<o){i=i<<6|e[r++]&63;a--}if(a>1){s[n++]=65533;continue}if(i<65536){s[n++]=i}else{i-=65536;s[n++]=55296|i>>10&1023;s[n++]=56320|i&1023}}return f(s,n)};r.utf8border=function(e,t){var r;t=t||e.length;if(t>e.length){t=e.length}r=t-1;while(r>=0&&(e[r]&192)===128){r--}if(r<0){return t}if(r===0){return t}return r+u[e[r]]>t?r:t}},{"./common":27}],29:[function(e,t,r){"use strict";function n(e,t,r,n){var i=e&65535|0,a=e>>>16&65535|0,o=0;while(r!==0){o=r>2e3?2e3:r;r-=o;do{i=i+t[n++]|0;a=a+i|0}while(--o);i%=65521;a%=65521}return i|a<<16|0}t.exports=n},{}],30:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t,r){"use strict";function n(){var e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++){e=e&1?3988292384^e>>>1:e>>>1}t[r]=e}return t}var s=n();function i(e,t,r,n){var i=s,a=n+r;e=e^-1;for(var o=n;o<a;o++){e=e>>>8^i[(e^t[o])&255]}return e^-1}t.exports=i},{}],32:[function(e,t,r){"use strict";var l=e("../utils/common");var u=e("./trees");var a=e("./adler32");var f=e("./crc32");var n=e("./messages");var c=0;var d=1;var h=3;var v=4;var p=5;var g=0;var m=1;var y=-2;var i=-3;var b=-5;var w=-1;var o=1;var C=2;var S=3;var E=4;var s=0;var k=2;var T=8;var _=9;var x=15;var D=8;var R=29;var I=256;var O=I+1+R;var A=30;var N=19;var M=2*O+1;var L=15;var P=3;var F=258;var B=F+P+1;var H=32;var $=42;var W=69;var U=73;var j=91;var V=103;var z=113;var q=666;var Y=1;var G=2;var X=3;var K=4;var J=3;function Q(e,t){e.msg=n[t];return t}function Z(e){return(e<<1)-(e>4?9:0)}function ee(e){var t=e.length;while(--t>=0){e[t]=0}}function te(e){var t=e.state;var r=t.pending;if(r>e.avail_out){r=e.avail_out}if(r===0){return}l.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out);e.next_out+=r;t.pending_out+=r;e.total_out+=r;e.avail_out-=r;t.pending-=r;if(t.pending===0){t.pending_out=0}}function re(e,t){u._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t);e.block_start=e.strstart;te(e.strm)}function ne(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255;e.pending_buf[e.pending++]=t&255}function ae(e,t,r,n){var i=e.avail_in;if(i>n){i=n}if(i===0){return 0}e.avail_in-=i;l.arraySet(t,e.input,e.next_in,i,r);if(e.state.wrap===1){e.adler=a(e.adler,t,i,r)}else if(e.state.wrap===2){e.adler=f(e.adler,t,i,r)}e.next_in+=i;e.total_in+=i;return i}function oe(e,t){var r=e.max_chain_length;var n=e.strstart;var i;var a;var o=e.prev_length;var s=e.nice_match;var l=e.strstart>e.w_size-B?e.strstart-(e.w_size-B):0;var u=e.window;var f=e.w_mask;var c=e.prev;var d=e.strstart+F;var h=u[n+o-1];var v=u[n+o];if(e.prev_length>=e.good_match){r>>=2}if(s>e.lookahead){s=e.lookahead}do{i=t;if(u[i+o]!==v||u[i+o-1]!==h||u[i]!==u[n]||u[++i]!==u[n+1]){continue}n+=2;i++;do{}while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<d);a=F-(d-n);n=d-F;if(a>o){e.match_start=t;o=a;if(a>=s){break}h=u[n+o-1];v=u[n+o]}}while((t=c[t&f])>l&&--r!==0);if(o<=e.lookahead){return o}return e.lookahead}function se(e){var t=e.w_size;var r,n,i,a,o;do{a=e.window_size-e.lookahead-e.strstart;if(e.strstart>=t+(t-B)){l.arraySet(e.window,e.window,t,t,0);e.match_start-=t;e.strstart-=t;e.block_start-=t;n=e.hash_size;r=n;do{i=e.head[--r];e.head[r]=i>=t?i-t:0}while(--n);n=t;r=n;do{i=e.prev[--r];e.prev[r]=i>=t?i-t:0}while(--n);a+=t}if(e.strm.avail_in===0){break}n=ae(e.strm,e.window,e.strstart+e.lookahead,a);e.lookahead+=n;if(e.lookahead+e.insert>=P){o=e.strstart-e.insert;e.ins_h=e.window[o];e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;while(e.insert){e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+P-1])&e.hash_mask;e.prev[o&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=o;o++;e.insert--;if(e.lookahead+e.insert<P){break}}}}while(e.lookahead<B&&e.strm.avail_in!==0)}function le(e,t){var r=65535;if(r>e.pending_buf_size-5){r=e.pending_buf_size-5}for(;;){if(e.lookahead<=1){se(e);if(e.lookahead===0&&t===c){return Y}if(e.lookahead===0){break}}e.strstart+=e.lookahead;e.lookahead=0;var n=e.block_start+r;if(e.strstart===0||e.strstart>=n){e.lookahead=e.strstart-n;e.strstart=n;re(e,false);if(e.strm.avail_out===0){return Y}}if(e.strstart-e.block_start>=e.w_size-B){re(e,false);if(e.strm.avail_out===0){return Y}}}e.insert=0;if(t===v){re(e,true);if(e.strm.avail_out===0){return X}return K}if(e.strstart>e.block_start){re(e,false);if(e.strm.avail_out===0){return Y}}return Y}function ue(e,t){var r;var n;for(;;){if(e.lookahead<B){se(e);if(e.lookahead<B&&t===c){return Y}if(e.lookahead===0){break}}r=0;if(e.lookahead>=P){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}if(r!==0&&e.strstart-r<=e.w_size-B){e.match_length=oe(e,r)}if(e.match_length>=P){n=u._tr_tally(e,e.strstart-e.match_start,e.match_length-P);e.lookahead-=e.match_length;if(e.match_length<=e.max_lazy_match&&e.lookahead>=P){e.match_length--;do{e.strstart++;e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}while(--e.match_length!==0);e.strstart++}else{e.strstart+=e.match_length;e.match_length=0;e.ins_h=e.window[e.strstart];e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}}else{n=u._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(n){re(e,false);if(e.strm.avail_out===0){return Y}}}e.insert=e.strstart<P-1?e.strstart:P-1;if(t===v){re(e,true);if(e.strm.avail_out===0){return X}return K}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return Y}}return G}function fe(e,t){var r;var n;var i;for(;;){if(e.lookahead<B){se(e);if(e.lookahead<B&&t===c){return Y}if(e.lookahead===0){break}}r=0;if(e.lookahead>=P){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}e.prev_length=e.match_length;e.prev_match=e.match_start;e.match_length=P-1;if(r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-B){e.match_length=oe(e,r);if(e.match_length<=5&&(e.strategy===o||e.match_length===P&&e.strstart-e.match_start>4096)){e.match_length=P-1}}if(e.prev_length>=P&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-P;n=u._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-P);e.lookahead-=e.prev_length-1;e.prev_length-=2;do{if(++e.strstart<=i){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}}while(--e.prev_length!==0);e.match_available=0;e.match_length=P-1;e.strstart++;if(n){re(e,false);if(e.strm.avail_out===0){return Y}}}else if(e.match_available){n=u._tr_tally(e,0,e.window[e.strstart-1]);if(n){re(e,false)}e.strstart++;e.lookahead--;if(e.strm.avail_out===0){return Y}}else{e.match_available=1;e.strstart++;e.lookahead--}}if(e.match_available){n=u._tr_tally(e,0,e.window[e.strstart-1]);e.match_available=0}e.insert=e.strstart<P-1?e.strstart:P-1;if(t===v){re(e,true);if(e.strm.avail_out===0){return X}return K}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return Y}}return G}function ce(e,t){var r;var n;var i,a;var o=e.window;for(;;){if(e.lookahead<=F){se(e);if(e.lookahead<=F&&t===c){return Y}if(e.lookahead===0){break}}e.match_length=0;if(e.lookahead>=P&&e.strstart>0){i=e.strstart-1;n=o[i];if(n===o[++i]&&n===o[++i]&&n===o[++i]){a=e.strstart+F;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<a);e.match_length=F-(a-i);if(e.match_length>e.lookahead){e.match_length=e.lookahead}}}if(e.match_length>=P){r=u._tr_tally(e,1,e.match_length-P);e.lookahead-=e.match_length;e.strstart+=e.match_length;e.match_length=0}else{r=u._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(r){re(e,false);if(e.strm.avail_out===0){return Y}}}e.insert=0;if(t===v){re(e,true);if(e.strm.avail_out===0){return X}return K}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return Y}}return G}function de(e,t){var r;for(;;){if(e.lookahead===0){se(e);if(e.lookahead===0){if(t===c){return Y}break}}e.match_length=0;r=u._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++;if(r){re(e,false);if(e.strm.avail_out===0){return Y}}}e.insert=0;if(t===v){re(e,true);if(e.strm.avail_out===0){return X}return K}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return Y}}return G}var he=function(e,t,r,n,i){this.good_length=e;this.max_lazy=t;this.nice_length=r;this.max_chain=n;this.func=i};var ve;ve=[new he(0,0,0,0,le),new he(4,4,8,4,ue),new he(4,5,16,8,ue),new he(4,6,32,32,ue),new he(4,4,16,16,fe),new he(8,16,32,32,fe),new he(8,16,128,128,fe),new he(8,32,128,256,fe),new he(32,128,258,1024,fe),new he(32,258,258,4096,fe)];function pe(e){e.window_size=2*e.w_size;ee(e.head);e.max_lazy_match=ve[e.level].max_lazy;e.good_match=ve[e.level].good_length;e.nice_match=ve[e.level].nice_length;e.max_chain_length=ve[e.level].max_chain;e.strstart=0;e.block_start=0;e.lookahead=0;e.insert=0;e.match_length=e.prev_length=P-1;e.match_available=0;e.ins_h=0}function ge(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=T;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new l.Buf16(M*2);this.dyn_dtree=new l.Buf16((2*A+1)*2);this.bl_tree=new l.Buf16((2*N+1)*2);ee(this.dyn_ltree);ee(this.dyn_dtree);ee(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new l.Buf16(L+1);this.heap=new l.Buf16(2*O+1);ee(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new l.Buf16(2*O+1);ee(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function me(e){var t;if(!e||!e.state){return Q(e,y)}e.total_in=e.total_out=0;e.data_type=k;t=e.state;t.pending=0;t.pending_out=0;if(t.wrap<0){t.wrap=-t.wrap}t.status=t.wrap?$:z;e.adler=t.wrap===2?0:1;t.last_flush=c;u._tr_init(t);return g}function ye(e){var t=me(e);if(t===g){pe(e.state)}return t}function be(e,t){if(!e||!e.state){return y}if(e.state.wrap!==2){return y}e.state.gzhead=t;return g}function we(e,t,r,n,i,a){if(!e){return y}var o=1;if(t===w){t=6}if(n<0){o=0;n=-n}else if(n>15){o=2;n-=16}if(i<1||i>_||r!==T||n<8||n>15||t<0||t>9||a<0||a>E){return Q(e,y)}if(n===8){n=9}var s=new ge;e.state=s;s.strm=e;s.wrap=o;s.gzhead=null;s.w_bits=n;s.w_size=1<<s.w_bits;s.w_mask=s.w_size-1;s.hash_bits=i+7;s.hash_size=1<<s.hash_bits;s.hash_mask=s.hash_size-1;s.hash_shift=~~((s.hash_bits+P-1)/P);s.window=new l.Buf8(s.w_size*2);s.head=new l.Buf16(s.hash_size);s.prev=new l.Buf16(s.w_size);s.lit_bufsize=1<<i+6;s.pending_buf_size=s.lit_bufsize*4;s.pending_buf=new l.Buf8(s.pending_buf_size);s.d_buf=s.lit_bufsize>>1;s.l_buf=(1+2)*s.lit_bufsize;s.level=t;s.strategy=a;s.method=r;return ye(e)}function Ce(e,t){return we(e,t,T,x,D,s)}function Se(e,t){var r,n;var i,a;if(!e||!e.state||t>p||t<0){return e?Q(e,y):y}n=e.state;if(!e.output||!e.input&&e.avail_in!==0||n.status===q&&t!==v){return Q(e,e.avail_out===0?b:y)}n.strm=e;r=n.last_flush;n.last_flush=t;if(n.status===$){if(n.wrap===2){e.adler=0;ne(n,31);ne(n,139);ne(n,8);if(!n.gzhead){ne(n,0);ne(n,0);ne(n,0);ne(n,0);ne(n,0);ne(n,n.level===9?2:n.strategy>=C||n.level<2?4:0);ne(n,J);n.status=z}else{ne(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(!n.gzhead.extra?0:4)+(!n.gzhead.name?0:8)+(!n.gzhead.comment?0:16));ne(n,n.gzhead.time&255);ne(n,n.gzhead.time>>8&255);ne(n,n.gzhead.time>>16&255);ne(n,n.gzhead.time>>24&255);ne(n,n.level===9?2:n.strategy>=C||n.level<2?4:0);ne(n,n.gzhead.os&255);if(n.gzhead.extra&&n.gzhead.extra.length){ne(n,n.gzhead.extra.length&255);ne(n,n.gzhead.extra.length>>8&255)}if(n.gzhead.hcrc){e.adler=f(e.adler,n.pending_buf,n.pending,0)}n.gzindex=0;n.status=W}}else{var o=T+(n.w_bits-8<<4)<<8;var s=-1;if(n.strategy>=C||n.level<2){s=0}else if(n.level<6){s=1}else if(n.level===6){s=2}else{s=3}o|=s<<6;if(n.strstart!==0){o|=H}o+=31-o%31;n.status=z;ie(n,o);if(n.strstart!==0){ie(n,e.adler>>>16);ie(n,e.adler&65535)}e.adler=1}}if(n.status===W){if(n.gzhead.extra){i=n.pending;while(n.gzindex<(n.gzhead.extra.length&65535)){if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i){e.adler=f(e.adler,n.pending_buf,n.pending-i,i)}te(e);i=n.pending;if(n.pending===n.pending_buf_size){break}}ne(n,n.gzhead.extra[n.gzindex]&255);n.gzindex++}if(n.gzhead.hcrc&&n.pending>i){e.adler=f(e.adler,n.pending_buf,n.pending-i,i)}if(n.gzindex===n.gzhead.extra.length){n.gzindex=0;n.status=U}}else{n.status=U}}if(n.status===U){if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i){e.adler=f(e.adler,n.pending_buf,n.pending-i,i)}te(e);i=n.pending;if(n.pending===n.pending_buf_size){a=1;break}}if(n.gzindex<n.gzhead.name.length){a=n.gzhead.name.charCodeAt(n.gzindex++)&255}else{a=0}ne(n,a)}while(a!==0);if(n.gzhead.hcrc&&n.pending>i){e.adler=f(e.adler,n.pending_buf,n.pending-i,i)}if(a===0){n.gzindex=0;n.status=j}}else{n.status=j}}if(n.status===j){if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i){e.adler=f(e.adler,n.pending_buf,n.pending-i,i)}te(e);i=n.pending;if(n.pending===n.pending_buf_size){a=1;break}}if(n.gzindex<n.gzhead.comment.length){a=n.gzhead.comment.charCodeAt(n.gzindex++)&255}else{a=0}ne(n,a)}while(a!==0);if(n.gzhead.hcrc&&n.pending>i){e.adler=f(e.adler,n.pending_buf,n.pending-i,i)}if(a===0){n.status=V}}else{n.status=V}}if(n.status===V){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size){te(e)}if(n.pending+2<=n.pending_buf_size){ne(n,e.adler&255);ne(n,e.adler>>8&255);e.adler=0;n.status=z}}else{n.status=z}}if(n.pending!==0){te(e);if(e.avail_out===0){n.last_flush=-1;return g}}else if(e.avail_in===0&&Z(t)<=Z(r)&&t!==v){return Q(e,b)}if(n.status===q&&e.avail_in!==0){return Q(e,b)}if(e.avail_in!==0||n.lookahead!==0||t!==c&&n.status!==q){var l=n.strategy===C?de(n,t):n.strategy===S?ce(n,t):ve[n.level].func(n,t);if(l===X||l===K){n.status=q}if(l===Y||l===X){if(e.avail_out===0){n.last_flush=-1}return g}if(l===G){if(t===d){u._tr_align(n)}else if(t!==p){u._tr_stored_block(n,0,0,false);if(t===h){ee(n.head);if(n.lookahead===0){n.strstart=0;n.block_start=0;n.insert=0}}}te(e);if(e.avail_out===0){n.last_flush=-1;return g}}}if(t!==v){return g}if(n.wrap<=0){return m}if(n.wrap===2){ne(n,e.adler&255);ne(n,e.adler>>8&255);ne(n,e.adler>>16&255);ne(n,e.adler>>24&255);ne(n,e.total_in&255);ne(n,e.total_in>>8&255);ne(n,e.total_in>>16&255);ne(n,e.total_in>>24&255)}else{ie(n,e.adler>>>16);ie(n,e.adler&65535)}te(e);if(n.wrap>0){n.wrap=-n.wrap}return n.pending!==0?g:m}function Ee(e){var t;if(!e||!e.state){return y}t=e.state.status;if(t!==$&&t!==W&&t!==U&&t!==j&&t!==V&&t!==z&&t!==q){return Q(e,y)}e.state=null;return t===z?Q(e,i):g}r.deflateInit=Ce;r.deflateInit2=we;r.deflateReset=ye;r.deflateResetKeep=me;r.deflateSetHeader=be;r.deflate=Se;r.deflateEnd=Ee;r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t,r){"use strict";function n(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}t.exports=n},{}],34:[function(e,t,r){"use strict";var x=30;var D=12;t.exports=function e(t,r){var n;var e;var i;var a;var o;var s;var l;var u;var f;var c;var d;var h;var v;var p;var g;var m;var y;var b;var w;var C;var S;var E;var k;var T,_;n=t.state;e=t.next_in;T=t.input;i=e+(t.avail_in-5);a=t.next_out;_=t.output;o=a-(r-t.avail_out);s=a+(t.avail_out-257);l=n.dmax;u=n.wsize;f=n.whave;c=n.wnext;d=n.window;h=n.hold;v=n.bits;p=n.lencode;g=n.distcode;m=(1<<n.lenbits)-1;y=(1<<n.distbits)-1;e:do{if(v<15){h+=T[e++]<<v;v+=8;h+=T[e++]<<v;v+=8}b=p[h&m];t:for(;;){w=b>>>24;h>>>=w;v-=w;w=b>>>16&255;if(w===0){_[a++]=b&65535}else if(w&16){C=b&65535;w&=15;if(w){if(v<w){h+=T[e++]<<v;v+=8}C+=h&(1<<w)-1;h>>>=w;v-=w}if(v<15){h+=T[e++]<<v;v+=8;h+=T[e++]<<v;v+=8}b=g[h&y];r:for(;;){w=b>>>24;h>>>=w;v-=w;w=b>>>16&255;if(w&16){S=b&65535;w&=15;if(v<w){h+=T[e++]<<v;v+=8;if(v<w){h+=T[e++]<<v;v+=8}}S+=h&(1<<w)-1;if(S>l){t.msg="invalid distance too far back";n.mode=x;break e}h>>>=w;v-=w;w=a-o;if(S>w){w=S-w;if(w>f){if(n.sane){t.msg="invalid distance too far back";n.mode=x;break e}}E=0;k=d;if(c===0){E+=u-w;if(w<C){C-=w;do{_[a++]=d[E++]}while(--w);E=a-S;k=_}}else if(c<w){E+=u+c-w;w-=c;if(w<C){C-=w;do{_[a++]=d[E++]}while(--w);E=0;if(c<C){w=c;C-=w;do{_[a++]=d[E++]}while(--w);E=a-S;k=_}}}else{E+=c-w;if(w<C){C-=w;do{_[a++]=d[E++]}while(--w);E=a-S;k=_}}while(C>2){_[a++]=k[E++];_[a++]=k[E++];_[a++]=k[E++];C-=3}if(C){_[a++]=k[E++];if(C>1){_[a++]=k[E++]}}}else{E=a-S;do{_[a++]=_[E++];_[a++]=_[E++];_[a++]=_[E++];C-=3}while(C>2);if(C){_[a++]=_[E++];if(C>1){_[a++]=_[E++]}}}}else if((w&64)===0){b=g[(b&65535)+(h&(1<<w)-1)];continue r}else{t.msg="invalid distance code";n.mode=x;break e}break}}else if((w&64)===0){b=p[(b&65535)+(h&(1<<w)-1)];continue t}else if(w&32){n.mode=D;break e}else{t.msg="invalid literal/length code";n.mode=x;break e}break}}while(e<i&&a<s);C=v>>3;e-=C;v-=C<<3;h&=(1<<v)-1;t.next_in=e;t.next_out=a;t.avail_in=e<i?5+(i-e):5-(e-i);t.avail_out=a<s?257+(s-a):257-(a-s);n.hold=h;n.bits=v;return}},{}],35:[function(e,t,r){"use strict";var R=e("../utils/common");var I=e("./adler32");var O=e("./crc32");var A=e("./inffast");var N=e("./inftrees");var M=0;var L=1;var P=2;var F=4;var B=5;var H=6;var $=0;var W=1;var U=2;var j=-2;var V=-3;var z=-4;var q=-5;var Y=8;var G=1;var X=2;var K=3;var J=4;var Q=5;var Z=6;var ee=7;var te=8;var re=9;var ne=10;var ie=11;var ae=12;var oe=13;var se=14;var le=15;var ue=16;var fe=17;var ce=18;var de=19;var he=20;var ve=21;var pe=22;var ge=23;var me=24;var ye=25;var be=26;var we=27;var Ce=28;var Se=29;var Ee=30;var ke=31;var Te=32;var n=852;var i=592;var a=15;var o=a;function _e(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function s(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new R.Buf16(320);this.work=new R.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function l(e){var t;if(!e||!e.state){return j}t=e.state;e.total_in=e.total_out=t.total=0;e.msg="";if(t.wrap){e.adler=t.wrap&1}t.mode=G;t.last=0;t.havedict=0;t.dmax=32768;t.head=null;t.hold=0;t.bits=0;t.lencode=t.lendyn=new R.Buf32(n);t.distcode=t.distdyn=new R.Buf32(i);t.sane=1;t.back=-1;return $}function u(e){var t;if(!e||!e.state){return j}t=e.state;t.wsize=0;t.whave=0;t.wnext=0;return l(e)}function f(e,t){var r;var n;if(!e||!e.state){return j}n=e.state;if(t<0){r=0;t=-t}else{r=(t>>4)+1;if(t<48){t&=15}}if(t&&(t<8||t>15)){return j}if(n.window!==null&&n.wbits!==t){n.window=null}n.wrap=r;n.wbits=t;return u(e)}function c(e,t){var r;var n;if(!e){return j}n=new s;e.state=n;n.window=null;r=f(e,t);if(r!==$){e.state=null}return r}function d(e){return c(e,o)}var h=true;var v,p;function xe(e){if(h){var t;v=new R.Buf32(512);p=new R.Buf32(32);t=0;while(t<144){e.lens[t++]=8}while(t<256){e.lens[t++]=9}while(t<280){e.lens[t++]=7}while(t<288){e.lens[t++]=8}N(L,e.lens,0,288,v,0,e.work,{bits:9});t=0;while(t<32){e.lens[t++]=5}N(P,e.lens,0,32,p,0,e.work,{bits:5});h=false}e.lencode=v;e.lenbits=9;e.distcode=p;e.distbits=5}function De(e,t,r,n){var i;var a=e.state;if(a.window===null){a.wsize=1<<a.wbits;a.wnext=0;a.whave=0;a.window=new R.Buf8(a.wsize)}if(n>=a.wsize){R.arraySet(a.window,t,r-a.wsize,a.wsize,0);a.wnext=0;a.whave=a.wsize}else{i=a.wsize-a.wnext;if(i>n){i=n}R.arraySet(a.window,t,r-n,i,a.wnext);n-=i;if(n){R.arraySet(a.window,t,r-n,n,0);a.wnext=n;a.whave=a.wsize}else{a.wnext+=i;if(a.wnext===a.wsize){a.wnext=0}if(a.whave<a.wsize){a.whave+=i}}}return 0}function g(e,t){var r;var n,i;var a;var o;var s,l;var u;var f;var c,d;var h;var v;var p;var g=0;var m,y,b;var w,C,S;var E;var k;var T=new R.Buf8(4);var _;var x;var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0){return j}r=e.state;if(r.mode===ae){r.mode=oe}o=e.next_out;i=e.output;l=e.avail_out;a=e.next_in;n=e.input;s=e.avail_in;u=r.hold;f=r.bits;c=s;d=l;k=$;e:for(;;){switch(r.mode){case G:if(r.wrap===0){r.mode=oe;break}while(f<16){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(r.wrap&2&&u===35615){r.check=0;T[0]=u&255;T[1]=u>>>8&255;r.check=O(r.check,T,2,0);u=0;f=0;r.mode=X;break}r.flags=0;if(r.head){r.head.done=false}if(!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check";r.mode=Ee;break}if((u&15)!==Y){e.msg="unknown compression method";r.mode=Ee;break}u>>>=4;f-=4;E=(u&15)+8;if(r.wbits===0){r.wbits=E}else if(E>r.wbits){e.msg="invalid window size";r.mode=Ee;break}r.dmax=1<<E;e.adler=r.check=1;r.mode=u&512?ne:ae;u=0;f=0;break;case X:while(f<16){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.flags=u;if((r.flags&255)!==Y){e.msg="unknown compression method";r.mode=Ee;break}if(r.flags&57344){e.msg="unknown header flags set";r.mode=Ee;break}if(r.head){r.head.text=u>>8&1}if(r.flags&512){T[0]=u&255;T[1]=u>>>8&255;r.check=O(r.check,T,2,0)}u=0;f=0;r.mode=K;case K:while(f<32){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(r.head){r.head.time=u}if(r.flags&512){T[0]=u&255;T[1]=u>>>8&255;T[2]=u>>>16&255;T[3]=u>>>24&255;r.check=O(r.check,T,4,0)}u=0;f=0;r.mode=J;case J:while(f<16){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(r.head){r.head.xflags=u&255;r.head.os=u>>8}if(r.flags&512){T[0]=u&255;T[1]=u>>>8&255;r.check=O(r.check,T,2,0)}u=0;f=0;r.mode=Q;case Q:if(r.flags&1024){while(f<16){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.length=u;if(r.head){r.head.extra_len=u}if(r.flags&512){T[0]=u&255;T[1]=u>>>8&255;r.check=O(r.check,T,2,0)}u=0;f=0}else if(r.head){r.head.extra=null}r.mode=Z;case Z:if(r.flags&1024){h=r.length;if(h>s){h=s}if(h){if(r.head){E=r.head.extra_len-r.length;if(!r.head.extra){r.head.extra=new Array(r.head.extra_len)}R.arraySet(r.head.extra,n,a,h,E)}if(r.flags&512){r.check=O(r.check,n,h,a)}s-=h;a+=h;r.length-=h}if(r.length){break e}}r.length=0;r.mode=ee;case ee:if(r.flags&2048){if(s===0){break e}h=0;do{E=n[a+h++];if(r.head&&E&&r.length<65536){r.head.name+=String.fromCharCode(E)}}while(E&&h<s);if(r.flags&512){r.check=O(r.check,n,h,a)}s-=h;a+=h;if(E){break e}}else if(r.head){r.head.name=null}r.length=0;r.mode=te;case te:if(r.flags&4096){if(s===0){break e}h=0;do{E=n[a+h++];if(r.head&&E&&r.length<65536){r.head.comment+=String.fromCharCode(E)}}while(E&&h<s);if(r.flags&512){r.check=O(r.check,n,h,a)}s-=h;a+=h;if(E){break e}}else if(r.head){r.head.comment=null}r.mode=re;case re:if(r.flags&512){while(f<16){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(u!==(r.check&65535)){e.msg="header crc mismatch";r.mode=Ee;break}u=0;f=0}if(r.head){r.head.hcrc=r.flags>>9&1;r.head.done=true}e.adler=r.check=0;r.mode=ae;break;case ne:while(f<32){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}e.adler=r.check=_e(u);u=0;f=0;r.mode=ie;case ie:if(r.havedict===0){e.next_out=o;e.avail_out=l;e.next_in=a;e.avail_in=s;r.hold=u;r.bits=f;return U}e.adler=r.check=1;r.mode=ae;case ae:if(t===B||t===H){break e};case oe:if(r.last){u>>>=f&7;f-=f&7;r.mode=we;break}while(f<3){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.last=u&1;u>>>=1;f-=1;switch(u&3){case 0:r.mode=se;break;case 1:xe(r);r.mode=he;if(t===H){u>>>=2;f-=2;break e}break;case 2:r.mode=fe;break;case 3:e.msg="invalid block type";r.mode=Ee}u>>>=2;f-=2;break;case se:u>>>=f&7;f-=f&7;while(f<32){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths";r.mode=Ee;break}r.length=u&65535;u=0;f=0;r.mode=le;if(t===H){break e};case le:r.mode=ue;case ue:h=r.length;if(h){if(h>s){h=s}if(h>l){h=l}if(h===0){break e}R.arraySet(i,n,a,h,o);s-=h;a+=h;l-=h;o+=h;r.length-=h;break}r.mode=ae;break;case fe:while(f<14){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.nlen=(u&31)+257;u>>>=5;f-=5;r.ndist=(u&31)+1;u>>>=5;f-=5;r.ncode=(u&15)+4;u>>>=4;f-=4;if(r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols";r.mode=Ee;break}r.have=0;r.mode=ce;case ce:while(r.have<r.ncode){while(f<3){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.lens[D[r.have++]]=u&7;u>>>=3;f-=3}while(r.have<19){r.lens[D[r.have++]]=0}r.lencode=r.lendyn;r.lenbits=7;_={bits:r.lenbits};k=N(M,r.lens,0,19,r.lencode,0,r.work,_);r.lenbits=_.bits;if(k){e.msg="invalid code lengths set";r.mode=Ee;break}r.have=0;r.mode=de;case de:while(r.have<r.nlen+r.ndist){for(;;){g=r.lencode[u&(1<<r.lenbits)-1];m=g>>>24;y=g>>>16&255;b=g&65535;if(m<=f){break}if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(b<16){u>>>=m;f-=m;r.lens[r.have++]=b}else{if(b===16){x=m+2;while(f<x){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}u>>>=m;f-=m;if(r.have===0){e.msg="invalid bit length repeat";r.mode=Ee;break}E=r.lens[r.have-1];h=3+(u&3);u>>>=2;f-=2}else if(b===17){x=m+3;while(f<x){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}u>>>=m;f-=m;E=0;h=3+(u&7);u>>>=3;f-=3}else{x=m+7;while(f<x){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}u>>>=m;f-=m;E=0;h=11+(u&127);u>>>=7;f-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat";r.mode=Ee;break}while(h--){r.lens[r.have++]=E}}}if(r.mode===Ee){break}if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block";r.mode=Ee;break}r.lenbits=9;_={bits:r.lenbits};k=N(L,r.lens,0,r.nlen,r.lencode,0,r.work,_);r.lenbits=_.bits;if(k){e.msg="invalid literal/lengths set";r.mode=Ee;break}r.distbits=6;r.distcode=r.distdyn;_={bits:r.distbits};k=N(P,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,_);r.distbits=_.bits;if(k){e.msg="invalid distances set";r.mode=Ee;break}r.mode=he;if(t===H){break e};case he:r.mode=ve;case ve:if(s>=6&&l>=258){e.next_out=o;e.avail_out=l;e.next_in=a;e.avail_in=s;r.hold=u;r.bits=f;A(e,d);o=e.next_out;i=e.output;l=e.avail_out;a=e.next_in;n=e.input;s=e.avail_in;u=r.hold;f=r.bits;if(r.mode===ae){r.back=-1}break}r.back=0;for(;;){g=r.lencode[u&(1<<r.lenbits)-1];m=g>>>24;y=g>>>16&255;b=g&65535;if(m<=f){break}if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(y&&(y&240)===0){w=m;C=y;S=b;for(;;){g=r.lencode[S+((u&(1<<w+C)-1)>>w)];m=g>>>24;y=g>>>16&255;b=g&65535;if(w+m<=f){break}if(s===0){break e}s--;u+=n[a++]<<f;f+=8}u>>>=w;f-=w;r.back+=w}u>>>=m;f-=m;r.back+=m;r.length=b;if(y===0){r.mode=be;break}if(y&32){r.back=-1;r.mode=ae;break}if(y&64){e.msg="invalid literal/length code";r.mode=Ee;break}r.extra=y&15;r.mode=pe;case pe:if(r.extra){x=r.extra;while(f<x){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.length+=u&(1<<r.extra)-1;u>>>=r.extra;f-=r.extra;r.back+=r.extra}r.was=r.length;r.mode=ge;case ge:for(;;){g=r.distcode[u&(1<<r.distbits)-1];m=g>>>24;y=g>>>16&255;b=g&65535;if(m<=f){break}if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if((y&240)===0){w=m;C=y;S=b;for(;;){g=r.distcode[S+((u&(1<<w+C)-1)>>w)];m=g>>>24;y=g>>>16&255;b=g&65535;if(w+m<=f){break}if(s===0){break e}s--;u+=n[a++]<<f;f+=8}u>>>=w;f-=w;r.back+=w}u>>>=m;f-=m;r.back+=m;if(y&64){e.msg="invalid distance code";r.mode=Ee;break}r.offset=b;r.extra=y&15;r.mode=me;case me:if(r.extra){x=r.extra;while(f<x){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}r.offset+=u&(1<<r.extra)-1;u>>>=r.extra;f-=r.extra;r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back";r.mode=Ee;break}r.mode=ye;case ye:if(l===0){break e}h=d-l;if(r.offset>h){h=r.offset-h;if(h>r.whave){if(r.sane){e.msg="invalid distance too far back";r.mode=Ee;break}}if(h>r.wnext){h-=r.wnext;v=r.wsize-h}else{v=r.wnext-h}if(h>r.length){h=r.length}p=r.window}else{p=i;v=o-r.offset;h=r.length}if(h>l){h=l}l-=h;r.length-=h;do{i[o++]=p[v++]}while(--h);if(r.length===0){r.mode=ve}break;case be:if(l===0){break e}i[o++]=r.length;l--;r.mode=ve;break;case we:if(r.wrap){while(f<32){if(s===0){break e}s--;u|=n[a++]<<f;f+=8}d-=l;e.total_out+=d;r.total+=d;if(d){e.adler=r.check=r.flags?O(r.check,i,d,o-d):I(r.check,i,d,o-d)}d=l;if((r.flags?u:_e(u))!==r.check){e.msg="incorrect data check";r.mode=Ee;break}u=0;f=0}r.mode=Ce;case Ce:if(r.wrap&&r.flags){while(f<32){if(s===0){break e}s--;u+=n[a++]<<f;f+=8}if(u!==(r.total&4294967295)){e.msg="incorrect length check";r.mode=Ee;break}u=0;f=0}r.mode=Se;case Se:k=W;break e;case Ee:k=V;break e;case ke:return z;case Te:;default:return j}}e.next_out=o;e.avail_out=l;e.next_in=a;e.avail_in=s;r.hold=u;r.bits=f;if(r.wsize||d!==e.avail_out&&r.mode<Ee&&(r.mode<we||t!==F)){if(De(e,e.output,e.next_out,d-e.avail_out)){r.mode=ke;return z}}c-=e.avail_in;d-=e.avail_out;e.total_in+=c;e.total_out+=d;r.total+=d;if(r.wrap&&d){e.adler=r.check=r.flags?O(r.check,i,d,e.next_out-d):I(r.check,i,d,e.next_out-d)}e.data_type=r.bits+(r.last?64:0)+(r.mode===ae?128:0)+(r.mode===he||r.mode===le?256:0);if((c===0&&d===0||t===F)&&k===$){k=q}return k}function m(e){if(!e||!e.state){return j}var t=e.state;if(t.window){t.window=null}e.state=null;return $}function y(e,t){var r;if(!e||!e.state){return j}r=e.state;if((r.wrap&2)===0){return j}r.head=t;t.done=false;return $}r.inflateReset=u;r.inflateReset2=f;r.inflateResetKeep=l;r.inflateInit=d;r.inflateInit2=c;r.inflate=g;r.inflateEnd=m;r.inflateGetHeader=y;r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t,r){"use strict";var P=e("../utils/common");var F=15;var B=852;var H=592;var $=0;var W=1;var U=2;var j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var V=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var q=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function e(t,r,n,i,a,o,s,l){var u=l.bits;var f=0;var c=0;var d=0,h=0;var v=0;var p=0;var g=0;var m=0;var y=0;var b=0;var w;var C;var S;var E;var k;var T=null;var _=0;var x;var D=new P.Buf16(F+1);var R=new P.Buf16(F+1);var I=null;var O=0;var A,N,M;for(f=0;f<=F;f++){D[f]=0}for(c=0;c<i;c++){D[r[n+c]]++}v=u;for(h=F;h>=1;h--){if(D[h]!==0){break}}if(v>h){v=h}if(h===0){a[o++]=1<<24|64<<16|0;a[o++]=1<<24|64<<16|0;l.bits=1;return 0}for(d=1;d<h;d++){if(D[d]!==0){break}}if(v<d){v=d}m=1;for(f=1;f<=F;f++){m<<=1;m-=D[f];if(m<0){return-1}}if(m>0&&(t===$||h!==1)){return-1}R[1]=0;for(f=1;f<F;f++){R[f+1]=R[f]+D[f]}for(c=0;c<i;c++){if(r[n+c]!==0){s[R[r[n+c]]++]=c}}if(t===$){T=I=s;x=19}else if(t===W){T=j;_-=257;I=V;O-=257;x=256}else{T=z;I=q;x=-1}b=0;c=0;f=d;k=o;p=v;g=0;S=-1;y=1<<v;E=y-1;if(t===W&&y>B||t===U&&y>H){return 1}var L=0;for(;;){L++;A=f-g;if(s[c]<x){N=0;M=s[c]}else if(s[c]>x){N=I[O+s[c]];M=T[_+s[c]]}else{N=32+64;M=0}w=1<<f-g;C=1<<p;d=C;do{C-=w;a[k+(b>>g)+C]=A<<24|N<<16|M|0}while(C!==0);w=1<<f-1;while(b&w){w>>=1}if(w!==0){b&=w-1;b+=w}else{b=0}c++;if(--D[f]===0){if(f===h){break}f=r[n+s[c]]}if(f>v&&(b&E)!==S){if(g===0){g=v}k+=d;p=f-g;m=1<<p;while(p+g<h){m-=D[p+g];if(m<=0){break}p++;m<<=1}y+=1<<p;if(t===W&&y>B||t===U&&y>H){return 1}S=b&E;a[S]=v<<24|p<<16|k-o|0}}if(b!==0){a[k+b]=f-g<<24|64<<16|0}l.bits=v;return 0}},{"../utils/common":27}],37:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,t,r){"use strict";var i=e("../utils/common");var s=4;var n=0;var a=1;var l=2;function o(e){var t=e.length;while(--t>=0){e[t]=0}}var u=0;var f=1;var c=2;var d=3;var h=258;var v=29;var p=256;var g=p+1+v;var m=30;var y=19;var b=2*g+1;var w=15;var C=16;var S=7;var E=256;var k=16;var T=17;var _=18;var x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var D=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var O=512;var A=new Array((g+2)*2);o(A);var N=new Array(m*2);o(N);var M=new Array(O);o(M);var L=new Array(h-d+1);o(L);var P=new Array(v);o(P);var F=new Array(m);o(F);var B=function(e,t,r,n,i){this.static_tree=e;this.extra_bits=t;this.extra_base=r;this.elems=n;this.max_length=i;this.has_stree=e&&e.length};var H;var $;var W;var U=function(e,t){this.dyn_tree=e;this.max_code=0;this.stat_desc=t};function j(e){return e<256?M[e]:M[256+(e>>>7)]}function V(e,t){e.pending_buf[e.pending++]=t&255;e.pending_buf[e.pending++]=t>>>8&255}function z(e,t,r){if(e.bi_valid>C-r){e.bi_buf|=t<<e.bi_valid&65535;V(e,e.bi_buf);e.bi_buf=t>>C-e.bi_valid;e.bi_valid+=r-C}else{e.bi_buf|=t<<e.bi_valid&65535;e.bi_valid+=r}}function q(e,t,r){z(e,r[t*2],r[t*2+1])}function Y(e,t){var r=0;do{r|=e&1;e>>>=1;r<<=1}while(--t>0);return r>>>1}function G(e){if(e.bi_valid===16){V(e,e.bi_buf);e.bi_buf=0;e.bi_valid=0}else if(e.bi_valid>=8){e.pending_buf[e.pending++]=e.bi_buf&255;e.bi_buf>>=8;e.bi_valid-=8}}function X(e,t){var r=t.dyn_tree;var n=t.max_code;var i=t.stat_desc.static_tree;var a=t.stat_desc.has_stree;var o=t.stat_desc.extra_bits;var s=t.stat_desc.extra_base;var l=t.stat_desc.max_length;var u;var f,c;var d;var h;var v;var p=0;for(d=0;d<=w;d++){e.bl_count[d]=0}r[e.heap[e.heap_max]*2+1]=0;for(u=e.heap_max+1;u<b;u++){f=e.heap[u];d=r[r[f*2+1]*2+1]+1;if(d>l){d=l;p++}r[f*2+1]=d;if(f>n){continue}e.bl_count[d]++;h=0;if(f>=s){h=o[f-s]}v=r[f*2];e.opt_len+=v*(d+h);if(a){e.static_len+=v*(i[f*2+1]+h)}}if(p===0){return}do{d=l-1;while(e.bl_count[d]===0){d--}e.bl_count[d]--;e.bl_count[d+1]+=2;e.bl_count[l]--;p-=2}while(p>0);for(d=l;d!==0;d--){f=e.bl_count[d];while(f!==0){c=e.heap[--u];if(c>n){continue}if(r[c*2+1]!==d){e.opt_len+=(d-r[c*2+1])*r[c*2];r[c*2+1]=d}f--}}}function K(e,t,r){var n=new Array(w+1);var i=0;var a;var o;for(a=1;a<=w;a++){n[a]=i=i+r[a-1]<<1}for(o=0;o<=t;o++){var s=e[o*2+1];if(s===0){continue}e[o*2]=Y(n[s]++,s)}}function J(){var e;var t;var r;var n;var i;var a=new Array(w+1);r=0;for(n=0;n<v-1;n++){P[n]=r;for(e=0;e<1<<x[n];e++){L[r++]=n}}L[r-1]=n;i=0;for(n=0;n<16;n++){F[n]=i;for(e=0;e<1<<D[n];e++){M[i++]=n}}i>>=7;for(;n<m;n++){F[n]=i<<7;for(e=0;e<1<<D[n]-7;e++){M[256+i++]=n}}for(t=0;t<=w;t++){a[t]=0}e=0;while(e<=143){A[e*2+1]=8;e++;a[8]++}while(e<=255){A[e*2+1]=9;e++;a[9]++}while(e<=279){A[e*2+1]=7;e++;a[7]++}while(e<=287){A[e*2+1]=8;e++;a[8]++}K(A,g+1,a);for(e=0;e<m;e++){N[e*2+1]=5;N[e*2]=Y(e,5)}H=new B(A,x,p+1,g,w);$=new B(N,D,0,m,w);W=new B(new Array(0),R,0,y,S)}function Q(e){var t;for(t=0;t<g;t++){e.dyn_ltree[t*2]=0}for(t=0;t<m;t++){e.dyn_dtree[t*2]=0}for(t=0;t<y;t++){e.bl_tree[t*2]=0}e.dyn_ltree[E*2]=1;e.opt_len=e.static_len=0;e.last_lit=e.matches=0}function Z(e){if(e.bi_valid>8){V(e,e.bi_buf)}else if(e.bi_valid>0){e.pending_buf[e.pending++]=e.bi_buf}e.bi_buf=0;e.bi_valid=0}function ee(e,t,r,n){Z(e);if(n){V(e,r);V(e,~r)}i.arraySet(e.pending_buf,e.window,t,r,e.pending);e.pending+=r}function te(e,t,r,n){var i=t*2;var a=r*2;return e[i]<e[a]||e[i]===e[a]&&n[t]<=n[r]}function re(e,t,r){var n=e.heap[r];var i=r<<1;while(i<=e.heap_len){if(i<e.heap_len&&te(t,e.heap[i+1],e.heap[i],e.depth)){i++}if(te(t,n,e.heap[i],e.depth)){break}e.heap[r]=e.heap[i];r=i;i<<=1}e.heap[r]=n}function ne(e,t,r){var n;var i;var a=0;var o;var s;if(e.last_lit!==0){do{n=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1];i=e.pending_buf[e.l_buf+a];a++;if(n===0){q(e,i,t)}else{o=L[i];q(e,o+p+1,t);s=x[o];if(s!==0){i-=P[o];z(e,i,s)}n--;o=j(n);q(e,o,r);s=D[o];if(s!==0){n-=F[o];z(e,n,s)}}}while(a<e.last_lit)}q(e,E,t)}function ie(e,t){var r=t.dyn_tree;var n=t.stat_desc.static_tree;var i=t.stat_desc.has_stree;var a=t.stat_desc.elems;var o,s;var l=-1;var u;e.heap_len=0;e.heap_max=b;for(o=0;o<a;o++){if(r[o*2]!==0){e.heap[++e.heap_len]=l=o;e.depth[o]=0}else{r[o*2+1]=0}}while(e.heap_len<2){u=e.heap[++e.heap_len]=l<2?++l:0;r[u*2]=1;e.depth[u]=0;e.opt_len--;if(i){e.static_len-=n[u*2+1]}}t.max_code=l;for(o=e.heap_len>>1;o>=1;o--){re(e,r,o)}u=a;do{o=e.heap[1];e.heap[1]=e.heap[e.heap_len--];re(e,r,1);s=e.heap[1];e.heap[--e.heap_max]=o;e.heap[--e.heap_max]=s;r[u*2]=r[o*2]+r[s*2];e.depth[u]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1;r[o*2+1]=r[s*2+1]=u;e.heap[1]=u++;re(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1];X(e,t);K(r,l,e.bl_count)}function ae(e,t,r){var n;var i=-1;var a;var o=t[0*2+1];var s=0;var l=7;var u=4;if(o===0){l=138;u=3}t[(r+1)*2+1]=65535;for(n=0;n<=r;n++){a=o;o=t[(n+1)*2+1];if(++s<l&&a===o){continue}else if(s<u){e.bl_tree[a*2]+=s}else if(a!==0){if(a!==i){e.bl_tree[a*2]++}e.bl_tree[k*2]++}else if(s<=10){e.bl_tree[T*2]++}else{e.bl_tree[_*2]++}s=0;i=a;if(o===0){l=138;u=3}else if(a===o){l=6;u=3}else{l=7;u=4}}}function oe(e,t,r){var n;var i=-1;var a;var o=t[0*2+1];var s=0;var l=7;var u=4;if(o===0){l=138;u=3}for(n=0;n<=r;n++){a=o;o=t[(n+1)*2+1];if(++s<l&&a===o){continue}else if(s<u){do{q(e,a,e.bl_tree)}while(--s!==0)}else if(a!==0){if(a!==i){q(e,a,e.bl_tree);s--}q(e,k,e.bl_tree);z(e,s-3,2)}else if(s<=10){q(e,T,e.bl_tree);z(e,s-3,3)}else{q(e,_,e.bl_tree);z(e,s-11,7)}s=0;i=a;if(o===0){l=138;u=3}else if(a===o){l=6;u=3}else{l=7;u=4}}}function se(e){var t;ae(e,e.dyn_ltree,e.l_desc.max_code);ae(e,e.dyn_dtree,e.d_desc.max_code);ie(e,e.bl_desc);for(t=y-1;t>=3;t--){if(e.bl_tree[I[t]*2+1]!==0){break}}e.opt_len+=3*(t+1)+5+5+4;return t}function le(e,t,r,n){var i;z(e,t-257,5);z(e,r-1,5);z(e,n-4,4);for(i=0;i<n;i++){z(e,e.bl_tree[I[i]*2+1],3)}oe(e,e.dyn_ltree,t-1);oe(e,e.dyn_dtree,r-1)}function ue(e){var t=4093624447;var r;for(r=0;r<=31;r++,t>>>=1){if(t&1&&e.dyn_ltree[r*2]!==0){return n}}if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0){return a}for(r=32;r<p;r++){if(e.dyn_ltree[r*2]!==0){return a}}return n}var fe=false;function ce(e){if(!fe){J();fe=true}e.l_desc=new U(e.dyn_ltree,H);e.d_desc=new U(e.dyn_dtree,$);e.bl_desc=new U(e.bl_tree,W);e.bi_buf=0;e.bi_valid=0;Q(e)}function de(e,t,r,n){z(e,(u<<1)+(n?1:0),3);ee(e,t,r,true)}function he(e){z(e,f<<1,3);q(e,E,A);G(e)}function ve(e,t,r,n){var i,a;var o=0;if(e.level>0){if(e.strm.data_type===l){e.strm.data_type=ue(e)}ie(e,e.l_desc);ie(e,e.d_desc);o=se(e);i=e.opt_len+3+7>>>3;a=e.static_len+3+7>>>3;if(a<=i){i=a}}else{i=a=r+5}if(r+4<=i&&t!==-1){de(e,t,r,n)}else if(e.strategy===s||a===i){z(e,(f<<1)+(n?1:0),3);ne(e,A,N)}else{z(e,(c<<1)+(n?1:0),3);le(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1);ne(e,e.dyn_ltree,e.dyn_dtree)}Q(e);if(n){Z(e)}}function pe(e,t,r){e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255;e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255;e.pending_buf[e.l_buf+e.last_lit]=r&255;e.last_lit++;if(t===0){e.dyn_ltree[r*2]++}else{e.matches++;t--;e.dyn_ltree[(L[r]+p+1)*2]++;e.dyn_dtree[j(t)*2]++}return e.last_lit===e.lit_bufsize-1}r._tr_init=ce;r._tr_stored_block=de;r._tr_flush_block=ve;r._tr_tally=pe;r._tr_align=he},{"../utils/common":27}],39:[function(e,t,r){"use strict";function n(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}t.exports=n},{}]},{},[9])(9)});var XLSX={};function make_xlsx_lib(n){n.version="0.16.8";var d=1200,k=1252;if(typeof module!=="undefined"&&typeof require!=="undefined"){if(typeof cptable==="undefined"){if(typeof global!=="undefined")global.cptable=undefined;else if(typeof window!=="undefined")window.cptable=undefined}}var t=[874,932,936,949,950];for(var e=0;e<=8;++e)t.push(1250+e);var l={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969};var u=function(e){if(t.indexOf(e)==-1)return;k=l[0]=e};function r(){u(1252)}var pe=function(e){d=e;u(e)};function f(){pe(1200);r()}function ee(e){var t=[];for(var r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function i(e){var t=[];for(var r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function a(e){var t=[];for(var r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var te=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);if(t==255&&r==254)return i(e.slice(2));if(t==254&&r==255)return a(e.slice(2));if(t==65279)return e.slice(1);return e};var c=function e(t){return String.fromCharCode(t)};var s=function e(t){return String.fromCharCode(t)};if(typeof cptable!=="undefined"){pe=function(e){d=e;u(e)};te=function(e){if(e.charCodeAt(0)===255&&e.charCodeAt(1)===254){return cptable.utils.decode(1200,ee(e.slice(2)))}return e};c=function e(t){if(d===1200)return String.fromCharCode(t);return cptable.utils.decode(d,[t&255,t>>8])[0]};s=function e(t){return cptable.utils.decode(k,[t])[0]}}var ge=null;var h=true;var Te=function e(){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(e){var t="";var r=0,n=0,i=0,a=0,o=0,s=0,l=0;for(var u=0;u<e.length;){r=e.charCodeAt(u++);a=r>>2;n=e.charCodeAt(u++);o=(r&3)<<4|n>>4;i=e.charCodeAt(u++);s=(n&15)<<2|i>>6;l=i&63;if(isNaN(n)){s=l=64}else if(isNaN(i)){l=64}t+=c.charAt(a)+c.charAt(o)+c.charAt(s)+c.charAt(l)}return t},decode:function e(t){var r="";var n=0,i=0,a=0,o=0,s=0,l=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;){o=c.indexOf(t.charAt(f++));s=c.indexOf(t.charAt(f++));n=o<<2|s>>4;r+=String.fromCharCode(n);l=c.indexOf(t.charAt(f++));i=(s&15)<<4|l>>2;if(l!==64){r+=String.fromCharCode(i)}u=c.indexOf(t.charAt(f++));a=(l&3)<<6|u;if(u!==64){r+=String.fromCharCode(a)}}return r}}}();var _e=typeof Buffer!=="undefined"&&typeof process!=="undefined"&&typeof process.versions!=="undefined"&&!!process.versions.node;var o=function(){};if(typeof Buffer!=="undefined"){var v=!Buffer.from;if(!v)try{Buffer.from("foo","utf8")}catch(e){v=true}o=v?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer);if(!Buffer.alloc)Buffer.alloc=function(e){return new Buffer(e)};if(!Buffer.allocUnsafe)Buffer.allocUnsafe=function(e){return new Buffer(e)}}function xe(e){return _e?Buffer.alloc(e):new Array(e)}function De(e){return _e?Buffer.allocUnsafe(e):new Array(e)}var Re=function e(t){if(_e)return o(t,"binary");return t.split("").map(function(e){return e.charCodeAt(0)&255})};function p(e){if(typeof ArrayBuffer==="undefined")return Re(e);var t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(var n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function g(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");var t=[];for(var r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function m(e){if(typeof Uint8Array==="undefined")throw new Error("Unsupported");return new Uint8Array(e)}function y(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return y(new Uint8Array(e));var t=new Array(e.length);for(var r=0;r<e.length;++r)t[r]=e[r];return t}var Ie=function(e){return[].concat.apply([],e)};var Oe=/\u0000/g,Ae=/[\u0001-\u0006]/g;var me={};var re=function e(t){t.version="0.11.2";function N(e){var t="",r=e.length-1;while(r>=0)t+=e.charAt(r--);return t}function M(e,t){var r="";while(r.length<t)r+=e;return r}function L(e,t){var r=""+e;return r.length>=t?r:M("0",t-r.length)+r}function P(e,t){var r=""+e;return r.length>=t?r:M(" ",t-r.length)+r}function F(e,t){var r=""+e;return r.length>=t?r:r+M(" ",t-r.length)}function n(e,t){var r=""+Math.round(e);return r.length>=t?r:M("0",t-r.length)+r}function i(e,t){var r=""+e;return r.length>=t?r:M("0",t-r.length)+r}var a=Math.pow(2,32);function B(e,t){if(e>a||e<-a)return n(e,t);var r=Math.round(e);return i(r,t)}function x(e,t){t=t||0;return e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var c=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];var d=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function r(e){e[0]="General";e[1]="0";e[2]="0.00";e[3]="#,##0";e[4]="#,##0.00";e[9]="0%";e[10]="0.00%";e[11]="0.00E+00";e[12]="# ?/?";e[13]="# ??/??";e[14]="m/d/yy";e[15]="d-mmm-yy";e[16]="d-mmm";e[17]="mmm-yy";e[18]="h:mm AM/PM";e[19]="h:mm:ss AM/PM";e[20]="h:mm";e[21]="h:mm:ss";e[22]="m/d/yy h:mm";e[37]="#,##0 ;(#,##0)";e[38]="#,##0 ;[Red](#,##0)";e[39]="#,##0.00;(#,##0.00)";e[40]="#,##0.00;[Red](#,##0.00)";e[45]="mm:ss";e[46]="[h]:mm:ss";e[47]="mmss.0";e[48]="##0.0E+0";e[49]="@";e[56]='"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "'}var o={};r(o);var s=[];var l=0;for(l=5;l<=8;++l)s[l]=32+l;for(l=23;l<=26;++l)s[l]=0;for(l=27;l<=31;++l)s[l]=14;for(l=50;l<=58;++l)s[l]=14;for(l=59;l<=62;++l)s[l]=l-58;for(l=67;l<=68;++l)s[l]=l-58;for(l=72;l<=75;++l)s[l]=l-58;for(l=67;l<=68;++l)s[l]=l-57;for(l=76;l<=78;++l)s[l]=l-56;for(l=79;l<=81;++l)s[l]=l-34;var u=[];u[5]=u[63]='"$"#,##0_);\\("$"#,##0\\)';u[6]=u[64]='"$"#,##0_);[Red]\\("$"#,##0\\)';u[7]=u[65]='"$"#,##0.00_);\\("$"#,##0.00\\)';u[8]=u[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)';u[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)';u[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)';u[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)';u[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function H(e,t,r){var n=e<0?-1:1;var i=e*n;var a=0,o=1,s=0;var l=1,u=0,f=0;var c=Math.floor(i);while(u<t){c=Math.floor(i);s=c*o+a;f=c*u+l;if(i-c<5e-8)break;i=1/(i-c);a=o;o=s;l=u;u=f}if(f>t){if(u>t){f=l;s=a}else{f=u;s=o}}if(!r)return[0,n*s,f];var d=Math.floor(n*s/f);return[d,n*s-d*f,f]}function D(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0;var o=[];var s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6)s.u=0;if(t&&t.date1904)n+=1462;if(s.u>.9999){s.u=0;if(++i==86400){s.T=i=0;++n;++s.D}}if(n===60){o=r?[1317,10,29]:[1900,2,29];a=3}else if(n===0){o=r?[1317,8,29]:[1900,1,0];a=6}else{if(n>60)--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1);o=[l.getFullYear(),l.getMonth()+1,l.getDate()];a=l.getDay();if(n<60)a=(a+6)%7;if(r)a=y(l,o)}s.y=o[0];s.m=o[1];s.d=o[2];s.S=i%60;i=Math.floor(i/60);s.M=i%60;i=Math.floor(i/60);s.H=i;s.q=a;return s}t.parse_date_code=D;var f=new Date(1899,11,31,0,0,0);var h=f.getTime();var v=new Date(1900,2,1,0,0,0);function p(e,t){var r=e.getTime();if(t)r-=1461*24*60*60*1e3;else if(e>=v)r+=24*60*60*1e3;return(r-(h+(e.getTimezoneOffset()-f.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function g(e){return e.toString(10)}t._general_int=g;var m=function e(){var t=/(?:\.0*|(\.\d*[1-9])0+)$/;function n(e){return e.indexOf(".")==-1?e:e.replace(t,"$1")}var r=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/;var i=/(E[+-])(\d)$/;function a(e){if(e.indexOf("E")==-1)return e;return e.replace(r,"$1E").replace(i,"$10$2")}function o(e){var t=e<0?12:11;var r=n(e.toFixed(12));if(r.length<=t)return r;r=e.toPrecision(10);if(r.length<=t)return r;return e.toExponential(5)}function s(e){var t=n(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function l(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;if(t>=-4&&t<=-1)r=e.toPrecision(10+t);else if(Math.abs(t)<=9)r=o(e);else if(t===10)r=e.toFixed(10).substr(0,12);else r=s(e);return n(a(r.toUpperCase()))}return l}();t._general_num=m;function R(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):m(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return T(14,p(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}t._general=R;function y(e,t){t[0]-=581;var r=e.getDay();if(e<60)r=(r+6)%7;return r}function I(e,t,r,n){var i="",a=0,o=0,s=r.y,l,u=0;switch(e){case 98:s=r.y+543;case 121:switch(t.length){case 1:;case 2:l=s%100;u=2;break;default:l=s%1e4;u=4;break}break;case 109:switch(t.length){case 1:;case 2:l=r.m;u=t.length;break;case 3:return d[r.m-1][1];case 5:return d[r.m-1][0];default:return d[r.m-1][2]}break;case 100:switch(t.length){case 1:;case 2:l=r.d;u=t.length;break;case 3:return c[r.q][0];default:return c[r.q][1]}break;case 104:switch(t.length){case 1:;case 2:l=1+(r.H+11)%12;u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:;case 2:l=r.H;u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:;case 2:l=r.M;u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;if(r.u===0&&(t=="s"||t=="ss"))return L(r.S,t.length);if(n>=2)o=n===3?1e3:100;else o=n===1?10:1;a=Math.round(o*(r.S+r.u));if(a>=60*o)a=0;if(t==="s")return a===0?"0":""+a/o;i=L(a,2+n);if(t==="ss")return i.substr(0,2);return"."+i.substr(2,t.length-1);case 90:switch(t){case"[h]":;case"[hh]":l=r.D*24+r.H;break;case"[m]":;case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":;case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=s;u=1;break}var f=u>0?L(l,u):"";return f}function $(e){var t=3;if(e.length<=t)return e;var r=e.length%t,n=e.substr(0,r);for(;r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var W=function e(){var a=/%/g;function v(e,t,r){var n=t.replace(a,""),i=t.length-n.length;return W(e,n,r*Math.pow(10,2*i))+M("%",i)}function p(e,t,r){var n=t.length-1;while(t.charCodeAt(n-1)===44)--n;return W(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function g(e,t){var r;var n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";else if(t<0)return"-"+g(e,-t);var i=e.indexOf(".");if(i===-1)i=e.indexOf("E");var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0)a+=i;r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i);if(r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);if(r.indexOf(".")===-1)r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a);else r+="E+"+(o-a);while(r.substr(0,2)==="0."){r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i);r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.")}r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(i+a)%i)+"."+n.substr(a)+"E"})}else r=t.toExponential(n);if(e.match(/E\+00$/)&&r.match(/e[+-]\d$/))r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1);if(e.match(/E\-/)&&r.match(/e\+/))r=r.replace(/e\+/,"e");return r.replace("e","E")}var m=/# (\?+)( ?)\/( ?)(\d+)/;function y(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n);var o=i-a*n,s=n;return r+(a===0?"":""+a)+" "+(o===0?M(" ",e[1].length+1+e[4].length):P(o,e[1].length)+e[2]+"/"+e[3]+L(s,e[4].length))}function b(e,t,r){return r+(t===0?"":""+t)+M(" ",e[1].length+2+e[4].length)}var w=/^#*0*\.([0#]+)/;var C=/\).*[0#]/;var S=/\(###\) ###\\?-####/;function E(e){var t="",r;for(var n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function k(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function T(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);if(t<(""+Math.round(r*n)).length)return 0;return Math.round(r*n)}function _(e,t){if(t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length){return 1}return 0}function x(e){if(e<2147483647&&e>-2147483648)return""+(e>=0?e|0:e-1|0);return""+Math.floor(e)}function D(e,t,r){if(e.charCodeAt(0)===40&&!t.match(C)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(r>=0)return D("n",n,r);return"("+D("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return p(e,t,r);if(t.indexOf("%")!==-1)return v(e,t,r);if(t.indexOf("E")!==-1)return g(t,r);if(t.charCodeAt(0)===36)return"$"+D(e,t.substr(t.charAt(1)==" "?2:1),r);var i;var a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+B(l,t.length);if(t.match(/^[#?]+$/)){i=B(r,0);if(i==="0")i="";return i.length>t.length?i:E(t.substr(0,t.length-i.length))+i}if(a=t.match(m))return y(a,l,u);if(t.match(/^#+0+$/))return u+B(l,t.length-t.indexOf("0"));if(a=t.match(w)){i=k(r,a[1].length).replace(/^([^\.]+)$/,"$1."+E(a[1])).replace(/\.$/,"."+E(a[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+M("0",E(a[1]).length-t.length)});return t.indexOf("0.")!==-1?i:i.replace(/^0\./,".")}t=t.replace(/^#+([0.])/,"$1");if(a=t.match(/^(0*)\.(#*)$/)){return u+k(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".")}if(a=t.match(/^#{1,3},##0(\.?)$/))return u+$(B(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/)){return r<0?"-"+D(e,t,-r):$(""+(Math.floor(r)+_(r,a[1].length)))+"."+L(T(r,a[1].length),a[1].length)}if(a=t.match(/^#,#*,#0/))return D(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/)){i=N(D(e,t.replace(/[\\-]/g,""),r));o=0;return N(N(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return o<i.length?i.charAt(o++):e==="0"?"0":""}))}if(t.match(S)){i=D(e,"##########",r);return"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6)}var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){o=Math.min(a[4].length,7);s=H(l,Math.pow(10,o)-1,false);i=""+u;f=W("n",a[1],s[1]);if(f.charAt(f.length-1)==" ")f=f.substr(0,f.length-1)+"0";i+=f+a[2]+"/"+a[3];f=F(s[2],o);if(f.length<a[4].length)f=E(a[4].substr(a[4].length-f.length))+f;i+=f;return i}if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){o=Math.min(Math.max(a[1].length,a[4].length),7);s=H(l,Math.pow(10,o)-1,true);return u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?P(s[1],o)+a[2]+"/"+a[3]+F(s[2],o):M(" ",2*o+1+a[2].length+a[3].length))}if(a=t.match(/^[#0?]+$/)){i=B(r,0);if(t.length<=i.length)return i;return E(t.substr(0,t.length-i.length))+i}if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1");o=i.indexOf(".");var c=t.indexOf(".")-o,d=t.length-i.length-c;return E(t.substr(0,c)+i+t.substr(t.length-d))}if(a=t.match(/^00,000\.([#0]*0)$/)){o=T(r,a[1].length);return r<0?"-"+D(e,t,-r):$(x(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?L(0,3-e.length):"")+e})+"."+L(o,a[1].length)}switch(t){case"###,##0.00":return D(e,"#,##0.00",r);case"###,###":;case"##,###":;case"#,###":var h=$(B(l,0));return h!=="0"?u+h:"";case"###,###.00":return D(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return D(e,"#,##0.00",r).replace(/^0\./,".");default:;}throw new Error("unsupported format |"+t+"|")}function R(e,t,r){var n=t.length-1;while(t.charCodeAt(n-1)===44)--n;return W(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function I(e,t,r){var n=t.replace(a,""),i=t.length-n.length;return W(e,n,r*Math.pow(10,2*i))+M("%",i)}function O(e,t){var r;var n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";else if(t<0)return"-"+O(e,-t);var i=e.indexOf(".");if(i===-1)i=e.indexOf("E");var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0)a+=i;r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i);if(!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);if(r.indexOf(".")===-1)r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a);else r+="E+"+(o-a);r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(i+a)%i)+"."+n.substr(a)+"E"})}else r=t.toExponential(n);if(e.match(/E\+00$/)&&r.match(/e[+-]\d$/))r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1);if(e.match(/E\-/)&&r.match(/e\+/))r=r.replace(/e\+/,"e");return r.replace("e","E")}function A(e,t,r){if(e.charCodeAt(0)===40&&!t.match(C)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(r>=0)return A("n",n,r);return"("+A("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return R(e,t,r);if(t.indexOf("%")!==-1)return I(e,t,r);if(t.indexOf("E")!==-1)return O(t,r);if(t.charCodeAt(0)===36)return"$"+A(e,t.substr(t.charAt(1)==" "?2:1),r);var i;var a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+L(l,t.length);if(t.match(/^[#?]+$/)){i=""+r;if(r===0)i="";return i.length>t.length?i:E(t.substr(0,t.length-i.length))+i}if(a=t.match(m))return b(a,l,u);if(t.match(/^#+0+$/))return u+L(l,t.length-t.indexOf("0"));if(a=t.match(w)){i=(""+r).replace(/^([^\.]+)$/,"$1."+E(a[1])).replace(/\.$/,"."+E(a[1]));i=i.replace(/\.(\d*)$/,function(e,t){return"."+t+M("0",E(a[1]).length-t.length)});return t.indexOf("0.")!==-1?i:i.replace(/^0\./,".")}t=t.replace(/^#+([0.])/,"$1");if(a=t.match(/^(0*)\.(#*)$/)){return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".")}if(a=t.match(/^#{1,3},##0(\.?)$/))return u+$(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/)){return r<0?"-"+A(e,t,-r):$(""+r)+"."+M("0",a[1].length)}if(a=t.match(/^#,#*,#0/))return A(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/)){i=N(A(e,t.replace(/[\\-]/g,""),r));o=0;return N(N(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return o<i.length?i.charAt(o++):e==="0"?"0":""}))}if(t.match(S)){i=A(e,"##########",r);return"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6)}var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){o=Math.min(a[4].length,7);s=H(l,Math.pow(10,o)-1,false);i=""+u;f=W("n",a[1],s[1]);if(f.charAt(f.length-1)==" ")f=f.substr(0,f.length-1)+"0";i+=f+a[2]+"/"+a[3];f=F(s[2],o);if(f.length<a[4].length)f=E(a[4].substr(a[4].length-f.length))+f;i+=f;return i}if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){o=Math.min(Math.max(a[1].length,a[4].length),7);s=H(l,Math.pow(10,o)-1,true);return u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?P(s[1],o)+a[2]+"/"+a[3]+F(s[2],o):M(" ",2*o+1+a[2].length+a[3].length))}if(a=t.match(/^[#0?]+$/)){i=""+r;if(t.length<=i.length)return i;return E(t.substr(0,t.length-i.length))+i}if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1");o=i.indexOf(".");var c=t.indexOf(".")-o,d=t.length-i.length-c;return E(t.substr(0,c)+i+t.substr(t.length-d))}if(a=t.match(/^00,000\.([#0]*0)$/)){return r<0?"-"+A(e,t,-r):$(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?L(0,3-e.length):"")+e})+"."+L(0,a[1].length)}switch(t){case"###,###":;case"##,###":;case"#,###":var h=$(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return A(e,t.slice(0,t.lastIndexOf(".")),r)+E(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}return function e(t,r,n){return(n|0)===n?A(t,r,n):D(t,r,n)}}();function b(e){var t=[];var r=false;for(var n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:;case 42:;case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i);i=n+1}t[t.length]=e.substr(i);if(r===true)throw new Error("Format |"+e+"| unterminated string ");return t}t._split=b;var O=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function A(e){var t=0,r="",n="";while(t<e.length){switch(r=e.charAt(t)){case"G":if(x(e,t))t+=6;t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;){}++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":;case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return true;case"M":;case"D":;case"Y":;case"H":;case"S":;case"E":;case"m":;case"d":;case"y":;case"h":;case"s":;case"e":;case"g":return true;case"A":;case"a":;case"ä¸":if(e.substr(t,3).toUpperCase()==="A/P")return true;if(e.substr(t,5).toUpperCase()==="AM/PM")return true;if(e.substr(t,5).toUpperCase()==="ä¸å/ä¸å")return true;++t;break;case"[":n=r;while(e.charAt(t++)!=="]"&&t<e.length)n+=e.charAt(t);if(n.match(O))return true;break;case".":;case"0":;case"#":while(t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1)){}break;case"?":while(e.charAt(++t)===r){}break;case"*":++t;if(e.charAt(t)==" "||e.charAt(t)=="*")++t;break;case"(":;case")":++t;break;case"1":;case"2":;case"3":;case"4":;case"5":;case"6":;case"7":;case"8":;case"9":while(t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1){}break;case" ":++t;break;default:++t;break}}return false}t.is_date=A;function w(e,t,r,n){var i=[],a="",o=0,s="",l="t",u,f,c;var d="H";while(o<e.length){switch(s=e.charAt(o)){case"G":if(!x(e,o))throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"G",v:"General"};o+=7;break;case'"':for(a="";(c=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(c);i[i.length]={t:"t",v:a};++o;break;case"\\":var h=e.charAt(++o),v=h==="("||h===")"?h:"t";i[i.length]={t:v,v:h};++o;break;case"_":i[i.length]={t:"t",v:" "};o+=2;break;case"@":i[i.length]={t:"T",v:t};++o;break;case"B":;case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null){u=D(t,r,e.charAt(o+1)==="2");if(u==null)return""}i[i.length]={t:"X",v:e.substr(o,2)};l=s;o+=2;break};case"M":;case"D":;case"Y":;case"H":;case"S":;case"E":s=s.toLowerCase();case"m":;case"d":;case"y":;case"h":;case"s":;case"e":;case"g":if(t<0)return"";if(u==null){u=D(t,r);if(u==null)return""}a=s;while(++o<e.length&&e.charAt(o).toLowerCase()===s)a+=s;if(s==="m"&&l.toLowerCase()==="h")s="M";if(s==="h")s=d;i[i.length]={t:s,v:a};l=s;break;case"A":;case"a":;case"ä¸":var p={t:s,v:s};if(u==null)u=D(t,r);if(e.substr(o,3).toUpperCase()==="A/P"){if(u!=null)p.v=u.H>=12?"P":"A";p.t="T";d="h";o+=3}else if(e.substr(o,5).toUpperCase()==="AM/PM"){if(u!=null)p.v=u.H>=12?"PM":"AM";p.t="T";o+=5;d="h"}else if(e.substr(o,5).toUpperCase()==="ä¸å/ä¸å"){if(u!=null)p.v=u.H>=12?"ä¸å":"ä¸å";p.t="T";o+=5;d="h"}else{p.t="t";++o}if(u==null&&p.t==="T")return"";i[i.length]=p;l=s;break;case"[":a=s;while(e.charAt(o++)!=="]"&&o<e.length)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(O)){if(u==null){u=D(t,r);if(u==null)return""}i[i.length]={t:"Z",v:a.toLowerCase()};l=a.charAt(1)}else if(a.indexOf("$")>-1){a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$";if(!A(e))i[i.length]={t:"t",v:a}}break;case".":if(u!=null){a=s;while(++o<e.length&&(s=e.charAt(o))==="0")a+=s;i[i.length]={t:"s",v:a};break};case"0":;case"#":a=s;while(++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1)a+=s;i[i.length]={t:"n",v:a};break;case"?":a=s;while(e.charAt(++o)===s)a+=s;i[i.length]={t:s,v:a};l=s;break;case"*":++o;if(e.charAt(o)==" "||e.charAt(o)=="*")++o;break;case"(":;case")":i[i.length]={t:n===1?"t":s,v:s};++o;break;case"1":;case"2":;case"3":;case"4":;case"5":;case"6":;case"7":;case"8":;case"9":a=s;while(o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s};++o;break;case"$":i[i.length]={t:"t",v:"$"};++o;break;default:if(",$-+/():!^&'~{}<>=â¬acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"t",v:s};++o;break}}var g=0,m=0,y;for(o=i.length-1,l="t";o>=0;--o){switch(i[o].t){case"h":;case"H":i[o].t=d;l="h";if(g<1)g=1;break;case"s":if(y=i[o].v.match(/\.0+$/))m=Math.max(m,y[0].length-1);if(g<3)g=3;case"d":;case"y":;case"M":;case"e":l=i[o].t;break;case"m":if(l==="s"){i[o].t="M";if(g<2)g=2}break;case"X":break;case"Z":if(g<1&&i[o].v.match(/[Hh]/))g=1;if(g<2&&i[o].v.match(/[Mm]/))g=2;if(g<3&&i[o].v.match(/[Ss]/))g=3}}switch(g){case 0:break;case 1:if(u.u>=.5){u.u=0;++u.S}if(u.S>=60){u.S=0;++u.M}if(u.M>=60){u.M=0;++u.H}break;case 2:if(u.u>=.5){u.u=0;++u.S}if(u.S>=60){u.S=0;++u.M}break}var b="",w;for(o=0;o<i.length;++o){switch(i[o].t){case"t":;case"T":;case" ":;case"D":break;case"X":i[o].v="";i[o].t=";";break;case"d":;case"m":;case"y":;case"h":;case"H":;case"M":;case"s":;case"e":;case"b":;case"Z":i[o].v=I(i[o].t.charCodeAt(0),i[o].v,u,m);i[o].t="t";break;case"n":;case"?":w=o+1;while(i[w]!=null&&((s=i[w].t)==="?"||s==="D"||(s===" "||s==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"))){i[o].v+=i[w].v;i[w]={v:"",t:";"};++w}b+=i[o].v;o=w-1;break;case"G":i[o].t="t";i[o].v=R(t,r);break}}var C="",S,E;if(b.length>0){if(b.charCodeAt(0)==40){S=t<0&&b.charCodeAt(0)===45?-t:t;E=W("n",b,S)}else{S=t<0&&n>1?-t:t;E=W("n",b,S);if(S<0&&i[0]&&i[0].t=="t"){E=E.substr(1);i[0].v="-"+i[0].v}}w=E.length-1;var k=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){k=o;break}var T=i.length;if(k===i.length&&E.indexOf("E")===-1){for(o=i.length-1;o>=0;--o){if(i[o]==null||"n?".indexOf(i[o].t)===-1)continue;if(w>=i[o].v.length-1){w-=i[o].v.length;i[o].v=E.substr(w+1,i[o].v.length)}else if(w<0)i[o].v="";else{i[o].v=E.substr(0,w+1);w=-1}i[o].t="t";T=o}if(w>=0&&T<i.length)i[T].v=E.substr(0,w+1)+i[T].v}else if(k!==i.length&&E.indexOf("E")===-1){w=E.indexOf(".")-1;for(o=k;o>=0;--o){if(i[o]==null||"n?".indexOf(i[o].t)===-1)continue;f=i[o].v.indexOf(".")>-1&&o===k?i[o].v.indexOf(".")-1:i[o].v.length-1;C=i[o].v.substr(f+1);for(;f>=0;--f){if(w>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#"))C=E.charAt(w--)+C}i[o].v=C;i[o].t="t";T=o}if(w>=0&&T<i.length)i[T].v=E.substr(0,w+1)+i[T].v;w=E.indexOf(".")+1;for(o=k;o<i.length;++o){if(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==k)continue;f=i[o].v.indexOf(".")>-1&&o===k?i[o].v.indexOf(".")+1:0;C=i[o].v.substr(0,f);for(;f<i[o].v.length;++f){if(w<E.length)C+=E.charAt(w++)}i[o].v=C;i[o].t="t";T=o}}}for(o=0;o<i.length;++o)if(i[o]!=null&&"n?".indexOf(i[o].t)>-1){S=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t;i[o].v=W(i[o].t,i[o].v,S);i[o].t="t"}var _="";for(o=0;o!==i.length;++o)if(i[o]!=null)_+=i[o].v;return _}t._eval=w;var C=/\[[=<>]/;var S=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function E(e,t){if(t==null)return false;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return true;break;case">":if(e>r)return true;break;case"<":if(e<r)return true;break;case"<>":if(e!=r)return true;break;case">=":if(e>=r)return true;break;case"<=":if(e<=r)return true;break}return false}function k(e,t){var r=b(e);var n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1)--n;if(r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!=="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(C)!=null||r[1].match(C)!=null){var o=r[0].match(S);var s=r[1].match(S);return E(t,o)?[n,r[0]]:E(t,s)?[n,r[1]]:[n,r[o!=null&&s!=null?2:1]]}return[n,a]}function T(e,t,r){if(r==null)r={};var n="";switch(typeof e){case"string":if(e=="m/d/yy"&&r.dateNF)n=r.dateNF;else n=e;break;case"number":if(e==14&&r.dateNF)n=r.dateNF;else n=(r.table!=null?r.table:o)[e];if(n==null)n=r.table&&r.table[s[e]]||o[s[e]];if(n==null)n=u[e]||"General";break}if(x(n,0))return R(t,r);if(t instanceof Date)t=p(t,r.date1904);var i=k(n,t);if(x(i[1]))return R(t,r);if(t===true)t="TRUE";else if(t===false)t="FALSE";else if(t===""||t==null)return"";return w(i[1],t,r,i[0])}function _(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(o[r]==undefined){if(t<0)t=r;continue}if(o[r]==e){t=r;break}}if(t<0)t=391}o[t]=e;return t}t.load=_;t._table=o;t.get_table=function e(){return o};t.load_table=function e(t){for(var r=0;r!=392;++r)if(t[r]!==undefined)_(t[r],r)};t.init_table=r;t.format=T};re(me);var ne={"General Number":"General","General Date":me._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":me._table[15],"Short Date":me._table[14],"Long Time":me._table[19],"Medium Time":me._table[18],"Short Time":me._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:me._table[2],Standard:me._table[4],Percent:me._table[10],Scientific:me._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var b={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"};var w=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function C(e){var t=typeof e=="number"?me._table[e]:e;t=t.replace(w,"(\\d+)");return new RegExp("^"+t+"$")}function S(e,t,n){var i=-1,a=-1,o=-1,s=-1,l=-1,u=-1;(t.match(w)||[]).forEach(function(e,t){var r=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":i=r;break;case"d":o=r;break;case"h":s=r;break;case"s":u=r;break;case"m":if(s>=0)l=r;else a=r;break}});if(u>=0&&l==-1&&a>=0){l=a;a=-1}var r=(""+(i>=0?i:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);if(r.length==7)r="0"+r;if(r.length==8)r="20"+r;var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);if(s==-1&&l==-1&&u==-1)return r;if(i==-1&&a==-1&&o==-1)return f;return r+"T"+f}var E=true;var Ne;(function(e){e(Ne={})})(function(e){e.version="1.2.0";function t(){var e=0,t=new Array(256);for(var r=0;r!=256;++r){e=r;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;t[r]=e}return typeof Int32Array!=="undefined"?new Int32Array(t):t}var s=t();function r(e,t){var r=t^-1,n=e.length-1;for(var i=0;i<n;){r=r>>>8^s[(r^e.charCodeAt(i++))&255];r=r>>>8^s[(r^e.charCodeAt(i++))&255]}if(i===n)r=r>>>8^s[(r^e.charCodeAt(i))&255];return r^-1}function n(e,t){if(e.length>1e4)return a(e,t);var r=t^-1,n=e.length-3;for(var i=0;i<n;){r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255]}while(i<n+3)r=r>>>8^s[(r^e[i++])&255];return r^-1}function a(e,t){var r=t^-1,n=e.length-7;for(var i=0;i<n;){r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255];r=r>>>8^s[(r^e[i++])&255]}while(i<n+7)r=r>>>8^s[(r^e[i++])&255];return r^-1}function i(e,t){var r=t^-1;for(var n=0,i=e.length,a,o;n<i;){a=e.charCodeAt(n++);if(a<128){r=r>>>8^s[(r^a)&255]}else if(a<2048){r=r>>>8^s[(r^(192|a>>6&31))&255];r=r>>>8^s[(r^(128|a&63))&255]}else if(a>=55296&&a<57344){a=(a&1023)+64;o=e.charCodeAt(n++)&1023;r=r>>>8^s[(r^(240|a>>8&7))&255];r=r>>>8^s[(r^(128|a>>2&63))&255];r=r>>>8^s[(r^(128|o>>6&15|(a&3)<<4))&255];r=r>>>8^s[(r^(128|o&63))&255]}else{r=r>>>8^s[(r^(224|a>>12&15))&255];r=r>>>8^s[(r^(128|a>>6&63))&255];r=r>>>8^s[(r^(128|a&63))&255]}}return r^-1}e.table=s;e.bstr=r;e.buf=n;e.str=i});var Me=function e(){var t={};t.version="1.1.4";function d(e,t){var r=e.split("/"),n=t.split("/");for(var i=0,a=0,o=Math.min(r.length,n.length);i<o;++i){if(a=r[i].length-n[i].length)return a;if(r[i]!=n[i])return r[i]<n[i]?-1:1}return r.length-n.length}function h(e){if(e.charAt(e.length-1)=="/")return e.slice(0,-1).indexOf("/")===-1?e:h(e.slice(0,-1));var t=e.lastIndexOf("/");return t===-1?e:e.slice(0,t+1)}function v(e){if(e.charAt(e.length-1)=="/")return v(e.slice(0,-1));var t=e.lastIndexOf("/");return t===-1?e:e.slice(t+1)}function C(e,t){if(typeof t==="string")t=new Date(t);var r=t.getHours();r=r<<6|t.getMinutes();r=r<<5|t.getSeconds()>>>1;e._W(2,r);var n=t.getFullYear()-1980;n=n<<4|t.getMonth()+1;n=n<<5|t.getDate();e._W(2,n)}function b(e){var t=e._R(2)&65535;var r=e._R(2)&65535;var n=new Date;var i=r&31;r>>>=5;var a=r&15;r>>>=4;n.setMilliseconds(0);n.setFullYear(r+1980);n.setMonth(a-1);n.setDate(i);var o=t&31;t>>>=5;var s=t&63;t>>>=6;n.setHours(t);n.setMinutes(s);n.setSeconds(o<<1);return n}function w(e){Gt(e,0);var t={};var r=0;while(e.l<=e.length-4){var n=e._R(2);var i=e._R(2),a=e.l+i;var o={};switch(n){case 21589:{r=e._R(1);if(r&1)o.mtime=e._R(4);if(i>5){if(r&2)o.atime=e._R(4);if(r&4)o.ctime=e._R(4)}if(o.mtime)o.mt=new Date(o.mtime*1e3)}break}e.l=a;t[n]=o}return t}var i;function a(){return i||(i=require("fs"))}function r(e,t){if(e[0]==80&&e[1]==75)return me(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r=3;var n=512;var i=0;var a=0;var o=0;var s=0;var l=0;var u=[];var f=e.slice(0,512);Gt(f,0);var c=E(f);r=c[0];switch(r){case 3:n=512;break;case 4:n=4096;break;case 0:if(c[1]==0)return me(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}if(n!==512){f=e.slice(0,n);Gt(f,28)}var d=e.slice(0,n);k(f,r);var h=f._R(4,"i");if(r===3&&h!==0)throw new Error("# Directory Sectors: Expected 0 saw "+h);f.l+=4;o=f._R(4,"i");f.l+=4;f.chk("00100000","Mini Stream Cutoff Size: ");s=f._R(4,"i");i=f._R(4,"i");l=f._R(4,"i");a=f._R(4,"i");for(var v=-1,p=0;p<109;++p){v=f._R(4,"i");if(v<0)break;u[p]=v}var g=T(e,n);x(l,a,g,n,u);var m=D(g,o,u,n);m[o].name="!Directory";if(i>0&&s!==O)m[s].name="!MiniFAT";m[u[0]].name="!FAT";m.fat_addrs=u;m.ssz=n;var y={},b=[],w=[],C=[];R(o,m,g,b,i,y,w,s);_(w,C,b);b.shift();var S={FileIndex:w,FullPaths:C};if(t&&t.raw)S.raw={header:d,sectors:g};return S}function E(e){if(e[e.l]==80&&e[e.l+1]==75)return[0,0];e.chk(c,"Header Signature: ");e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}function k(e,t){var r=9;e.l+=2;switch(r=e._R(2)){case 9:if(t!=3)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(t!=4)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: ");e.chk("000000000000","Reserved: ")}function T(e,t){var r=Math.ceil(e.length/t)-1;var n=[];for(var i=1;i<r;++i)n[i-1]=e.slice(i*t,(i+1)*t);n[r-1]=e.slice(r*t);return n}function _(e,t,r){var n=0,i=0,a=0,o=0,s=0,l=r.length;var u=[],f=[];for(;n<l;++n){u[n]=f[n]=n;t[n]=r[n]}for(;s<f.length;++s){n=f[s];i=e[n].L;a=e[n].R;o=e[n].C;if(u[n]===n){if(i!==-1&&u[i]!==i)u[n]=u[i];if(a!==-1&&u[a]!==a)u[n]=u[a]}if(o!==-1)u[o]=n;if(i!==-1&&n!=u[n]){u[i]=u[n];if(f.lastIndexOf(i)<s)f.push(i)}if(a!==-1&&n!=u[n]){u[a]=u[n];if(f.lastIndexOf(a)<s)f.push(a)}}for(n=1;n<l;++n)if(u[n]===n){if(a!==-1&&u[a]!==a)u[n]=u[a];else if(i!==-1&&u[i]!==i)u[n]=u[i]}for(n=1;n<l;++n){if(e[n].type===0)continue;s=n;if(s!=u[s])do{s=u[s];t[n]=t[s]+"/"+t[n]}while(s!==0&&-1!==u[s]&&s!=u[s]);u[n]=-1}t[0]+="/";for(n=1;n<l;++n){if(e[n].type!==2)t[n]+="/"}}function y(e,t,r){var n=e.start,i=e.size;var a=[];var o=n;while(r&&i>0&&o>=0){a.push(t.slice(o*f,o*f+f));i-=f;o=$t(r,o*4)}if(a.length===0)return Kt(0);return Ie(a).slice(0,e.size)}function x(e,t,r,n,i){var a=O;if(e===O){if(t!==0)throw new Error("DIFAT chain shorter than expected")}else if(e!==-1){var o=r[e],s=(n>>>2)-1;if(!o)return;for(var l=0;l<s;++l){if((a=$t(o,l*4))===O)break;i.push(a)}x($t(o,n-4),t-1,r,n,i)}}function S(e,t,r,n,i){var a=[],o=[];if(!i)i=[];var s=n-1,l=0,u=0;for(l=t;l>=0;){i[l]=true;a[a.length]=l;o.push(e[l]);var f=r[Math.floor(l*4/n)];u=l*4&s;if(n<4+u)throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[f])break;l=$t(e[f],u)}return{nodes:a,data:pt([o])}}function D(e,t,r,n){var i=e.length,a=[];var o=[],s=[],l=[];var u=n-1,f=0,c=0,d=0,h=0;for(f=0;f<i;++f){s=[];d=f+t;if(d>=i)d-=i;if(o[d])continue;l=[];var v=[];for(c=d;c>=0;){v[c]=true;o[c]=true;s[s.length]=c;l.push(e[c]);var p=r[Math.floor(c*4/n)];h=c*4&u;if(n<4+h)throw new Error("FAT boundary crossed: "+c+" 4 "+n);if(!e[p])break;c=$t(e[p],h);if(v[c])break}a[d]={nodes:s,data:pt([l])}}return a}function R(e,t,r,n,i,a,o,s){var l=0,u=n.length?2:0;var f=t[e].data;var c=0,d=0,h;for(;c<f.length;c+=128){var v=f.slice(c,c+128);Gt(v,64);d=v._R(2);h=mt(v,0,d-u);n.push(h);var p={name:h,type:v._R(1),color:v._R(1),L:v._R(4,"i"),R:v._R(4,"i"),C:v._R(4,"i"),clsid:v._R(16),state:v._R(4,"i"),start:0,size:0};var g=v._R(2)+v._R(2)+v._R(2)+v._R(2);if(g!==0)p.ct=I(v,v.l-8);var m=v._R(2)+v._R(2)+v._R(2)+v._R(2);if(m!==0)p.mt=I(v,v.l-8);p.start=v._R(4,"i");p.size=v._R(4,"i");if(p.size<0&&p.start<0){p.size=p.type=0;p.start=O;p.name=""}if(p.type===5){l=p.start;if(i>0&&l!==O)t[l].name="!StreamData"}else if(p.size>=4096){p.storage="fat";if(t[p.start]===undefined)t[p.start]=S(r,p.start,t.fat_addrs,t.ssz);t[p.start].name=p.name;p.content=t[p.start].data.slice(0,p.size)}else{p.storage="minifat";if(p.size<0)p.size=0;else if(l!==O&&p.start!==O&&t[l]){p.content=y(p,t[l].data,(t[s]||{}).data)}}if(p.content)Gt(p.content,0);a[h]=p;o.push(p)}}function I(e,t){return new Date((Ht(e,t+4)/1e7*Math.pow(2,32)+Ht(e,t)/1e7-11644473600)*1e3)}function n(e,t){a();return r(i.readFileSync(e),t)}function o(e,t){switch(t&&t.type||"base64"){case"file":return n(e,t);case"base64":return r(Re(Te.decode(e)),t);case"binary":return r(Re(e),t)}return r(e,t)}function m(e,t){var r=t||{},n=r.root||"Root Entry";if(!e.FullPaths)e.FullPaths=[];if(!e.FileIndex)e.FileIndex=[];if(e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");if(e.FullPaths.length===0){e.FullPaths[0]=n+"/";e.FileIndex[0]={name:n,type:5}}if(r.CLSID)e.FileIndex[0].clsid=r.CLSID;s(e)}function s(e){var t="Sh33tJ5";if(Me.find(e,"/"+t))return;var r=Kt(4);r[0]=55;r[1]=r[3]=50;r[2]=54;e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69});e.FullPaths.push(e.FullPaths[0]+t);p(e)}function p(e,t){m(e);var r=false,n=false;for(var i=e.FullPaths.length-1;i>=0;--i){var a=e.FileIndex[i];switch(a.type){case 0:if(n)r=true;else{e.FileIndex.pop();e.FullPaths.pop()}break;case 1:;case 2:;case 5:n=true;if(isNaN(a.R*a.L*a.C))r=true;if(a.R>-1&&a.L>-1&&a.R==a.L)r=true;break;default:r=true;break}}if(!r&&!t)return;var o=new Date(1987,1,19),s=0;var l=[];for(i=0;i<e.FullPaths.length;++i){if(e.FileIndex[i].type===0)continue;l.push([e.FullPaths[i],e.FileIndex[i]])}for(i=0;i<l.length;++i){var u=h(l[i][0]);n=false;for(s=0;s<l.length;++s)if(l[s][0]===u)n=true;if(!n)l.push([u,{name:v(u).replace("/",""),type:1,clsid:A,ct:o,mt:o,content:null}])}l.sort(function(e,t){return d(e[0],t[0])});e.FullPaths=[];e.FileIndex=[];for(i=0;i<l.length;++i){e.FullPaths[i]=l[i][0];e.FileIndex[i]=l[i][1]}for(i=0;i<l.length;++i){var f=e.FileIndex[i];var c=e.FullPaths[i];f.name=v(c).replace("/","");f.L=f.R=f.C=-(f.color=1);f.size=f.content?f.content.length:0;f.start=0;f.clsid=f.clsid||A;if(i===0){f.C=l.length>1?1:-1;f.size=0;f.type=5}else if(c.slice(-1)=="/"){for(s=i+1;s<l.length;++s)if(h(e.FullPaths[s])==c)break;f.C=s>=l.length?-1:s;for(s=i+1;s<l.length;++s)if(h(e.FullPaths[s])==h(c))break;f.R=s>=l.length?-1:s;f.type=1}else{if(h(e.FullPaths[i+1]||"")==h(c))f.R=i+1;f.type=2}}}function l(e,t){var r=t||{};p(e);if(r.fileType=="zip")return be(e,r);var n=function(e){var t=0,r=0;for(var n=0;n<e.FileIndex.length;++n){var i=e.FileIndex[n];if(!i.content)continue;var a=i.content.length;if(a>0){if(a<4096)t+=a+63>>6;else r+=a+511>>9}}var o=e.FullPaths.length+3>>2;var s=t+7>>3;var l=t+127>>7;var u=s+r+o+l;var f=u+127>>7;var c=f<=109?0:Math.ceil((f-109)/127);while(u+f+c+127>>7>f)c=++f<=109?0:Math.ceil((f-109)/127);var d=[1,c,f,l,o,r,t,0];e.FileIndex[0].size=t<<6;d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3);return d}(e);var i=Kt(n[7]<<9);var a=0,o=0;{for(a=0;a<8;++a)i._W(1,g[a]);for(a=0;a<8;++a)i._W(2,0);i._W(2,62);i._W(2,3);i._W(2,65534);i._W(2,9);i._W(2,6);for(a=0;a<3;++a)i._W(2,0);i._W(4,0);i._W(4,n[2]);i._W(4,n[0]+n[1]+n[2]+n[3]-1);i._W(4,0);i._W(4,1<<12);i._W(4,n[3]?n[0]+n[1]+n[2]-1:O);i._W(4,n[3]);i._W(-4,n[1]?n[0]-1:O);i._W(4,n[1]);for(a=0;a<109;++a)i._W(-4,a<n[2]?n[1]+a:-1)}if(n[1]){for(o=0;o<n[1];++o){for(;a<236+o*127;++a)i._W(-4,a<n[2]?n[1]+a:-1);i._W(-4,o===n[1]-1?O:o+1)}}var s=function(e){for(o+=e;a<o-1;++a)i._W(-4,a+1);if(e){++a;i._W(-4,O)}};o=a=0;for(o+=n[1];a<o;++a)i._W(-4,N.DIFSECT);for(o+=n[2];a<o;++a)i._W(-4,N.FATSECT);s(n[3]);s(n[4]);var l=0,u=0;var f=e.FileIndex[0];for(;l<e.FileIndex.length;++l){f=e.FileIndex[l];if(!f.content)continue;u=f.content.length;if(u<4096)continue;f.start=o;s(u+511>>9)}s(n[6]+7>>3);while(i.l&511)i._W(-4,N.ENDOFCHAIN);o=a=0;for(l=0;l<e.FileIndex.length;++l){f=e.FileIndex[l];if(!f.content)continue;u=f.content.length;if(!u||u>=4096)continue;f.start=o;s(u+63>>6)}while(i.l&511)i._W(-4,N.ENDOFCHAIN);for(a=0;a<n[4]<<2;++a){var c=e.FullPaths[a];if(!c||c.length===0){for(l=0;l<17;++l)i._W(4,0);for(l=0;l<3;++l)i._W(4,-1);for(l=0;l<12;++l)i._W(4,0);continue}f=e.FileIndex[a];if(a===0)f.start=f.size?f.start-1:O;var d=a===0&&r.root||f.name;u=2*(d.length+1);i._W(64,d,"utf16le");i._W(2,u);i._W(1,f.type);i._W(1,f.color);i._W(-4,f.L);i._W(-4,f.R);i._W(-4,f.C);if(!f.clsid)for(l=0;l<4;++l)i._W(4,0);else i._W(16,f.clsid,"hex");i._W(4,f.state||0);i._W(4,0);i._W(4,0);i._W(4,0);i._W(4,0);i._W(4,f.start);i._W(4,f.size);i._W(4,0)}for(a=1;a<e.FileIndex.length;++a){f=e.FileIndex[a];if(f.size>=4096){i.l=f.start+1<<9;for(l=0;l<f.size;++l)i._W(1,f.content[l]);for(;l&511;++l)i._W(1,0)}}for(a=1;a<e.FileIndex.length;++a){f=e.FileIndex[a];if(f.size>0&&f.size<4096){for(l=0;l<f.size;++l)i._W(1,f.content[l]);for(;l&63;++l)i._W(1,0)}}while(i.l<i.length)i._W(1,0);return i}function u(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()});var n=r.map(function(e){var t=e.split("/");return t[t.length-(e.slice(-1)=="/"?2:1)]});var i=false;if(t.charCodeAt(0)===47){i=true;t=r[0].slice(0,-1)+t}else i=t.indexOf("/")!==-1;var a=t.toUpperCase();var o=i===true?r.indexOf(a):n.indexOf(a);if(o!==-1)return e.FileIndex[o];var s=!a.match(Ae);a=a.replace(Oe,"");if(s)a=a.replace(Ae,"!");for(o=0;o<r.length;++o){if((s?r[o].replace(Ae,"!"):r[o]).replace(Oe,"")==a)return e.FileIndex[o];if((s?n[o].replace(Ae,"!"):n[o]).replace(Oe,"")==a)return e.FileIndex[o]}return null}var f=64;var O=-2;var c="d0cf11e0a1b11ae1";var g=[208,207,17,224,161,177,26,225];var A="00000000000000000000000000000000";var N={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:c,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:A,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(e,t,r){a();var n=l(e,r);i.writeFileSync(t,n)}function L(e){var t=new Array(e.length);for(var r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function P(e,t){var r=l(e,t);switch(t&&t.type){case"file":a();i.writeFileSync(t.filename,r);return r;case"binary":return L(r);case"base64":return Te.encode(L(r))}return r}var F;function B(e){try{var t=e.InflateRaw;var r=new t;r._processChunk(new Uint8Array([3,0]),r._finishFlushFlag);if(r.bytesRead)F=e;else throw new Error("zlib does not expose bytesRead")}catch(e){console.error("cannot use native zlib: "+(e.message||e))}}function H(e,t){if(!F)return pe(e,t);var r=F.InflateRaw;var n=new r;var i=n._processChunk(e.slice(e.l),n._finishFlushFlag);e.l+=n.bytesRead;return i}function $(e){return F?F.deflateRawSync(e):ne(e)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];var j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function V(e){var t=(e<<1|e<<11)&139536|(e<<5|e<<15)&558144;return(t>>16|t>>8|t)&255}var z=typeof Uint8Array!=="undefined";var q=z?new Uint8Array(1<<8):[];for(var Y=0;Y<1<<8;++Y)q[Y]=V(Y);function G(e,t){var r=q[e&255];if(t<=8)return r>>>8-t;r=r<<8|q[e>>8&255];if(t<=16)return r>>>16-t;r=r<<8|q[e>>16&255];return r>>>24-t}function X(e,t){var r=t&7,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function K(e,t){var r=t&7,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function J(e,t){var r=t&7,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}function Q(e,t){var r=t&7,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function Z(e,t){var r=t&7,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function ee(e,t,r){var n=t&7,i=t>>>3,a=(1<<r)-1;var o=e[i]>>>n;if(r<8-n)return o&a;o|=e[i+1]<<8-n;if(r<16-n)return o&a;o|=e[i+2]<<16-n;if(r<24-n)return o&a;o|=e[i+3]<<24-n;return o&a}function te(e,t){var r=e.length,n=2*r>t?2*r:t+5,i=0;if(r>=t)return e;if(_e){var a=De(n);if(e.copy)e.copy(a);else for(;i<e.length;++i)a[i]=e[i];return a}else if(z){var o=new Uint8Array(n);if(o.set)o.set(e);else for(;i<e.length;++i)o[i]=e[i];return o}e.length=n;return e}function re(e){var t=new Array(e);for(var r=0;r<e;++r)t[r]=0;return t}var ne=function(){var n=function(){return function e(t,r){var n=0;while(n<t.length){var i=Math.min(65535,t.length-n);var a=n+i==t.length;r._W(1,+a);r._W(2,i);r._W(2,~i&65535);while(i-- >0)r[r.l++]=t[n++]}return r.l}}();return function(e){var t=Kt(50+Math.floor(e.length*1.1));var r=n(e,t);return t.slice(0,r)}}();function ie(e,t,r){var n=1,i=0,a=0,o=0,s=0,l=e.length;var u=z?new Uint16Array(32):re(32);for(a=0;a<32;++a)u[a]=0;for(a=l;a<r;++a)e[a]=0;l=e.length;var f=z?new Uint16Array(l):re(l);for(a=0;a<l;++a){u[i=e[a]]++;if(n<i)n=i;f[a]=0}u[0]=0;for(a=1;a<=n;++a)u[a+16]=s=s+u[a-1]<<1;for(a=0;a<l;++a){s=e[a];if(s!=0)f[a]=u[s+16]++}var c=0;for(a=0;a<l;++a){c=e[a];if(c!=0){s=G(f[a],n)>>n-c;for(o=(1<<n+4-c)-1;o>=0;--o)t[s|o<<c]=c&15|a<<4}}return n}var ae=z?new Uint16Array(512):re(512);var oe=z?new Uint16Array(32):re(32);if(!z){for(var se=0;se<512;++se)ae[se]=0;for(se=0;se<32;++se)oe[se]=0}(function(){var e=[];var t=0;for(;t<32;t++)e.push(5);ie(e,oe,32);var r=[];t=0;for(;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);ie(r,ae,288)})();var le=z?new Uint16Array(32768):re(32768);var ue=z?new Uint16Array(32768):re(32768);var fe=z?new Uint16Array(128):re(128);var ce=1,de=1;function he(e,t){var r=Q(e,t)+257;t+=5;var n=Q(e,t)+1;t+=5;var i=J(e,t)+4;t+=4;var a=0;var o=z?new Uint8Array(19):re(19);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var l=1;var u=z?new Uint8Array(8):re(8);var f=z?new Uint8Array(8):re(8);var c=o.length;for(var d=0;d<i;++d){o[W[d]]=a=K(e,t);if(l<a)l=a;u[a]++;t+=3}var h=0;u[0]=0;for(d=1;d<=l;++d)f[d]=h=h+u[d-1]<<1;for(d=0;d<c;++d)if((h=o[d])!=0)s[d]=f[h]++;var v=0;for(d=0;d<c;++d){v=o[d];if(v!=0){h=q[s[d]]>>8-v;for(var p=(1<<7-v)-1;p>=0;--p)fe[h|p<<v]=v&7|d<<3}}var g=[];l=1;for(;g.length<r+n;){h=fe[Z(e,t)];t+=h&7;switch(h>>>=3){case 16:a=3+X(e,t);t+=2;h=g[g.length-1];while(a-- >0)g.push(h);break;case 17:a=3+K(e,t);t+=3;while(a-- >0)g.push(0);break;case 18:a=11+Z(e,t);t+=7;while(a-- >0)g.push(0);break;default:g.push(h);if(l<h)l=h;break}}var m=g.slice(0,r),y=g.slice(r);for(d=r;d<286;++d)m[d]=0;for(d=n;d<30;++d)y[d]=0;ce=ie(m,le,286);de=ie(y,ue,30);return t}function ve(e,t){if(e[0]==3&&!(e[1]&3)){return[xe(t),2]}var r=0;var n=0;var i=De(t?t:1<<18);var a=0;var o=i.length>>>0;var s=0,l=0;while((n&1)==0){n=K(e,r);r+=3;if(n>>>1==0){if(r&7)r+=8-(r&7);var u=e[r>>>3]|e[(r>>>3)+1]<<8;r+=32;if(!t&&o<a+u){i=te(i,a+u);o=i.length}if(typeof e.copy==="function"){e.copy(i,a,r>>>3,(r>>>3)+u);a+=u;r+=8*u}else while(u-- >0){i[a++]=e[r>>>3];r+=8}continue}else if(n>>>1==1){s=9;l=5}else{r=he(e,r);s=ce;l=de}if(!t&&o<a+32767){i=te(i,a+32767);o=i.length}for(;;){var f=ee(e,r,s);var c=n>>>1==1?ae[f]:le[f];r+=c&15;c>>>=4;if((c>>>8&255)===0)i[a++]=c;else if(c==256)break;else{c-=257;var d=c<8?0:c-4>>2;if(d>5)d=0;var h=a+U[c];if(d>0){h+=ee(e,r,d);r+=d}f=ee(e,r,l);c=n>>>1==1?oe[f]:ue[f];r+=c&15;c>>>=4;var v=c<4?0:c-2>>1;var p=j[c];if(v>0){p+=ee(e,r,v);r+=v}if(!t&&o<h){i=te(i,h);o=i.length}while(a<h){i[a]=i[a-p];++a}}}}return[t?i:i.slice(0,a),r+7>>>3]}function pe(e,t){var r=e.slice(e.l||0);var n=ve(r,t);e.l+=n[1];return n[0]}function ge(e,t){if(e){if(typeof console!=="undefined")console.error(t)}else throw new Error(t)}function me(e,t){var r=e;Gt(r,0);var n=[],i=[];var a={FileIndex:n,FullPaths:i};m(a,{root:t.root});var o=r.length-4;while((r[o]!=80||r[o+1]!=75||r[o+2]!=5||r[o+3]!=6)&&o>=0)--o;r.l=o+4;r.l+=4;var s=r._R(2);r.l+=6;var l=r._R(4);r.l=l;for(o=0;o<s;++o){r.l+=20;var u=r._R(4);var f=r._R(4);var c=r._R(2);var d=r._R(2);var h=r._R(2);r.l+=8;var v=r._R(4);var p=w(r.slice(r.l+c,r.l+c+d));r.l+=c+d+h;var g=r.l;r.l=v+4;ye(r,u,f,a,p);r.l=g}return a}function ye(e,t,r,n,i){e.l+=2;var a=e._R(2);var o=e._R(2);var s=b(e);if(a&8257)throw new Error("Unsupported ZIP encryption");var l=e._R(4);var u=e._R(4);var f=e._R(4);var c=e._R(2);var d=e._R(2);var h="";for(var v=0;v<c;++v)h+=String.fromCharCode(e[e.l++]);if(d){var p=w(e.slice(e.l,e.l+d));if((p[21589]||{}).mt)s=p[21589].mt;if(((i||{})[21589]||{}).mt)s=i[21589].mt}e.l+=d;var g=e.slice(e.l,e.l+u);switch(o){case 8:g=H(e,f);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var m=false;if(a&8){l=e._R(4);if(l==134695760){l=e._R(4);m=true}u=e._R(4);f=e._R(4)}if(u!=t)ge(m,"Bad compressed size: "+t+" != "+u);if(f!=r)ge(m,"Bad uncompressed size: "+r+" != "+f);var y=Ne.buf(g,0);if(l>>0!=y>>0)ge(m,"Bad CRC32 checksum: "+l+" != "+y);Ce(n,h,g,{unsafe:true,mt:s})}function be(e,t){var r=t||{};var n=[],i=[];var a=Kt(1);var o=r.compression?8:0,s=0;var l=false;if(l)s|=8;var u=0,f=0;var c=0,d=0;var h=e.FullPaths[0],v=h,p=e.FileIndex[0];var g=[];var m=0;for(u=1;u<e.FullPaths.length;++u){v=e.FullPaths[u].slice(h.length);p=e.FileIndex[u];if(!p.size||!p.content||v=="Sh33tJ5")continue;var y=c;var b=Kt(v.length);for(f=0;f<v.length;++f)b._W(1,v.charCodeAt(f)&127);b=b.slice(0,b.l);g[d]=Ne.buf(p.content,0);var w=p.content;if(o==8)w=$(w);a=Kt(30);a._W(4,67324752);a._W(2,20);a._W(2,s);a._W(2,o);if(p.mt)C(a,p.mt);else a._W(4,0);a._W(-4,s&8?0:g[d]);a._W(4,s&8?0:w.length);a._W(4,s&8?0:p.content.length);a._W(2,b.length);a._W(2,0);c+=a.length;n.push(a);c+=b.length;n.push(b);c+=w.length;n.push(w);if(s&8){a=Kt(12);a._W(-4,g[d]);a._W(4,w.length);a._W(4,p.content.length);c+=a.l;n.push(a)}a=Kt(46);a._W(4,33639248);a._W(2,0);a._W(2,20);a._W(2,s);a._W(2,o);a._W(4,0);a._W(-4,g[d]);a._W(4,w.length);a._W(4,p.content.length);a._W(2,b.length);a._W(2,0);a._W(2,0);a._W(2,0);a._W(2,0);a._W(4,0);a._W(4,y);m+=a.l;i.push(a);m+=b.length;i.push(b);++d}a=Kt(22);a._W(4,101010256);a._W(2,0);a._W(2,0);a._W(2,d);a._W(2,d);a._W(4,m);a._W(4,c);a._W(2,0);return Ie([Ie(n),Ie(i),a])}function we(e){var t={};m(t,e);return t}function Ce(e,t,r,n){var i=n&&n.unsafe;if(!i)m(e);var a=!i&&Me.find(e,t);if(!a){var o=e.FullPaths[0];if(t.slice(0,o.length)==o)o=t;else{if(o.slice(-1)!="/")o+="/";o=(o+t).replace("//","/")}a={name:v(t),type:2};e.FileIndex.push(a);e.FullPaths.push(o);if(!i)Me.utils.cfb_gc(e)}a.content=r;a.size=r?r.length:0;if(n){if(n.CLSID)a.clsid=n.CLSID;if(n.mt)a.mt=n.mt;if(n.ct)a.ct=n.ct}return a}function Se(e,t){m(e);var r=Me.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r){e.FileIndex.splice(n,1);e.FullPaths.splice(n,1);return true}return false}function Ee(e,t,r){m(e);var n=Me.find(e,t);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n){e.FileIndex[i].name=v(r);e.FullPaths[i]=r;return true}return false}function ke(e){p(e,true)}t.find=u;t.read=o;t.parse=r;t.write=P;t.writeFile=M;t.utils={cfb_new:we,cfb_add:Ce,cfb_del:Se,cfb_mov:Ee,cfb_gc:ke,ReadShift:Ut,CheckField:Yt,prep_blob:Gt,bconcat:Ie,use_zlib:B,_deflateRaw:ne,_inflateRaw:pe,consts:N};return t}();if(typeof require!=="undefined"&&typeof module!=="undefined"&&typeof E==="undefined"){module.exports=Me}var T;if(typeof require!=="undefined")try{T=require("fs")}catch(e){}function _(e){if(typeof e==="string")return p(e);if(Array.isArray(e))return m(e);return e}function x(e,t,r){if(typeof T!=="undefined"&&T.writeFileSync)return r?T.writeFileSync(e,t,r):T.writeFileSync(e,t);var n=r=="utf8"?Xe(t):t;if(typeof IE_SaveFile!=="undefined")return IE_SaveFile(n,e);if(typeof Blob!=="undefined"){var i=new Blob([_(n)],{type:"application/octet-stream"});if(typeof navigator!=="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs!=="undefined")return saveAs(i,e);if(typeof URL!=="undefined"&&typeof document!=="undefined"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome==="object"&&typeof(chrome.downloads||{}).download=="function"){if(URL.revokeObjectURL&&typeof setTimeout!=="undefined")setTimeout(function(){URL.revokeObjectURL(a)},6e4);return chrome.downloads.download({url:a,filename:e,saveAs:true})}var o=document.createElement("a");if(o.download!=null){o.download=e;o.href=a;document.body.appendChild(o);o.click();document.body.removeChild(o);if(URL.revokeObjectURL&&typeof setTimeout!=="undefined")setTimeout(function(){URL.revokeObjectURL(a)},6e4);return a}}}if(typeof $!=="undefined"&&typeof File!=="undefined"&&typeof Folder!=="undefined")try{var s=File(e);s.open("w");s.encoding="binary";if(Array.isArray(t))t=g(t);s.write(t);s.close();return t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function D(e){if(typeof T!=="undefined")return T.readFileSync(e);if(typeof $!=="undefined"&&typeof File!=="undefined"&&typeof Folder!=="undefined")try{var t=File(e);t.open("r");t.encoding="binary";var r=t.read();t.close();return r}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}function ye(e){var t=Object.keys(e),r=[];for(var n=0;n<t.length;++n)if(Object.prototype.hasOwnProperty.call(e,t[n]))r.push(t[n]);return r}function R(e,t){var r=[],n=ye(e);for(var i=0;i!==n.length;++i)if(r[e[n[i]][t]]==null)r[e[n[i]][t]]=n[i];return r}function I(e){var t=[],r=ye(e);for(var n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function O(e){var t=[],r=ye(e);for(var n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function A(e){var t=[],r=ye(e);for(var n=0;n!==r.length;++n){if(t[e[r[n]]]==null)t[e[r[n]]]=[];t[e[r[n]]].push(r[n])}return t}var N=new Date(1899,11,30,0,0,0);function Z(e,t){var r=e.getTime();if(t)r-=1462*24*60*60*1e3;var n=N.getTime()+(e.getTimezoneOffset()-N.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var M=new Date;var L=N.getTime()+(M.getTimezoneOffset()-N.getTimezoneOffset())*6e4;var P=M.getTimezoneOffset();function Y(e){var t=new Date;t.setTime(e*24*60*60*1e3+L);if(t.getTimezoneOffset()!==P){t.setTime(t.getTime()+(t.getTimezoneOffset()-P)*6e4)}return t}function ie(e){var t=0,r=0,n=false;var i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a){if(!i[a])continue;r=1;if(a>3)n=true;switch(i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");else r*=60;case"S":break}t+=r*parseInt(i[a],10)}return t}var F=new Date("2017-02-19T19:06:09.000Z");if(isNaN(F.getFullYear()))F=new Date("2/19/17");var B=F.getFullYear()==2017;function ae(e,t){var r=new Date(e);if(B){if(t>0)r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3);else if(t<0)r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3);return r}if(e instanceof Date)return e;if(F.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();if(e.indexOf(""+n)>-1)return r;r.setFullYear(r.getFullYear()+100);return r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"];var a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);if(e.indexOf("Z")>-1)a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3);return a}function H(e){var t="";for(var r=0;r!=e.length;++r)t+=String.fromCharCode(e[r]);return t}function oe(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=oe(e[r]);return t}function W(e,t){var r="";while(r.length<t)r+=e;return r}function U(e){var t=Number(e);if(!isNaN(t))return t;if(!/\d/.test(e))return t;var r=1;var n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){r*=100;return""});if(!isNaN(t=Number(n)))return t/r;n=n.replace(/[(](.*)[)]/,function(e,t){r=-r;return t});if(!isNaN(t=Number(n)))return t/r;return t}function j(e){var t=new Date(e),r=new Date(NaN);var n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;if(n<0||n>8099)return r;if((i>0||a>1)&&n!=101)return t;if(e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/))return t;if(e.match(/[^-0-9:,\/\\]/))return r;return t}var V="abacaba".split(/(:?b)/i).length==5;function z(e,t,r){if(V||typeof t=="string")return e.split(t);var n=e.split(t),i=[n[0]];for(var a=1;a<n.length;++a){i.push(r);i.push(n[a])}return i}function q(e){if(!e)return null;if(e.data)return te(e.data);if(e.asNodeBuffer&&_e)return te(e.asNodeBuffer().toString("binary"));if(e.asBinary)return te(e.asBinary());if(e._data&&e._data.getContent)return te(H(Array.prototype.slice.call(e._data.getContent(),0)));if(e.content&&e.type)return te(H(e.content));return null}function G(e){if(!e)return null;if(e.data)return ee(e.data);if(e.asNodeBuffer&&_e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();if(typeof t=="string")return ee(t);return Array.prototype.slice.call(t)}if(e.content&&e.type)return e.content;return null}function X(e){return e&&e.name.slice(-4)===".bin"?G(e):q(e)}function K(e,t){var r=e.FullPaths||ye(e.files);var n=t.toLowerCase(),i=n.replace(/\//g,"\\");for(var a=0;a<r.length;++a){var o=r[a].toLowerCase();if(n==o||i==o)return e.files[r[a]]}return null}function J(e,t){var r=K(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Q(e,t,r){if(!r)return X(J(e,t));if(!t)return null;try{return Q(e,t)}catch(e){return null}}function se(e,t,r){if(!r)return q(J(e,t));if(!t)return null;try{return se(e,t)}catch(e){return null}}function le(e){var t=e.FullPaths||ye(e.files),r=[];for(var n=0;n<t.length;++n)if(t[n].slice(-1)!="/")r.push(t[n]);return r.sort()}function ue(e,t,r){if(e.FullPaths)Me.utils.cfb_add(e,t,r);else e.file(t,r)}var fe;if(typeof JSZipSync!=="undefined")fe=JSZipSync;if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){if(typeof fe==="undefined")fe=undefined}}function ce(){if(!fe)return Me.utils.cfb_new();return new fe}function de(e,t){var r;if(fe)switch(t.type){case"base64":r=new fe(e,{base64:true});break;case"binary":;case"array":r=new fe(e,{base64:false});break;case"buffer":r=new fe(e);break;default:throw new Error("Unrecognized type "+t.type)}else switch(t.type){case"base64":r=Me.read(e,{type:"base64"});break;case"binary":r=Me.read(e,{type:"binary"});break;case"buffer":;case"array":r=Me.read(e,{type:"buffer"});break;default:throw new Error("Unrecognized type "+t.type)}return r}function he(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");if(t.slice(-1)!="/")r.pop();var n=e.split("/");while(n.length!==0){var i=n.shift();if(i==="..")r.pop();else if(i!==".")r.push(i)}return r.join("/")}var ve='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var be=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g;var we=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s?[\/\?]?>/gm;if(!ve.match(we))we=/<[^>]*>/g;var Ce=/<\w*:/,Se=/<(\/?)\w+:/;function Ee(e,t,r){var n={};var i=0,a=0;for(;i!==e.length;++i)if((a=e.charCodeAt(i))===32||a===10||a===13)break;if(!t)n[0]=e.slice(0,i);if(i===e.length)return n;var o=e.match(be),s=0,l="",u=0,f="",c="",d=1;if(o)for(u=0;u!=o.length;++u){c=o[u];for(a=0;a!=c.length;++a)if(c.charCodeAt(a)===61)break;f=c.slice(0,a).trim();while(c.charCodeAt(a+1)==32)++a;d=(i=c.charCodeAt(a+1))==34||i==39?1:0;l=c.slice(a+1+d,c.length-d);for(s=0;s!=f.length;++s)if(f.charCodeAt(s)===58)break;if(s===f.length){if(f.indexOf("_")>0)f=f.slice(0,f.indexOf("_"));n[f]=l;if(!r)n[f.toLowerCase()]=l}else{var h=(s===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(s+1);if(n[h]&&f.slice(s-3,s)=="ext")continue;n[h]=l;if(!r)n[h.toLowerCase()]=l}}return n}function ke(e){return e.replace(Se,"<$1")}var Le={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};var Pe=I(Le);var Fe=function(){var a=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,o=/_x([\da-fA-F]{4})_/gi;return function e(t){var r=t+"",n=r.indexOf("<![CDATA[");if(n==-1)return r.replace(a,function(e,t){return Le[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(o,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=r.indexOf("]]>");return e(r.slice(0,n))+r.slice(n+9,i)+e(r.slice(i+3))}}();var Be=/[&<>'"]/g,He=/[\u0000-\u0008\u000b-\u001f]/g;function $e(e){var t=e+"";return t.replace(Be,function(e){return Pe[e]}).replace(He,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function We(e){return $e(e).replace(/ /g,"_x0020_")}var Ue=/[\u0000-\u001f]/g;function je(e){var t=e+"";return t.replace(Be,function(e){return Pe[e]}).replace(/\n/g,"<br/>").replace(Ue,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ve(e){var t=e+"";return t.replace(Be,function(e){return Pe[e]}).replace(Ue,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var ze=function(){var r=/&#(\d+);/g;function n(e,t){return String.fromCharCode(parseInt(t,10))}return function e(t){return t.replace(r,n)}}();var qe=function(){return function e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}}();function Ye(e){switch(e){case 1:;case true:;case"1":;case"true":;case"TRUE":return true;default:return false}}var Ge=function e(t){var r="",n=0,i=0,a=0,o=0,s=0,l=0;while(n<t.length){i=t.charCodeAt(n++);if(i<128){r+=String.fromCharCode(i);continue}a=t.charCodeAt(n++);if(i>191&&i<224){s=(i&31)<<6;s|=a&63;r+=String.fromCharCode(s);continue}o=t.charCodeAt(n++);if(i<240){r+=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63);continue}s=t.charCodeAt(n++);l=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;r+=String.fromCharCode(55296+(l>>>10&1023));r+=String.fromCharCode(56320+(l&1023))}return r};var Xe=function(e){var t=[],r=0,n=0,i=0;while(r<e.length){n=e.charCodeAt(r++);switch(true){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6)));t.push(String.fromCharCode(128+(n&63)));break;case n>=55296&&n<57344:n-=55296;i=e.charCodeAt(r++)-56320+(n<<10);t.push(String.fromCharCode(240+(i>>18&7)));t.push(String.fromCharCode(144+(i>>12&63)));t.push(String.fromCharCode(128+(i>>6&63)));t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12)));t.push(String.fromCharCode(128+(n>>6&63)));t.push(String.fromCharCode(128+(n&63)))}}return t.join("")};if(_e){var Ke=function e(t){var r=Buffer.alloc(2*t.length),n,i,a=1,o=0,s=0,l;for(i=0;i<t.length;i+=a){a=1;if((l=t.charCodeAt(i))<128)n=l;else if(l<224){n=(l&31)*64+(t.charCodeAt(i+1)&63);a=2}else if(l<240){n=(l&15)*4096+(t.charCodeAt(i+1)&63)*64+(t.charCodeAt(i+2)&63);a=3}else{a=4;n=(l&7)*262144+(t.charCodeAt(i+1)&63)*4096+(t.charCodeAt(i+2)&63)*64+(t.charCodeAt(i+3)&63);n-=65536;s=55296+(n>>>10&1023);n=56320+(n&1023)}if(s!==0){r[o++]=s&255;r[o++]=s>>>8;s=0}r[o++]=n%256;r[o++]=n>>>8}return r.slice(0,o).toString("ucs2")};var Je="foo bar bazÃ¢ÂÂÃ°ÂÂÂ£";if(Ge(Je)==Ke(Je))Ge=Ke;var Qe=function e(t){return o(t,"binary").toString("utf8")};if(Ge(Je)==Qe(Je))Ge=Qe;Xe=function(e){return o(e,"utf8").toString("binary")}}var Ze=function(){var i={};return function e(t,r){var n=t+"|"+(r||"");if(i[n])return i[n];return i[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}();var et=function(){var i=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function e(t){var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,"");for(var n=0;n<i.length;++n)r=r.replace(i[n][0],i[n][1]);return r}}();var tt=function(){var r={};return function e(t){if(r[t]!==undefined)return r[t];return r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}();var rt=/<\/?(?:vt:)?variant>/g,nt=/<(?:vt:)([^>]*)>([\s\S]*)</;function it(e,t){var r=Ee(e);var n=e.match(tt(r.baseType))||[];var i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}n.forEach(function(e){var t=e.replace(rt,"").match(nt);if(t)i.push({v:Ge(t[2]),t:t[1]})});return i}var at=/(^\s|\s$|\n)/;function ot(e,t){return"<"+e+(t.match(at)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function st(t){return ye(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function lt(e,t,r){return"<"+e+(r!=null?st(r):"")+(t!=null?(t.match(at)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ut(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function ft(e,t){switch(typeof e){case"string":var r=lt("vt:lpwstr",$e(e));if(t)r=r.replace(/&quot;/g,"_x0022_");return r;case"number":return lt((e|0)==e?"vt:i4":"vt:r8",$e(String(e)));case"boolean":return lt("vt:bool",e?"true":"false")}if(e instanceof Date)return lt("vt:filetime",ut(e));throw new Error("Unable to serialize "+e)}var ct={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"};ct.main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var dt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ht(e,t){var r=1-2*(e[t+7]>>>7);var n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15);var i=e[t+6]&15;for(var a=5;a>=0;--a)i=i*256+e[t+a];if(n==2047)return i==0?r*Infinity:NaN;if(n==0)n=-1022;else{n-=1023;i+=Math.pow(2,52)}return r*Math.pow(2,n-52)*i}function vt(e,t,r){var n=(t<0||1/t==-Infinity?1:0)<<7,i=0,a=0;var o=n?-t:t;if(!isFinite(o)){i=2047;a=isNaN(t)?26985:0}else if(o==0)i=a=0;else{i=Math.floor(Math.log(o)/Math.LN2);a=o*Math.pow(2,52-i);if(i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))){i=-1022}else{a-=Math.pow(2,52);i+=1023}}for(var s=0;s<=5;++s,a/=256)e[r+s]=a&255;e[r+6]=(i&15)<<4|a&15;e[r+7]=i>>4|n}var pt=function(e){var t=[],r=10240;for(var n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t};var gt=pt;var mt=function(e,t,r){var n=[];for(var i=t;i<r;i+=2)n.push(String.fromCharCode(Ft(e,i)));return n.join("").replace(Oe,"")};var yt=mt;var bt=function(e,t,r){var n=[];for(var i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")};var wt=bt;var Ct=function(e,t,r){var n=[];for(var i=t;i<r;i++)n.push(String.fromCharCode(Pt(e,i)));return n.join("")};var St=Ct;var Et=function(e,t){var r=Ht(e,t);return r>0?Ct(e,t+4,t+4+r-1):""};var kt=Et;var Tt=function(e,t){var r=Ht(e,t);return r>0?Ct(e,t+4,t+4+r-1):""};var _t=Tt;var xt=function(e,t){var r=2*Ht(e,t);return r>0?Ct(e,t+4,t+4+r-1):""};var Dt=xt;var Rt,It;Rt=It=function e(t,r){var n=Ht(t,r);return n>0?mt(t,r+4,r+4+n):""};var Ot=function(e,t){var r=Ht(e,t);return r>0?Ct(e,t+4,t+4+r):""};var At=Ot;var Nt,Mt;Nt=Mt=function(e,t){return ht(e,t)};var Lt=function e(t){return Array.isArray(t)};if(_e){mt=function(e,t,r){if(!Buffer.isBuffer(e))return yt(e,t,r);return e.toString("utf16le",t,r).replace(Oe,"")};bt=function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):wt(e,t,r)};Et=function e(t,r){if(!Buffer.isBuffer(t))return kt(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""};Tt=function e(t,r){if(!Buffer.isBuffer(t))return _t(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""};xt=function e(t,r){if(!Buffer.isBuffer(t))return Dt(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)};Rt=function e(t,r){if(!Buffer.isBuffer(t))return It(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)};Ot=function e(t,r){if(!Buffer.isBuffer(t))return At(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)};Ct=function e(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):St(t,r,n)};pt=function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):gt(e)};Ie=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):[].concat.apply([],e)};Nt=function e(t,r){if(Buffer.isBuffer(t))return t.readDoubleLE(r);return Mt(t,r)};Lt=function e(t){return Buffer.isBuffer(t)||Array.isArray(t)}}if(typeof cptable!=="undefined"){mt=function(e,t,r){return cptable.utils.decode(1200,e.slice(t,r)).replace(Oe,"")};Ct=function(e,t,r){return cptable.utils.decode(65001,e.slice(t,r))};Et=function(e,t){var r=Ht(e,t);return r>0?cptable.utils.decode(k,e.slice(t+4,t+4+r-1)):""};Tt=function(e,t){var r=Ht(e,t);return r>0?cptable.utils.decode(d,e.slice(t+4,t+4+r-1)):""};xt=function(e,t){var r=2*Ht(e,t);return r>0?cptable.utils.decode(1200,e.slice(t+4,t+4+r-1)):""};Rt=function(e,t){var r=Ht(e,t);return r>0?cptable.utils.decode(1200,e.slice(t+4,t+4+r)):""};Ot=function(e,t){var r=Ht(e,t);return r>0?cptable.utils.decode(65001,e.slice(t+4,t+4+r)):""}}var Pt=function(e,t){return e[t]};var Ft=function(e,t){return e[t+1]*(1<<8)+e[t]};var Bt=function(e,t){var r=e[t+1]*(1<<8)+e[t];return r<32768?r:(65535-r+1)*-1};var Ht=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]};var $t=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]};var Wt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ut(e,t){var r="",n,i,a=[],o,s,l,u;switch(t){case"dbcs":u=this.l;if(_e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l){r+=String.fromCharCode(Ft(this,u));u+=2}e*=2;break;case"utf8":r=Ct(this,this.l,this.l+e);break;case"utf16le":e*=2;r=mt(this,this.l,this.l+e);break;case"wstr":if(typeof cptable!=="undefined")r=cptable.utils.decode(d,this.slice(this.l,this.l+2*e));else return Ut.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Et(this,this.l);e=4+Ht(this,this.l);break;case"lpstr-cp":r=Tt(this,this.l);e=4+Ht(this,this.l);break;case"lpwstr":r=xt(this,this.l);e=4+2*Ht(this,this.l);break;case"lpp4":e=4+Ht(this,this.l);r=Rt(this,this.l);if(e&2)e+=2;break;case"8lpp4":e=4+Ht(this,this.l);r=Ot(this,this.l);if(e&3)e+=4-(e&3);break;case"cstr":e=0;r="";while((o=Pt(this,this.l+e++))!==0)a.push(c(o));r=a.join("");break;case"_wstr":e=0;r="";while((o=Ft(this,this.l+e))!==0){a.push(c(o));e+=2}e+=2;r=a.join("");break;case"dbcs-cont":r="";u=this.l;for(l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1){o=Pt(this,u);this.l=u+1;s=Ut.call(this,e-l,o?"dbcs-cont":"sbcs-cont");return a.join("")+s}a.push(c(Ft(this,u)));u+=2}r=a.join("");e*=2;break;case"cpstr":if(typeof cptable!=="undefined"){r=cptable.utils.decode(d,this.slice(this.l,this.l+e));break};case"sbcs-cont":r="";u=this.l;for(l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1){o=Pt(this,u);this.l=u+1;s=Ut.call(this,e-l,o?"dbcs-cont":"sbcs-cont");return a.join("")+s}a.push(c(Pt(this,u)));u+=1}r=a.join("");break;default:switch(e){case 1:n=Pt(this,this.l);this.l++;return n;case 2:n=(t==="i"?Bt:Ft)(this,this.l);this.l+=2;return n;case 4:;case-4:if(t==="i"||(this[this.l+3]&128)===0){n=(e>0?$t:Wt)(this,this.l);this.l+=4;return n}else{i=Ht(this,this.l);this.l+=4}return i;case 8:;case-8:if(t==="f"){if(e==8)i=Nt(this,this.l);else i=Nt([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0);this.l+=8;return i}else e=8;case 16:r=bt(this,this.l,e);break}}this.l+=e;return r}var jt=function(e,t,r){e[r]=t&255;e[r+1]=t>>>8&255;e[r+2]=t>>>16&255;e[r+3]=t>>>24&255};var Vt=function(e,t,r){e[r]=t&255;e[r+1]=t>>8&255;e[r+2]=t>>16&255;e[r+3]=t>>24&255};var zt=function(e,t,r){e[r]=t&255;e[r+1]=t>>>8&255};function qt(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)zt(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){if(typeof cptable!=="undefined"&&k==874){for(i=0;i!=t.length;++i){var a=cptable.utils.encode(k,t.charAt(i));this[this.l+i]=a[0]}}else{t=t.replace(/[^\x00-\x7F]/g,"_");for(i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255}n=t.length}else if(r==="hex"){for(;i<e;++i){this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0}return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255;this[this.l++]=s>>8}while(this.l<o)this[this.l++]=0;return this}else switch(e){case 1:n=1;this[this.l]=t&255;break;case 2:n=2;this[this.l]=t&255;t>>>=8;this[this.l+1]=t&255;break;case 3:n=3;this[this.l]=t&255;t>>>=8;this[this.l+1]=t&255;t>>>=8;this[this.l+2]=t&255;break;case 4:n=4;jt(this,t,this.l);break;case 8:n=8;if(r==="f"){vt(this,t,this.l);break};case 16:break;case-4:n=4;Vt(this,t,this.l);break}this.l+=n;return this}function Yt(e,t){var r=bt(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Gt(e,t){e.l=t;e._R=Ut;e.chk=Yt;e._W=qt}function Xt(e,t){e.l+=t}function Kt(e){var t=xe(e);Gt(t,0);return t}function Jt(e,t,r){if(!e)return;var n,i,a;Gt(e,e.l||0);var o=e.length,s=0,l=0;while(e.l<o){s=e._R(1);if(s&128)s=(s&127)+((e._R(1)&127)<<7);var u=Ap[s]||Ap[65535];n=e._R(1);a=n&127;for(i=1;i<4&&n&128;++i)a+=((n=e._R(1))&127)<<7*i;l=e.l+a;var f=(u.f||Xt)(e,a,r);e.l=l;if(t(f,u.n,s))return}}function Qt(){var t=[],r=_e?256:2048;var n=function e(t){var r=Kt(t);Gt(r,0);return r};var i=n(r);var a=function e(){if(!i)return;if(i.length>i.l){i=i.slice(0,i.l);i.l=i.length}if(i.length>0)t.push(i);i=null};var o=function e(t){if(i&&t<i.length-i.l)return i;a();return i=n(Math.max(t+1,r))};var e=function e(){a();return pt([t])};var s=function e(t){a();i=t;if(i.l==null)i.l=i.length;o(r)};return{next:o,push:s,end:e,_bufs:t}}function Zt(e,t,r,n){var i=+Np[t],a;if(isNaN(i))return;if(!n)n=Ap[i].p||(r||[]).length||0;a=1+(i>=128?1:0)+1;if(n>=128)++a;if(n>=16384)++a;if(n>=2097152)++a;var o=e.next(a);if(i<=127)o._W(1,i);else{o._W(1,(i&127)+128);o._W(1,i>>7)}for(var s=0;s!=4;++s){if(n>=128){o._W(1,(n&127)+128);n>>=7}else{o._W(1,n);break}}if(n>0&&Lt(r))e.push(r)}function er(e,t,r){var n=oe(e);if(t.s){if(n.cRel)n.c+=t.s.c;if(n.rRel)n.r+=t.s.r}else{if(n.cRel)n.c+=t.c;if(n.rRel)n.r+=t.r}if(!r||r.biff<12){while(n.c>=256)n.c-=256;while(n.r>=65536)n.r-=65536}return n}function tr(e,t,r){var n=oe(e);n.s=er(n.s,t.s,r);n.e=er(n.e,t.s,r);return n}function rr(e,t){if(e.cRel&&e.c<0){e=oe(e);while(e.c<0)e.c+=t>8?16384:256}if(e.rRel&&e.r<0){e=oe(e);while(e.r<0)e.r+=t>8?1048576:t>5?65536:16384}var r=gr(e);if(!e.cRel&&e.cRel!=null)r=dr(r);if(!e.rRel&&e.rRel!=null)r=lr(r);return r}function nr(e,t){if(e.s.r==0&&!e.s.rRel){if(e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel){return(e.s.cRel?"":"$")+cr(e.s.c)+":"+(e.e.cRel?"":"$")+cr(e.e.c)}}if(e.s.c==0&&!e.s.cRel){if(e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel){return(e.s.rRel?"":"$")+sr(e.s.r)+":"+(e.e.rRel?"":"$")+sr(e.e.r)}}return rr(e.s,t.biff)+":"+rr(e.e,t.biff)}var ir={};var ar=function(e,t){var r;if(typeof t!=="undefined")r=t;else if(typeof require!=="undefined"){try{r=undefined}catch(e){r=null}}e.rc4=function(e,t){var r=new Array(256);var n=0,i=0,a=0,o=0;for(i=0;i!=256;++i)r[i]=i;for(i=0;i!=256;++i){a=a+r[i]+e[i%e.length].charCodeAt(0)&255;o=r[i];r[i]=r[a];r[a]=o}i=a=0;var s=xe(t.length);for(n=0;n!=t.length;++n){i=i+1&255;a=(a+r[i])%256;o=r[i];r[i]=r[a];r[a]=o;s[n]=t[n]^r[r[i]+r[a]&255]}return s};e.md5=function(e){if(!r)throw new Error("Unsupported crypto");return r.createHash("md5").update(e).digest("hex")}};ar(ir,typeof crypto!=="undefined"?crypto:undefined);function or(e){return parseInt(ur(e),10)-1}function sr(e){return""+(e+1)}function lr(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ur(e){return e.replace(/\$(\d+)$/,"$1")}function fr(e){var t=hr(e),r=0,n=0;for(;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function cr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function dr(e){return e.replace(/^([A-Z])/,"$$$1")}function hr(e){return e.replace(/^\$([A-Z])/,"$1")}function vr(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pr(e){var t=0,r=0;for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i>=48&&i<=57)t=10*t+(i-48);else if(i>=65&&i<=90)r=26*r+(i-64)}return{c:r-1,r:t-1}}function gr(e){var t=e.c+1;var r="";for(;t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function mr(e){var t=e.indexOf(":");if(t==-1)return{s:pr(e),e:pr(e)};return{s:pr(e.slice(0,t)),e:pr(e.slice(t+1))}}function yr(e,t){if(typeof t==="undefined"||typeof t==="number"){return yr(e.s,e.e)}if(typeof e!=="string")e=gr(e);if(typeof t!=="string")t=gr(t);return e==t?e:e+":"+t}function br(e){var t={s:{c:0,r:0},e:{c:0,r:0}};var r=0,n=0,i=0;var a=e.length;for(r=0;n<a;++n){if((i=e.charCodeAt(n)-64)<1||i>26)break;r=26*r+i}t.s.c=--r;for(r=0;n<a;++n){if((i=e.charCodeAt(n)-48)<0||i>9)break;r=10*r+i}t.s.r=--r;if(n===a||e.charCodeAt(++n)===58){t.e.c=t.s.c;t.e.r=t.s.r;return t}for(r=0;n!=a;++n){if((i=e.charCodeAt(n)-64)<1||i>26)break;r=26*r+i}t.e.c=--r;for(r=0;n!=a;++n){if((i=e.charCodeAt(n)-48)<0||i>9)break;r=10*r+i}t.e.r=--r;return t}function wr(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=me.format(e.z,r?Z(t):t)}catch(e){}try{return e.w=me.format((e.XF||{}).numFmtId||(r?14:0),r?Z(t):t)}catch(e){return""+t}}function Cr(e,t,r){if(e==null||e.t==null||e.t=="z")return"";if(e.w!==undefined)return e.w;if(e.t=="d"&&!e.z&&r&&r.dateNF)e.z=r.dateNF;if(t==undefined)return wr(e,e.v);return wr(e,t)}function Sr(e,t){var r=t&&t.sheet?t.sheet:"Sheet1";var n={};n[r]=e;return{SheetNames:[r],Sheets:n}}function Er(e,t,r){var n=r||{};var i=e?Array.isArray(e):n.dense;if(ge!=null&&i==null)i=ge;var a=e||(i?[]:{});var o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?pr(n.origin):n.origin;o=l.r;s=l.c}if(!a["!ref"])a["!ref"]="A1:A1"}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=br(a["!ref"]);u.s.c=f.s.c;u.s.r=f.s.r;u.e.c=Math.max(u.e.c,f.e.c);u.e.r=Math.max(u.e.r,f.e.r);if(o==-1)u.e.r=o=f.e.r+1}for(var c=0;c!=t.length;++c){if(!t[c])continue;if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[c].length;++d){if(typeof t[c][d]==="undefined")continue;var h={v:t[c][d]};var v=o+c,p=s+d;if(u.s.r>v)u.s.r=v;if(u.s.c>p)u.s.c=p;if(u.e.r<v)u.e.r=v;if(u.e.c<p)u.e.c=p;if(t[c][d]&&typeof t[c][d]==="object"&&!Array.isArray(t[c][d])&&!(t[c][d]instanceof Date))h=t[c][d];else{if(Array.isArray(h.v)){h.f=t[c][d][1];h.v=h.v[0]}if(h.v===null){if(h.f)h.t="n";else if(!n.sheetStubs)continue;else h.t="z"}else if(typeof h.v==="number")h.t="n";else if(typeof h.v==="boolean")h.t="b";else if(h.v instanceof Date){h.z=n.dateNF||me._table[14];if(n.cellDates){h.t="d";h.w=me.format(h.z,Z(h.v))}else{h.t="n";h.v=Z(h.v);h.w=me.format(h.z,h.v)}}else h.t="s"}if(i){if(!a[v])a[v]=[];if(a[v][p]&&a[v][p].z)h.z=a[v][p].z;a[v][p]=h}else{var g=gr({c:p,r:v});if(a[g]&&a[g].z)h.z=a[g].z;a[g]=h}}}if(u.s.c<1e7)a["!ref"]=yr(u);return a}function kr(e,t){return Er(null,e,t)}function Tr(e,t){if(!t)t=Kt(4);t._W(4,e);return t}function _r(e){var t=e._R(4);return t===0?"":e._R(t,"dbcs")}function xr(e,t){var r=false;if(t==null){r=true;t=Kt(4+2*e.length)}t._W(4,e.length);if(e.length>0)t._W(0,e,"dbcs");return r?t.slice(0,t.l):t}function Dr(e){return{ich:e._R(2),ifnt:e._R(2)}}function Rr(e,t){if(!t)t=Kt(4);t._W(2,e.ich||0);t._W(2,e.ifnt||0);return t}function Ir(e,t){var r=e.l;var n=e._R(1);var i=_r(e);var a=[];var o={t:i,h:i};if((n&1)!==0){var s=e._R(4);for(var l=0;l!=s;++l)a.push(Dr(e));o.r=a}else o.r=[{ich:0,ifnt:0}];e.l=r+t;return o}function Or(e,t){var r=false;if(t==null){r=true;t=Kt(15+4*e.t.length)}t._W(1,0);xr(e.t,t);return r?t.slice(0,t.l):t}var Ar=Ir;function Nr(e,t){var r=false;if(t==null){r=true;t=Kt(23+4*e.t.length)}t._W(1,1);xr(e.t,t);t._W(4,1);Rr({ich:0,ifnt:0},t);return r?t.slice(0,t.l):t}function Mr(e){var t=e._R(4);var r=e._R(2);r+=e._R(1)<<16;e.l++;return{c:t,iStyleRef:r}}function Lr(e,t){if(t==null)t=Kt(8);t._W(-4,e.c);t._W(3,e.iStyleRef||e.s);t._W(1,0);return t}var Pr=_r;var Fr=xr;function Br(e){var t=e._R(4);return t===0||t===4294967295?"":e._R(t,"dbcs")}function Hr(e,t){var r=false;if(t==null){r=true;t=Kt(127)}t._W(4,e.length>0?e.length:4294967295);if(e.length>0)t._W(0,e,"dbcs");return r?t.slice(0,t.l):t}var $r=_r;var Wr=Br;var Ur=Hr;function jr(e){var t=e.slice(e.l,e.l+4);var r=t[0]&1,n=t[0]&2;e.l+=4;t[0]&=252;var i=n===0?Nt([0,0,0,0,t[0],t[1],t[2],t[3]],0):$t(t,0)>>2;return r?i/100:i}function Vr(e,t){if(t==null)t=Kt(4);var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29){n=1}else if(i==(i|0)&&i>=-(1<<29)&&i<1<<29){n=1;r=1}if(n)t._W(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function zr(e){var t={s:{},e:{}};t.s.r=e._R(4);t.e.r=e._R(4);t.s.c=e._R(4);t.e.c=e._R(4);return t}function qr(e,t){if(!t)t=Kt(16);t._W(4,e.s.r);t._W(4,e.e.r);t._W(4,e.s.c);t._W(4,e.e.c);return t}var Yr=zr;var Gr=qr;function Xr(e){return e._R(8,"f")}function Kr(e,t){return(t||Kt(8))._W(8,e,"f")}function Jr(e){var t={};var r=e._R(1);var n=r>>>1;var i=e._R(1);var a=e._R(2,"i");var o=e._R(1);var s=e._R(1);var l=e._R(1);e.l++;switch(n){case 0:t.auto=1;break;case 1:t.index=i;var u=xn[i];if(u)t.rgb=sl(u);break;case 2:t.rgb=sl([o,s,l]);break;case 3:t.theme=i;break}if(a!=0)t.tint=a>0?a/32767:a/32768;return t}function Qr(e,t){if(!t)t=Kt(8);if(!e||e.auto){t._W(4,0);t._W(4,0);return t}if(e.index!=null){t._W(1,2);t._W(1,e.index)}else if(e.theme!=null){t._W(1,6);t._W(1,e.theme)}else{t._W(1,5);t._W(1,0)}var r=e.tint||0;if(r>0)r*=32767;else if(r<0)r*=32768;t._W(2,r);if(!e.rgb||e.theme!=null){t._W(2,0);t._W(1,0);t._W(1,0)}else{var n=e.rgb||"FFFFFF";if(typeof n=="number")n=("000000"+n.toString(16)).slice(-6);t._W(1,parseInt(n.slice(0,2),16));t._W(1,parseInt(n.slice(2,4),16));t._W(1,parseInt(n.slice(4,6),16));t._W(1,255)}return t}function Zr(e){var t=e._R(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function en(e,t){if(!t)t=Kt(2);var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t._W(1,r);t._W(1,0);return t}function tn(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"};var n=e._R(4);switch(n){case 0:return"";case 4294967295:;case 4294967294:return r[e._R(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));e.l-=4;return e._R(0,t==1?"lpstr":"lpwstr")}function rn(e){return tn(e,1)}function nn(e){return tn(e,2)}var an=2;var on=3;var sn=11;var ln=12;var un=19;var fn=30;var cn=64;var dn=65;var hn=71;var vn=4096;var pn=80;var gn=81;var mn=[pn,gn];var yn={1:{n:"CodePage",t:an},2:{n:"Category",t:pn},3:{n:"PresentationFormat",t:pn},4:{n:"ByteCount",t:on},5:{n:"LineCount",t:on},6:{n:"ParagraphCount",t:on},7:{n:"SlideCount",t:on},8:{n:"NoteCount",t:on},9:{n:"HiddenCount",t:on},10:{n:"MultimediaClipCount",t:on},11:{n:"ScaleCrop",t:sn},12:{n:"HeadingPairs",t:vn|ln},13:{n:"TitlesOfParts",t:vn|fn},14:{n:"Manager",t:pn},15:{n:"Company",t:pn},16:{n:"LinksUpToDate",t:sn},17:{n:"CharacterCount",t:on},19:{n:"SharedDoc",t:sn},22:{n:"HyperlinksChanged",t:sn},23:{n:"AppVersion",t:on,p:"version"},24:{n:"DigSig",t:dn},26:{n:"ContentType",t:pn},27:{n:"ContentStatus",t:pn},28:{n:"Language",t:pn},29:{n:"Version",t:pn},255:{}};var bn={1:{n:"CodePage",t:an},2:{n:"Title",t:pn},3:{n:"Subject",t:pn},4:{n:"Author",t:pn},5:{n:"Keywords",t:pn},6:{n:"Comments",t:pn},7:{n:"Template",t:pn},8:{n:"LastAuthor",t:pn},9:{n:"RevNumber",t:pn},10:{n:"EditTime",t:cn},11:{n:"LastPrinted",t:cn},12:{n:"CreatedDate",t:cn},13:{n:"ModifiedDate",t:cn},14:{n:"PageCount",t:on},15:{n:"WordCount",t:on},16:{n:"CharCount",t:on},17:{n:"Thumbnail",t:hn},18:{n:"Application",t:pn},19:{n:"DocSecurity",t:on},255:{}};var wn={2147483648:{n:"Locale",t:un},2147483651:{n:"Behavior",t:un},1919054434:{}};(function(){for(var e in wn)if(Object.prototype.hasOwnProperty.call(wn,e))yn[e]=bn[e]=wn[e]})();var Cn=R(yn,"n");var Sn=R(bn,"n");var En={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"};var kn=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Tn(e){return e.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var _n=Tn([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var xn=oe(_n);var Dn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var Rn=O(Dn);var In={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var On=function(){var r={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};ye(r).forEach(function(t){["xlsm","xlam"].forEach(function(e){if(!r[t][e])r[t][e]=r[t].xlsx})});ye(r).forEach(function(t){ye(r[t]).forEach(function(e){In[r[t][e]]=t})});return r}();var An=A(In);ct.CT="http://schemas.openxmlformats.org/package/2006/content-types";function Nn(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""}}function Mn(e){var r=Nn();if(!e||!e.match)return r;var n={};(e.match(we)||[]).forEach(function(e){var t=Ee(e);switch(t[0].replace(Ce,"<")){case"<?xml":break;case"<Types":r.xmlns=t["xmlns"+(t[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[t.Extension]=t.ContentType;break;case"<Override":if(r[In[t.ContentType]]!==undefined)r[In[t.ContentType]].push(t.PartName);break}});if(r.xmlns!==ct.CT)throw new Error("Unknown Namespace: "+r.xmlns);r.calcchain=r.calcchains.length>0?r.calcchains[0]:"";r.sst=r.strs.length>0?r.strs[0]:"";r.style=r.styles.length>0?r.styles[0]:"";r.defaults=n;delete r.calcchains;return r}var Ln=lt("Types",null,{xmlns:ct.CT,"xmlns:xsd":ct.xsd,"xmlns:xsi":ct.xsi});var Pn=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",An.rels[0]]].map(function(e){return lt("Default",null,{Extension:e[0],ContentType:e[1]})});function Fn(r,n){var i=[],t;i[i.length]=ve;i[i.length]=Ln;i=i.concat(Pn);var e=function(e){if(r[e]&&r[e].length>0){t=r[e][0];i[i.length]=lt("Override",null,{PartName:(t[0]=="/"?"":"/")+t,ContentType:On[e][n.bookType||"xlsx"]})}};var a=function(t){(r[t]||[]).forEach(function(e){i[i.length]=lt("Override",null,{PartName:(e[0]=="/"?"":"/")+e,ContentType:On[t][n.bookType||"xlsx"]})})};var o=function(t){(r[t]||[]).forEach(function(e){i[i.length]=lt("Override",null,{PartName:(e[0]=="/"?"":"/")+e,ContentType:An[t][0]})})};e("workbooks");a("sheets");a("charts");o("themes");["strs","styles"].forEach(e);["coreprops","extprops","custprops"].forEach(o);o("vba");o("comments");o("drawings");if(i.length>2){i[i.length]="</Types>";i[1]=i[1].replace("/>",">")}return i.join("")}var Bn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Hn(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function $n(e,i){var a={"!id":{}};if(!e)return a;if(i.charAt(0)!=="/"){i="/"+i}var o={};(e.match(we)||[]).forEach(function(e){var t=Ee(e);if(t[0]==="<Relationship"){var r={};r.Type=t.Type;r.Target=t.Target;r.Id=t.Id;r.TargetMode=t.TargetMode;var n=t.TargetMode==="External"?t.Target:he(t.Target,i);a[n]=r;o[t.Id]=r}});a["!id"]=o;return a}ct.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var Wn=lt("Relationships",null,{xmlns:ct.RELS});function Un(t){var r=[ve,Wn];ye(t["!id"]).forEach(function(e){r[r.length]=lt("Relationship",null,t["!id"][e])});if(r.length>2){r[r.length]="</Relationships>";r[1]=r[1].replace("/>",">")}return r.join("")}var jn=[Bn.HLINK,Bn.XPATH,Bn.XMISS];function Vn(e,t,r,n,i,a){if(!i)i={};if(!e["!id"])e["!id"]={};if(t<0)for(t=1;e["!id"]["rId"+t];++t){}i.Id="rId"+t;i.Type=n;i.Target=r;if(a)i.TargetMode=a;else if(jn.indexOf(i.Type)>-1)i.TargetMode="External";if(e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);e["!id"][i.Id]=i;e[("/"+i.Target).replace("//","/")]=i;return t}var zn="application/vnd.oasis.opendocument.spreadsheet";function qn(e,t){var r=ap(e);var n;var i;while(n=op.exec(r))switch(n[3]){case"manifest":break;case"file-entry":i=Ee(n[0],false);if(i.path=="/"&&i.type!==zn)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":;case"algorithm":;case"start-key-generation":;case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Yn(e){var t=[ve];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n');t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');t.push("</manifest:manifest>");return t.join("")}function Gn(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Xn(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Kn(e){var t=[ve];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r){t.push(Gn(e[r][0],e[r][1]));t.push(Xn("",e[r][0]))}t.push(Gn("","Document","pkg"));t.push("</rdf:RDF>");return t.join("")}var Jn=function(){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>Sheet'+"JS "+n.version+"</meta:generator></office:meta></office:document-meta>";return function e(){return t}}();var Qn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];ct.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";Bn.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var Zn=function(){var e=new Array(Qn.length);for(var t=0;t<Qn.length;++t){var r=Qn[t];var n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function ei(e){var t={};e=Ge(e);for(var r=0;r<Qn.length;++r){var n=Qn[r],i=e.match(Zn[r]);if(i!=null&&i.length>0)t[n[1]]=Fe(i[1]);if(n[2]==="date"&&t[n[1]])t[n[1]]=ae(t[n[1]])}return t}var ti=lt("cp:coreProperties",null,{"xmlns:cp":ct.CORE_PROPS,"xmlns:dc":ct.dc,"xmlns:dcterms":ct.dcterms,"xmlns:dcmitype":ct.dcmitype,"xmlns:xsi":ct.xsi});function ri(e,t,r,n,i){if(i[e]!=null||t==null||t==="")return;i[e]=t;t=$e(t);n[n.length]=r?lt(e,t,r):ot(e,t)}function ni(e,t){var r=t||{};var n=[ve,ti],i={};if(!e&&!r.Props)return n.join("");if(e){if(e.CreatedDate!=null)ri("dcterms:created",typeof e.CreatedDate==="string"?e.CreatedDate:ut(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i);if(e.ModifiedDate!=null)ri("dcterms:modified",typeof e.ModifiedDate==="string"?e.ModifiedDate:ut(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i)}for(var a=0;a!=Qn.length;++a){var o=Qn[a];var s=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;if(s===true)s="1";else if(s===false)s="0";else if(typeof s=="number")s=String(s);if(s!=null)ri(o[0],s,null,n,i)}if(n.length>2){n[n.length]="</cp:coreProperties>";n[1]=n[1].replace("/>",">")}return n.join("")}var ii=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];ct.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";Bn.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";var ai=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function oi(e,t,r,n){var i=[];if(typeof e=="string")i=it(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(e){return{v:e}}));var o=typeof t=="string"?it(t,n).map(function(e){return e.v}):t;var s=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){l=+i[u+1].v;switch(i[u].v){case"Worksheets":;case"å·¥ä½è¡¨":;case"ÐÐ¸ÑÑÑ":;case"Ø£ÙØ±Ø§Ù Ø§ÙØ¹ÙÙ":;case"ã¯ã¼ã¯ã·ã¼ã":;case"××××× ××ª ×¢××××":;case"ArbeitsblÃ¤tter":;case"ÃalÄ±Åma SayfalarÄ±":;case"Feuilles de calcul":;case"Fogli di lavoro":;case"Folhas de cÃ¡lculo":;case"Planilhas":;case"Regneark":;case"Hojas de cÃ¡lculo":;case"Werkbladen":r.Worksheets=l;r.SheetNames=o.slice(s,s+l);break;case"Named Ranges":;case"Rangos con nombre":;case"ååä»ãä¸è¦§":;case"Benannte Bereiche":;case"Navngivne omrÃ¥der":r.NamedRanges=l;r.DefinedNames=o.slice(s,s+l);break;case"Charts":;case"Diagramme":r.Chartsheets=l;r.ChartNames=o.slice(s,s+l);break}s+=l}}function si(n,i,e){var a={};if(!i)i={};n=Ge(n);ii.forEach(function(e){var t=(n.match(Ze(e[0]))||[])[1];switch(e[2]){case"string":if(t)i[e[1]]=Fe(t);break;case"bool":i[e[1]]=t==="true";break;case"raw":var r=n.match(new RegExp("<"+e[0]+"[^>]*>([\\s\\S]*?)</"+e[0]+">"));if(r&&r.length>0)a[e[1]]=r[1];break}});if(a.HeadingPairs&&a.TitlesOfParts)oi(a.HeadingPairs,a.TitlesOfParts,i,e);return i}var li=lt("Properties",null,{xmlns:ct.EXT_PROPS,"xmlns:vt":ct.vt});function ui(r){var n=[],i=lt;if(!r)r={};r.Application="SheetJS";n[n.length]=ve;n[n.length]=li;ii.forEach(function(e){if(r[e[1]]===undefined)return;var t;switch(e[2]){case"string":t=$e(String(r[e[1]]));break;case"bool":t=r[e[1]]?"true":"false";break}if(t!==undefined)n[n.length]=i(e[0],t)});n[n.length]=i("HeadingPairs",i("vt:vector",i("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+i("vt:variant",i("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"}));n[n.length]=i("TitlesOfParts",i("vt:vector",r.SheetNames.map(function(e){return"<vt:lpstr>"+$e(e)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"}));if(n.length>2){n[n.length]="</Properties>";n[1]=n[1].replace("/>",">")}return n.join("")}ct.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";Bn.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var fi=/<[^>]+>[^<]*/g;function ci(e,t){var r={},n="";var i=e.match(fi);if(i)for(var a=0;a!=i.length;++a){var o=i[a],s=Ee(o);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Fe(s.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">");var u=l[0].slice(4),f=l[1];switch(u){case"lpstr":;case"bstr":;case"lpwstr":r[n]=Fe(f);break;case"bool":r[n]=Ye(f);break;case"i1":;case"i2":;case"i4":;case"i8":;case"int":;case"uint":r[n]=parseInt(f,10);break;case"r4":;case"r8":;case"decimal":r[n]=parseFloat(f);break;case"filetime":;case"date":r[n]=ae(f);break;case"cy":;case"error":r[n]=Fe(f);break;default:if(u.slice(-1)=="/")break;if(t.WTF&&typeof console!=="undefined")console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)==="</"){}else if(t.WTF)throw new Error(o)}}return r}var di=lt("Properties",null,{xmlns:ct.CUST_PROPS,"xmlns:vt":ct.vt});function hi(r){var n=[ve,di];if(!r)return n.join("");var i=1;ye(r).forEach(function e(t){++i;n[n.length]=lt("property",ft(r[t],true),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:i,name:$e(t)})});if(n.length>2){n[n.length]="</Properties>";n[1]=n[1].replace("/>",">")}return n.join("")}var vi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};var pi=I(vi);function gi(e,t,r){t=pi[t]||t;e[t]=r}function mi(r,n){var i=[];ye(vi).map(function(e){for(var t=0;t<Qn.length;++t)if(Qn[t][1]==e)return Qn[t];for(t=0;t<ii.length;++t)if(ii[t][1]==e)return ii[t];throw e}).forEach(function(e){if(r[e[1]]==null)return;var t=n&&n.Props&&n.Props[e[1]]!=null?n.Props[e[1]]:r[e[1]];switch(e[2]){case"date":t=new Date(t).toISOString().replace(/\.\d*Z/,"Z");break}if(typeof t=="number")t=String(t);else if(t===true||t===false){t=t?"1":"0"}else if(t instanceof Date)t=new Date(t).toISOString().replace(/\.\d*Z/,"");i.push(ot(vi[e[1]]||e[1],t))});return lt("DocumentProperties",i.join(""),{xmlns:dt.o})}function yi(i,n){var a=["Worksheets","SheetNames"];var e="CustomDocumentProperties";var o=[];if(i)ye(i).forEach(function(e){if(!Object.prototype.hasOwnProperty.call(i,e))return;for(var t=0;t<Qn.length;++t)if(e==Qn[t][1])return;for(t=0;t<ii.length;++t)if(e==ii[t][1])return;for(t=0;t<a.length;++t)if(e==a[t])return;var r=i[e];var n="string";if(typeof r=="number"){n="float";r=String(r)}else if(r===true||r===false){n="boolean";r=r?"1":"0"}else r=String(r);o.push(lt(We(e),r,{"dt:dt":n}))});if(n)ye(n).forEach(function(e){if(!Object.prototype.hasOwnProperty.call(n,e))return;if(i&&Object.prototype.hasOwnProperty.call(i,e))return;var t=n[e];var r="string";if(typeof t=="number"){r="float";t=String(t)}else if(t===true||t===false){r="boolean";t=t?"1":"0"}else if(t instanceof Date){r="dateTime.tz";t=t.toISOString()}else t=String(t);o.push(lt(We(e),t,{"dt:dt":r}))});return"<"+e+' xmlns="'+dt.o+'">'+o.join("")+"</"+e+">"}function bi(e){var t=e._R(4),r=e._R(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function wi(e){var t=typeof e=="string"?new Date(Date.parse(e)):e;var r=t.getTime()/1e3+11644473600;var n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7;i*=1e7;var a=n/Math.pow(2,32)|0;if(a>0){n=n%Math.pow(2,32);i+=a}var o=Kt(8);o._W(4,n);o._W(4,i);return o}function Ci(e,t,r){var n=e.l;var i=e._R(0,"lpstr-cp");if(r)while(e.l-n&3)++e.l;return i}function Si(e,t,r){var n=e._R(0,"lpwstr");if(r)e.l+=4-(n.length+1&3)&3;return n}function Ei(e,t,r){if(t===31)return Si(e);return Ci(e,t,r)}function ki(e,t,r){return Ei(e,t,r===false?0:4)}function Ti(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ei(e,t,0)}function _i(e){var t=e._R(4);var r=[];for(var n=0;n!=t;++n)r[n]=e._R(0,"lpstr-cp").replace(Oe,"");return r}function xi(e){return _i(e)}function Di(e){var t=Mi(e,gn);var r=Mi(e,on);return[t,r]}function Ri(e){var t=e._R(4);var r=[];for(var n=0;n!=t/2;++n)r.push(Di(e));return r}function Ii(e){return Ri(e)}function Oi(e,t){var r=e._R(4);var n={};for(var i=0;i!=r;++i){var a=e._R(4);var o=e._R(4);n[a]=e._R(o,t===1200?"utf16le":"utf8").replace(Oe,"").replace(Ae,"!");if(t===1200&&o%2)e.l+=2}if(e.l&3)e.l=e.l>>2+1<<2;return n}function Ai(e){var t=e._R(4);var r=e.slice(e.l,e.l+t);e.l+=t;if((t&3)>0)e.l+=4-(t&3)&3;return r}function Ni(e){var t={};t.Size=e._R(4);e.l+=t.Size+3-(t.Size-1)%4;return t}function Mi(e,t,r){var n=e._R(2),i,a=r||{};e.l+=2;if(t!==ln)if(n!==t&&mn.indexOf(t)===-1)throw new Error("Expected type "+t+" saw "+n);switch(t===ln?n:t){case 2:i=e._R(2,"i");if(!a.raw)e.l+=2;return i;case 3:i=e._R(4,"i");return i;case 11:return e._R(4)!==0;case 19:i=e._R(4);return i;case 30:return Ci(e,n,4).replace(Oe,"");case 31:return Si(e);case 64:return bi(e);case 65:return Ai(e);case 71:return Ni(e);case 80:return ki(e,n,!a.raw).replace(Oe,"");case 81:return Ti(e,n).replace(Oe,"");case 4108:return Ii(e);case 4126:return xi(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Li(e,t){var r=Kt(4),n=Kt(4);r._W(4,e==80?31:e);switch(e){case 3:n._W(-4,t);break;case 5:n=Kt(8);n._W(8,t,"f");break;case 11:n._W(4,t?1:0);break;case 64:n=wi(t);break;case 31:;case 80:n=Kt(4+2*(t.length+1)+(t.length%2?0:2));n._W(4,t.length+1);n._W(0,t,"dbcs");while(n.l!=n.length)n._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ie([r,n])}function Pi(e,t){var r=e.l;var n=e._R(4);var i=e._R(4);var a=[],o=0;var s=0;var l=-1,u={};for(o=0;o!=i;++o){var f=e._R(4);var c=e._R(4);a[o]=[f,c+r]}a.sort(function(e,t){return e[1]-t[1]});var d={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var h=true;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:if(e.l+2===a[o][1]){e.l+=2;h=false}break;case 80:if(e.l<=a[o][1]){e.l=a[o][1];h=false}break;case 4108:if(e.l<=a[o][1]){e.l=a[o][1];h=false}break}if((!t||o==0)&&e.l<=a[o][1]){h=false;e.l=a[o][1]}if(h)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[a[o][0]];d[v.n]=Mi(e,v.t,{raw:true});if(v.p==="version")d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4);if(v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:;case 932:;case 936:;case 949:;case 950:;case 1250:;case 1251:;case 1253:;case 1254:;case 1255:;case 1256:;case 1257:;case 1258:;case 1e4:;case 1200:;case 1201:;case 1252:;case 65e3:;case-536:;case 65001:;case-535:pe(s=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else{if(a[o][0]===1){s=d.CodePage=Mi(e,an);pe(s);if(l!==-1){var p=e.l;e.l=a[l][1];u=Oi(e,s);e.l=p}}else if(a[o][0]===0){if(s===0){l=o;e.l=a[o+1][1];continue}u=Oi(e,s)}else{var g=u[a[o][0]];var m;switch(e[e.l]){case 65:e.l+=4;m=Ai(e);break;case 30:e.l+=4;m=ki(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4;m=ki(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4;m=e._R(4,"i");break;case 19:e.l+=4;m=e._R(4);break;case 5:e.l+=4;m=e._R(8,"f");break;case 11:e.l+=4;m=zi(e,4);break;case 64:e.l+=4;m=ae(bi(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=m}}}e.l=r+n;return d}var Fi=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(ai);function Bi(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Hi(e,t,r){var n=Kt(8),i=[],a=[];var o=8,s=0;var l=Kt(8),u=Kt(8);l._W(4,2);l._W(4,1200);u._W(4,1);a.push(l);i.push(u);o+=8+l.length;if(!t){u=Kt(8);u._W(4,0);i.unshift(u);var f=[Kt(4)];f[0]._W(4,e.length);for(s=0;s<e.length;++s){var c=e[s][0];l=Kt(4+4+2*(c.length+1)+(c.length%2?0:2));l._W(4,s+2);l._W(4,c.length+1);l._W(0,c,"dbcs");while(l.l!=l.length)l._W(1,0);f.push(l)}l=Ie(f);a.unshift(l);o+=8+l.length}for(s=0;s<e.length;++s){if(t&&!t[e[s][0]])continue;if(Fi.indexOf(e[s][0])>-1)continue;if(e[s][1]==null)continue;var d=e[s][1],h=0;if(t){h=+t[e[s][0]];var v=r[h];if(v.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}l=Li(v.t,d)}else{var g=Bi(d);if(g==-1){g=31;d=String(d)}l=Li(g,d)}a.push(l);u=Kt(8);u._W(4,!t?2+s:h);i.push(u);o+=8+l.length}var m=8*(a.length+1);for(s=0;s<a.length;++s){i[s]._W(4,m);m+=a[s].length}n._W(4,o);n._W(4,a.length);return Ie([n].concat(i).concat(a))}function $i(e,t,r){var n=e.content;if(!n)return{};Gt(n,0);var i,a,o,s,l=0;n.chk("feff","Byte Order: ");n._R(2);var u=n._R(4);var f=n._R(16);if(f!==Me.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);i=n._R(4);if(i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);a=n._R(16);s=n._R(4);if(i===1&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);else if(i===2){o=n._R(16);l=n._R(4)}var c=Pi(n,t);var d={SystemIdentifier:u};for(var h in c)d[h]=c[h];d.FMTID=a;if(i===1)return d;if(l-n.l==2)n.l+=2;if(n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=Pi(n,null)}catch(e){}for(h in v)d[h]=v[h];d.FMTID=[a,o];return d}function Wi(e,t,r,n,i,a){var o=Kt(i?68:48);var s=[o];o._W(2,65534);o._W(2,0);o._W(4,842412599);o._W(16,Me.utils.consts.HEADER_CLSID,"hex");o._W(4,i?2:1);o._W(16,t,"hex");o._W(4,i?68:48);var l=Hi(e,r,n);s.push(l);if(i){var u=Hi(i,null,null);o._W(16,a,"hex");o._W(4,68+l.length);s.push(u)}return Ie(s)}function Ui(e,t){e._R(t);return null}function ji(e,t){if(!t)t=Kt(e);for(var r=0;r<e;++r)t._W(1,0);return t}function Vi(e,t,r){var n=[],i=e.l+t;while(e.l<i)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function zi(e,t){return e._R(t)===1}function qi(e,t){if(!t)t=Kt(2);t._W(2,+!!e);return t}function Yi(e){return e._R(2,"u")}function Gi(e,t){if(!t)t=Kt(2);t._W(2,e);return t}function Xi(e,t){return Vi(e,t,Yi)}function Ki(e){var t=e._R(1),r=e._R(1);return r===1?t:t===1}function Ji(e,t,r){if(!r)r=Kt(2);r._W(1,+e);r._W(1,t=="e"?1:0);return r}function Qi(e,t,r){var n=e._R(r&&r.biff>=12?2:1);var i="sbcs-cont";var a=d;if(r&&r.biff>=8)d=1200;if(!r||r.biff==8){var o=e._R(1);if(o){i="dbcs-cont"}}else if(r.biff==12){i="wstr"}if(r.biff>=2&&r.biff<=5)i="cpstr";var s=n?e._R(n,i):"";d=a;return s}function Zi(e){var t=d;d=1200;var r=e._R(2),n=e._R(1);var i=n&4,a=n&8;var o=1+(n&1);var s=0,l;var u={};if(a)s=e._R(2);if(i)l=e._R(4);var f=o==2?"dbcs-cont":"sbcs-cont";var c=r===0?"":e._R(r,f);if(a)e.l+=4*s;if(i)e.l+=l;u.t=c;if(!a){u.raw="<t>"+u.t+"</t>";u.r=u.t}d=t;return u}function ea(e){var t=e.t||"",r=1;var n=Kt(3+(r>1?2:0));n._W(2,t.length);n._W(1,(r>1?8:0)|1);if(r>1)n._W(2,r);var i=Kt(2*t.length);i._W(2*t.length,t,"utf16le");var a=[n,i];return Ie(a)}function ta(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e._R(t,"cpstr");if(r.biff>=12)return e._R(t,"dbcs-cont")}var i=e._R(1);if(i===0){n=e._R(t,"sbcs-cont")}else{n=e._R(t,"dbcs-cont")}return n}function ra(e,t,r){var n=e._R(r&&r.biff==2?1:2);if(n===0){e.l++;return""}return ta(e,n,r)}function na(e,t,r){if(r.biff>5)return ra(e,t,r);var n=e._R(1);if(n===0){e.l++;return""}return e._R(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ia(e,t,r){if(!r)r=Kt(3+2*e.length);r._W(2,e.length);r._W(1,1);r._W(31,e,"utf16le");return r}function aa(e){var t=e._R(1);e.l++;var r=e._R(2);e.l+=2;return[t,r]}function oa(e){var t=e._R(4),r=e.l;var n=false;if(t>24){e.l+=t-24;if(e._R(16)==="795881f43b1d7f48af2c825dc4852763")n=true;e.l=r}var i=e._R((n?t-24:t)>>1,"utf16le").replace(Oe,"");if(n)e.l+=24;return i}function sa(e){e.l+=2;var t=e._R(0,"lpstr-ansi");e.l+=2;if(e._R(2)!=57005)throw new Error("Bad FileMoniker");var r=e._R(4);if(r===0)return t.replace(/\\/g,"/");var n=e._R(4);if(e._R(2)!=3)throw new Error("Bad FileMoniker");var i=e._R(n>>1,"utf16le").replace(Oe,"");return i}function la(e,t){var r=e._R(16);t-=16;switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return oa(e,t);case"0303000000000000c000000000000046":return sa(e,t);default:throw new Error("Unsupported Moniker "+r)}}function ua(e){var t=e._R(4);var r=t>0?e._R(t,"utf16le").replace(Oe,""):"";return r}function fa(e,t){var r=e.l+t;var n=e._R(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e._R(2);e.l+=2;var a,o,s,l,u="",f,c;if(i&16)a=ua(e,r-e.l);if(i&128)o=ua(e,r-e.l);if((i&257)===257)s=ua(e,r-e.l);if((i&257)===1)l=la(e,r-e.l);if(i&8)u=ua(e,r-e.l);if(i&32)f=e._R(16);if(i&64)c=bi(e);e.l=r;var d=o||s||l||"";if(d&&u)d+="#"+u;if(!d)d="#"+u;var h={Target:d};if(f)h.guid=f;if(c)h.time=c;if(a)h.Tooltip=a;return h}function ca(e){var t=Kt(512),r=0;var n=e.Target;var i=n.indexOf("#")>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=~2;break}t._W(4,2);t._W(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t._W(4,a[r]);if(i==28){n=n.slice(1);t._W(4,n.length+1);for(r=0;r<n.length;++r)t._W(2,n.charCodeAt(r));t._W(2,0)}else if(i&2){a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");for(r=0;r<a.length;++r)t._W(1,parseInt(a[r],16));t._W(4,2*(n.length+1));for(r=0;r<n.length;++r)t._W(2,n.charCodeAt(r));t._W(2,0)}else{a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" ");for(r=0;r<a.length;++r)t._W(1,parseInt(a[r],16));var o=0;while(n.slice(o*3,o*3+3)=="../"||n.slice(o*3,o*3+3)=="..\\")++o;t._W(2,o);t._W(4,n.length+1);for(r=0;r<n.length;++r)t._W(1,n.charCodeAt(r)&255);t._W(1,0);t._W(2,65535);t._W(2,57005);for(r=0;r<6;++r)t._W(4,0)}return t.slice(0,t.l)}function da(e){var t=e._R(1),r=e._R(1),n=e._R(1),i=e._R(1);return[t,r,n,i]}function ha(e,t){var r=da(e,t);r[3]=0;return r}function va(e){var t=e._R(2);var r=e._R(2);var n=e._R(2);return{r:t,c:r,ixfe:n}}function pa(e,t,r,n){if(!n)n=Kt(6);n._W(2,e);n._W(2,t);n._W(2,r||0);return n}function ga(e){var t=e._R(2);var r=e._R(2);e.l+=8;return{type:t,flags:r}}function ma(e,t,r){return t===0?"":na(e,t,r)}function ya(e,t,r){var n=r.biff>8?4:2;var i=e._R(n),a=e._R(n,"i"),o=e._R(n,"i");return[i,a,o]}function ba(e){var t=e._R(2);var r=jr(e);return[t,r]}function wa(e,t,r){e.l+=4;t-=4;var n=e.l+t;var i=Qi(e,t,r);var a=e._R(2);n-=e.l;if(a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);e.l+=a;return i}function Ca(e){var t=e._R(2);var r=e._R(2);var n=e._R(2);var i=e._R(2);return{s:{c:n,r:t},e:{c:i,r:r}}}function Sa(e,t){if(!t)t=Kt(8);t._W(2,e.s.r);t._W(2,e.e.r);t._W(2,e.s.c);t._W(2,e.e.c);return t}function Ea(e){var t=e._R(2);var r=e._R(2);var n=e._R(1);var i=e._R(1);return{s:{c:n,r:t},e:{c:i,r:r}}}var ka=Ea;function Ta(e){e.l+=4;var t=e._R(2);var r=e._R(2);var n=e._R(2);e.l+=12;return[r,t,n]}function _a(e){var t={};e.l+=4;e.l+=16;t.fSharedNote=e._R(2);e.l+=4;return t}function xa(e){var t={};e.l+=4;e.cf=e._R(2);return t}function Da(e){e.l+=2;e.l+=e._R(2)}var Ra={0:Da,4:Da,5:Da,6:Da,7:xa,8:Da,9:Da,10:Da,11:Da,12:Da,13:_a,14:Da,15:Da,16:Da,17:Da,18:Da,19:Da,20:Da,21:Ta};function Ia(t,e){var r=t.l+e;var n=[];while(t.l<r){var i=t._R(2);t.l-=2;try{n.push(Ra[i](t,r-t.l))}catch(e){t.l=r;return n}}if(t.l!=r)t.l=r;return n}function Oa(e,t){var r={BIFFVer:0,dt:0};r.BIFFVer=e._R(2);t-=2;if(t>=2){r.dt=e._R(2);e.l-=2}switch(r.BIFFVer){case 1536:;case 1280:;case 1024:;case 768:;case 512:;case 2:;case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}e._R(t);return r}function Aa(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280;i=8;break;case"biff4":n=4;i=6;break;case"biff3":n=3;i=6;break;case"biff2":n=2;i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Kt(i);a._W(2,n);a._W(2,t);if(i>4)a._W(2,29282);if(i>6)a._W(2,1997);if(i>8){a._W(2,49161);a._W(2,1);a._W(2,1798);a._W(2,0)}return a}function Na(e,t){if(t===0)return 1200;if(e._R(2)!==1200){}return 1200}function Ma(e,t,r){if(r.enc){e.l+=t;return""}var n=e.l;var i=na(e,0,r);e._R(t+n-e.l);return i}function La(e,t){var r=!t||t.biff==8;var n=Kt(r?112:54);n._W(t.biff==8?2:1,7);if(r)n._W(1,0);n._W(4,859007059);n._W(4,5458548|(r?0:536870912));while(n.l<n.length)n._W(1,r?0:32);return n}function Pa(e,t,r){var n=r&&r.biff==8||t==2?e._R(2):(e.l+=t,0);return{fDialog:n&16}}function Fa(e,t,r){var n=e._R(4);var i=e._R(1)&3;var a=e._R(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Qi(e,0,r);if(o.length===0)o="Sheet1";return{pos:n,hs:i,dt:a,name:o}}function Ba(e,t){var r=!t||t.biff>=8?2:1;var n=Kt(8+r*e.name.length);n._W(4,e.pos);n._W(1,e.hs||0);n._W(1,e.dt);n._W(1,e.name.length);if(t.biff>=8)n._W(1,1);n._W(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);i.l=n.l;return i}function Ha(e,t){var r=e.l+t;var n=e._R(4);var i=e._R(4);var a=[];for(var o=0;o!=i&&e.l<r;++o){a.push(Zi(e))}a.Count=n;a.Unique=i;return a}function $a(e,t){var r=Kt(8);r._W(4,e.Count);r._W(4,e.Unique);var n=[];for(var i=0;i<e.length;++i)n[i]=ea(e[i],t);var a=Ie([r].concat(n));a.parts=[r.length].concat(n.map(function(e){return e.length}));return a}function Wa(e,t){var r={};r.dsst=e._R(2);e.l+=t-2;return r}function Ua(e){var t={};t.r=e._R(2);t.c=e._R(2);t.cnt=e._R(2)-t.c;var r=e._R(2);e.l+=4;var n=e._R(1);e.l+=3;if(n&7)t.level=n&7;if(n&32)t.hidden=true;if(n&64)t.hpt=r/20;return t}function ja(e){var t=ga(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e._R(4);return r!==0}function Va(e){e._R(2);return e._R(4)}function za(e,t,r){var n=0;if(!(r&&r.biff==2)){n=e._R(2)}var i=e._R(2);if(r&&r.biff==2){n=1-(i>>15);i&=32767}var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function qa(e){var t=e._R(2),r=e._R(2),n=e._R(2),i=e._R(2);var a=e._R(2),o=e._R(2),s=e._R(2);var l=e._R(2),u=e._R(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:s,Selected:l,TabRatio:u}}function Ya(){var e=Kt(18);e._W(2,0);e._W(2,0);e._W(2,29280);e._W(2,17600);e._W(2,56);e._W(2,0);e._W(2,0);e._W(2,1);e._W(2,500);return e}function Ga(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e._R(2);return{RTL:n&64}}function Xa(e){var t=Kt(18),r=1718;if(e&&e.RTL)r|=64;t._W(2,r);t._W(4,0);t._W(4,64);t._W(4,0);t._W(4,0);return t}function Ka(){}function Ja(e,t,r){var n={dyHeight:e._R(2),fl:e._R(2)};switch(r&&r.biff||8){case 2:break;case 3:;case 4:e.l+=2;break;default:e.l+=10;break}n.name=Qi(e,0,r);return n}function Qa(e,t){var r=e.name||"Arial";var n=t&&t.biff==5,i=n?15+r.length:16+2*r.length;var a=Kt(i);a._W(2,(e.sz||12)*20);a._W(4,0);a._W(2,400);a._W(4,0);a._W(2,0);a._W(1,r.length);if(!n)a._W(1,1);a._W((n?1:2)*r.length,r,n?"sbcs":"utf16le");return a}function Za(e){var t=va(e);t.isst=e._R(4);return t}function eo(e,t,r,n){var i=Kt(10);pa(e,t,n,i);i._W(4,r);return i}function to(e,t,r){var n=e.l+t;var i=va(e,6);if(r.biff==2)e.l++;var a=ra(e,n-e.l,r);i.val=a;return i}function ro(e,t,r,n,i){var a=!i||i.biff==8;var o=Kt(6+2+ +a+(1+a)*r.length);pa(e,t,n,o);o._W(2,r.length);if(a)o._W(1,1);o._W((1+a)*r.length,r,a?"utf16le":"sbcs");return o}function no(e,t,r){var n=e._R(2);var i=na(e,0,r);return[n,i]}function io(e,t,r,n){var i=r&&r.biff==5;if(!n)n=Kt(i?3+t.length:5+2*t.length);n._W(2,e);n._W(i?1:2,t.length);if(!i)n._W(1,1);n._W((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;if(a.l==null)a.l=a.length;return a}var ao=na;function oo(e,t,r){var n=e.l+t;var i=r.biff==8||!r.biff?4:2;var a=e._R(i),o=e._R(i);var s=e._R(2),l=e._R(2);e.l=n;return{s:{r:a,c:s},e:{r:o,c:l}}}function so(e,t){var r=t.biff==8||!t.biff?4:2;var n=Kt(2*r+6);n._W(r,e.s.r);n._W(r,e.e.r+1);n._W(2,e.s.c);n._W(2,e.e.c+1);n._W(2,0);return n}function lo(e){var t=e._R(2),r=e._R(2);var n=ba(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function uo(e,t){var r=e.l+t-2;var n=e._R(2),i=e._R(2);var a=[];while(e.l<r)a.push(ba(e));if(e.l!==r)throw new Error("MulRK read error");var o=e._R(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function fo(e,t){var r=e.l+t-2;var n=e._R(2),i=e._R(2);var a=[];while(e.l<r)a.push(e._R(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e._R(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function co(e,t,r,n){var i={};var a=e._R(4),o=e._R(4);var s=e._R(4),l=e._R(2);i.patternType=kn[s>>26];if(!n.cellStyles)return i;i.alc=a&7;i.fWrap=a>>3&1;i.alcV=a>>4&7;i.fJustLast=a>>7&1;i.trot=a>>8&255;i.cIndent=a>>16&15;i.fShrinkToFit=a>>20&1;i.iReadOrder=a>>22&2;i.fAtrNum=a>>26&1;i.fAtrFnt=a>>27&1;i.fAtrAlc=a>>28&1;i.fAtrBdr=a>>29&1;i.fAtrPat=a>>30&1;i.fAtrProt=a>>31&1;i.dgLeft=o&15;i.dgRight=o>>4&15;i.dgTop=o>>8&15;i.dgBottom=o>>12&15;i.icvLeft=o>>16&127;i.icvRight=o>>23&127;i.grbitDiag=o>>30&3;i.icvTop=s&127;i.icvBottom=s>>7&127;i.icvDiag=s>>14&127;i.dgDiag=s>>21&15;i.icvFore=l&127;i.icvBack=l>>7&127;i.fsxButton=l>>14&1;return i}function ho(e,t,r){var n={};n.ifnt=e._R(2);n.numFmtId=e._R(2);n.flags=e._R(2);n.fStyle=n.flags>>2&1;t-=6;n.data=co(e,t,n.fStyle,r);return n}function vo(e,t,r,n){var i=r&&r.biff==5;if(!n)n=Kt(i?16:20);n._W(2,0);if(e.style){n._W(2,e.numFmtId||0);n._W(2,65524)}else{n._W(2,e.numFmtId||0);n._W(2,t<<4)}n._W(4,0);n._W(4,0);if(!i)n._W(4,0);n._W(2,0);return n}function po(e){e.l+=4;var t=[e._R(2),e._R(2)];if(t[0]!==0)t[0]--;if(t[1]!==0)t[1]--;if(t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function go(e){var t=Kt(8);t._W(4,0);t._W(2,e[0]?e[0]+1:0);t._W(2,e[1]?e[1]+1:0);return t}function mo(e,t,r){var n=va(e,6);if(r.biff==2)++e.l;var i=Ki(e,2);n.val=i;n.t=i===true||i===false?"b":"e";return n}function yo(e,t,r,n,i,a){var o=Kt(8);pa(e,t,n,o);Ji(r,a,o);return o}function bo(e){var t=va(e,6);var r=Xr(e,8);t.val=r;return t}function wo(e,t,r,n){var i=Kt(14);pa(e,t,n,i);Kr(r,i);return i}var Co=ma;function So(e,t,r){var n=e.l+t;var i=e._R(2);var a=e._R(2);r.sbcch=a;if(a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);var o=ta(e,a);var s=[];while(n>e.l)s.push(ra(e));return[a,i,o,s]}function Eo(e,t,r){var n=e._R(2);var i;var a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};if(r.sbcch===14849)i=wa(e,t-2,r);a.body=i||e._R(t-2);if(typeof i==="string")a.Name=i;return a}var ko=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function To(e,t,r){var n=e.l+t;var i=e._R(2);var a=e._R(1);var o=e._R(1);var s=e._R(r&&r.biff==2?1:2);var l=0;if(!r||r.biff>=5){if(r.biff!=5)e.l+=2;l=e._R(2);if(r.biff==5)e.l+=2;e.l+=4}var u=ta(e,o,r);if(i&32)u=ko[u.charCodeAt(0)];var f=n-e.l;if(r&&r.biff==2)--f;var c=n==e.l||s===0?[]:Uc(e,f,r,s);return{chKey:a,Name:u,itab:l,rgce:c}}function _o(e,t,r){if(r.biff<8)return xo(e,t,r);var n=[],i=e.l+t,a=e._R(r.biff>8?4:2);while(a--!==0)n.push(ya(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function xo(e,t,r){if(e[e.l+1]==3)e[e.l]++;var n=Qi(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Do(e,t,r){if(r.biff<8){e.l+=t;return}var n=e._R(2);var i=e._R(2);var a=ta(e,n,r);var o=ta(e,i,r);return[a,o]}function Ro(e,t,r){var n=Ea(e,6);e.l++;var i=e._R(1);t-=8;return[jc(e,t,r),i,n]}function Io(e,t,r){var n=ka(e,6);switch(r.biff){case 2:e.l++;t-=7;break;case 3:;case 4:e.l+=2;t-=8;break;default:e.l+=6;t-=12}return[n,$c(e,t,r,n)]}function Oo(e){var t=e._R(4)!==0;var r=e._R(4)!==0;var n=e._R(4);return[t,r,n]}function Ao(e,t,r){if(r.biff<8)return;var n=e._R(2),i=e._R(2);var a=e._R(2),o=e._R(2);var s=na(e,0,r);if(r.biff<8)e._R(1);return[{r:n,c:i},s,o,a]}function No(e,t,r){return Ao(e,t,r)}function Mo(e,t){var r=[];var n=e._R(2);while(n--)r.push(Ca(e,t));return r}function Lo(e){var t=Kt(2+e.length*8);t._W(2,e.length);for(var r=0;r<e.length;++r)Sa(e[r],t);return t}function Po(e,t,r){if(r&&r.biff<8)return Bo(e,t,r);var n=Ta(e,22);var i=Ia(e,t-22,n[1]);return{cmo:n,ft:i}}var Fo=[];Fo[8]=function(e,t){var r=e.l+t;e.l+=10;var n=e._R(2);e.l+=4;e.l+=2;e.l+=2;e.l+=2;e.l+=4;var i=e._R(1);e.l+=i;e.l=r;return{fmt:n}};function Bo(e,t,r){e.l+=4;var n=e._R(2);var i=e._R(2);var a=e._R(2);e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=6;t-=36;var o=[];o.push((Fo[n]||Xt)(e,t,r));return{cmo:[i,n,a],ft:o}}function Ho(t,r,e){var n=t.l;var i="";try{t.l+=4;var a=(e.lastobj||{cmo:[0,0]}).cmo[1];var o;if([0,5,7,11,12,14].indexOf(a)==-1)t.l+=6;else o=aa(t,6,e);var s=t._R(2);t._R(2);Yi(t,2);var l=t._R(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l];var c=ta(t,t.lens[u+1]-t.lens[u]-1);i+=c;if(i.length>=(f?s:2*s))break}if(i.length!==s&&i.length!==s*2){throw new Error("cchText: "+s+" != "+i.length)}t.l=n+r;return{t:i}}catch(e){t.l=n+r;return{t:i}}}function $o(e,t){var r=Ca(e,8);e.l+=16;var n=fa(e,t-24);return[r,n]}function Wo(e){var t=Kt(24);var r=pr(e[0]);t._W(2,r.r);t._W(2,r.r);t._W(2,r.c);t._W(2,r.c);var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");for(var i=0;i<16;++i)t._W(1,parseInt(n[i],16));return Ie([t,ca(e[1])])}function Uo(e,t){e._R(2);var r=Ca(e,8);var n=e._R((t-10)/2,"dbcs-cont");n=n.replace(Oe,"");return[r,n]}function jo(e){var t=e[1].Tooltip;var r=Kt(10+2*(t.length+1));r._W(2,2048);var n=pr(e[0]);r._W(2,n.r);r._W(2,n.r);r._W(2,n.c);r._W(2,n.c);for(var i=0;i<t.length;++i)r._W(2,t.charCodeAt(i));r._W(2,0);return r}function Vo(e){var t=[0,0],r;r=e._R(2);t[0]=En[r]||r;r=e._R(2);t[1]=En[r]||r;return t}function zo(e){if(!e)e=Kt(4);e._W(2,1);e._W(2,1);return e}function qo(e){var t=e._R(2);var r=[];while(t-- >0)r.push(ha(e,8));return r}function Yo(e){var t=e._R(2);var r=[];while(t-- >0)r.push(ha(e,8));return r}function Go(e){e.l+=2;var t={cxfs:0,crc:0};t.cxfs=e._R(2);t.crc=e._R(4);return t}function Xo(e,t,r){if(!r.cellStyles)return Xt(e,t);var n=r&&r.biff>=12?4:2;var i=e._R(n);var a=e._R(n);var o=e._R(n);var s=e._R(n);var l=e._R(2);if(n==2)e.l+=2;var u={s:i,e:a,w:o,ixfe:s,flags:l};if(r.biff>=5||!r.biff)u.level=l>>8&7;return u}function Ko(e,t){var r={};if(t<32)return r;e.l+=16;r.header=Xr(e,8);r.footer=Xr(e,8);e.l+=2;return r}function Jo(e,t,r){var n={area:false};if(r.biff!=5){e.l+=t;return n}var i=e._R(1);e.l+=3;if(i&16)n.area=true;return n}function Qo(e){var t=Kt(2*e);for(var r=0;r<e;++r)t._W(2,r+1);return t}var Zo=va;var es=Xi;var ts=ra;function rs(e){var t=e._R(2);var r=e._R(2);var n=e._R(4);var i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};e.l+=n;return i}function ns(e,t,r){var n=va(e,6);++e.l;var i=na(e,t-7,r);n.t="str";n.val=i;return n}function is(e){var t=va(e,6);++e.l;var r=Xr(e,8);t.t="n";t.val=r;return t}function as(e,t,r){var n=Kt(15);Bp(n,e,t);n._W(8,r,"f");return n}function os(e){var t=va(e,6);++e.l;var r=e._R(2);t.t="n";t.val=r;return t}function ss(e,t,r){var n=Kt(9);Bp(n,e,t);n._W(2,r);return n}function ls(e){var t=e._R(1);if(t===0){e.l++;return""}return e._R(t,"sbcs-cont")}function us(e,t){e.l+=6;e.l+=2;e.l+=1;e.l+=3;e.l+=1;e.l+=t-13}function fs(e,t,r){var n=e.l+t;var i=va(e,6);var a=e._R(2);var o=ta(e,a,r);e.l=n;i.t="str";i.val=o;return i}var cs=function(){var w={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969};var S=I({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});var e=[2,3,48,49,131,139,140,245];function n(e,t){var r=[];var n=xe(1);switch(t.type){case"base64":n=Re(Te.decode(e));break;case"binary":n=Re(e);break;case"buffer":;case"array":n=e;break}Gt(n,0);var i=n._R(1);var a=false;var o=false,s=false;switch(i){case 2:;case 3:break;case 48:o=true;a=true;break;case 49:o=true;break;case 131:a=true;break;case 139:a=true;break;case 140:a=true;s=true;break;case 245:a=true;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var l=0,u=0;if(i==2)l=n._R(2);n.l+=3;if(i!=2)l=n._R(4);if(i!=2)u=n._R(2);var f=n._R(2);var c=1252;if(i!=2){n.l+=16;n._R(1);if(n[n.l]!==0)c=w[n[n.l]];n.l+=1;n.l+=2}if(s)n.l+=36;var d=[],h={};var v=u-10-(o?264:0),p=s?32:11;while(i==2?n.l<n.length&&n[n.l]!=13:n.l<v){h={};h.name=cptable.utils.decode(c,n.slice(n.l,n.l+p)).replace(/[\u0000\r\n].*$/g,"");n.l+=p;h.type=String.fromCharCode(n._R(1));if(i!=2&&!s)h.offset=n._R(4);h.len=n._R(1);if(i==2)h.offset=n._R(2);h.dec=n._R(1);if(h.name.length)d.push(h);if(i!=2)n.l+=s?13:14;switch(h.type){case"B":if((!o||h.len!=8)&&t.WTF)console.log("Skipping "+h.name+":"+h.type);break;case"G":;case"P":if(t.WTF)console.log("Skipping "+h.name+":"+h.type);break;case"C":;case"D":;case"F":;case"I":;case"L":;case"M":;case"N":;case"O":;case"T":;case"Y":;case"0":;case"@":;case"+":break;default:throw new Error("Unknown Field Type: "+h.type)}}if(n[n.l]!==13)n.l=u-1;else if(i==2)n.l=521;if(i!=2){if(n._R(1)!==13)throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=u}var g=0,m=0;r[0]=[];for(m=0;m!=d.length;++m)r[0][m]=d[m].name;while(l-- >0){if(n[n.l]===42){n.l+=f;continue}++n.l;r[++g]=[];m=0;for(m=0;m!=d.length;++m){var y=n.slice(n.l,n.l+d[m].len);n.l+=d[m].len;Gt(y,0);var b=cptable.utils.decode(c,y);switch(d[m].type){case"C":r[g][m]=cptable.utils.decode(c,y);r[g][m]=r[g][m].trim();break;case"D":if(b.length===8)r[g][m]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8));else r[g][m]=b;break;case"F":r[g][m]=parseFloat(b.trim());break;case"+":;case"I":r[g][m]=s?y._R(-4,"i")^2147483648:y._R(4,"i");break;case"L":switch(b.toUpperCase()){case"Y":;case"T":r[g][m]=true;break;case"N":;case"F":r[g][m]=false;break;case" ":;case"?":r[g][m]=false;break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[g][m]="##MEMO##"+(s?parseInt(b.trim(),10):y._R(4));break;case"N":r[g][m]=+b.replace(/\u0000/g,"").trim();break;case"@":r[g][m]=new Date(y._R(-8,"f")-621356832e5);break;case"T":r[g][m]=new Date((y._R(4)-2440588)*864e5+y._R(4));break;case"Y":r[g][m]=y._R(4,"i")/1e4;break;case"O":r[g][m]=-y._R(-8,"f");break;case"B":if(o&&d[m].len==8){r[g][m]=y._R(8,"f");break};case"G":;case"P":y.l+=d[m].len;break;case"0":if(d[m].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+d[m].type)}}}if(i!=2)if(n.l<n.length&&n[n.l++]!=26)throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));if(t&&t.sheetRows)r=r.slice(0,t.sheetRows);return r}function r(e,t){var r=t||{};if(!r.dateNF)r.dateNF="yyyymmdd";return kr(n(e,r),r)}function t(e,t){try{return Sr(r(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}}var E={B:8,C:250,L:1,D:8,"?":0,"":0};function i(e,t){var r=t||{};if(+r.codepage>=0)pe(+r.codepage);if(r.type=="string")throw new Error("Cannot write DBF to JS string");var n=Qt();var i=em(e,{header:1,raw:true,cellDates:true});var a=i[0],o=i.slice(1);var s=0,l=0,u=0,f=1;for(s=0;s<a.length;++s){if(s==null)continue;++u;if(typeof a[s]==="number")a[s]=a[s].toString(10);if(typeof a[s]!=="string")throw new Error("DBF Invalid column name "+a[s]+" |"+typeof a[s]+"|");if(a.indexOf(a[s])!==s)for(l=0;l<1024;++l)if(a.indexOf(a[s]+"_"+l)==-1){a[s]+="_"+l;break}}var c=br(e["!ref"]);var d=[];for(s=0;s<=c.e.c-c.s.c;++s){var h=[];for(l=0;l<o.length;++l){if(o[l][s]!=null)h.push(o[l][s])}if(h.length==0||a[s]==null){d[s]="?";continue}var v="",p="";for(l=0;l<h.length;++l){switch(typeof h[l]){case"number":p="B";break;case"string":p="C";break;case"boolean":p="L";break;case"object":p=h[l]instanceof Date?"D":"C";break;default:p="C"}v=v&&v!=p?"C":p;if(v=="C")break}f+=E[v]||0;d[s]=v}var g=n.next(32);g._W(4,318902576);g._W(4,o.length);g._W(2,296+32*u);g._W(2,f);for(s=0;s<4;++s)g._W(4,0);g._W(4,0|(+S[k]||3)<<8);for(s=0,l=0;s<a.length;++s){if(a[s]==null)continue;var m=n.next(32);var y=(a[s].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);m._W(1,y,"sbcs");m._W(1,d[s]=="?"?"C":d[s],"sbcs");m._W(4,l);m._W(1,E[d[s]]||0);m._W(1,0);m._W(1,2);m._W(4,0);m._W(1,0);m._W(4,0);m._W(4,0);l+=E[d[s]]||0}var b=n.next(264);b._W(4,13);for(s=0;s<65;++s)b._W(4,0);for(s=0;s<o.length;++s){var w=n.next(f);w._W(1,0);for(l=0;l<a.length;++l){if(a[l]==null)continue;switch(d[l]){case"L":w._W(1,o[s][l]==null?63:o[s][l]?84:70);break;case"B":w._W(8,o[s][l]||0,"f");break;case"D":if(!o[s][l])w._W(8,"00000000","sbcs");else{w._W(4,("0000"+o[s][l].getFullYear()).slice(-4),"sbcs");w._W(2,("00"+(o[s][l].getMonth()+1)).slice(-2),"sbcs");w._W(2,("00"+o[s][l].getDate()).slice(-2),"sbcs")}break;case"C":var C=String(o[s][l]||"");w._W(1,C,"sbcs");for(u=0;u<250-C.length;++u)w._W(1,32);break}}}n.next(1)._W(1,26);return n.end()}return{versions:e,to_workbook:t,to_sheet:r,from_sheet:i}}();var ds=function(){var n={AA:"Ã",BA:"Ã",CA:"Ã",DA:195,HA:"Ã",JA:197,AE:"Ã",BE:"Ã",CE:"Ã",HE:"Ã",AI:"Ã",BI:"Ã",CI:"Ã",HI:"Ã",AO:"Ã",BO:"Ã",CO:"Ã",DO:213,HO:"Ã",AU:"Ã",BU:"Ã",CU:"Ã",HU:"Ã",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã",Kc:"Ã§",q:"Ã¦",z:"Å",a:"Ã",j:"Å",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,B:180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223};var k=new RegExp("N("+ye(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm");var T=function(e,t){var r=n[t];return typeof r=="number"?s(r):r};var _=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return n==59?e:s(n)};n["|"]=254;function o(e,t){switch(t.type){case"base64":return r(Te.decode(e),t);case"binary":return r(e,t);case"buffer":return r(e.toString("binary"),t);case"array":return r(H(e),t)}throw new Error("Unrecognized type "+t.type)}function r(e,t){var r=e.split(/[\n\r]+/),n=-1,i=-1,a=0,o=0,s=[];var l=[];var u=null;var f={},c=[],d=[],h=[];var v=0,p;if(+t.codepage>=0)pe(+t.codepage);for(;a!==r.length;++a){v=0;var g=r[a].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,_).replace(k,T);var m=g.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")});var y=m[0],b;if(g.length>0)switch(y){case"ID":break;case"E":break;case"B":break;case"O":break;case"P":if(m[1].charAt(0)=="P")l.push(g.slice(3).replace(/;;/g,";"));break;case"C":var w=false,C=false;for(o=1;o<m.length;++o)switch(m[o].charAt(0)){case"X":i=parseInt(m[o].slice(1))-1;C=true;break;case"Y":n=parseInt(m[o].slice(1))-1;if(!C)i=0;for(p=s.length;p<=n;++p)s[p]=[];break;case"K":b=m[o].slice(1);if(b.charAt(0)==='"')b=b.slice(1,b.length-1);else if(b==="TRUE")b=true;else if(b==="FALSE")b=false;else if(!isNaN(U(b))){b=U(b);if(u!==null&&me.is_date(u))b=Y(b)}else if(!isNaN(j(b).getDate())){b=ae(b)}if(typeof cptable!=="undefined"&&typeof b=="string"&&(t||{}).type!="string"&&(t||{}).codepage)b=cptable.utils.decode(t.codepage,b);w=true;break;case"E":var S=rf(m[o].slice(1),{r:n,c:i});s[n][i]=[s[n][i],S];break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}if(w){s[n][i]=b;u=null}break;case"F":var E=0;for(o=1;o<m.length;++o)switch(m[o].charAt(0)){case"X":i=parseInt(m[o].slice(1))-1;++E;break;case"Y":n=parseInt(m[o].slice(1))-1;for(p=s.length;p<=n;++p)s[p]=[];break;case"M":v=parseInt(m[o].slice(1))/20;break;case"F":break;case"G":break;case"P":u=l[parseInt(m[o].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":h=m[o].slice(1).split(" ");for(p=parseInt(h[0],10);p<=parseInt(h[1],10);++p){v=parseInt(h[2],10);d[p-1]=v===0?{hidden:true}:{wch:v};wl(d[p-1])}break;case"C":i=parseInt(m[o].slice(1))-1;if(!d[i])d[i]={};break;case"R":n=parseInt(m[o].slice(1))-1;if(!c[n])c[n]={};if(v>0){c[n].hpt=v;c[n].hpx=kl(v)}else if(v===0)c[n].hidden=true;break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}if(E<1)u=null;break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}}if(c.length>0)f["!rows"]=c;if(d.length>0)f["!cols"]=d;if(t&&t.sheetRows)s=s.slice(0,t.sheetRows);return[s,f]}function i(e,t){var r=o(e,t);var n=r[0],i=r[1];var a=kr(n,t);ye(i).forEach(function(e){a[e]=i[e]});return a}function e(e,t){return Sr(i(e,t),t)}function c(e,t,r,n){var i="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":i+=e.v||0;if(e.f&&!e.F)i+=";E"+af(e.f,{r:r,c:n});break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"")+'"';break}return i}function d(n,e){e.forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";if(e.hidden)r+="0";else{if(typeof e.width=="number")e.wpx=pl(e.width);if(typeof e.wpx=="number")e.wch=gl(e.wpx);if(typeof e.wch=="number")r+=Math.round(e.wch)}if(r.charAt(r.length-1)!=" ")n.push(r)})}function h(n,e){e.forEach(function(e,t){var r="F;";if(e.hidden)r+="M0;";else if(e.hpt)r+="M"+20*e.hpt+";";else if(e.hpx)r+="M"+20*El(e.hpx)+";";if(r.length>2)n.push(r+"R"+(t+1))})}function t(e,t){var r=["ID;PWXL;N;E"],n=[];var i=br(e["!ref"]),a;var o=Array.isArray(e);var s="\r\n";r.push("P;PGeneral");r.push("F;P0;DG0G8;M255");if(e["!cols"])d(r,e["!cols"]);if(e["!rows"])h(r,e["!rows"]);r.push("B;Y"+(i.e.r-i.s.r+1)+";X"+(i.e.c-i.s.c+1)+";D"+[i.s.c,i.s.r,i.e.c,i.e.r].join(" "));for(var l=i.s.r;l<=i.e.r;++l){for(var u=i.s.c;u<=i.e.c;++u){var f=gr({r:l,c:u});a=o?(e[l]||[])[u]:e[f];if(!a||a.v==null&&(!a.f||a.F))continue;n.push(c(a,e,l,u,t))}}return r.join(s)+s+n.join(s)+s+"E"+s}return{to_workbook:e,to_sheet:i,from_sheet:t}}();var hs=function(){function r(e,t){switch(t.type){case"base64":return n(Te.decode(e),t);case"binary":return n(e,t);case"buffer":return n(e.toString("binary"),t);case"array":return n(H(e),t)}throw new Error("Unrecognized type "+t.type)}function n(e,t){var r=e.split("\n"),n=-1,i=-1,a=0,o=[];for(;a!==r.length;++a){if(r[a].trim()==="BOT"){o[++n]=[];i=0;continue}if(n<0)continue;var s=r[a].trim().split(",");var l=s[0],u=s[1];++a;var f=r[a].trim();switch(+l){case-1:if(f==="BOT"){o[++n]=[];i=0;continue}else if(f!=="EOD")throw new Error("Unrecognized DIF special command "+f);break;case 0:if(f==="TRUE")o[n][i]=true;else if(f==="FALSE")o[n][i]=false;else if(!isNaN(U(u)))o[n][i]=U(u);else if(!isNaN(j(u).getDate()))o[n][i]=ae(u);else o[n][i]=u;++i;break;case 1:f=f.slice(1,f.length-1);o[n][i++]=f!==""?f:null;break}if(f==="EOD")break}if(t&&t.sheetRows)o=o.slice(0,t.sheetRows);return o}function i(e,t){return kr(r(e,t),t)}function e(e,t){return Sr(i(e,t),t)}var t=function(){var c=function e(t,r,n,i,a){t.push(r);t.push(n+","+i);t.push('"'+a.replace(/"/g,'""')+'"')};var d=function e(t,r,n,i){t.push(r+","+n);t.push(r==1?'"'+i.replace(/"/g,'""')+'"':i)};return function e(t){var r=[];var e=br(t["!ref"]),n;var i=Array.isArray(t);c(r,"TABLE",0,1,"sheetjs");c(r,"VECTORS",0,e.e.r-e.s.r+1,"");c(r,"TUPLES",0,e.e.c-e.s.c+1,"");c(r,"DATA",0,0,"");for(var a=e.s.r;a<=e.e.r;++a){d(r,-1,0,"BOT");for(var o=e.s.c;o<=e.e.c;++o){var s=gr({r:a,c:o});n=i?(t[a]||[])[o]:t[s];if(!n){d(r,1,0,"");continue}switch(n.t){case"n":var l=h?n.w:n.v;if(!l&&n.v!=null)l=n.v;if(l==null){if(h&&n.f&&!n.F)d(r,1,0,"="+n.f);else d(r,1,0,"")}else d(r,0,l,"V");break;case"b":d(r,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":d(r,1,0,!h||isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":if(!n.w)n.w=me.format(n.z||me._table[14],Z(ae(n.v)));if(h)d(r,0,n.w,"V");else d(r,1,0,n.w);break;default:d(r,1,0,"")}}}d(r,-1,0,"EOD");var u="\r\n";var f=r.join(u);return f}}();return{to_workbook:e,to_sheet:i,from_sheet:t}}();var vs=function(){function f(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function c(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(e,t){var r=e.split("\n"),n=-1,i=-1,a=0,o=[];for(;a!==r.length;++a){var s=r[a].trim().split(":");if(s[0]!=="cell")continue;var l=pr(s[1]);if(o.length<=l.r)for(n=o.length;n<=l.r;++n)if(!o[n])o[n]=[];n=l.r;i=l.c;switch(s[2]){case"t":o[n][i]=f(s[3]);break;case"v":o[n][i]=+s[3];break;case"vtf":var u=s[s.length-1];case"vtc":switch(s[3]){case"nl":o[n][i]=+s[4]?true:false;break;default:o[n][i]=+s[4];break}if(s[2]=="vtf")o[n][i]=[o[n][i],u]}}if(t&&t.sheetRows)o=o.slice(0,t.sheetRows);return o}function n(e,t){return kr(r(e,t),t)}function e(e,t){return Sr(n(e,t),t)}var t=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n");var i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n";var a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n");var o="--SocialCalcSpreadsheetControlSave--";function s(e){if(!e||!e["!ref"])return"";var t=[],r=[],n,i="";var a=mr(e["!ref"]);var o=Array.isArray(e);for(var s=a.s.r;s<=a.e.r;++s){for(var l=a.s.c;l<=a.e.c;++l){i=gr({r:s,c:l});n=o?(e[s]||[])[l]:e[i];if(!n||n.v==null||n.t==="z")continue;r=["cell",i,"t"];switch(n.t){case"s":;case"str":r.push(c(n.v));break;case"n":if(!n.f){r[2]="v";r[3]=n.v}else{r[2]="vtf";r[3]="n";r[4]=n.v;r[5]=c(n.f)}break;case"b":r[2]="vt"+(n.f?"f":"c");r[3]="nl";r[4]=n.v?"1":"0";r[5]=c(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=Z(ae(n.v));r[2]="vtc";r[3]="nd";r[4]=""+u;r[5]=n.w||me.format(n.z||me._table[14],u);break;case"e":continue}t.push(r.join(":"))}}t.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1");t.push("valueformat:1:text-wiki");return t.join("\n")}function l(e){return[t,i,a,i,s(e),o].join("\n")}return{to_workbook:e,to_sheet:n,from_sheet:l}}();var ps=function(){function f(e,t,r,n,i){if(i.raw)t[r][n]=e;else if(e==="TRUE")t[r][n]=true;else if(e==="FALSE")t[r][n]=false;else if(e===""){}else if(!isNaN(U(e)))t[r][n]=U(e);else if(!isNaN(j(e).getDate()))t[r][n]=ae(e);else t[r][n]=e}function r(e,t){var r=t||{};var n=[];if(!e||e.length===0)return n;var i=e.split(/[\r\n]/);var a=i.length-1;while(a>=0&&i[a].length===0)--a;var o=10,s=0;var l=0;for(;l<=a;++l){s=i[l].indexOf(" ");if(s==-1)s=i[l].length;else s++;o=Math.max(o,s)}for(l=0;l<=a;++l){n[l]=[];var u=0;f(i[l].slice(0,o).trim(),n,l,u,r);for(u=1;u<=(i[l].length-o)/10+1;++u)f(i[l].slice(o+(u-1)*10,o+u*10).trim(),n,l,u,r)}if(r.sheetRows)n=n.slice(0,r.sheetRows);return n}var a={44:",",9:"\t",59:";"};var o={44:3,9:2,59:1};function g(e){var t={},r=false,n=0,i=0;for(;n<e.length;++n){if((i=e.charCodeAt(n))==34)r=!r;else if(!r&&i in a)t[i]=(t[i]||0)+1}i=[];for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){i.push([t[n],n])}if(!i.length){t=o;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){i.push([t[n],n])}}i.sort(function(e,t){return e[0]-t[0]||o[e[1]]-o[t[1]]});return a[i.pop()[1]]}function n(n,e){var i=e||{};var t="";if(ge!=null&&i.dense==null)i.dense=ge;var a=i.dense?[]:{};var o={s:{c:0,r:0},e:{c:0,r:0}};if(n.slice(0,4)=="sep="){if(n.charCodeAt(5)==13&&n.charCodeAt(6)==10){t=n.charAt(4);n=n.slice(7)}else if(n.charCodeAt(5)==13||n.charCodeAt(5)==10){t=n.charAt(4);n=n.slice(6)}}else t=g(n.slice(0,1024));var s=0,l=0,u=0;var f=0,c=0,d=t.charCodeAt(0),r=false,h=0;n=n.replace(/\r\n/gm,"\n");var v=i.dateNF!=null?C(i.dateNF):null;function p(){var e=n.slice(f,c);var t={};if(e.charAt(0)=='"'&&e.charAt(e.length-1)=='"')e=e.slice(1,-1).replace(/""/g,'"');if(e.length===0)t.t="z";else if(i.raw){t.t="s";t.v=e}else if(e.trim().length===0){t.t="s";t.v=e}else if(e.charCodeAt(0)==61){if(e.charCodeAt(1)==34&&e.charCodeAt(e.length-1)==34){t.t="s";t.v=e.slice(2,-1).replace(/""/g,'"')}else if(lf(e)){t.t="n";t.f=e.slice(1)}else{t.t="s";t.v=e}}else if(e=="TRUE"){t.t="b";t.v=true}else if(e=="FALSE"){t.t="b";t.v=false}else if(!isNaN(u=U(e))){t.t="n";if(i.cellText!==false)t.w=e;t.v=u}else if(!isNaN(j(e).getDate())||v&&e.match(v)){t.z=i.dateNF||me._table[14];var r=0;if(v&&e.match(v)){e=S(e,i.dateNF,e.match(v)||[]);r=1}if(i.cellDates){t.t="d";t.v=ae(e,r)}else{t.t="n";t.v=Z(ae(e,r))}if(i.cellText!==false)t.w=me.format(t.z,t.v instanceof Date?Z(t.v):t.v);if(!i.cellNF)delete t.z}else{t.t="s";t.v=e}if(t.t=="z"){}else if(i.dense){if(!a[s])a[s]=[];a[s][l]=t}else a[gr({c:l,r:s})]=t;f=c+1;if(o.e.c<l)o.e.c=l;if(o.e.r<s)o.e.r=s;if(h==d)++l;else{l=0;++s;if(i.sheetRows&&i.sheetRows<=s)return true}}e:for(;c<n.length;++c)switch(h=n.charCodeAt(c)){case 34:r=!r;break;case d:;case 10:;case 13:if(!r&&p())break e;break;default:break}if(c-f>0)p();a["!ref"]=yr(o);return a}function i(e,t){if(!(t&&t.PRN))return n(e,t);if(e.slice(0,4)=="sep=")return n(e,t);if(e.indexOf("\t")>=0||e.indexOf(",")>=0||e.indexOf(";")>=0)return n(e,t);return kr(r(e,t),t)}function s(e,t){var r="",n=t.type=="string"?[0,0,0,0]:Ng(e,t);switch(t.type){case"base64":r=Te.decode(e);break;case"binary":r=e;break;case"buffer":if(t.codepage==65001)r=e.toString("utf8");else if(t.codepage&&typeof cptable!=="undefined")r=cptable.utils.decode(t.codepage,e);else r=e.toString("binary");break;case"array":r=H(e);break;case"string":r=e;break;default:throw new Error("Unrecognized type "+t.type)}if(n[0]==239&&n[1]==187&&n[2]==191)r=Ge(r.slice(3));else if(t.type=="binary"&&typeof cptable!=="undefined"&&t.codepage)r=cptable.utils.decode(t.codepage,cptable.utils.encode(1252,r));if(r.slice(0,19)=="socialcalc:version:")return vs.to_sheet(t.type=="string"?r:Ge(r),t);return i(r,t)}function e(e,t){return Sr(s(e,t),t)}function t(e){var t=[];var r=br(e["!ref"]),n;var i=Array.isArray(e);for(var a=r.s.r;a<=r.e.r;++a){var o=[];for(var s=r.s.c;s<=r.e.c;++s){var l=gr({r:a,c:s});n=i?(e[a]||[])[s]:e[l];if(!n||n.v==null){o.push("          ");continue}var u=(n.w||(Cr(n),n.w)||"").slice(0,10);while(u.length<10)u+=" ";o.push(u+(s===0?" ":""))}t.push(o.join(""))}return t.join("\n")}return{to_workbook:e,to_sheet:s,from_sheet:t}}();function gs(t,r){var n=r||{},i=!!n.WTF;n.WTF=true;try{var e=ds.to_workbook(t,n);n.WTF=i;return e}catch(e){n.WTF=i;if(!e.message.match(/SYLK bad record ID/)&&i)throw e;return ps.to_workbook(t,r)}}var ms=function(){function t(e,t,r){if(!e)return;Gt(e,e.l||0);var n=r.Enum||m;while(e.l<e.length){var i=e._R(2);var a=n[i]||n[255];var o=e._R(2);var s=e.l+o;var l=(a.f||Xt)(e,o,r);e.l=s;if(t(l,a.n,i))return}}function e(e,t){switch(t.type){case"base64":return r(Re(Te.decode(e)),t);case"binary":return r(Re(e),t);case"buffer":;case"array":return r(e,t)}throw"Unsupported type "+t.type}function r(n,e){if(!n)return n;var i=e||{};if(ge!=null&&i.dense==null)i.dense=ge;var a=i.dense?[]:{},o="Sheet1",s=0;var l={},u=[o];var f={s:{r:0,c:0},e:{r:0,c:0}};var c=i.sheetRows||0;if(n[2]==2)i.Enum=m;else if(n[2]==26)i.Enum=y;else if(n[2]==14){i.Enum=y;i.qpro=true;n.l=0}else throw new Error("Unrecognized LOTUS BOF "+n[2]);t(n,function(e,t,r){if(n[2]==2)switch(r){case 0:i.vers=e;if(e>=4096)i.qpro=true;break;case 6:f=e;break;case 15:if(!i.qpro)e[1].v=e[1].v.slice(1);case 13:;case 14:;case 16:;case 51:if(r==14&&(e[2]&112)==112&&(e[2]&15)>1&&(e[2]&15)<15){e[1].z=i.dateNF||me._table[14];if(i.cellDates){e[1].t="d";e[1].v=Y(e[1].v)}}if(i.dense){if(!a[e[0].r])a[e[0].r]=[];a[e[0].r][e[0].c]=e[1]}else a[gr(e[0])]=e[1];break}else switch(r){case 22:e[1].v=e[1].v.slice(1);case 23:;case 24:;case 25:;case 37:;case 39:;case 40:if(e[3]>s){a["!ref"]=yr(f);l[o]=a;a=i.dense?[]:{};f={s:{r:0,c:0},e:{r:0,c:0}};s=e[3];o="Sheet"+(s+1);u.push(o)}if(c>0&&e[0].r>=c)break;if(i.dense){if(!a[e[0].r])a[e[0].r]=[];a[e[0].r][e[0].c]=e[1]}else a[gr(e[0])]=e[1];if(f.e.c<e[0].c)f.e.c=e[0].c;if(f.e.r<e[0].r)f.e.r=e[0].r;break;default:break}},i);a["!ref"]=yr(f);l[o]=a;return{SheetNames:u,Sheets:l}}function n(e){var t={s:{c:0,r:0},e:{c:0,r:0}};t.s.c=e._R(2);t.s.r=e._R(2);t.e.c=e._R(2);t.e.r=e._R(2);if(t.s.c==65535)t.s.c=t.e.c=t.s.r=t.e.r=0;return t}function o(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0];if(r.qpro&&r.vers!=20768){n[0].c=e._R(1);e.l++;n[0].r=e._R(2);e.l+=2}else{n[2]=e._R(1);n[0].c=e._R(2);n[0].r=e._R(2)}return n}function i(e,t,r){var n=e.l+t;var i=o(e,t,r);i[1].t="s";if(r.vers==20768){e.l++;var a=e._R(1);i[1].v=e._R(a,"utf8");return i}if(r.qpro)e.l++;i[1].v=e._R(n-e.l,"cstr");return i}function a(e,t,r){var n=o(e,t,r);n[1].v=e._R(2,"i");return n}function s(e,t,r){var n=o(e,t,r);n[1].v=e._R(8,"f");return n}function l(e,t,r){var n=e.l+t;var i=o(e,t,r);i[1].v=e._R(8,"f");if(r.qpro)e.l=n;else{var a=e._R(2);e.l+=a}return i}function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];t[0].r=e._R(2);t[3]=e[e.l++];t[0].c=e[e.l++];return t}function f(e,t){var r=u(e,t);r[1].t="s";r[1].v=e._R(t-4,"cstr");return r}function c(e,t){var r=u(e,t);r[1].v=e._R(2);var n=r[1].v>>1;if(r[1].v&1){switch(n&7){case 1:n=(n>>3)*500;break;case 2:n=(n>>3)/20;break;case 4:n=(n>>3)/2e3;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(n&7)}}r[1].v=n;return r}function d(e,t){var r=u(e,t);var n=e._R(4);var i=e._R(4);var a=e._R(2);if(a==65535){r[1].v=0;return r}var o=a&32768;a=(a&32767)-16446;r[1].v=(o*2-1)*((a>0?i<<a:i>>>-a)+(a>-32?n<<a+32:n>>>-(a+32)));return r}function h(e,t){var r=d(e,14);e.l+=t-14;return r}function v(e,t){var r=u(e,t);var n=e._R(4);r[1].v=n>>6;return r}function p(e,t){var r=u(e,t);var n=e._R(8,"f");r[1].v=n;return r}function g(e,t){var r=p(e,14);e.l+=t-10;return r}var m={0:{n:"BOF",f:Yi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:n},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:a},14:{n:"NUMBER",f:s},15:{n:"LABEL",f:i},16:{n:"FORMULA",f:l},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:i},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:Xt}};var y={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:f},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:c},25:{n:"FORMULA19",f:h},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:v},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:g},255:{n:"",f:Xt}};return{to_workbook:e}}();function ys(e){var t={},r=e.match(we),n=0;var i=false;if(r)for(;n!=r.length;++n){var a=Ee(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":;case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=l[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":;case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":;case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break};case"<u>":;case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":;case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":;case"<i/>":t.i=1;break;case"</i>":break;case"<color":if(a.rgb)t.color=a.rgb.slice(2,8);break;case"<family":t.family=a.val;break;case"<vertAlign":t.valign=a.val;break;case"<scheme":break;case"<extLst":;case"<extLst>":;case"</extLst>":break;case"<ext":i=true;break;case"</ext>":i=false;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var bs=function(){var i=Ze("t"),a=Ze("rPr");function r(e){var t=e.match(i);if(!t)return{t:"s",v:""};var r={t:"s",v:Fe(t[1])};var n=e.match(a);if(n)r.s=ys(n[1]);return r}var n=/<(?:\w+:)?r>/g,o=/<\/(?:\w+:)?r>/;return function e(t){return t.replace(n,"").split(o).map(r).filter(function(e){return e.v})}}();var ws=function e(){var r=/(\r\n|\n)/g;function n(e,t,r){var n=[];if(e.u)n.push("text-decoration: underline;");if(e.uval)n.push("text-underline-style:"+e.uval+";");if(e.sz)n.push("font-size:"+e.sz+"pt;");if(e.outline)n.push("text-effect: outline;");if(e.shadow)n.push("text-shadow: auto;");t.push('<span style="'+n.join("")+'">');if(e.b){t.push("<b>");r.push("</b>")}if(e.i){t.push("<i>");r.push("</i>")}if(e.strike){t.push("<s>");r.push("</s>")}var i=e.valign||"";if(i=="superscript"||i=="super")i="sup";else if(i=="subscript")i="sub";if(i!=""){t.push("<"+i+">");r.push("</"+i+">")}r.push("</span>");return e}function i(e){var t=[[],e.v,[]];if(!e.v)return"";if(e.s)n(e.s,t[0],t[2]);return t[0].join("")+t[1].replace(r,"<br/>")+t[2].join("")}return function e(t){return t.map(i).join("")}}();var Cs=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ss=/<(?:\w+:)?r>/;var Es=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ks(e,t){var r=t?t.cellHTML:true;var n={};if(!e)return{t:""};if(e.match(/^\s*<(?:\w+:)?t[^>]*>/)){n.t=Fe(Ge(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""));n.r=Ge(e);if(r)n.h=je(n.t)}else if(e.match(Ss)){n.r=Ge(e);n.t=Fe(Ge((e.replace(Es,"").match(Cs)||[]).join("").replace(we,"")));if(r)n.h=ws(bs(n.r))}return n}var Ts=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/;var _s=/<(?:\w+:)?(?:si|sstItem)>/g;var xs=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ds(e,t){var r=[],n="";if(!e)return r;var i=e.match(Ts);if(i){n=i[2].replace(_s,"").split(xs);for(var a=0;a!=n.length;++a){var o=ks(n[a].trim(),t);if(o!=null)r[r.length]=o}i=Ee(i[1]);r.Count=i.count;r.Unique=i.uniqueCount}return r}Bn.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var Rs=/^\s|\s$|[\t\n\r]/;function Is(e,t){if(!t.bookSST)return"";var r=[ve];r[r.length]=lt("sst",null,{xmlns:ct.main[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n){if(e[n]==null)continue;var i=e[n];var a="<si>";if(i.r)a+=i.r;else{a+="<t";if(!i.t)i.t="";if(i.t.match(Rs))a+=' xml:space="preserve"';a+=">"+$e(i.t)+"</t>"}a+="</si>";r[r.length]=a}if(r.length>2){r[r.length]="</sst>";r[1]=r[1].replace("/>",">")}return r.join("")}function Os(e){return[e._R(4),e._R(4)]}function As(e,i){var a=[];var o=false;Jt(e,function e(t,r,n){switch(n){case 159:a.Count=t[0];a.Unique=t[1];break;case 19:a.push(t);break;case 160:return true;case 35:o=true;break;case 36:o=false;break;default:if(r.indexOf("Begin")>0){}else if(r.indexOf("End")>0){}if(!o||i.WTF)throw new Error("Unexpected record "+n+" "+r)}});return a}function Ns(e,t){if(!t)t=Kt(8);t._W(4,e.Count);t._W(4,e.Unique);return t}var Ms=Or;function Ls(e){var t=Qt();Zt(t,"BrtBeginSst",Ns(e));for(var r=0;r<e.length;++r)Zt(t,"BrtSSTItem",Ms(e[r]));Zt(t,"BrtEndSst");return t.end()}function Ps(e){if(typeof cptable!=="undefined")return cptable.utils.encode(k,e);var t=[],r=e.split("");for(var n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Fs(e,t){var r={};r.Major=e._R(2);r.Minor=e._R(2);if(t>=4)e.l+=t-4;return r}function Bs(e){var t={};t.id=e._R(0,"lpp4");t.R=Fs(e,4);t.U=Fs(e,4);t.W=Fs(e,4);return t}function Hs(e){var t=e._R(4);var r=e.l+t-4;var n={};var i=e._R(4);var a=[];while(i-- >0)a.push({t:e._R(4),v:e._R(0,"lpp4")});n.name=e._R(0,"lpp4");n.comps=a;if(e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $s(e){var t=[];e.l+=4;var r=e._R(4);while(r-- >0)t.push(Hs(e));return t}function Ws(e){var t=[];e.l+=4;var r=e._R(4);while(r-- >0)t.push(e._R(0,"lpp4"));return t}function Us(e){var t={};e._R(4);e.l+=4;t.id=e._R(0,"lpp4");t.name=e._R(0,"lpp4");t.R=Fs(e,4);t.U=Fs(e,4);t.W=Fs(e,4);return t}function js(e){var t=Us(e);t.ename=e._R(0,"8lpp4");t.blksz=e._R(4);t.cmode=e._R(4);if(e._R(4)!=4)throw new Error("Bad !Primary record");return t}function Vs(e,t){var r=e.l+t;var n={};n.Flags=e._R(4)&63;e.l+=4;n.AlgID=e._R(4);var i=false;switch(n.AlgID){case 26126:;case 26127:;case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");n.AlgIDHash=e._R(4);n.KeySize=e._R(4);n.ProviderType=e._R(4);e.l+=8;n.CSPName=e._R(r-e.l>>1,"utf16le");e.l=r;return n}function zs(e,t){var r={},n=e.l+t;e.l+=4;r.Salt=e.slice(e.l,e.l+16);e.l+=16;r.Verifier=e.slice(e.l,e.l+16);e.l+=16;e._R(4);r.VerifierHash=e.slice(e.l,n);e.l=n;return r}function qs(e){var t=Fs(e);switch(t.Minor){case 2:return[t.Minor,Ys(e,t)];case 3:return[t.Minor,Gs(e,t)];case 4:return[t.Minor,Xs(e,t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Ys(e){var t=e._R(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e._R(4);var n=Vs(e,r);var i=zs(e,e.length-e.l);return{t:"Std",h:n,v:i}}function Gs(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Xs(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e._R(e.length-e.l,"utf8");var i={};t.replace(we,function e(t){var r=Ee(t);switch(ke(r[0])){case"<?xml":break;case"<encryption":;case"</encryption>":break;case"<keyData":n.forEach(function(e){i[e]=r[e]});break;case"<dataIntegrity":i.encryptedHmacKey=r.encryptedHmacKey;i.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":;case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=r.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(r);break;default:throw r[0]}});return i}function Ks(e,t){var r={};var n=r.EncryptionVersionInfo=Fs(e,4);t-=4;if(n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e._R(4);t-=4;var i=e._R(4);t-=4;r.EncryptionHeader=Vs(e,i);t-=i;r.EncryptionVerifier=zs(e,t);return r}function Js(e){var t={};var r=t.EncryptionVersionInfo=Fs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;t.Salt=e._R(16);t.EncryptedVerifier=e._R(16);t.EncryptedVerifierHash=e._R(16);return t}function Qs(e){var t=0,r;var n=Ps(e);var i=n.length+1,a,o;var s,l,u;r=xe(i);r[0]=n.length;for(a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a){o=r[a];s=(t&16384)===0?0:1;l=t<<1&32767;u=s|l;t=u^o}return t^52811}var Zs=function(){var u=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0];var o=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163];var s=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628];var r=function(e){return(e/2|e*128)&255};var f=function(e,t){return r(e^t)};var c=function(e){var t=o[e.length-1];var r=104;for(var n=e.length-1;n>=0;--n){var i=e[n];for(var a=0;a!=7;++a){if(i&64)t^=s[r];i*=2;--r}}return t};return function(e){var t=Ps(e);var r=c(t);var n=t.length;var i=xe(16);for(var a=0;a!=16;++a)i[a]=0;var o,s,l;if((n&1)===1){o=r>>8;i[n]=f(u[0],o);--n;o=r&255;s=t[t.length-1];i[n]=f(s,o)}while(n>0){--n;o=r>>8;i[n]=f(t[n],o);--n;o=r&255;i[n]=f(t[n],o)}n=15;l=15-t.length;while(l>0){o=r>>8;i[n]=f(u[l],o);--n;--l;o=r&255;i[n]=f(t[n],o);--n;--l}return i}}();var el=function(e,t,r,n,i){if(!i)i=t;if(!n)n=Zs(e);var a,o;for(a=0;a!=t.length;++a){o=t[a];o^=n[r];o=(o>>5|o<<3)&255;i[a]=o;++r}return[i,r,n]};var tl=function(e){var r=0,n=Zs(e);return function(e){var t=el("",e,r,n);r=t[1];return t[0]}};function rl(e,t,r,n){var i={key:Yi(e),verificationBytes:Yi(e)};if(r.password)i.verifier=Qs(r.password);n.valid=i.verificationBytes===i.verifier;if(n.valid)n.insitu=tl(r.password);return i}function nl(e,t,r){var n=r||{};n.Info=e._R(2);e.l-=2;if(n.Info===1)n.Data=Js(e,t);else n.Data=Ks(e,t);return n}function il(e,t,r){var n={Type:r.biff>=8?e._R(2):0};if(n.Type)nl(e,t-2,n);else rl(e,r.biff>=8?t:t-2,r,n);return n}var al=function(){function r(e,t){switch(t.type){case"base64":return n(Te.decode(e),t);case"binary":return n(e,t);case"buffer":return n(e.toString("binary"),t);case"array":return n(H(e),t)}throw new Error("Unrecognized type "+t.type)}function n(e,t){var r=t||{};var n=r.dense?[]:{};var i={s:{c:0,r:0},e:{c:0,r:0}};if(!e.match(/\\trowd/))throw new Error("RTF missing table");n["!ref"]=yr(i);return n}function e(e,t){return Sr(r(e,t),t)}function t(e){var t=["{\\rtf1\\ansi"];var r=br(e["!ref"]),n;var i=Array.isArray(e);for(var a=r.s.r;a<=r.e.r;++a){t.push("\\trowd\\trautofit1");for(var o=r.s.c;o<=r.e.c;++o)t.push("\\cellx"+(o+1));t.push("\\pard\\intbl");for(o=r.s.c;o<=r.e.c;++o){var s=gr({r:a,c:o});n=i?(e[a]||[])[o]:e[s];if(!n||n.v==null&&(!n.f||n.F))continue;t.push(" "+(n.w||(Cr(n),n.w)));t.push("\\cell")}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:t}}();function ol(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function sl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function ll(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;var i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var s=0,l=0,u=i+a;l=o/(u>1?2-u:u);switch(i){case t:s=((r-n)/o+6)%6;break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4;break}return[s/6,l,u/2]}function ul(e){var t=e[0],r=e[1],n=e[2];var i=r*2*(n<.5?n:1-n),a=n-i/2;var o=[a,a,a],s=6*t;var l;if(r!==0)switch(s|0){case 0:;case 6:l=i*s;o[0]+=i;o[1]+=l;break;case 1:l=i*(2-s);o[0]+=l;o[1]+=i;break;case 2:l=i*(s-2);o[1]+=i;o[2]+=l;break;case 3:l=i*(4-s);o[1]+=l;o[2]+=i;break;case 4:l=i*(s-4);o[2]+=i;o[0]+=l;break;case 5:l=i*(6-s);o[2]+=l;o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function fl(e,t){if(t===0)return e;var r=ll(ol(e));if(t<0)r[2]=r[2]*(1+t);else r[2]=1-(1-r[2])*(1-t);return sl(ul(r))}var cl=6,dl=15,hl=1,vl=cl;function pl(e){return Math.floor((e+Math.round(128/vl)/256)*vl)}function gl(e){return Math.floor((e-5)/vl*100+.5)/100}function ml(e){return Math.round((e*vl+5)/vl*256)/256}function yl(e){return ml(gl(pl(e)))}function bl(e){var t=Math.abs(e-yl(e)),r=vl;if(t>.005)for(vl=hl;vl<dl;++vl)if(Math.abs(e-yl(e))<=t){t=Math.abs(e-yl(e));r=vl}vl=r}function wl(e){if(e.width){e.wpx=pl(e.width);e.wch=gl(e.wpx);e.MDW=vl}else if(e.wpx){e.wch=gl(e.wpx);e.width=ml(e.wch);e.MDW=vl}else if(typeof e.wch=="number"){e.width=ml(e.wch);e.wpx=pl(e.width);e.MDW=vl}if(e.customWidth)delete e.customWidth}var Cl=96,Sl=Cl;function El(e){return e*96/Sl}function kl(e){return e*Sl/96}var Tl={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _l(e,r,t,n){r.Borders=[];var i={};var a=false;(e[0].match(we)||[]).forEach(function(e){var t=Ee(e);switch(ke(t[0])){case"<borders":;case"<borders>":;case"</borders>":break;case"<border":;case"<border>":;case"<border/>":i={};if(t.diagonalUp)i.diagonalUp=Ye(t.diagonalUp);if(t.diagonalDown)i.diagonalDown=Ye(t.diagonalDown);r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":;case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":;case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":;case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":;case"<bottom>":break;case"</bottom>":break;case"<diagonal":;case"<diagonal>":;case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":;case"<horizontal>":;case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":;case"<vertical>":;case"<vertical/>":break;case"</vertical>":break;case"<start":;case"<start>":;case"<start/>":break;case"</start>":break;case"<end":;case"<end>":;case"<end/>":break;case"</end>":break;case"<color":;case"<color>":break;case"<color/>":;case"</color>":break;case"<extLst":;case"<extLst>":;case"</extLst>":break;case"<ext":a=true;break;case"</ext>":a=false;break;default:if(n&&n.WTF){if(!a)throw new Error("unrecognized "+t[0]+" in borders")}}})}function xl(e,r,t,n){r.Fills=[];var i={};var a=false;(e[0].match(we)||[]).forEach(function(e){var t=Ee(e);switch(ke(t[0])){case"<fills":;case"<fills>":;case"</fills>":break;case"<fill>":;case"<fill":;case"<fill/>":i={};r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":;case"</gradientFill>":r.Fills.push(i);i={};break;case"<patternFill":;case"<patternFill>":if(t.patternType)i.patternType=t.patternType;break;case"<patternFill/>":;case"</patternFill>":break;case"<bgColor":if(!i.bgColor)i.bgColor={};if(t.indexed)i.bgColor.indexed=parseInt(t.indexed,10);if(t.theme)i.bgColor.theme=parseInt(t.theme,10);if(t.tint)i.bgColor.tint=parseFloat(t.tint);if(t.rgb)i.bgColor.rgb=t.rgb.slice(-6);break;case"<bgColor/>":;case"</bgColor>":break;case"<fgColor":if(!i.fgColor)i.fgColor={};if(t.theme)i.fgColor.theme=parseInt(t.theme,10);if(t.tint)i.fgColor.tint=parseFloat(t.tint);if(t.rgb!=null)i.fgColor.rgb=t.rgb.slice(-6);break;case"<fgColor/>":;case"</fgColor>":break;case"<stop":;case"<stop/>":break;case"</stop>":break;case"<color":;case"<color/>":break;case"</color>":break;case"<extLst":;case"<extLst>":;case"</extLst>":break;case"<ext":a=true;break;case"</ext>":a=false;break;default:if(n&&n.WTF){if(!a)throw new Error("unrecognized "+t[0]+" in fills")}}})}function Dl(e,n,i,a){n.Fonts=[];var o={};var s=false;(e[0].match(we)||[]).forEach(function(e){var t=Ee(e);switch(ke(t[0])){case"<fonts":;case"<fonts>":;case"</fonts>":break;case"<font":;case"<font>":break;case"</font>":;case"<font/>":n.Fonts.push(o);o={};break;case"<name":if(t.val)o.name=Ge(t.val);break;case"<name/>":;case"</name>":break;case"<b":o.bold=t.val?Ye(t.val):1;break;case"<b/>":o.bold=1;break;case"<i":o.italic=t.val?Ye(t.val):1;break;case"<i/>":o.italic=1;break;case"<u":switch(t.val){case"none":o.underline=0;break;case"single":o.underline=1;break;case"double":o.underline=2;break;case"singleAccounting":o.underline=33;break;case"doubleAccounting":o.underline=34;break}break;case"<u/>":o.underline=1;break;case"<strike":o.strike=t.val?Ye(t.val):1;break;case"<strike/>":o.strike=1;break;case"<outline":o.outline=t.val?Ye(t.val):1;break;case"<outline/>":o.outline=1;break;case"<shadow":o.shadow=t.val?Ye(t.val):1;break;case"<shadow/>":o.shadow=1;break;case"<condense":o.condense=t.val?Ye(t.val):1;break;case"<condense/>":o.condense=1;break;case"<extend":o.extend=t.val?Ye(t.val):1;break;case"<extend/>":o.extend=1;break;case"<sz":if(t.val)o.sz=+t.val;break;case"<sz/>":;case"</sz>":break;case"<vertAlign":if(t.val)o.vertAlign=t.val;break;case"<vertAlign/>":;case"</vertAlign>":break;case"<family":if(t.val)o.family=parseInt(t.val,10);break;case"<family/>":;case"</family>":break;case"<scheme":if(t.val)o.scheme=t.val;break;case"<scheme/>":;case"</scheme>":break;case"<charset":if(t.val=="1")break;t.codepage=l[parseInt(t.val,10)];break;case"<color":if(!o.color)o.color={};if(t.auto)o.color.auto=Ye(t.auto);if(t.rgb)o.color.rgb=t.rgb.slice(-6);else if(t.indexed){o.color.index=parseInt(t.indexed,10);var r=xn[o.color.index];if(o.color.index==81)r=xn[1];if(!r)throw new Error(e);o.color.rgb=r[0].toString(16)+r[1].toString(16)+r[2].toString(16)}else if(t.theme){o.color.theme=parseInt(t.theme,10);if(t.tint)o.color.tint=parseFloat(t.tint);if(t.theme&&i.themeElements&&i.themeElements.clrScheme){o.color.rgb=fl(i.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0)}}break;case"<color/>":;case"</color>":break;case"<AlternateContent":s=true;break;case"</AlternateContent>":s=false;break;case"<extLst":;case"<extLst>":;case"</extLst>":break;case"<ext":s=true;break;case"</ext>":s=false;break;default:if(a&&a.WTF){if(!s)throw new Error("unrecognized "+t[0]+" in fonts")}}})}function Rl(e,t,r){t.NumberFmt=[];var n=ye(me._table);for(var i=0;i<n.length;++i)t.NumberFmt[n[i]]=me._table[n[i]];var a=e[0].match(we);if(!a)return;for(i=0;i<a.length;++i){var o=Ee(a[i]);switch(ke(o[0])){case"<numFmts":;case"</numFmts>":;case"<numFmts/>":;case"<numFmts>":break;case"<numFmt":{var s=Fe(Ge(o.formatCode)),l=parseInt(o.numFmtId,10);t.NumberFmt[l]=s;if(l>0){if(l>392){for(l=392;l>60;--l)if(t.NumberFmt[l]==null)break;t.NumberFmt[l]=s}me.load(s,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Il(r){var n=["<numFmts>"];[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)if(r[t]!=null)n[n.length]=lt("numFmt",null,{numFmtId:t,formatCode:$e(r[t])})});if(n.length===1)return"";n[n.length]="</numFmts>";n[0]=lt("numFmts",null,{count:n.length-2}).replace("/>",">");return n.join("")}var Ol=["numFmtId","fillId","fontId","borderId","xfId"];var Al=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Nl(e,i,a){i.CellXf=[];var o;var s=false;(e[0].match(we)||[]).forEach(function(e){var t=Ee(e),r=0;switch(ke(t[0])){case"<cellXfs":;case"<cellXfs>":;case"<cellXfs/>":;case"</cellXfs>":break;case"<xf":;case"<xf/>":o=t;delete o[0];for(r=0;r<Ol.length;++r)if(o[Ol[r]])o[Ol[r]]=parseInt(o[Ol[r]],10);for(r=0;r<Al.length;++r)if(o[Al[r]])o[Al[r]]=Ye(o[Al[r]]);if(o.numFmtId>392){for(r=392;r>60;--r)if(i.NumberFmt[o.numFmtId]==i.NumberFmt[r]){o.numFmtId=r;break}}i.CellXf.push(o);break;case"</xf>":break;case"<alignment":;case"<alignment/>":var n={};if(t.vertical)n.vertical=t.vertical;if(t.horizontal)n.horizontal=t.horizontal;if(t.textRotation!=null)n.textRotation=t.textRotation;if(t.indent)n.indent=t.indent;if(t.wrapText)n.wrapText=Ye(t.wrapText);o.alignment=n;break;case"</alignment>":break;case"<protection":break;case"</protection>":;case"<protection/>":break;case"<AlternateContent":s=true;break;case"</AlternateContent>":s=false;break;case"<extLst":;case"<extLst>":;case"</extLst>":break;case"<ext":s=true;break;case"</ext>":s=false;break;default:if(a&&a.WTF){if(!s)throw new Error("unrecognized "+t[0]+" in cellXfs")}}})}function Ml(e){var t=[];t[t.length]=lt("cellXfs",null);e.forEach(function(e){t[t.length]=lt("xf",null,e)});t[t.length]="</cellXfs>";if(t.length===2)return"";t[0]=lt("cellXfs",null,{count:t.length-2}).replace("/>",">");return t.join("")}var Ll=function e(){var o=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/;var s=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/;var l=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/;var u=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/;var f=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function e(t,r,n){var i={};if(!t)return i;t=t.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var a;if(a=t.match(o))Rl(a,i,n);if(a=t.match(u))Dl(a,i,r,n);if(a=t.match(l))xl(a,i,r,n);if(a=t.match(f))_l(a,i,r,n);if(a=t.match(s))Nl(a,i,n);return i}}();var Pl=lt("styleSheet",null,{xmlns:ct.main[0],"xmlns:vt":ct.vt});Bn.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";function Fl(e,t){var r=[ve,Pl],n;if(e.SSF&&(n=Il(e.SSF))!=null)r[r.length]=n;r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>';r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>';r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>';if(n=Ml(t.cellXfs))r[r.length]=n;r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>';r[r.length]='<dxfs count="0"/>';r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>';if(r.length>2){r[r.length]="</styleSheet>";r[1]=r[1].replace("/>",">")}return r.join("")}function Bl(e,t){var r=e._R(2);var n=_r(e,t-2);return[r,n]}function Hl(e,t,r){if(!r)r=Kt(6+4*t.length);r._W(2,e);xr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;if(r.l==null)r.l=r.length;return n}function $l(e,t,r){var n={};n.sz=e._R(2)/20;var i=Zr(e,2,r);if(i.fItalic)n.italic=1;if(i.fCondense)n.condense=1;if(i.fExtend)n.extend=1;if(i.fShadow)n.shadow=1;if(i.fOutline)n.outline=1;if(i.fStrikeout)n.strike=1;var a=e._R(2);if(a===700)n.bold=1;switch(e._R(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e._R(1);if(o!=0)n.underline=o;var s=e._R(1);if(s>0)n.family=s;var l=e._R(1);if(l>0)n.charset=l;e.l++;n.color=Jr(e,8);switch(e._R(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}n.name=_r(e,t-21);return n}function Wl(e,t){if(!t)t=Kt(25+4*32);t._W(2,e.sz*20);en(e,t);t._W(2,e.bold?700:400);var r=0;if(e.vertAlign=="superscript")r=1;else if(e.vertAlign=="subscript")r=2;t._W(2,r);t._W(1,e.underline||0);t._W(1,e.family||0);t._W(1,e.charset||0);t._W(1,0);Qr(e.color,t);var n=0;if(e.scheme=="major")n=1;if(e.scheme=="minor")n=2;t._W(1,n);xr(e.name,t);return t.length>t.l?t.slice(0,t.l):t}var Ul=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];var jl=I(Ul);var Vl=Xt;function zl(e,t){if(!t)t=Kt(4*3+8*7+16*1);var r=jl[e.patternType];if(r==null)r=40;t._W(4,r);var n=0;if(r!=40){Qr({auto:1},t);Qr({auto:1},t);for(;n<12;++n)t._W(4,0)}else{for(;n<4;++n)t._W(4,0);for(;n<12;++n)t._W(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ql(e,t){var r=e.l+t;var n=e._R(2);var i=e._R(2);e.l=r;return{ixfe:n,numFmtId:i}}function Yl(e,t,r){if(!r)r=Kt(16);r._W(2,t||0);r._W(2,e.numFmtId||0);r._W(2,0);r._W(2,0);r._W(2,0);r._W(1,0);r._W(1,0);var n=0;r._W(1,n);r._W(1,0);r._W(1,0);r._W(1,0);return r}function Gl(e,t){if(!t)t=Kt(10);t._W(1,0);t._W(1,0);t._W(4,0);t._W(4,0);return t}var Xl=Xt;function Kl(e,t){if(!t)t=Kt(51);t._W(1,0);Gl(null,t);Gl(null,t);Gl(null,t);Gl(null,t);Gl(null,t);return t.length>t.l?t.slice(0,t.l):t}function Jl(e,t){if(!t)t=Kt(12+4*10);t._W(4,e.xfId);t._W(2,1);t._W(1,+e.builtinId);t._W(1,0);Hr(e.name||"",t);return t.length>t.l?t.slice(0,t.l):t}function Ql(e,t,r){var n=Kt(4+256*2*4);n._W(4,e);Hr(t,n);Hr(r,n);return n.length>n.l?n.slice(0,n.l):n}function Zl(e,i,a){var o={};o.NumberFmt=[];for(var t in me._table)o.NumberFmt[t]=me._table[t];o.CellXf=[];o.Fonts=[];var s=[];var l=false;Jt(e,function e(t,r,n){switch(n){case 44:o.NumberFmt[t[0]]=t[1];me.load(t[1],t[0]);break;case 43:o.Fonts.push(t);if(t.color.theme!=null&&i&&i.themeElements&&i.themeElements.clrScheme){t.color.rgb=fl(i.themeElements.clrScheme[t.color.theme].rgb,t.color.tint||0)}break;case 1025:break;case 45:break;case 46:break;case 47:if(s[s.length-1]=="BrtBeginCellXFs"){o.CellXf.push(t)}break;case 48:;case 507:;case 572:;case 475:break;case 1171:;case 2102:;case 1130:;case 512:;case 2095:;case 3072:break;case 35:l=true;break;case 36:l=false;break;case 37:s.push(r);l=true;break;case 38:s.pop();l=false;break;default:if((r||"").indexOf("Begin")>0)s.push(r);else if((r||"").indexOf("End")>0)s.pop();else if(!l||a.WTF&&s[s.length-1]!="BrtACBegin")throw new Error("Unexpected record "+n+" "+r)}});return o}function eu(r,n){if(!n)return;var i=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)if(n[t]!=null)++i});if(i==0)return;Zt(r,"BrtBeginFmts",Tr(i));[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)if(n[t]!=null)Zt(r,"BrtFmt",Hl(t,n[t]))});Zt(r,"BrtEndFmts")}function tu(e){var t=1;if(t==0)return;Zt(e,"BrtBeginFonts",Tr(t));Zt(e,"BrtFont",Wl({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}));Zt(e,"BrtEndFonts")}function ru(e){var t=2;if(t==0)return;Zt(e,"BrtBeginFills",Tr(t));Zt(e,"BrtFill",zl({patternType:"none"}));Zt(e,"BrtFill",zl({patternType:"gray125"}));Zt(e,"BrtEndFills")}function nu(e){var t=1;if(t==0)return;Zt(e,"BrtBeginBorders",Tr(t));Zt(e,"BrtBorder",Kl({}));Zt(e,"BrtEndBorders")}function iu(e){var t=1;Zt(e,"BrtBeginCellStyleXFs",Tr(t));Zt(e,"BrtXF",Yl({numFmtId:0,fontId:0,fillId:0,borderId:0},65535));Zt(e,"BrtEndCellStyleXFs")}function au(t,e){Zt(t,"BrtBeginCellXFs",Tr(e.length));e.forEach(function(e){Zt(t,"BrtXF",Yl(e,0))});Zt(t,"BrtEndCellXFs")}function ou(e){var t=1;Zt(e,"BrtBeginStyles",Tr(t));Zt(e,"BrtStyle",Jl({xfId:0,builtinId:0,name:"Normal"}));Zt(e,"BrtEndStyles")}function su(e){var t=0;Zt(e,"BrtBeginDXFs",Tr(t));Zt(e,"BrtEndDXFs")}function lu(e){var t=0;Zt(e,"BrtBeginTableStyles",Ql(t,"TableStyleMedium9","PivotStyleMedium4"));Zt(e,"BrtEndTableStyles")}function uu(){return}function fu(e,t){var r=Qt();Zt(r,"BrtBeginStyleSheet");eu(r,e.SSF);tu(r,e);ru(r,e);nu(r,e);iu(r,e);au(r,t.cellXfs);ou(r,e);su(r,e);lu(r,e);uu(r,e);Zt(r,"BrtEndStyleSheet");return r.end()}Bn.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var cu=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function du(e,r,n){r.themeElements.clrScheme=[];var i={};(e[0].match(we)||[]).forEach(function(e){var t=Ee(e);switch(t[0]){case"<a:clrScheme":;case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=t.val;break;case"<a:sysClr":i.rgb=t.lastClr;break;case"<a:dk1>":;case"</a:dk1>":;case"<a:lt1>":;case"</a:lt1>":;case"<a:dk2>":;case"</a:dk2>":;case"<a:lt2>":;case"</a:lt2>":;case"<a:accent1>":;case"</a:accent1>":;case"<a:accent2>":;case"</a:accent2>":;case"<a:accent3>":;case"</a:accent3>":;case"<a:accent4>":;case"</a:accent4>":;case"<a:accent5>":;case"</a:accent5>":;case"<a:accent6>":;case"</a:accent6>":;case"<a:hlink>":;case"</a:hlink>":;case"<a:folHlink>":;case"</a:folHlink>":if(t[0].charAt(1)==="/"){r.themeElements.clrScheme[cu.indexOf(t[0])]=i;i={}}else{i.name=t[0].slice(3,t[0].length-1)}break;default:if(n&&n.WTF)throw new Error("Unrecognized "+t[0]+" in clrScheme")}})}function hu(){}function vu(){}var pu=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/;var gu=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/;var mu=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function yu(t,r,n){r.themeElements={};var i;[["clrScheme",pu,du],["fontScheme",gu,hu],["fmtScheme",mu,vu]].forEach(function(e){if(!(i=t.match(e[1])))throw new Error(e[0]+" not found in themeElements");e[2](i,r,n)})}var bu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function wu(e,t){if(!e||e.length===0)return wu(Cu());var r;var n={};if(!(r=e.match(bu)))throw new Error("themeElements not found in theme");yu(r[0],n,t);n.raw=e;return n}function Cu(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ve];r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">';r[r.length]="<a:themeElements>";r[r.length]='<a:clrScheme name="Office">';r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>';r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>';r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>';r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>';r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>';r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>';r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>';r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>';r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>';r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>';r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>';r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>';r[r.length]="</a:clrScheme>";r[r.length]='<a:fontScheme name="Office">';r[r.length]="<a:majorFont>";r[r.length]='<a:latin typeface="Cambria"/>';r[r.length]='<a:ea typeface=""/>';r[r.length]='<a:cs typeface=""/>';r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>';r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>';r[r.length]='<a:font script="Hans" typeface="å®ä½"/>';r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>';r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>';r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>';r[r.length]='<a:font script="Thai" typeface="Tahoma"/>';r[r.length]='<a:font script="Ethi" typeface="Nyala"/>';r[r.length]='<a:font script="Beng" typeface="Vrinda"/>';r[r.length]='<a:font script="Gujr" typeface="Shruti"/>';r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>';r[r.length]='<a:font script="Knda" typeface="Tunga"/>';r[r.length]='<a:font script="Guru" typeface="Raavi"/>';r[r.length]='<a:font script="Cans" typeface="Euphemia"/>';r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>';r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>';r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>';r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>';r[r.length]='<a:font script="Deva" typeface="Mangal"/>';r[r.length]='<a:font script="Telu" typeface="Gautami"/>';r[r.length]='<a:font script="Taml" typeface="Latha"/>';r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>';r[r.length]='<a:font script="Orya" typeface="Kalinga"/>';r[r.length]='<a:font script="Mlym" typeface="Kartika"/>';r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>';r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>';r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>';r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>';r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>';r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>';r[r.length]="</a:majorFont>";r[r.length]="<a:minorFont>";r[r.length]='<a:latin typeface="Calibri"/>';r[r.length]='<a:ea typeface=""/>';r[r.length]='<a:cs typeface=""/>';r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>';r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>';r[r.length]='<a:font script="Hans" typeface="å®ä½"/>';r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>';r[r.length]='<a:font script="Arab" typeface="Arial"/>';r[r.length]='<a:font script="Hebr" typeface="Arial"/>';r[r.length]='<a:font script="Thai" typeface="Tahoma"/>';r[r.length]='<a:font script="Ethi" typeface="Nyala"/>';r[r.length]='<a:font script="Beng" typeface="Vrinda"/>';r[r.length]='<a:font script="Gujr" typeface="Shruti"/>';r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>';r[r.length]='<a:font script="Knda" typeface="Tunga"/>';r[r.length]='<a:font script="Guru" typeface="Raavi"/>';r[r.length]='<a:font script="Cans" typeface="Euphemia"/>';r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>';r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>';r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>';r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>';r[r.length]='<a:font script="Deva" typeface="Mangal"/>';r[r.length]='<a:font script="Telu" typeface="Gautami"/>';r[r.length]='<a:font script="Taml" typeface="Latha"/>';r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>';r[r.length]='<a:font script="Orya" typeface="Kalinga"/>';r[r.length]='<a:font script="Mlym" typeface="Kartika"/>';r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>';r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>';r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>';r[r.length]='<a:font script="Viet" typeface="Arial"/>';r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>';r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>';r[r.length]="</a:minorFont>";r[r.length]="</a:fontScheme>";r[r.length]='<a:fmtScheme name="Office">';r[r.length]="<a:fillStyleLst>";r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>';r[r.length]='<a:gradFill rotWithShape="1">';r[r.length]="<a:gsLst>";r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>';r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>';r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';r[r.length]="</a:gsLst>";r[r.length]='<a:lin ang="16200000" scaled="1"/>';r[r.length]="</a:gradFill>";r[r.length]='<a:gradFill rotWithShape="1">';r[r.length]="<a:gsLst>";r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>';r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';r[r.length]="</a:gsLst>";r[r.length]='<a:lin ang="16200000" scaled="0"/>';r[r.length]="</a:gradFill>";r[r.length]="</a:fillStyleLst>";r[r.length]="<a:lnStyleLst>";r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>';r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>';r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>';r[r.length]="</a:lnStyleLst>";r[r.length]="<a:effectStyleLst>";r[r.length]="<a:effectStyle>";r[r.length]="<a:effectLst>";r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>';r[r.length]="</a:effectLst>";r[r.length]="</a:effectStyle>";r[r.length]="<a:effectStyle>";r[r.length]="<a:effectLst>";r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>';r[r.length]="</a:effectLst>";r[r.length]="</a:effectStyle>";r[r.length]="<a:effectStyle>";r[r.length]="<a:effectLst>";r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>';r[r.length]="</a:effectLst>";r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>';r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>';r[r.length]="</a:effectStyle>";r[r.length]="</a:effectStyleLst>";r[r.length]="<a:bgFillStyleLst>";r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>';r[r.length]='<a:gradFill rotWithShape="1">';r[r.length]="<a:gsLst>";r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>';r[r.length]="</a:gsLst>";r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>';r[r.length]="</a:gradFill>";r[r.length]='<a:gradFill rotWithShape="1">';r[r.length]="<a:gsLst>";r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>';r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>';r[r.length]="</a:gsLst>";r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>';r[r.length]="</a:gradFill>";r[r.length]="</a:bgFillStyleLst>";r[r.length]="</a:fmtScheme>";r[r.length]="</a:themeElements>";r[r.length]="<a:objectDefaults>";r[r.length]="<a:spDef>";r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>';r[r.length]="</a:spDef>";r[r.length]="<a:lnDef>";r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>';r[r.length]="</a:lnDef>";r[r.length]="</a:objectDefaults>";r[r.length]="<a:extraClrSchemeLst/>";r[r.length]="</a:theme>";return r.join("")}function Su(e,t,r){var n=e.l+t;var i=e._R(4);if(i===124226)return;if(!r.cellStyles||!fe){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=new fe(a)}catch(e){return}var s=se(o,"theme/theme/theme1.xml",true);if(!s)return;return wu(s,r)}function Eu(e){return e._R(4)}function ku(e){var t={};t.xclrType=e._R(2);t.nTintShade=e._R(2);switch(t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Tu(e,4);break;case 2:t.xclrValue=da(e,4);break;case 3:t.xclrValue=Eu(e,4);break;case 4:e.l+=4;break}e.l+=8;return t}function Tu(e,t){return Xt(e,t)}function _u(e,t){return Xt(e,t)}function xu(e){var t=e._R(2);var r=e._R(2)-4;var n=[t];switch(t){case 4:;case 5:;case 7:;case 8:;case 9:;case 10:;case 11:;case 13:n[1]=ku(e,r);break;case 6:n[1]=_u(e,r);break;case 14:;case 15:n[1]=e._R(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Du(e,t){var r=e.l+t;e.l+=2;var n=e._R(2);e.l+=2;var i=e._R(2);var a=[];while(i-- >0)a.push(xu(e,r-e.l));return{ixfe:n,ext:a}}function Ru(e,t){t.forEach(function(e){switch(e[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Iu(e){var r=[];if(!e)return r;var n=1;(e.match(we)||[]).forEach(function(e){var t=Ee(e);switch(t[0]){case"<?xml":break;case"<calcChain":;case"<calcChain>":;case"</calcChain>":break;case"<c":delete t[0];if(t.i)n=t.i;else t.i=n;r.push(t);break}});return r}function Ou(e){var t={};t.i=e._R(4);var r={};r.r=e._R(4);r.c=e._R(4);t.r=gr(r);var n=e._R(1);if(n&2)t.l="1";if(n&8)t.a="1";return t}function Au(e,t,i){var a=[];var o=false;Jt(e,function e(t,r,n){switch(n){case 63:a.push(t);break;default:if((r||"").indexOf("Begin")>0){}else if((r||"").indexOf("End")>0){}else if(!o||i.WTF)throw new Error("Unexpected record "+n+" "+r)}});return a}function Nu(){}function Mu(e,t,r,n){if(!e)return e;var i=n||{};var a=false,o=false;Jt(e,function e(t,r,n){if(o)return;switch(n){case 359:;case 363:;case 364:;case 366:;case 367:;case 368:;case 369:;case 370:;case 371:;case 472:;case 577:;case 578:;case 579:;case 580:;case 581:;case 582:;case 583:;case 584:;case 585:;case 586:;case 587:break;case 35:a=true;break;case 36:a=false;break;default:if((r||"").indexOf("Begin")>0){}else if((r||"").indexOf("End")>0){}else if(!a||i.WTF)throw new Error("Unexpected record "+n.toString(16)+" "+r)}},i)}Bn.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image";Bn.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";function Lu(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Pu=1024;function Fu(e,t){var r=[21600,21600];var n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(",");var o=[lt("xml",null,{"xmlns:v":dt.v,"xmlns:o":dt.o,"xmlns:x":dt.x,"xmlns:mv":dt.mv}).replace(/\/>/,">"),lt("o:shapelayout",lt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),lt("v:shapetype",[lt("v:stroke",null,{joinstyle:"miter"}),lt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];while(Pu<e*1e3)Pu+=1e3;t.forEach(function(e){var t=pr(e[0]);var r={color2:"#BEFF82",type:"gradient"};if(r.type=="gradient")r.angle="-180";var n=r.type=="gradient"?lt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null;var i=lt("v:fill",n,r);var a={on:"t",obscured:"t"};++Pu;o=o.concat(["<v:shape"+st({id:"_x0000_s"+Pu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,lt("v:shadow",null,a),lt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ot("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),ot("x:AutoFill","False"),ot("x:Row",String(t.r)),ot("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])});o.push("</xml>");return o.join("")}Bn.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";function Bu(a,e){var o=Array.isArray(a);var s;e.forEach(function(e){var t=pr(e.ref);if(o){if(!a[t.r])a[t.r]=[];s=a[t.r][t.c]}else s=a[e.ref];if(!s){s={t:"z"};if(o)a[t.r][t.c]=s;else a[e.ref]=s;var r=br(a["!ref"]||"BDWGO1000001:A1");if(r.s.r>t.r)r.s.r=t.r;if(r.e.r<t.r)r.e.r=t.r;if(r.s.c>t.c)r.s.c=t.c;if(r.e.c<t.c)r.e.c=t.c;var n=yr(r);if(n!==a["!ref"])a["!ref"]=n}if(!s.c)s.c=[];var i={a:e.author,t:e.t,r:e.r};if(e.h)i.h=e.h;s.c.push(i)})}function Hu(e,s){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var l=[];var u=[];var t=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);if(t&&t[1])t[1].split(/<\/\w*:?author>/).forEach(function(e){if(e===""||e.trim()==="")return;var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);if(t)l.push(t[1])});var r=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);if(r&&r[1])r[1].split(/<\/\w*:?comment>/).forEach(function(e){if(e===""||e.trim()==="")return;var t=e.match(/<(?:\w+:)?comment[^>]*>/);if(!t)return;var r=Ee(t[0]);var n={author:r.authorId&&l[r.authorId]||"sheetjsghost",ref:r.ref,guid:r.guid};var i=pr(r.ref);if(s.sheetRows&&s.sheetRows<=i.r)return;var a=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/);var o=!!a&&!!a[1]&&ks(a[1])||{r:"",t:"",h:""};n.r=o.r;if(o.r=="<t></t>")o.t=o.h="";n.t=o.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n");if(s.cellHTML)n.h=o.h;u.push(n)});return u}var $u=lt("comments",null,{xmlns:ct.main[0]});function Wu(e){var r=[ve,$u];var n=[];r.push("<authors>");e.forEach(function(e){e[1].forEach(function(e){var t=$e(e.a);if(n.indexOf(t)>-1)return;n.push(t);r.push("<author>"+t+"</author>")})});r.push("</authors>");r.push("<commentList>");e.forEach(function(t){t[1].forEach(function(e){r.push('<comment ref="'+t[0]+'" authorId="'+n.indexOf($e(e.a))+'"><text>');r.push(ot("t",e.t==null?"":$e(e.t)));r.push("</text></comment>")})});r.push("</commentList>");if(r.length>2){r[r.length]="</comments>";r[1]=r[1].replace("/>",">")}return r.join("")}function Uu(e){var t={};t.iauthor=e._R(4);var r=Yr(e,16);t.rfx=r.s;t.ref=gr(r.s);e.l+=16;return t}function ju(e,t){if(t==null)t=Kt(36);t._W(4,e[1].iauthor);Gr(e[0],t);t._W(4,0);t._W(4,0);t._W(4,0);t._W(4,0);return t}var Vu=_r;function zu(e){return xr(e.slice(0,54))}function qu(e,i){var a=[];var o=[];var s={};var l=false;Jt(e,function e(t,r,n){switch(n){case 632:o.push(t);break;case 635:s=t;break;case 637:s.t=t.t;s.h=t.h;s.r=t.r;break;case 636:s.author=o[s.iauthor];delete s.iauthor;if(i.sheetRows&&s.rfx&&i.sheetRows<=s.rfx.r)break;if(!s.t)s.t="";delete s.rfx;a.push(s);break;case 3072:break;case 35:l=true;break;case 36:l=false;break;case 37:break;case 38:break;default:if((r||"").indexOf("Begin")>0){}else if((r||"").indexOf("End")>0){}else if(!l||i.WTF)throw new Error("Unexpected record "+n+" "+r)}});return a}function Yu(e){var n=Qt();var i=[];Zt(n,"BrtBeginComments");Zt(n,"BrtBeginCommentAuthors");e.forEach(function(e){e[1].forEach(function(e){if(i.indexOf(e.a)>-1)return;i.push(e.a.slice(0,54));Zt(n,"BrtCommentAuthor",zu(e.a))})});Zt(n,"BrtEndCommentAuthors");Zt(n,"BrtBeginCommentList");e.forEach(function(r){r[1].forEach(function(e){e.iauthor=i.indexOf(e.a);var t={s:pr(r[0]),e:pr(r[0])};Zt(n,"BrtBeginComment",ju([t,e]));if(e.t&&e.t.length>0)Zt(n,"BrtCommentText",Nr(e));Zt(n,"BrtEndComment");delete e.iauthor})});Zt(n,"BrtEndCommentList");Zt(n,"BrtEndComments");return n.end()}var Gu="application/vnd.ms-office.vbaProject";function Xu(n){var i=Me.utils.cfb_new({root:"R"});n.FullPaths.forEach(function(e,t){if(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))return;var r=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Me.utils.cfb_add(i,r,n.FileIndex[t].content)});return Me.write(i)}function Ku(n,i){i.FullPaths.forEach(function(e,t){if(t==0)return;var r=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");if(r.slice(-1)!=="/")Me.utils.cfb_add(n,r,i.FileIndex[t].content)})}var Ju=["xlsb","xlsm","xlam","biff8","xla"];Bn.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet";Bn.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";function Qu(){return{"!type":"dialog"}}function Zu(){return{"!type":"dialog"}}function ef(){return{"!type":"macro"}}function tf(){return{"!type":"macro"}}var rf=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g;var l={r:0,c:0};function i(e,t,r,n){var i=false,a=false;if(r.length==0)a=true;else if(r.charAt(0)=="["){a=true;r=r.slice(1,-1)}if(n.length==0)i=true;else if(n.charAt(0)=="["){i=true;n=n.slice(1,-1)}var o=r.length>0?parseInt(r,10)|0:0,s=n.length>0?parseInt(n,10)|0:0;if(i)s+=l.c;else--s;if(a)o+=l.r;else--o;return t+(i?"":"$")+cr(s)+(a?"":"$")+sr(o)}return function e(t,r){l=r;return t.replace(n,i)}}();var nf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g;var af=function(){return function e(t,f){return t.replace(nf,function(e,t,r,n,i,a){var o=fr(n)-(r?0:f.c);var s=or(a)-(i?0:f.r);var l=s==0?"":!i?"["+s+"]":s+1;var u=o==0?"":!r?"["+o+"]":o+1;return t+"R"+l+"C"+u})}}();function of(e,o){return e.replace(nf,function(e,t,r,n,i,a){return t+(r=="$"?r+n:cr(fr(n)+o.c))+(i=="$"?i+a:sr(or(a)+o.r))})}function sf(e,t,r){var n=mr(t),i=n.s,a=pr(r);var o={r:a.r-i.r,c:a.c-i.c};return of(e,o)}function lf(e){if(e.length==1)return false;return true}function uf(e){return e.replace(/_xlfn\./g,"")}function ff(e){e.l+=1;return}function cf(e,t){var r=e._R(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function df(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return hf(e,t,r);else if(r.biff==12)n=4}var i=e._R(n),a=e._R(n);var o=cf(e,2);var s=cf(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function hf(e){var t=cf(e,2),r=cf(e,2);var n=e._R(1);var i=e._R(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function vf(e,t,r){if(r.biff<8)return hf(e,t,r);var n=e._R(r.biff==12?4:2),i=e._R(r.biff==12?4:2);var a=cf(e,2);var o=cf(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function pf(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return gf(e,t,r);var n=e._R(r&&r.biff==12?4:2);var i=cf(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function gf(e){var t=cf(e,2);var r=e._R(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function mf(e){var t=e._R(2);var r=e._R(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function yf(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bf(e,t,r);var i=e._R(n>=12?4:2);var a=e._R(2);var o=(a&16384)>>14,s=(a&32768)>>15;a&=16383;if(s==1)while(i>524287)i-=1048576;if(o==1)while(a>8191)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function bf(e){var t=e._R(2);var r=e._R(1);var n=(t&32768)>>15,i=(t&16384)>>14;t&=16383;if(n==1&&t>=8192)t=t-16384;if(i==1&&r>=128)r=r-256;return{r:t,c:r,cRel:i,rRel:n}}function wf(e,t,r){var n=(e[e.l++]&96)>>5;var i=df(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Cf(e,t,r){var n=(e[e.l++]&96)>>5;var i=e._R(2,"i");var a=8;if(r)switch(r.biff){case 5:e.l+=12;a=6;break;case 12:a=12;break}var o=df(e,a,r);return[n,i,o]}function Sf(e,t,r){var n=(e[e.l++]&96)>>5;e.l+=r&&r.biff>8?12:r.biff<8?6:8;return[n]}function Ef(e,t,r){var n=(e[e.l++]&96)>>5;var i=e._R(2);var a=8;if(r)switch(r.biff){case 5:e.l+=12;a=6;break;case 12:a=12;break}e.l+=a;return[n,i]}function kf(e,t,r){var n=(e[e.l++]&96)>>5;var i=vf(e,t-1,r);return[n,i]}function Tf(e,t,r){var n=(e[e.l++]&96)>>5;e.l+=r.biff==2?6:r.biff==12?14:7;return[n]}function _f(e){var t=e[e.l+1]&1;var r=1;e.l+=4;return[t,r]}function xf(e,t,r){e.l+=2;var n=e._R(r&&r.biff==2?1:2);var i=[];for(var a=0;a<=n;++a)i.push(e._R(r&&r.biff==2?1:2));return i}function Df(e,t,r){var n=e[e.l+1]&255?1:0;e.l+=2;return[n,e._R(r&&r.biff==2?1:2)]}function Rf(e,t,r){var n=e[e.l+1]&255?1:0;e.l+=2;return[n,e._R(r&&r.biff==2?1:2)]}function If(e){var t=e[e.l+1]&255?1:0;e.l+=2;return[t,e._R(2)]}function Of(e,t,r){var n=e[e.l+1]&255?1:0;e.l+=r&&r.biff==2?3:4;return[n]}function Af(e){var t=e._R(1),r=e._R(1);return[t,r]}function Nf(e){e._R(2);return Af(e,2)}function Mf(e){e._R(2);return Af(e,2)}function Lf(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=pf(e,0,r);return[n,i]}function Pf(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=yf(e,0,r);return[n,i]}function Ff(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e._R(2);if(r&&r.biff==5)e.l+=12;var a=pf(e,0,r);return[n,i,a]}function Bf(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e._R(r&&r.biff<=3?1:2);return[td[i],ed[i],n]}function Hf(e,t,r){var n=e[e.l++];var i=e._R(1),a=r&&r.biff<=3?[n==88?-1:0,e._R(1)]:$f(e);return[i,(a[0]===0?ed:Zc)[a[1]]]}function $f(e){return[e[e.l+1]>>7,e._R(2)&32767]}function Wf(e,t,r){e.l+=r&&r.biff==2?3:4;return}function Uf(e,t,r){e.l++;if(r&&r.biff==12)return[e._R(4,"i"),0];var n=e._R(2);var i=e._R(r&&r.biff==2?1:2);return[n,i]}function jf(e){e.l++;return Dn[e._R(1)]}function Vf(e){e.l++;return e._R(2)}function zf(e){e.l++;return e._R(1)!==0}function qf(e){e.l++;return Xr(e,8)}function Yf(e,t,r){e.l++;return Qi(e,t-1,r)}function Gf(e,t){var r=[e._R(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zi(e,1)?"TRUE":"FALSE";if(t!=12)e.l+=7;break;case 37:;case 16:r[1]=Dn[e[e.l]];e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Xr(e,8);break;case 2:r[1]=na(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Xf(e,t,r){var n=e._R(r.biff==12?4:2);var i=[];for(var a=0;a!=n;++a)i.push((r.biff==12?Yr:Ca)(e,8));return i}function Kf(e,t,r){var n=0,i=0;if(r.biff==12){n=e._R(4);i=e._R(4)}else{i=1+e._R(1);n=1+e._R(2)}if(r.biff>=2&&r.biff<8){--n;if(--i==0)i=256}for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=Gf(e,r.biff);return o}function Jf(e,t,r){var n=e._R(1)>>>5&3;var i=!r||r.biff>=8?4:2;var a=e._R(i);switch(r.biff){case 2:e.l+=5;break;case 3:;case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function Qf(e,t,r){if(r.biff==5)return Zf(e,t,r);var n=e._R(1)>>>5&3;var i=e._R(2);var a=e._R(4);return[n,i,a]}function Zf(e){var t=e._R(1)>>>5&3;var r=e._R(2,"i");e.l+=8;var n=e._R(2);e.l+=12;return[t,r,n]}function ec(e,t,r){var n=e._R(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e._R(r&&r.biff==2?1:2);return[n,i]}function tc(e,t,r){var n=e._R(1)>>>5&3;var i=e._R(r&&r.biff==2?1:2);return[n,i]}function rc(e,t,r){var n=e._R(1)>>>5&3;e.l+=4;if(r.biff<8)e.l--;if(r.biff==12)e.l+=2;return[n]}function nc(e,t,r){var n=(e[e.l++]&96)>>5;var i=e._R(2);var a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}e.l+=a;return[n,i]}var ic=Xt;var ac=Xt;var oc=Xt;function sc(e,t,r){e.l+=2;return[mf(e,4,r)]}function lc(e){e.l+=6;return[]}var uc=sc;var fc=lc;var cc=lc;var dc=sc;function hc(e){e.l+=2;return[Yi(e),e._R(2)&1]}var vc=sc;var pc=hc;var gc=lc;var mc=sc;var yc=sc;var bc=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wc(e){e.l+=2;var t=e._R(2);var r=e._R(2);var n=e._R(4);var i=e._R(2);var a=e._R(2);var o=bc[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function Cc(e){e.l+=2;return[e._R(4)]}function Sc(e,t,r){e.l+=5;e.l+=2;e.l+=r.biff==2?1:4;return["PTGSHEET"]}function Ec(e,t,r){e.l+=r.biff==2?4:5;return["PTGENDSHEET"]}function kc(e){var t=e._R(1)>>>5&3;var r=e._R(2);return[t,r]}function Tc(e){var t=e._R(1)>>>5&3;var r=e._R(2);return[t,r]}function _c(e){e.l+=4;return[0,0]}var xc={1:{n:"PtgExp",f:Uf},2:{n:"PtgTbl",f:oc},3:{n:"PtgAdd",f:ff},4:{n:"PtgSub",f:ff},5:{n:"PtgMul",f:ff},6:{n:"PtgDiv",f:ff},7:{n:"PtgPower",f:ff},8:{n:"PtgConcat",f:ff},9:{n:"PtgLt",f:ff},10:{n:"PtgLe",f:ff},11:{n:"PtgEq",f:ff},12:{n:"PtgGe",f:ff},13:{n:"PtgGt",f:ff},14:{n:"PtgNe",f:ff},15:{n:"PtgIsect",f:ff},16:{n:"PtgUnion",f:ff},17:{n:"PtgRange",f:ff},18:{n:"PtgUplus",f:ff},19:{n:"PtgUminus",f:ff},20:{n:"PtgPercent",f:ff},21:{n:"PtgParen",f:ff},22:{n:"PtgMissArg",f:ff},23:{n:"PtgStr",f:Yf},26:{n:"PtgSheet",f:Sc},27:{n:"PtgEndSheet",f:Ec},28:{n:"PtgErr",f:jf},29:{n:"PtgBool",f:zf},30:{n:"PtgInt",f:Vf},31:{n:"PtgNum",f:qf},32:{n:"PtgArray",f:Tf},33:{n:"PtgFunc",f:Bf},34:{n:"PtgFuncVar",f:Hf},35:{n:"PtgName",f:Jf},36:{n:"PtgRef",f:Lf},37:{n:"PtgArea",f:wf},38:{n:"PtgMemArea",f:ec},39:{n:"PtgMemErr",f:ic},40:{n:"PtgMemNoMem",f:ac},41:{n:"PtgMemFunc",f:tc},42:{n:"PtgRefErr",f:rc},43:{n:"PtgAreaErr",f:Sf},44:{n:"PtgRefN",f:Pf},45:{n:"PtgAreaN",f:kf},46:{n:"PtgMemAreaN",f:kc},47:{n:"PtgMemNoMemN",f:Tc},57:{n:"PtgNameX",f:Qf},58:{n:"PtgRef3d",f:Ff},59:{n:"PtgArea3d",f:Cf},60:{n:"PtgRefErr3d",f:nc},61:{n:"PtgAreaErr3d",f:Ef},255:{}};var Dc={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};(function(){for(var e in Dc)xc[e]=xc[Dc[e]]})();var Rc={1:{n:"PtgElfLel",f:hc},2:{n:"PtgElfRw",f:mc},3:{n:"PtgElfCol",f:uc},6:{n:"PtgElfRwV",f:yc},7:{n:"PtgElfColV",f:dc},10:{n:"PtgElfRadical",f:vc},11:{n:"PtgElfRadicalS",f:gc},13:{n:"PtgElfColS",f:fc},15:{n:"PtgElfColSV",f:cc},16:{n:"PtgElfRadicalLel",f:pc},25:{n:"PtgList",f:wc},29:{n:"PtgSxName",f:Cc},255:{}};var Ic={0:{n:"PtgAttrNoop",f:_c},1:{n:"PtgAttrSemi",f:Of},2:{n:"PtgAttrIf",f:Rf},4:{n:"PtgAttrChoose",f:xf},8:{n:"PtgAttrGoto",f:Df},16:{n:"PtgAttrSum",f:Wf},32:{n:"PtgAttrBaxcel",f:_f},64:{n:"PtgAttrSpace",f:Nf},65:{n:"PtgAttrSpaceSemi",f:Mf},128:{n:"PtgAttrIfError",f:If},255:{}};Ic[33]=Ic[32];function Oc(e,t,r,n){if(n.biff<8)return Xt(e,t);var i=e.l+t;var a=[];for(var o=0;o!==r.length;++o){switch(r[o][0]){case"PtgArray":r[o][1]=Kf(e,0,n);a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Xf(e,r[o][1],n);a.push(r[o][2]);break;case"PtgExp":if(n&&n.biff==12){r[o][1][1]=e._R(4);a.push(r[o][1])}break;case"PtgList":;case"PtgElfRadicalS":;case"PtgElfColS":;case"PtgElfColSV":throw"Unsupported "+r[o][0];default:break}}t=i-e.l;if(t!==0)a.push(Xt(e,t));return a}function Ac(e,t,r){var n=e.l+t;var i,a,o=[];while(n!=e.l){t=n-e.l;a=e[e.l];i=xc[a];if(a===24||a===25)i=(a===24?Rc:Ic)[e[e.l+1]];if(!i||!i.f){Xt(e,t)}else{o.push([i.n,i.f(e,t,r)])}}return o}function Nc(e){var t=[];for(var r=0;r<e.length;++r){var n=e[r],i=[];for(var a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Mc={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};var Lc=new RegExp(/[^\w\u4E00-\u9FFF\u3040-\u30FF]/);function Pc(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");if(Lc.test(e))return"'"+e+"'";return e}function Fc(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8){if(t>1e4)t-=65536;if(t<0)t=-t;return t==0?"":e.XTI[t-1]}if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:i=n[1]==-1?"#REF":e.SheetNames[n[1]];return n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:if(r.SID!=null)return e.SheetNames[r.SID];return"SH33TJSSAME"+e[n[0]][0];case 355:;default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3";return n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:if(!e[n[0]][0][3])return"SH33TJSERR2";i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4";return n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]}}function Bc(e,t,r){return Pc(Fc(e,t,r),r)}function Hc(e,t,r,n,i){var a=i&&i.biff||8;var o={s:{c:0,r:0},e:{c:0,r:0}};var s=[],l,u,f,c=0,d=0,h,v="";if(!e[0]||!e[0][0])return"";var p=-1,g="";for(var m=0,y=e[0].length;m<y;++m){var b=e[0][m];switch(b[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":;case"PtgConcat":;case"PtgDiv":;case"PtgEq":;case"PtgGe":;case"PtgGt":;case"PtgLe":;case"PtgLt":;case"PtgMul":;case"PtgNe":;case"PtgPower":;case"PtgSub":l=s.pop();u=s.pop();if(p>=0){switch(e[0][p][1][0]){case 0:g=W(" ",e[0][p][1][1]);break;case 1:g=W("\r",e[0][p][1][1]);break;default:g="";if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g;p=-1}s.push(u+Mc[b[0]]+l);break;case"PtgIsect":l=s.pop();u=s.pop();s.push(u+" "+l);break;case"PtgUnion":l=s.pop();u=s.pop();s.push(u+","+l);break;case"PtgRange":l=s.pop();u=s.pop();s.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=er(b[1][1],o,i);s.push(rr(f,a));break;case"PtgRefN":f=r?er(b[1][1],r,i):b[1][1];s.push(rr(f,a));break;case"PtgRef3d":c=b[1][1];f=er(b[1][2],o,i);v=Bc(n,c,i);var w=v;s.push(v+"!"+rr(f,a));break;case"PtgFunc":;case"PtgFuncVar":var C=b[1][0],S=b[1][1];if(!C)C=0;C&=127;var E=C==0?[]:s.slice(-C);s.length-=C;if(S==="User")S=E.shift();s.push(S+"("+E.join(",")+")");break;case"PtgBool":s.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(b[1]);break;case"PtgNum":s.push(String(b[1]));break;case"PtgStr":s.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(b[1]);break;case"PtgAreaN":h=tr(b[1][1],r?{s:r}:o,i);s.push(nr(h,i));break;case"PtgArea":h=tr(b[1][1],o,i);s.push(nr(h,i));break;case"PtgArea3d":c=b[1][1];h=b[1][2];v=Bc(n,c,i);s.push(v+"!"+nr(h,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":;case"PtgAttrSemi":break;case"PtgName":d=b[1][2];var k=(n.names||[])[d-1]||(n[0]||[])[d];var T=k?k.Name:"SH33TJSNAME"+String(d);if(T in rd)T=rd[T];s.push(T);break;case"PtgNameX":var _=b[1][1];d=b[1][2];var x;if(i.biff<=5){if(_<0)_=-_;if(n[_])x=n[_][d]}else{var D="";if(((n[_]||[])[0]||[])[0]==14849){}else if(((n[_]||[])[0]||[])[0]==1025){if(n[_][d]&&n[_][d].itab>0){D=n.SheetNames[n[_][d].itab-1]+"!"}}else D=n.SheetNames[d-1]+"!";if(n[_]&&n[_][d])D+=n[_][d].Name;else if(n[0]&&n[0][d])D+=n[0][d].Name;else{var R=Fc(n,_,i).split(";;");if(R[d-1])D=R[d-1];else D+="SH33TJSERRX"}s.push(D);break}if(!x)x={Name:"SH33TJSERRY"};s.push(x.Name);break;case"PtgParen":var I="(",O=")";if(p>=0){g="";switch(e[0][p][1][0]){case 2:I=W(" ",e[0][p][1][1])+I;break;case 3:I=W("\r",e[0][p][1][1])+I;break;case 4:O=W(" ",e[0][p][1][1])+O;break;case 5:O=W("\r",e[0][p][1][1])+O;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}s.push(I+s.pop()+O);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:b[1][1],r:b[1][0]};var A={c:r.c,r:r.r};if(n.sharedf[gr(f)]){var N=n.sharedf[gr(f)];s.push(Hc(N,o,A,n,i))}else{var M=false;for(l=0;l!=n.arrayf.length;++l){u=n.arrayf[l];if(f.c<u[0].s.c||f.c>u[0].e.c)continue;if(f.r<u[0].s.r||f.r>u[0].e.r)continue;s.push(Hc(u[1],o,A,n,i));M=true;break}if(!M)s.push(b[1])}break;case"PtgArray":s.push("{"+Nc(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":;case"PtgAttrSpaceSemi":p=m;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":;case"PtgMemNoMemN":;case"PtgAttrNoop":;case"PtgSheet":;case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":;case"PtgElfColS":;case"PtgElfColSV":;case"PtgElfColV":;case"PtgElfLel":;case"PtgElfRadical":;case"PtgElfRadicalLel":;case"PtgElfRadicalS":;case"PtgElfRw":;case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var L=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3)if(p>=0&&L.indexOf(e[0][m][0])==-1){b=e[0][p];var P=true;switch(b[1][0]){case 4:P=false;case 0:g=W(" ",b[1][1]);break;case 5:P=false;case 1:g=W("\r",b[1][1]);break;default:g="";if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}s.push((P?g:"")+s.pop()+(P?"":g));p=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function $c(e,t,r){var n=e.l+t,i=r.biff==2?1:2;var a,o=e._R(i);if(o==65535)return[[],Xt(e,t-2)];var s=Ac(e,o,r);if(t!==o+i)a=Oc(e,t-o-i,s,r);e.l=n;return[s,a]}function Wc(e,t,r){var n=e.l+t,i=r.biff==2?1:2;var a,o=e._R(i);if(o==65535)return[[],Xt(e,t-2)];var s=Ac(e,o,r);if(t!==o+i)a=Oc(e,t-o-i,s,r);e.l=n;return[s,a]}function Uc(e,t,r,n){var i=e.l+t;var a=Ac(e,n,r);var o;if(i!==e.l)o=Oc(e,i-e.l,a,r);return[a,o]}function jc(e,t,r){var n=e.l+t;var i,a=e._R(2);var o=Ac(e,a,r);if(a==65535)return[[],Xt(e,t-2)];if(t!==a+2)i=Oc(e,n-a-2,o,r);return[o,i]}function Vc(e){var t;if(Ft(e,e.l+6)!==65535)return[Xr(e),"n"];switch(e[e.l]){case 0:e.l+=8;return["String","s"];case 1:t=e[e.l+2]===1;e.l+=8;return[t,"b"];case 2:t=e[e.l+2];e.l+=8;return[t,"e"];case 3:e.l+=8;return["","s"]}return[]}function zc(e){if(e==null){var t=Kt(8);t._W(1,3);t._W(1,0);t._W(2,0);t._W(2,0);t._W(2,65535);return t}else if(typeof e=="number")return Kr(e);return Kr(0)}function qc(e,t,r){var n=e.l+t;var i=va(e,6);if(r.biff==2)++e.l;var a=Vc(e,8);var o=e._R(1);if(r.biff!=2){e._R(1);if(r.biff>=5){e._R(4)}}var s=Wc(e,n-e.l,r);return{cell:i,val:a[0],formula:s,shared:o>>3&1,tt:a[1]}}function Yc(e,t,r,n,i){var a=pa(t,r,i);var o=zc(e.v);var s=Kt(6);var l=1|32;s._W(2,l);s._W(4,0);var u=Kt(e.bf.length);for(var f=0;f<e.bf.length;++f)u[f]=e.bf[f];var c=Ie([a,o,s,u]);return c}function Gc(e,t,r){var n=e._R(4);var i=Ac(e,n,r);var a=e._R(4);var o=a>0?Oc(e,a,i,r):null;return[i,o]}var Xc=Gc;var Kc=Gc;var Jc=Gc;var Qc=Gc;var Zc={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"};var ed={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"};var td={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};var rd={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function nd(e){if(e.slice(0,3)=="of:")e=e.slice(3);if(e.charCodeAt(0)==61){e=e.slice(1);if(e.charCodeAt(0)==61)e=e.slice(1)}e=e.replace(/COM\.MICROSOFT\./g,"");e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")});e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1");return e.replace(/[;~]/g,",").replace(/\|/g,";")}function id(e){var t="of:="+e.replace(nf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ad(e){var t=e.split(":");var r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function od(e){return e.replace(/\./,"!")}var sd={};var ld={};Bn.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"];var ud=typeof Map!=="undefined";function fd(e,t,r){var n=0,i=e.length;if(r){if(ud?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){var a=ud?r.get(t):r[t];for(;n<a.length;++n){if(e[a[n]].t===t){e.Count++;return a[n]}}}}else for(;n<i;++n){if(e[n].t===t){e.Count++;return n}}e[i]={t:t};e.Count++;e.Unique++;if(r){if(ud){if(!r.has(t))r.set(t,[]);r.get(t).push(i)}else{if(!Object.prototype.hasOwnProperty.call(r,t))r[t]=[];r[t].push(i)}}return i}function cd(e,t){var r={min:e+1,max:e+1};var n=-1;if(t.MDW)vl=t.MDW;if(t.width!=null)r.customWidth=1;else if(t.wpx!=null)n=gl(t.wpx);else if(t.wch!=null)n=t.wch;if(n>-1){r.width=ml(n);r.customWidth=1}else if(t.width!=null)r.width=t.width;if(t.hidden)r.hidden=true;return r}function dd(e,t){if(!e)return;var r=[.7,.7,.75,.75,.3,.3];if(t=="xlml")r=[1,1,1,1,.5,.5];if(e.left==null)e.left=r[0];if(e.right==null)e.right=r[1];if(e.top==null)e.top=r[2];if(e.bottom==null)e.bottom=r[3];if(e.header==null)e.header=r[4];if(e.footer==null)e.footer=r[5]}function hd(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"];var i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){me.load(t.z,i);r.ssf[i]=t.z;r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1};return a}function vd(e,t,r,n,i,a){try{if(n.cellNF)e.z=me._table[t]}catch(e){if(n.WTF)throw e}if(e.t==="z")return;if(e.t==="d"&&typeof e.v==="string")e.v=ae(e.v);if(!n||n.cellText!==false)try{if(me._table[t]==null)me.load(b[t]||"General",t);if(e.t==="e")e.w=e.w||Dn[e.v];else if(t===0){if(e.t==="n"){if((e.v|0)===e.v)e.w=me._general_int(e.v);else e.w=me._general_num(e.v)}else if(e.t==="d"){var o=Z(e.v);if((o|0)===o)e.w=me._general_int(o);else e.w=me._general_num(o)}else if(e.v===undefined)return"";else e.w=me._general(e.v,ld)}else if(e.t==="d")e.w=me.format(t,Z(e.v),ld);else e.w=me.format(t,e.v,ld)}catch(e){if(n.WTF)throw e}if(!n.cellStyles)return;if(r!=null)try{e.s=a.Fills[r];if(e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb){e.s.fgColor.rgb=fl(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0);if(n.WTF)e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb}if(e.s.bgColor&&e.s.bgColor.theme){e.s.bgColor.rgb=fl(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0);if(n.WTF)e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb}}catch(e){if(n.WTF&&a.Fills)throw e}}function pd(e,t,r){if(e&&e["!ref"]){var n=br(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function gd(e,t){var r=br(t);if(r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0)e["!ref"]=yr(r)}var md=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g;var yd=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/;var bd=/<(?:\w:)?hyperlink [^>]*>/gm;var wd=/"(\w*:\w*)"/;var Cd=/<(?:\w:)?col\b[^>]*[\/]?>/g;var Sd=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g;var Ed=/<(?:\w:)?pageMargins[^>]*\/>/g;var kd=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/;var Td=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _d(e,t,r,n,i,a,o){if(!e)return e;if(!n)n={"!id":{}};if(ge!=null&&t.dense==null)t.dense=ge;var s=t.dense?[]:{};var l={s:{r:2e6,c:2e6},e:{r:0,c:0}};var u="",f="";var c=e.match(yd);if(c){u=e.slice(0,c.index);f=e.slice(c.index+c[0].length)}else u=f=e;var d=u.match(kd);if(d)Dd(d[0],s,i,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=u.slice(h,h+50).match(wd);if(v)gd(s,v[1])}var p=u.match(Td);if(p&&p[1])Wd(p[1],i);var g=[];if(t.cellStyles){var m=u.match(Cd);if(m)Pd(g,m)}if(c)Vd(c[1],s,t,l,a,o);var y=f.match(Sd);if(y)s["!autofilter"]=Bd(y[0]);var b=[];var w=f.match(md);if(w)for(h=0;h!=w.length;++h)b[h]=br(w[h].slice(w[h].indexOf('"')+1));var C=f.match(bd);if(C)Nd(s,C,n);var S=f.match(Ed);if(S)s["!margins"]=Md(Ee(S[0]));if(!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r)s["!ref"]=yr(l);if(t.sheetRows>0&&s["!ref"]){var E=br(s["!ref"]);if(t.sheetRows<=+E.e.r){E.e.r=t.sheetRows-1;if(E.e.r>l.e.r)E.e.r=l.e.r;if(E.e.r<E.s.r)E.s.r=E.e.r;if(E.e.c>l.e.c)E.e.c=l.e.c;if(E.e.c<E.s.c)E.s.c=E.e.c;s["!fullref"]=s["!ref"];s["!ref"]=yr(E)}}if(g.length>0)s["!cols"]=g;if(b.length>0)s["!merges"]=b;return s}function xd(e){if(e.length===0)return"";var t='<mergeCells count="'+e.length+'">';for(var r=0;r!=e.length;++r)t+='<mergeCell ref="'+yr(e[r])+'"/>';return t+"</mergeCells>"}function Dd(e,t,r,n){var i=Ee(e);if(!r.Sheets[n])r.Sheets[n]={};if(i.codeName)r.Sheets[n].CodeName=i.codeName}function Rd(e,t,r,n,i){var a=false;var o={},s=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{if(t.Workbook)l=t.Workbook.Sheets[r].CodeName||l}catch(e){}a=true;o.codeName=$e(l)}if(!a&&!s)return;i[i.length]=lt("sheetPr",s,o)}var Id=["objects","scenarios","selectLockedCells","selectUnlockedCells"];var Od=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ad(t){var r={sheet:1};Id.forEach(function(e){if(t[e]!=null&&t[e])r[e]="1"});Od.forEach(function(e){if(t[e]!=null&&!t[e])r[e]="0"});if(t.password)r.password=Qs(t.password).toString(16).toUpperCase();return lt("sheetProtection",null,r)}function Nd(e,t,r){var n=Array.isArray(e);for(var i=0;i!=t.length;++i){var a=Ee(Ge(t[i]),true);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];if(o){a.Target=o.Target;if(a.location)a.Target+="#"+a.location}else{a.Target="#"+a.location;o={Target:a.Target,TargetMode:"Internal"}}a.Rel=o;if(a.tooltip){a.Tooltip=a.tooltip;delete a.tooltip}var s=br(a.ref);for(var l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=gr({c:u,r:l});if(n){if(!e[l])e[l]=[];if(!e[l][u])e[l][u]={t:"z",v:undefined};e[l][u].l=a}else{if(!e[f])e[f]={t:"z",v:undefined};e[f].l=a}}}}function Md(t){var r={};["left","right","top","bottom","header","footer"].forEach(function(e){if(t[e])r[e]=parseFloat(t[e])});return r}function Ld(e){dd(e);return lt("pageMargins",null,e)}function Pd(e,t){var r=false;for(var n=0;n!=t.length;++n){var i=Ee(t[n],true);if(i.hidden)i.hidden=Ye(i.hidden);var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;delete i.min;delete i.max;i.width=+i.width;if(!r&&i.width){r=true;bl(i.width)}wl(i);while(a<=o)e[a++]=oe(i)}}function Fd(e,t){var r=["<cols>"],n;for(var i=0;i!=t.length;++i){if(!(n=t[i]))continue;r[r.length]=lt("col",null,cd(i,n))}r[r.length]="</cols>";return r.join("")}function Bd(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Hd(e,t,r,n){var i=typeof e.ref=="string"?e.ref:yr(e.ref);if(!r.Workbook)r.Workbook={Sheets:[]};if(!r.Workbook.Names)r.Workbook.Names=[];var a=r.Workbook.Names;var o=mr(i);if(o.s.r==o.e.r){o.e.r=mr(t["!ref"]).e.r;i=yr(o)}for(var s=0;s<a.length;++s){var l=a[s];if(l.Name!="_xlnm._FilterDatabase")continue;if(l.Sheet!=n)continue;l.Ref="'"+r.SheetNames[n]+"'!"+i;break}if(s==a.length)a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i});return lt("autoFilter",null,{ref:i})}var $d=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Wd(e,n){if(!n.Views)n.Views=[{}];(e.match($d)||[]).forEach(function(e,t){var r=Ee(e);if(!n.Views[t])n.Views[t]={};if(Ye(r.rightToLeft))n.Views[t].RTL=true})}function Ud(e,t,r,n){var i={workbookViewId:"0"};if((((n||{}).Workbook||{}).Views||[])[0])i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0";return lt("sheetViews",lt("sheetView",null,i),{})}function jd(e,t,r,n){if(e.v===undefined&&typeof e.f!=="string"||e.t==="z")return"";var i="";var a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Dn[e.v];break;case"d":if(n&&n.cellDates)i=ae(e.v,-1).toISOString();else{e=oe(e);e.t="n";i=""+(e.v=Z(ae(e.v)))}if(typeof e.z==="undefined")e.z=me._table[14];break;default:i=e.v;break}var s=ot("v",$e(i)),l={r:t};var u=hd(n.cellXfs,e,n);if(u!==0)l.s=u;switch(e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(n&&n.bookSST){s=ot("v",""+fd(n.Strings,e.v,n.revStrings));l.t="s";break}l.t="str";break}if(e.t!=a){e.t=a;e.v=o}if(typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=lt("f",$e(e.f),f)+(e.v!=null?s:"")}if(e.l)r["!links"].push([t,e.l]);if(e.c)r["!comments"].push([t,e.c]);return lt("c",s,l)}var Vd=function(){var $=/<(?:\w+:)?c[ >]/,W=/<\/(?:\w+:)?row>/;var U=/r=["']([^"']*)["']/,j=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/;var V=/ref=["']([^"']*)["']/;var z=Ze("v"),q=Ze("f");return function e(t,r,n,i,a,o){var s=0,l="",u=[],f=[],c=0,d=0,h=0,v="",p;var g,m=0,y=0;var b,w;var C=0,S=0;var E=Array.isArray(o.CellXf),k;var T=[];var _=[];var x=Array.isArray(r);var D=[],R={},I=false;var O=!!n.sheetStubs;for(var A=t.split(W),N=0,M=A.length;N!=M;++N){l=A[N].trim();var L=l.length;if(L===0)continue;for(s=0;s<L;++s)if(l.charCodeAt(s)===62)break;++s;g=Ee(l.slice(0,s),true);m=g.r!=null?parseInt(g.r,10):m+1;y=-1;if(n.sheetRows&&n.sheetRows<m)continue;if(i.s.r>m-1)i.s.r=m-1;if(i.e.r<m-1)i.e.r=m-1;if(n&&n.cellStyles){R={};I=false;if(g.ht){I=true;R.hpt=parseFloat(g.ht);R.hpx=kl(R.hpt)}if(g.hidden=="1"){I=true;R.hidden=true}if(g.outlineLevel!=null){I=true;R.level=+g.outlineLevel}if(I)D[m-1]=R}u=l.slice(s).split($);for(var P=0;P!=u.length;++P)if(u[P].trim().charAt(0)!="<")break;u=u.slice(P);for(s=0;s!=u.length;++s){l=u[s].trim();if(l.length===0)continue;f=l.match(U);c=s;d=0;h=0;l="<c "+(l.slice(0,1)=="<"?">":"")+l;if(f!=null&&f.length===2){c=0;v=f[1];for(d=0;d!=v.length;++d){if((h=v.charCodeAt(d)-64)<1||h>26)break;c=26*c+h}--c;y=c}else++y;for(d=0;d!=l.length;++d)if(l.charCodeAt(d)===62)break;++d;g=Ee(l.slice(0,d),true);if(!g.r)g.r=gr({r:m-1,c:y});v=l.slice(d);p={t:""};if((f=v.match(z))!=null&&f[1]!=="")p.v=Fe(f[1]);if(n.cellFormula){if((f=v.match(q))!=null&&f[1]!==""){p.f=Fe(Ge(f[1])).replace(/\r\n/g,"\n");if(!n.xlfn)p.f=uf(p.f);if(f[0].indexOf('t="array"')>-1){p.F=(v.match(V)||[])[1];if(p.F.indexOf(":")>-1)T.push([br(p.F),p.F])}else if(f[0].indexOf('t="shared"')>-1){w=Ee(f[0]);var F=Fe(Ge(f[1]));if(!n.xlfn)F=uf(F);_[parseInt(w.si,10)]=[w,F,g.r]}}else if(f=v.match(/<f[^>]*\/>/)){w=Ee(f[0]);if(_[w.si])p.f=sf(_[w.si][1],_[w.si][2],g.r)}var B=pr(g.r);for(d=0;d<T.length;++d)if(B.r>=T[d][0].s.r&&B.r<=T[d][0].e.r)if(B.c>=T[d][0].s.c&&B.c<=T[d][0].e.c)p.F=T[d][1]}if(g.t==null&&p.v===undefined){if(p.f||p.F){p.v=0;p.t="n"}else if(!O)continue;else p.t="z"}else p.t=g.t||"n";if(i.s.c>y)i.s.c=y;if(i.e.c<y)i.e.c=y;switch(p.t){case"n":if(p.v==""||p.v==null){if(!O)continue;p.t="z"}else p.v=parseFloat(p.v);break;case"s":if(typeof p.v=="undefined"){if(!O)continue;p.t="z"}else{b=sd[parseInt(p.v,10)];p.v=b.t;p.r=b.r;if(n.cellHTML)p.h=b.h}break;case"str":p.t="s";p.v=p.v!=null?Ge(p.v):"";if(n.cellHTML)p.h=je(p.v);break;case"inlineStr":f=v.match(j);p.t="s";if(f!=null&&(b=ks(f[1]))){p.v=b.t;if(n.cellHTML)p.h=b.h}else p.v="";break;case"b":p.v=Ye(p.v);break;case"d":if(n.cellDates)p.v=ae(p.v,1);else{p.v=Z(ae(p.v,1));p.t="n"}break;case"e":if(!n||n.cellText!==false)p.w=p.v;p.v=Rn[p.v];break}C=S=0;k=null;if(E&&g.s!==undefined){k=o.CellXf[g.s];if(k!=null){if(k.numFmtId!=null)C=k.numFmtId;if(n.cellStyles){if(k.fillId!=null)S=k.fillId}}}vd(p,C,S,n,a,o);if(n.cellDates&&E&&p.t=="n"&&me.is_date(me._table[C])){p.t="d";p.v=Y(p.v)}if(x){var H=pr(g.r);if(!r[H.r])r[H.r]=[];r[H.r][H.c]=p}else r[g.r]=p}}if(D.length>0)r["!rows"]=D}}();function zd(e,t,r,n){var i=[],a=[],o=br(e["!ref"]),s="",l,u="",f=[],c=0,d=0,h=e["!rows"];var v=Array.isArray(e);var p={r:u},g,m=-1;for(d=o.s.c;d<=o.e.c;++d)f[d]=cr(d);for(c=o.s.r;c<=o.e.r;++c){a=[];u=sr(c);for(d=o.s.c;d<=o.e.c;++d){l=f[d]+u;var y=v?(e[c]||[])[d]:e[l];if(y===undefined)continue;if((s=jd(y,l,e,t,r,n))!=null)a.push(s)}if(a.length>0||h&&h[c]){p={r:u};if(h&&h[c]){g=h[c];if(g.hidden)p.hidden=1;m=-1;if(g.hpx)m=El(g.hpx);else if(g.hpt)m=g.hpt;if(m>-1){p.ht=m;p.customHeight=1}if(g.level){p.outlineLevel=g.level}}i[i.length]=lt("row",a.join(""),p)}}if(h)for(;c<h.length;++c){if(h&&h[c]){p={r:c+1};g=h[c];if(g.hidden)p.hidden=1;m=-1;if(g.hpx)m=El(g.hpx);else if(g.hpt)m=g.hpt;if(m>-1){p.ht=m;p.customHeight=1}if(g.level){p.outlineLevel=g.level}i[i.length]=lt("row","",p)}}return i.join("")}var qd=lt("worksheet",null,{xmlns:ct.main[0],"xmlns:r":ct.r});function Yd(e,t,r,n){var i=[ve,qd];var a=r.SheetNames[e],o=0,s="";var l=r.Sheets[a];if(l==null)l={};var u=l["!ref"]||"A1";var f=br(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383);f.e.r=Math.min(f.e.c,1048575);u=yr(f)}if(!n)n={};l["!comments"]=[];var c=[];Rd(l,r,e,t,i);i[i.length]=lt("dimension",null,{ref:u});i[i.length]=Ud(l,t,e,r);if(t.sheetFormat)i[i.length]=lt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"});if(l["!cols"]!=null&&l["!cols"].length>0)i[i.length]=Fd(l,l["!cols"]);i[o=i.length]="<sheetData/>";l["!links"]=[];if(l["!ref"]!=null){s=zd(l,t,e,r,n);if(s.length>0)i[i.length]=s}if(i.length>o+1){i[i.length]="</sheetData>";i[o]=i[o].replace("/>",">")}if(l["!protect"]!=null)i[i.length]=Ad(l["!protect"]);if(l["!autofilter"]!=null)i[i.length]=Hd(l["!autofilter"],l,r,e);if(l["!merges"]!=null&&l["!merges"].length>0)i[i.length]=xd(l["!merges"]);var d=-1,h,v=-1;if(l["!links"].length>0){i[i.length]="<hyperlinks>";l["!links"].forEach(function(e){if(!e[1].Target)return;h={ref:e[0]};if(e[1].Target.charAt(0)!="#"){v=Vn(n,-1,$e(e[1].Target).replace(/#.*$/,""),Bn.HLINK);h["r:id"]="rId"+v}if((d=e[1].Target.indexOf("#"))>-1)h.location=$e(e[1].Target.slice(d+1));if(e[1].Tooltip)h.tooltip=$e(e[1].Tooltip);i[i.length]=lt("hyperlink",null,h)});i[i.length]="</hyperlinks>"}delete l["!links"];if(l["!margins"]!=null)i[i.length]=Ld(l["!margins"]);if(!t||t.ignoreEC||t.ignoreEC==void 0)i[i.length]=ot("ignoredErrors",lt("ignoredError",null,{numberStoredAsText:1,sqref:u}));if(c.length>0){v=Vn(n,-1,"../drawings/drawing"+(e+1)+".xml",Bn.DRAW);i[i.length]=lt("drawing",null,{"r:id":"rId"+v});l["!drawing"]=c}if(l["!comments"].length>0){v=Vn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bn.VML);i[i.length]=lt("legacyDrawing",null,{"r:id":"rId"+v});l["!legacy"]=v}if(i.length>1){i[i.length]="</worksheet>";i[1]=i[1].replace("/>",">")}return i.join("")}function Gd(e,t){var r={};var n=e.l+t;r.r=e._R(4);e.l+=4;var i=e._R(2);e.l+=1;var a=e._R(1);e.l=n;if(a&7)r.level=a&7;if(a&16)r.hidden=true;if(a&32)r.hpt=i/20;return r}function Xd(e,t,r){var n=Kt(17+8*16);var i=(r["!rows"]||[])[e]||{};n._W(4,e);n._W(4,0);var a=320;if(i.hpx)a=El(i.hpx)*20;else if(i.hpt)a=i.hpt*20;n._W(2,a);n._W(1,0);var o=0;if(i.level)o|=i.level;if(i.hidden)o|=16;if(i.hpx||i.hpt)o|=32;n._W(1,o);n._W(1,0);var s=0,l=n.l;n.l+=4;var u={r:e,c:0};for(var f=0;f<16;++f){if(t.s.c>f+1<<10||t.e.c<f<<10)continue;var c=-1,d=-1;for(var h=f<<10;h<f+1<<10;++h){u.c=h;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[gr(u)];if(v){if(c<0)c=h;d=h}}if(c<0)continue;++s;n._W(4,c);n._W(4,d)}var p=n.l;n.l=l;n._W(4,s);n.l=p;return n.length>n.l?n.slice(0,n.l):n}function Kd(e,t,r,n){var i=Xd(n,r,t);if(i.length>17||(t["!rows"]||[])[n])Zt(e,"BrtRowHdr",i)}var Jd=Yr;var Qd=Gr;function Zd(){}function eh(e,t){var r={};e.l+=19;r.name=Pr(e,t-19);return r}function th(e,t){if(t==null)t=Kt(84+4*e.length);for(var r=0;r<3;++r)t._W(1,0);Qr({auto:1},t);t._W(-4,-1);t._W(-4,-1);Fr(e,t);return t.slice(0,t.l)}function rh(e){var t=Mr(e);return[t]}function nh(e,t,r){if(r==null)r=Kt(8);return Lr(t,r)}function ih(e){var t=Mr(e);var r=e._R(1);return[t,r,"b"]}function ah(e,t,r){if(r==null)r=Kt(9);Lr(t,r);r._W(1,e.v?1:0);return r}function oh(e){var t=Mr(e);var r=e._R(1);return[t,r,"e"]}function sh(e){var t=Mr(e);var r=e._R(4);return[t,r,"s"]}function lh(e,t,r){if(r==null)r=Kt(12);Lr(t,r);r._W(4,t.v);return r}function uh(e){var t=Mr(e);var r=Xr(e);return[t,r,"n"]}function fh(e,t,r){if(r==null)r=Kt(16);Lr(t,r);Kr(e.v,r);return r}function ch(e){var t=Mr(e);var r=jr(e);return[t,r,"n"]}function dh(e,t,r){if(r==null)r=Kt(12);Lr(t,r);Vr(e.v,r);return r}function hh(e){var t=Mr(e);var r=_r(e);return[t,r,"str"]}function vh(e,t,r){if(r==null)r=Kt(12+4*e.v.length);Lr(t,r);xr(e.v,r);return r.length>r.l?r.slice(0,r.l):r}function ph(e,t,r){var n=e.l+t;var i=Mr(e);i.r=r["!row"];var a=e._R(1);var o=[i,a,"b"];if(r.cellFormula){e.l+=2;var s=Kc(e,n-e.l,r);o[3]=Hc(s,null,i,r.supbooks,r)}else e.l=n;return o}function gh(e,t,r){var n=e.l+t;var i=Mr(e);i.r=r["!row"];var a=e._R(1);var o=[i,a,"e"];if(r.cellFormula){e.l+=2;var s=Kc(e,n-e.l,r);o[3]=Hc(s,null,i,r.supbooks,r)}else e.l=n;return o}function mh(e,t,r){var n=e.l+t;var i=Mr(e);i.r=r["!row"];var a=Xr(e);var o=[i,a,"n"];if(r.cellFormula){e.l+=2;var s=Kc(e,n-e.l,r);o[3]=Hc(s,null,i,r.supbooks,r)}else e.l=n;return o}function yh(e,t,r){var n=e.l+t;var i=Mr(e);i.r=r["!row"];var a=_r(e);var o=[i,a,"str"];if(r.cellFormula){e.l+=2;var s=Kc(e,n-e.l,r);o[3]=Hc(s,null,i,r.supbooks,r)}else e.l=n;return o}var bh=Yr;var wh=Gr;function Ch(e,t){if(t==null)t=Kt(4);t._W(4,e);return t}function Sh(e,t){var r=e.l+t;var n=Yr(e,16);var i=Br(e);var a=_r(e);var o=_r(e);var s=_r(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:s};if(o)l.Tooltip=o;return l}function Eh(e,t){var r=Kt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Gr({s:pr(e[0]),e:pr(e[0])},r);Ur("rId"+t,r);var n=e[1].Target.indexOf("#");var i=n==-1?"":e[1].Target.slice(n+1);xr(i||"",r);xr(e[1].Tooltip||"",r);xr("",r);return r.slice(0,r.l)}function kh(){}function Th(e,t,r){var n=e.l+t;var i=zr(e,16);var a=e._R(1);var o=[i];o[2]=a;if(r.cellFormula){var s=Xc(e,n-e.l,r);o[1]=s}else e.l=n;return o}function _h(e,t,r){var n=e.l+t;var i=Yr(e,16);var a=[i];if(r.cellFormula){var o=Qc(e,n-e.l,r);a[1]=o;e.l=n}else e.l=n;return a}function xh(e,t,r){if(r==null)r=Kt(18);var n=cd(e,t);r._W(-4,e);r._W(-4,e);r._W(4,(n.width||10)*256);r._W(4,0);var i=0;if(t.hidden)i|=1;if(typeof n.width=="number")i|=2;if(t.level)i|=t.level<<8;r._W(2,i);return r}var Dh=["left","right","top","bottom","header","footer"];function Rh(t){var r={};Dh.forEach(function(e){r[e]=Xr(t,8)});return r}function Ih(t,r){if(r==null)r=Kt(6*8);dd(t);Dh.forEach(function(e){Kr(t[e],r)});return r}function Oh(e){var t=e._R(2);e.l+=28;return{RTL:t&32}}function Ah(e,t,r){if(r==null)r=Kt(30);var n=924;if((((t||{}).Views||[])[0]||{}).RTL)n|=32;r._W(2,n);r._W(4,0);r._W(4,0);r._W(4,0);r._W(1,0);r._W(1,0);r._W(2,0);r._W(2,100);r._W(2,0);r._W(2,0);r._W(2,0);r._W(4,0);return r}function Nh(e){var t=Kt(24);t._W(4,4);t._W(4,1);Gr(e,t);return t}function Mh(t,r){if(r==null)r=Kt(16*4+2);r._W(2,t.password?Qs(t.password):0);r._W(4,1);[["objects",false],["scenarios",false],["formatCells",true],["formatColumns",true],["formatRows",true],["insertColumns",true],["insertRows",true],["insertHyperlinks",true],["deleteColumns",true],["deleteRows",true],["selectLockedCells",false],["sort",true],["autoFilter",true],["pivotTables",true],["selectUnlockedCells",false]].forEach(function(e){if(e[1])r._W(4,t[e[0]]!=null&&!t[e[0]]?1:0);else r._W(4,t[e[0]]!=null&&t[e[0]]?0:1)});return r}function Lh(){}function Ph(){}function Fh(e,t,o,s,l,u,f){if(!e)return e;var c=t||{};if(!s)s={"!id":{}};if(ge!=null&&c.dense==null)c.dense=ge;var d=c.dense?[]:{};var h;var v={s:{r:2e6,c:2e6},e:{r:0,c:0}};var p=[];var g=false,m=false;var y,b,w,C,S,E,k,T,_;var x=[];c.biff=12;c["!row"]=0;var D=0,R=false;var I=[];var O={};var A=c.supbooks||l.supbooks||[[]];A.sharedf=O;A.arrayf=I;A.SheetNames=l.SheetNames||l.Sheets.map(function(e){return e.name});if(!c.supbooks){c.supbooks=A;if(l.Names)for(var r=0;r<l.Names.length;++r)A[0][r+1]=l.Names[r]}var N=[],M=[];var L=false;Jt(e,function e(t,r,n){if(m)return;switch(n){case 148:h=t;break;case 0:y=t;if(c.sheetRows&&c.sheetRows<=y.r)m=true;T=sr(C=y.r);c["!row"]=y.r;if(t.hidden||t.hpt||t.level!=null){if(t.hpt)t.hpx=kl(t.hpt);M[t.r]=t}break;case 2:;case 3:;case 4:;case 5:;case 6:;case 7:;case 8:;case 9:;case 10:;case 11:b={t:t[2]};switch(t[2]){case"n":b.v=t[1];break;case"s":k=sd[t[1]];b.v=k.t;b.r=k.r;break;case"b":b.v=t[1]?true:false;break;case"e":b.v=t[1];if(c.cellText!==false)b.w=Dn[b.v];break;case"str":b.t="s";b.v=t[1];break}if(w=f.CellXf[t[0].iStyleRef])vd(b,w.numFmtId,null,c,u,f);S=t[0].c;if(c.dense){if(!d[C])d[C]=[];d[C][S]=b}else d[cr(S)+T]=b;if(c.cellFormula){R=false;for(D=0;D<I.length;++D){var i=I[D];if(y.r>=i[0].s.r&&y.r<=i[0].e.r)if(S>=i[0].s.c&&S<=i[0].e.c){b.F=yr(i[0]);R=true}}if(!R&&t.length>3)b.f=t[3]}if(v.s.r>y.r)v.s.r=y.r;if(v.s.c>S)v.s.c=S;if(v.e.r<y.r)v.e.r=y.r;if(v.e.c<S)v.e.c=S;if(c.cellDates&&w&&b.t=="n"&&me.is_date(me._table[w.numFmtId])){var a=me.parse_date_code(b.v);if(a){b.t="d";b.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)}}break;case 1:if(!c.sheetStubs||g)break;b={t:"z",v:undefined};S=t[0].c;if(c.dense){if(!d[C])d[C]=[];d[C][S]=b}else d[cr(S)+T]=b;if(v.s.r>y.r)v.s.r=y.r;if(v.s.c>S)v.s.c=S;if(v.e.r<y.r)v.e.r=y.r;if(v.e.c<S)v.e.c=S;break;case 176:x.push(t);break;case 494:var e=s["!id"][t.relId];if(e){t.Target=e.Target;if(t.loc)t.Target+="#"+t.loc;t.Rel=e}else if(t.relId==""){t.Target="#"+t.loc}for(C=t.rfx.s.r;C<=t.rfx.e.r;++C)for(S=t.rfx.s.c;S<=t.rfx.e.c;++S){if(c.dense){if(!d[C])d[C]=[];if(!d[C][S])d[C][S]={t:"z",v:undefined};d[C][S].l=t}else{E=gr({c:S,r:C});if(!d[E])d[E]={t:"z",v:undefined};d[E].l=t}}break;case 426:if(!c.cellFormula)break;I.push(t);_=c.dense?d[C][S]:d[cr(S)+T];_.f=Hc(t[1],v,{r:y.r,c:S},A,c);_.F=yr(t[0]);break;case 427:if(!c.cellFormula)break;O[gr(t[0].s)]=t[1];_=c.dense?d[C][S]:d[cr(S)+T];_.f=Hc(t[1],v,{r:y.r,c:S},A,c);break;case 60:if(!c.cellStyles)break;while(t.e>=t.s){N[t.e--]={width:t.w/256,hidden:!!(t.flags&1),level:t.level};if(!L){L=true;bl(t.w/256)}wl(N[t.e+1])}break;case 161:d["!autofilter"]={ref:yr(t)};break;case 476:d["!margins"]=t;break;case 147:if(!l.Sheets[o])l.Sheets[o]={};if(t.name)l.Sheets[o].CodeName=t.name;break;case 137:if(!l.Views)l.Views=[{}];if(!l.Views[0])l.Views[0]={};if(t.RTL)l.Views[0].RTL=true;break;case 485:break;case 64:;case 1053:break;case 151:break;case 175:;case 644:;case 625:;case 562:;case 396:;case 1112:;case 1146:;case 471:;case 1050:;case 649:;case 1105:;case 49:;case 589:;case 607:;case 564:;case 1055:;case 168:;case 174:;case 1180:;case 499:;case 507:;case 550:;case 171:;case 167:;case 1177:;case 169:;case 1181:;case 551:;case 552:;case 661:;case 639:;case 478:;case 537:;case 477:;case 536:;case 1103:;case 680:;case 1104:;case 1024:;case 152:;case 663:;case 535:;case 678:;case 504:;case 1043:;case 428:;case 170:;case 3072:;case 50:;case 2070:;case 1045:break;case 35:g=true;break;case 36:g=false;break;case 37:p.push(r);g=true;break;case 38:p.pop();g=false;break;default:if((r||"").indexOf("Begin")>0){}else if((r||"").indexOf("End")>0){}else if(!g||c.WTF)throw new Error("Unexpected record "+n+" "+r)}},c);delete c.supbooks;delete c["!row"];if(!d["!ref"]&&(v.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0)))d["!ref"]=yr(h||v);if(c.sheetRows&&d["!ref"]){var n=br(d["!ref"]);if(c.sheetRows<=+n.e.r){n.e.r=c.sheetRows-1;if(n.e.r>v.e.r)n.e.r=v.e.r;if(n.e.r<n.s.r)n.s.r=n.e.r;if(n.e.c>v.e.c)n.e.c=v.e.c;if(n.e.c<n.s.c)n.s.c=n.e.c;d["!fullref"]=d["!ref"];d["!ref"]=yr(n)}}if(x.length>0)d["!merges"]=x;if(N.length>0)d["!cols"]=N;if(M.length>0)d["!rows"]=M;return d}function Bh(e,t,r,n,i,a){if(t.v===undefined)return;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=oe(t);t.z=t.z||me._table[14];t.v=Z(ae(t.v));t.t="n";break;case"n":;case"e":o=""+t.v;break;default:o=t.v;break}var s={r:r,c:n};s.s=hd(i.cellXfs,t,i);if(t.l)a["!links"].push([gr(s),t.l]);if(t.c)a["!comments"].push([gr(s),t.c]);switch(t.t){case"s":;case"str":if(i.bookSST){o=fd(i.Strings,t.v,i.revStrings);s.t="s";s.v=o;Zt(e,"BrtCellIsst",lh(t,s))}else{s.t="str";Zt(e,"BrtCellSt",vh(t,s))}return;case"n":if(t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3)Zt(e,"BrtCellRk",dh(t,s));else Zt(e,"BrtCellReal",fh(t,s));return;case"b":s.t="b";Zt(e,"BrtCellBool",ah(t,s));return;case"e":s.t="e";break}Zt(e,"BrtCellBlank",nh(t,s))}function Hh(e,t,r,n){var i=br(t["!ref"]||"A1"),a,o="",s=[];Zt(e,"BrtBeginSheetData");var l=Array.isArray(t);var u=i.e.r;if(t["!rows"])u=Math.max(i.e.r,t["!rows"].length-1);for(var f=i.s.r;f<=u;++f){o=sr(f);Kd(e,t,i,f);if(f<=i.e.r)for(var c=i.s.c;c<=i.e.c;++c){if(f===i.s.r)s[c]=cr(c);a=s[c]+o;var d=l?(t[f]||[])[c]:t[a];if(!d)continue;Bh(e,d,f,c,n,t)}}Zt(e,"BrtEndSheetData")}function $h(t,e){if(!e||!e["!merges"])return;Zt(t,"BrtBeginMergeCells",Ch(e["!merges"].length));e["!merges"].forEach(function(e){Zt(t,"BrtMergeCell",wh(e))});Zt(t,"BrtEndMergeCells")}function Wh(r,e){if(!e||!e["!cols"])return;Zt(r,"BrtBeginColInfos");e["!cols"].forEach(function(e,t){if(e)Zt(r,"BrtColInfo",xh(t,e))});Zt(r,"BrtEndColInfos")}function Uh(e,t){if(!t||!t["!ref"])return;Zt(e,"BrtBeginCellIgnoreECs");Zt(e,"BrtCellIgnoreEC",Nh(br(t["!ref"])));Zt(e,"BrtEndCellIgnoreECs")}function jh(r,e,n){e["!links"].forEach(function(e){if(!e[1].Target)return;var t=Vn(n,-1,e[1].Target.replace(/#.*$/,""),Bn.HLINK);Zt(r,"BrtHLink",Eh(e,t))});delete e["!links"]}function Vh(e,t,r,n){if(t["!comments"].length>0){var i=Vn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Bn.VML);Zt(e,"BrtLegacyDrawing",Ur("rId"+i));t["!legacy"]=i}}function zh(e,t,r,n){if(!t["!autofilter"])return;var i=t["!autofilter"];var a=typeof i.ref==="string"?i.ref:yr(i.ref);if(!r.Workbook)r.Workbook={Sheets:[]};if(!r.Workbook.Names)r.Workbook.Names=[];var o=r.Workbook.Names;var s=mr(a);if(s.s.r==s.e.r){s.e.r=mr(t["!ref"]).e.r;a=yr(s)}for(var l=0;l<o.length;++l){var u=o[l];if(u.Name!="_xlnm._FilterDatabase")continue;if(u.Sheet!=n)continue;u.Ref="'"+r.SheetNames[n]+"'!"+a;break}if(l==o.length)o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a});Zt(e,"BrtBeginAFilter",Gr(br(a)));Zt(e,"BrtEndAFilter")}function qh(e,t,r){Zt(e,"BrtBeginWsViews");{Zt(e,"BrtBeginWsView",Ah(t,r));Zt(e,"BrtEndWsView")}Zt(e,"BrtEndWsViews")}function Yh(){}function Gh(e,t){if(!t["!protect"])return;Zt(e,"BrtSheetProtection",Mh(t["!protect"]))}function Xh(e,t,r,n){var i=Qt();var a=r.SheetNames[e],o=r.Sheets[a]||{};var s=a;try{if(r&&r.Workbook)s=r.Workbook.Sheets[e].CodeName||s}catch(e){}var l=br(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383);l.e.r=Math.min(l.e.c,1048575)}o["!links"]=[];o["!comments"]=[];Zt(i,"BrtBeginSheet");if(r.vbaraw)Zt(i,"BrtWsProp",th(s));Zt(i,"BrtWsDim",Qd(l));qh(i,o,r.Workbook);Yh(i,o);Wh(i,o,e,t,r);Hh(i,o,e,t,r);Gh(i,o);zh(i,o,r,e);$h(i,o);jh(i,o,n);if(o["!margins"])Zt(i,"BrtMargins",Ih(o["!margins"]));if(!t||t.ignoreEC||t.ignoreEC==void 0)Uh(i,o);Vh(i,o,e,n);Zt(i,"BrtEndSheet");return i.end()}Bn.CHART="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart";Bn.CHARTEX="http://schemas.microsoft.com/office/2014/relationships/chartEx";function Kh(e){var r=[];var n=e.match(/^<c:numCache>/);var t;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);if(!t)return;r[+t[1]]=n?+t[2]:t[2]});var i=Fe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")});return[r,i,t]}function Jh(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var s=0,l=0,u="A";var f={s:{r:2e6,c:2e6},e:{r:0,c:0}};(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var r=Kh(e);f.s.r=f.s.c=0;f.e.c=s;u=cr(s);r[0].forEach(function(e,t){o[u+sr(t)]={t:"n",v:e,z:r[1]};l=t});if(f.e.r<l)f.e.r=l;++s});if(s>0)o["!ref"]=yr(f);return o}Bn.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";var Qh=lt("chartsheet",null,{xmlns:ct.main[0],"xmlns:r":ct.r});function Zh(e,t,r,n,i){if(!e)return e;if(!n)n={"!id":{}};var a={"!type":"chart","!drawel":null,"!rel":""};var o;var s=e.match(kd);if(s)Dd(s[0],a,i,r);if(o=e.match(/drawing r:id="(.*?)"/))a["!rel"]=o[1];if(n["!id"][a["!rel"]])a["!drawel"]=n["!id"][a["!rel"]];return a}function ev(e,t,r,n){var i=[ve,Qh];i[i.length]=lt("drawing",null,{"r:id":"rId1"});Vn(n,-1,"../drawings/drawing"+(e+1)+".xml",Bn.DRAW);if(i.length>2){i[i.length]="</chartsheet>";i[1]=i[1].replace("/>",">")}return i.join("")}function tv(e,t){e.l+=10;var r=_r(e,t-10);return{name:r}}function rv(e,i,a,t,o){if(!e)return e;if(!t)t={"!id":{}};var s={"!type":"chart","!drawel":null,"!rel":""};var l=[];var u=false;Jt(e,function e(t,r,n){switch(n){case 550:s["!rel"]=t;break;case 651:if(!o.Sheets[a])o.Sheets[a]={};if(t.name)o.Sheets[a].CodeName=t.name;break;case 562:;case 652:;case 669:;case 679:;case 551:;case 552:;case 476:;case 3072:break;case 35:u=true;break;case 36:u=false;break;case 37:l.push(r);break;case 38:l.pop();break;default:if((r||"").indexOf("Begin")>0)l.push(r);else if((r||"").indexOf("End")>0)l.pop();else if(!u||i.WTF)throw new Error("Unexpected record "+n+" "+r)}},i);if(t["!id"][s["!rel"]])s["!drawel"]=t["!id"][s["!rel"]];return s}function nv(){var e=Qt();Zt(e,"BrtBeginSheet");Zt(e,"BrtEndSheet");return e.end()}var iv=[["allowRefreshQuery",false,"bool"],["autoCompressPictures",true,"bool"],["backupFile",false,"bool"],["checkCompatibility",false,"bool"],["CodeName",""],["date1904",false,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",false,"bool"],["hidePivotFieldList",false,"bool"],["promptedSolutions",false,"bool"],["publishItems",false,"bool"],["refreshAllConnections",false,"bool"],["saveExternalLinkValues",true,"bool"],["showBorderUnselectedTables",true,"bool"],["showInkAnnotation",true,"bool"],["showObjects","all"],["showPivotChartFilter",false,"bool"],["updateLinks","userSet"]];var av=[["activeTab",0,"int"],["autoFilterDateGrouping",true,"bool"],["firstSheet",0,"int"],["minimized",false,"bool"],["showHorizontalScroll",true,"bool"],["showSheetTabs",true,"bool"],["showVerticalScroll",true,"bool"],["tabRatio",600,"int"],["visibility","visible"]];var ov=[];var sv=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lv(e,t){for(var r=0;r!=e.length;++r){var n=e[r];for(var i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":if(typeof n[a[0]]=="string")n[a[0]]=Ye(n[a[0]]);break;case"int":if(typeof n[a[0]]=="string")n[a[0]]=parseInt(n[a[0]],10);break}}}}function uv(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":if(typeof e[n[0]]=="string")e[n[0]]=Ye(e[n[0]]);break;case"int":if(typeof e[n[0]]=="string")e[n[0]]=parseInt(e[n[0]],10);break}}}function fv(e){uv(e.WBProps,iv);uv(e.CalcPr,sv);lv(e.WBView,av);lv(e.Sheets,ov);ld.date1904=Ye(e.WBProps.date1904)}function cv(e){if(!e.Workbook)return"false";if(!e.Workbook.WBProps)return"false";return Ye(e.Workbook.WBProps.date1904)?"true":"false"}var dv="][*?/\\".split("");function hv(t,r){if(t.length>31){if(r)return false;throw new Error("Sheet names cannot exceed 31 chars")}var n=true;dv.forEach(function(e){if(t.indexOf(e)==-1)return;if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=false});return n}function vv(i,a,o){i.forEach(function(e,t){hv(e);for(var r=0;r<t;++r)if(e==i[r])throw new Error("Duplicate Sheet Name: "+e);if(o){var n=a&&a[t]&&a[t].CodeName||e;if(n.charCodeAt(0)==95&&n.length>22)throw new Error("Bad Code Name: Worksheet"+n)}})}function pv(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];vv(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)pd(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var gv=/<\w+:workbook/;function mv(i,a){if(!i)throw new Error("Could not find file");var o={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""};var s=false,l="xmlns";var u={},f=0;i.replace(we,function e(t,r){var n=Ee(t);switch(ke(n[0])){case"<?xml":break;case"<workbook":if(t.match(gv))l="xmlns"+t.match(/<(\w+):/)[1];o.xmlns=n[l];break;case"</workbook>":break;case"<fileVersion":delete n[0];o.AppVersion=n;break;case"<fileVersion/>":;case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":;case"<workbookPr/>":iv.forEach(function(e){if(n[e[0]]==null)return;switch(e[2]){case"bool":o.WBProps[e[0]]=Ye(n[e[0]]);break;case"int":o.WBProps[e[0]]=parseInt(n[e[0]],10);break;default:o.WBProps[e[0]]=n[e[0]]}});if(n.codeName)o.WBProps.CodeName=Ge(n.codeName);break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":;case"<bookViews>":;case"</bookViews>":break;case"<workbookView":;case"<workbookView/>":delete n[0];o.WBView.push(n);break;case"</workbookView>":break;case"<sheets":;case"<sheets>":;case"</sheets>":break;case"<sheet":switch(n.state){case"hidden":n.Hidden=1;break;case"veryHidden":n.Hidden=2;break;default:n.Hidden=0}delete n.state;n.name=Fe(Ge(n.name));delete n[0];o.Sheets.push(n);break;case"</sheet>":break;case"<functionGroups":;case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":;case"</externalReferences>":;case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":;case"<definedNames":s=true;break;case"</definedNames>":s=false;break;case"<definedName":{u={};u.Name=Ge(n.name);if(n.comment)u.Comment=n.comment;if(n.localSheetId)u.Sheet=+n.localSheetId;if(Ye(n.hidden||"0"))u.Hidden=true;f=r+t.length}break;case"</definedName>":{u.Ref=Fe(Ge(i.slice(f,r)));o.Names.push(u)}break;case"<definedName/>":break;case"<calcPr":delete n[0];o.CalcPr=n;break;case"<calcPr/>":delete n[0];o.CalcPr=n;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":;case"</customWorkbookViews>":;case"<customWorkbookViews":break;case"<customWorkbookView":;case"</customWorkbookView>":break;case"<pivotCaches>":;case"</pivotCaches>":;case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":;case"<smartTagPr/>":break;case"<smartTagTypes":;case"<smartTagTypes>":;case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":;case"<webPublishing/>":break;case"<fileRecoveryPr":;case"<fileRecoveryPr/>":break;case"<webPublishObjects>":;case"<webPublishObjects":;case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":;case"<extLst>":;case"</extLst>":;case"<extLst/>":break;case"<ext":s=true;break;case"</ext>":s=false;break;case"<ArchID":break;case"<AlternateContent":;case"<AlternateContent>":s=true;break;case"</AlternateContent>":s=false;break;case"<revisionPtr":break;default:if(!s&&a.WTF)throw new Error("unrecognized "+n[0]+" in workbook")}return t});if(ct.main.indexOf(o.xmlns)===-1)throw new Error("Unknown Namespace: "+o.xmlns);fv(o);return o}var yv=lt("workbook",null,{xmlns:ct.main[0],"xmlns:r":ct.r});function bv(t){var r=[ve];r[r.length]=yv;var e=t.Workbook&&(t.Workbook.Names||[]).length>0;var n={codeName:"ThisWorkbook"};if(t.Workbook&&t.Workbook.WBProps){iv.forEach(function(e){if(t.Workbook.WBProps[e[0]]==null)return;if(t.Workbook.WBProps[e[0]]==e[1])return;n[e[0]]=t.Workbook.WBProps[e[0]]});if(t.Workbook.WBProps.CodeName){n.codeName=t.Workbook.WBProps.CodeName;delete n.CodeName}}r[r.length]=lt("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[];var a=0;if(i&&i[0]&&!!i[0].Hidden){r[r.length]="<bookViews>";for(a=0;a!=t.SheetNames.length;++a){if(!i[a])break;if(!i[a].Hidden)break}if(a==t.SheetNames.length)a=0;r[r.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>';r[r.length]="</bookViews>"}r[r.length]="<sheets>";for(a=0;a!=t.SheetNames.length;++a){var o={name:$e(t.SheetNames[a].slice(0,31))};o.sheetId=""+(a+1);o["r:id"]="rId"+(a+1);if(i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=lt("sheet",null,o)}r[r.length]="</sheets>";if(e){r[r.length]="<definedNames>";if(t.Workbook&&t.Workbook.Names)t.Workbook.Names.forEach(function(e){var t={name:e.Name};if(e.Comment)t.comment=e.Comment;if(e.Sheet!=null)t.localSheetId=""+e.Sheet;if(e.Hidden)t.hidden="1";if(!e.Ref)return;r[r.length]=lt("definedName",$e(e.Ref),t)});r[r.length]="</definedNames>"}if(r.length>2){r[r.length]="</workbook>";r[1]=r[1].replace("/>",">")}return r.join("")}function wv(e,t){var r={};r.Hidden=e._R(4);r.iTabID=e._R(4);r.strRelID=Wr(e,t-8);r.name=_r(e);return r}function Cv(e,t){if(!t)t=Kt(127);t._W(4,e.Hidden);t._W(4,e.iTabID);Ur(e.strRelID,t);xr(e.name.slice(0,31),t);return t.length>t.l?t.slice(0,t.l):t}function Sv(e,t){var r={};var n=e._R(4);r.defaultThemeVersion=e._R(4);var i=t>8?_r(e):"";if(i.length>0)r.CodeName=i;r.autoCompressPictures=!!(n&65536);r.backupFile=!!(n&64);r.checkCompatibility=!!(n&4096);r.date1904=!!(n&1);r.filterPrivacy=!!(n&8);r.hidePivotFieldList=!!(n&1024);r.promptedSolutions=!!(n&16);r.publishItems=!!(n&2048);r.refreshAllConnections=!!(n&262144);r.saveExternalLinkValues=!!(n&128);r.showBorderUnselectedTables=!!(n&4);r.showInkAnnotation=!!(n&32);r.showObjects=["all","placeholders","none"][n>>13&3];r.showPivotChartFilter=!!(n&32768);r.updateLinks=["userSet","never","always"][n>>8&3];return r}function Ev(e,t){if(!t)t=Kt(72);var r=0;if(e){if(e.filterPrivacy)r|=8}t._W(4,r);t._W(4,0);Fr(e&&e.CodeName||"ThisWorkbook",t);return t.slice(0,t.l)}function kv(e,t){var r={};e._R(4);r.ArchID=e._R(4);e.l+=t-8;return r}function Tv(e,t,r){var n=e.l+t;e.l+=4;e.l+=1;var i=e._R(4);var a=$r(e);var o=Jc(e,0,r);var s=Br(e);e.l=n;var l={Name:a,Ptg:o};if(i<268435455)l.Sheet=i;if(s)l.Comment=s;return l}function _v(e,i){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""};var o=[];var s=false;if(!i)i={};i.biff=12;var l=[];var u=[[]];u.SheetNames=[];u.XTI=[];Jt(e,function e(t,r,n){switch(n){case 156:u.SheetNames.push(t.name);a.Sheets.push(t);break;case 153:a.WBProps=t;break;case 39:if(t.Sheet!=null)i.SID=t.Sheet;t.Ref=Hc(t.Ptg,null,null,u,i);delete i.SID;delete t.Ptg;l.push(t);break;case 1036:break;case 357:;case 358:;case 355:;case 667:if(!u[0].length)u[0]=[n,t];else u.push([n,t]);u[u.length-1].XTI=[];break;case 362:if(u.length===0){u[0]=[];u[0].XTI=[]}u[u.length-1].XTI=u[u.length-1].XTI.concat(t);u.XTI=u.XTI.concat(t);break;case 361:break;case 3072:;case 3073:;case 2071:;case 534:;case 677:;case 158:;case 157:;case 610:;case 2050:;case 155:;case 548:;case 676:;case 128:;case 665:;case 2128:;case 2125:;case 549:;case 2053:;case 596:;case 2076:;case 2075:;case 2082:;case 397:;case 154:;case 1117:;case 553:;case 2091:break;case 35:o.push(r);s=true;break;case 36:o.pop();s=false;break;case 37:o.push(r);s=true;break;case 38:o.pop();s=false;break;case 16:break;default:if((r||"").indexOf("Begin")>0){}else if((r||"").indexOf("End")>0){}else if(!s||i.WTF&&o[o.length-1]!="BrtACBegin"&&o[o.length-1]!="BrtFRTBegin")throw new Error("Unexpected record "+n+" "+r)}},i);fv(a);a.Names=l;a.supbooks=u;return a}function xv(e,t){Zt(e,"BrtBeginBundleShs");for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0;var i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Zt(e,"BrtBundleSh",Cv(i))}Zt(e,"BrtEndBundleShs")}function Dv(e,t){if(!t)t=Kt(127);for(var r=0;r!=4;++r)t._W(4,0);xr("SheetJS",t);xr(n.version,t);xr(n.version,t);xr("7262",t);t.length=t.l;return t.length>t.l?t.slice(0,t.l):t}function Rv(e,t){if(!t)t=Kt(29);t._W(-4,0);t._W(-4,460);t._W(4,28800);t._W(4,17600);t._W(4,500);t._W(4,e);t._W(4,e);var r=120;t._W(1,r);return t.length>t.l?t.slice(0,t.l):t}function Iv(e,t){if(!t.Workbook||!t.Workbook.Sheets)return;var r=t.Workbook.Sheets;var n=0,i=-1,a=-1;for(;n<r.length;++n){if(!r[n]||!r[n].Hidden&&i==-1)i=n;else if(r[n].Hidden==1&&a==-1)a=n}if(a>i)return;Zt(e,"BrtBeginBookViews");Zt(e,"BrtBookView",Rv(i));Zt(e,"BrtEndBookViews")}function Ov(e,t){var r=Qt();Zt(r,"BrtBeginBook");Zt(r,"BrtFileVersion",Dv());Zt(r,"BrtWbProp",Ev(e.Workbook&&e.Workbook.WBProps||null));Iv(r,e,t);xv(r,e,t);Zt(r,"BrtEndBook");return r.end()}function Av(e,t,r){if(t.slice(-4)===".bin")return _v(e,r);return mv(e,r)}function Nv(e,t,r,n,i,a,o,s){if(t.slice(-4)===".bin")return Fh(e,n,r,i,a,o,s);return _d(e,n,r,i,a,o,s)}function Mv(e,t,r,n,i,a,o,s){if(t.slice(-4)===".bin")return rv(e,n,r,i,a,o,s);return Zh(e,n,r,i,a,o,s)}function Lv(e,t,r,n,i,a,o,s){if(t.slice(-4)===".bin")return ef(e,n,r,i,a,o,s);return tf(e,n,r,i,a,o,s)}function Pv(e,t,r,n,i,a,o,s){if(t.slice(-4)===".bin")return Qu(e,n,r,i,a,o,s);return Zu(e,n,r,i,a,o,s)}function Fv(e,t,r,n){if(t.slice(-4)===".bin")return Zl(e,r,n);return Ll(e,r,n)}function Bv(e,t,r){return wu(e,r)}function Hv(e,t,r){if(t.slice(-4)===".bin")return As(e,r);return Ds(e,r)}function $v(e,t,r){if(t.slice(-4)===".bin")return qu(e,r);return Hu(e,r)}function Wv(e,t,r){if(t.slice(-4)===".bin")return Au(e,t,r);return Iu(e,t,r)}function Uv(e,t,r,n){if(r.slice(-4)===".bin")return Mu(e,t,r,n);return Nu(e,t,r,n)}function jv(e,t,r){return(t.slice(-4)===".bin"?Ov:bv)(e,r)}function Vv(e,t,r,n,i){return(t.slice(-4)===".bin"?Xh:Yd)(e,r,n,i)}function zv(e,t,r,n,i){return(t.slice(-4)===".bin"?nv:ev)(e,r,n,i)}function qv(e,t,r){return(t.slice(-4)===".bin"?fu:Fl)(e,r)}function Yv(e,t,r){return(t.slice(-4)===".bin"?Ls:Is)(e,r)}function Gv(e,t,r){return(t.slice(-4)===".bin"?Yu:Wu)(e,r)}var Xv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g;var Kv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Jv(e,t){var r=e.split(/\s+/);var n=[];if(!t)n[0]=r[0];if(r.length===1)return n;var i=e.match(Xv),a,o,s,l;if(i)for(l=0;l!=i.length;++l){a=i[l].match(Kv);if((o=a[1].indexOf(":"))===-1)n[a[1]]=a[2].slice(1,a[2].length-1);else{if(a[1].slice(0,6)==="xmlns:")s="xmlns"+a[1].slice(6);else s=a[1].slice(o+1);n[s]=a[2].slice(1,a[2].length-1)}}return n}function Qv(e){var t=e.split(/\s+/);var r={};if(t.length===1)return r;var n=e.match(Xv),i,a,o,s;if(n)for(s=0;s!=n.length;++s){i=n[s].match(Kv);if((a=i[1].indexOf(":"))===-1)r[i[1]]=i[2].slice(1,i[2].length-1);else{if(i[1].slice(0,6)==="xmlns:")o="xmlns"+i[1].slice(6);else o=i[1].slice(a+1);r[o]=i[2].slice(1,i[2].length-1)}}return r}function Zv(e,t){var r=ne[e]||Fe(e);if(r==="General")return me._general(t);return me.format(r,t)}function ep(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ye(n);break;case"i2":;case"int":i=parseInt(n,10);break;case"r4":;case"float":i=parseFloat(n);break;case"date":;case"dateTime.tz":i=ae(n);break;case"i8":;case"string":;case"fixed":;case"uuid":;case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Fe(t)]=i}function tp(e,t,r){if(e.t==="z")return;if(!r||r.cellText!==false)try{if(e.t==="e"){e.w=e.w||Dn[e.v]}else if(t==="General"){if(e.t==="n"){if((e.v|0)===e.v)e.w=me._general_int(e.v);else e.w=me._general_num(e.v)}else e.w=me._general(e.v)}else e.w=Zv(t||"General",e.v)}catch(e){if(r.WTF)throw e}try{var n=ne[t]||t||"General";if(r.cellNF)e.z=n;if(r.cellDates&&e.t=="n"&&me.is_date(n)){var i=me.parse_date_code(e.v);if(i){e.t="d";e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)}}}catch(e){if(r.WTF)throw e}}function rp(e,t,r){if(r.cellStyles){if(t.Interior){var n=t.Interior;if(n.Pattern)n.patternType=Tl[n.Pattern]||n.Pattern}}e[t.ID]=t}function np(e,t,r,n,i,a,o,s,l,u){var f="General",c=n.StyleID,d={};u=u||{};var h=[];var v=0;if(c===undefined&&s)c=s.StyleID;if(c===undefined&&o)c=o.StyleID;while(a[c]!==undefined){if(a[c].nf)f=a[c].nf;if(a[c].Interior)h.push(a[c].Interior);if(!a[c].Parent)break;c=a[c].Parent}switch(r.Type){case"Boolean":n.t="b";n.v=Ye(e);break;case"String":n.t="s";n.r=ze(Fe(e));n.v=e.indexOf("<")>-1?Fe(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":if(e.slice(-1)!="Z")e+="Z";n.v=(ae(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3);if(n.v!==n.v)n.v=Fe(e);else if(n.v<60)n.v=n.v-1;if(!f||f=="General")f="yyyy-mm-dd";case"Number":if(n.v===undefined)n.v=+e;if(!n.t)n.t="n";break;case"Error":n.t="e";n.v=Rn[e];if(u.cellText!==false)n.w=e;break;default:if(e==""&&t==""){n.t="z"}else{n.t="s";n.v=ze(t||e)}break}tp(n,f,u);if(u.cellFormula!==false){if(n.Formula){var p=Fe(n.Formula);if(p.charCodeAt(0)==61)p=p.slice(1);n.f=rf(p,i);delete n.Formula;if(n.ArrayRange=="RC")n.F=rf("RC:RC",i);else if(n.ArrayRange){n.F=rf(n.ArrayRange,i);l.push([br(n.F),n.F])}}else{for(v=0;v<l.length;++v)if(i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r)if(i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c)n.F=l[v][1]}}if(u.cellStyles){h.forEach(function(e){if(!d.patternType&&e.patternType)d.patternType=e.patternType});n.s=d}if(n.StyleID!==undefined)n.ixfe=n.StyleID}function ip(e){e.t=e.v||"";e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n");e.v=e.w=e.ixfe=undefined}function ap(e){if(_e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e==="string")return e;if(typeof Uint8Array!=="undefined"&&e instanceof Uint8Array)return Ge(g(y(e)));throw new Error("Bad input format: expected Buffer or string")}var op=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm;function sp(e,t){var r=t||{};re(me);var n=te(ap(e));if(r.type=="binary"||r.type=="array"||r.type=="base64"){if(typeof cptable!=="undefined")n=cptable.utils.decode(65001,ee(n));else n=Ge(n)}var i=n.slice(0,1024).toLowerCase(),a=false;if(i.indexOf("<?xml")==-1)["html","table","head","meta","script","style","div"].forEach(function(e){if(i.indexOf("<"+e)>=0)a=true});if(a)return eg.to_workbook(n,r);var o;var s=[],l;if(ge!=null&&r.dense==null)r.dense=ge;var u={},f=[],c=r.dense?[]:{},d="";var h={},v={},p={};var g=Jv('<Data ss:Type="String">'),m=0;var y=0,b=0;var w={s:{r:2e6,c:2e6},e:{r:0,c:0}};var C={},S={};var E="",k=0;var T=[];var _={},x={},D=0,R=[];var I=[],O={};var A=[],N,M=false;var L=[];var P=[],F={},B=0,H=0;var $={Sheets:[],WBProps:{date1904:false}},W={};op.lastIndex=0;n=n.replace(/<!--([\s\S]*?)-->/gm,"");var U="";while(o=op.exec(n))switch(o[3]=(U=o[3]).toLowerCase()){case"data":if(U=="data"){if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/")s.push([o[3],true]);break}if(s[s.length-1][1])break;if(o[1]==="/")np(n.slice(m,o.index),E,g,s[s.length-1][0]=="comment"?O:v,{c:y,r:b},C,A[y],p,L,r);else{E="";g=Jv(o[0]);m=o.index+o[0].length}break;case"cell":if(o[1]==="/"){if(I.length>0)v.c=I;if((!r.sheetRows||r.sheetRows>b)&&v.v!==undefined){if(r.dense){if(!c[b])c[b]=[];c[b][y]=v}else c[cr(y)+sr(b)]=v}if(v.HRef){v.l={Target:v.HRef};if(v.HRefScreenTip)v.l.Tooltip=v.HRefScreenTip;delete v.HRef;delete v.HRefScreenTip}if(v.MergeAcross||v.MergeDown){B=y+(parseInt(v.MergeAcross,10)|0);H=b+(parseInt(v.MergeDown,10)|0);T.push({s:{c:y,r:b},e:{c:B,r:H}})}if(!r.sheetStubs){if(v.MergeAcross)y=B+1;else++y}else if(v.MergeAcross||v.MergeDown){for(var j=y;j<=B;++j){for(var V=b;V<=H;++V){if(j>y||V>b){if(r.dense){if(!c[V])c[V]=[];c[V][j]={t:"z"}}else c[cr(j)+sr(V)]={t:"z"}}}}y=B+1}else++y}else{v=Qv(o[0]);if(v.Index)y=+v.Index-1;if(y<w.s.c)w.s.c=y;if(y>w.e.c)w.e.c=y;if(o[0].slice(-2)==="/>")++y;I=[]}break;case"row":if(o[1]==="/"||o[0].slice(-2)==="/>"){if(b<w.s.r)w.s.r=b;if(b>w.e.r)w.e.r=b;if(o[0].slice(-2)==="/>"){p=Jv(o[0]);if(p.Index)b=+p.Index-1}y=0;++b}else{p=Jv(o[0]);if(p.Index)b=+p.Index-1;F={};if(p.AutoFitHeight=="0"||p.Height){F.hpx=parseInt(p.Height,10);F.hpt=El(F.hpx);P[b]=F}if(p.Hidden=="1"){F.hidden=true;P[b]=F}}break;case"worksheet":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));f.push(d);if(w.s.r<=w.e.r&&w.s.c<=w.e.c){c["!ref"]=yr(w);if(r.sheetRows&&r.sheetRows<=w.e.r){c["!fullref"]=c["!ref"];w.e.r=r.sheetRows-1;c["!ref"]=yr(w)}}if(T.length)c["!merges"]=T;if(A.length>0)c["!cols"]=A;if(P.length>0)c["!rows"]=P;u[d]=c}else{w={s:{r:2e6,c:2e6},e:{r:0,c:0}};b=y=0;s.push([o[3],false]);l=Jv(o[0]);d=Fe(l.Name);c=r.dense?[]:{};T=[];L=[];P=[];W={name:d,Hidden:0};$.Sheets.push(W)}break;case"table":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].slice(-2)=="/>")break;else{h=Jv(o[0]);s.push([o[3],false]);A=[];M=false}break;case"style":if(o[1]==="/")rp(C,S,r);else S=Jv(o[0]);break;case"numberformat":S.nf=Fe(Jv(o[0]).Format||"General");if(ne[S.nf])S.nf=ne[S.nf];for(var z=0;z!=392;++z)if(me._table[z]==S.nf)break;if(z==392)for(z=57;z!=392;++z)if(me._table[z]==null){me.load(S.nf,z);break}break;case"column":if(s[s.length-1][0]!=="table")break;N=Jv(o[0]);if(N.Hidden){N.hidden=true;delete N.Hidden}if(N.Width)N.wpx=parseInt(N.Width,10);if(!M&&N.wpx>10){M=true;vl=cl;for(var q=0;q<A.length;++q)if(A[q])wl(A[q])}if(M)wl(N);A[N.Index-1||A.length]=N;for(var Y=0;Y<+N.Span;++Y)A[A.length]=oe(N);break;case"namedrange":if(o[1]==="/")break;if(!$.Names)$.Names=[];var G=Ee(o[0]);var X={Name:G.Name,Ref:rf(G.RefersTo.slice(1),{r:0,c:0})};if($.Sheets.length>0)X.Sheet=$.Sheets.length-1;$.Names.push(X);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;else if(o[1]==="/")E+=n.slice(k,o.index);else k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=Jv(o[0]);break;case"protection":break;case"author":;case"title":;case"description":;case"created":;case"keywords":;case"subject":;case"category":;case"company":;case"lastauthor":;case"lastsaved":;case"lastprinted":;case"version":;case"revision":;case"totaltime":;case"hyperlinkbase":;case"manager":;case"contentstatus":;case"identifier":;case"language":;case"appname":if(o[0].slice(-2)==="/>")break;else if(o[1]==="/")gi(_,U,n.slice(D,o.index));else D=o.index+o[0].length;break;case"paragraphs":break;case"styles":;case"workbook":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else s.push([o[3],false]);break;case"comment":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));ip(O);I.push(O)}else{s.push([o[3],false]);l=Jv(o[0]);O={a:l.Author}}break;case"autofilter":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var K=Jv(o[0]);c["!autofilter"]={ref:rf(K.Range).replace(/\$/g,"")};s.push([o[3],true])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].charAt(o[0].length-2)!=="/")s.push([o[3],true])}break;case"pixelsperinch":break;case"componentoptions":;case"documentproperties":;case"customdocumentproperties":;case"officedocumentsettings":;case"pivottable":;case"pivotcache":;case"names":;case"mapinfo":;case"pagebreaks":;case"querytable":;case"sorting":;case"schema":;case"conditionalformatting":;case"smarttagtype":;case"smarttags":;case"excelworkbook":;case"workbookoptions":;case"worksheetoptions":if(o[1]==="/"){if((l=s.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/")s.push([o[3],true]);break;default:if(s.length==0&&o[3]=="document")return lg(n,r);if(s.length==0&&o[3]=="uof")return lg(n,r);var J=true;switch(s[s.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=false}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=false}break;case"excelworkbook":switch(o[3]){case"date1904":$.WBProps.date1904=true;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=false}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:J=false}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)==="/>"){}else if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else D=o.index+o[0].length;break;case"header":if(!c["!margins"])dd(c["!margins"]={},"xlml");c["!margins"].header=Ee(o[0]).Margin;break;case"footer":if(!c["!margins"])dd(c["!margins"]={},"xlml");c["!margins"].footer=Ee(o[0]).Margin;break;case"pagemargins":var Q=Ee(o[0]);if(!c["!margins"])dd(c["!margins"]={},"xlml");if(Q.Top)c["!margins"].top=Q.Top;if(Q.Left)c["!margins"].left=Q.Left;if(Q.Right)c["!margins"].right=Q.Right;if(Q.Bottom)c["!margins"].bottom=Q.Bottom;break;case"displayrighttoleft":if(!$.Views)$.Views=[];if(!$.Views[0])$.Views[0]={};$.Views[0].RTL=true;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":;case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=false}break;case"pivottable":;case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=false}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=false}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=false}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=false}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=false}break;case"sorting":;case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=false}break;case"mapinfo":;case"schema":;case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":;case"element":;case"complextype":;case"datatype":;case"all":;case"attribute":;case"extends":break;case"row":break;default:J=false}break;case"smarttags":break;default:J=false;break}if(J)break;if(o[3].match(/!\[CDATA/))break;if(!s[s.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+s.join("|");if(s[s.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;else if(o[1]==="/")ep(x,U,R,n.slice(D,o.index));else{R=o;D=o.index+o[0].length}break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+s.join("|")}var Z={};if(!r.bookSheets&&!r.bookProps)Z.Sheets=u;Z.SheetNames=f;Z.Workbook=$;Z.SSF=me.get_table();Z.Props=_;Z.Custprops=x;return Z}function lp(e,t){kg(t=t||{});switch(t.type||"base64"){case"base64":return sp(Te.decode(e),t);case"binary":;case"buffer":;case"file":return sp(e,t);case"array":return sp(g(e),t)}}function up(e,t){var r=[];if(e.Props)r.push(mi(e.Props,t));if(e.Custprops)r.push(yi(e.Props,e.Custprops,t));return r.join("")}function fp(){return""}function cp(e,t){var i=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];t.cellXfs.forEach(function(e,t){var r=[];r.push(lt("NumberFormat",null,{"ss:Format":$e(me._table[e.numFmtId])}));var n={"ss:ID":"s"+(21+t)};i.push(lt("Style",r.join(""),n))});return lt("Styles",i.join(""))}function dp(e){return lt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+af(e.Ref,{r:0,c:0})})}function hp(e){if(!((e||{}).Workbook||{}).Names)return"";var t=e.Workbook.Names;var r=[];for(var n=0;n<t.length;++n){var i=t[n];if(i.Sheet!=null)continue;if(i.Name.match(/^_xlfn\./))continue;r.push(dp(i))}return lt("Names",r.join(""))}function vp(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";var i=n.Workbook.Names;var a=[];for(var o=0;o<i.length;++o){var s=i[o];if(s.Sheet!=r)continue;if(s.Name.match(/^_xlfn\./))continue;a.push(dp(s))}return a.join("")}function pp(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]){i.push("<PageSetup>");if(t["!margins"].header)i.push(lt("Header",null,{"x:Margin":t["!margins"].header}));if(t["!margins"].footer)i.push(lt("Footer",null,{"x:Margin":t["!margins"].footer}));i.push(lt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"}));i.push("</PageSetup>")}if(n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r]){if(n.Workbook.Sheets[r].Hidden)i.push(lt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r;++a)if(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden)break;if(a==r)i.push("<Selected/>")}}if(((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL)i.push("<DisplayRightToLeft/>");if(t["!protect"]){i.push(ot("ProtectContents","True"));if(t["!protect"].objects)i.push(ot("ProtectObjects","True"));if(t["!protect"].scenarios)i.push(ot("ProtectScenarios","True"));if(t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells)i.push(ot("EnableSelection","NoSelection"));else if(t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells)i.push(ot("EnableSelection","UnlockedCells"));[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(e){if(t["!protect"][e[0]])i.push("<"+e[1]+"/>")})}if(i.length==0)return"";return lt("WorksheetOptions",i.join(""),{xmlns:dt.x})}function gp(e){return e.map(function(e){var t=qe(e.t||"");var r=lt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return lt("Comment",r,{"ss:Author":e.a})}).join("")}function mp(e,t,r,n,i,a,o){if(!e||e.v==undefined&&e.f==undefined)return"";var s={};if(e.f)s["ss:Formula"]="="+$e(af(e.f,o));if(e.F&&e.F.slice(0,t.length)==t){var l=pr(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target){s["ss:HRef"]=$e(e.l.Target);if(e.l.Tooltip)s["x:HRefScreenTip"]=$e(e.l.Tooltip)}if(r["!merges"]){var u=r["!merges"];for(var f=0;f!=u.length;++f){if(u[f].s.c!=o.c||u[f].s.r!=o.r)continue;if(u[f].e.c>u[f].s.c)s["ss:MergeAcross"]=u[f].e.c-u[f].s.c;if(u[f].e.r>u[f].s.r)s["ss:MergeDown"]=u[f].e.r-u[f].s.r}}var c="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":c="Number";d=String(e.v);break;case"b":c="Boolean";d=e.v?"1":"0";break;case"e":c="Error";d=Dn[e.v];break;case"d":c="DateTime";d=new Date(e.v).toISOString();if(e.z==null)e.z=e.z||me._table[14];break;case"s":c="String";d=Ve(e.v||"");break}var h=hd(n.cellXfs,e,n);s["ss:StyleID"]="s"+(21+h);s["ss:Index"]=o.c+1;var v=e.v!=null?d:"";var p=e.t=="z"?"":'<Data ss:Type="'+c+'">'+v+"</Data>";if((e.c||[]).length>0)p+=gp(e.c);return lt("Cell",p,s)}function yp(e,t){var r='<Row ss:Index="'+(e+1)+'"';if(t){if(t.hpt&&!t.hpx)t.hpx=kl(t.hpt);if(t.hpx)r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"';if(t.hidden)r+=' ss:Hidden="1"'}return r+">"}function bp(e,t,r,n){if(!e["!ref"])return"";var i=br(e["!ref"]);var a=e["!merges"]||[],o=0;var s=[];if(e["!cols"])e["!cols"].forEach(function(e,t){wl(e);var r=!!e.width;var n=cd(t,e);var i={"ss:Index":t+1};if(r)i["ss:Width"]=pl(n.width);if(e.hidden)i["ss:Hidden"]="1";s.push(lt("Column",null,i))});var l=Array.isArray(e);for(var u=i.s.r;u<=i.e.r;++u){var f=[yp(u,(e["!rows"]||[])[u])];for(var c=i.s.c;c<=i.e.c;++c){var d=false;for(o=0;o!=a.length;++o){if(a[o].s.c>c)continue;if(a[o].s.r>u)continue;if(a[o].e.c<c)continue;if(a[o].e.r<u)continue;if(a[o].s.c!=c||a[o].s.r!=u)d=true;break}if(d)continue;var h={r:u,c:c};var v=gr(h),p=l?(e[u]||[])[c]:e[v];f.push(mp(p,v,e,t,r,n,h))}f.push("</Row>");if(f.length>2)s.push(f.join(""))}return s.join("")}function wp(e,t,r){var n=[];var i=r.SheetNames[e];var a=r.Sheets[i];var o=a?vp(a,t,e,r):"";if(o.length>0)n.push("<Names>"+o+"</Names>");o=a?bp(a,t,e,r):"";if(o.length>0)n.push("<Table>"+o+"</Table>");n.push(pp(a,t,e,r));return n.join("")}function Cp(e,t){if(!t)t={};if(!e.SSF)e.SSF=me.get_table();if(e.SSF){re(me);me.load_table(e.SSF);t.revssf=O(e.SSF);t.revssf[e.SSF[65535]]=0;t.ssf=e.SSF;t.cellXfs=[];hd(t.cellXfs,{},{revssf:{General:0}})}var r=[];r.push(up(e,t));r.push(fp(e,t));r.push("");r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(lt("Worksheet",wp(n,t,e),{"ss:Name":$e(e.SheetNames[n])}));r[2]=cp(e,t);r[3]=hp(e,t);return ve+lt("Workbook",r.join(""),{xmlns:dt.ss,"xmlns:o":dt.o,"xmlns:x":dt.x,"xmlns:ss":dt.ss,"xmlns:dt":dt.dt,"xmlns:html":dt.html})}function Sp(e){var t={};var r=e.content;r.l=28;t.AnsiUserType=r._R(0,"lpstr-ansi");t.AnsiClipboardFormat=rn(r);if(r.length-r.l<=4)return t;var n=r._R(4);if(n==0||n>40)return t;r.l-=4;t.Reserved1=r._R(0,"lpstr-ansi");if(r.length-r.l<=4)return t;n=r._R(4);if(n!==1907505652)return t;t.UnicodeClipboardFormat=nn(r);n=r._R(4);if(n==0||n>40)return t;r.l-=4;t.Reserved2=r._R(0,"lpwstr")}function Ep(e,t,r,n){var i=r;var a=[];var o=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu)switch(e.n){case"BOF":;case"FilePass":;case"FileLock":;case"InterfaceHdr":;case"RRDInfo":;case"RRDHead":;case"UsrExcl":break;default:if(o.length===0)break;n.enc.insitu(o)}a.push(o);t.l+=i;var s=Mp[Ft(t,t.l)];var l=0;while(s!=null&&s.n.slice(0,8)==="Continue"){i=Ft(t,t.l+2);l=t.l+4;if(s.n=="ContinueFrt")l+=4;else if(s.n.slice(0,11)=="ContinueFrt")l+=12;a.push(t.slice(l,t.l+4+i));t.l+=4+i;s=Mp[Ft(t,t.l)]}var u=Ie(a);Gt(u,0);var f=0;u.lens=[];for(var c=0;c<a.length;++c){u.lens.push(f);f+=a[c].length}return e.f(u,u.length,n)}function kp(e,t,r){if(e.t==="z")return;if(!e.XF)return;var n=0;try{n=e.z||e.XF.numFmtId||0;if(t.cellNF)e.z=me._table[n]}catch(e){if(t.WTF)throw e}if(!t||t.cellText!==false)try{if(e.t==="e"){e.w=e.w||Dn[e.v]}else if(n===0||n=="General"){if(e.t==="n"){if((e.v|0)===e.v)e.w=me._general_int(e.v);else e.w=me._general_num(e.v)}else e.w=me._general(e.v)}else e.w=me.format(n,e.v,{date1904:!!r})}catch(e){if(t.WTF)throw e}if(t.cellDates&&n&&e.t=="n"&&me.is_date(me._table[n]||String(n))){var i=me.parse_date_code(e.v);if(i){e.t="d";e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)}}}function Tp(e,t,r){return{v:e,ixfe:t,t:r}}function _p(e,t){var r={opts:{}};var n={};if(ge!=null&&t.dense==null)t.dense=ge;var a=t.dense?[]:{};var i={};var o={};var s=null;var l=[];var u="";var f={};var c,d="",h,v,p,g;var m={};var y=[];var b;var w;var C=true;var S=[];var E=[];var k={Sheets:[],WBProps:{date1904:false},Views:[{}]},T={};var _=function e(t){if(t<8)return xn[t];if(t<64)return E[t-8]||xn[t];return xn[t]};var x=function e(t,r,n){var i=r.XF.data;if(!i||!i.patternType||!n||!n.cellStyles)return;r.s={};r.s.patternType=i.patternType;var a;if(a=sl(_(i.icvFore))){r.s.fgColor={rgb:a}}if(a=sl(_(i.icvBack))){r.s.bgColor={rgb:a}}};var D=function e(t,r,n){if($>1)return;if(n.sheetRows&&t.r>=n.sheetRows)C=false;if(!C)return;if(n.cellStyles&&r.XF&&r.XF.data)x(t,r,n);delete r.ixfe;delete r.XF;c=t;d=gr(t);if(!o||!o.s||!o.e)o={s:{r:0,c:0},e:{r:0,c:0}};if(t.r<o.s.r)o.s.r=t.r;if(t.c<o.s.c)o.s.c=t.c;if(t.r+1>o.e.r)o.e.r=t.r+1;if(t.c+1>o.e.c)o.e.c=t.c+1;if(n.cellFormula&&r.f){for(var i=0;i<y.length;++i){if(y[i][0].s.c>t.c||y[i][0].s.r>t.r)continue;if(y[i][0].e.c<t.c||y[i][0].e.r<t.r)continue;r.F=yr(y[i][0]);if(y[i][0].s.c!=t.c||y[i][0].s.r!=t.r)delete r.f;if(r.f)r.f=""+Hc(y[i][1],o,t,B,R);break}}{if(n.dense){if(!a[t.r])a[t.r]=[];a[t.r][t.c]=r}else a[d]=r}};var R={enc:false,sbcch:0,snames:[],sharedf:m,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};if(t.password)R.password=t.password;var I;var O=[];var A=[];var N=[],M=[];var L=0,P=0;var F=false;var B=[];B.SheetNames=R.snames;B.sharedf=R.sharedf;B.arrayf=R.arrayf;B.names=[];B.XTI=[];var H="";var $=0;var W=0,U=[];var j=[];var V;R.codepage=1200;pe(1200);var z=false;while(e.l<e.length-1){var q=e.l;var Y=e._R(2);if(Y===0&&H==="EOF")break;var G=e.l===e.length?0:e._R(2);var X=Mp[Y];if(X&&X.f){if(t.bookSheets){if(H==="BoundSheet8"&&X.n!=="BoundSheet8")break}H=X.n;if(X.r===2||X.r==12){var K=e._R(2);G-=2;if(!R.enc&&K!==Y&&((K&255)<<8|K>>8)!==Y)throw new Error("rt mismatch: "+K+"!="+Y);if(X.r==12){e.l+=10;G-=10}}var J={};if(X.n==="EOF")J=X.f(e,G,R);else J=Ep(X,e,G,R);var Q=X.n;if($==0&&Q!="BOF")continue;switch(Q){case"Date1904":r.opts.Date1904=k.WBProps.date1904=J;break;case"WriteProtect":r.opts.WriteProtect=true;break;case"FilePass":if(!R.enc)e.l=0;R.enc=J;if(!t.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case"WriteAccess":R.lastuser=J;break;case"FileSharing":break;case"CodePage":var Z=Number(J);switch(Z){case 21010:Z=1200;break;case 32768:Z=1e4;break;case 32769:Z=1252;break}pe(R.codepage=Z);z=true;break;case"RRTabId":R.rrtabid=J;break;case"WinProtect":R.winlocked=J;break;case"Template":break;case"BookBool":break;case"UsesELFs":break;case"MTRSettings":break;case"RefreshAll":;case"CalcCount":;case"CalcDelta":;case"CalcIter":;case"CalcMode":;case"CalcPrecision":;case"CalcSaveRecalc":r.opts[Q]=J;break;case"CalcRefMode":R.CalcRefMode=J;break;case"Uncalced":break;case"ForceFullCalculation":r.opts.FullCalc=J;break;case"WsBool":if(J.fDialog)a["!type"]="dialog";break;case"XF":S.push(J);break;case"ExtSST":break;case"BookExt":break;case"RichTextStream":break;case"BkHim":break;case"SupBook":B.push([J]);B[B.length-1].XTI=[];break;case"ExternName":B[B.length-1].push(J);break;case"Index":break;case"Lbl":V={Name:J.Name,Ref:Hc(J.rgce,o,null,B,R)};if(J.itab>0)V.Sheet=J.itab-1;B.names.push(V);if(!B[0]){B[0]=[];B[0].XTI=[]}B[B.length-1].push(J);if(J.Name=="_xlnm._FilterDatabase"&&J.itab>0)if(J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d")j[J.itab-1]={ref:yr(J.rgce[0][0][1][2])};break;case"ExternCount":R.ExternCount=J;break;case"ExternSheet":if(B.length==0){B[0]=[];B[0].XTI=[]}B[B.length-1].XTI=B[B.length-1].XTI.concat(J);B.XTI=B.XTI.concat(J);break;case"NameCmt":if(R.biff<8)break;if(V!=null)V.Comment=J[1];break;case"Protect":a["!protect"]=J;break;case"Password":if(J!==0&&R.WTF)console.error("Password verifier: "+J);break;case"Prot4Rev":;case"Prot4RevPass":break;case"BoundSheet8":{i[J.pos]=J;R.snames.push(J.name)}break;case"EOF":{if(--$)break;if(o.e){if(o.e.r>0&&o.e.c>0){o.e.r--;o.e.c--;a["!ref"]=yr(o);if(t.sheetRows&&t.sheetRows<=o.e.r){var ee=o.e.r;o.e.r=t.sheetRows-1;a["!fullref"]=a["!ref"];a["!ref"]=yr(o);o.e.r=ee}o.e.r++;o.e.c++}if(O.length>0)a["!merges"]=O;if(A.length>0)a["!objects"]=A;if(N.length>0)a["!cols"]=N;if(M.length>0)a["!rows"]=M;k.Sheets.push(T)}if(u==="")f=a;else n[u]=a;a=t.dense?[]:{}}break;case"BOF":{if(R.biff===8)R.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8;if(R.biff==8&&J.BIFFVer==0&&J.dt==16)R.biff=2;if($++)break;C=true;a=t.dense?[]:{};if(R.biff<8&&!z){z=true;pe(R.codepage=t.codepage||1252)}if(R.biff<5){if(u==="")u="Sheet1";o={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-G,name:u};i[te.pos]=te;R.snames.push(u)}else u=(i[q]||{name:""}).name;if(J.dt==32)a["!type"]="chart";if(J.dt==64)a["!type"]="macro";O=[];A=[];R.arrayf=y=[];N=[];M=[];L=P=0;F=false;T={Hidden:(i[q]||{hs:0}).hs,name:u}}break;case"Number":;case"BIFF2NUM":;case"BIFF2INT":{if(a["!type"]=="chart")if(t.dense?(a[J.r]||[])[J.c]:a[gr({c:J.c,r:J.r})])++J.c;b={ixfe:J.ixfe,XF:S[J.ixfe]||{},v:J.val,t:"n"};if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:J.c,r:J.r},b,t)}break;case"BoolErr":{b={ixfe:J.ixfe,XF:S[J.ixfe],v:J.val,t:J.t};if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:J.c,r:J.r},b,t)}break;case"RK":{b={ixfe:J.ixfe,XF:S[J.ixfe],v:J.rknum,t:"n"};if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:J.c,r:J.r},b,t)}break;case"MulRk":{for(var re=J.c;re<=J.C;++re){var ne=J.rkrec[re-J.c][0];b={ixfe:ne,XF:S[ne],v:J.rkrec[re-J.c][1],t:"n"};if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:re,r:J.r},b,t)}}break;case"Formula":{if(J.val=="String"){s=J;break}b=Tp(J.val,J.cell.ixfe,J.tt);b.XF=S[b.ixfe];if(t.cellFormula){var ie=J.formula;if(ie&&ie[0]&&ie[0][0]&&ie[0][0][0]=="PtgExp"){var ae=ie[0][0][1][0],oe=ie[0][0][1][1];var se=gr({r:ae,c:oe});if(m[se])b.f=""+Hc(J.formula,o,J.cell,B,R);else b.F=((t.dense?(a[ae]||[])[oe]:a[se])||{}).F}else b.f=""+Hc(J.formula,o,J.cell,B,R)}if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D(J.cell,b,t);s=J}break;case"String":{if(s){s.val=J;b=Tp(J,s.cell.ixfe,"s");b.XF=S[b.ixfe];if(t.cellFormula){b.f=""+Hc(s.formula,o,s.cell,B,R)}if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D(s.cell,b,t);s=null}else throw new Error("String record expects Formula")}break;case"Array":{y.push(J);var le=gr(J[0].s);h=t.dense?(a[J[0].s.r]||[])[J[0].s.c]:a[le];if(t.cellFormula&&h){if(!s)break;if(!le||!h)break;h.f=""+Hc(J[1],o,J[0],B,R);h.F=yr(J[0])}}break;case"ShrFmla":{if(!C)break;if(!t.cellFormula)break;if(d){if(!s)break;m[gr(s.cell)]=J[0];h=t.dense?(a[s.cell.r]||[])[s.cell.c]:a[gr(s.cell)];(h||{}).f=""+Hc(J[0],o,c,B,R)}}break;case"LabelSst":b=Tp(l[J.isst].t,J.ixfe,"s");if(l[J.isst].h)b.h=l[J.isst].h;b.XF=S[b.ixfe];if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:J.c,r:J.r},b,t);break;case"Blank":if(t.sheetStubs){b={ixfe:J.ixfe,XF:S[J.ixfe],t:"z"};if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:J.c,r:J.r},b,t)}break;case"MulBlank":if(t.sheetStubs){for(var ue=J.c;ue<=J.C;++ue){var fe=J.ixfe[ue-J.c];b={ixfe:fe,XF:S[fe],t:"z"};if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:ue,r:J.r},b,t)}}break;case"RString":;case"Label":;case"BIFF2STR":b=Tp(J.val,J.ixfe,"s");b.XF=S[b.ixfe];if(W>0)b.z=U[b.ixfe>>8&31];kp(b,t,r.opts.Date1904);D({c:J.c,r:J.r},b,t);break;case"Dimensions":{if($===1)o=J}break;case"SST":{l=J}break;case"Format":{if(R.biff==4){U[W++]=J[1];for(var ce=0;ce<W+163;++ce)if(me._table[ce]==J[1])break;if(ce>=163)me.load(J[1],W+163)}else me.load(J[1],J[0])}break;case"BIFF2FORMAT":{U[W++]=J;for(var de=0;de<W+163;++de)if(me._table[de]==J)break;if(de>=163)me.load(J,W+163)}break;case"MergeCells":O=O.concat(J);break;case"Obj":A[J.cmo[0]]=R.lastobj=J;break;case"TxO":R.lastobj.TxO=J;break;case"ImData":R.lastobj.ImData=J;break;case"HLink":{for(g=J[0].s.r;g<=J[0].e.r;++g)for(p=J[0].s.c;p<=J[0].e.c;++p){h=t.dense?(a[g]||[])[p]:a[gr({c:p,r:g})];if(h)h.l=J[1]}}break;case"HLinkTooltip":{for(g=J[0].s.r;g<=J[0].e.r;++g)for(p=J[0].s.c;p<=J[0].e.c;++p){h=t.dense?(a[g]||[])[p]:a[gr({c:p,r:g})];if(h&&h.l)h.l.Tooltip=J[1]}}break;case"Note":{if(R.biff<=5&&R.biff>=2)break;h=t.dense?(a[J[0].r]||[])[J[0].c]:a[gr(J[0])];var he=A[J[2]];if(!h){if(t.dense){if(!a[J[0].r])a[J[0].r]=[];h=a[J[0].r][J[0].c]={t:"z"}}else{h=a[gr(J[0])]={t:"z"}}o.e.r=Math.max(o.e.r,J[0].r);o.s.r=Math.min(o.s.r,J[0].r);o.e.c=Math.max(o.e.c,J[0].c);o.s.c=Math.min(o.s.c,J[0].c)}if(!h.c)h.c=[];v={a:J[1],t:he.TxO.t};h.c.push(v)}break;default:switch(X.n){case"ClrtClient":break;case"XFExt":Ru(S[J.ixfe],J.ext);break;case"DefColWidth":L=J;break;case"DefaultRowHeight":P=J[1];break;case"ColInfo":{if(!R.cellStyles)break;while(J.e>=J.s){N[J.e--]={width:J.w/256};if(!F){F=true;bl(J.w/256)}wl(N[J.e+1])}}break;case"Row":{var ve={};if(J.level!=null){M[J.r]=ve;ve.level=J.level}if(J.hidden){M[J.r]=ve;ve.hidden=true}if(J.hpt){M[J.r]=ve;ve.hpt=J.hpt;ve.hpx=kl(J.hpt)}}break;case"LeftMargin":;case"RightMargin":;case"TopMargin":;case"BottomMargin":if(!a["!margins"])dd(a["!margins"]={});a["!margins"][Q.slice(0,-6).toLowerCase()]=J;break;case"Setup":if(!a["!margins"])dd(a["!margins"]={});a["!margins"].header=J.header;a["!margins"].footer=J.footer;break;case"Window2":if(J.RTL)k.Views[0].RTL=true;break;case"Header":break;case"Footer":break;case"HCenter":break;case"VCenter":break;case"Pls":break;case"GCW":break;case"LHRecord":break;case"DBCell":break;case"EntExU2":break;case"SxView":break;case"Sxvd":break;case"SXVI":break;case"SXVDEx":break;case"SxIvd":break;case"SXString":break;case"Sync":break;case"Addin":break;case"SXDI":break;case"SXLI":break;case"SXEx":break;case"QsiSXTag":break;case"Selection":break;case"Feat":break;case"FeatHdr":;case"FeatHdr11":break;case"Feature11":;case"Feature12":;case"List12":break;case"Country":w=J;break;case"RecalcId":break;case"DxGCol":break;case"Fbi":;case"Fbi2":;case"GelFrame":break;case"Font":break;case"XFCRC":break;case"Style":break;case"StyleExt":break;case"Palette":E=J;break;case"Theme":I=J;break;case"ScenarioProtect":break;case"ObjProtect":break;case"CondFmt12":break;case"Table":break;case"TableStyles":break;case"TableStyle":break;case"TableStyleElement":break;case"SXStreamID":break;case"SXVS":break;case"DConRef":break;case"SXAddl":break;case"DConBin":break;case"DConName":break;case"SXPI":break;case"SxFormat":break;case"SxSelect":break;case"SxRule":break;case"SxFilt":break;case"SxItm":break;case"SxDXF":break;case"ScenMan":break;case"DCon":break;case"CellWatch":break;case"PrintRowCol":break;case"PrintGrid":break;case"PrintSize":break;case"XCT":break;case"CRN":break;case"Scl":{}break;case"SheetExt":{}break;case"SheetExtOptional":{}break;case"ObNoMacros":{}break;case"ObProj":{}break;case"CodeName":{if(!u)k.WBProps.CodeName=J||"ThisWorkbook";else T.CodeName=J||T.name}break;case"GUIDTypeLib":{}break;case"WOpt":break;case"PhoneticInfo":break;case"OleObjectSize":break;case"DXF":;case"DXFN":;case"DXFN12":;case"DXFN12List":;case"DXFN12NoCB":break;case"Dv":;case"DVal":break;case"BRAI":;case"Series":;case"SeriesText":break;case"DConn":break;case"DbOrParamQry":break;case"DBQueryExt":break;case"OleDbConn":break;case"ExtString":break;case"IFmtRecord":break;case"CondFmt":;case"CF":;case"CF12":;case"CFEx":break;case"Excel9File":break;case"Units":break;case"InterfaceHdr":;case"Mms":;case"InterfaceEnd":;case"DSF":break;case"BuiltInFnGroupCount":break;case"Window1":;case"HideObj":;case"GridSet":;case"Guts":;case"UserBView":;case"UserSViewBegin":;case"UserSViewEnd":break;case"Pane":break;default:switch(X.n){case"Dat":;case"Begin":;case"End":;case"StartBlock":;case"EndBlock":;case"Frame":;case"Area":;case"Axis":;case"AxisLine":;case"Tick":break;case"AxesUsed":;case"CrtLayout12":;case"CrtLayout12A":;case"CrtLink":;case"CrtLine":;case"CrtMlFrt":;case"CrtMlFrtContinue":break;case"LineFormat":;case"AreaFormat":;case"Chart":;case"Chart3d":;case"Chart3DBarShape":;case"ChartFormat":;case"ChartFrtInfo":break;case"PlotArea":;case"PlotGrowth":break;case"SeriesList":;case"SerParent":;case"SerAuxTrend":break;case"DataFormat":;case"SerToCrt":;case"FontX":break;case"CatSerRange":;case"AxcExt":;case"SerFmt":break;case"ShtProps":break;case"DefaultText":;case"Text":;case"CatLab":break;case"DataLabExtContents":break;case"Legend":;case"LegendException":break;case"Pie":;case"Scatter":break;case"PieFormat":;case"MarkerFormat":break;case"StartObject":;case"EndObject":break;case"AlRuns":;case"ObjectLink":break;case"SIIndex":break;case"AttachedLabel":;case"YMult":break;case"Line":;case"Bar":break;case"Surf":break;case"AxisParent":break;case"Pos":break;case"ValueRange":break;case"SXViewEx9":break;case"SXViewLink":break;case"PivotChartBits":break;case"SBaseRef":break;case"TextPropsStream":break;case"LnExt":break;case"MkrExt":break;case"CrtCoopt":break;case"Qsi":;case"Qsif":;case"Qsir":;case"QsiSXTag":break;case"TxtQry":break;case"FilterMode":break;case"AutoFilter":;case"AutoFilterInfo":break;case"AutoFilter12":break;case"DropDownObjIds":break;case"Sort":break;case"SortData":break;case"ShapePropsStream":break;case"MsoDrawing":;case"MsoDrawingGroup":;case"MsoDrawingSelection":break;case"WebPub":;case"AutoWebPub":break;case"HeaderFooter":;case"HFPicture":;case"PLV":;case"HorizontalPageBreaks":;case"VerticalPageBreaks":break;case"Backup":;case"CompressPictures":;case"Compat12":break;case"Continue":;case"ContinueFrt12":break;case"FrtFontList":;case"FrtWrapper":break;default:switch(X.n){case"TabIdConf":;case"Radar":;case"RadarArea":;case"DropBar":;case"Intl":;case"CoordList":;case"SerAuxErrBar":break;case"BIFF2FONTCLR":;case"BIFF2FMTCNT":;case"BIFF2FONTXTRA":break;case"BIFF2XF":;case"BIFF3XF":;case"BIFF4XF":break;case"BIFF4FMTCNT":;case"BIFF2ROW":;case"BIFF2WINDOW2":break;case"SCENARIO":;case"DConBin":;case"PicF":;case"DataLabExt":;case"Lel":;case"BopPop":;case"BopPopCustom":;case"RealTimeData":;case"Name":break;case"LHNGraph":;case"FnGroupName":;case"AddMenu":;case"LPr":break;case"ListObj":;case"ListField":break;case"RRSort":break;case"BigName":break;case"ToolbarHdr":;case"ToolbarEnd":break;case"DDEObjName":break;case"FRTArchId$":break;default:if(t.WTF)throw"Unrecognized Record "+X.n}}}}}else e.l+=G}r.SheetNames=ye(i).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return i[e].name});if(!t.bookSheets)r.Sheets=n;if(r.Sheets)j.forEach(function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e});r.Preamble=f;r.Strings=l;r.SSF=me.get_table();if(R.enc)r.Encryption=R.enc;if(I)r.Themes=I;r.Metadata={};if(w!==undefined)r.Metadata.Country=w;if(B.names.length>0)k.Names=B.names;r.Workbook=k;return r}var xp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Dp(e,t,r){var n=Me.find(e,"!DocumentSummaryInformation");if(n&&n.size>0)try{var i=$i(n,yn,xp.DSI);for(var a in i)t[a]=i[a]}catch(e){if(r.WTF)throw e}var o=Me.find(e,"!SummaryInformation");if(o&&o.size>0)try{var s=$i(o,bn,xp.SI);for(var l in s)if(t[l]==null)t[l]=s[l]}catch(e){if(r.WTF)throw e}if(t.HeadingPairs&&t.TitlesOfParts){oi(t.HeadingPairs,t.TitlesOfParts,t,r);delete t.HeadingPairs;delete t.TitlesOfParts}}function Rp(e,t){var r=[],n=[],i=[];var a=0,o;if(e.Props){o=ye(e.Props);for(a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(Cn,o[a])?r:Object.prototype.hasOwnProperty.call(Sn,o[a])?n:i).push([o[a],e.Props[o[a]]])}if(e.Custprops){o=ye(e.Custprops);for(a=0;a<o.length;++a)if(!Object.prototype.hasOwnProperty.call(e.Props||{},o[a]))(Object.prototype.hasOwnProperty.call(Cn,o[a])?r:Object.prototype.hasOwnProperty.call(Sn,o[a])?n:i).push([o[a],e.Custprops[o[a]]])}var s=[];for(a=0;a<i.length;++a){if(Fi.indexOf(i[a][0])>-1)continue;if(i[a][1]==null)continue;s.push(i[a])}if(n.length)Me.utils.cfb_add(t,"/SummaryInformation",Wi(n,xp.SI,Sn,bn));if(r.length||s.length)Me.utils.cfb_add(t,"/DocumentSummaryInformation",Wi(r,xp.DSI,Cn,yn,s.length?s:null,xp.UDI))}function Ip(e,t){if(!t)t={};kg(t);f();if(t.codepage)u(t.codepage);var r,n;if(e.FullPaths){if(Me.find(e,"/encryption"))throw new Error("File is password-protected");r=Me.find(e,"!CompObj");n=Me.find(e,"/Workbook")||Me.find(e,"/Book")}else{switch(t.type){case"base64":e=Re(Te.decode(e));break;case"binary":e=Re(e);break;case"buffer":break;case"array":if(!Array.isArray(e))e=Array.prototype.slice.call(e);break}Gt(e,0);n={content:e}}var i;var a;if(r)Sp(r);if(t.bookProps&&!t.bookSheets)i={};else{var o=_e?"buffer":"array";if(n&&n.content)i=_p(n.content,t);else if((a=Me.find(e,"PerfectOffice_MAIN"))&&a.content)i=ms.to_workbook(a.content,(t.type=o,t));else if((a=Me.find(e,"NativeContent_MAIN"))&&a.content)i=ms.to_workbook(a.content,(t.type=o,t));else throw new Error("Cannot find Workbook stream");if(t.bookVBA&&e.FullPaths&&Me.find(e,"/_VBA_PROJECT_CUR/VBA/dir"))i.vbaraw=Xu(e)}var s={};if(e.FullPaths)Dp(e,s,t);i.Props=i.Custprops=s;if(t.bookFiles)i.cfb=e;return i}function Op(e,t){var r=t||{};var n=Me.utils.cfb_new({root:"R"});var i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":if(!r.bookType)r.bookType="xla";case"biff8":i="/Workbook";r.biff=8;break;case"biff5":i="/Book";r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}Me.utils.cfb_add(n,i,Zp(e,r));if(r.biff==8&&(e.Props||e.Custprops))Rp(e,n);if(r.biff==8&&e.vbaraw)Ku(n,Me.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"}));return n}var Ap={0:{n:"BrtRowHdr",f:Gd},1:{n:"BrtCellBlank",f:rh},2:{n:"BrtCellRk",f:ch},3:{n:"BrtCellError",f:oh},4:{n:"BrtCellBool",f:ih},5:{n:"BrtCellReal",f:uh},6:{n:"BrtCellSt",f:hh},7:{n:"BrtCellIsst",f:sh},8:{n:"BrtFmlaString",f:yh},9:{n:"BrtFmlaNum",f:mh},10:{n:"BrtFmlaBool",f:ph},11:{n:"BrtFmlaError",f:gh},16:{n:"BrtFRTArchID$",f:kv},19:{n:"BrtSSTItem",f:Ir},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:Tv},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:$l},44:{n:"BrtFmt",f:Bl},45:{n:"BrtFill",f:Vl},46:{n:"BrtBorder",f:Xl},47:{n:"BrtXF",f:ql},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:Xo},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:Ou},64:{n:"BrtDVal",f:Lh},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:Xt,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:Oh},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:eh},148:{n:"BrtWsDim",f:Jd,p:16},151:{n:"BrtPane",f:kh},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:Sv},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:wv},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:Os},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:Yr},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:bh},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:Wr},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:_o},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:Th},427:{n:"BrtShrFmla",f:_h},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:Rh},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:Zd},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:Sh},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:Wr},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:Vu},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:Uu},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:Ar},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:tv},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},681:{n:"BrtDValList"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14",f:Ph},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}};var Np=R(Ap,"n");var Mp={3:{n:"BIFF2NUM",f:is},4:{n:"BIFF2STR",f:ns},6:{n:"Formula",f:qc},9:{n:"BOF",f:Oa},10:{n:"EOF",f:Ui},12:{n:"CalcCount",f:Yi},13:{n:"CalcMode",f:Yi},14:{n:"CalcPrecision",f:zi},15:{n:"CalcRefMode",f:zi},16:{n:"CalcDelta",f:Xr},17:{n:"CalcIter",f:zi},18:{n:"Protect",f:zi},19:{n:"Password",f:Yi},20:{n:"Header",f:Co},21:{n:"Footer",f:Co},23:{n:"ExternSheet",f:_o},24:{n:"Lbl",f:To},25:{n:"WinProtect",f:zi},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:No},29:{n:"Selection"},34:{n:"Date1904",f:zi},35:{n:"ExternName",f:Eo},36:{n:"COLWIDTH"},38:{n:"LeftMargin",f:Xr},39:{n:"RightMargin",f:Xr},40:{n:"TopMargin",f:Xr},41:{n:"BottomMargin",f:Xr},42:{n:"PrintRowCol",f:zi},43:{n:"PrintGrid",f:zi},47:{n:"FilePass",f:il},49:{n:"Font",f:Ja},51:{n:"PrintSize",f:Yi},60:{n:"Continue"},61:{n:"Window1",f:qa},64:{n:"Backup",f:zi},65:{n:"Pane",f:Ka},66:{n:"CodePage",f:Yi},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:Yi},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:Ma},93:{n:"Obj",f:Po},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:zi},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:zi},125:{n:"ColInfo",f:Xo},128:{n:"Guts",f:po},129:{n:"WsBool",f:Pa},130:{n:"GridSet",f:Yi},131:{n:"HCenter",f:zi},132:{n:"VCenter",f:zi},133:{n:"BoundSheet8",f:Fa},134:{n:"WriteProtect"},140:{n:"Country",f:Vo},141:{n:"HideObj",f:Yi},144:{n:"Sort"},146:{n:"Palette",f:Yo},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:Yi},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:es},161:{n:"Setup",f:Ko},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:uo},190:{n:"MulBlank",f:fo},193:{n:"Mms",f:Ui},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:zi},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:Yi},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:zi},222:{n:"OleObjectSize"},224:{n:"XF",f:ho},225:{n:"InterfaceHdr",f:Na},226:{n:"InterfaceEnd",f:Ui},227:{n:"SXVS"},229:{n:"MergeCells",f:Mo},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:Ha},253:{n:"LabelSst",f:Za},255:{n:"ExtSST",f:Wa},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:Xi},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:zi},353:{n:"DSF",f:Ui},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:So},431:{n:"Prot4Rev",f:zi},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:Ho},439:{n:"RefreshAll",f:zi},440:{n:"HLink",f:$o},441:{n:"Lel"},442:{n:"CodeName",f:ra},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:Yi},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:Ui},449:{n:"RecalcId",f:Va,r:2},450:{n:"EntExU2",f:Ui},512:{n:"Dimensions",f:oo},513:{n:"Blank",f:Zo},515:{n:"Number",f:bo},516:{n:"Label",f:to},517:{n:"BoolErr",f:mo},518:{n:"Formula",f:qc},519:{n:"String",f:ts},520:{n:"Row",f:Ua},523:{n:"Index"},545:{n:"Array",f:Io},549:{n:"DefaultRowHeight",f:za},566:{n:"Table"},574:{n:"Window2",f:Ga},638:{n:"RK",f:lo},659:{n:"Style"},1030:{n:"Formula",f:qc},1048:{n:"BigName"},1054:{n:"Format",f:no},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:Ro},2048:{n:"HLinkTooltip",f:Uo},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:Oa},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:Ui},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:Go,r:12},2173:{n:"XFExt",f:Du,r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:zi,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:Do,r:12},2197:{n:"SortData"},2198:{n:"Theme",f:Su,r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:Oo,r:12},2203:{n:"CompressPictures",f:Ui},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:ja},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:Yi},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:Jo},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:qo},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:oo},2:{n:"BIFF2INT",f:os},5:{n:"BoolErr",f:mo},7:{n:"String",f:ls},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:Yi},30:{n:"BIFF2FORMAT",f:ao},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:Io},37:{n:"DefaultRowHeight",f:za},50:{n:"BIFF2FONTXTRA",f:us},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:rs},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:fs},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:Oa},536:{n:"Lbl",f:To},547:{n:"ExternName",f:Eo},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:Oa},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}};var Lp=R(Mp,"n");function Pp(e,t,r,n){var i=+t||+Lp[t];if(isNaN(i))return;var a=n||(r||[]).length||0;var o=e.next(4);o._W(2,i);o._W(2,a);if(a>0&&Lt(r))e.push(r)}function Fp(e,t,r,n){var i=n||(r||[]).length||0;if(i<=8224)return Pp(e,t,r,i);var a=+t||+Lp[t];if(isNaN(a))return;var o=r.parts||[],s=0;var l=0,u=0;while(u+(o[s]||8224)<=8224){u+=o[s]||8224;s++}var f=e.next(4);f._W(2,a);f._W(2,u);e.push(r.slice(l,l+u));l+=u;while(l<i){f=e.next(4);f._W(2,60);u=0;while(u+(o[s]||8224)<=8224){u+=o[s]||8224;s++}f._W(2,u);e.push(r.slice(l,l+u));l+=u}}function Bp(e,t,r){if(!e)e=Kt(7);e._W(2,t);e._W(2,r);e._W(2,0);e._W(1,0);return e}function Hp(e,t,r,n){var i=Kt(9);Bp(i,e,t);if(n=="e"){i._W(1,r);i._W(1,1)}else{i._W(1,r?1:0);i._W(1,0)}return i}function $p(e,t,r){var n=Kt(8+2*r.length);Bp(n,e,t);n._W(1,r.length);n._W(r.length,r,"sbcs");return n.l<n.length?n.slice(0,n.l):n}function Wp(e,t,r,n){if(t.v!=null)switch(t.t){case"d":;case"n":var i=t.t=="d"?Z(ae(t.v)):t.v;if(i==(i|0)&&i>=0&&i<65536)Pp(e,2,ss(r,n,i));else Pp(e,3,as(r,n,i));return;case"b":;case"e":Pp(e,5,Hp(r,n,t.v,t.t));return;case"s":;case"str":Pp(e,4,$p(r,n,t.v));return}Pp(e,1,Bp(null,r,n))}function Up(e,t,r,n){var i=Array.isArray(t);var a=br(t["!ref"]||"A1"),o,s="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255);a.e.r=Math.min(a.e.c,16383);o=yr(a)}for(var u=a.s.r;u<=a.e.r;++u){s=sr(u);for(var f=a.s.c;f<=a.e.c;++f){if(u===a.s.r)l[f]=cr(f);o=l[f]+s;var c=i?(t[u]||[])[f]:t[o];if(!c)continue;Wp(e,c,u,f,n)}}}function jp(e,t){var r=t||{};if(ge!=null&&r.dense==null)r.dense=ge;var n=Qt();var i=0;for(var a=0;a<e.SheetNames.length;++a)if(e.SheetNames[a]==r.sheet)i=a;if(i==0&&!!r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);Pp(n,9,Aa(e,16,r));Up(n,e.Sheets[e.SheetNames[i]],i,r,e);Pp(n,10);return n.end()}function Vp(e,t,r){Pp(e,"Font",Qa({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function zp(r,n,i){if(!n)return;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)if(n[t]!=null)Pp(r,"Format",io(t,n[t],i))})}function qp(e,t){var r=Kt(19);r._W(4,2151);r._W(4,0);r._W(4,0);r._W(2,3);r._W(1,1);r._W(4,0);Pp(e,"FeatHdr",r);r=Kt(39);r._W(4,2152);r._W(4,0);r._W(4,0);r._W(2,3);r._W(1,0);r._W(4,0);r._W(2,1);r._W(4,4);r._W(2,0);Sa(br(t["!ref"]||"A1"),r);r._W(4,4);Pp(e,"Feat",r)}function Yp(t,r){for(var e=0;e<16;++e)Pp(t,"XF",vo({numFmtId:0,style:true},0,r));r.cellXfs.forEach(function(e){Pp(t,"XF",vo(e,0,r))})}function Gp(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Pp(e,"HLink",Wo(n));if(n[1].Tooltip)Pp(e,"HLinkTooltip",jo(n))}delete t["!links"]}function Xp(e,t,r,n,i){var a=16+hd(i.cellXfs,t,i);if(t.v==null&&!t.bf){Pp(e,"Blank",pa(r,n,a));return}if(t.bf)Pp(e,"Formula",Yc(t,r,n,i,a));else switch(t.t){case"d":;case"n":var o=t.t=="d"?Z(ae(t.v)):t.v;Pp(e,"Number",wo(r,n,o,a,i));break;case"b":;case"e":Pp(e,517,yo(r,n,t.v,a,i,t.t));break;case"s":;case"str":if(i.bookSST){var s=fd(i.Strings,t.v,i.revStrings);Pp(e,"LabelSst",eo(r,n,s,a,i))}else Pp(e,"Label",ro(r,n,t.v,a,i));break;default:Pp(e,"Blank",pa(r,n,a))}}function Kp(e,t,r){var n=Qt();var i=r.SheetNames[e],a=r.Sheets[i]||{};var o=(r||{}).Workbook||{};var s=(o.Sheets||[])[e]||{};var l=Array.isArray(a);var u=t.biff==8;var f,c="",d=[];var h=br(a["!ref"]||"A1");var v=u?65536:16384;if(h.e.c>255||h.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255);h.e.r=Math.min(h.e.c,v-1)}Pp(n,2057,Aa(r,16,t));Pp(n,"CalcMode",Gi(1));Pp(n,"CalcCount",Gi(100));Pp(n,"CalcRefMode",qi(true));Pp(n,"CalcIter",qi(false));Pp(n,"CalcDelta",Kr(.001));Pp(n,"CalcSaveRecalc",qi(true));Pp(n,"PrintRowCol",qi(false));Pp(n,"PrintGrid",qi(false));Pp(n,"GridSet",Gi(1));Pp(n,"Guts",go([0,0]));Pp(n,"HCenter",qi(false));Pp(n,"VCenter",qi(false));Pp(n,512,so(h,t));if(u)a["!links"]=[];for(var p=h.s.r;p<=h.e.r;++p){c=sr(p);for(var g=h.s.c;g<=h.e.c;++g){if(p===h.s.r)d[g]=cr(g);f=d[g]+c;var m=l?(a[p]||[])[g]:a[f];if(!m)continue;Xp(n,m,p,g,t);if(u&&m.l)a["!links"].push([f,m.l])}}var y=s.CodeName||s.name||i;if(u)Pp(n,"Window2",Xa((o.Views||[])[0]));if(u&&(a["!merges"]||[]).length)Pp(n,"MergeCells",Lo(a["!merges"]));if(u)Gp(n,a);Pp(n,"CodeName",ia(y,t));if(u)qp(n,a);Pp(n,"EOF");return n.end()}function Jp(e,t,r){var n=Qt();var i=(e||{}).Workbook||{};var a=i.Sheets||[];var o=i.WBProps||{};var s=r.biff==8,l=r.biff==5;Pp(n,2057,Aa(e,5,r));if(r.bookType=="xla")Pp(n,"Addin");Pp(n,"InterfaceHdr",s?Gi(1200):null);Pp(n,"Mms",ji(2));if(l)Pp(n,"ToolbarHdr");if(l)Pp(n,"ToolbarEnd");Pp(n,"InterfaceEnd");Pp(n,"WriteAccess",La("SheetJS",r));Pp(n,"CodePage",Gi(s?1200:1252));if(s)Pp(n,"DSF",Gi(0));if(s)Pp(n,"Excel9File");Pp(n,"RRTabId",Qo(e.SheetNames.length));if(s&&e.vbaraw)Pp(n,"ObProj");if(s&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Pp(n,"CodeName",ia(u,r))}Pp(n,"BuiltInFnGroupCount",Gi(17));Pp(n,"WinProtect",qi(false));Pp(n,"Protect",qi(false));Pp(n,"Password",Gi(0));if(s)Pp(n,"Prot4Rev",qi(false));if(s)Pp(n,"Prot4RevPass",Gi(0));Pp(n,"Window1",Ya(r));Pp(n,"Backup",qi(false));Pp(n,"HideObj",Gi(0));Pp(n,"Date1904",qi(cv(e)=="true"));Pp(n,"CalcPrecision",qi(true));if(s)Pp(n,"RefreshAll",qi(false));Pp(n,"BookBool",Gi(0));Vp(n,e,r);zp(n,e.SSF,r);Yp(n,r);if(s)Pp(n,"UsesELFs",qi(false));var f=n.end();var c=Qt();if(s)Pp(c,"Country",zo());if(s&&r.Strings)Fp(c,"SST",$a(r.Strings,r));Pp(c,"EOF");var d=c.end();var h=Qt();var v=0,p=0;for(p=0;p<e.SheetNames.length;++p)v+=(s?12:11)+(s?2:1)*e.SheetNames[p].length;var g=f.length+v+d.length;for(p=0;p<e.SheetNames.length;++p){var m=a[p]||{};Pp(h,"BoundSheet8",Ba({pos:g,hs:m.Hidden||0,dt:0,name:e.SheetNames[p]},r));g+=t[p].length}var y=h.end();if(v!=y.length)throw new Error("BS8 "+v+" != "+y.length);var b=[];if(f.length)b.push(f);if(y.length)b.push(y);if(d.length)b.push(d);return pt([b])}function Qp(e,t){var r=t||{};var n=[];if(e&&!e.SSF){e.SSF=me.get_table()}if(e&&e.SSF){re(me);me.load_table(e.SSF);r.revssf=O(e.SSF);r.revssf[e.SSF[65535]]=0;r.ssf=e.SSF}r.Strings=[];r.Strings.Count=0;r.Strings.Unique=0;Tg(r);r.cellXfs=[];hd(r.cellXfs,{},{revssf:{General:0}});if(!e.Props)e.Props={};for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Kp(i,r,e);n.unshift(Jp(e,n,r));return pt([n])}function Zp(e,t){var r=t||{};switch(r.biff||2){case 8:;case 5:return Qp(e,t);case 4:;case 3:;case 2:return jp(e,t)}throw new Error("invalid type "+r.bookType+" for BIFF")}var eg=function(){function r(e,t){var r=t||{};if(ge!=null&&r.dense==null)r.dense=ge;var n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i);var o=i.index,s=a&&a.index||e.length;var l=z(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>");var u=-1,f=0,c=0,d=0;var h={s:{r:1e7,c:1e7},e:{r:0,c:0}};var v=[];for(o=0;o<l.length;++o){var p=l[o].trim();var g=p.slice(0,3).toLowerCase();if(g=="<tr"){++u;if(r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(g!="<td"&&g!="<th")continue;var m=p.split(/<\/t[dh]>/i);for(s=0;s<m.length;++s){var y=m[s].trim();if(!y.match(/<t[dh]/i))continue;var b=y,w=0;while(b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1)b=b.slice(w+1);for(var C=0;C<v.length;++C){var S=v[C];if(S.s.c==f&&S.s.r<u&&u<=S.e.r){f=S.e.c+1;C=-1}}var E=Ee(y.slice(0,y.indexOf(">")));d=E.colspan?+E.colspan:1;if((c=+E.rowspan)>1||d>1)v.push({s:{r:u,c:f},e:{r:u+(c||1)-1,c:f+d-1}});var k=E.t||"";if(!b.length){f+=d;continue}b=et(b);if(h.s.r>u)h.s.r=u;if(h.e.r<u)h.e.r=u;if(h.s.c>f)h.s.c=f;if(h.e.c<f)h.e.c=f;if(!b.length)continue;var T={t:"s",v:b};if(r.raw||!b.trim().length||k=="s"){}else if(b==="TRUE")T={t:"b",v:true};else if(b==="FALSE")T={t:"b",v:false};else if(!isNaN(U(b)))T={t:"n",v:U(b)};else if(!isNaN(j(b).getDate())){T={t:"d",v:ae(b)};if(!r.cellDates)T={t:"n",v:Z(T.v)};T.z=r.dateNF||me._table[14]}if(r.dense){if(!n[u])n[u]=[];n[u][f]=T}else n[gr({r:u,c:f})]=T;f+=d}}n["!ref"]=yr(h);if(v.length)n["!merges"]=v;return n}function e(e,t){return Sr(r(e,t),t)}function l(e,t,r,n){var i=e["!merges"]||[];var a=[];for(var o=t.s.c;o<=t.e.c;++o){var s=0,l=0;for(var u=0;u<i.length;++u){if(i[u].s.r>r||i[u].s.c>o)continue;if(i[u].e.r<r||i[u].e.c<o)continue;if(i[u].s.r<r||i[u].s.c<o){s=-1;break}s=i[u].e.r-i[u].s.r+1;l=i[u].e.c-i[u].s.c+1;break}if(s<0)continue;var f=gr({r:r,c:o});var c=n.dense?(e[r]||[])[o]:e[f];var d=c&&c.v!=null&&(c.h||je(c.w||(Cr(c),c.w)||""))||"";var h={};if(s>1)h.rowspan=s;if(l>1)h.colspan=l;h.t=c&&c.t||"z";if(n.editable)d='<span contenteditable="true">'+d+"</span>";h.id=(n.id||"sjs")+"-"+f;if(h.t!="z"){h.v=c.v;if(c.z!=null)h.z=c.z}a.push(lt("td",d,h))}var v="<tr>";return v+a.join("")+"</tr>"}function u(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}var f='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>';var c="</body></html>";function t(e,t){var r=t||{};var n=r.header!=null?r.header:f;var i=r.footer!=null?r.footer:c;var a=[n];var o=mr(e["!ref"]);r.dense=Array.isArray(e);a.push(u(e,o,r));for(var s=o.s.r;s<=o.e.r;++s)a.push(l(e,o,s,r));a.push("</table>"+i);return a.join("")}return{to_workbook:e,to_sheet:r,_row:l,BEGIN:f,END:c,_preamble:u,from_sheet:t}}();function tg(e,t,r){var n=r||{};if(ge!=null)n.dense=ge;var i=0,a=0;if(n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?pr(n.origin):n.origin;i=o.r;a=o.c}}var s=t.getElementsByTagName("tr");var l=Math.min(n.sheetRows||1e7,s.length);var u={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var f=mr(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r);u.s.c=Math.min(u.s.c,f.s.c);u.e.r=Math.max(u.e.r,f.e.r);u.e.c=Math.max(u.e.c,f.e.c);if(i==-1)u.e.r=i=f.e.r+1}var c=[],d=0;var h=e["!rows"]||(e["!rows"]=[]);var v=0,p=0,g=0,m=0,y=0,b=0;if(!e["!cols"])e["!cols"]=[];for(;v<s.length&&p<l;++v){var w=s[v];if(ig(w)){if(n.display)continue;h[p]={hidden:true}}var C=w.children;for(g=m=0;g<C.length;++g){var S=C[g];if(n.display&&ig(S))continue;var E=S.hasAttribute("v")?S.getAttribute("v"):et(S.innerHTML);var k=S.getAttribute("z");for(d=0;d<c.length;++d){var T=c[d];if(T.s.c==m+a&&T.s.r<p+i&&p+i<=T.e.r){m=T.e.c+1-a;d=-1}}b=+S.getAttribute("colspan")||1;if((y=+S.getAttribute("rowspan")||1)>1||b>1)c.push({s:{r:p+i,c:m+a},e:{r:p+i+(y||1)-1,c:m+a+(b||1)-1}});var _={t:"s",v:E};var x=S.getAttribute("t")||"";if(E!=null){if(E.length==0)_.t=x||"z";else if(n.raw||E.trim().length==0||x=="s"){}else if(E==="TRUE")_={t:"b",v:true};else if(E==="FALSE")_={t:"b",v:false};else if(!isNaN(U(E)))_={t:"n",v:U(E)};else if(!isNaN(j(E).getDate())){_={t:"d",v:ae(E)};if(!n.cellDates)_={t:"n",v:Z(_.v)};_.z=n.dateNF||me._table[14]}}if(_.z===undefined&&k!=null)_.z=k;if(n.dense){if(!e[p+i])e[p+i]=[];e[p+i][m+a]=_}else e[gr({c:m+a,r:p+i})]=_;if(u.e.c<m+a)u.e.c=m+a;m+=b}++p}if(c.length)e["!merges"]=(e["!merges"]||[]).concat(c);u.e.r=Math.max(u.e.r,p-1+i);e["!ref"]=yr(u);if(p>=l)e["!fullref"]=yr((u.e.r=s.length-v+p-1+i,u));return e}function rg(e,t){var r=t||{};var n=r.dense?[]:{};return tg(n,e,t)}function ng(e,t){return Sr(rg(e,t),t)}function ig(e){var t="";var r=ag(e);if(r)t=r(e).getPropertyValue("display");if(!t)t=e.style.display;return t==="none"}function ag(e){if(e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle==="function")return e.ownerDocument.defaultView.getComputedStyle;if(typeof getComputedStyle==="function")return getComputedStyle;return null}var og=function(){var J=function(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");var r=Fe(t.replace(/<[^>]*>/g,""));return[r]};var Q={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};return function e(t,r){var n=r||{};if(ge!=null&&n.dense==null)n.dense=ge;var i=ap(t);var a=[],o;var s;var l={name:""},u="",f=0;var c;var d;var h={},v=[];var p=n.dense?[]:{};var g,m;var y={value:""};var b="",w=0,C;var S=[];var E=-1,k=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}};var _=0;var x={};var D=[],R={},I=0,O=0;var A=[],N=1,M=1;var L=[];var P={Names:[]};var F={};var B=["",""];var H=[],$={};var W="",U=0;var j=false,V=false;var z=0;op.lastIndex=0;i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");while(g=op.exec(i))switch(g[3]=g[3].replace(/_.*$/,"")){case"table":;case"å·¥ä½è¡¨":if(g[1]==="/"){if(T.e.c>=T.s.c&&T.e.r>=T.s.r)p["!ref"]=yr(T);else p["!ref"]="A1:A1";if(n.sheetRows>0&&n.sheetRows<=T.e.r){p["!fullref"]=p["!ref"];T.e.r=n.sheetRows-1;p["!ref"]=yr(T)}if(D.length)p["!merges"]=D;if(A.length)p["!rows"]=A;c.name=c["åç§°"]||c.name;if(typeof JSON!=="undefined")JSON.stringify(c);v.push(c.name);h[c.name]=p;V=false}else if(g[0].charAt(g[0].length-2)!=="/"){c=Ee(g[0],false);E=k=-1;T.s.r=T.s.c=1e7;T.e.r=T.e.c=0;p=n.dense?[]:{};D=[];A=[];V=true}break;case"table-row-group":if(g[1]==="/")--_;else++_;break;case"table-row":;case"è¡":if(g[1]==="/"){E+=N;N=1;break}d=Ee(g[0],false);if(d["è¡å·"])E=d["è¡å·"]-1;else if(E==-1)E=0;N=+d["number-rows-repeated"]||1;if(N<10)for(z=0;z<N;++z)if(_>0)A[E+z]={level:_};k=-1;break;case"covered-table-cell":if(g[1]!=="/")++k;if(n.sheetStubs){if(n.dense){if(!p[E])p[E]=[];p[E][k]={t:"z"}}else p[gr({r:E,c:k})]={t:"z"}}b="";S=[];break;case"table-cell":;case"æ°æ®":if(g[0].charAt(g[0].length-2)==="/"){++k;y=Ee(g[0],false);M=parseInt(y["number-columns-repeated"]||"1",10);m={t:"z",v:null};if(y.formula&&n.cellFormula!=false)m.f=nd(Fe(y.formula));if((y["æ°æ®ç±»å"]||y["value-type"])=="string"){m.t="s";m.v=Fe(y["string-value"]||"");if(n.dense){if(!p[E])p[E]=[];p[E][k]=m}else{p[gr({r:E,c:k})]=m}}k+=M-1}else if(g[1]!=="/"){++k;M=1;var q=N?E+N-1:E;if(k>T.e.c)T.e.c=k;if(k<T.s.c)T.s.c=k;if(E<T.s.r)T.s.r=E;if(q>T.e.r)T.e.r=q;y=Ee(g[0],false);H=[];$={};m={t:y["æ°æ®ç±»å"]||y["value-type"],v:null};if(n.cellFormula){if(y.formula)y.formula=Fe(y.formula);if(y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]){I=parseInt(y["number-matrix-rows-spanned"],10)||0;O=parseInt(y["number-matrix-columns-spanned"],10)||0;R={s:{r:E,c:k},e:{r:E+I-1,c:k+O-1}};m.F=yr(R);L.push([R,m.F])}if(y.formula)m.f=nd(y.formula);else for(z=0;z<L.length;++z)if(E>=L[z][0].s.r&&E<=L[z][0].e.r)if(k>=L[z][0].s.c&&k<=L[z][0].e.c)m.F=L[z][1]}if(y["number-columns-spanned"]||y["number-rows-spanned"]){I=parseInt(y["number-rows-spanned"],10)||0;O=parseInt(y["number-columns-spanned"],10)||0;R={s:{r:E,c:k},e:{r:E+I-1,c:k+O-1}};D.push(R)}if(y["number-columns-repeated"])M=parseInt(y["number-columns-repeated"],10);switch(m.t){case"boolean":m.t="b";m.v=Ye(y["boolean-value"]);break;case"float":m.t="n";m.v=parseFloat(y.value);break;case"percentage":m.t="n";m.v=parseFloat(y.value);break;case"currency":m.t="n";m.v=parseFloat(y.value);break;case"date":m.t="d";m.v=ae(y["date-value"]);if(!n.cellDates){m.t="n";m.v=Z(m.v)}m.z="m/d/yy";break;case"time":m.t="n";m.v=ie(y["time-value"])/86400;break;case"number":m.t="n";m.v=parseFloat(y["æ°æ®æ°å¼"]);break;default:if(m.t==="string"||m.t==="text"||!m.t){m.t="s";if(y["string-value"]!=null){b=Fe(y["string-value"]);S=[]}}else throw new Error("Unsupported value type "+m.t)}}else{j=false;if(m.t==="s"){m.v=b||"";if(S.length)m.R=S;j=w==0}if(F.Target)m.l=F;if(H.length>0){m.c=H;H=[]}if(b&&n.cellText!==false)m.w=b;if(j){m.t="z";delete m.v}if(!j||n.sheetStubs){if(!(n.sheetRows&&n.sheetRows<=E)){for(var Y=0;Y<N;++Y){M=parseInt(y["number-columns-repeated"]||"1",10);if(n.dense){if(!p[E+Y])p[E+Y]=[];p[E+Y][k]=Y==0?m:oe(m);while(--M>0)p[E+Y][k+M]=oe(m)}else{p[gr({r:E+Y,c:k})]=m;while(--M>0)p[gr({r:E+Y,c:k+M})]=oe(m)}if(T.e.c<=k)T.e.c=k}}}M=parseInt(y["number-columns-repeated"]||"1",10);k+=M-1;M=0;m={};b="";S=[]}F={};break;case"document":;case"document-content":;case"çµå­è¡¨æ ¼ææ¡£":;case"spreadsheet":;case"ä¸»ä½":;case"scripts":;case"styles":;case"font-face-decls":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else if(g[0].charAt(g[0].length-2)!=="/")a.push([g[3],true]);break;case"annotation":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o;$.t=b;if(S.length)$.R=S;$.a=W;H.push($)}else if(g[0].charAt(g[0].length-2)!=="/"){a.push([g[3],false])}W="";U=0;b="";w=0;S=[];break;case"creator":if(g[1]==="/"){W=i.slice(U,g.index)}else U=g.index+g[0].length;break;case"meta":;case"åæ°æ®":;case"settings":;case"config-item-set":;case"config-item-map-indexed":;case"config-item-map-entry":;case"config-item-map-named":;case"shapes":;case"frame":;case"text-box":;case"image":;case"data-pilot-tables":;case"list-style":;case"form":;case"dde-links":;case"event-listeners":;case"chart":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else if(g[0].charAt(g[0].length-2)!=="/")a.push([g[3],false]);b="";w=0;S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":;case"percentage-style":;case"date-style":;case"time-style":if(g[1]==="/"){x[l.name]=u;if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else if(g[0].charAt(g[0].length-2)!=="/"){u="";l=Ee(g[0],false);a.push([g[3],true])}break;case"script":break;case"libraries":break;case"automatic-styles":break;case"master-styles":break;case"default-style":;case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":;case"date-style":s=Ee(g[0],false);u+=Q[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":;case"month":;case"year":;case"era":;case"day-of-week":;case"week-of-year":;case"quarter":;case"hours":;case"minutes":;case"seconds":;case"am-pm":switch(a[a.length-1][0]){case"time-style":;case"date-style":s=Ee(g[0],false);u+=Q[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;else if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":;case"date-style":;case"time-style":u+=i.slice(f,g.index);break}else f=g.index+g[0].length;break;case"named-range":s=Ee(g[0],false);B=ad(s["cell-range-address"]);var G={Name:s.name,Ref:B[0]+"!"+B[1]};if(V)G.Sheet=v.length;P.Names.push(G);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":;case"çµå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":;case"ææ¬ä¸²":if(g[1]==="/"&&(!y||!y["string-value"])){var X=J(i.slice(w,g.index),C);b=(b.length>0?b+"\n":"")+X[0]}else{C=Ee(g[0],false);w=g.index+g[0].length}break;case"s":break;case"database-range":if(g[1]==="/")break;try{B=ad(Ee(g[0])["target-range-address"]);h[B[0]]["!autofilter"]={ref:B[1]}}catch(e){}break;case"date":break;case"object":break;case"title":;case"æ é¢":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":;case"sender-lastname":;case"sender-initials":;case"sender-title":;case"sender-position":;case"sender-email":;case"sender-phone-private":;case"sender-fax":;case"sender-company":;case"sender-phone-work":;case"sender-street":;case"sender-city":;case"sender-postal-code":;case"sender-country":;case"sender-state-or-province":;case"author-name":;case"author-initials":;case"chapter":;case"file-name":;case"template-name":;case"sheet-name":break;case"event-listener":break;case"initial-creator":;case"creation-date":;case"print-date":;case"generator":;case"document-statistic":;case"user-defined":;case"editing-duration":;case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":;case"source-cell-range":;case"source-service":;case"data-pilot-field":;case"data-pilot-level":;case"data-pilot-subtotals":;case"data-pilot-subtotal":;case"data-pilot-members":;case"data-pilot-member":;case"data-pilot-display-info":;case"data-pilot-sort-info":;case"data-pilot-layout-info":;case"data-pilot-field-reference":;case"data-pilot-groups":;case"data-pilot-group":;case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":;case"dde-connection-decl":;case"dde-link":;case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){F=Ee(g[0],false);if(!F.href)break;F.Target=F.href;delete F.href;if(F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1){B=ad(F.Target.slice(1));F.Target="#"+B[0]+"!"+B[1]}}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":;case"calcext:":;case"loext:":;case"ooo:":;case"chartooo:":;case"draw:":;case"style:":;case"chart:":;case"form:":;case"uof:":;case"è¡¨:":;case"å­:":break;default:if(n.WTF)throw new Error(g)}}var K={Sheets:h,SheetNames:v,Workbook:P};if(n.bookSheets)delete K.Sheets;return K}}();function sg(e,t){t=t||{};var r=!!K(e,"objectdata");if(r)qn(Q(e,"META-INF/manifest.xml"),t);var n=se(e,"content.xml");if(!n)throw new Error("Missing content.xml in "+(r?"ODS":"UOF")+" file");var i=og(r?n:Ge(n),t);if(K(e,"meta.xml"))i.Props=ei(Q(e,"meta.xml"));return i}function lg(e,t){return og(e,t)}var ug=function(){var t="<office:document-styles "+st({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>";return function e(){return ve+t}}();var fg=function(){var y=function(e){return $e(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")};var b="          <table:table-cell />\n";var w="          <table:covered-table-cell/>\n";var o=function(e,t,r){var n=[];n.push('      <table:table table:name="'+$e(t.SheetNames[r])+'" table:style-name="ta1">\n');var i=0,a=0,o=mr(e["!ref"]);var s=e["!merges"]||[],l=0;var u=Array.isArray(e);for(i=0;i<o.s.r;++i)n.push("        <table:table-row></table:table-row>\n");for(;i<=o.e.r;++i){n.push("        <table:table-row>\n");for(a=0;a<o.s.c;++a)n.push(b);for(;a<=o.e.c;++a){var f=false,c={},d="";for(l=0;l!=s.length;++l){if(s[l].s.c>a)continue;if(s[l].s.r>i)continue;if(s[l].e.c<a)continue;if(s[l].e.r<i)continue;if(s[l].s.c!=a||s[l].s.r!=i)f=true;c["table:number-columns-spanned"]=s[l].e.c-s[l].s.c+1;c["table:number-rows-spanned"]=s[l].e.r-s[l].s.r+1;break}if(f){n.push(w);continue}var h=gr({r:i,c:a}),v=u?(e[i]||[])[a]:e[h];if(v&&v.f){c["table:formula"]=$e(id(v.f));if(v.F){if(v.F.slice(0,h.length)==h){var p=mr(v.F);c["table:number-matrix-columns-spanned"]=p.e.c-p.s.c+1;c["table:number-matrix-rows-spanned"]=p.e.r-p.s.r+1}}}if(!v){n.push(b);continue}switch(v.t){case"b":d=v.v?"TRUE":"FALSE";c["office:value-type"]="boolean";c["office:boolean-value"]=v.v?"true":"false";break;case"n":d=v.w||String(v.v||0);c["office:value-type"]="float";c["office:value"]=v.v||0;break;case"s":;case"str":d=v.v==null?"":v.v;c["office:value-type"]="string";break;case"d":d=v.w||ae(v.v).toISOString();c["office:value-type"]="date";c["office:date-value"]=ae(v.v).toISOString();c["table:style-name"]="ce1";break;default:n.push(b);continue}var g=y(d);if(v.l&&v.l.Target){var m=v.l.Target;m=m.charAt(0)=="#"?"#"+od(m.slice(1)):m;g=lt("text:a",g,{"xlink:href":m})}n.push("          "+lt("table:table-cell",lt("text:p",g,{}),c)+"\n")}n.push("        </table:table-row>\n")}n.push("      </table:table>\n");return n.join("")};var s=function(e){e.push(" <office:automatic-styles>\n");e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n');e.push('   <number:month number:style="long"/>\n');e.push("   <number:text>/</number:text>\n");e.push('   <number:day number:style="long"/>\n');e.push("   <number:text>/</number:text>\n");e.push("   <number:year/>\n");e.push("  </number:date-style>\n");e.push('  <style:style style:name="ta1" style:family="table">\n');e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n');e.push("  </style:style>\n");e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n');e.push(" </office:automatic-styles>\n")};return function e(t,r){var n=[ve];var e=st({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"});var i=st({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});if(r.bookType=="fods")n.push("<office:document"+e+i+">\n");else n.push("<office:document-content"+e+">\n");s(n);n.push("  <office:body>\n");n.push("    <office:spreadsheet>\n");for(var a=0;a!=t.SheetNames.length;++a)n.push(o(t.Sheets[t.SheetNames[a]],t,a,r));n.push("    </office:spreadsheet>\n");n.push("  </office:body>\n");if(r.bookType=="fods")n.push("</office:document>");else n.push("</office:document-content>");return n.join("")}}();function cg(e,t){if(t.bookType=="fods")return fg(e,t);var r=ce();var n="";var i=[];var a=[];n="mimetype";ue(r,n,"application/vnd.oasis.opendocument.spreadsheet");n="content.xml";ue(r,n,fg(e,t));i.push([n,"text/xml"]);a.push([n,"ContentFile"]);n="styles.xml";ue(r,n,ug(e,t));i.push([n,"text/xml"]);a.push([n,"StylesFile"]);n="meta.xml";ue(r,n,Jn());i.push([n,"text/xml"]);a.push([n,"MetadataFile"]);n="manifest.rdf";ue(r,n,Kn(a));i.push([n,"application/rdf+xml"]);n="META-INF/manifest.xml";ue(r,n,Yn(i));return r}function dg(e,t){if(!t)return 0;var r=e.SheetNames.indexOf(t);if(r==-1)throw new Error("Sheet not found: "+t);return r}function hg(i){return function e(t,r){var n=dg(t,r.sheet);return i.from_sheet(t.Sheets[t.SheetNames[n]],r,t)}}var vg=hg(eg);var pg=hg({from_sheet:nm});var gg=hg(typeof ds!=="undefined"?ds:{});var mg=hg(typeof hs!=="undefined"?hs:{});var yg=hg(typeof ps!=="undefined"?ps:{});var bg=hg(typeof al!=="undefined"?al:{});var wg=hg({from_sheet:im});var Cg=hg(typeof cs!=="undefined"?cs:{});var Sg=hg(typeof vs!=="undefined"?vs:{});function Eg(i){return function e(t){for(var r=0;r!=i.length;++r){var n=i[r];if(t[n[0]]===undefined)t[n[0]]=n[1];if(n[2]==="n")t[n[0]]=Number(t[n[0]])}}}var kg=function(e){Eg([["cellNF",false],["cellHTML",true],["cellFormula",true],["cellStyles",false],["cellText",true],["cellDates",false],["sheetStubs",false],["sheetRows",0,"n"],["bookDeps",false],["bookSheets",false],["bookProps",false],["bookFiles",false],["bookVBA",false],["password",""],["WTF",false]])(e)};var Tg=Eg([["cellDates",false],["bookSST",false],["bookType","xlsx"],["compression",false],["WTF",false]]);function _g(e){if(Bn.WS.indexOf(e)>-1)return"sheet";if(Bn.CS&&e==Bn.CS)return"chart";if(Bn.DS&&e==Bn.DS)return"dialog";if(Bn.MS&&e==Bn.MS)return"macro";return e&&e.length?e:"sheet"}function xg(r,e){if(!r)return 0;try{r=e.map(function e(t){if(!t.id)t.id=t.strRelID;return[t.name,r["!id"][t.id].Target,_g(r["!id"][t.id].Type)]})}catch(e){return null}return!r||r.length===0?null:r}function Dg(r,n,e,i,t,a,o,s,l,u,f,c){try{a[i]=$n(se(r,e,true),n);var d=Q(r,n);var h;switch(s){case"sheet":h=Nv(d,n,t,l,a[i],u,f,c);break;case"chart":h=Mv(d,n,t,l,a[i],u,f,c);if(!h||!h["!drawel"])break;var v=he(h["!drawel"].Target,n);var p=Hn(v);var g=Lu(se(r,v,true),$n(se(r,p,true),v));var m=he(g,v);var y=Hn(m);h=Jh(se(r,m,true),m,l,$n(se(r,y,true),m),u,h);break;case"macro":h=Lv(d,n,t,l,a[i],u,f,c);break;case"dialog":h=Pv(d,n,t,l,a[i],u,f,c);break;default:throw new Error("Unrecognized sheet type "+s)}o[i]=h;var b=[];if(a&&a[i])ye(a[i]).forEach(function(e){if(a[i][e].Type==Bn.CMNT){var t=he(a[i][e].Target,n);b=$v(Q(r,t,true),t,l);if(!b||!b.length)return;Bu(h,b)}})}catch(e){if(l.WTF)throw e}}function Rg(e){return e.charAt(0)=="/"?e.slice(1):e}function Ig(r,n){re(me);n=n||{};kg(n);if(K(r,"META-INF/manifest.xml"))return sg(r,n);if(K(r,"objectdata.xml"))return sg(r,n);if(K(r,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var e=le(r);var t=Mn(se(r,"[Content_Types].xml"));var i=false;var a,o;if(t.workbooks.length===0){o="xl/workbook.xml";if(Q(r,o,true))t.workbooks.push(o)}if(t.workbooks.length===0){o="xl/workbook.bin";if(!Q(r,o,true))throw new Error("Could not find workbook");t.workbooks.push(o);i=true}if(t.workbooks[0].slice(-3)=="bin")i=true;var s={};var l={};if(!n.bookSheets&&!n.bookProps){sd=[];if(t.sst)try{sd=Hv(Q(r,Rg(t.sst)),t.sst,n)}catch(e){if(n.WTF)throw e}if(n.cellStyles&&t.themes.length)s=Bv(se(r,t.themes[0].replace(/^\//,""),true)||"",t.themes[0],n);if(t.style)l=Fv(Q(r,Rg(t.style)),t.style,s,n)}t.links.map(function(e){try{var t=$n(se(r,Hn(Rg(e))),e);return Uv(Q(r,Rg(e)),t,e,n)}catch(e){}});var u=Av(Q(r,Rg(t.workbooks[0])),t.workbooks[0],n);var f={},c="";if(t.coreprops.length){c=Q(r,Rg(t.coreprops[0]),true);if(c)f=ei(c);if(t.extprops.length!==0){c=Q(r,Rg(t.extprops[0]),true);if(c)si(c,f,n)}}var d={};if(!n.bookSheets||n.bookProps){if(t.custprops.length!==0){c=se(r,Rg(t.custprops[0]),true);if(c)d=ci(c,n)}}var h={};if(n.bookSheets||n.bookProps){if(u.Sheets)a=u.Sheets.map(function e(t){return t.name});else if(f.Worksheets&&f.SheetNames.length>0)a=f.SheetNames;if(n.bookProps){h.Props=f;h.Custprops=d}if(n.bookSheets&&typeof a!=="undefined")h.SheetNames=a;if(n.bookSheets?h.SheetNames:n.bookProps)return h}a={};var v={};if(n.bookDeps&&t.calcchain)v=Wv(Q(r,Rg(t.calcchain)),t.calcchain,n);var p=0;var g={};var m,y;{var b=u.Sheets;f.Worksheets=b.length;f.SheetNames=[];for(var w=0;w!=b.length;++w){f.SheetNames[w]=b[w].name}}var C=i?"bin":"xml";var S=t.workbooks[0].lastIndexOf("/");var E=(t.workbooks[0].slice(0,S+1)+"_rels/"+t.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");if(!K(r,E))E="xl/_rels/workbook."+C+".rels";var k=$n(se(r,E,true),E);if(k)k=xg(k,u.Sheets);var T=Q(r,"xl/worksheets/sheet.xml",true)?1:0;e:for(p=0;p!=f.Worksheets;++p){var _="sheet";if(k&&k[p]){m="xl/"+k[p][1].replace(/[\/]?xl\//,"");if(!K(r,m))m=k[p][1];if(!K(r,m))m=E.replace(/_rels\/.*$/,"")+k[p][1];_=k[p][2]}else{m="xl/worksheets/sheet"+(p+1-T)+"."+C;m=m.replace(/sheet0\./,"sheet.")}y=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels");if(n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(p!=n.sheets)continue e;break;case"string":if(f.SheetNames[p].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){var x=false;for(var D=0;D!=n.sheets.length;++D){if(typeof n.sheets[D]=="number"&&n.sheets[D]==p)x=1;if(typeof n.sheets[D]=="string"&&n.sheets[D].toLowerCase()==f.SheetNames[p].toLowerCase())x=1}if(!x)continue e}}Dg(r,m,y,f.SheetNames[p],p,g,a,_,n,u,s,l)}h={Directory:t,Workbook:u,Props:f,Custprops:d,Deps:v,Sheets:a,SheetNames:f.SheetNames,Strings:sd,Styles:l,Themes:s,SSF:me.get_table()};if(n&&n.bookFiles){h.keys=e;h.files=r.files}if(n&&n.bookVBA){if(t.vba.length>0)h.vbaraw=Q(r,Rg(t.vba[0]),true);else if(t.defaults&&t.defaults.bin===Gu)h.vbaraw=Q(r,"xl/vbaProject.bin",true)}return h}function Og(e,t){var r=t||{};var n="Workbook",i=Me.find(e,n);try{n="/!DataSpaces/Version";i=Me.find(e,n);if(!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Bs(i.content);n="/!DataSpaces/DataSpaceMap";i=Me.find(e,n);if(!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=$s(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace";i=Me.find(e,n);if(!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Ws(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary";i=Me.find(e,n);if(!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);js(i.content)}catch(e){}n="/EncryptionInfo";i=Me.find(e,n);if(!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qs(i.content);n="/EncryptedPackage";i=Me.find(e,n);if(!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s[0]==4&&typeof decrypt_agile!=="undefined")return decrypt_agile(s[1],i.content,r.password||"",r);if(s[0]==2&&typeof decrypt_std76!=="undefined")return decrypt_std76(s[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Ag(e,t){Pu=1024;if(t.bookType=="ods")return cg(e,t);if(e&&!e.SSF){e.SSF=me.get_table()}if(e&&e.SSF){re(me);me.load_table(e.SSF);t.revssf=O(e.SSF);t.revssf[e.SSF[65535]]=0;t.ssf=e.SSF}t.rels={};t.wbrels={};t.Strings=[];t.Strings.Count=0;t.Strings.Unique=0;if(ud)t.revStrings=new Map;else{t.revStrings={};t.revStrings.foo=[];delete t.revStrings.foo}var r=t.bookType=="xlsb"?"bin":"xml";var n=Ju.indexOf(t.bookType)>-1;var i=Nn();Tg(t=t||{});var a=ce();var o="",s=0;t.cellXfs=[];hd(t.cellXfs,{},{revssf:{General:0}});if(!e.Props)e.Props={};o="docProps/core.xml";ue(a,o,ni(e.Props,t));i.coreprops.push(o);Vn(t.rels,2,o,Bn.CORE_PROPS);o="docProps/app.xml";if(e.Props&&e.Props.SheetNames){}else if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{var l=[];for(var u=0;u<e.SheetNames.length;++u)if((e.Workbook.Sheets[u]||{}).Hidden!=2)l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length;ue(a,o,ui(e.Props,t));i.extprops.push(o);Vn(t.rels,3,o,Bn.EXT_PROPS);if(e.Custprops!==e.Props&&ye(e.Custprops||{}).length>0){o="docProps/custom.xml";ue(a,o,hi(e.Custprops,t));i.custprops.push(o);Vn(t.rels,4,o,Bn.CUST_PROPS)}for(s=1;s<=e.SheetNames.length;++s){var f={"!id":{}};var c=e.Sheets[e.SheetNames[s-1]];var d=(c||{})["!type"]||"sheet";switch(d){case"chart":;default:o="xl/worksheets/sheet"+s+"."+r;ue(a,o,Vv(s-1,o,t,e,f));i.sheets.push(o);Vn(t.wbrels,-1,"worksheets/sheet"+s+"."+r,Bn.WS[0])}if(c){var h=c["!comments"];var v=false;if(h&&h.length>0){var p="xl/comments"+s+"."+r;ue(a,p,Gv(h,p,t));i.comments.push(p);Vn(f,-1,"../comments"+s+"."+r,Bn.CMNT);v=true}if(c["!legacy"]){if(v)ue(a,"xl/drawings/vmlDrawing"+s+".vml",Fu(s,c["!comments"]))}delete c["!comments"];delete c["!legacy"]}if(f["!id"].rId1)ue(a,Hn(o),Un(f))}if(t.Strings!=null&&t.Strings.length>0){o="xl/sharedStrings."+r;ue(a,o,Yv(t.Strings,o,t));i.strs.push(o);Vn(t.wbrels,-1,"sharedStrings."+r,Bn.SST)}o="xl/workbook."+r;ue(a,o,jv(e,o,t));i.workbooks.push(o);Vn(t.rels,1,o,Bn.WB);o="xl/theme/theme1.xml";ue(a,o,Cu(e.Themes,t));i.themes.push(o);Vn(t.wbrels,-1,"theme/theme1.xml",Bn.THEME);o="xl/styles."+r;ue(a,o,qv(e,o,t));i.styles.push(o);Vn(t.wbrels,-1,"styles."+r,Bn.STY);if(e.vbaraw&&n){o="xl/vbaProject.bin";ue(a,o,e.vbaraw);i.vba.push(o);Vn(t.wbrels,-1,"vbaProject.bin",Bn.VBA)}ue(a,"[Content_Types].xml",Fn(i,t));ue(a,"_rels/.rels",Un(t.rels));ue(a,"xl/_rels/workbook."+r+".rels",Un(t.wbrels));delete t.revssf;delete t.ssf;return a}function Ng(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Te.decode(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Mg(e,t){if(Me.find(e,"EncryptedPackage"))return Og(e,t);return Ip(e,t)}function Lg(e,t){var r,n=e;var i=t||{};if(!i.type)i.type=_e&&Buffer.isBuffer(e)?"buffer":"base64";r=de(n,i);return Ig(r,i)}function Pg(e,t){var r=0;e:while(r<e.length)switch(e.charCodeAt(r)){case 10:;case 13:;case 32:++r;break;case 60:return lp(e.slice(r),t);default:break e}return ps.to_workbook(e,t)}function Fg(e,t){var r="",n=Ng(e,t);switch(t.type){case"base64":r=Te.decode(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=H(e);break;default:throw new Error("Unrecognized type "+t.type)}if(n[0]==239&&n[1]==187&&n[2]==191)r=Ge(r);return Pg(r,t)}function Bg(e,t){var r=e;if(t.type=="base64")r=Te.decode(r);r=cptable.utils.decode(1200,r.slice(2),"str");t.type="binary";return Pg(r,t)}function Hg(e){return!e.match(/[^\x00-\x7F]/)?e:Xe(e)}function $g(e,t,r,n){if(n){r.type="string";return ps.to_workbook(e,r)}return ps.to_workbook(t,r)}function Wg(e,t){f();if(typeof ArrayBuffer!=="undefined"&&e instanceof ArrayBuffer)return Wg(new Uint8Array(e),t);var r=e,n=[0,0,0,0],i=false;var a=t||{};if(a.cellStyles){a.cellNF=true;a.sheetStubs=true}ld={};if(a.dateNF)ld.dateNF=a.dateNF;if(!a.type)a.type=_e&&Buffer.isBuffer(e)?"buffer":"base64";if(a.type=="file"){a.type=_e?"buffer":"binary";r=D(e)}if(a.type=="string"){i=true;a.type="binary";a.codepage=65001;r=Hg(e)}if(a.type=="array"&&typeof Uint8Array!=="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!=="undefined"){var o=new ArrayBuffer(3),s=new Uint8Array(o);s.foo="bar";if(!s.foo){a=oe(a);a.type="array";return Wg(y(r),a)}}switch((n=Ng(r,a))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Mg(Me.read(r,a),a);break;case 9:if(n[1]<=4)return Ip(r,a);break;case 60:return lp(r,a);case 73:if(n[1]===68)return gs(r,a);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return hs.to_workbook(r,a);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Lg(r,a):$g(e,r,a,i);case 239:return n[3]===60?lp(r,a):$g(e,r,a,i);case 255:if(n[1]===254){return Bg(r,a)}break;case 0:if(n[1]===0&&n[2]>=2&&n[3]===0)return ms.to_workbook(r,a);break;case 3:;case 131:;case 139:;case 140:return cs.to_workbook(r,a);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return al.to_workbook(r,a);break;case 10:;case 13:;case 32:return Fg(r,a)}if(cs.versions.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31)return cs.to_workbook(r,a);return $g(e,r,a,i)}function Ug(e,t){var r=t||{};r.type="file";return Wg(e,r)}function jg(e,t){switch(t.type){case"base64":;case"binary":break;case"buffer":;case"array":t.type="";break;case"file":return x(t.file,Me.write(e,{type:_e?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Me.write(e,t)}function Vg(e,t){var r=t||{};var n=Ag(e,r);var i={};if(r.compression)i.compression="DEFLATE";if(r.password)i.type=_e?"nodebuffer":"string";else switch(r.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":;case"file":i.type=_e?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+r.type)}var a=n.FullPaths?Me.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type}):n.generate(i);if(r.password&&typeof encrypt_agile!=="undefined")return jg(encrypt_agile(a,r.password),r);if(r.type==="file")return x(r.file,a);return r.type=="string"?Ge(a):a}function zg(e,t){var r=t||{};var n=Op(e,r);return jg(n,r)}function qg(e,t,r){if(!r)r="";var n=r+e;switch(t.type){case"base64":return Te.encode(Xe(n));case"binary":return Xe(n);case"string":return e;case"file":return x(t.file,n,"utf8");case"buffer":{if(_e)return o(n,"utf8");else return qg(n,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}}throw new Error("Unrecognized type "+t.type)}function Yg(e,t){switch(t.type){case"base64":return Te.encode(e);case"binary":return e;case"string":return e;case"file":return x(t.file,e,"binary");case"buffer":{if(_e)return o(e,"binary");else return e.split("").map(function(e){return e.charCodeAt(0)})}}throw new Error("Unrecognized type "+t.type)}function Gg(e,t){switch(t.type){case"string":;case"base64":;case"binary":var r="";for(var n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Te.encode(r):t.type=="string"?Ge(r):r;case"file":return x(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Xg(e,t){f();pv(e);var r=t||{};if(r.cellStyles){r.cellNF=true;r.sheetStubs=true}if(r.type=="array"){r.type="binary";var n=Xg(e,r);r.type="array";return p(n)}switch(r.bookType||"xlsb"){case"xml":;case"xlml":return qg(Cp(e,r),r);case"slk":;case"sylk":return qg(gg(e,r),r);case"htm":;case"html":return qg(vg(e,r),r);case"txt":return Yg(wg(e,r),r);case"csv":return qg(pg(e,r),r,"\ufeff");case"dif":return qg(mg(e,r),r);case"dbf":return Gg(Cg(e,r),r);case"prn":return qg(yg(e,r),r);case"rtf":return qg(bg(e,r),r);case"eth":return qg(Sg(e,r),r);case"fods":return qg(cg(e,r),r);case"biff2":if(!r.biff)r.biff=2;case"biff3":if(!r.biff)r.biff=3;case"biff4":if(!r.biff)r.biff=4;return Gg(Zp(e,r),r);case"biff5":if(!r.biff)r.biff=5;case"biff8":;case"xla":;case"xls":if(!r.biff)r.biff=8;return zg(e,r);case"xlsx":;case"xlsm":;case"xlam":;case"xlsb":;case"ods":return Vg(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Kg(e){if(e.bookType)return;var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"};var r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();if(r.match(/^\.[a-z]+$/))e.bookType=r.slice(1);e.bookType=t[e.bookType]||e.bookType}function Jg(e,t,r){var n=r||{};n.type="file";n.file=t;Kg(n);return Xg(e,n)}function Qg(e,t,r,n){var i=r||{};i.type="file";i.file=e;Kg(i);i.type="buffer";var a=n;if(!(a instanceof Function))a=r;return T.writeFile(e,Xg(t,i),a)}function Zg(e,t,r,n,i,a,o,s){var l=sr(r);var u=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw");var c=true;var d=i===1?[]:{};if(i!==1){if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:false})}catch(e){d.__rowNum__=r}else d.__rowNum__=r}if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=o?e[r][h]:e[n[h]+l];if(v===undefined||v.t===undefined){if(u===undefined)continue;if(a[h]!=null){d[a[h]]=u}continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=void 0;break;case"s":;case"d":;case"b":;case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[h]!=null){if(p==null){if(u!==undefined)d[a[h]]=u;else if(f&&p===null)d[a[h]]=null;else continue}else{d[a[h]]=f||s.rawNumbers&&v.t=="n"?p:Cr(v,p,s)}if(p!=null)c=false}}return{row:d,isempty:c}}function em(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,s="";var l={s:{r:0,c:0},e:{r:0,c:0}};var u=t||{};var f=u.range!=null?u.range:e["!ref"];if(u.header===1)n=1;else if(u.header==="A")n=2;else if(Array.isArray(u.header))n=3;else if(u.header==null)n=0;switch(typeof f){case"string":l=br(f);break;case"number":l=br(e["!ref"]);l.s.r=f;break;default:l=f}if(n>0)i=0;var c=sr(l.s.r);var d=[];var h=[];var v=0,p=0;var g=Array.isArray(e);var m=l.s.r,y=0,b=0;if(g&&!e[m])e[m]=[];for(y=l.s.c;y<=l.e.c;++y){d[y]=cr(y);r=g?e[m][y]:e[d[y]+c];switch(n){case 1:a[y]=y-l.s.c;break;case 2:a[y]=d[y];break;case 3:a[y]=u.header[y-l.s.c];break;default:if(r==null)r={w:"__EMPTY",t:"s"};s=o=Cr(r,null,u);p=0;for(b=0;b<a.length;++b)if(a[b]==s)s=o+"_"+ ++p;a[y]=s}}for(m=l.s.r+i;m<=l.e.r;++m){var w=Zg(e,l,m,d,n,a,g,u);if(w.isempty===false||(n===1?u.blankrows!==false:!!u.blankrows))h[v++]=w.row}h.length=v;return h}var tm=/"/g;function rm(e,t,r,n,i,a,o,s){var l=true;var u=[],f="",c=sr(r);for(var d=t.s.c;d<=t.e.c;++d){if(!n[d])continue;var h=s.dense?(e[r]||[])[d]:e[n[d]+c];if(h==null)f="";else if(h.v!=null){l=false;f=""+(s.rawNumbers&&h.t=="n"?h.v:Cr(h,null,s));for(var v=0,p=0;v!==f.length;++v)if((p=f.charCodeAt(v))===i||p===a||p===34||s.forceQuotes){f='"'+f.replace(tm,'""')+'"';break}if(f=="ID")f='"ID"'}else if(h.f!=null&&!h.F){l=false;f="="+h.f;if(f.indexOf(",")>=0)f='"'+f.replace(tm,'""')+'"'}else f="";u.push(f)}if(s.blankrows===false&&l)return null;return u.join(o)}function nm(e,t){var r=[];var n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var i=br(e["!ref"]);var a=n.FS!==undefined?n.FS:",",o=a.charCodeAt(0);var s=n.RS!==undefined?n.RS:"\n",l=s.charCodeAt(0);var u=new RegExp((a=="|"?"\\|":a)+"+$");var f="",c=[];n.dense=Array.isArray(e);var d=n.skipHidden&&e["!cols"]||[];var h=n.skipHidden&&e["!rows"]||[];for(var v=i.s.c;v<=i.e.c;++v)if(!(d[v]||{}).hidden)c[v]=cr(v);for(var p=i.s.r;p<=i.e.r;++p){if((h[p]||{}).hidden)continue;f=rm(e,i,p,c,o,l,a,n);if(f==null){continue}if(n.strip)f=f.replace(u,"");r.push(f+s)}delete n.dense;return r.join("")}function im(e,t){if(!t)t={};t.FS="\t";t.RS="\n";var r=nm(e,t);if(typeof cptable=="undefined"||t.type=="string")return r;var n=cptable.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function am(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=br(e["!ref"]),a="",o=[],s;var l=[];var u=Array.isArray(e);for(s=i.s.c;s<=i.e.c;++s)o[s]=cr(s);for(var f=i.s.r;f<=i.e.r;++f){a=sr(f);for(s=i.s.c;s<=i.e.c;++s){t=o[s]+a;r=u?(e[f]||[])[s]:e[t];n="";if(r===undefined)continue;else if(r.F!=null){t=r.F;if(!r.f)continue;n=r.f;if(t.indexOf(":")==-1)t=t+":"+t}if(r.f!=null)n=r.f;else if(r.t=="z")continue;else if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==undefined)n="'"+r.w;else if(r.v===undefined)continue;else if(r.t=="s")n="'"+r.v;else n=""+r.v;l[l.length]=t+"="+n}}return l}function om(e,t,r){var s=r||{};var l=+!s.skipHeader;var u=e||{};var f=0,c=0;if(u&&s.origin!=null){if(typeof s.origin=="number")f=s.origin;else{var n=typeof s.origin=="string"?pr(s.origin):s.origin;f=n.r;c=n.c}}var d;var i={s:{c:0,r:0},e:{c:c,r:f+t.length-1+l}};if(u["!ref"]){var a=br(u["!ref"]);i.e.c=Math.max(i.e.c,a.e.c);i.e.r=Math.max(i.e.r,a.e.r);if(f==-1){f=a.e.r+1;i.e.r=f+t.length-1+l}}else{if(f==-1){f=0;i.e.r=t.length-1+l}}var h=s.header||[],v=0;t.forEach(function(a,o){ye(a).forEach(function(e){if((v=h.indexOf(e))==-1)h[v=h.length]=e;var t=a[e];var r="z";var n="";var i=gr({c:c+v,r:f+o+l});d=lm.sheet_get_cell(u,i);if(t&&typeof t==="object"&&!(t instanceof Date)){u[i]=t}else{if(typeof t=="number")r="n";else if(typeof t=="boolean")r="b";else if(typeof t=="string")r="s";else if(t instanceof Date){r="d";if(!s.cellDates){r="n";t=Z(t)}n=s.dateNF||me._table[14]}if(!d)u[i]=d={t:r,v:t};else{d.t=r;d.v=t;delete d.w;delete d.R;if(n)d.z=n}if(n)d.z=n}})});i.e.c=Math.max(i.e.c,c+h.length-1);var o=sr(f);if(l)for(v=0;v<h.length;++v)u[cr(v+c)+o]={t:"s",v:h[v]};u["!ref"]=yr(i);return u}function sm(e,t){return om(null,e,t)}var lm={encode_col:cr,encode_row:sr,encode_cell:gr,encode_range:yr,decode_col:fr,decode_row:or,split_cell:vr,decode_cell:pr,decode_range:mr,format_cell:Cr,get_formulae:am,make_csv:nm,make_json:em,make_formulae:am,sheet_add_aoa:Er,sheet_add_json:om,sheet_add_dom:tg,aoa_to_sheet:kr,json_to_sheet:sm,table_to_sheet:rg,table_to_book:ng,sheet_to_csv:nm,sheet_to_txt:im,sheet_to_json:em,sheet_to_html:eg.from_sheet,sheet_to_formulae:am,sheet_to_row_object_array:em};(function(n){n.consts=n.consts||{};function e(e){e.forEach(function(e){n.consts[e[0]]=e[1]})}function i(e,t,r){return e[t]!=null?e[t]:e[t]=r}function l(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=pr(t);if(!e[n.r])e[n.r]=[];return e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}if(typeof t!="number")return l(e,gr(t));return l(e,gr({r:t,c:r||0}))}n.sheet_get_cell=l;function a(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}n.book_new=function(){return{SheetNames:[],Sheets:{}}};n.book_append_sheet=function(e,t,r){if(!r)for(var n=1;n<=65535;++n,r=undefined)if(e.SheetNames.indexOf(r="Sheet"+n)==-1)break;if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");hv(r);if(e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");e.SheetNames.push(r);e.Sheets[r]=t};n.book_set_sheet_visibility=function(e,t,r){i(e,"Workbook",{});i(e.Workbook,"Sheets",[]);var n=a(e,t);i(e.Workbook.Sheets,n,{});switch(r){case 0:;case 1:;case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r};e([["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]]);n.cell_set_number_format=function(e,t){e.z=t;return e};n.cell_set_hyperlink=function(e,t,r){if(!t){delete e.l}else{e.l={Target:t};if(r)e.l.Tooltip=r}return e};n.cell_set_internal_link=function(e,t,r){return n.cell_set_hyperlink(e,"#"+t,r)};n.cell_add_comment=function(e,t,r){if(!e.c)e.c=[];e.c.push({t:t,a:r||"SheetJS"})};n.sheet_set_array_formula=function(e,t,r){var n=typeof t!="string"?t:br(t);var i=typeof t=="string"?t:yr(t);for(var a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var s=l(e,a,o);s.t="n";s.F=i;delete s.v;if(a==n.s.r&&o==n.s.c)s.f=r}return e};return n})(lm);if(_e&&typeof require!="undefined")(function(){var b={}.Readable;var e=function(e,t){var r=b();var n=t==null?{}:t;if(e==null||e["!ref"]==null){r.push(null);return r}var i=br(e["!ref"]);var a=n.FS!==undefined?n.FS:",",o=a.charCodeAt(0);var s=n.RS!==undefined?n.RS:"\n",l=s.charCodeAt(0);var u=new RegExp((a=="|"?"\\|":a)+"+$");var f="",c=[];n.dense=Array.isArray(e);var d=n.skipHidden&&e["!cols"]||[];var h=n.skipHidden&&e["!rows"]||[];for(var v=i.s.c;v<=i.e.c;++v)if(!(d[v]||{}).hidden)c[v]=cr(v);var p=i.s.r;var g=false;r._read=function(){if(!g){g=true;return r.push("\ufeff")}while(p<=i.e.r){++p;if((h[p-1]||{}).hidden)continue;f=rm(e,i,p-1,c,o,l,a,n);if(f!=null){if(n.strip)f=f.replace(u,"");r.push(f+s);break}}if(p>i.e.r)return r.push(null)};return r};var t=function(e,t){var r=b();var n=t||{};var i=n.header!=null?n.header:eg.BEGIN;var a=n.footer!=null?n.footer:eg.END;r.push(i);var o=mr(e["!ref"]);n.dense=Array.isArray(e);r.push(eg._preamble(e,o,n));var s=o.s.r;var l=false;r._read=function(){if(s>o.e.r){if(!l){l=true;r.push("</table>"+a)}return r.push(null)}while(s<=o.e.r){r.push(eg._row(e,o,s,n));++s;break}};return r};var r=function(t,e){var r=b({objectMode:true});if(t==null||t["!ref"]==null){r.push(null);return r}var n={t:"n",v:0},i=0,a=1,o=[],s=0,l="";var u={s:{r:0,c:0},e:{r:0,c:0}};var f=e||{};var c=f.range!=null?f.range:t["!ref"];if(f.header===1)i=1;else if(f.header==="A")i=2;else if(Array.isArray(f.header))i=3;switch(typeof c){case"string":u=br(c);break;case"number":u=br(t["!ref"]);u.s.r=c;break;default:u=c}if(i>0)a=0;var d=sr(u.s.r);var h=[];var v=0;var p=Array.isArray(t);var g=u.s.r,m=0,y=0;if(p&&!t[g])t[g]=[];for(m=u.s.c;m<=u.e.c;++m){h[m]=cr(m);n=p?t[g][m]:t[h[m]+d];switch(i){case 1:o[m]=m-u.s.c;break;case 2:o[m]=h[m];break;case 3:o[m]=f.header[m-u.s.c];break;default:if(n==null)n={w:"__EMPTY",t:"s"};l=s=Cr(n,null,f);v=0;for(y=0;y<o.length;++y)if(o[y]==l)l=s+"_"+ ++v;o[m]=l}}g=u.s.r+a;r._read=function(){if(g>u.e.r)return r.push(null);while(g<=u.e.r){var e=Zg(t,u,g,h,i,o,p,f);++g;if(e.isempty===false||(i===1?f.blankrows!==false:!!f.blankrows)){r.push(e.row);break}}};return r};n.stream={to_json:r,to_html:t,to_csv:e}})();if(typeof Ip!=="undefined")n.parse_xlscfb=Ip;n.parse_zip=Ig;n.read=Wg;n.readFile=Ug;n.readFileSync=Ug;n.write=Xg;n.writeFile=Jg;n.writeFileSync=Jg;n.writeFileAsync=Qg;n.utils=lm;n.SSF=me;if(typeof Me!=="undefined")n.CFB=Me}if(typeof exports!=="undefined")make_xlsx_lib(exports);else if(typeof module!=="undefined"&&module.exports)make_xlsx_lib(module.exports);else if(typeof define==="function"&&define.amd)define(function(){if(!XLSX.version)make_xlsx_lib(XLSX);return XLSX});else make_xlsx_lib(XLSX);var XLS=XLSX,ODS=XLSX;(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define("Handsontable",[],r);else if(typeof exports==="object")exports["Handsontable"]=r();else t["Handsontable"]=r()})(typeof self!=="undefined"?self:this,function(){return function(r){var n={};function i(e){if(n[e]){return n[e].exports}var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=r;i.c=n;i.d=function(e,t,r){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);i.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=416)}([function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}e.exports=r},function(e,t){function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}e.exports=r},function(e,t){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function r(e,t,r){if(t)n(e.prototype,t);if(r)n(e,r);return e}e.exports=r},function(e,t,r){"use strict";var n=r(0);r(10);r(23);r(38);r(52);t.__esModule=true;t.duckSchema=s;t.inherit=l;t.extend=u;t.deepExtend=f;t.deepClone=c;t.clone=d;t.mixin=h;t.isObjectEqual=v;t.isObject=p;t.defineGetter=g;t.objectEach=m;t.getProperty=y;t.deepObjectSize=b;t.createObjectPropListener=w;t.hasOwnProperty=C;var a=n(r(70));var i=n(r(42));var o=r(4);function s(e){var r;if(Array.isArray(e)){r=[]}else{r={};m(e,function(e,t){if(t==="__children"){return}if(e&&(0,i.default)(e)==="object"&&!Array.isArray(e)){r[t]=s(e)}else if(Array.isArray(e)){if(e.length&&(0,i.default)(e[0])==="object"&&!Array.isArray(e[0])){r[t]=[s(e[0])]}else{r[t]=[]}}else{r[t]=null}})}return r}function l(e,t){t.prototype.constructor=t;e.prototype=new t;e.prototype.constructor=e;return e}function u(r,e){m(e,function(e,t){r[t]=e});return r}function f(r,n){m(n,function(e,t){if(n[t]&&(0,i.default)(n[t])==="object"){if(!r[t]){if(Array.isArray(n[t])){r[t]=[]}else if(Object.prototype.toString.call(n[t])==="[object Date]"){r[t]=n[t]}else{r[t]={}}}f(r[t],n[t])}else{r[t]=n[t]}})}function c(e){if((0,i.default)(e)==="object"){return JSON.parse(JSON.stringify(e))}return e}function d(e){var r={};m(e,function(e,t){r[t]=e});return r}function h(i){if(!i.MIXINS){i.MIXINS=[]}for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++){t[r-1]=arguments[r]}(0,o.arrayEach)(t,function(e){i.MIXINS.push(e.MIXIN_NAME);m(e,function(e,t){if(i.prototype[t]!==void 0){throw new Error("Mixin conflict. Property '".concat(t,"' already exist and cannot be overwritten."))}if(typeof e==="function"){i.prototype[t]=e}else{var r=function e(t,r){var n="_".concat(t);var i=function e(t){var r=t;if(Array.isArray(r)||p(r)){r=c(r)}return r};return function(){if(this[n]===void 0){this[n]=i(r)}return this[n]}};var n=function e(t){var r="_".concat(t);return function(e){this[r]=e}};Object.defineProperty(i.prototype,t,{get:r(t,e),set:n(t),configurable:true})}})});return i}function v(e,t){return JSON.stringify(e)===JSON.stringify(t)}function p(e){return Object.prototype.toString.call(e)==="[object Object]"}function g(e,t,r,n){n.value=r;n.writable=n.writable!==false;n.enumerable=n.enumerable!==false;n.configurable=n.configurable!==false;Object.defineProperty(e,t,n)}function m(e,t){for(var r in e){if(!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r)){if(t(e[r],r,e)===false){break}}}return e}function y(e,t){var r=t.split(".");var n=e;m(r,function(e){n=n[e];if(n===void 0){n=void 0;return false}});return n}function b(e){if(!p(e)){return 0}var t=function t(e){var r=0;if(p(e)){m(e,function(e){r+=t(e)})}else{r+=1}return r};return t(e)}function w(e){var t;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"value";var n="_".concat(r);var i=(t={_touched:false},(0,a.default)(t,n,e),(0,a.default)(t,"isTouched",function e(){return this._touched}),t);Object.defineProperty(i,r,{get:function e(){return this[n]},set:function e(t){this._touched=true;this[n]=t},enumerable:true,configurable:true});return i}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},function(e,t,r){"use strict";r(19);r(60);r(12);r(13);t.__esModule=true;t.to2dArray=n;t.extendArray=i;t.pivot=a;t.arrayReduce=o;t.arrayFilter=s;t.arrayMap=l;t.arrayEach=u;t.arraySum=f;t.arrayMax=c;t.arrayMin=d;t.arrayAvg=h;t.arrayFlatten=v;t.arrayUnique=p;function n(e){var t=e.length;var r=0;while(r<t){e[r]=[e[r]];r+=1}}function i(e,t){var r=t.length;var n=0;while(n<r){e.push(t[n]);n+=1}}function a(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0){return t}var r=e.length;var n=e[0].length;for(var i=0;i<r;i++){for(var a=0;a<n;a++){if(!t[a]){t[a]=[]}t[a][i]=e[i][a]}}return t}function o(e,t,r,n){var i=-1;var a=e;var o=r;if(!Array.isArray(e)){a=Array.from(e)}var s=a.length;if(n&&s){i+=1;o=a[i]}i+=1;while(i<s){o=t(o,a[i],i,a);i+=1}return o}function s(e,t){var r=0;var n=e;if(!Array.isArray(e)){n=Array.from(e)}var i=n.length;var a=[];var o=-1;while(r<i){var s=n[r];if(t(s,r,n)){o+=1;a[o]=s}r+=1}return a}function l(e,t){var r=0;var n=e;if(!Array.isArray(e)){n=Array.from(e)}var i=n.length;var a=[];var o=-1;while(r<i){var s=n[r];o+=1;a[o]=t(s,r,n);r+=1}return a}function u(e,t){var r=0;var n=e;if(!Array.isArray(e)){n=Array.from(e)}var i=n.length;while(r<i){if(t(n[r],r,n)===false){break}r+=1}return e}function f(e){return o(e,function(e,t){return e+t},0)}function c(e){return o(e,function(e,t){return e>t?e:t},Array.isArray(e)?e[0]:void 0)}function d(e){return o(e,function(e,t){return e<t?e:t},Array.isArray(e)?e[0]:void 0)}function h(e){if(!e.length){return 0}return f(e)/e.length}function v(e){return o(e,function(e,t){return e.concat(Array.isArray(t)?v(t):t)},[])}function p(e){var t=[];u(e,function(e){if(t.indexOf(e)===-1){t.push(e)}});return t}},function(t,e){function r(e){t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return r(e)}t.exports=r},function(e,t,r){var n=r(42);var i=r(28);function a(e,t){if(t&&(n(t)==="object"||typeof t==="function")){return t}return i(e)}e.exports=a},function(e,t,r){var n=r(222);function i(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)n(e,t)}e.exports=i},function(e,t,r){"use strict";var n=r(0);r(19);r(31);r(12);r(54);r(41);r(177);r(10);r(119);r(23);r(38);r(39);r(40);r(52);r(143);t.__esModule=true;t.getParent=a;t.getFrameElement=o;t.getParentWindow=l;t.hasAccessToParentWindow=u;t.closest=f;t.closestDown=d;t.isChildOf=h;t.isChildOfWebComponentTable=v;t.polymerWrap=p;t.polymerUnwrap=g;t.index=m;t.overlayContainsElement=y;t.hasClass=T;t.addClass=_;t.removeClass=x;t.removeTextNodes=D;t.empty=R;t.fastInnerHTML=O;t.fastInnerText=A;t.isVisible=N;t.offset=M;t.getWindowScrollTop=L;t.getWindowScrollLeft=P;t.getScrollTop=F;t.getScrollLeft=B;t.getScrollableElement=H;t.getTrimmingContainer=$;t.getStyle=W;t.matchesCSSRules=U;t.getComputedStyle=j;t.outerWidth=V;t.outerHeight=z;t.innerHeight=q;t.innerWidth=Y;t.addEvent=G;t.removeEvent=X;t.getCaretPosition=K;t.getSelectionEndPosition=J;t.getSelectionText=Q;t.clearTextSelection=Z;t.setCaretPosition=ee;t.getScrollbarWidth=ne;t.hasVerticalScrollbar=ie;t.hasHorizontalScrollbar=ae;t.setOverlayPosition=oe;t.getCssTransform=se;t.resetCssTransform=le;t.isInput=ue;t.isOutsideInput=fe;t.selectElementIfAllowed=ce;t.HTML_CHARACTERS=void 0;var s=n(r(37));var i=r(71);var c=r(76);function a(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=-1;var n=null;var i=e;while(i!==null){if(r===t){n=i;break}if(i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE){i=i.host}else{r+=1;i=i.parentNode}}return n}function o(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function l(e){return o(e)&&e.parent}function u(e){return!!Object.getPrototypeOf(e.parent)}function f(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r=arguments.length>2?arguments[2]:undefined;var n=Node,i=n.ELEMENT_NODE,a=n.DOCUMENT_FRAGMENT_NODE;var o=e;while(o!==null&&o!==void 0&&o!==r){var s=o,l=s.nodeType,u=s.nodeName;if(l===i&&(t.includes(u)||t.includes(o))){return o}var f=o,c=f.host;if(c&&l===a){o=c}else{o=o.parentNode}}return null}function d(e,t,r){var n=[];var i=e;while(i){i=f(i,t,r);if(!i||r&&!r.contains(i)){break}n.push(i);if(i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE){i=i.host}else{i=i.parentNode}}var a=n.length;return a?n[a-1]:null}function h(e,t){var r=e.parentNode;var n=[];if(typeof t==="string"){if(e.defaultView){n=Array.prototype.slice.call(e.querySelectorAll(t),0)}else{n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0)}}else{n.push(t)}while(r!==null){if(n.indexOf(r)>-1){return true}r=r.parentNode}return false}function v(e){var t="hot-table";var r=false;var n=p(e);function i(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===t.toUpperCase()}while(n!==null){if(i(n)){r=true;break}else if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){r=i(n.host);if(r){break}n=n.host}n=n.parentNode}return r}function p(e){return typeof Polymer!=="undefined"&&typeof wrap==="function"?wrap(e):e}function g(e){return typeof Polymer!=="undefined"&&typeof unwrap==="function"?unwrap(e):e}function m(e){var t=0;var r=e;if(r.previousSibling){while(r=r.previousSibling){t+=1}}return t}function y(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var b;var w;var C;function S(e){var t=[];if(!e||!e.length){return t}var r=0;while(e[r]){t.push(e[r]);r+=1}return t}if((0,c.isClassListSupported)()){var E=function e(t){var r=t.createElement("div");r.classList.add("test","test2");return r.classList.contains("test2")};b=function e(t,r){if(t.classList===void 0||typeof r!=="string"||r===""){return false}return t.classList.contains(r)};w=function e(t,r){var n=t.ownerDocument;var i=r;if(typeof i==="string"){i=i.split(" ")}i=S(i);if(i.length>0){if(E(n)){var a;(a=t.classList).add.apply(a,(0,s.default)(i))}else{var o=0;while(i&&i[o]){t.classList.add(i[o]);o+=1}}}};C=function e(t,r){var n=r;if(typeof n==="string"){n=n.split(" ")}n=S(n);if(n.length>0){if(E){var i;(i=t.classList).remove.apply(i,(0,s.default)(n))}else{var a=0;while(n&&n[a]){t.classList.remove(n[a]);a+=1}}}}}else{var k=function e(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};b=function e(t,r){return t.className!==void 0&&k(r).test(t.className)};w=function e(t,r){var n=0;var i=t.className;var a=r;if(typeof a==="string"){a=a.split(" ")}if(i===""){i=a.join(" ")}else{while(a&&a[n]){if(!k(a[n]).test(i)){i+=" ".concat(a[n])}n+=1}}t.className=i};C=function e(t,r){var n=0;var i=t.className;var a=r;if(typeof a==="string"){a=a.split(" ")}while(a&&a[n]){i=i.replace(k(a[n])," ").trim();n+=1}if(t.className!==i){t.className=i}}}function T(e,t){return b(e,t)}function _(e,t){return w(e,t)}function x(e,t){return C(e,t)}function D(e,t){if(e.nodeType===3){t.removeChild(e)}else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){var r=e.childNodes;for(var n=r.length-1;n>=0;n--){D(r[n],e)}}}function R(e){var t;while(t=e.lastChild){e.removeChild(t)}}var I=/(<(.*)>|&(.*);)/;t.HTML_CHARACTERS=I;function O(e,t){if(I.test(t)){e.innerHTML=t}else{A(e,t)}}function A(e,t){var r=e.firstChild;if(r&&r.nodeType===3&&r.nextSibling===null){if(c.isTextContentSupported){r.textContent=t}else{r.data=t}}else{R(e);e.appendChild(e.ownerDocument.createTextNode(t))}}function N(e){var t=e.ownerDocument.documentElement;var r=e;while(g(r)!==t){if(r===null){return false}else if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl){return N(r.host.impl)}else if(r.host){return N(r.host)}throw new Error("Lost in Web Components world")}else{return false}}else if(r.style&&r.style.display==="none"){return false}r=r.parentNode}return true}function M(e){var t=e.ownerDocument;var r=t.defaultView;var n=t.documentElement;var i=e;var a;var o;var s;var l;if((0,c.hasCaptionProblem)()&&i.firstChild&&i.firstChild.nodeName==="CAPTION"){l=i.getBoundingClientRect();return{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}}a=i.offsetLeft;o=i.offsetTop;s=i;while(i=i.offsetParent){if(i===t.body){break}a+=i.offsetLeft;o+=i.offsetTop;s=i}if(s&&s.style.position==="fixed"){a+=r.pageXOffset||n.scrollLeft;o+=r.pageYOffset||n.scrollTop}return{left:a,top:o}}function L(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:window;var t=e.scrollY;if(t===void 0){t=e.document.documentElement.scrollTop}return t}function P(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:window;var t=e.scrollX;if(t===void 0){t=e.document.documentElement.scrollLeft}return t}function F(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window;if(e===t){return L(t)}return e.scrollTop}function B(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window;if(e===t){return P(t)}return e.scrollLeft}function H(e){var t=e.ownerDocument;var r=t?t.defaultView:void 0;if(!t){t=e.document?e.document:e;r=t.defaultView}var n=["auto","scroll"];var i=(0,c.isGetComputedStyleSupported)();var a=e.parentNode;while(a&&a.style&&t.body!==a){var o=a.style,s=o.overflow,l=o.overflowX,u=o.overflowY;if([s,l,u].includes("scroll")){return a}else if(i){var f=r.getComputedStyle(a);s=f.overflow;l=f.overflowX;u=f.overflowY;if(n.includes(s)||n.includes(l)||n.includes(u)){return a}}if(a.clientHeight<=a.scrollHeight+1&&(n.includes(u)||n.includes(s))){return a}if(a.clientWidth<=a.scrollWidth+1&&(n.includes(l)||n.includes(s))){return a}a=a.parentNode}return r}function $(e){var t=e.ownerDocument;var r=t.defaultView;var n=e.parentNode;while(n&&n.style&&t.body!==n){if(n.style.overflow!=="visible"&&n.style.overflow!==""){return n}var i=j(n,r);var a=["scroll","hidden","auto"];var o=i.getPropertyValue("overflow");var s=i.getPropertyValue("overflow-y");var l=i.getPropertyValue("overflow-x");if(a.includes(o)||a.includes(s)||a.includes(l)){return n}n=n.parentNode}return r}function W(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:window;if(!e){return}else if(e===r){if(t==="width"){return"".concat(r.innerWidth,"px")}else if(t==="height"){return"".concat(r.innerHeight,"px")}return}var n=e.style[t];if(n!==""&&n!==void 0){return n}var i=j(e,r);if(i[t]!==""&&i[t]!==void 0){return i[t]}}function U(e,t){var r=t.selectorText;var n=false;if(t.type===CSSRule.STYLE_RULE&&r){if(e.msMatchesSelector){n=e.msMatchesSelector(r)}else if(e.matches){n=e.matches(r)}}return n}function j(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function V(e){return e.offsetWidth}function z(e){if((0,c.hasCaptionProblem)()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){return e.offsetHeight+e.firstChild.offsetHeight}return e.offsetHeight}function q(e){return e.clientHeight||e.innerHeight}function Y(e){return e.clientWidth||e.innerWidth}function G(e,t,r){var n=e.defaultView;if(!n){n=e.document?e:e.ownerDocument.defaultView}if(n.addEventListener){e.addEventListener(t,r,false)}else{e.attachEvent("on".concat(t),r)}}function X(e,t,r){var n=e.defaultView;if(!n){n=e.document?e:e.ownerDocument.defaultView}if(n.removeEventListener){e.removeEventListener(t,r,false)}else{e.detachEvent("on".concat(t),r)}}function K(e){var t=e.ownerDocument;if(e.selectionStart){return e.selectionStart}else if(t.selection){e.focus();var r=t.selection.createRange();if(r===null){return 0}var n=e.createTextRange();var i=n.duplicate();n.moveToBookmark(r.getBookmark());i.setEndPoint("EndToStart",n);return i.text.length}return 0}function J(e){var t=e.ownerDocument;if(e.selectionEnd){return e.selectionEnd}else if(t.selection){var r=t.selection.createRange();if(r===null){return 0}var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function Q(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:window;var t=e.document;var r="";if(e.getSelection){r=e.getSelection().toString()}else if(t.selection&&t.selection.type!=="Control"){r=t.selection.createRange().text}return r}function Z(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:window;var t=e.document;if(e.getSelection){if(e.getSelection().empty){e.getSelection().empty()}else if(e.getSelection().removeAllRanges){e.getSelection().removeAllRanges()}}else if(t.selection){t.selection.empty()}}function ee(t,r,n){if(n===void 0){n=r}if(t.setSelectionRange){t.focus();try{t.setSelectionRange(r,n)}catch(e){var i=t.parentNode;var a=i.style.display;i.style.display="block";t.setSelectionRange(r,n);i.style.display=a}}else if(t.createTextRange){var e=t.createTextRange();e.collapse(true);e.moveEnd("character",n);e.moveStart("character",r);e.select()}}var te;function re(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;var t=e.createElement("div");t.style.height="200px";t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box";r.style.height="150px";r.style.left="0px";r.style.overflow="hidden";r.style.position="absolute";r.style.top="0px";r.style.width="200px";r.style.visibility="hidden";r.appendChild(t);(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;if(n===i){i=r.clientWidth}(e.body||e.documentElement).removeChild(r);return n-i}function ne(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;if(te===void 0){te=re(e)}return te}function ie(e){return e.offsetWidth!==e.clientWidth}function ae(e){return e.offsetHeight!==e.clientHeight}function oe(e,t,r){if((0,i.isIE8)()||(0,i.isIE9)()){e.style.top=r;e.style.left=t}else if((0,i.isSafari)()){e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)");e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)")}else{e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}}function se(e){var t;if(e.style.transform&&(t=e.style.transform)!==""){return["transform",t]}else if(e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""){return["-webkit-transform",t]}return-1}function le(e){if(e.style.transform&&e.style.transform!==""){e.style.transform=""}else if(e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""){e.style["-webkit-transform"]=""}}function ue(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function fe(e){return ue(e)&&e.className.indexOf("handsontableInput")===-1&&e.className.indexOf("HandsontableCopyPaste")===-1}function ce(e){var t=e.ownerDocument.activeElement;if(!fe(t)){e.select()}}},function(e,t,r){var o=r(42);function s(){if(typeof WeakMap!=="function")return null;var t=new WeakMap;s=function e(){return t};return t}function n(e){if(e&&e.__esModule){return e}if(e===null||o(e)!=="object"&&typeof e!=="function"){return{default:e}}var t=s();if(t&&t.has(e)){return t.get(e)}var r={};var n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;if(a&&(a.get||a.set)){Object.defineProperty(r,i,a)}else{r[i]=e[i]}}}r["default"]=e;if(t){t.set(e,r)}return r}e.exports=n},function(e,t,r){var n=r(164);var i=r(68);var a=r(424);if(!n){i(Object.prototype,"toString",a,{unsafe:true})}},function(e,t,r){"use strict";t.__esModule=true;t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=t.FILTERS_BUTTONS_PLACEHOLDER_VALUE=t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=t.FILTERS_BUTTONS_CANCEL=t.FILTERS_BUTTONS_OK=t.FILTERS_BUTTONS_CLEAR=t.FILTERS_BUTTONS_SELECT_ALL=t.FILTERS_VALUES_BLANK_CELLS=t.FILTERS_LABELS_DISJUNCTION=t.FILTERS_LABELS_CONJUNCTION=t.FILTERS_DIVS_FILTER_BY_VALUE=t.FILTERS_DIVS_FILTER_BY_CONDITION=t.FILTERS_CONDITIONS_YESTERDAY=t.FILTERS_CONDITIONS_TOMORROW=t.FILTERS_CONDITIONS_TODAY=t.FILTERS_CONDITIONS_BEFORE=t.FILTERS_CONDITIONS_AFTER=t.FILTERS_CONDITIONS_NOT_BETWEEN=t.FILTERS_CONDITIONS_BETWEEN=t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=t.FILTERS_CONDITIONS_LESS_THAN=t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=t.FILTERS_CONDITIONS_GREATER_THAN=t.FILTERS_CONDITIONS_BY_VALUE=t.FILTERS_CONDITIONS_NOT_CONTAIN=t.FILTERS_CONDITIONS_CONTAINS=t.FILTERS_CONDITIONS_ENDS_WITH=t.FILTERS_CONDITIONS_BEGINS_WITH=t.FILTERS_CONDITIONS_NOT_EQUAL=t.FILTERS_CONDITIONS_EQUAL=t.FILTERS_CONDITIONS_NOT_EMPTY=t.FILTERS_CONDITIONS_EMPTY=t.FILTERS_CONDITIONS_NONE=t.FILTERS_CONDITIONS_NAMESPACE=t.FILTERS_NAMESPACE=t.CONTEXTMENU_ITEMS_SHOW_ROW=t.CONTEXTMENU_ITEMS_HIDE_ROW=t.CONTEXTMENU_ITEMS_SHOW_COLUMN=t.CONTEXTMENU_ITEMS_HIDE_COLUMN=t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=t.CONTEXTMENU_ITEMS_REMOVE_BORDERS=t.CONTEXTMENU_ITEMS_BORDERS_LEFT=t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=t.CONTEXTMENU_ITEMS_BORDERS_RIGHT=t.CONTEXTMENU_ITEMS_BORDERS_TOP=t.CONTEXTMENU_ITEMS_BORDERS=t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=t.CONTEXTMENU_ITEMS_ALIGNMENT=t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=t.CONTEXTMENU_ITEMS_REMOVE_COMMENT=t.CONTEXTMENU_ITEMS_EDIT_COMMENT=t.CONTEXTMENU_ITEMS_ADD_COMMENT=t.CONTEXTMENU_ITEMS_UNMERGE_CELLS=t.CONTEXTMENU_ITEMS_MERGE_CELLS=t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=t.CONTEXTMENU_ITEMS_FREEZE_COLUMN=t.CONTEXTMENU_ITEMS_CUT=t.CONTEXTMENU_ITEMS_COPY=t.CONTEXTMENU_ITEMS_CLEAR_COLUMN=t.CONTEXTMENU_ITEMS_READ_ONLY=t.CONTEXTMENU_ITEMS_REDO=t.CONTEXTMENU_ITEMS_UNDO=t.CONTEXTMENU_ITEMS_REMOVE_COLUMN=t.CONTEXTMENU_ITEMS_REMOVE_ROW=t.CONTEXTMENU_ITEMS_INSERT_RIGHT=t.CONTEXTMENU_ITEMS_INSERT_LEFT=t.CONTEXTMENU_ITEMS_ROW_BELOW=t.CONTEXTMENU_ITEMS_ROW_ABOVE=t.CONTEXTMENU_ITEMS_NO_ITEMS=t.CONTEXT_MENU_ITEMS_NAMESPACE=void 0;var n="ContextMenu:items";t.CONTEXT_MENU_ITEMS_NAMESPACE=n;var i="".concat(n,".noItems");t.CONTEXTMENU_ITEMS_NO_ITEMS=i;var a="".concat(n,".insertRowAbove");t.CONTEXTMENU_ITEMS_ROW_ABOVE=a;var o="".concat(n,".insertRowBelow");t.CONTEXTMENU_ITEMS_ROW_BELOW=o;var s="".concat(n,".insertColumnOnTheLeft");t.CONTEXTMENU_ITEMS_INSERT_LEFT=s;var l="".concat(n,".insertColumnOnTheRight");t.CONTEXTMENU_ITEMS_INSERT_RIGHT=l;var u="".concat(n,".removeRow");t.CONTEXTMENU_ITEMS_REMOVE_ROW=u;var f="".concat(n,".removeColumn");t.CONTEXTMENU_ITEMS_REMOVE_COLUMN=f;var c="".concat(n,".undo");t.CONTEXTMENU_ITEMS_UNDO=c;var d="".concat(n,".redo");t.CONTEXTMENU_ITEMS_REDO=d;var h="".concat(n,".readOnly");t.CONTEXTMENU_ITEMS_READ_ONLY=h;var v="".concat(n,".clearColumn");t.CONTEXTMENU_ITEMS_CLEAR_COLUMN=v;var p="".concat(n,".copy");t.CONTEXTMENU_ITEMS_COPY=p;var g="".concat(n,".cut");t.CONTEXTMENU_ITEMS_CUT=g;var m="".concat(n,".freezeColumn");t.CONTEXTMENU_ITEMS_FREEZE_COLUMN=m;var y="".concat(n,".unfreezeColumn");t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=y;var b="".concat(n,".mergeCells");t.CONTEXTMENU_ITEMS_MERGE_CELLS=b;var w="".concat(n,".unmergeCells");t.CONTEXTMENU_ITEMS_UNMERGE_CELLS=w;var C="".concat(n,".addComment");t.CONTEXTMENU_ITEMS_ADD_COMMENT=C;var S="".concat(n,".editComment");t.CONTEXTMENU_ITEMS_EDIT_COMMENT=S;var E="".concat(n,".removeComment");t.CONTEXTMENU_ITEMS_REMOVE_COMMENT=E;var k="".concat(n,".readOnlyComment");t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=k;var T="".concat(n,".align");t.CONTEXTMENU_ITEMS_ALIGNMENT=T;var _="".concat(n,".align.left");t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=_;var x="".concat(n,".align.center");t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=x;var D="".concat(n,".align.right");t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=D;var R="".concat(n,".align.justify");t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=R;var I="".concat(n,".align.top");t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=I;var O="".concat(n,".align.middle");t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=O;var A="".concat(n,".align.bottom");t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=A;var N="".concat(n,".borders");t.CONTEXTMENU_ITEMS_BORDERS=N;var M="".concat(n,".borders.top");t.CONTEXTMENU_ITEMS_BORDERS_TOP=M;var L="".concat(n,".borders.right");t.CONTEXTMENU_ITEMS_BORDERS_RIGHT=L;var P="".concat(n,".borders.bottom");t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=P;var F="".concat(n,".borders.left");t.CONTEXTMENU_ITEMS_BORDERS_LEFT=F;var B="".concat(n,".borders.remove");t.CONTEXTMENU_ITEMS_REMOVE_BORDERS=B;var H="".concat(n,".nestedHeaders.insertChildRow");t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=H;var $="".concat(n,".nestedHeaders.detachFromParent");t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=$;var W="".concat(n,".hideColumn");t.CONTEXTMENU_ITEMS_HIDE_COLUMN=W;var U="".concat(n,".showColumn");t.CONTEXTMENU_ITEMS_SHOW_COLUMN=U;var j="".concat(n,".hideRow");t.CONTEXTMENU_ITEMS_HIDE_ROW=j;var V="".concat(n,".showRow");t.CONTEXTMENU_ITEMS_SHOW_ROW=V;var z="Filters:";t.FILTERS_NAMESPACE=z;var q="".concat(z,"conditions");t.FILTERS_CONDITIONS_NAMESPACE=q;var Y="".concat(q,".none");t.FILTERS_CONDITIONS_NONE=Y;var G="".concat(q,".isEmpty");t.FILTERS_CONDITIONS_EMPTY=G;var X="".concat(q,".isNotEmpty");t.FILTERS_CONDITIONS_NOT_EMPTY=X;var K="".concat(q,".isEqualTo");t.FILTERS_CONDITIONS_EQUAL=K;var J="".concat(q,".isNotEqualTo");t.FILTERS_CONDITIONS_NOT_EQUAL=J;var Q="".concat(q,".beginsWith");t.FILTERS_CONDITIONS_BEGINS_WITH=Q;var Z="".concat(q,".endsWith");t.FILTERS_CONDITIONS_ENDS_WITH=Z;var ee="".concat(q,".contains");t.FILTERS_CONDITIONS_CONTAINS=ee;var te="".concat(q,".doesNotContain");t.FILTERS_CONDITIONS_NOT_CONTAIN=te;var re="".concat(q,".byValue");t.FILTERS_CONDITIONS_BY_VALUE=re;var ne="".concat(q,".greaterThan");t.FILTERS_CONDITIONS_GREATER_THAN=ne;var ie="".concat(q,".greaterThanOrEqualTo");t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=ie;var ae="".concat(q,".lessThan");t.FILTERS_CONDITIONS_LESS_THAN=ae;var oe="".concat(q,".lessThanOrEqualTo");t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=oe;var se="".concat(q,".isBetween");t.FILTERS_CONDITIONS_BETWEEN=se;var le="".concat(q,".isNotBetween");t.FILTERS_CONDITIONS_NOT_BETWEEN=le;var ue="".concat(q,".after");t.FILTERS_CONDITIONS_AFTER=ue;var fe="".concat(q,".before");t.FILTERS_CONDITIONS_BEFORE=fe;var ce="".concat(q,".today");t.FILTERS_CONDITIONS_TODAY=ce;var de="".concat(q,".tomorrow");t.FILTERS_CONDITIONS_TOMORROW=de;var he="".concat(q,".yesterday");t.FILTERS_CONDITIONS_YESTERDAY=he;var ve="".concat(z,"labels.filterByCondition");t.FILTERS_DIVS_FILTER_BY_CONDITION=ve;var pe="".concat(z,"labels.filterByValue");t.FILTERS_DIVS_FILTER_BY_VALUE=pe;var ge="".concat(z,"labels.conjunction");t.FILTERS_LABELS_CONJUNCTION=ge;var me="".concat(z,"labels.disjunction");t.FILTERS_LABELS_DISJUNCTION=me;var ye="".concat(z,"values.blankCells");t.FILTERS_VALUES_BLANK_CELLS=ye;var be="".concat(z,"buttons.selectAll");t.FILTERS_BUTTONS_SELECT_ALL=be;var we="".concat(z,"buttons.clear");t.FILTERS_BUTTONS_CLEAR=we;var Ce="".concat(z,"buttons.ok");t.FILTERS_BUTTONS_OK=Ce;var Se="".concat(z,"buttons.cancel");t.FILTERS_BUTTONS_CANCEL=Se;var Ee="".concat(z,"buttons.placeholder.search");t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=Ee;var ke="".concat(z,"buttons.placeholder.value");t.FILTERS_BUTTONS_PLACEHOLDER_VALUE=ke;var Te="".concat(z,"buttons.placeholder.secondValue");t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=Te},function(e,t,r){"use strict";var n=r(20);var i=r(158).indexOf;var a=r(84);var o=r(59);var s=[].indexOf;var l=!!s&&1/[1].indexOf(1,-0)<0;var u=a("indexOf");var f=o("indexOf",{ACCESSORS:true,1:0});n({target:"Array",proto:true,forced:l||!u||!f},{indexOf:function e(t){return l?s.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var a=r(165).charAt;var n=r(81);var i=r(162);var o="String Iterator";var s=n.set;var l=n.getterFor(o);i(String,"String",function(e){s(this,{type:o,string:String(e),index:0})},function e(){var t=l(this);var r=t.string;var n=t.index;var i;if(n>=r.length)return{value:undefined,done:true};i=a(r,n);t.index+=i.length;return{value:i,done:false}})},function(n,e,t){var o=t(463);function i(e,t,r){if(typeof Reflect!=="undefined"&&Reflect.get){n.exports=i=Reflect.get}else{n.exports=i=function e(t,r,n){var i=o(t,r);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,r);if(a.get){return a.get.call(n)}return a.value}}return i(e,t,r||e)}n.exports=i},function(e,t,r){"use strict";var n=r(63);var i=r(109);var a=r(112);var o=r(81);var s=r(162);var l="Array Iterator";var u=o.set;var f=o.getterFor(l);e.exports=s(Array,"Array",function(e,t){u(this,{type:l,target:n(e),index:0,kind:t})},function(){var e=f(this);var t=e.target;var r=e.kind;var n=e.index++;if(!t||n>=t.length){e.target=undefined;return{value:undefined,done:true}}if(r=="keys")return{value:n,done:false};if(r=="values")return{value:t[n],done:false};return{value:[n,t[n]],done:false}},"values");a.Arguments=a.Array;i("keys");i("values");i("entries")},function(e,t,r){var n=r(35);var i=r(214);var a=r(15);var o=r(67);var s=r(36);var l=s("iterator");var u=s("toStringTag");var f=a.values;for(var c in i){var d=n[c];var h=d&&d.prototype;if(h){if(h[l]!==f)try{o(h,l,f)}catch(e){h[l]=f}if(!h[u]){o(h,u,c)}if(i[c])for(var v in a){if(h[v]!==a[v])try{o(h,v,a[v])}catch(e){h[v]=a[v]}}}}},function(e,t,r){"use strict";var n=r(0);r(10);r(23);r(38);r(40);t.__esModule=true;t.isNumeric=a;t.rangeEach=o;t.rangeEachReverse=s;t.valueAccordingPercent=l;var i=n(r(42));function a(e){var t=(0,i.default)(e);return t=="number"?!isNaN(e)&&isFinite(e):t=="string"?!e.length?false:e.length==1?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):t=="object"?!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date):false}function o(e,t,r){var n=-1;if(typeof t==="function"){r=t;t=e}else{n=e-1}while(++n<=t){if(r(n)===false){break}}}function s(e,t,r){var n=e+1;if(typeof t==="function"){r=t;t=0}while(--n>=t){if(r(n)===false){break}}}function l(e,t){t=parseInt(t.toString().replace("%",""),10);t=parseInt(e*t/100,10);return t}},function(e,t,r){var n=r(229);var i=r(431);var a=r(230);function o(e,t){return n(e)||i(e,t)||a()}e.exports=o},function(e,t,r){"use strict";var n=r(20);var i=r(26);var a=r(114);var o=r(45);var f=r(58);var c=r(49);var d=r(115);var h=r(170);var s=r(116);var l=r(36);var u=r(218);var v=l("isConcatSpreadable");var p=9007199254740991;var g="Maximum allowed index exceeded";var m=u>=51||!i(function(){var e=[];e[v]=false;return e.concat()[0]!==e});var y=s("concat");var b=function(e){if(!o(e))return false;var t=e[v];return t!==undefined?!!t:a(e)};var w=!m||!y;n({target:"Array",proto:true,forced:w},{concat:function e(t){var r=f(this);var n=h(r,0);var i=0;var a,o,s,l,u;for(a=-1,s=arguments.length;a<s;a++){u=a===-1?r:arguments[a];if(b(u)){l=c(u.length);if(i+l>p)throw TypeError(g);for(o=0;o<l;o++,i++)if(o in u)d(n,i,u[o])}else{if(i>=p)throw TypeError(g);d(n,i++,u)}}n.length=i;return n}})},function(e,t,r){var c=r(35);var d=r(79).f;var h=r(67);var v=r(68);var p=r(156);var g=r(198);var m=r(134);e.exports=function(e,t){var r=e.target;var n=e.global;var i=e.stat;var a,o,s,l,u,f;if(n){o=c}else if(i){o=c[r]||p(r,{})}else{o=(c[r]||{}).prototype}if(o)for(s in t){u=t[s];if(e.noTargetGet){f=d(o,s);l=f&&f.value}else l=o[s];a=m(n?s:r+(i?".":"#")+s,e.forced);if(!a&&l!==undefined){if(typeof u===typeof l)continue;g(u,l)}if(e.sham||l&&l.sham){h(u,"sham",true)}v(o,s,u,e)}}},function(e,t,r){"use strict";var n=r(0);r(15);r(65);r(10);r(13);r(24);r(16);t.__esModule=true;t.registerPlugin=l;t.getPlugin=u;t.getRegistredPluginNames=f;t.getPluginName=c;var i=n(r(46));var a=r(3);var o=r(74);var s=new WeakMap;function l(e,t){var r=(0,o.toUpperCaseFirst)(e);i.default.getSingleton().add("construct",function(){if(!s.has(this)){s.set(this,{})}var e=s.get(this);if(!e[r]){e[r]=new t(this)}});i.default.getSingleton().add("afterDestroy",function(){if(s.has(this)){var e=s.get(this);(0,a.objectEach)(e,function(e){return e.destroy()});s.delete(this)}})}function u(e,t){if(typeof t!=="string"){throw Error('Only strings can be passed as "plugin" parameter')}var r=(0,o.toUpperCaseFirst)(t);if(!s.has(e)||!s.get(e)[r]){return void 0}return s.get(e)[r]}function f(e){return s.has(e)?Object.keys(s.get(e)):[]}function c(e,r){var n=null;if(s.has(e)){(0,a.objectEach)(s.get(e),function(e,t){if(e===r){n=t}})}return n}},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(33);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(3);var s=r(4);var l=r(98);var u=r(21);var f=new WeakMap;var c=null;var d=function(){function r(e){var t=this;(0,i.default)(this,r);(0,o.defineGetter)(this,"hot",e,{writable:false});(0,o.defineGetter)(this,"t",(0,l.getTranslator)(e),{writable:false});f.set(this,{hooks:{}});c=null;this.pluginName=null;this.pluginsInitializedCallbacks=[];this.isPluginsReady=false;this.enabled=false;this.initialized=false;this.hot.addHook("afterPluginsInitialized",function(){return t.onAfterPluginsInitialized()});this.hot.addHook("afterUpdateSettings",function(e){return t.onUpdateSettings(e)});this.hot.addHook("beforeInit",function(){return t.init()})}(0,a.default)(r,[{key:"init",value:function e(){this.pluginName=(0,u.getPluginName)(this.hot,this);if(this.isEnabled&&this.isEnabled()){this.enablePlugin()}if(!c){c=(0,u.getRegistredPluginNames)(this.hot)}if(c.indexOf(this.pluginName)>=0){c.splice(c.indexOf(this.pluginName),1)}if(!c.length){this.hot.runHooks("afterPluginsInitialized")}this.initialized=true}},{key:"enablePlugin",value:function e(){this.enabled=true}},{key:"disablePlugin",value:function e(){if(this.eventManager){this.eventManager.clear()}this.clearHooks();this.enabled=false}},{key:"addHook",value:function e(t,r){f.get(this).hooks[t]=f.get(this).hooks[t]||[];var n=f.get(this).hooks[t];this.hot.addHook(t,r);n.push(r);f.get(this).hooks[t]=n}},{key:"removeHooks",value:function e(t){var r=this;(0,s.arrayEach)(f.get(this).hooks[t]||[],function(e){r.hot.removeHook(t,e)})}},{key:"clearHooks",value:function e(){var r=this;var t=f.get(this).hooks;(0,o.objectEach)(t,function(e,t){return r.removeHooks(t)});t.length=0}},{key:"callOnPluginsReady",value:function e(t){if(this.isPluginsReady){t()}else{this.pluginsInitializedCallbacks.push(t)}}},{key:"onAfterPluginsInitialized",value:function e(){(0,s.arrayEach)(this.pluginsInitializedCallbacks,function(e){return e()});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=true}},{key:"onUpdateSettings",value:function e(){if(this.isEnabled){if(this.enabled&&!this.isEnabled()){this.disablePlugin()}if(!this.enabled&&this.isEnabled()){this.enablePlugin()}if(this.enabled&&this.isEnabled()){this.updatePlugin()}}}},{key:"updatePlugin",value:function e(){}},{key:"destroy",value:function e(){var r=this;if(this.eventManager){this.eventManager.destroy()}this.clearHooks();(0,o.objectEach)(this,function(e,t){if(t!=="hot"&&t!=="t"){r[t]=null}});delete this.t;delete this.hot}}]);return r}();var h=d;t.default=h},function(e,t,r){"use strict";var n=r(20);var i=r(140);n({target:"RegExp",proto:true,forced:/./.exec!==i},{exec:i})},function(e,t,r){"use strict";var n=r(35);var i=r(166);var a=r(136);var o=r(137);var s=r(213);var l=r(45);var u=r(81).enforce;var f=r(197);var c=!n.ActiveXObject&&"ActiveXObject"in n;var d=Object.isExtensible;var h;var v=function(t){return function e(){return t(this,arguments.length?arguments[0]:undefined)}};var p=e.exports=o("WeakMap",v,s);if(f&&c){h=s.getConstructor(v,"WeakMap",true);a.REQUIRED=true;var g=p.prototype;var m=g["delete"];var y=g.has;var b=g.get;var w=g.set;i(g,{delete:function(e){if(l(e)&&!d(e)){var t=u(this);if(!t.frozen)t.frozen=new h;return m.call(this,e)||t.frozen["delete"](e)}return m.call(this,e)},has:function e(t){if(l(t)&&!d(t)){var r=u(this);if(!r.frozen)r.frozen=new h;return y.call(this,t)||r.frozen.has(t)}return y.call(this,t)},get:function e(t){if(l(t)&&!d(t)){var r=u(this);if(!r.frozen)r.frozen=new h;return y.call(this,t)?b.call(this,t):r.frozen.get(t)}return b.call(this,t)},set:function e(t,r){if(l(t)&&!d(t)){var n=u(this);if(!n.frozen)n.frozen=new h;y.call(this,t)?w.call(this,t,r):n.frozen.set(t,r)}else w.call(this,t,r);return this}})}},function(e,t,r){"use strict";var n=r(0);r(33);t.__esModule=true;t.getListenersCounter=s;t.default=void 0;var i=n(r(1));var a=n(r(2));var u=r(8);var f=r(3);var c=r(76);var d=r(32);var l=0;var h=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;(0,i.default)(this,t);this.context=e||this;if(!this.context.eventListeners){this.context.eventListeners=[]}}(0,a.default)(t,[{key:"addEventListener",value:function e(t,r,n){var i=this;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var o=this.context;function s(e){n.call(this,v(o,e))}if(typeof a!=="boolean"&&!(0,c.isPassiveEventSupported)()){a=false}this.context.eventListeners.push({element:t,event:r,callback:n,callbackProxy:s,options:a,eventManager:this});t.addEventListener(r,s,a);l+=1;return function(){i.removeEventListener(t,r,n)}}},{key:"removeEventListener",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var a=this.context.eventListeners.length;var o;while(a){a-=1;o=this.context.eventListeners[a];if(o.event===r&&o.element===t){if(n&&n!==o.callback){continue}if(i&&o.eventManager!==this){continue}this.context.eventListeners.splice(a,1);o.element.removeEventListener(o.event,o.callbackProxy,o.options);l-=1}}}},{key:"clearEvents",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.context){return}var r=this.context.eventListeners.length;while(r){r-=1;var n=this.context.eventListeners[r];if(n){this.removeEventListener(n.element,n.event,n.callback,t)}}}},{key:"clear",value:function e(){this.clearEvents()}},{key:"destroy",value:function e(){this.clearEvents();this.context=null}},{key:"destroyWithOwnEventsOnly",value:function e(){this.clearEvents(true);this.context=null}},{key:"fireEvent",value:function e(t,r){var n=t.document;var i=t;if(!n){n=t.ownerDocument?t.ownerDocument:t;i=n.defaultView}var a={bubbles:true,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:undefined};var o;if(n.createEvent){o=n.createEvent("MouseEvents");o.initMouseEvent(r,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget||n.body.parentNode)}else{o=n.createEventObject()}if(t.dispatchEvent){t.dispatchEvent(o)}else{t.fireEvent("on".concat(r),o)}}}]);return t}();function v(e,t){var r="HOT-TABLE";var n;var i;var a;var o;var s;t.isTargetWebComponent=false;t.realTarget=t.target;var l=t.stopImmediatePropagation;t.stopImmediatePropagation=function(){l.apply(this);(0,d.stopImmediatePropagation)(this)};if(!h.isHotTableEnv){return t}t=(0,u.polymerWrap)(t);s=t.path?t.path.length:0;while(s){s-=1;if(t.path[s].nodeName===r){n=true}else if(n&&t.path[s].shadowRoot){o=t.path[s];break}if(s===0&&!o){o=t.path[s]}}if(!o){o=t.target}t.isTargetWebComponent=true;if((0,c.isWebComponentSupportedNatively)()){t.realTarget=t.srcElement||t.toElement}else if((0,f.hasOwnProperty)(e,"hot")||e.isHotTableEnv||e.wtTable){if((0,f.hasOwnProperty)(e,"hot")){i=e.hot?e.hot.view.wt.wtTable.TABLE:null}else if(e.isHotTableEnv){i=e.view.activeWt.wtTable.TABLE.parentNode.parentNode}else if(e.wtTable){i=e.wtTable.TABLE.parentNode.parentNode}a=(0,u.closest)(t.target,[r],i);if(a){t.realTarget=i.querySelector(r)||t.target}else{t.realTarget=t.target}}Object.defineProperty(t,"target",{get:function e(){return(0,u.polymerWrap)(o)},enumerable:true,configurable:true});return t}var o=h;t.default=o;function s(){return l}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return true}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.Renderer=void 0;var a=i(r(223));t.ViewportColumnsCalculator=a.default;var o=i(r(224));t.ViewportRowsCalculator=o.default;var s=i(r(118));t.CellCoords=s.default;var l=i(r(225));t.CellRange=l.default;var u=i(r(226));t.ColumnFilter=u.default;var f=i(r(227));t.RowFilter=f.default;var c=i(r(228));t.MasterTable=c.default;var d=i(r(450));t.LeftOverlay=d.default;var h=i(r(452));t.TopOverlay=h.default;var v=i(r(454));t.TopLeftCornerOverlay=v.default;var p=i(r(456));t.BottomOverlay=p.default;var g=i(r(458));t.BottomLeftCornerOverlay=g.default;var m=i(r(373));t.Border=m.default;var y=i(r(363));t.default=y.default;t.Core=y.default;var b=i(r(364));t.Event=b.default;var w=i(r(365));t.Overlays=w.default;var C=i(r(367));t.Scroll=C.default;var S=i(r(460));t.Selection=S.default;var E=i(r(368));t.Settings=E.default;var k=n(r(231));t.Renderer=k;var T=r(145);t.OrderView=T.OrderView;t.SharedOrderView=T.SharedOrderView;var _=i(r(369));t.Viewport=_.default;var x=r(25);t.getListenersCounter=x.getListenersCounter},function(e,t){function r(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}e.exports=r},function(e,t,r){"use strict";var n=r(0);r(10);r(23);r(38);r(440);r(234);r(40);r(52);t.__esModule=true;t.stringify=h;t.isDefined=v;t.isUndefined=p;t.isEmpty=m;t.isRegExp=y;t._injectProductInfo=I;var i=n(r(72));var a=n(r(42));var g=n(r(64));var o=r(73);function s(){var t=(0,i.default)(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);s=function e(){return t};return t}function l(){var t=(0,i.default)(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.']);l=function e(){return t};return t}function u(){var t=(0,i.default)(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);u=function e(){return t};return t}function f(){var t=(0,i.default)(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."]);f=function e(){return t};return t}function c(){var t=(0,i.default)(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."]);c=function e(){return t};return t}function d(){var t=(0,i.default)(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."]);d=function e(){return t};return t}function h(e){var t;switch((0,a.default)(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function v(e){return typeof e!=="undefined"}function p(e){return typeof e==="undefined"}function m(e){return e===null||e===""||p(e)}function y(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var b="length";var w=function e(t){return parseInt(t,16)};var C=function e(t){return parseInt(t,10)};var S=function e(t,r,n){return t["substr"](r,n)};var E=function e(t){return t["codePointAt"](0)-65};var k=function e(t){return"".concat(t).replace(/\-/g,"")};var T=function e(t){return w(S(k(t),w("12"),E("F")))/(w(S(k(t),E("B"),~~![][b]))||9)};var _=function e(){return typeof location!=="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)};var x=false;var D={invalid:function e(){return(0,o.toSingleLine)(d())},expired:function e(t){var r=t.keyValidityDate,n=t.hotVersion;return(0,o.toSingleLine)(c(),r,n,r)},missing:function e(){return(0,o.toSingleLine)(f())},non_commercial:function e(){return""}};var R={invalid:function e(){return(0,o.toSingleLine)(u())},expired:function e(t){var r=t.keyValidityDate,n=t.hotVersion;return(0,o.toSingleLine)(l(),r,n,r)},missing:function e(){return(0,o.toSingleLine)(s())},non_commercial:function e(){return""}};function I(e,t){var r=!m(e);var n=typeof e==="string"&&e.toLowerCase()==="non-commercial-and-evaluation";var i="7.4.2";var a;var o="invalid";var s="invalid";e=k(e||"");var l=O(e);if(r||n||l){if(l){var u=(0,g.default)("19/02/2020","DD/MM/YYYY");var f=Math.floor(u.toDate().getTime()/864e5);var c=T(e);a=(0,g.default)((c+1)*864e5,"x").format("MMMM DD, YYYY");if(f>c){var d=(0,g.default)().diff(u,"days");o=d<=1?"valid":"expired";s=d<=15?"valid":"expired"}else{o="valid";s="valid"}}else if(n){o="non_commercial";s="valid"}else{o="invalid";s="invalid"}}else{o="missing";s="missing"}if(_()){o="valid";s="valid"}if(!x&&o!=="valid"){var h=D[o]({keyValidityDate:a,hotVersion:i});if(h){console[o==="non_commercial"?"info":"warn"](D[o]({keyValidityDate:a,hotVersion:i}))}x=true}if(s!=="valid"&&t.parentNode){var v=R[s]({keyValidityDate:a,hotVersion:i});if(v){var p=document.createElement("div");p.id="hot-display-license-info";p.innerHTML=R[s]({keyValidityDate:a,hotVersion:i});t.parentNode.insertBefore(p,t.nextSibling)}}}function O(e){var t=[][b];var r=t;if(e[b]!==E("Z")){return false}for(var n="",i="B<H4P+".split(""),a=E(i.shift());a;a=E(i.shift()||"A")){--a<""[b]?r=r|(C("".concat(C(w(n)+(w(S(e,Math.abs(a),2))+[]).padStart(2,"0"))))%97||2)>>1:n=S(e,a,!a?6:i[b]===1?9:8)}return r===t}},function(e,t,r){"use strict";r(19);t.__esModule=true;t.getCondition=n;t.getConditionDescriptor=i;t.registerCondition=a;t.conditions=void 0;var o={};t.conditions=o;function n(e,t){if(!o[e]){throw Error('Filter condition "'.concat(e,'" does not exist.'))}var r=o[e],n=r.condition,i=r.descriptor;var a=t;if(i.inputValuesDecorator){a=i.inputValuesDecorator(a)}return function(e){return n.apply(e.meta.instance,[].concat([e],[a]))}}function i(e){if(!o[e]){throw Error('Filter condition "'.concat(e,'" does not exist.'))}return o[e].descriptor}function a(e,t,r){r.key=e;o[e]={condition:t,descriptor:r}}},function(e,t,r){"use strict";var n=r(20);var i=r(158).includes;var a=r(109);var o=r(59);var s=o("indexOf",{ACCESSORS:true,1:0});n({target:"Array",proto:true,forced:!s},{includes:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});a("includes")},function(e,t,r){"use strict";t.__esModule=true;t.stopImmediatePropagation=i;t.isImmediatePropagationStopped=a;t.stopPropagation=o;t.pageX=s;t.pageY=l;t.isRightClick=u;t.isLeftClick=f;var n=r(8);function i(e){e.isImmediatePropagationEnabled=false;e.cancelBubble=true}function a(e){return e.isImmediatePropagationEnabled===false}function o(e){if(typeof e.stopPropagation==="function"){e.stopPropagation()}else{e.cancelBubble=true}}function s(e){if(e.pageX){return e.pageX}var t=e.target.ownerDocument.defaultView;return e.clientX+(0,n.getWindowScrollLeft)(t)}function l(e){if(e.pageY){return e.pageY}var t=e.target.ownerDocument.defaultView;var r=(0,n.getWindowScrollTop)(t);t=(0,n.getParentWindow)(t);while(t){r-=(0,n.getWindowScrollTop)(t);t=(0,n.getParentWindow)(t)}return e.clientY+r}function u(e){return e.button===2}function f(e){return e.button===0}},function(e,t,r){"use strict";var n=r(20);var h=r(133);var v=r(82);var p=r(49);var g=r(58);var m=r(170);var y=r(115);var i=r(116);var a=r(59);var o=i("splice");var s=a("splice",{ACCESSORS:true,0:0,1:2});var b=Math.max;var w=Math.min;var C=9007199254740991;var S="Maximum allowed length exceeded";n({target:"Array",proto:true,forced:!o||!s},{splice:function e(t,r){var n=g(this);var i=p(n.length);var a=h(t,i);var o=arguments.length;var s,l,u,f,c,d;if(o===0){s=l=0}else if(o===1){s=0;l=i-a}else{s=o-2;l=w(b(v(r),0),i-a)}if(i+s-l>C){throw TypeError(S)}u=m(n,l);for(f=0;f<l;f++){c=a+f;if(c in n)y(u,f,n[c])}u.length=l;if(s<l){for(f=a;f<i-l;f++){c=f+l;d=f+s;if(c in n)n[d]=n[c];else delete n[d]}for(f=i;f>i-l+s;f--)delete n[f-1]}else if(s>l){for(f=i-l;f>a;f--){c=f+l-1;d=f+s-1;if(c in n)n[d]=n[c];else delete n[d]}}for(f=0;f<s;f++){n[f+a]=arguments[f+2]}n.length=i-l+s;return u}})},function(e,t,r){var n=r(20);var i=r(35);var a=r(139);var o=[].slice;var s=/MSIE .\./.test(a);var l=function(i){return function(e,t){var r=arguments.length>2;var n=r?o.call(arguments,2):undefined;return i(r?function(){(typeof e=="function"?e:Function(e)).apply(this,n)}:e,t)}};n({global:true,bind:true,forced:s},{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},function(e,t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof global=="object"&&global)||Function("return this")()},function(e,t,r){var n=r(35);var i=r(157);var a=r(47);var o=r(132);var s=r(161);var l=r(203);var u=i("wks");var f=n.Symbol;var c=l?f:f&&f.withoutSetter||o;e.exports=function(e){if(!a(u,e)){if(s&&a(f,e))u[e]=f[e];else u[e]=c("Symbol."+e)}return u[e]}},function(e,t,r){var n=r(426);var i=r(217);var a=r(427);function o(e){return n(e)||i(e)||a()}e.exports=o},function(e,t,r){"use strict";var n=r(68);var a=r(48);var i=r(26);var o=r(171);var s="toString";var l=RegExp.prototype;var u=l[s];var f=i(function(){return u.call({source:"a",flags:"b"})!="/a/b"});var c=u.name!=s;if(f||c){n(RegExp.prototype,s,function e(){var t=a(this);var r=String(t.source);var n=t.flags;var i=String(n===undefined&&t instanceof RegExp&&!("flags"in l)?o.call(t):n);return"/"+r+"/"+i},{unsafe:true})}},function(e,t,r){"use strict";var n=r(20);var i=r(175);var a=r(53);var o=r(176);n({target:"String",proto:true,forced:!o("includes")},{includes:function e(t){return!!~String(a(this)).indexOf(i(t),arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var n=r(141);var x=r(48);var i=r(58);var D=r(49);var R=r(82);var o=r(53);var I=r(173);var O=r(142);var A=Math.max;var N=Math.min;var d=Math.floor;var h=/\$([$&'`]|\d\d?|<[^>]*>)/g;var v=/\$([$&'`]|\d\d?)/g;var M=function(e){return e===undefined?e:String(e)};n("replace",2,function(a,C,S,e){var E=e.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE;var k=e.REPLACE_KEEPS_$0;var T=E?"$":"$0";return[function e(t,r){var n=o(this);var i=t==undefined?undefined:t[a];return i!==undefined?i.call(t,n,r):C.call(String(n),t,r)},function(e,t){if(!E&&k||typeof t==="string"&&t.indexOf(T)===-1){var r=S(C,e,this,t);if(r.done)return r.value}var n=x(e);var i=String(this);var a=typeof t==="function";if(!a)t=String(t);var o=n.global;if(o){var s=n.unicode;n.lastIndex=0}var l=[];while(true){var u=O(n,i);if(u===null)break;l.push(u);if(!o)break;var f=String(u[0]);if(f==="")n.lastIndex=I(i,D(n.lastIndex),s)}var c="";var d=0;for(var h=0;h<l.length;h++){u=l[h];var v=String(u[0]);var p=A(N(R(u.index),i.length),0);var g=[];for(var m=1;m<u.length;m++)g.push(M(u[m]));var y=u.groups;if(a){var b=[v].concat(g,p,i);if(y!==undefined)b.push(y);var w=String(t.apply(undefined,b))}else{w=_(v,i,p,g,y,t)}if(p>=d){c+=i.slice(d,p)+w;d=p+v.length}}return c+i.slice(d)}];function _(a,o,s,l,u,e){var f=s+a.length;var c=l.length;var t=v;if(u!==undefined){u=i(u);t=h}return C.call(e,t,function(e,t){var r;switch(t.charAt(0)){case"$":return"$";case"&":return a;case"`":return o.slice(0,s);case"'":return o.slice(f);case"<":r=u[t.slice(1,-1)];break;default:var n=+t;if(n===0)return e;if(n>c){var i=d(n/10);if(i===0)return e;if(i<=c)return l[i-1]===undefined?t.charAt(1):l[i-1]+t.charAt(1);return e}r=l[n-1]}return r===undefined?"":r})}})},function(e,t,r){"use strict";var n=r(20);var f=r(45);var c=r(114);var d=r(133);var h=r(49);var v=r(63);var p=r(115);var i=r(36);var a=r(116);var o=r(59);var s=a("slice");var l=o("slice",{ACCESSORS:true,0:0,1:2});var g=i("species");var m=[].slice;var y=Math.max;n({target:"Array",proto:true,forced:!s||!l},{slice:function e(t,r){var n=v(this);var i=h(n.length);var a=d(t,i);var o=d(r===undefined?i:r,i);var s,l,u;if(c(n)){s=n.constructor;if(typeof s=="function"&&(s===Array||c(s.prototype))){s=undefined}else if(f(s)){s=s[g];if(s===null)s=undefined}if(s===Array||s===undefined){return m.call(n,a,o)}}l=new(s===undefined?Array:s)(y(o-a,0));for(u=0;a<o;a++,u++)if(a in n)p(l,u,n[a]);l.length=u;return l}})},function(t,e){function r(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){t.exports=r=function e(t){return typeof t}}else{t.exports=r=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return r(e)}t.exports=r},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.getRenderer=y;t.getRegisteredRenderers=t.getRegisteredRendererNames=t.hasRenderer=t.registerRenderer=void 0;var i=n(r(83));var a=n(r(473));var o=n(r(474));var s=n(r(475));var l=n(r(476));var u=n(r(477));var f=n(r(478));var c=n(r(479));var d=(0,i.default)("renderers"),h=d.register,v=d.getItem,p=d.hasItem,g=d.getNames,m=d.getValues;t.getRegisteredRenderers=m;t.getRegisteredRendererNames=g;t.hasRenderer=p;t.registerRenderer=h;h("base",a.default);h("autocomplete",o.default);h("checkbox",s.default);h("html",l.default);h("numeric",u.default);h("password",f.default);h("text",c.default);function y(e){if(typeof e==="function"){return e}if(!p(e)){throw Error('No registered renderer found under "'.concat(e,'" name'))}return v(e)}},function(e,t,r){var n=r(26);e.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(e,t){e.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},function(e,t,r){"use strict";var n=r(0);r(12);r(33);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var s=r(4);var o=r(3);var l=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","skipLengthCache","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions"];var u=function(){(0,a.default)(e,null,[{key:"getSingleton",value:function e(){return c()}}]);function e(){(0,i.default)(this,e);this.globalBucket=this.createEmptyBucket()}(0,a.default)(e,[{key:"createEmptyBucket",value:function e(){var t=Object.create(null);(0,s.arrayEach)(l,function(e){return t[e]=[]});return t}},{key:"getBucket",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(t){if(!t.pluginHookBucket){t.pluginHookBucket=this.createEmptyBucket()}return t.pluginHookBucket}return this.globalBucket}},{key:"add",value:function e(r,n){var t=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(Array.isArray(n)){(0,s.arrayEach)(n,function(e){return t.add(r,e,i)})}else{var a=this.getBucket(i);if(typeof a[r]==="undefined"){this.register(r);a[r]=[]}n.skip=false;if(a[r].indexOf(n)===-1){var o=false;if(n.initialHook){(0,s.arrayEach)(a[r],function(e,t){if(e.initialHook){a[r][t]=n;o=true;return false}})}if(!o){a[r].push(n)}}}return this}},{key:"once",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(Array.isArray(r)){(0,s.arrayEach)(r,function(e){return n.once(t,e,i)})}else{r.runOnce=true;this.add(t,r,i)}}},{key:"remove",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var i=this.getBucket(n);if(typeof i[t]!=="undefined"){if(i[t].indexOf(r)>=0){r.skip=true;return true}}return false}},{key:"has",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=this.getBucket(r);return!!(n[t]!==void 0&&n[t].length)}},{key:"run",value:function e(t,r,n,i,a,o,s,l){{var u=this.globalBucket[r];var f=u?u.length:0;var c=0;if(f){while(c<f){if(!u[c]||u[c].skip){c+=1;continue}var d=u[c].call(t,n,i,a,o,s,l);if(d!==void 0){n=d}if(u[c]&&u[c].runOnce){this.remove(r,u[c])}c+=1}}}{var h=this.getBucket(t)[r];var v=h?h.length:0;var p=0;if(v){while(p<v){if(!h[p]||h[p].skip){p+=1;continue}var g=h[p].call(t,n,i,a,o,s,l);if(g!==void 0){n=g}if(h[p]&&h[p].runOnce){this.remove(r,h[p],t)}p+=1}}}return n}},{key:"destroy",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;(0,o.objectEach)(this.getBucket(t),function(e,t,r){return r[t].length=0})}},{key:"register",value:function e(t){if(!this.isRegistered(t)){l.push(t)}}},{key:"deregister",value:function e(t){if(this.isRegistered(t)){l.splice(l.indexOf(t),1)}}},{key:"isRegistered",value:function e(t){return l.indexOf(t)>=0}},{key:"getRegistered",value:function e(){return l}}]);return e}();var f=new u;function c(){return f}var d=u;t.default=d},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(45);e.exports=function(e){if(!n(e)){throw TypeError(String(e)+" is not an object")}return e}},function(e,t,r){var n=r(82);var i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){"use strict";var n=r(20);var i=r(75).filter;var a=r(116);var o=r(59);var s=a("filter");var l=o("filter");n({target:"Array",proto:true,forced:!s||!l},{filter:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){var n=r(44);var i=r(194);var a=r(48);var o=r(105);var s=Object.defineProperty;t.f=n?s:function e(t,r,n){a(t);r=o(r,true);a(n);if(i)try{return s(t,r,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");if("value"in n)t[r]=n.value;return t}},function(e,t,r){"use strict";var n=r(141);var c=r(172);var b=r(48);var d=r(53);var w=r(429);var C=r(173);var S=r(49);var E=r(142);var h=r(140);var i=r(26);var v=[].push;var k=Math.min;var T=4294967295;var _=!i(function(){return!RegExp(T,"y")});n("split",2,function(a,g,m){var y;if("abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length){y=function(e,t){var r=String(d(this));var n=t===undefined?T:t>>>0;if(n===0)return[];if(e===undefined)return[r];if(!c(e)){return g.call(r,e,n)}var i=[];var a=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":"");var o=0;var s=new RegExp(e.source,a+"g");var l,u,f;while(l=h.call(s,r)){u=s.lastIndex;if(u>o){i.push(r.slice(o,l.index));if(l.length>1&&l.index<r.length)v.apply(i,l.slice(1));f=l[0].length;o=u;if(i.length>=n)break}if(s.lastIndex===l.index)s.lastIndex++}if(o===r.length){if(f||!s.test(""))i.push("")}else i.push(r.slice(o));return i.length>n?i.slice(0,n):i}}else if("0".split(undefined,0).length){y=function(e,t){return e===undefined&&t===0?[]:g.call(this,e,t)}}else y=g;return[function e(t,r){var n=d(this);var i=t==undefined?undefined:t[a];return i!==undefined?i.call(t,n,r):y.call(String(n),t,r)},function(e,t){var r=m(y,e,this,t,y!==g);if(r.done)return r.value;var n=b(e);var i=String(this);var a=w(n,RegExp);var o=n.unicode;var s=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(_?"y":"g");var l=new a(_?n:"^(?:"+n.source+")",s);var u=t===undefined?T:t>>>0;if(u===0)return[];if(i.length===0)return E(l,i)===null?[i]:[];var f=0;var c=0;var d=[];while(c<i.length){l.lastIndex=_?c:0;var h=E(l,_?i:i.slice(c));var v;if(h===null||(v=k(S(l.lastIndex+(_?0:c)),i.length))===f){c=C(i,c,o)}else{d.push(i.slice(f,c));if(d.length===u)return d;for(var p=1;p<=h.length-1;p++){d.push(h[p]);if(d.length===u)return d}c=f=v}}d.push(i.slice(f));return d}]},!_)},function(e,t){e.exports=function(e){if(e==undefined)throw TypeError("Can't call method on "+e);return e}},function(e,t,r){"use strict";var n=r(20);var i=r(104);var a=r(63);var o=r(84);var s=[].join;var l=i!=Object;var u=o("join",",");n({target:"Array",proto:true,forced:l||!u},{join:function e(t){return s.call(a(this),t===undefined?",":t)}})},function(e,t,r){"use strict";r(31);r(12);r(23);r(39);r(52);t.__esModule=true;t.isPrintableChar=n;t.isMetaKey=o;t.isCtrlKey=s;t.isCtrlMetaKey=l;t.isKey=u;t.KEY_CODES=void 0;var i=r(4);var a={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};t.KEY_CODES=a;function n(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function o(e){var t=[a.ARROW_DOWN,a.ARROW_UP,a.ARROW_LEFT,a.ARROW_RIGHT,a.HOME,a.END,a.DELETE,a.BACKSPACE,a.F1,a.F2,a.F3,a.F4,a.F5,a.F6,a.F7,a.F8,a.F9,a.F10,a.F11,a.F12,a.TAB,a.PAGE_DOWN,a.PAGE_UP,a.ENTER,a.ESCAPE,a.SHIFT,a.CAPS_LOCK,a.ALT];return t.indexOf(e)!==-1}function s(e){var t=[];if(navigator.platform.includes("Mac")){t.push(a.COMMAND_LEFT,a.COMMAND_RIGHT,a.COMMAND_FIREFOX)}else{t.push(a.CONTROL)}return t.includes(e)}function l(e){return[a.CONTROL,a.COMMAND_LEFT,a.COMMAND_RIGHT,a.COMMAND_FIREFOX].includes(e)}function u(t,e){var r=e.split("|");var n=false;(0,i.arrayEach)(r,function(e){if(t===a[e]){n=true;return false}});return n}},function(e,t,r){var n=r(44);var i=r(51).f;var a=Function.prototype;var o=a.toString;var s=/^\s*function ([^ (]*)/;var l="name";if(n&&!(l in a)){i(a,l,{configurable:true,get:function(){try{return o.call(this).match(s)[1]}catch(e){return""}}})}},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.RegisteredEditor=E;t.getEditorInstance=t._getEditorInstance=k;t.registerEditor=_;t.getEditor=T;t.getRegisteredEditors=t.getRegisteredEditorNames=t.hasEditor=void 0;var i=n(r(83));var a=n(r(46));var o=n(r(117));var s=n(r(375));var l=n(r(465));var u=n(r(466));var f=n(r(469));var c=n(r(376));var d=n(r(470));var h=n(r(471));var v=n(r(472));var p=n(r(123));var g=new WeakMap;var m=(0,i.default)("editors"),y=m.register,b=m.getItem,w=m.hasItem,C=m.getNames,S=m.getValues;t.getRegisteredEditors=S;t.getRegisteredEditorNames=C;t.hasEditor=w;_("base",o.default);_("autocomplete",s.default);_("checkbox",l.default);_("date",u.default);_("dropdown",f.default);_("handsontable",c.default);_("numeric",d.default);_("password",h.default);_("select",v.default);_("text",p.default);function E(e){var t={};var r=e;this.getConstructor=function(){return e};this.getInstance=function(e){if(!(e.guid in t)){t[e.guid]=new r(e)}return t[e.guid]};a.default.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function k(e,t){var r;if(typeof e==="function"){if(!g.get(e)){_(null,e)}r=g.get(e)}else if(typeof e==="string"){r=b(e)}else{throw Error('Only strings and functions can be passed as "editor" parameter')}if(!r){throw Error('No editor registered under name "'.concat(e,'"'))}return r.getInstance(t)}function T(e){if(!w(e)){throw Error('No registered editor found under "'.concat(e,'" name'))}return b(e).getConstructor()}function _(e,t){var r=new E(t);if(typeof e==="string"){y(e,r)}g.set(t,r)}},function(e,t,r){var n=r(53);e.exports=function(e){return Object(n(e))}},function(e,t,r){var o=r(44);var s=r(26);var l=r(47);var u=Object.defineProperty;var f={};var c=function(e){throw e};e.exports=function(e,t){if(l(f,e))return f[e];if(!t)t={};var r=[][e];var n=l(t,"ACCESSORS")?t.ACCESSORS:false;var i=l(t,0)?t[0]:c;var a=l(t,1)?t[1]:undefined;return f[e]=!!r&&!s(function(){if(n&&!o)return true;var e={length:-1};if(n)u(e,1,{enumerable:true,get:c});else e[1]=1;r.call(e,i,a)})}},function(e,t,r){var n=r(20);var i=r(428);var a=r(212);var o=!a(function(e){Array.from(e)});n({target:"Array",stat:true,forced:o},{from:i})},function(e,t,r){"use strict";t.__esModule=true;t.log=i;t.warn=a;t.info=o;t.error=s;var n=r(29);function i(){if((0,n.isDefined)(console)){var e;(e=console).log.apply(e,arguments)}}function a(){if((0,n.isDefined)(console)){var e;(e=console).warn.apply(e,arguments)}}function o(){if((0,n.isDefined)(console)){var e;(e=console).info.apply(e,arguments)}}function s(){if((0,n.isDefined)(console)){var e;(e=console).error.apply(e,arguments)}}},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var o=r(4);var n=r(3);var i="localHooks";var a={_localHooks:Object.create(null),addLocalHook:function e(t,r){if(!this._localHooks[t]){this._localHooks[t]=[]}this._localHooks[t].push(r);return this},runLocalHooks:function e(t){var r=this;for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++){i[a-1]=arguments[a]}if(this._localHooks[t]){(0,o.arrayEach)(this._localHooks[t],function(e){return e.apply(r,i)})}},clearLocalHooks:function e(){this._localHooks={};return this}};(0,n.defineGetter)(a,"MIXIN_NAME",i,{writable:false,enumerable:false});var s=a;t.default=s},function(e,t,r){var n=r(104);var i=r(53);e.exports=function(e){return n(i(e))}},function(e,t,Wa){(function(Ha){var $a;(function(e,t){true?Ha.exports=t():undefined})(this,function(){"use strict";var t;function u(){return t.apply(null,arguments)}function e(e){t=e}function o(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function s(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function l(e){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(e).length===0}else{var t;for(t in e){if(e.hasOwnProperty(t)){return false}}return true}}function a(e){return e===void 0}function f(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function i(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function r(e,t){var r=[],n;for(n=0;n<e.length;++n){r.push(t(e[n],n))}return r}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var r in t){if(c(t,r)){e[r]=t[r]}}if(c(t,"toString")){e.toString=t.toString}if(c(t,"valueOf")){e.valueOf=t.valueOf}return e}function h(e,t,r,n){return zr(e,t,r,n,true).utc()}function n(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function v(e){if(e._pf==null){e._pf=n()}return e._pf}var p;if(Array.prototype.some){p=Array.prototype.some}else{p=function(e){var t=Object(this);var r=t.length>>>0;for(var n=0;n<r;n++){if(n in t&&e.call(this,t[n],n,t)){return true}}return false}}function g(e){if(e._isValid==null){var t=v(e);var r=p.call(t.parsedDateParts,function(e){return e!=null});var n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict){n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(e)){e._isValid=n}else{return n}}return e._isValid}function m(e){var t=h(NaN);if(e!=null){d(v(t),e)}else{v(t).userInvalidated=true}return t}var y=u.momentProperties=[];function b(e,t){var r,n,i;if(!a(t._isAMomentObject)){e._isAMomentObject=t._isAMomentObject}if(!a(t._i)){e._i=t._i}if(!a(t._f)){e._f=t._f}if(!a(t._l)){e._l=t._l}if(!a(t._strict)){e._strict=t._strict}if(!a(t._tzm)){e._tzm=t._tzm}if(!a(t._isUTC)){e._isUTC=t._isUTC}if(!a(t._offset)){e._offset=t._offset}if(!a(t._pf)){e._pf=v(t)}if(!a(t._locale)){e._locale=t._locale}if(y.length>0){for(r=0;r<y.length;r++){n=y[r];i=t[n];if(!a(i)){e[n]=i}}}return e}var w=false;function C(e){b(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(w===false){w=true;u.updateOffset(this);w=false}}function S(e){return e instanceof C||e!=null&&e._isAMomentObject!=null}function E(e){if(e<0){return Math.ceil(e)||0}else{return Math.floor(e)}}function k(e){var t=+e,r=0;if(t!==0&&isFinite(t)){r=E(t)}return r}function T(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++){if(r&&e[o]!==t[o]||!r&&k(e[o])!==k(t[o])){a++}}return a+i}function _(e){if(u.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function x(i,a){var o=true;return d(function(){if(u.deprecationHandler!=null){u.deprecationHandler(null,i)}if(o){var e=[];var t;for(var r=0;r<arguments.length;r++){t="";if(typeof arguments[r]==="object"){t+="\n["+r+"] ";for(var n in arguments[0]){t+=n+": "+arguments[0][n]+", "}t=t.slice(0,-2)}else{t=arguments[r]}e.push(t)}_(i+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);o=false}return a.apply(this,arguments)},a)}var D={};function R(e,t){if(u.deprecationHandler!=null){u.deprecationHandler(e,t)}if(!D[e]){_(t);D[e]=true}}u.suppressDeprecationWarnings=false;u.deprecationHandler=null;function I(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function O(e){var t,r;for(r in e){t=e[r];if(I(t)){this[r]=t}else{this["_"+r]=t}}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function A(e,t){var r=d({},e),n;for(n in t){if(c(t,n)){if(s(e[n])&&s(t[n])){r[n]={};d(r[n],e[n]);d(r[n],t[n])}else if(t[n]!=null){r[n]=t[n]}else{delete r[n]}}}for(n in e){if(c(e,n)&&!c(t,n)&&s(e[n])){r[n]=d({},r[n])}}return r}function N(e){if(e!=null){this.set(e)}}var M;if(Object.keys){M=Object.keys}else{M=function(e){var t,r=[];for(t in e){if(c(e,t)){r.push(t)}}return r}}var L={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function P(e,t,r){var n=this._calendar[e]||this._calendar["sameElse"];return I(n)?n.call(t,r):n}var F={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function B(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];if(t||!r){return t}this._longDateFormat[e]=r.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)});return this._longDateFormat[e]}var H="Invalid date";function $(){return this._invalidDate}var W="%d";var U=/\d{1,2}/;function j(e){return this._ordinal.replace("%d",e)}var V={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function z(e,t,r,n){var i=this._relativeTime[r];return I(i)?i(e,t,r,n):i.replace(/%d/i,e)}function q(e,t){var r=this._relativeTime[e>0?"future":"past"];return I(r)?r(t):r.replace(/%s/i,t)}var Y={};function G(e,t){var r=e.toLowerCase();Y[r]=Y[r+"s"]=Y[t]=e}function X(e){return typeof e==="string"?Y[e]||Y[e.toLowerCase()]:undefined}function K(e){var t={},r,n;for(n in e){if(c(e,n)){r=X(n);if(r){t[r]=e[n]}}}return t}var J={};function Q(e,t){J[e]=t}function Z(e){var t=[];for(var r in e){t.push({unit:r,priority:J[r]})}t.sort(function(e,t){return e.priority-t.priority});return t}function ee(e,t,r){var n=""+Math.abs(e),i=t-n.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var te=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var re=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var ne={};var ie={};function ae(e,t,r,n){var i=n;if(typeof n==="string"){i=function(){return this[n]()}}if(e){ie[e]=i}if(t){ie[t[0]]=function(){return ee(i.apply(this,arguments),t[1],t[2])}}if(r){ie[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)}}}function oe(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function se(n){var i=n.match(te),e,a;for(e=0,a=i.length;e<a;e++){if(ie[i[e]]){i[e]=ie[i[e]]}else{i[e]=oe(i[e])}}return function(e){var t="",r;for(r=0;r<a;r++){t+=I(i[r])?i[r].call(e,n):i[r]}return t}}function le(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=ue(t,e.localeData());ne[t]=ne[t]||se(t);return ne[t](e)}function ue(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}re.lastIndex=0;while(r>=0&&re.test(e)){e=e.replace(re,n);re.lastIndex=0;r-=1}return e}var fe=/\d/;var ce=/\d\d/;var de=/\d{3}/;var he=/\d{4}/;var ve=/[+-]?\d{6}/;var pe=/\d\d?/;var ge=/\d\d\d\d?/;var me=/\d\d\d\d\d\d?/;var ye=/\d{1,3}/;var be=/\d{1,4}/;var we=/[+-]?\d{1,6}/;var Ce=/\d+/;var Se=/[+-]?\d+/;var Ee=/Z|[+-]\d\d:?\d\d/gi;var ke=/Z|[+-]\d\d(?::?\d\d)?/gi;var Te=/[+-]?\d+(\.\d{1,3})?/;var _e=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;var xe={};function De(e,r,n){xe[e]=I(r)?r:function(e,t){return e&&n?n:r}}function Re(e,t){if(!c(xe,e)){return new RegExp(Ie(e))}return xe[e](t._strict,t._locale)}function Ie(e){return Oe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,n,i){return t||r||n||i}))}function Oe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ae={};function Ne(e,r){var t,n=r;if(typeof e==="string"){e=[e]}if(f(r)){n=function(e,t){t[r]=k(e)}}for(t=0;t<e.length;t++){Ae[e[t]]=n}}function Me(e,i){Ne(e,function(e,t,r,n){r._w=r._w||{};i(e,r._w,r,n)})}function Le(e,t,r){if(t!=null&&c(Ae,e)){Ae[e](t,r._a,r,e)}}var Pe=0;var Fe=1;var Be=2;var He=3;var $e=4;var We=5;var Ue=6;var je=7;var Ve=8;ae("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e});ae(0,["YY",2],0,function(){return this.year()%100});ae(0,["YYYY",4],0,"year");ae(0,["YYYYY",5],0,"year");ae(0,["YYYYYY",6,true],0,"year");G("year","y");Q("year",1);De("Y",Se);De("YY",pe,ce);De("YYYY",be,he);De("YYYYY",we,ve);De("YYYYYY",we,ve);Ne(["YYYYY","YYYYYY"],Pe);Ne("YYYY",function(e,t){t[Pe]=e.length===2?u.parseTwoDigitYear(e):k(e)});Ne("YY",function(e,t){t[Pe]=u.parseTwoDigitYear(e)});Ne("Y",function(e,t){t[Pe]=parseInt(e,10)});function ze(e){return qe(e)?366:365}function qe(e){return e%4===0&&e%100!==0||e%400===0}u.parseTwoDigitYear=function(e){return k(e)+(k(e)>68?1900:2e3)};var Ye=Xe("FullYear",true);function Ge(){return qe(this.year())}function Xe(t,r){return function(e){if(e!=null){Je(this,t,e);u.updateOffset(this,r);return this}else{return Ke(this,t)}}}function Ke(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Je(e,t,r){if(e.isValid()&&!isNaN(r)){if(t==="FullYear"&&qe(e.year())&&e.month()===1&&e.date()===29){e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),rt(r,e.month()))}else{e._d["set"+(e._isUTC?"UTC":"")+t](r)}}}function Qe(e){e=X(e);if(I(this[e])){return this[e]()}return this}function Ze(e,t){if(typeof e==="object"){e=K(e);var r=Z(e);for(var n=0;n<r.length;n++){this[r[n].unit](e[r[n].unit])}}else{e=X(e);if(I(this[e])){return this[e](t)}}return this}function et(e,t){return(e%t+t)%t}var tt;if(Array.prototype.indexOf){tt=Array.prototype.indexOf}else{tt=function(e){var t;for(t=0;t<this.length;++t){if(this[t]===e){return t}}return-1}}function rt(e,t){if(isNaN(e)||isNaN(t)){return NaN}var r=et(t,12);e+=(t-r)/12;return r===1?qe(e)?29:28:31-r%7%2}ae("M",["MM",2],"Mo",function(){return this.month()+1});ae("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});ae("MMMM",0,0,function(e){return this.localeData().months(this,e)});G("month","M");Q("month",8);De("M",pe);De("MM",pe,ce);De("MMM",function(e,t){return t.monthsShortRegex(e)});De("MMMM",function(e,t){return t.monthsRegex(e)});Ne(["M","MM"],function(e,t){t[Fe]=k(e)-1});Ne(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);if(i!=null){t[Fe]=i}else{v(r).invalidMonth=e}});var nt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var it="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function at(e,t){if(!e){return o(this._months)?this._months:this._months["standalone"]}return o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nt).test(t)?"format":"standalone"][e.month()]}var ot="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function st(e,t){if(!e){return o(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nt.test(t)?"format":"standalone"][e.month()]}function lt(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(n=0;n<12;++n){a=h([2e3,n]);this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase();this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase()}}if(r){if(t==="MMM"){i=tt.call(this._shortMonthsParse,o);return i!==-1?i:null}else{i=tt.call(this._longMonthsParse,o);return i!==-1?i:null}}else{if(t==="MMM"){i=tt.call(this._shortMonthsParse,o);if(i!==-1){return i}i=tt.call(this._longMonthsParse,o);return i!==-1?i:null}else{i=tt.call(this._longMonthsParse,o);if(i!==-1){return i}i=tt.call(this._shortMonthsParse,o);return i!==-1?i:null}}}function ut(e,t,r){var n,i,a;if(this._monthsParseExact){return lt.call(this,e,t,r)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(n=0;n<12;n++){i=h([2e3,n]);if(r&&!this._longMonthsParse[n]){this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i");this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")}if(!r&&!this._monthsParse[n]){a="^"+this.months(i,"")+"|^"+this.monthsShort(i,"");this._monthsParse[n]=new RegExp(a.replace(".",""),"i")}if(r&&t==="MMMM"&&this._longMonthsParse[n].test(e)){return n}else if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e)){return n}else if(!r&&this._monthsParse[n].test(e)){return n}}}function ft(e,t){var r;if(!e.isValid()){return e}if(typeof t==="string"){if(/^\d+$/.test(t)){t=k(t)}else{t=e.localeData().monthsParse(t);if(!f(t)){return e}}}r=Math.min(e.date(),rt(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r);return e}function ct(e){if(e!=null){ft(this,e);u.updateOffset(this,true);return this}else{return Ke(this,"Month")}}function dt(){return rt(this.year(),this.month())}var ht=_e;function vt(e){if(this._monthsParseExact){if(!c(this,"_monthsRegex")){mt.call(this)}if(e){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!c(this,"_monthsShortRegex")){this._monthsShortRegex=ht}return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}var pt=_e;function gt(e){if(this._monthsParseExact){if(!c(this,"_monthsRegex")){mt.call(this)}if(e){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!c(this,"_monthsRegex")){this._monthsRegex=pt}return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function mt(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],i,a;for(i=0;i<12;i++){a=h([2e3,i]);t.push(this.monthsShort(a,""));r.push(this.months(a,""));n.push(this.months(a,""));n.push(this.monthsShort(a,""))}t.sort(e);r.sort(e);n.sort(e);for(i=0;i<12;i++){t[i]=Oe(t[i]);r[i]=Oe(r[i])}for(i=0;i<24;i++){n[i]=Oe(n[i])}this._monthsRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function yt(e,t,r,n,i,a,o){var s;if(e<100&&e>=0){s=new Date(e+400,t,r,n,i,a,o);if(isFinite(s.getFullYear())){s.setFullYear(e)}}else{s=new Date(e,t,r,n,i,a,o)}return s}function bt(e){var t;if(e<100&&e>=0){var r=Array.prototype.slice.call(arguments);r[0]=e+400;t=new Date(Date.UTC.apply(null,r));if(isFinite(t.getUTCFullYear())){t.setUTCFullYear(e)}}else{t=new Date(Date.UTC.apply(null,arguments))}return t}function wt(e,t,r){var n=7+t-r,i=(7+bt(e,0,n).getUTCDay()-t)%7;return-i+n-1}function Ct(e,t,r,n,i){var a=(7+r-n)%7,o=wt(e,n,i),s=1+7*(t-1)+a+o,l,u;if(s<=0){l=e-1;u=ze(l)+s}else if(s>ze(e)){l=e+1;u=s-ze(e)}else{l=e;u=s}return{year:l,dayOfYear:u}}function St(e,t,r){var n=wt(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;if(i<1){o=e.year()-1;a=i+Et(o,t,r)}else if(i>Et(e.year(),t,r)){a=i-Et(e.year(),t,r);o=e.year()+1}else{o=e.year();a=i}return{week:a,year:o}}function Et(e,t,r){var n=wt(e,t,r),i=wt(e+1,t,r);return(ze(e)-n+i)/7}ae("w",["ww",2],"wo","week");ae("W",["WW",2],"Wo","isoWeek");G("week","w");G("isoWeek","W");Q("week",5);Q("isoWeek",5);De("w",pe);De("ww",pe,ce);De("W",pe);De("WW",pe,ce);Me(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=k(e)});function kt(e){return St(e,this._week.dow,this._week.doy).week}var Tt={dow:0,doy:6};function _t(){return this._week.dow}function xt(){return this._week.doy}function Dt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Rt(e){var t=St(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}ae("d",0,"do","day");ae("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});ae("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});ae("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});ae("e",0,0,"weekday");ae("E",0,0,"isoWeekday");G("day","d");G("weekday","e");G("isoWeekday","E");Q("day",11);Q("weekday",11);Q("isoWeekday",11);De("d",pe);De("e",pe);De("E",pe);De("dd",function(e,t){return t.weekdaysMinRegex(e)});De("ddd",function(e,t){return t.weekdaysShortRegex(e)});De("dddd",function(e,t){return t.weekdaysRegex(e)});Me(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);if(i!=null){t.d=i}else{v(r).invalidWeekday=e}});Me(["d","e","E"],function(e,t,r,n){t[n]=k(e)});function It(e,t){if(typeof e!=="string"){return e}if(!isNaN(e)){return parseInt(e,10)}e=t.weekdaysParse(e);if(typeof e==="number"){return e}return null}function Ot(e,t){if(typeof e==="string"){return t.weekdaysParse(e)%7||7}return isNaN(e)?null:e}function At(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Nt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Mt(e,t){var r=o(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?At(r,this._week.dow):e?r[e.day()]:r}var Lt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Pt(e){return e===true?At(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}var Ft="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Bt(e){return e===true?At(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ht(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(n=0;n<7;++n){a=h([2e3,1]).day(n);this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase();this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase();this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase()}}if(r){if(t==="dddd"){i=tt.call(this._weekdaysParse,o);return i!==-1?i:null}else if(t==="ddd"){i=tt.call(this._shortWeekdaysParse,o);return i!==-1?i:null}else{i=tt.call(this._minWeekdaysParse,o);return i!==-1?i:null}}else{if(t==="dddd"){i=tt.call(this._weekdaysParse,o);if(i!==-1){return i}i=tt.call(this._shortWeekdaysParse,o);if(i!==-1){return i}i=tt.call(this._minWeekdaysParse,o);return i!==-1?i:null}else if(t==="ddd"){i=tt.call(this._shortWeekdaysParse,o);if(i!==-1){return i}i=tt.call(this._weekdaysParse,o);if(i!==-1){return i}i=tt.call(this._minWeekdaysParse,o);return i!==-1?i:null}else{i=tt.call(this._minWeekdaysParse,o);if(i!==-1){return i}i=tt.call(this._weekdaysParse,o);if(i!==-1){return i}i=tt.call(this._shortWeekdaysParse,o);return i!==-1?i:null}}}function $t(e,t,r){var n,i,a;if(this._weekdaysParseExact){return Ht.call(this,e,t,r)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(n=0;n<7;n++){i=h([2e3,1]).day(n);if(r&&!this._fullWeekdaysParse[n]){this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[n]){a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,"");this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")}if(r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e)){return n}else if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e)){return n}else if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e)){return n}else if(!r&&this._weekdaysParse[n].test(e)){return n}}}function Wt(e){if(!this.isValid()){return e!=null?this:NaN}var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=It(e,this.localeData());return this.add(e-t,"d")}else{return t}}function Ut(e){if(!this.isValid()){return e!=null?this:NaN}var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function jt(e){if(!this.isValid()){return e!=null?this:NaN}if(e!=null){var t=Ot(e,this.localeData());return this.day(this.day()%7?t:t-7)}else{return this.day()||7}}var Vt=_e;function zt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!c(this,"_weekdaysRegex")){this._weekdaysRegex=Vt}return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}var qt=_e;function Yt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!c(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=qt}return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var Gt=_e;function Xt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!c(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=Gt}return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function Kt(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++){o=h([2e3,1]).day(a);s=this.weekdaysMin(o,"");l=this.weekdaysShort(o,"");u=this.weekdays(o,"");t.push(s);r.push(l);n.push(u);i.push(s);i.push(l);i.push(u)}t.sort(e);r.sort(e);n.sort(e);i.sort(e);for(a=0;a<7;a++){r[a]=Oe(r[a]);n[a]=Oe(n[a]);i[a]=Oe(i[a])}this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Jt(){return this.hours()%12||12}function Qt(){return this.hours()||24}ae("H",["HH",2],0,"hour");ae("h",["hh",2],0,Jt);ae("k",["kk",2],0,Qt);ae("hmm",0,0,function(){return""+Jt.apply(this)+ee(this.minutes(),2)});ae("hmmss",0,0,function(){return""+Jt.apply(this)+ee(this.minutes(),2)+ee(this.seconds(),2)});ae("Hmm",0,0,function(){return""+this.hours()+ee(this.minutes(),2)});ae("Hmmss",0,0,function(){return""+this.hours()+ee(this.minutes(),2)+ee(this.seconds(),2)});function Zt(e,t){ae(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}Zt("a",true);Zt("A",false);G("hour","h");Q("hour",13);function er(e,t){return t._meridiemParse}De("a",er);De("A",er);De("H",pe);De("h",pe);De("k",pe);De("HH",pe,ce);De("hh",pe,ce);De("kk",pe,ce);De("hmm",ge);De("hmmss",me);De("Hmm",ge);De("Hmmss",me);Ne(["H","HH"],He);Ne(["k","kk"],function(e,t,r){var n=k(e);t[He]=n===24?0:n});Ne(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e);r._meridiem=e});Ne(["h","hh"],function(e,t,r){t[He]=k(e);v(r).bigHour=true});Ne("hmm",function(e,t,r){var n=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n));v(r).bigHour=true});Ne("hmmss",function(e,t,r){var n=e.length-4;var i=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n,2));t[We]=k(e.substr(i));v(r).bigHour=true});Ne("Hmm",function(e,t,r){var n=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n))});Ne("Hmmss",function(e,t,r){var n=e.length-4;var i=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n,2));t[We]=k(e.substr(i))});function tr(e){return(e+"").toLowerCase().charAt(0)==="p"}var rr=/[ap]\.?m?\.?/i;function nr(e,t,r){if(e>11){return r?"pm":"PM"}else{return r?"am":"AM"}}var ir=Xe("Hours",true);var ar={calendar:L,longDateFormat:F,invalidDate:H,ordinal:W,dayOfMonthOrdinalParse:U,relativeTime:V,months:it,monthsShort:ot,week:Tt,weekdays:Nt,weekdaysMin:Ft,weekdaysShort:Lt,meridiemParse:rr};var or={};var sr={};var lr;function ur(e){return e?e.toLowerCase().replace("_","-"):e}function fr(e){var t=0,r,n,i,a;while(t<e.length){a=ur(e[t]).split("-");r=a.length;n=ur(e[t+1]);n=n?n.split("-"):null;while(r>0){i=cr(a.slice(0,r).join("-"));if(i){return i}if(n&&n.length>=r&&T(a,n,true)>=r-1){break}r--}t++}return lr}function cr(e){var t=null;if(!or[e]&&typeof Ha!=="undefined"&&Ha&&Ha.exports){try{t=lr._abbr;var r=$a;Wa(444)("./"+e);dr(t)}catch(e){}}return or[e]}function dr(e,t){var r;if(e){if(a(t)){r=pr(e)}else{r=hr(e,t)}if(r){lr=r}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+e+" not found. Did you forget to load it?")}}}return lr._abbr}function hr(e,t){if(t!==null){var r,n=ar;t.abbr=e;if(or[e]!=null){R("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");n=or[e]._config}else if(t.parentLocale!=null){if(or[t.parentLocale]!=null){n=or[t.parentLocale]._config}else{r=cr(t.parentLocale);if(r!=null){n=r._config}else{if(!sr[t.parentLocale]){sr[t.parentLocale]=[]}sr[t.parentLocale].push({name:e,config:t});return null}}}or[e]=new N(A(n,t));if(sr[e]){sr[e].forEach(function(e){hr(e.name,e.config)})}dr(e);return or[e]}else{delete or[e];return null}}function vr(e,t){if(t!=null){var r,n,i=ar;n=cr(e);if(n!=null){i=n._config}t=A(i,t);r=new N(t);r.parentLocale=or[e];or[e]=r;dr(e)}else{if(or[e]!=null){if(or[e].parentLocale!=null){or[e]=or[e].parentLocale}else if(or[e]!=null){delete or[e]}}}return or[e]}function pr(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return lr}if(!o(e)){t=cr(e);if(t){return t}e=[e]}return fr(e)}function gr(){return M(or)}function mr(e){var t;var r=e._a;if(r&&v(e).overflow===-2){t=r[Fe]<0||r[Fe]>11?Fe:r[Be]<1||r[Be]>rt(r[Pe],r[Fe])?Be:r[He]<0||r[He]>24||r[He]===24&&(r[$e]!==0||r[We]!==0||r[Ue]!==0)?He:r[$e]<0||r[$e]>59?$e:r[We]<0||r[We]>59?We:r[Ue]<0||r[Ue]>999?Ue:-1;if(v(e)._overflowDayOfYear&&(t<Pe||t>Be)){t=Be}if(v(e)._overflowWeeks&&t===-1){t=je}if(v(e)._overflowWeekday&&t===-1){t=Ve}v(e).overflow=t}return e}function yr(e,t,r){if(e!=null){return e}if(t!=null){return t}return r}function br(e){var t=new Date(u.now());if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}return[t.getFullYear(),t.getMonth(),t.getDate()]}function wr(e){var t,r,n=[],i,a,o;if(e._d){return}i=br(e);if(e._w&&e._a[Be]==null&&e._a[Fe]==null){Cr(e)}if(e._dayOfYear!=null){o=yr(e._a[Pe],i[Pe]);if(e._dayOfYear>ze(o)||e._dayOfYear===0){v(e)._overflowDayOfYear=true}r=bt(o,0,e._dayOfYear);e._a[Fe]=r.getUTCMonth();e._a[Be]=r.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=n[t]=i[t]}for(;t<7;t++){e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[He]===24&&e._a[$e]===0&&e._a[We]===0&&e._a[Ue]===0){e._nextDay=true;e._a[He]=0}e._d=(e._useUTC?bt:yt).apply(null,n);a=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[He]=24}if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==a){v(e).weekdayMismatch=true}}function Cr(e){var t,r,n,i,a,o,s,l;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){a=1;o=4;r=yr(t.GG,e._a[Pe],St(qr(),1,4).year);n=yr(t.W,1);i=yr(t.E,1);if(i<1||i>7){l=true}}else{a=e._locale._week.dow;o=e._locale._week.doy;var u=St(qr(),a,o);r=yr(t.gg,e._a[Pe],u.year);n=yr(t.w,u.week);if(t.d!=null){i=t.d;if(i<0||i>6){l=true}}else if(t.e!=null){i=t.e+a;if(t.e<0||t.e>6){l=true}}else{i=a}}if(n<1||n>Et(r,a,o)){v(e)._overflowWeeks=true}else if(l!=null){v(e)._overflowWeekday=true}else{s=Ct(r,n,i,a,o);e._a[Pe]=s.year;e._dayOfYear=s.dayOfYear}}var Sr=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var Er=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var kr=/Z|[+-]\d\d(?::?\d\d)?/;var Tr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]];var _r=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]];var xr=/^\/?Date\((\-?\d+)/i;function Dr(e){var t,r,n=e._i,i=Sr.exec(n)||Er.exec(n),a,o,s,l;if(i){v(e).iso=true;for(t=0,r=Tr.length;t<r;t++){if(Tr[t][1].exec(i[1])){o=Tr[t][0];a=Tr[t][2]!==false;break}}if(o==null){e._isValid=false;return}if(i[3]){for(t=0,r=_r.length;t<r;t++){if(_r[t][1].exec(i[3])){s=(i[2]||" ")+_r[t][0];break}}if(s==null){e._isValid=false;return}}if(!a&&s!=null){e._isValid=false;return}if(i[4]){if(kr.exec(i[4])){l="Z"}else{e._isValid=false;return}}e._f=o+(s||"")+(l||"");Br(e)}else{e._isValid=false}}var Rr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Ir(e,t,r,n,i,a){var o=[Or(e),ot.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];if(a){o.push(parseInt(a,10))}return o}function Or(e){var t=parseInt(e,10);if(t<=49){return 2e3+t}else if(t<=999){return 1900+t}return t}function Ar(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Nr(e,t,r){if(e){var n=Lt.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i){v(r).weekdayMismatch=true;r._isValid=false;return false}}return true}var Mr={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Lr(e,t,r){if(e){return Mr[e]}else if(t){return 0}else{var n=parseInt(r,10);var i=n%100,a=(n-i)/100;return a*60+i}}function Pr(e){var t=Rr.exec(Ar(e._i));if(t){var r=Ir(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Nr(t[1],r,e)){return}e._a=r;e._tzm=Lr(t[8],t[9],t[10]);e._d=bt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);v(e).rfc2822=true}else{e._isValid=false}}function Fr(e){var t=xr.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}Dr(e);if(e._isValid===false){delete e._isValid}else{return}Pr(e);if(e._isValid===false){delete e._isValid}else{return}u.createFromInputFallback(e)}u.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});u.ISO_8601=function(){};u.RFC_2822=function(){};function Br(e){if(e._f===u.ISO_8601){Dr(e);return}if(e._f===u.RFC_2822){Pr(e);return}e._a=[];v(e).empty=true;var t=""+e._i,r,n,i,a,o,s=t.length,l=0;i=ue(e._f,e._locale).match(te)||[];for(r=0;r<i.length;r++){a=i[r];n=(t.match(Re(a,e))||[])[0];if(n){o=t.substr(0,t.indexOf(n));if(o.length>0){v(e).unusedInput.push(o)}t=t.slice(t.indexOf(n)+n.length);l+=n.length}if(ie[a]){if(n){v(e).empty=false}else{v(e).unusedTokens.push(a)}Le(a,n,e)}else if(e._strict&&!n){v(e).unusedTokens.push(a)}}v(e).charsLeftOver=s-l;if(t.length>0){v(e).unusedInput.push(t)}if(e._a[He]<=12&&v(e).bigHour===true&&e._a[He]>0){v(e).bigHour=undefined}v(e).parsedDateParts=e._a.slice(0);v(e).meridiem=e._meridiem;e._a[He]=Hr(e._locale,e._a[He],e._meridiem);wr(e);mr(e)}function Hr(e,t,r){var n;if(r==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,r)}else if(e.isPM!=null){n=e.isPM(r);if(n&&t<12){t+=12}if(!n&&t===12){t=0}return t}else{return t}}function $r(e){var t,r,n,i,a;if(e._f.length===0){v(e).invalidFormat=true;e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){a=0;t=b({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._f=e._f[i];Br(t);if(!g(t)){continue}a+=v(t).charsLeftOver;a+=v(t).unusedTokens.length*10;v(t).score=a;if(n==null||a<n){n=a;r=t}}d(e,r||t)}function Wr(e){if(e._d){return}var t=K(e._i);e._a=r([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});wr(e)}function Ur(e){var t=new C(mr(jr(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function jr(e){var t=e._i,r=e._f;e._locale=e._locale||pr(e._l);if(t===null||r===undefined&&t===""){return m({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(S(t)){return new C(mr(t))}else if(i(t)){e._d=t}else if(o(r)){$r(e)}else if(r){Br(e)}else{Vr(e)}if(!g(e)){e._d=null}return e}function Vr(e){var t=e._i;if(a(t)){e._d=new Date(u.now())}else if(i(t)){e._d=new Date(t.valueOf())}else if(typeof t==="string"){Fr(e)}else if(o(t)){e._a=r(t.slice(0),function(e){return parseInt(e,10)});wr(e)}else if(s(t)){Wr(e)}else if(f(t)){e._d=new Date(t)}else{u.createFromInputFallback(e)}}function zr(e,t,r,n,i){var a={};if(r===true||r===false){n=r;r=undefined}if(s(e)&&l(e)||o(e)&&e.length===0){e=undefined}a._isAMomentObject=true;a._useUTC=a._isUTC=i;a._l=r;a._i=e;a._f=t;a._strict=n;return Ur(a)}function qr(e,t,r,n){return zr(e,t,r,n,false)}var Yr=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qr.apply(null,arguments);if(this.isValid()&&e.isValid()){return e<this?this:e}else{return m()}});var Gr=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qr.apply(null,arguments);if(this.isValid()&&e.isValid()){return e>this?this:e}else{return m()}});function Xr(e,t){var r,n;if(t.length===1&&o(t[0])){t=t[0]}if(!t.length){return qr()}r=t[0];for(n=1;n<t.length;++n){if(!t[n].isValid()||t[n][e](r)){r=t[n]}}return r}function Kr(){var e=[].slice.call(arguments,0);return Xr("isBefore",e)}function Jr(){var e=[].slice.call(arguments,0);return Xr("isAfter",e)}var Qr=function(){return Date.now?Date.now():+new Date};var Zr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function en(e){for(var t in e){if(!(tt.call(Zr,t)!==-1&&(e[t]==null||!isNaN(e[t])))){return false}}var r=false;for(var n=0;n<Zr.length;++n){if(e[Zr[n]]){if(r){return false}if(parseFloat(e[Zr[n]])!==k(e[Zr[n]])){r=true}}}return true}function tn(){return this._isValid}function rn(){return Tn(NaN)}function nn(e){var t=K(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=en(t);this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60;this._days=+o+a*7;this._months=+i+n*3+r*12;this._data={};this._locale=pr();this._bubble()}function an(e){return e instanceof nn}function on(e){if(e<0){return Math.round(-1*e)*-1}else{return Math.round(e)}}function sn(e,r){ae(e,0,0,function(){var e=this.utcOffset();var t="+";if(e<0){e=-e;t="-"}return t+ee(~~(e/60),2)+r+ee(~~e%60,2)})}sn("Z",":");sn("ZZ","");De("Z",ke);De("ZZ",ke);Ne(["Z","ZZ"],function(e,t,r){r._useUTC=true;r._tzm=un(ke,e)});var ln=/([\+\-]|\d\d)/gi;function un(e,t){var r=(t||"").match(e);if(r===null){return null}var n=r[r.length-1]||[];var i=(n+"").match(ln)||["-",0,0];var a=+(i[1]*60)+k(i[2]);return a===0?0:i[0]==="+"?a:-a}function fn(e,t){var r,n;if(t._isUTC){r=t.clone();n=(S(e)||i(e)?e.valueOf():qr(e).valueOf())-r.valueOf();r._d.setTime(r._d.valueOf()+n);u.updateOffset(r,false);return r}else{return qr(e).local()}}function cn(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}u.updateOffset=function(){};function dn(e,t,r){var n=this._offset||0,i;if(!this.isValid()){return e!=null?this:NaN}if(e!=null){if(typeof e==="string"){e=un(ke,e);if(e===null){return this}}else if(Math.abs(e)<16&&!r){e=e*60}if(!this._isUTC&&t){i=cn(this)}this._offset=e;this._isUTC=true;if(i!=null){this.add(i,"m")}if(n!==e){if(!t||this._changeInProgress){In(this,Tn(e-n,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;u.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?n:cn(this)}}function hn(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}function vn(e){return this.utcOffset(0,e)}function pn(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(cn(this),"m")}}return this}function gn(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var e=un(Ee,this._i);if(e!=null){this.utcOffset(e)}else{this.utcOffset(0,true)}}return this}function mn(e){if(!this.isValid()){return false}e=e?qr(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function yn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bn(){if(!a(this._isDSTShifted)){return this._isDSTShifted}var e={};b(e,this);e=jr(e);if(e._a){var t=e._isUTC?h(e._a):qr(e._a);this._isDSTShifted=this.isValid()&&T(e._a,t.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function wn(){return this.isValid()?!this._isUTC:false}function Cn(){return this.isValid()?this._isUTC:false}function Sn(){return this.isValid()?this._isUTC&&this._offset===0:false}var En=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var kn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Tn(e,t){var r=e,n=null,i,a,o;if(an(e)){r={ms:e._milliseconds,d:e._days,M:e._months}}else if(f(e)){r={};if(t){r[t]=e}else{r.milliseconds=e}}else if(!!(n=En.exec(e))){i=n[1]==="-"?-1:1;r={y:0,d:k(n[Be])*i,h:k(n[He])*i,m:k(n[$e])*i,s:k(n[We])*i,ms:k(on(n[Ue]*1e3))*i}}else if(!!(n=kn.exec(e))){i=n[1]==="-"?-1:1;r={y:_n(n[2],i),M:_n(n[3],i),w:_n(n[4],i),d:_n(n[5],i),h:_n(n[6],i),m:_n(n[7],i),s:_n(n[8],i)}}else if(r==null){r={}}else if(typeof r==="object"&&("from"in r||"to"in r)){o=Dn(qr(r.from),qr(r.to));r={};r.ms=o.milliseconds;r.M=o.months}a=new nn(r);if(an(e)&&c(e,"_locale")){a._locale=e._locale}return a}Tn.fn=nn.prototype;Tn.invalid=rn;function _n(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function xn(e,t){var r={};r.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(r.months,"M").isAfter(t)){--r.months}r.milliseconds=+t-+e.clone().add(r.months,"M");return r}function Dn(e,t){var r;if(!(e.isValid()&&t.isValid())){return{milliseconds:0,months:0}}t=fn(t,e);if(e.isBefore(t)){r=xn(e,t)}else{r=xn(t,e);r.milliseconds=-r.milliseconds;r.months=-r.months}return r}function Rn(i,a){return function(e,t){var r,n;if(t!==null&&!isNaN(+t)){R(a,"moment()."+a+"(period, number) is deprecated. Please use moment()."+a+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");n=e;e=t;t=n}e=typeof e==="string"?+e:e;r=Tn(e,t);In(this,r,i);return this}}function In(e,t,r,n){var i=t._milliseconds,a=on(t._days),o=on(t._months);if(!e.isValid()){return}n=n==null?true:n;if(o){ft(e,Ke(e,"Month")+o*r)}if(a){Je(e,"Date",Ke(e,"Date")+a*r)}if(i){e._d.setTime(e._d.valueOf()+i*r)}if(n){u.updateOffset(e,a||o)}}var On=Rn(1,"add");var An=Rn(-1,"subtract");function Nn(e,t){var r=e.diff(t,"days",true);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Mn(e,t){var r=e||qr(),n=fn(r,this).startOf("day"),i=u.calendarFormat(this,n)||"sameElse";var a=t&&(I(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,qr(r)))}function Ln(){return new C(this)}function Pn(e,t){var r=S(e)?e:qr(e);if(!(this.isValid()&&r.isValid())){return false}t=X(t)||"millisecond";if(t==="millisecond"){return this.valueOf()>r.valueOf()}else{return r.valueOf()<this.clone().startOf(t).valueOf()}}function Fn(e,t){var r=S(e)?e:qr(e);if(!(this.isValid()&&r.isValid())){return false}t=X(t)||"millisecond";if(t==="millisecond"){return this.valueOf()<r.valueOf()}else{return this.clone().endOf(t).valueOf()<r.valueOf()}}function Bn(e,t,r,n){var i=S(e)?e:qr(e),a=S(t)?t:qr(t);if(!(this.isValid()&&i.isValid()&&a.isValid())){return false}n=n||"()";return(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))}function Hn(e,t){var r=S(e)?e:qr(e),n;if(!(this.isValid()&&r.isValid())){return false}t=X(t)||"millisecond";if(t==="millisecond"){return this.valueOf()===r.valueOf()}else{n=r.valueOf();return this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()}}function $n(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Wn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Un(e,t,r){var n,i,a;if(!this.isValid()){return NaN}n=fn(e,this);if(!n.isValid()){return NaN}i=(n.utcOffset()-this.utcOffset())*6e4;t=X(t);switch(t){case"year":a=jn(this,n)/12;break;case"month":a=jn(this,n);break;case"quarter":a=jn(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:E(a)}function jn(e,t){var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,a;if(t-n<0){i=e.clone().add(r-1,"months");a=(t-n)/(n-i)}else{i=e.clone().add(r+1,"months");a=(t-n)/(i-n)}return-(r+a)||0}u.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";u.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Vn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function zn(e){if(!this.isValid()){return null}var t=e!==true;var r=t?this.clone().utc():this;if(r.year()<0||r.year()>9999){return le(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(I(Date.prototype.toISOString)){if(t){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",le(r,"Z"))}}return le(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function qn(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var e="moment";var t="";if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}var r="["+e+'("]';var n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var i="-MM-DD[T]HH:mm:ss.SSS";var a=t+'[")]';return this.format(r+n+i+a)}function Yn(e){if(!e){e=this.isUtc()?u.defaultFormatUtc:u.defaultFormat}var t=le(this,e);return this.localeData().postformat(t)}function Gn(e,t){if(this.isValid()&&(S(e)&&e.isValid()||qr(e).isValid())){return Tn({to:this,from:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function Xn(e){return this.from(qr(),e)}function Kn(e,t){if(this.isValid()&&(S(e)&&e.isValid()||qr(e).isValid())){return Tn({from:this,to:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function Jn(e){return this.to(qr(),e)}function Qn(e){var t;if(e===undefined){return this._locale._abbr}else{t=pr(e);if(t!=null){this._locale=t}return this}}var Zn=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined){return this.localeData()}else{return this.locale(e)}});function ei(){return this._locale}var ti=1e3;var ri=60*ti;var ni=60*ri;var ii=(365*400+97)*24*ni;function ai(e,t){return(e%t+t)%t}function oi(e,t,r){if(e<100&&e>=0){return new Date(e+400,t,r)-ii}else{return new Date(e,t,r).valueOf()}}function si(e,t,r){if(e<100&&e>=0){return Date.UTC(e+400,t,r)-ii}else{return Date.UTC(e,t,r)}}function li(e){var t;e=X(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}var r=this._isUTC?si:oi;switch(e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=ai(t+(this._isUTC?0:this.utcOffset()*ri),ni);break;case"minute":t=this._d.valueOf();t-=ai(t,ri);break;case"second":t=this._d.valueOf();t-=ai(t,ti);break}this._d.setTime(t);u.updateOffset(this,true);return this}function ui(e){var t;e=X(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}var r=this._isUTC?si:oi;switch(e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=ni-ai(t+(this._isUTC?0:this.utcOffset()*ri),ni)-1;break;case"minute":t=this._d.valueOf();t+=ri-ai(t,ri)-1;break;case"second":t=this._d.valueOf();t+=ti-ai(t,ti)-1;break}this._d.setTime(t);u.updateOffset(this,true);return this}function fi(){return this._d.valueOf()-(this._offset||0)*6e4}function ci(){return Math.floor(this.valueOf()/1e3)}function di(){return new Date(this.valueOf())}function hi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function vi(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function pi(){return this.isValid()?this.toISOString():null}function gi(){return g(this)}function mi(){return d({},v(this))}function yi(){return v(this).overflow}function bi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ae(0,["gg",2],0,function(){return this.weekYear()%100});ae(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wi(e,t){ae(0,[e,e.length],0,t)}wi("gggg","weekYear");wi("ggggg","weekYear");wi("GGGG","isoWeekYear");wi("GGGGG","isoWeekYear");G("weekYear","gg");G("isoWeekYear","GG");Q("weekYear",1);Q("isoWeekYear",1);De("G",Se);De("g",Se);De("GG",pe,ce);De("gg",pe,ce);De("GGGG",be,he);De("gggg",be,he);De("GGGGG",we,ve);De("ggggg",we,ve);Me(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=k(e)});Me(["gg","GG"],function(e,t,r,n){t[n]=u.parseTwoDigitYear(e)});function Ci(e){return Ti.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Si(e){return Ti.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ei(){return Et(this.year(),1,4)}function ki(){var e=this.localeData()._week;return Et(this.year(),e.dow,e.doy)}function Ti(e,t,r,n,i){var a;if(e==null){return St(this,n,i).year}else{a=Et(e,n,i);if(t>a){t=a}return _i.call(this,e,t,r,n,i)}}function _i(e,t,r,n,i){var a=Ct(e,t,r,n,i),o=bt(a.year,0,a.dayOfYear);this.year(o.getUTCFullYear());this.month(o.getUTCMonth());this.date(o.getUTCDate());return this}ae("Q",0,"Qo","quarter");G("quarter","Q");Q("quarter",7);De("Q",fe);Ne("Q",function(e,t){t[Fe]=(k(e)-1)*3});function xi(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}ae("D",["DD",2],"Do","date");G("date","D");Q("date",9);De("D",pe);De("DD",pe,ce);De("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Ne(["D","DD"],Be);Ne("Do",function(e,t){t[Be]=k(e.match(pe)[0])});var Di=Xe("Date",true);ae("DDD",["DDDD",3],"DDDo","dayOfYear");G("dayOfYear","DDD");Q("dayOfYear",4);De("DDD",ye);De("DDDD",de);Ne(["DDD","DDDD"],function(e,t,r){r._dayOfYear=k(e)});function Ri(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}ae("m",["mm",2],0,"minute");G("minute","m");Q("minute",14);De("m",pe);De("mm",pe,ce);Ne(["m","mm"],$e);var Ii=Xe("Minutes",false);ae("s",["ss",2],0,"second");G("second","s");Q("second",15);De("s",pe);De("ss",pe,ce);Ne(["s","ss"],We);var Oi=Xe("Seconds",false);ae("S",0,0,function(){return~~(this.millisecond()/100)});ae(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ae(0,["SSS",3],0,"millisecond");ae(0,["SSSS",4],0,function(){return this.millisecond()*10});ae(0,["SSSSS",5],0,function(){return this.millisecond()*100});ae(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ae(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ae(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ae(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});G("millisecond","ms");Q("millisecond",16);De("S",ye,fe);De("SS",ye,ce);De("SSS",ye,de);var Ai;for(Ai="SSSS";Ai.length<=9;Ai+="S"){De(Ai,Ce)}function Ni(e,t){t[Ue]=k(("0."+e)*1e3)}for(Ai="S";Ai.length<=9;Ai+="S"){Ne(Ai,Ni)}var Mi=Xe("Milliseconds",false);ae("z",0,0,"zoneAbbr");ae("zz",0,0,"zoneName");function Li(){return this._isUTC?"UTC":""}function Pi(){return this._isUTC?"Coordinated Universal Time":""}var Fi=C.prototype;Fi.add=On;Fi.calendar=Mn;Fi.clone=Ln;Fi.diff=Un;Fi.endOf=ui;Fi.format=Yn;Fi.from=Gn;Fi.fromNow=Xn;Fi.to=Kn;Fi.toNow=Jn;Fi.get=Qe;Fi.invalidAt=yi;Fi.isAfter=Pn;Fi.isBefore=Fn;Fi.isBetween=Bn;Fi.isSame=Hn;Fi.isSameOrAfter=$n;Fi.isSameOrBefore=Wn;Fi.isValid=gi;Fi.lang=Zn;Fi.locale=Qn;Fi.localeData=ei;Fi.max=Gr;Fi.min=Yr;Fi.parsingFlags=mi;Fi.set=Ze;Fi.startOf=li;Fi.subtract=An;Fi.toArray=hi;Fi.toObject=vi;Fi.toDate=di;Fi.toISOString=zn;Fi.inspect=qn;Fi.toJson=pi;Fi.toString=Vn;Fi.unix=ci;Fi.valueOf=fi;Fi.creationData=bi;Fi.year=Ye;Fi.isLeapYear=Ge;Fi.weekYear=Ci;Fi.isoWeekYear=Si;Fi.quarter=Fi.quarters=xi;Fi.month=ct;Fi.daysInMonth=dt;Fi.week=Fi.weeks=Dt;Fi.isoWeek=Fi.isoWeeks=Rt;Fi.weeksInYear=ki;Fi.isoWeeksInYear=Ei;Fi.date=Di;Fi.day=Fi.days=Wt;Fi.weekday=Ut;Fi.isoWeekday=jt;Fi.dayOfYear=Ri;Fi.hour=Fi.hours=ir;Fi.minute=Fi.minutes=Ii;Fi.second=Fi.seconds=Oi;Fi.millisecond=Fi.milliseconds=Mi;Fi.utcOffset=dn;Fi.utc=vn;Fi.local=pn;Fi.parseZone=gn;Fi.hasAlignedHourOffset=mn;Fi.isDST=yn;Fi.isLocal=wn;Fi.isUtcOffset=Cn;Fi.isUtc=Sn;Fi.isUTC=Sn;Fi.zoneAbbr=Li;Fi.zoneName=Pi;Fi.dates=x("dates accessor is deprecated. Use date instead.",Di);Fi.months=x("months accessor is deprecated. Use month instead",ct);Fi.years=x("years accessor is deprecated. Use year instead",Ye);Fi.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hn);Fi.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bn);function Bi(e){return qr(e*1e3)}function Hi(){return qr.apply(null,arguments).parseZone()}function $i(e){return e}var Wi=N.prototype;Wi.calendar=P;Wi.longDateFormat=B;Wi.invalidDate=$;Wi.ordinal=j;Wi.preparse=$i;Wi.postformat=$i;Wi.relativeTime=z;Wi.pastFuture=q;Wi.set=O;Wi.months=at;Wi.monthsShort=st;Wi.monthsParse=ut;Wi.monthsRegex=gt;Wi.monthsShortRegex=vt;Wi.week=kt;Wi.firstDayOfYear=xt;Wi.firstDayOfWeek=_t;Wi.weekdays=Mt;Wi.weekdaysMin=Bt;Wi.weekdaysShort=Pt;Wi.weekdaysParse=$t;Wi.weekdaysRegex=zt;Wi.weekdaysShortRegex=Yt;Wi.weekdaysMinRegex=Xt;Wi.isPM=tr;Wi.meridiem=nr;function Ui(e,t,r,n){var i=pr();var a=h().set(n,t);return i[r](a,e)}function ji(e,t,r){if(f(e)){t=e;e=undefined}e=e||"";if(t!=null){return Ui(e,t,r,"month")}var n;var i=[];for(n=0;n<12;n++){i[n]=Ui(e,n,r,"month")}return i}function Vi(e,t,r,n){if(typeof e==="boolean"){if(f(t)){r=t;t=undefined}t=t||""}else{t=e;r=t;e=false;if(f(t)){r=t;t=undefined}t=t||""}var i=pr(),a=e?i._week.dow:0;if(r!=null){return Ui(t,(r+a)%7,n,"day")}var o;var s=[];for(o=0;o<7;o++){s[o]=Ui(t,(o+a)%7,n,"day")}return s}function zi(e,t){return ji(e,t,"months")}function qi(e,t){return ji(e,t,"monthsShort")}function Yi(e,t,r){return Vi(e,t,r,"weekdays")}function Gi(e,t,r){return Vi(e,t,r,"weekdaysShort")}function Xi(e,t,r){return Vi(e,t,r,"weekdaysMin")}dr("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=k(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});u.lang=x("moment.lang is deprecated. Use moment.locale instead.",dr);u.langData=x("moment.langData is deprecated. Use moment.localeData instead.",pr);var Ki=Math.abs;function Ji(){var e=this._data;this._milliseconds=Ki(this._milliseconds);this._days=Ki(this._days);this._months=Ki(this._months);e.milliseconds=Ki(e.milliseconds);e.seconds=Ki(e.seconds);e.minutes=Ki(e.minutes);e.hours=Ki(e.hours);e.months=Ki(e.months);e.years=Ki(e.years);return this}function Qi(e,t,r,n){var i=Tn(t,r);e._milliseconds+=n*i._milliseconds;e._days+=n*i._days;e._months+=n*i._months;return e._bubble()}function Zi(e,t){return Qi(this,e,t,1)}function ea(e,t){return Qi(this,e,t,-1)}function ta(e){if(e<0){return Math.floor(e)}else{return Math.ceil(e)}}function ra(){var e=this._milliseconds;var t=this._days;var r=this._months;var n=this._data;var i,a,o,s,l;if(!(e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0)){e+=ta(ia(r)+t)*864e5;t=0;r=0}n.milliseconds=e%1e3;i=E(e/1e3);n.seconds=i%60;a=E(i/60);n.minutes=a%60;o=E(a/60);n.hours=o%24;t+=E(o/24);l=E(na(t));r+=l;t-=ta(ia(l));s=E(r/12);r%=12;n.days=t;n.months=r;n.years=s;return this}function na(e){return e*4800/146097}function ia(e){return e*146097/4800}function aa(e){if(!this.isValid()){return NaN}var t;var r;var n=this._milliseconds;e=X(e);if(e==="month"||e==="quarter"||e==="year"){t=this._days+n/864e5;r=this._months+na(t);switch(e){case"month":return r;case"quarter":return r/3;case"year":return r/12}}else{t=this._days+Math.round(ia(this._months));switch(e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}}function oa(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+k(this._months/12)*31536e6}function sa(e){return function(){return this.as(e)}}var la=sa("ms");var ua=sa("s");var fa=sa("m");var ca=sa("h");var da=sa("d");var ha=sa("w");var va=sa("M");var pa=sa("Q");var ga=sa("y");function ma(){return Tn(this)}function ya(e){e=X(e);return this.isValid()?this[e+"s"]():NaN}function ba(e){return function(){return this.isValid()?this._data[e]:NaN}}var wa=ba("milliseconds");var Ca=ba("seconds");var Sa=ba("minutes");var Ea=ba("hours");var ka=ba("days");var Ta=ba("months");var _a=ba("years");function xa(){return E(this.days()/7)}var Da=Math.round;var Ra={ss:44,s:45,m:45,h:22,d:26,M:11};function Ia(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function Oa(e,t,r){var n=Tn(e).abs();var i=Da(n.as("s"));var a=Da(n.as("m"));var o=Da(n.as("h"));var s=Da(n.as("d"));var l=Da(n.as("M"));var u=Da(n.as("y"));var f=i<=Ra.ss&&["s",i]||i<Ra.s&&["ss",i]||a<=1&&["m"]||a<Ra.m&&["mm",a]||o<=1&&["h"]||o<Ra.h&&["hh",o]||s<=1&&["d"]||s<Ra.d&&["dd",s]||l<=1&&["M"]||l<Ra.M&&["MM",l]||u<=1&&["y"]||["yy",u];f[2]=t;f[3]=+e>0;f[4]=r;return Ia.apply(null,f)}function Aa(e){if(e===undefined){return Da}if(typeof e==="function"){Da=e;return true}return false}function Na(e,t){if(Ra[e]===undefined){return false}if(t===undefined){return Ra[e]}Ra[e]=t;if(e==="s"){Ra.ss=t-1}return true}function Ma(e){if(!this.isValid()){return this.localeData().invalidDate()}var t=this.localeData();var r=Oa(this,!e,t);if(e){r=t.pastFuture(+this,r)}return t.postformat(r)}var La=Math.abs;function Pa(e){return(e>0)-(e<0)||+e}function Fa(){if(!this.isValid()){return this.localeData().invalidDate()}var e=La(this._milliseconds)/1e3;var t=La(this._days);var r=La(this._months);var n,i,a;n=E(e/60);i=E(n/60);e%=60;n%=60;a=E(r/12);r%=12;var o=a;var s=r;var l=t;var u=i;var f=n;var c=e?e.toFixed(3).replace(/\.?0+$/,""):"";var d=this.asSeconds();if(!d){return"P0D"}var h=d<0?"-":"";var v=Pa(this._months)!==Pa(d)?"-":"";var p=Pa(this._days)!==Pa(d)?"-":"";var g=Pa(this._milliseconds)!==Pa(d)?"-":"";return h+"P"+(o?v+o+"Y":"")+(s?v+s+"M":"")+(l?p+l+"D":"")+(u||f||c?"T":"")+(u?g+u+"H":"")+(f?g+f+"M":"")+(c?g+c+"S":"")}var Ba=nn.prototype;Ba.isValid=tn;Ba.abs=Ji;Ba.add=Zi;Ba.subtract=ea;Ba.as=aa;Ba.asMilliseconds=la;Ba.asSeconds=ua;Ba.asMinutes=fa;Ba.asHours=ca;Ba.asDays=da;Ba.asWeeks=ha;Ba.asMonths=va;Ba.asQuarters=pa;Ba.asYears=ga;Ba.valueOf=oa;Ba._bubble=ra;Ba.clone=ma;Ba.get=ya;Ba.milliseconds=wa;Ba.seconds=Ca;Ba.minutes=Sa;Ba.hours=Ea;Ba.days=ka;Ba.weeks=xa;Ba.months=Ta;Ba.years=_a;Ba.humanize=Ma;Ba.toISOString=Fa;Ba.toString=Fa;Ba.toJson=Fa;Ba.locale=Qn;Ba.localeData=ei;Ba.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Fa);Ba.lang=Zn;ae("X",0,0,"unix");ae("x",0,0,"valueOf");De("x",Se);De("X",Te);Ne("X",function(e,t,r){r._d=new Date(parseFloat(e,10)*1e3)});Ne("x",function(e,t,r){r._d=new Date(k(e))});u.version="2.24.0";e(qr);u.fn=Fi;u.min=Kr;u.max=Jr;u.now=Qr;u.utc=h;u.unix=Bi;u.months=zi;u.isDate=i;u.locale=dr;u.invalid=m;u.duration=Tn;u.isMoment=S;u.weekdays=Yi;u.parseZone=Hi;u.localeData=pr;u.isDuration=an;u.monthsShort=qi;u.weekdaysMin=Xi;u.defineLocale=hr;u.updateLocale=vr;u.locales=gr;u.weekdaysShort=Gi;u.normalizeUnits=X;u.relativeTimeRounding=Aa;u.relativeTimeThreshold=Na;u.calendarFormat=Nn;u.prototype=Fi;u.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return u});window["moment"]=Wa(64)}).call(this,Wa(443)(e))},function(e,t,r){var n=r(20);var i=r(58);var a=r(111);var o=r(26);var s=o(function(){a(1)});n({target:"Object",stat:true,forced:s},{keys:function e(t){return a(i(t))}})},function(e,t,r){"use strict";r(19);r(12);r(144);r(41);r(56);r(23);r(40);t.__esModule=true;t.normalizeSelection=o;t.isSeparator=s;t.hasSubMenu=l;t.isDisabled=u;t.isSelectionDisabled=f;t.getValidSelection=c;t.prepareVerticalAlignClass=d;t.prepareHorizontalAlignClass=h;t.getAlignmentClasses=v;t.align=p;t.checkSelectionConsistency=m;t.markLabelAsSelected=y;t.isItemHidden=b;t.filterSeparators=E;var i=r(4);var n=r(8);var a=r(186);function o(e){return(0,i.arrayMap)(e,function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}})}function s(e){return(0,n.hasClass)(e,"htSeparator")}function l(e){return(0,n.hasClass)(e,"htSubmenu")}function u(e){return(0,n.hasClass)(e,"htDisabled")}function f(e){return(0,n.hasClass)(e,"htSelectionDisabled")}function c(e){var t=e.getSelected();if(!t){return null}if(t[0]<0){return null}return t}function d(e,t){if(e.indexOf(t)!==-1){return e}var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function h(e,t){if(e.indexOf(t)!==-1){return e}var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function v(e,a){var o={};(0,i.arrayEach)(e,function(e){var t=e.from,r=e.to;for(var n=t.row;n<=r.row;n++){for(var i=t.col;i<=r.col;i++){if(!o[n]){o[n]=[]}o[n][i]=a(n,i)}}});return o}function p(e,a,o,s,l){(0,i.arrayEach)(e,function(e){var t=e.from,r=e.to;if(t.row===r.row&&t.col===r.col){g(t.row,t.col,a,o,s,l)}else{for(var n=t.row;n<=r.row;n++){for(var i=t.col;i<=r.col;i++){g(n,i,a,o,s,l)}}}})}function g(e,t,r,n,i,a){var o=i(e,t);var s=n;if(o.className){if(r==="vertical"){s=d(o.className,n)}else{s=h(o.className,n)}}a(e,t,"className",s)}function m(e,r){var n=false;if(Array.isArray(e)){(0,i.arrayEach)(e,function(e){e.forAll(function(e,t){if(r(e,t)){n=true;return false}});return n})}return n}function y(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function b(e,t){return!e.hidden||!(typeof e.hidden==="function"&&e.hidden.call(t))}function w(e,t){var r=e.slice(0);for(var n=0;n<r.length;){if(r[n].name===t){r.shift()}else{break}}return r}function C(e,t){var r=e.slice(0);r.reverse();r=w(r,t);r.reverse();return r}function S(e){var r=[];(0,i.arrayEach)(e,function(e,t){if(t>0){if(r[r.length-1].name!==e.name){r.push(e)}}else{r.push(e)}});return r}function E(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a.KEY;var r=e.slice(0);r=w(r,t);r=C(r,t);r=S(r);return r}},function(e,t,r){var n=r(44);var i=r(51);var a=r(103);e.exports=n?function(e,t,r){return i.f(e,t,a(1,r))}:function(e,t,r){e[t]=r;return e}},function(e,t,r){var s=r(35);var l=r(67);var u=r(47);var f=r(156);var n=r(195);var i=r(81);var a=i.get;var c=i.enforce;var d=String(String).split("String");(e.exports=function(e,t,r,n){var i=n?!!n.unsafe:false;var a=n?!!n.enumerable:false;var o=n?!!n.noTargetGet:false;if(typeof r=="function"){if(typeof t=="string"&&!u(r,"name"))l(r,"name",t);c(r).source=d.join(typeof t=="string"?t:"")}if(e===s){if(a)e[t]=r;else f(t,r);return}else if(!i){delete e[t]}else if(!o&&e[t]){a=true}if(a)e[t]=r;else l(e,t,r)})(Function.prototype,"toString",function e(){return typeof this=="function"&&a(this).source||n(this)})},function(e,t,r){"use strict";var n=r(137);var i=r(215);e.exports=n("Map",function(t){return function e(){return t(this,arguments.length?arguments[0]:undefined)}},i)},function(e,t){function r(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}e.exports=r},function(e,t,r){"use strict";t.__esModule=true;t.setBrowserMeta=s;t.setPlatformMeta=l;t.isChrome=u;t.isEdge=f;t.isIE=c;t.isIE8=d;t.isIE9=h;t.isMSBrowser=v;t.isMobileBrowser=p;t.isSafari=g;t.isFirefox=m;t.isWindowsOS=y;t.isMacOS=b;t.isLinuxOS=w;var a=r(3);var n=function e(r){var n={value:false};n.test=function(e,t){n.value=r(e,t)};return n};var o={chrome:n(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),edge:n(function(e){return/Edge/.test(e)}),firefox:n(function(e){return/Firefox/.test(e)}),ie:n(function(e){return/Trident/.test(e)}),ie8:n(function(){return!document.createTextNode("test").textContent}),ie9:n(function(){return!!document.documentMode}),mobile:n(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:n(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})};var i={mac:n(function(e){return/^Mac/.test(e)}),win:n(function(e){return/^Win/.test(e)}),linux:n(function(e){return/^Linux/.test(e)})};function s(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;(0,a.objectEach)(o,function(e){var t=e.test;return void t(r,i)})}function l(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;(0,a.objectEach)(i,function(e){var t=e.test;return void t(r)})}s();l();function u(){return o.chrome.value}function f(){return o.edge.value}function c(){return o.ie.value}function d(){return o.ie8.value}function h(){return o.ie9.value}function v(){return o.ie.value||o.edge.value}function p(){return o.mobile.value}function g(){return o.safari.value}function m(){return o.firefox.value}function y(){return i.win.value}function b(){return i.mac.value}function w(){return i.linux.value}},function(e,t){function r(e,t){if(!t){t=e.slice(0)}return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}e.exports=r},function(e,t,r){"use strict";r(23);r(40);r(143);t.__esModule=true;t.toSingleLine=n;var i=r(4);function n(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++){a[r-1]=arguments[r]}var n=(0,i.arrayReduce)(e,function(e,t,r){var n=t.replace(/(?:\r?\n\s+)/g,"");var i=a[r]?a[r]:"";return e+n+i},"");return n.trim()}},function(e,t,r){"use strict";r(12);r(10);r(23);r(38);r(40);t.__esModule=true;t.toUpperCaseFirst=n;t.equalsIgnoreCase=i;t.randomString=a;t.isPercentValue=s;t.substitute=l;t.stripTags=f;var o=r(29);function n(e){return e[0].toUpperCase()+e.substr(1)}function i(){var e=[];for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}var i=r.length;while(i){i-=1;var a=(0,o.stringify)(r[i]).toLowerCase();if(e.indexOf(a)===-1){e.push(a)}}return e.length===1}function a(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function s(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function l(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(e,t){if(e.charAt(0)==="\\"){return e.substr(1,e.length-1)}return r[t]===void 0?"":r[t]})}var u=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function f(e){return"".concat(e).replace(u,"")}},function(e,t,r){var w=r(113);var C=r(104);var S=r(58);var E=r(49);var k=r(170);var T=[].push;var n=function(h){var v=h==1;var p=h==2;var g=h==3;var m=h==4;var y=h==6;var b=h==5||y;return function(e,t,r,n){var i=S(e);var a=C(i);var o=w(t,r,3);var s=E(a.length);var l=0;var u=n||k;var f=v?u(e,s):p?u(e,0):undefined;var c,d;for(;s>l;l++)if(b||l in a){c=a[l];d=o(c,l,i);if(h){if(v)f[l]=d;else if(d)switch(h){case 3:return true;case 5:return c;case 6:return l;case 2:T.call(f,c)}else if(m)return false}}return y?-1:g||m?m:f}};e.exports={forEach:n(0),map:n(1),filter:n(2),some:n(3),every:n(4),find:n(5),findIndex:n(6)}},function(e,t,r){"use strict";var n=r(0);r(10);r(23);r(38);r(120);r(34);t.__esModule=true;t.requestAnimationFrame=f;t.isClassListSupported=c;t.isTextContentSupported=d;t.isGetComputedStyleSupported=h;t.cancelAnimationFrame=v;t.isTouchSupported=p;t.isWebComponentSupportedNatively=g;t.hasCaptionProblem=b;t.getComparisonFunction=C;t.isPassiveEventSupported=E;var i=n(r(42));var a=0;var o=["ms","moz","webkit","o"];var s=window.requestAnimationFrame;var l=window.cancelAnimationFrame;for(var u=0;u<o.length&&!s;++u){s=window["".concat(o[u],"RequestAnimationFrame")];l=window["".concat(o[u],"CancelAnimationFrame")]||window["".concat(o[u],"CancelRequestAnimationFrame")]}if(!s){s=function e(t){var r=(new Date).getTime();var n=Math.max(0,16-(r-a));var i=window.setTimeout(function(){t(r+n)},n);a=r+n;return i}}if(!l){l=function e(t){clearTimeout(t)}}function f(e){return s.call(window,e)}function c(){return!!document.documentElement.classList}function d(){return!!document.createTextNode("test").textContent}function h(){return!!window.getComputedStyle}function v(e){l.call(window,e)}function p(){return"ontouchstart"in window}function g(){var e=document.createElement("div");return!!(e.createShadowRoot&&e.createShadowRoot.toString().match(/\[native code\]/))}var m;function y(){var e=document.createElement("TABLE");e.style.borderSpacing="0";e.style.borderWidth="0";e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t);t.appendChild(document.createElement("TR"));t.firstChild.appendChild(document.createElement("TD"));t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c";r.style.padding="0";r.style.margin="0";e.insertBefore(r,t);document.body.appendChild(e);m=e.offsetHeight<2*e.lastChild.offsetHeight;document.body.removeChild(e)}function b(){if(m===void 0){y()}return m}var w;function C(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(w){return w}if((typeof Intl==="undefined"?"undefined":(0,i.default)(Intl))==="object"){w=new Intl.Collator(e,t).compare}else if(typeof String.prototype.localeCompare==="function"){w=function e(t,r){return"".concat(t).localeCompare(r)}}else{w=function e(t,r){if(t===r){return 0}return t>r?-1:1}}return w}var S;function E(){if(S!==void 0){return S}try{var e={get passive(){S=true}};window.addEventListener("test",e,e);window.removeEventListener("test",e,e)}catch(e){S=false}return S}},function(e,t,r){"use strict";r(19);r(144);r(41);r(34);t.__esModule=true;t.isFunction=n;t.throttle=s;t.throttleAfterHits=i;t.debounce=a;t.pipe=l;t.partial=u;t.curry=f;t.curryRight=c;var o=r(4);function n(e){return typeof e==="function"}function s(s){var l=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var u=0;var f={lastCallThrottled:true};var c=null;function e(){var e=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}var i=Date.now();var a=false;f.lastCallThrottled=true;if(!u){u=i;a=true}var o=l-(i-u);if(a){f.lastCallThrottled=false;s.apply(this,r)}else{if(c){clearTimeout(c)}c=setTimeout(function(){f.lastCallThrottled=false;s.apply(e,r);u=0;c=void 0},o)}return f}return e}function i(n){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:10;var i=s(n,e);var a=t;function r(){a=t}function o(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}if(a){a-=1;return n.apply(this,t)}return i.apply(this,t)}o.clearHits=r;return o}function a(i){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var o=null;var s;function e(){var e=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}if(o){clearTimeout(o)}o=setTimeout(function(){s=i.apply(e,r)},a);return s}return e}function l(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}var i=t[0],a=t.slice(1);return function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(0,o.arrayReduce)(a,function(e,t){return t(e)},i.apply(this,r))}}function u(i){for(var e=arguments.length,a=new Array(e>1?e-1:0),t=1;t<e;t++){a[t-1]=arguments[t]}return function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return i.apply(this,a.concat(r))}}function f(s){var l=s.length;function u(o){return function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}var i=o.concat(r);var a;if(i.length>=l){a=s.apply(this,i)}else{a=u(i)}return a}}return u([])}function c(s){var l=s.length;function u(o){return function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}var i=o.concat(r.reverse());var a;if(i.length>=l){a=s.apply(this,i)}else{a=u(i)}return a}}return u([])}},function(e,t,r){"use strict";var n=r(20);var i=r(138);var a=r(58);var o=r(26);var s=r(84);var l=[];var u=l.sort;var f=o(function(){l.sort(undefined)});var c=o(function(){l.sort(null)});var d=s("sort");var h=f||!c||!d;n({target:"Array",proto:true,forced:h},{sort:function e(t){return t===undefined?u.call(a(this)):u.call(a(this),i(t))}})},function(e,t,r){var n=r(44);var i=r(130);var a=r(103);var o=r(63);var s=r(105);var l=r(47);var u=r(194);var f=Object.getOwnPropertyDescriptor;t.f=n?f:function e(t,r){t=o(t);r=s(r,true);if(u)try{return f(t,r)}catch(e){}if(l(t,r))return a(!i.f.call(t,r),t[r])}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(197);var i=r(35);var a=r(45);var o=r(67);var s=r(47);var l=r(131);var u=r(106);var f=i.WeakMap;var c,d,h;var v=function(e){return h(e)?d(e):c(e,{})};var p=function(r){return function(e){var t;if(!a(e)||(t=d(e)).type!==r){throw TypeError("Incompatible receiver, "+r+" required")}return t}};if(n){var g=new f;var m=g.get;var y=g.has;var b=g.set;c=function(e,t){b.call(g,e,t);return t};d=function(e){return m.call(g,e)||{}};h=function(e){return y.call(g,e)}}else{var w=l("state");u[w]=true;c=function(e,t){o(e,w,t);return t};d=function(e){return s(e,w)?e[w]:{}};h=function(e){return s(e,w)}}e.exports={set:c,get:d,has:h,enforce:v,getterFor:p}},function(e,t){var r=Math.ceil;var n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){"use strict";var n=r(0);r(15);r(69);r(10);r(13);r(16);t.__esModule=true;t.default=i;t.collection=void 0;var s=n(r(37));var l=new Map;t.collection=l;function i(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"common";if(!l.has(e)){l.set(e,new Map)}var r=l.get(e);function t(e,t){r.set(e,t)}function n(e){return r.get(e)}function i(e){return r.has(e)}function a(){return(0,s.default)(r.keys())}function o(){return(0,s.default)(r.values())}return{register:t,getItem:n,hasItem:i,getNames:a,getValues:o}}},function(e,t,r){"use strict";var n=r(26);e.exports=function(e,t){var r=[][e];return!!r&&n(function(){r.call(null,t||function(){throw 1},1)})}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.getValidator=p;t.getRegisteredValidators=t.getRegisteredValidatorNames=t.hasValidator=t.registerValidator=void 0;var i=n(r(83));var a=n(r(480));var o=n(r(481));var s=n(r(483));var l=n(r(484));var u=(0,i.default)("validators"),f=u.register,c=u.getItem,d=u.hasItem,h=u.getNames,v=u.getValues;t.getRegisteredValidators=v;t.getRegisteredValidatorNames=h;t.hasValidator=d;t.registerValidator=f;f("autocomplete",a.default);f("date",o.default);f("numeric",s.default);f("time",l.default);function p(e){if(typeof e==="function"){return e}if(!d(e)){throw Error('No registered validator found under "'.concat(e,'" name'))}return c(e)}},function(e,t,r){"use strict";var n=r(44);var i=r(35);var a=r(134);var o=r(68);var s=r(47);var l=r(80);var u=r(169);var f=r(105);var c=r(26);var d=r(110);var h=r(108).f;var v=r(79).f;var p=r(51).f;var g=r(220).trim;var m="Number";var y=i[m];var b=y.prototype;var w=l(d(b))==m;var C=function(e){var t=f(e,false);var r,n,i,a,o,s,l,u;if(typeof t=="string"&&t.length>2){t=g(t);r=t.charCodeAt(0);if(r===43||r===45){n=t.charCodeAt(2);if(n===88||n===120)return NaN}else if(r===48){switch(t.charCodeAt(1)){case 66:case 98:i=2;a=49;break;case 79:case 111:i=8;a=55;break;default:return+t}o=t.slice(2);s=o.length;for(l=0;l<s;l++){u=o.charCodeAt(l);if(u<48||u>a)return NaN}return parseInt(o,i)}}return+t};if(a(m,!y(" 0o1")||!y("0b1")||y("+0x1"))){var S=function e(t){var r=arguments.length<1?0:t;var n=this;return n instanceof S&&(w?c(function(){b.valueOf.call(n)}):l(n)!=m)?u(new y(C(r)),n,S):C(r)};for(var E=n?h(y):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),k=0,T;E.length>k;k++){if(s(y,T=E[k])&&!s(S,T)){p(S,T,v(y,T))}}S.prototype=b;b.constructor=S;o(i,m,S)}},function(e,t,r){var n=r(20);var i=r(494);n({target:"Number",stat:true},{isInteger:i})},function(e,t,r){"use strict";var n=r(137);var i=r(215);e.exports=n("Set",function(t){return function e(){return t(this,arguments.length?arguments[0]:undefined)}},i)},function(e,t,r){"use strict";var n=r(0);var i=r(9);r(12);t.__esModule=true;t.predefinedItems=E;t.addItem=k;t.ITEMS=t.UNDO=t.NO_ITEMS=t.SEPARATOR=t.ROW_BELOW=t.ROW_ABOVE=t.REMOVE_ROW=t.REMOVE_COLUMN=t.REDO=t.READ_ONLY=t.COLUMN_RIGHT=t.COLUMN_LEFT=t.CLEAR_COLUMN=t.ALIGNMENT=void 0;var a=n(r(70));var o=r(3);var s=i(r(548));t.ALIGNMENT=s.KEY;var l=i(r(549));t.CLEAR_COLUMN=l.KEY;var u=i(r(550));t.COLUMN_LEFT=u.KEY;var f=i(r(551));t.COLUMN_RIGHT=f.KEY;var c=i(r(552));t.READ_ONLY=c.KEY;var d=i(r(553));t.REDO=d.KEY;var h=i(r(554));t.REMOVE_COLUMN=h.KEY;var v=i(r(555));t.REMOVE_ROW=v.KEY;var p=i(r(556));t.ROW_ABOVE=p.KEY;var g=i(r(557));t.ROW_BELOW=g.KEY;var m=i(r(186));t.SEPARATOR=m.KEY;var y=i(r(558));t.NO_ITEMS=y.KEY;var b=i(r(559));t.UNDO=b.KEY;var w;var C=[p.KEY,g.KEY,u.KEY,f.KEY,l.KEY,v.KEY,h.KEY,b.KEY,d.KEY,c.KEY,s.KEY,m.KEY,y.KEY];t.ITEMS=C;var S=(w={},(0,a.default)(w,m.KEY,m.default),(0,a.default)(w,y.KEY,y.default),(0,a.default)(w,p.KEY,p.default),(0,a.default)(w,g.KEY,g.default),(0,a.default)(w,u.KEY,u.default),(0,a.default)(w,f.KEY,f.default),(0,a.default)(w,l.KEY,l.default),(0,a.default)(w,v.KEY,v.default),(0,a.default)(w,h.KEY,h.default),(0,a.default)(w,b.KEY,b.default),(0,a.default)(w,d.KEY,d.default),(0,a.default)(w,c.KEY,c.default),(0,a.default)(w,s.KEY,s.default),w);function E(){var r={};(0,o.objectEach)(S,function(e,t){r[t]=e()});return r}function k(e,t){if(C.indexOf(e)===-1){S[e]=t}}},function(e,t,r){"use strict";r(23);r(120);r(40);t.__esModule=true;t.isFormulaExpression=n;t.isFormulaExpressionEscaped=i;t.unescapeFormulaExpression=a;t.toUpperCaseFormula=o;t.cellCoordFactory=s;function n(e){return typeof e==="string"&&e.length>=2&&e.charAt(0)==="="}function i(e){return typeof e==="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function a(e){return i(e)?e.substr(1):e}function o(e){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g;var r=e.match(t)||[];var n=-1;return e.toUpperCase().replace(t,function(){n+=1;return r[n]})}function s(t,r){return function(e){return{row:t==="row"?r:e.row,column:t==="column"?r:e.column}}}},function(e,t,r){"use strict";var n=r(0);r(12);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(2));var l=n(r(7));var u=r(128);var f=r(4);var c=n(r(414));var d=1;var h=2;var v=3;var p=[d,h,v];var g=function(e){(0,l.default)(n,e);(0,s.default)(n,null,[{key:"STATE_OUT_OFF_DATE",get:function e(){return 1}},{key:"STATE_COMPUTING",get:function e(){return 2}},{key:"STATE_UP_TO_DATE",get:function e(){return 3}}]);function n(e,t){var r;(0,i.default)(this,n);r=(0,a.default)(this,(0,o.default)(n).call(this,e,t));r.precedents=[];r.value=null;r.error=null;r.state=n.STATE_UP_TO_DATE;return r}(0,s.default)(n,[{key:"setValue",value:function e(t){this.value=t}},{key:"getValue",value:function e(){return this.value}},{key:"setError",value:function e(t){this.error=t}},{key:"getError",value:function e(){return this.error}},{key:"hasError",value:function e(){return this.error!==null}},{key:"setState",value:function e(t){if(p.indexOf(t)===-1){throw Error("Unrecognized state: ".concat(t))}this.state=t}},{key:"isState",value:function e(t){return this.state===t}},{key:"addPrecedent",value:function e(t){if(this.isEqual(t)){throw Error(u.ERROR_REF)}if(!this.hasPrecedent(t)){this.precedents.push(t)}}},{key:"removePrecedent",value:function e(t){if(this.isEqual(t)){throw Error(u.ERROR_REF)}this.precedents=(0,f.arrayFilter)(this.precedents,function(e){return!e.isEqual(t)})}},{key:"clearPrecedents",value:function e(){this.precedents.length=0}},{key:"getPrecedents",value:function e(){return this.precedents}},{key:"hasPrecedents",value:function e(){return this.precedents.length>0}},{key:"hasPrecedent",value:function e(t){return(0,f.arrayFilter)(this.precedents,function(e){return e.isEqual(t)}).length>0}}]);return n}(c.default);var m=g;t.default=m},function(e,t,r){"use strict";var n=r(0);r(12);t.__esModule=true;t.default=void 0;var s=n(r(1));var i=n(r(2));var f=r(8);var l=r(3);var o=r(4);var c=r(61);var a=n(r(25));var d=n(r(363));var h={};var u=function(){(0,i.default)(u,null,[{key:"registerOverlay",value:function e(t,r){if(u.CLONE_TYPES.indexOf(t)===-1){throw new Error("Unsupported overlay (".concat(t,")."))}h[t]=r}},{key:"createOverlay",value:function e(t,r){return new h[t](r)}},{key:"hasOverlay",value:function e(t){return h[t]!==void 0}},{key:"isOverlayTypeOf",value:function e(t,r){if(!t||!h[r]){return false}return t instanceof h[r]}},{key:"CLONE_TOP",get:function e(){return"top"}},{key:"CLONE_BOTTOM",get:function e(){return"bottom"}},{key:"CLONE_LEFT",get:function e(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function e(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function e(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function e(){return"debug"}},{key:"CLONE_TYPES",get:function e(){return[u.CLONE_TOP,u.CLONE_BOTTOM,u.CLONE_LEFT,u.CLONE_TOP_LEFT_CORNER,u.CLONE_BOTTOM_LEFT_CORNER,u.CLONE_DEBUG]}}]);function u(e){(0,s.default)(this,u);(0,l.defineGetter)(this,"wot",e,{writable:false});var t=this.wot.wtTable,r=t.TABLE,n=t.hider,i=t.spreader,a=t.holder,o=t.wtRootElement;this.instance=this.wot;this.type="";this.mainTableScrollableElement=null;this.TABLE=r;this.hider=n;this.spreader=i;this.holder=a;this.wtRootElement=o;this.trimmingContainer=(0,f.getTrimmingContainer)(this.hider.parentNode.parentNode);this.areElementSizesAdjusted=false;this.updateStateOfRendering()}(0,i.default)(u,[{key:"updateStateOfRendering",value:function e(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var r=t!==this.needFullRender;if(r&&!this.needFullRender){this.reset()}return r}},{key:"shouldBeRendered",value:function e(){return true}},{key:"updateTrimmingContainer",value:function e(){this.trimmingContainer=(0,f.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function e(){var t=this.wot,r=t.wtTable,n=t.rootWindow;if(n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"){this.mainTableScrollableElement=this.wot.wtTable.holder}else{this.mainTableScrollableElement=(0,f.getScrollableElement)(r.TABLE)}}},{key:"getRelativeCellPosition",value:function e(t,r,n){if(this.clone.wtTable.holder.contains(t)===false){(0,c.warn)("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.wot.rootWindow;var a=n<this.wot.getSetting("fixedColumnsLeft");var o=r<this.wot.getSetting("fixedRowsTop");var s=r>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom");var l={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop};var u={left:t.offsetLeft,top:t.offsetTop};var f=null;if(i){f=this.getRelativeCellPositionWithinWindow(o,a,u,l)}else{f=this.getRelativeCellPositionWithinHolder(o,s,a,u,l)}return f}},{key:"getRelativeCellPositionWithinWindow",value:function e(t,r,n,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect();var o=0;var s=0;if(!r){o=i.left}else{o=a.left<=0?-1*a.left:0}if(t){var l=this.clone.wtTable.TABLE.getBoundingClientRect();s=l.top-a.top}else{s=i.top}return{left:n.left+o,top:n.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function e(t,r,n,i,a){var o={horizontal:this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),vertical:this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition()};var s=0;var l=0;if(!n){s=o.horizontal-a.left}if(r){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect();var f=this.clone.wtTable.TABLE.getBoundingClientRect();l=f.top*-1+u.top}else if(!t){l=o.vertical-a.top}return{left:i.left-s,top:i.top-l}}},{key:"makeClone",value:function e(t){if(u.CLONE_TYPES.indexOf(t)===-1){throw new Error('Clone type "'.concat(t,'" is not supported.'))}var r=this.wot,n=r.wtTable,i=r.rootDocument,a=r.rootWindow;var o=i.createElement("DIV");var s=i.createElement("TABLE");o.className="ht_clone_".concat(t," handsontable");o.style.position="absolute";o.style.top=0;o.style.left=0;o.style.overflow="hidden";s.className=n.TABLE.className;o.appendChild(s);this.type=t;n.wtRootElement.parentNode.appendChild(o);var l=this.wot.getSetting("preventOverflow");if(l===true||l==="horizontal"&&this.type===u.CLONE_TOP||l==="vertical"&&this.type===u.CLONE_LEFT){this.mainTableScrollableElement=a}else if(a.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"){this.mainTableScrollableElement=n.holder}else{this.mainTableScrollableElement=(0,f.getScrollableElement)(n.TABLE)}return new d.default({cloneSource:this.wot,cloneOverlay:this,table:s})}},{key:"refresh",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=this.shouldBeRendered();if(this.clone&&(this.needFullRender||r)){this.clone.draw(t)}this.needFullRender=r}},{key:"reset",value:function e(){if(!this.clone){return}var t=this.clone.wtTable.holder;var r=this.clone.wtTable.hider;var n=t.style;var i=r.style;var a=t.parentNode.style;(0,o.arrayEach)([n,i,a],function(e){e.width="";e.height=""})}},{key:"destroy",value:function e(){new a.default(this.clone).destroy()}}]);return u}();var v=u;t.default=v},function(e,t,r){"use strict";t.__esModule=true;var n=r(398);t.registerRootComparator=n.registerRootComparator;t.getRootComparator=n.getRootComparator;t.getCompareFunctionFactory=n.getCompareFunctionFactory;var i=r(540);t.FIRST_AFTER_SECOND=i.FIRST_AFTER_SECOND;t.FIRST_BEFORE_SECOND=i.FIRST_BEFORE_SECOND;t.DO_NOT_SWAP=i.DO_NOT_SWAP;t.sort=i.sort},function(e,t){e.exports=false},function(e,t,r){"use strict";var n=r(0);r(60);r(31);r(13);t.__esModule=true;t.default=void 0;var a=n(r(37));var c=n(r(18));var o=n(r(1));var s=n(r(2));var S=r(8);var l=r(77);var u=n(r(118));var E=n(r(226));var k=n(r(227));var f=r(231);var T=n(r(92));var d=n(r(448));var h=n(r(449));var i=function(){function i(e,t){var r=this;(0,o.default)(this,i);this.isMaster=!e.cloneOverlay;this.wot=e;this.instance=this.wot;this.TABLE=t;this.TBODY=null;this.THEAD=null;this.COLGROUP=null;this.tableOffset=0;this.holderOffset=0;this.hasTableHeight=true;this.hasTableWidth=true;this.isTableVisible=false;(0,S.removeTextNodes)(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;if(this.isMaster){this.alignOverlaysWithTrimmingContainer()}this.fixTableDomTree();this.rowFilter=null;this.columnFilter=null;this.correctHeaderWidth=false;var n=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return r._modifyRowHeaderWidth(n)};this.rowUtils=new h.default(this.wot);this.columnUtils=new d.default(this.wot);this.tableRenderer=new f.Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}(0,s.default)(i,[{key:"is",value:function e(t){return T.default.isOverlayTypeOf(this.wot.cloneOverlay,t)}},{key:"fixTableDomTree",value:function e(){var t=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody");if(!this.TBODY){this.TBODY=t.createElement("tbody");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.querySelector("thead");if(!this.THEAD){this.THEAD=t.createElement("thead");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.querySelector("colgroup");if(!this.COLGROUP){this.COLGROUP=t.createElement("colgroup");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){this.THEAD.appendChild(t.createElement("TR"))}}},{key:"createSpreader",value:function e(t){var r=t.parentNode;var n;if(!r||r.nodeType!==Node.ELEMENT_NODE||!(0,S.hasClass)(r,"wtHolder")){n=this.wot.rootDocument.createElement("div");n.className="wtSpreader";if(r){r.insertBefore(n,t)}n.appendChild(t)}n.style.position="relative";return n}},{key:"createHider",value:function e(t){var r=t.parentNode;var n;if(!r||r.nodeType!==Node.ELEMENT_NODE||!(0,S.hasClass)(r,"wtHolder")){n=this.wot.rootDocument.createElement("div");n.className="wtHider";if(r){r.insertBefore(n,t)}n.appendChild(t)}return n}},{key:"createHolder",value:function e(t){var r=t.parentNode;var n;if(!r||r.nodeType!==Node.ELEMENT_NODE||!(0,S.hasClass)(r,"wtHolder")){n=this.wot.rootDocument.createElement("div");n.style.position="relative";n.className="wtHolder";if(r){r.insertBefore(n,t)}if(this.isMaster){n.parentNode.className+="ht_master handsontable"}n.appendChild(t)}return n}},{key:"draw",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=this.wot;var n=r.wtOverlays,i=r.wtViewport;var a=r.getSetting("totalRows");var o=r.getSetting("totalColumns");var s=r.getSetting("rowHeaders");var l=s.length;var u=r.getSetting("columnHeaders");var f=u.length;var c=false;var d=t;if(this.isMaster){this.holderOffset=(0,S.offset)(this.holder);d=i.createRenderCalculators(d);if(l&&!r.getSetting("fixedColumnsLeft")){var h=n.leftOverlay.getScrollPosition();var v=this.correctHeaderWidth;this.correctHeaderWidth=h>0;if(v!==this.correctHeaderWidth){d=false}}}if(this.isMaster){c=n.prepareOverlays()}if(d){if(this.isMaster){i.createVisibleCalculators()}if(n){n.refresh(true)}}else{if(this.isMaster){this.tableOffset=(0,S.offset)(this.TABLE)}else{this.tableOffset=this.wot.cloneSource.wtTable.tableOffset}var p=a>0?this.getFirstRenderedRow():0;var g=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new k.default(p,a,f);this.columnFilter=new E.default(g,o,l);var m=true;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var y={};this.wot.getSetting("beforeDraw",true,y);m=y.skipRender!==true}if(m){this.tableRenderer.setHeaderContentRenderers(s,u);if(this.is(T.default.CLONE_BOTTOM)||this.is(T.default.CLONE_BOTTOM_LEFT_CORNER)){this.tableRenderer.setHeaderContentRenderers(s,[])}this.resetOversizedRows();this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var b;if(this.isMaster){b=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtViewport.containerWidth=null;this.markOversizedColumnHeaders()}this.adjustColumnHeaderHeights();if(this.isMaster||this.is(T.default.CLONE_BOTTOM)){this.markOversizedRows()}if(this.isMaster){this.wot.wtViewport.createVisibleCalculators();this.wot.wtOverlays.refresh(false);this.wot.wtOverlays.applyToDOM();var w=(0,S.outerWidth)(this.hider);var C=(0,S.outerWidth)(this.TABLE);if(w!==0&&C!==w){this.columnUtils.calculateWidths();this.tableRenderer.renderer.colGroup.render()}if(b!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;this.columnUtils.calculateWidths();this.tableRenderer.renderer.colGroup.render()}this.wot.getSetting("onDraw",true)}else if(this.is(T.default.CLONE_BOTTOM)){this.wot.cloneSource.wtOverlays.adjustElementsSize()}}}this.refreshSelections(d);if(this.isMaster){n.topOverlay.resetFixedPosition();if(n.bottomOverlay.clone){n.bottomOverlay.resetFixedPosition()}n.leftOverlay.resetFixedPosition();if(n.topLeftCornerOverlay){n.topLeftCornerOverlay.resetFixedPosition()}if(n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone){n.bottomLeftCornerOverlay.resetFixedPosition()}}if(c){n.syncScrollWithMaster()}r.drawn=true;return this}},{key:"markIfOversizedColumnHeader",value:function e(t){var r=this.wot.wtTable.columnFilter.renderedToSource(t);var n=this.wot.getSetting("columnHeaders").length;var i=this.wot.wtSettings.settings.defaultRowHeight;var a;var o;var s;var l=this.wot.getSetting("columnHeaderHeight")||[];while(n){n-=1;a=this.wot.wtTable.getColumnHeaderHeight(n);o=this.wot.wtTable.getColumnHeader(r,n);if(!o){continue}s=(0,S.innerHeight)(o);if(!a&&i<s||a<s){this.wot.wtViewport.oversizedColumnHeaders[n]=s}if(Array.isArray(l)){if(l[n]!==null&&l[n]!==void 0){this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]}}else if(!isNaN(l)){this.wot.wtViewport.oversizedColumnHeaders[n]=l}if(this.wot.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)){this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]||l}}}},{key:"adjustColumnHeaderHeights",value:function e(){var t=this.wot;var r=t.wtTable.THEAD.childNodes;var n=t.wtViewport.oversizedColumnHeaders;var i=t.getSetting("columnHeaders");for(var a=0,o=i.length;a<o;a++){if(n[a]){if(!r[a]||r[a].childNodes.length===0){return}r[a].childNodes[0].style.height="".concat(n[a],"px")}}}},{key:"resetOversizedRows",value:function e(){var t=this.wot;if(!this.isMaster&&!this.is(T.default.CLONE_BOTTOM)){return}if(!t.getSetting("externalRowCalculator")){var r=this.getRenderedRowsCount();for(var n=0;n<r;n++){var i=this.rowFilter.renderedToSource(n);if(t.wtViewport.oversizedRows&&t.wtViewport.oversizedRows[i]){t.wtViewport.oversizedRows[i]=void 0}}}}},{key:"removeClassFromCells",value:function e(t){var r=this.TABLE.querySelectorAll(".".concat(t));for(var n=0,i=r.length;n<i;n++){(0,S.removeClass)(r[n],t)}}},{key:"refreshSelections",value:function e(t){var r=this.wot;if(!r.selections){return}var n=Array.from(r.selections);var i=n.length;if(t){var a=[];for(var o=0;o<i;o++){var s=n[o].settings,l=s.highlightHeaderClassName,u=s.highlightRowClassName,f=s.highlightColumnClassName;var c=n[o].classNames;var d=c.length;for(var h=0;h<d;h++){if(!a.includes(c[h])){a.push(c[h])}}if(l&&!a.includes(l)){a.push(l)}if(u&&!a.includes(u)){a.push(u)}if(f&&!a.includes(f)){a.push(f)}}var v=r.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(v)){for(var p=0;p<v.length;p++){a.push(v[p])}}var g=a.length;for(var m=0;m<g;m++){this.removeClassFromCells(a[m])}}for(var y=0;y<i;y++){n[y].draw(r,t)}}},{key:"getCell",value:function e(t){var r=t.row;var n=t.col;var i=this.wot.getSetting("onModifyGetCellCoords",r,n);if(i&&Array.isArray(i)){var a=(0,c.default)(i,2);r=a[0];n=a[1]}if(this.isRowBeforeRenderedRows(r)){return-1}else if(this.isRowAfterRenderedRows(r)){return-2}else if(this.isColumnBeforeRenderedColumns(n)){return-3}else if(this.isColumnAfterRenderedColumns(n)){return-4}if(r<0){var o=this.wot.getSetting("columnHeaders");var s=o.length;var l=s+r;return this.getColumnHeader(n,l)}var u=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];if(!u&&r>=0){throw new Error("TR was expected to be rendered but is not")}var f=u.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!f&&n>=0){throw new Error("TD or TH was expected to be rendered but is not")}return f}},{key:"getColumnHeader",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=this.THEAD.childNodes[r];if(n){return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}}},{key:"getRowHeader",value:function e(t){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0){return null}var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];if(r){return r.childNodes[0]}}},{key:"getCoords",value:function e(t){var r=t;if(r.nodeName!=="TD"&&r.nodeName!=="TH"){r=(0,S.closest)(r,["TD","TH"])}if(r===null){return null}var n=r.parentNode;var i=n.parentNode;var a=(0,S.index)(n);var o=r.cellIndex;if((0,S.overlayContainsElement)(T.default.CLONE_TOP_LEFT_CORNER,r,this.wtRootElement)||(0,S.overlayContainsElement)(T.default.CLONE_TOP,r,this.wtRootElement)){if(i.nodeName==="THEAD"){a-=i.childNodes.length}}else if((0,S.overlayContainsElement)(T.default.CLONE_BOTTOM_LEFT_CORNER,r,this.wtRootElement)||(0,S.overlayContainsElement)(T.default.CLONE_BOTTOM,r,this.wtRootElement)){var s=this.wot.getSetting("totalRows");a=s-i.childNodes.length+a}else if(i===this.THEAD){a=this.rowFilter.visibleColHeadedRowToSourceRow(a)}else{a=this.rowFilter.renderedToSource(a)}if((0,S.overlayContainsElement)(T.default.CLONE_TOP_LEFT_CORNER,r,this.wtRootElement)||(0,S.overlayContainsElement)(T.default.CLONE_LEFT,r,this.wtRootElement)||(0,S.overlayContainsElement)(T.default.CLONE_BOTTOM_LEFT_CORNER,r,this.wtRootElement)){o=this.columnFilter.offsettedTH(o)}else{o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o)}return new u.default(a,o)}},{key:"markOversizedRows",value:function e(){if(this.wot.getSetting("externalRowCalculator")){return}var t=this.TBODY.childNodes.length;var r=t*this.wot.wtSettings.settings.defaultRowHeight;var n=(0,S.innerHeight)(this.TBODY)-1;var i;var a;var o;var s;var l;if(r===n&&!this.wot.getSetting("fixedRowsBottom")){return}while(t){t-=1;o=this.rowFilter.renderedToSource(t);i=this.getRowHeight(o);s=this.getTrForRow(o);l=s.querySelector("th");if(l){a=(0,S.innerHeight)(l)}else{a=(0,S.innerHeight)(s)-1}if(!i&&this.wot.wtSettings.settings.defaultRowHeight<a||i<a){a+=1;this.wot.wtViewport.oversizedRows[o]=a}}}},{key:"getTrForRow",value:function e(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderLevelRendered",value:function e(t){var r=this.wot.getSetting("columnHeaders");var n=r.length;return t>n-1}},{key:"isRowHeaderLevelRendered",value:function e(t){var r=this.wot.getSetting("rowHeaders");var n=r.length;return t>n-1}},{key:"isRowBeforeRenderedRows",value:function e(t){var r=this.getFirstRenderedRow();if(t<0){t=0}if(r===-1){return true}return t<r}},{key:"isRowAfterViewport",value:function e(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function e(t){if(t<0){var r=this.wot.getSetting("columnHeaders");var n=r.length;var i=n+t;return this.isColumnHeaderLevelRendered(i)}return t>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function e(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isColumnBeforeRenderedColumns",value:function e(t){var r=this.getFirstRenderedColumn();if(t<0){t=0}if(r===-1){return true}return t<r}},{key:"isColumnAfterViewport",value:function e(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isColumnAfterRenderedColumns",value:function e(t){if(t<0){var r=this.wot.getSetting("rowHeaders");var n=r.length;var i=n+t;return this.isRowHeaderLevelRendered(i)}return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isLastRowFullyVisible",value:function e(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function e(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function e(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function e(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function e(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function e(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function e(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function e(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function e(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function e(){return(0,S.isVisible)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function e(t){var r=(0,l.isFunction)(t)?t():null;if(Array.isArray(r)){r=(0,a.default)(r);r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])}else{r=this._correctRowHeaderWidth(r)}return r}},{key:"_correctRowHeaderWidth",value:function e(t){var r=t;if(typeof t!=="number"){r=this.wot.getSetting("defaultColumnWidth")}if(this.correctHeaderWidth){r+=1}return r}}]);return i}();var v=i;t.default=v},function(e,t,r){"use strict";var n=r(20);var i=r(366);n({target:"Array",proto:true,forced:[].forEach!=i},{forEach:i})},function(e,t,r){var n=r(35);var i=r(214);var a=r(366);var o=r(67);for(var s in i){var l=n[s];var u=l&&l.prototype;if(u&&u.forEach!==a)try{o(u,"forEach",a)}catch(e){u.forEach=a}}},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.registerIdentity=c;t.getTranslator=d;t.getIdentity=h;t.RecordTranslator=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(181));var s=r(3);var l=function(){function t(e){(0,i.default)(this,t);this.hot=e}(0,a.default)(t,[{key:"toVisualRow",value:function e(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function e(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function e(t,r){var n;if((0,s.isObject)(t)){n={row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}}else{n=[this.toVisualRow(t),this.toVisualColumn(r)]}return n}},{key:"toPhysicalRow",value:function e(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function e(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function e(t,r){var n;if((0,s.isObject)(t)){n={row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}}else{n=[this.toPhysicalRow(t),this.toPhysicalColumn(r)]}return n}}]);return t}();t.RecordTranslator=l;var u=new WeakMap;var f=new WeakMap;function c(e,t){u.set(e,t)}function d(e){var t=e instanceof o.default?e:h(e);var r;if(f.has(t)){r=f.get(t)}else{r=new l(t);f.set(t,r)}return r}function h(e){if(!u.has(e)){throw Error("Record translator was not registered for this object identity")}return u.get(e)}},function(e,t,r){"use strict";var n=r(20);var i=r(75).some;var a=r(84);var o=r(59);var s=a("some");var l=o("some");n({target:"Array",proto:true,forced:!s||!l},{some:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var n=r(20);var i=r(75).every;var a=r(84);var o=r(59);var s=a("every");var l=o("every");n({target:"Array",proto:true,forced:!s||!l},{every:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var n=r(0);r(19);r(12);r(78);r(33);t.__esModule=true;t.default=void 0;var i=n(r(37));var o=r(4);var a=r(3);var s=r(17);var l="arrayMapper";var u={_arrayMap:[],getValueByIndex:function e(t){var r=this._arrayMap.length;var n=null;if(t<r){n=this._arrayMap[t]}return n},getIndexByValue:function e(t){var r;return(r=this._arrayMap.indexOf(t))===-1?null:r},insertItems:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var i=(0,o.arrayMax)(this._arrayMap)+1;var a=[];(0,s.rangeEach)(n-1,function(e){a.push(r._arrayMap.splice(t+e,0,i+e))});return a},removeItems:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=[];if(Array.isArray(t)){var i=[].concat(this._arrayMap);t.sort(function(e,t){return t-e});for(var a=0,o=t.length;a<o;a++){var s=t[a];this._arrayMap.splice(s,1);n.push(i[s])}}else{n=this._arrayMap.splice(t,r)}return n},unshiftItems:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var i=this.removeItems(t,r);function n(n){return(0,o.arrayReduce)(i,function(e,t){var r=e;if(n>t){r+=1}return r},0)}this._arrayMap=(0,o.arrayMap)(this._arrayMap,function(e){var t=e;var r=n(t);if(r){t-=r}return t})},shiftItems:function e(r){var t=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this._arrayMap=(0,o.arrayMap)(this._arrayMap,function(e){var t=e;if(t>=r){t+=n}return t});(0,s.rangeEach)(n-1,function(e){t._arrayMap.splice(r+e,0,r+e)})},swapIndexes:function e(t,r){var n;(n=this._arrayMap).splice.apply(n,[r,0].concat((0,i.default)(this._arrayMap.splice(t,1))))},clearMap:function e(){this._arrayMap.length=0}};(0,a.defineGetter)(u,"MIXIN_NAME",l,{writable:false,enumerable:false});var f=u;t.default=f},function(e,t,r){"use strict";r(19);t.__esModule=true;t.createId=n;t.createDefaultCustomBorder=i;t.createSingleEmptyBorder=a;t.createDefaultHtBorder=l;t.createEmptyBorders=u;t.extendDefaultBorder=f;t.checkSelectionBorders=c;t.markSelected=d;var o=r(3);var s=r(4);function n(e,t){return"border_row".concat(e,"col").concat(t)}function i(){return{width:1,color:"#000"}}function a(){return{hide:true}}function l(){return{width:1,color:"#000",cornerVisible:false}}function u(e,t){return{id:n(e,t),border:l(),row:e,col:t,top:a(),right:a(),bottom:a(),left:a()}}function f(e,t){if((0,o.hasOwnProperty)(t,"border")){e.border=t.border}if((0,o.hasOwnProperty)(t,"top")){if(t.top){if(!(0,o.isObject)(t.top)){t.top=i()}e.top=t.top}else{t.top=a();e.top=t.top}}if((0,o.hasOwnProperty)(t,"right")){if(t.right){if(!(0,o.isObject)(t.right)){t.right=i()}e.right=t.right}else{t.right=a();e.right=t.right}}if((0,o.hasOwnProperty)(t,"bottom")){if(t.bottom){if(!(0,o.isObject)(t.bottom)){t.bottom=i()}e.bottom=t.bottom}else{t.bottom=a();e.bottom=t.bottom}}if((0,o.hasOwnProperty)(t,"left")){if(t.left){if(!(0,o.isObject)(t.left)){t.left=i()}e.left=t.left}else{t.left=a();e.left=t.left}}return e}function c(n,i){var a=false;(0,s.arrayEach)(n.getSelectedRange(),function(e){e.forAll(function(e,t){var r=n.getCellMeta(e,t).borders;if(r){if(i){if(!(0,o.hasOwnProperty)(r[i],"hide")||r[i].hide===false){a=true;return false}}else{a=true;return false}}})});return a}function d(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}},function(e,t){e.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},function(e,t,r){var n=r(26);var i=r(80);var a="".split;e.exports=n(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return i(e)=="String"?a.call(e,""):Object(e)}:Object},function(e,t,r){var i=r(45);e.exports=function(e,t){if(!i(e))return e;var r,n;if(t&&typeof(r=e.toString)=="function"&&!i(n=r.call(e)))return n;if(typeof(r=e.valueOf)=="function"&&!i(n=r.call(e)))return n;if(!t&&typeof(r=e.toString)=="function"&&!i(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports={}},function(e,t,r){var n=r(200);var i=r(35);var a=function(e){return typeof e=="function"?e:undefined};e.exports=function(e,t){return arguments.length<2?a(n[e])||a(i[e]):n[e]&&n[e][t]||i[e]&&i[e][t]}},function(e,t,r){var n=r(201);var i=r(159);var a=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function e(t){return n(t,a)}},function(e,t,r){var n=r(36);var i=r(110);var a=r(51);var o=n("unscopables");var s=Array.prototype;if(s[o]==undefined){a.f(s,o,{configurable:true,value:i(null)})}e.exports=function(e){s[o][e]=true}},function(e,t,r){var i=r(48);var a=r(421);var n=r(159);var o=r(106);var s=r(204);var l=r(155);var u=r(131);var f=">";var c="<";var d="prototype";var h="script";var v=u("IE_PROTO");var p=function(){};var g=function(e){return c+h+f+e+c+"/"+h+f};var m=function(e){e.write(g(""));e.close();var t=e.parentWindow.Object;e=null;return t};var y=function(){var e=l("iframe");var t="java"+h+":";var r;e.style.display="none";s.appendChild(e);e.src=String(t);r=e.contentWindow.document;r.open();r.write(g("document.F=Object"));r.close();return r.F};var b;var w=function(){try{b=document.domain&&new ActiveXObject("htmlfile")}catch(e){}w=b?m(b):y();var e=n.length;while(e--)delete w[d][n[e]];return w()};o[v]=true;e.exports=Object.create||function e(t,r){var n;if(t!==null){p[d]=i(t);n=new p;p[d]=null;n[v]=t}else n=w();return r===undefined?n:a(n,r)}},function(e,t,r){var n=r(201);var i=r(159);e.exports=Object.keys||function e(t){return n(t,i)}},function(e,t){e.exports={}},function(e,t,r){var a=r(138);e.exports=function(n,i,e){a(n);if(i===undefined)return n;switch(e){case 0:return function(){return n.call(i)};case 1:return function(e){return n.call(i,e)};case 2:return function(e,t){return n.call(i,e,t)};case 3:return function(e,t,r){return n.call(i,e,t,r)}}return function(){return n.apply(i,arguments)}}},function(e,t,r){var n=r(80);e.exports=Array.isArray||function e(t){return n(t)=="Array"}},function(e,t,r){"use strict";var i=r(105);var a=r(51);var o=r(103);e.exports=function(e,t,r){var n=i(t);if(n in e)a.f(e,n,o(0,r));else e[n]=r}},function(e,t,r){var n=r(26);var i=r(36);var a=r(218);var o=i("species");e.exports=function(r){return a>=51||!n(function(){var e=[];var t=e.constructor={};t[o]=function(){return{foo:1}};return e[r](Boolean).foo!==1})}},function(e,t,r){"use strict";var n=r(0);r(143);t.__esModule=true;t.default=t.EditorState=void 0;var i=n(r(6));var a=n(r(5));var o=n(r(7));var s=n(r(1));var l=n(r(2));var u=r(27);var f=r(29);var c=r(3);var d=n(r(462));var h={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};t.EditorState=h;var v=function(){function t(e){(0,s.default)(this,t);this.hot=e;this.instance=e;this.state=h.VIRGIN;this._opened=false;this._fullEditMode=false;this._closeCallback=null;this.TD=null;this.row=null;this.col=null;this.prop=null;this.originalValue=null;this.cellProperties=null;this.init()}(0,l.default)(t,[{key:"_fireCallbacks",value:function e(t){if(this._closeCallback){this._closeCallback(t);this._closeCallback=null}}},{key:"init",value:function e(){}},{key:"getValue",value:function e(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function e(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function e(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function e(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function e(t,r,n,i,a,o){this.TD=i;this.row=t;this.col=r;this.prop=n;this.originalValue=a;this.cellProperties=o;this.state=h.VIRGIN}},{key:"extend",value:function e(){return function(e){(0,o.default)(t,e);function t(){(0,s.default)(this,t);return(0,i.default)(this,(0,a.default)(t).apply(this,arguments))}return t}(this.constructor)}},{key:"saveValue",value:function e(t,r){var n;var i;if(r){n=this.hot.getSelectedLast();if(n[0]>n[2]){i=n[0];n[0]=n[2];n[2]=i}if(n[1]>n[3]){i=n[1];n[1]=n[3];n[3]=i}}else{n=[this.row,this.col,null,null]}this.hot.populateFromArray(n[0],n[1],t,n[2],n[3],"edit")}},{key:"beginEditing",value:function e(t,r){if(this.state!==h.VIRGIN){return}this.hot.view.scrollViewport(new u.CellCoords(this.row,this.col));this.state=h.EDITING;if(this.isInFullEditMode()){var n=typeof t==="string"?t:(0,f.stringify)(this.originalValue);this.setValue(n)}this.open(r);this._opened=true;this.focus();this.hot.view.render();this.hot.runHooks("afterBeginEditing",this.row,this.col)}},{key:"finishEditing",value:function e(t,r,n){var i=this;var a;if(n){var o=this._closeCallback;this._closeCallback=function(e){if(o){o(e)}n(e);i.hot.view.render()}}if(this.isWaiting()){return}if(this.state===h.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(true)});return}if(this.state===h.EDITING){if(t){this.cancelChanges();this.hot.view.render();return}var s=this.getValue();if(this.hot.getSettings().trimWhitespace){a=[[typeof s==="string"?String.prototype.trim.call(s||""):s]]}else{a=[[s]]}this.state=h.WAITING;this.saveValue(a,r);if(this.hot.getCellValidator(this.cellProperties)){this.hot.addHookOnce("postAfterValidate",function(e){i.state=h.FINISHED;i.discardEditor(e)})}else{this.state=h.FINISHED;this.discardEditor(true)}}}},{key:"cancelChanges",value:function e(){this.state=h.FINISHED;this.discardEditor()}},{key:"discardEditor",value:function e(t){if(this.state!==h.FINISHED){return}if(t===false&&this.cellProperties.allowInvalid!==true){this.hot.selectCell(this.row,this.col);this.focus();this.state=h.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this._fullEditMode=false;this.state=h.VIRGIN;this._fireCallbacks(true)}}},{key:"enableFullEditMode",value:function e(){this._fullEditMode=true}},{key:"isInFullEditMode",value:function e(){return this._fullEditMode}},{key:"isOpened",value:function e(){return this._opened}},{key:"isWaiting",value:function e(){return this.state===h.WAITING}},{key:"getEditedCellsLayerClass",value:function e(){var t=this.checkEditorSection();switch(t){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function e(){return this.hot.getCell(this.row,this.col,true)}},{key:"checkEditorSection",value:function e(){var t=this.hot.countRows();var r="";if(this.row<this.hot.getSettings().fixedRowsTop){if(this.col<this.hot.getSettings().fixedColumnsLeft){r="top-left-corner"}else{r="top"}}else if(this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom){if(this.col<this.hot.getSettings().fixedColumnsLeft){r="bottom-left-corner"}else{r="bottom"}}else if(this.col<this.hot.getSettings().fixedColumnsLeft){r="left"}return r}}]);return t}();(0,c.mixin)(v,d.default);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function r(e,t){(0,i.default)(this,r);this.row=null;this.col=null;if(typeof e!=="undefined"&&typeof t!=="undefined"){this.row=e;this.col=t}}(0,a.default)(r,[{key:"isValid",value:function e(t){if(this.row<0||this.col<0){return false}if(this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns")){return false}return true}},{key:"isEqual",value:function e(t){if(t===this){return true}return this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function e(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function e(t){return this.row<=t.row&&this.col<=t.col}},{key:"isSouthWestOf",value:function e(t){return this.row>=t.row&&this.col<=t.col}},{key:"isNorthEastOf",value:function e(t){return this.row<=t.row&&this.col>=t.col}},{key:"toObject",value:function e(){return{row:this.row,col:this.col}}}]);return r}();var s=o;t.default=s},function(e,t,r){var n=r(44);var i=r(35);var a=r(134);var l=r(169);var o=r(51).f;var s=r(108).f;var u=r(172);var f=r(171);var c=r(219);var d=r(68);var h=r(26);var v=r(81).set;var p=r(216);var g=r(36);var m=g("match");var y=i.RegExp;var b=y.prototype;var w=/a/g;var C=/a/g;var S=new y(w)!==w;var E=c.UNSUPPORTED_Y;var k=n&&a("RegExp",!S||E||h(function(){C[m]=false;return y(w)!=w||y(C)==C||y(w,"i")!="/a/i"}));if(k){var T=function e(t,r){var n=this instanceof T;var i=u(t);var a=r===undefined;var o;if(!n&&i&&t.constructor===T&&a){return t}if(S){if(i&&!a)t=t.source}else if(t instanceof T){if(a)r=f.call(t);t=t.source}if(E){o=!!r&&r.indexOf("y")>-1;if(o)r=r.replace(/y/g,"")}var s=l(S?new y(t,r):y(t,r),n?this:b,T);if(E&&o)v(s,{sticky:o});return s};var _=function(t){t in T||o(T,t,{configurable:true,get:function(){return y[t]},set:function(e){y[t]=e}})};var x=s(y);var D=0;while(x.length>D)_(x[D++]);b.constructor=T;T.prototype=b;d(i,"RegExp",T)}p("RegExp")},function(e,t,r){"use strict";var n=r(141);var c=r(48);var d=r(49);var a=r(53);var h=r(173);var v=r(142);n("match",1,function(i,u,f){return[function e(t){var r=a(this);var n=t==undefined?undefined:t[i];return n!==undefined?n.call(t,r):new RegExp(t)[i](String(r))},function(e){var t=f(u,e,this);if(t.done)return t.value;var r=c(e);var n=String(this);if(!r.global)return v(r,n);var i=r.unicode;r.lastIndex=0;var a=[];var o=0;var s;while((s=v(r,n))!==null){var l=String(s[0]);a[o]=l;if(l==="")r.lastIndex=h(n,d(r.lastIndex),i);o++}return o===0?null:a}]})},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(436));var s=function(){function r(e,t){(0,i.default)(this,r);this.nodesPool=typeof e==="string"?new o.default(e):null;this.nodeType=e;this.rootNode=t;this.table=null;this.renderedNodes=0}(0,a.default)(r,[{key:"setTable",value:function e(t){if(this.nodesPool){this.nodesPool.setRootDocument(t.rootDocument)}this.table=t}},{key:"adjust",value:function e(){}},{key:"render",value:function e(){}}]);return r}();t.default=s},function(n,e,t){var s=t(222);function i(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function a(e,t,r){if(i()){n.exports=a=Reflect.construct}else{n.exports=a=function e(t,r,n){var i=[null];i.push.apply(i,r);var a=Function.bind.apply(t,i);var o=new a;if(n)s(o,n.prototype);return o}}return a.apply(null,arguments)}n.exports=a},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(19);r(31);r(12);r(41);t.__esModule=true;t.default=void 0;var a=i(r(1));var o=i(r(2));var s=i(r(6));var l=i(r(28));var h=i(r(5));var v=i(r(14));var u=i(r(7));var P=r(8);var f=r(17);var c=i(r(464));var p=r(71);var F=n(r(117));var g=i(r(25));var m=r(55);var y=r(32);var b="ht_editor_visible";var w="ht_editor_hidden";var d=function(e){(0,u.default)(d,e);function d(e){var t;(0,a.default)(this,d);t=(0,s.default)(this,(0,h.default)(d).call(this,e));t.eventManager=new g.default((0,l.default)(t));t.autoResize=(0,c.default)();t.TEXTAREA=void 0;t.textareaStyle=void 0;t.TEXTAREA_PARENT=void 0;t.textareaParentStyle=void 0;t.layerClass=void 0;t.createElements();t.bindEvents();t.hot.addHookOnce("afterDestroy",function(){return t.destroy()});return t}(0,o.default)(d,[{key:"getValue",value:function e(){return this.TEXTAREA.value}},{key:"setValue",value:function e(t){this.TEXTAREA.value=t}},{key:"open",value:function e(){var t=this;this.refreshDimensions();this.showEditableElement();this.addHook("beforeKeyDown",function(e){return t.onBeforeKeyDown(e)})}},{key:"close",value:function e(){this.autoResize.unObserve();if(this.hot.rootDocument.activeElement===this.TEXTAREA){this.hot.listen()}this.hideEditableElement();this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function e(t,r,n,i,a,o){var s=this;var l=this.state;(0,v.default)((0,h.default)(d.prototype),"prepare",this).call(this,t,r,n,i,a,o);if(!o.readOnly){this.refreshDimensions(true);var u=o.allowInvalid,f=o.fragmentSelection;if(u){this.TEXTAREA.value=""}if(l!==F.EditorState.FINISHED){this.hideEditableElement()}var c=!f;if(c&&!(0,p.isMobileBrowser)()){this.hot._registerImmediate(function(){return s.focus(true)})}}}},{key:"beginEditing",value:function e(t,r){if(this.state!==F.EditorState.VIRGIN){return}this.TEXTAREA.value="";(0,v.default)((0,h.default)(d.prototype),"beginEditing",this).call(this,t,r)}},{key:"focus",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(t){(0,P.selectElementIfAllowed)(this.TEXTAREA)}else{this.TEXTAREA.select();(0,P.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}}},{key:"createElements",value:function e(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA");this.TEXTAREA.tabIndex=-1;(0,P.addClass)(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.textareaStyle.overflowY="visible";this.TEXTAREA_PARENT=t.createElement("DIV");(0,P.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder");if((0,P.hasClass)(this.TEXTAREA_PARENT,this.layerClass)){(0,P.removeClass)(this.TEXTAREA_PARENT,this.layerClass)}(0,P.addClass)(this.TEXTAREA_PARENT,w);this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function e(){if((0,p.isIE)()||(0,p.isEdge)()){this.textareaStyle.textIndent="-99999px"}this.textareaStyle.overflowY="visible";this.textareaParentStyle.opacity="0";this.textareaParentStyle.height="1px";if((0,P.hasClass)(this.TEXTAREA_PARENT,this.layerClass)){(0,P.removeClass)(this.TEXTAREA_PARENT,this.layerClass)}(0,P.addClass)(this.TEXTAREA_PARENT,w)}},{key:"showEditableElement",value:function e(){this.textareaParentStyle.height="";this.textareaParentStyle.overflow="";this.textareaParentStyle.position="";this.textareaParentStyle.right="auto";this.textareaParentStyle.opacity="1";this.textareaStyle.textIndent="";this.textareaStyle.overflowY="hidden";var r=this.TEXTAREA_PARENT.childNodes;var n=false;(0,f.rangeEach)(r.length-1,function(e){var t=r[e];if((0,P.hasClass)(t,"handsontableEditor")){n=true;return false}});if((0,P.hasClass)(this.TEXTAREA_PARENT,w)){(0,P.removeClass)(this.TEXTAREA_PARENT,w)}if(n){this.layerClass=b;(0,P.addClass)(this.TEXTAREA_PARENT,this.layerClass)}else{this.layerClass=this.getEditedCellsLayerClass();(0,P.addClass)(this.TEXTAREA_PARENT,this.layerClass)}}},{key:"refreshValue",value:function e(){var t=this.hot.toPhysicalRow(this.row);var r=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=r;this.setValue(r);this.refreshDimensions()}},{key:"refreshDimensions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.state!==F.EditorState.EDITING&&!t){return}this.TD=this.getEditedCell();if(!this.TD){if(!t){this.close()}return}var r=this.hot.view.wt,n=r.wtOverlays,i=r.wtViewport;var a=(0,P.offset)(this.TD);var o=(0,P.offset)(this.hot.rootElement);var s=n.topOverlay.holder;var l=n.leftOverlay.holder;var u=this.hot.countRows();var f=s!==this.hot.rootWindow?s.scrollTop:0;var c=l!==this.hot.rootWindow?l.scrollLeft:0;var d=this.checkEditorSection();var h=["","left"].includes(d)?f:0;var v=["","top","bottom"].includes(d)?c:0;var p=a.top===o.top?0:1;var g=this.hot.getSettings();var m=this.hot.hasColHeaders();var y=this.TD.style.backgroundColor;var b=a.top-o.top-p-h;var w=a.left-o.left-1-v;var C;switch(d){case"top":C=(0,P.getCssTransform)(n.topOverlay.clone.wtTable.holder.parentNode);break;case"left":C=(0,P.getCssTransform)(n.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":C=(0,P.getCssTransform)(n.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":C=(0,P.getCssTransform)(n.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":C=(0,P.getCssTransform)(n.bottomOverlay.clone.wtTable.holder.parentNode);break;default:break}if(m&&this.hot.getSelectedLast()[0]===0||g.fixedRowsBottom&&this.hot.getSelectedLast()[0]===u-g.fixedRowsBottom){b+=1}if(this.hot.getSelectedLast()[1]===0){w+=1}if(C&&C!==-1){this.textareaParentStyle[C[0]]=C[1]}else{(0,P.resetCssTransform)(this.TEXTAREA_PARENT)}this.textareaParentStyle.top="".concat(b,"px");this.textareaParentStyle.left="".concat(w,"px");this.showEditableElement();var S=i.rowsRenderCalculator.startPosition;var E=i.columnsRenderCalculator.startPosition;var k=n.leftOverlay.getScrollPosition();var T=n.topOverlay.getScrollPosition();var _=(0,P.getScrollbarWidth)(this.hot.rootDocument);var x=this.TD.offsetTop+S-T;var D=this.TD.offsetLeft+E-k;var R=(0,P.innerWidth)(this.TD)-8;var I=(0,P.hasVerticalScrollbar)(s)?_:0;var O=(0,P.hasHorizontalScrollbar)(l)?_:0;var A=this.hot.view.maximumVisibleElementWidth(D)-9-I;var N=this.TD.scrollHeight+1;var M=Math.max(this.hot.view.maximumVisibleElementHeight(x)-O,23);var L=(0,P.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=L.fontSize;this.TEXTAREA.style.fontFamily=L.fontFamily;this.TEXTAREA.style.backgroundColor=y;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(N,M),maxHeight:M,minWidth:Math.min(R,A),maxWidth:A},true)}},{key:"bindEvents",value:function e(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){return(0,y.stopPropagation)(e)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){return(0,y.stopPropagation)(e)});this.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()});this.addHook("afterScrollVertically",function(){return t.refreshDimensions()});this.addHook("afterColumnResize",function(){t.refreshDimensions();t.focus()});this.addHook("afterRowResize",function(){t.refreshDimensions();t.focus()})}},{key:"allowKeyEventPropagation",value:function e(){}},{key:"destroy",value:function e(){this.eventManager.destroy();this.clearHooks()}},{key:"onBeforeKeyDown",value:function e(t){var r=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target!==this.TEXTAREA||(0,y.isImmediatePropagationStopped)(t)){return}switch(t.keyCode){case m.KEY_CODES.ARROW_RIGHT:if(this.isInFullEditMode()){if(!this.isWaiting()&&!this.allowKeyEventPropagation(t.keyCode)){(0,y.stopImmediatePropagation)(t)}}break;case m.KEY_CODES.ARROW_LEFT:if(this.isInFullEditMode()){if(!this.isWaiting()&&!this.allowKeyEventPropagation(t.keyCode)){(0,y.stopImmediatePropagation)(t)}}break;case m.KEY_CODES.ARROW_UP:case m.KEY_CODES.ARROW_DOWN:if(this.isInFullEditMode()){if(!this.isWaiting()&&!this.allowKeyEventPropagation(t.keyCode)){(0,y.stopImmediatePropagation)(t)}}break;case m.KEY_CODES.ENTER:{var n=this.hot.selection.isMultiple();if(r&&!n||t.altKey){if(this.isOpened()){var i=(0,P.getCaretPosition)(this.TEXTAREA);var a=this.getValue();var o="".concat(a.slice(0,i),"\n").concat(a.slice(i));this.setValue(o);(0,P.setCaretPosition)(this.TEXTAREA,i+1)}else{this.beginEditing("".concat(this.originalValue,"\n"))}(0,y.stopImmediatePropagation)(t)}t.preventDefault();break}case m.KEY_CODES.BACKSPACE:case m.KEY_CODES.DELETE:case m.KEY_CODES.HOME:case m.KEY_CODES.END:(0,y.stopImmediatePropagation)(t);break;default:break}if([m.KEY_CODES.ARROW_UP,m.KEY_CODES.ARROW_RIGHT,m.KEY_CODES.ARROW_DOWN,m.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)===-1){this.autoResize.resize(String.fromCharCode(t.keyCode))}}}]);return d}(F.default);var C=d;t.default=C},function(e,t,r){"use strict";var n=r(20);var i=r(35);var a=r(107);var o=r(94);var s=r(44);var l=r(161);var u=r(203);var f=r(26);var c=r(47);var d=r(114);var h=r(45);var v=r(48);var p=r(58);var g=r(63);var m=r(105);var y=r(103);var b=r(110);var w=r(111);var C=r(108);var S=r(202);var E=r(160);var k=r(79);var T=r(51);var _=r(130);var x=r(67);var D=r(68);var R=r(157);var I=r(131);var O=r(106);var A=r(132);var N=r(36);var M=r(384);var L=r(385);var P=r(135);var F=r(81);var B=r(75).forEach;var H=I("hidden");var $="Symbol";var W="prototype";var U=N("toPrimitive");var j=F.set;var V=F.getterFor($);var z=Object[W];var q=i.Symbol;var Y=a("JSON","stringify");var G=k.f;var X=T.f;var K=S.f;var J=_.f;var Q=R("symbols");var Z=R("op-symbols");var ee=R("string-to-symbol-registry");var te=R("symbol-to-string-registry");var re=R("wks");var ne=i.QObject;var ie=!ne||!ne[W]||!ne[W].findChild;var ae=s&&f(function(){return b(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=G(z,t);if(n)delete z[t];X(e,t,r);if(n&&e!==z){X(z,t,n)}}:X;var oe=function(e,t){var r=Q[e]=b(q[W]);j(r,{type:$,tag:e,description:t});if(!s)r.description=t;return r};var se=u?function(e){return typeof e=="symbol"}:function(e){return Object(e)instanceof q};var le=function e(t,r,n){if(t===z)le(Z,r,n);v(t);var i=m(r,true);v(n);if(c(Q,i)){if(!n.enumerable){if(!c(t,H))X(t,H,y(1,{}));t[H][i]=true}else{if(c(t,H)&&t[H][i])t[H][i]=false;n=b(n,{enumerable:y(0,false)})}return ae(t,i,n)}return X(t,i,n)};var ue=function e(t,r){v(t);var n=g(r);var i=w(n).concat(ve(n));B(i,function(e){if(!s||ce.call(n,e))le(t,e,n[e])});return t};var fe=function e(t,r){return r===undefined?b(t):ue(b(t),r)};var ce=function e(t){var r=m(t,true);var n=J.call(this,r);if(this===z&&c(Q,r)&&!c(Z,r))return false;return n||!c(this,r)||!c(Q,r)||c(this,H)&&this[H][r]?n:true};var de=function e(t,r){var n=g(t);var i=m(r,true);if(n===z&&c(Q,i)&&!c(Z,i))return;var a=G(n,i);if(a&&c(Q,i)&&!(c(n,H)&&n[H][i])){a.enumerable=true}return a};var he=function e(t){var r=K(g(t));var n=[];B(r,function(e){if(!c(Q,e)&&!c(O,e))n.push(e)});return n};var ve=function e(t){var r=t===z;var n=K(r?Z:g(t));var i=[];B(n,function(e){if(c(Q,e)&&(!r||c(z,e))){i.push(Q[e])}});return i};if(!l){q=function e(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var t=!arguments.length||arguments[0]===undefined?undefined:String(arguments[0]);var r=A(t);var n=function(e){if(this===z)n.call(Z,e);if(c(this,H)&&c(this[H],r))this[H][r]=false;ae(this,r,y(1,e))};if(s&&ie)ae(z,r,{configurable:true,set:n});return oe(r,t)};D(q[W],"toString",function e(){return V(this).tag});D(q,"withoutSetter",function(e){return oe(A(e),e)});_.f=ce;T.f=le;k.f=de;C.f=S.f=he;E.f=ve;M.f=function(e){return oe(N(e),e)};if(s){X(q[W],"description",{configurable:true,get:function e(){return V(this).description}});if(!o){D(z,"propertyIsEnumerable",ce,{unsafe:true})}}}n({global:true,wrap:true,forced:!l,sham:!l},{Symbol:q});B(w(re),function(e){L(e)});n({target:$,stat:true,forced:!l},{for:function(e){var t=String(e);if(c(ee,t))return ee[t];var r=q(t);ee[t]=r;te[r]=t;return r},keyFor:function e(t){if(!se(t))throw TypeError(t+" is not a symbol");if(c(te,t))return te[t]},useSetter:function(){ie=true},useSimple:function(){ie=false}});n({target:"Object",stat:true,forced:!l,sham:!s},{create:fe,defineProperty:le,defineProperties:ue,getOwnPropertyDescriptor:de});n({target:"Object",stat:true,forced:!l},{getOwnPropertyNames:he,getOwnPropertySymbols:ve});n({target:"Object",stat:true,forced:f(function(){E.f(1)})},{getOwnPropertySymbols:function e(t){return E.f(p(t))}});if(Y){var pe=!l||f(function(){var e=q();return Y([e])!="[null]"||Y({a:e})!="{}"||Y(Object(e))!="{}"});n({target:"JSON",stat:true,forced:pe},{stringify:function e(t,r,n){var i=[t];var a=1;var o;while(arguments.length>a)i.push(arguments[a++]);o=r;if(!h(r)&&t===undefined||se(t))return;if(!d(r))r=function(e,t){if(typeof o=="function")t=o.call(this,e,t);if(!se(t))return t};i[1]=r;return Y.apply(null,i)}})}if(!q[W][U]){x(q[W],U,q[W].valueOf)}P(q,$);O[H]=true},function(e,t,r){"use strict";r(60);r(12);r(15);r(78);r(10);r(88);r(13);r(16);t.__esModule=true;t.sortComparison=a;t.toVisualValue=u;t.createArrayAssertion=f;t.toEmptyString=c;t.unifyColumnValues=d;t.intersectValues=h;var n=r(76);var l=r(4);var i=(0,n.getComparisonFunction)();function a(e,t){if(typeof e==="number"&&typeof t==="number"){return e-t}return i(e,t)}function u(e,t){var r=e;if(r===""){r="(".concat(t,")")}return r}var o=new Set([1]).has(1);var s=o&&typeof Array.from==="function";function f(e){var r=e;if(o){r=new Set(r)}return function(e){var t;if(o){t=r.has(e)}else{t=!!~r.indexOf(e)}return t}}function c(e){return e===null||e===void 0?"":e}function d(e){var t=e;if(s){t=Array.from(new Set(t))}else{t=(0,l.arrayUnique)(t)}t=t.sort(function(e,t){if(typeof e==="number"&&typeof t==="number"){return e-t}if(e===t){return 0}return e>t?1:-1});return t}function h(e,t,n,i){var a=[];var o=e===t;var s;if(!o){s=f(t)}(0,l.arrayEach)(e,function(e){var t=false;if(o||s(e)){t=true}var r={checked:t,value:e,visualValue:u(e,n)};if(i){i(r)}a.push(r)});return a}},function(e,t,r){"use strict";r(56);t.__esModule=true;t.getOperationFunc=i;t.getOperationName=a;t.registerOperation=o;t.operations=void 0;var n={};t.operations=n;function i(e){if(!n[e]){throw Error('Operation with id "'.concat(e,'" does not exist.'))}var r=n[e].func;return function(e,t){return r(e,t)}}function a(e){return n[e].name}function o(e,t,r){n[e]={name:t,func:r}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(153);t.__esModule=true;t.default=void 0;var a=i(r(1));var o=i(r(2));var s=r(3);var l=i(r(62));var u=i(r(25));var f=r(8);var c=r(4);var d=n(r(11));var h="built";var v="building";var p=["click","input","keydown","keypress","keyup","focus","blur","change"];var g=function(){(0,o.default)(r,null,[{key:"DEFAULTS",get:function e(){return(0,s.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:true})}}]);function r(e,t){(0,a.default)(this,r);this.hot=e;this.eventManager=new u.default(this);this.options=(0,s.extend)(r.DEFAULTS,t);this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName);this.buildState=false}(0,o.default)(r,[{key:"setValue",value:function e(t){this.options.value=t;this.update()}},{key:"getValue",value:function e(){return this.options.value}},{key:"isBuilt",value:function e(){return this.buildState===h}},{key:"translateIfPossible",value:function e(t){if(typeof t==="string"&&t.startsWith(d.FILTERS_NAMESPACE)){return this.hot.getTranslatedPhrase(t)}return t}},{key:"build",value:function e(){var n=this;var t=function e(t,r){n.eventManager.addEventListener(t,r,function(e){return n.runLocalHooks(r,e,n)})};if(!this.buildState){this.buildState=v}if(this.options.className){(0,f.addClass)(this._element,this.options.className)}if(this.options.children.length){(0,c.arrayEach)(this.options.children,function(e){return n._element.appendChild(e.element)})}else if(this.options.wrapIt){var r=this.hot.rootDocument.createElement(this.options.tagName);(0,s.objectEach)(this.options,function(e,t){if(r[t]!==void 0&&t!=="className"&&t!=="tagName"&&t!=="children"){r[t]=n.translateIfPossible(e)}});this._element.appendChild(r);(0,c.arrayEach)(p,function(e){return t(r,e)})}else{(0,c.arrayEach)(p,function(e){return t(n._element,e)})}}},{key:"update",value:function e(){}},{key:"reset",value:function e(){this.options.value="";this.update()}},{key:"show",value:function e(){this.element.style.display=""}},{key:"hide",value:function e(){this.element.style.display="none"}},{key:"focus",value:function e(){}},{key:"destroy",value:function e(){this.eventManager.destroy();this.eventManager=null;this.hot=null;if(this._element.parentNode){this._element.parentNode.removeChild(this._element)}this._element=null}},{key:"element",get:function e(){if(this.buildState===v){return this._element}if(this.buildState===h){this.update();return this._element}this.buildState=v;this.build();this.buildState=h;return this._element}}]);return r}();(0,s.mixin)(g,l.default);var m=g;t.default=m},function(n,e,t){(function e(t,r){if(true)n.exports=r();else{}})(typeof self!=="undefined"?self:this,function(){return function(r){var n={};function i(e){if(n[e]){return n[e].exports}var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=r;i.c=n;i.d=function(e,t,r){if(!i.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:r})}};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=15)}([function(e,t){t.nil=new Error("#NULL!");t.div0=new Error("#DIV/0!");t.value=new Error("#VALUE!");t.ref=new Error("#REF!");t.name=new Error("#NAME?");t.num=new Error("#NUM!");t.na=new Error("#N/A");t.error=new Error("#ERROR!");t.data=new Error("#GETTING_DATA")},function(e,i,t){var a=t(0);i.flattenShallow=function(e){if(!e||!e.reduce){return e}return e.reduce(function(e,t){var r=Array.isArray(e);var n=Array.isArray(t);if(r&&n){return e.concat(t)}if(r){e.push(t);return e}if(n){return[e].concat(t)}return[e,t]})};i.isFlat=function(e){if(!e){return false}for(var t=0;t<e.length;++t){if(Array.isArray(e[t])){return false}}return true};i.flatten=function(){var e=i.argsToArray.apply(null,arguments);while(!i.isFlat(e)){e=i.flattenShallow(e)}return e};i.argsToArray=function(e){var t=[];i.arrayEach(e,function(e){t.push(e)});return t};i.numbers=function(){var e=this.flatten.apply(null,arguments);return e.filter(function(e){return typeof e==="number"})};i.cleanFloat=function(e){var t=1e14;return Math.round(e*t)/t};i.parseBool=function(e){if(typeof e==="boolean"){return e}if(e instanceof Error){return e}if(typeof e==="number"){return e!==0}if(typeof e==="string"){var t=e.toUpperCase();if(t==="TRUE"){return true}if(t==="FALSE"){return false}}if(e instanceof Date&&!isNaN(e)){return true}return a.value};i.parseNumber=function(e){if(e===undefined||e===""){return a.value}if(!isNaN(e)){return parseFloat(e)}return a.value};i.parseNumberArray=function(e){var t;if(!e||(t=e.length)===0){return a.value}var r;while(t--){r=i.parseNumber(e[t]);if(r===a.value){return r}e[t]=r}return e};i.parseMatrix=function(e){var t;if(!e||(t=e.length)===0){return a.value}var r;for(var n=0;n<e.length;n++){r=i.parseNumberArray(e[n]);e[n]=r;if(r instanceof Error){return r}}return e};var r=new Date(Date.UTC(1900,0,1));i.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date){return new Date(e)}var t=parseInt(e,10);if(t<0){return a.num}if(t<=60){return new Date(r.getTime()+(t-1)*864e5)}return new Date(r.getTime()+(t-2)*864e5)}if(typeof e==="string"){e=new Date(e);if(!isNaN(e)){return e}}return a.value};i.parseDateArray=function(e){var t=e.length;var r;while(t--){r=this.parseDate(e[t]);if(r===a.value){return r}e[t]=r}return e};i.anyIsError=function(){var e=arguments.length;while(e--){if(arguments[e]instanceof Error){return true}}return false};i.arrayValuesToNumbers=function(e){var t=e.length;var r;while(t--){r=e[t];if(typeof r==="number"){continue}if(r===true){e[t]=1;continue}if(r===false){e[t]=0;continue}if(typeof r==="string"){var n=this.parseNumber(r);if(n instanceof Error){e[t]=0}else{e[t]=n}}}return e};i.rest=function(e,t){t=t||1;if(!e||typeof e.slice!=="function"){return e}return e.slice(t)};i.initial=function(e,t){t=t||1;if(!e||typeof e.slice!=="function"){return e}return e.slice(0,e.length-t)};i.arrayEach=function(e,t){var r=-1,n=e.length;while(++r<n){if(t(e[r],r,e)===false){break}}return e};i.transpose=function(r){if(!r){return a.value}return r[0].map(function(e,t){return r.map(function(e){return e[t]})})}},function(e,t,r){"use strict";t.__esModule=true;var n;t["default"]=h;t.isValidStrict=v;var i=t.ERROR="ERROR";var a=t.ERROR_DIV_ZERO="DIV/0";var o=t.ERROR_NAME="NAME";var s=t.ERROR_NOT_AVAILABLE="N/A";var l=t.ERROR_NULL="NULL";var u=t.ERROR_NUM="NUM";var f=t.ERROR_REF="REF";var c=t.ERROR_VALUE="VALUE";var d=(n={},n[i]="#ERROR!",n[a]="#DIV/0!",n[o]="#NAME?",n[s]="#N/A",n[l]="#NULL!",n[u]="#NUM!",n[f]="#REF!",n[c]="#VALUE!",n);function h(e){var t=void 0;e=(e+"").replace(/#|!|\?/g,"");if(d[e]){t=d[e]}return t?t:null}function v(e){var t=false;for(var r in d){if(Object.prototype.hasOwnProperty.call(d,r)&&d[r]===e){t=true;break}}return t}},function(e,t,r){"use strict";t.__esModule=true;t.toNumber=n;t.invertNumber=i;function n(e){var t=void 0;if(typeof e==="number"){t=e}else if(typeof e==="string"){t=e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)}return t}function i(e){return-1*n(e)}},function(e,i,t){var p=t(1);var l=t(0);var a=t(5);var o=t(8);var g=t(7);i.ABS=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.abs(e);return t};i.ACOS=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.acos(e);if(isNaN(t)){t=l.num}return t};i.ACOSH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.log(e+Math.sqrt(e*e-1));if(isNaN(t)){t=l.num}return t};i.ACOT=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.atan(1/e);return t};i.ACOTH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=.5*Math.log((e+1)/(e-1));if(isNaN(t)){t=l.num}return t};i.AGGREGATE=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(e);if(p.anyIsError(e,t)){return l.value}switch(e){case 1:return a.AVERAGE(r);case 2:return a.COUNT(r);case 3:return a.COUNTA(r);case 4:return a.MAX(r);case 5:return a.MIN(r);case 6:return i.PRODUCT(r);case 7:return a.STDEV.S(r);case 8:return a.STDEV.P(r);case 9:return i.SUM(r);case 10:return a.VAR.S(r);case 11:return a.VAR.P(r);case 12:return a.MEDIAN(r);case 13:return a.MODE.SNGL(r);case 14:return a.LARGE(r,n);case 15:return a.SMALL(r,n);case 16:return a.PERCENTILE.INC(r,n);case 17:return a.QUARTILE.INC(r,n);case 18:return a.PERCENTILE.EXC(r,n);case 19:return a.QUARTILE.EXC(r,n)}};i.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e)){return l.value}var t=0;e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]});return t};i.ASIN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.asin(e);if(isNaN(t)){t=l.num}return t};i.ASINH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.log(e+Math.sqrt(e*e+1))};i.ATAN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.atan(e)};i.ATAN2=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return Math.atan2(e,t)};i.ATANH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.log((1+e)/(1-e))/2;if(isNaN(t)){t=l.num}return t};i.BASE=function(e,t,r){r=r||0;e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return l.value}r=r===undefined?0:r;var n=e.toString(t);return new Array(Math.max(r+1-n.length,0)).join("0")+n};i.CEILING=function(e,t,r){t=t===undefined?1:Math.abs(t);r=r||0;e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return l.value}if(t===0){return 0}var n=-Math.floor(Math.log(t)/Math.log(10));if(e>=0){return i.ROUND(Math.ceil(e/t)*t,n)}else{if(r===0){return-i.ROUND(Math.floor(Math.abs(e)/t)*t,n)}else{return-i.ROUND(Math.ceil(Math.abs(e)/t)*t,n)}}};i.CEILING.MATH=i.CEILING;i.CEILING.PRECISE=i.CEILING;i.COMBIN=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return i.FACT(e)/(i.FACT(t)*i.FACT(e-t))};i.COMBINA=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return e===0&&t===0?1:i.COMBIN(e+t-1,e-1)};i.COS=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.cos(e)};i.COSH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return(Math.exp(e)+Math.exp(-e))/2};i.COT=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return 1/Math.tan(e)};i.COTH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.exp(2*e);return(t+1)/(t-1)};i.CSC=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return 1/Math.sin(e)};i.CSCH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return 2/(Math.exp(e)-Math.exp(-e))};i.DECIMAL=function(e,t){if(arguments.length<1){return l.value}return parseInt(e,t)};i.DEGREES=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return e*180/Math.PI};i.EVEN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return i.CEILING(e,-2,-1)};i.EXP=function(e){if(arguments.length<1){return l.na}if(typeof e!=="number"||arguments.length>1){return l.error}e=Math.exp(e);return e};var r=[];i.FACT=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.floor(e);if(t===0||t===1){return 1}else if(r[t]>0){return r[t]}else{r[t]=i.FACT(t-1)*t;return r[t]}};i.FACTDOUBLE=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.floor(e);if(t<=0){return 1}else{return t*i.FACTDOUBLE(t-2)}};i.FLOOR=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}if(t===0){return 0}if(!(e>0&&t>0)&&!(e<0&&t<0)){return l.num}t=Math.abs(t);var r=-Math.floor(Math.log(t)/Math.log(10));if(e>=0){return i.ROUND(Math.floor(e/t)*t,r)}else{return-i.ROUND(Math.ceil(Math.abs(e)/t),r)}};i.FLOOR.MATH=function(e,t,r){t=t===undefined?1:t;r=r===undefined?0:r;e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return l.value}if(t===0){return 0}t=t?Math.abs(t):1;var n=-Math.floor(Math.log(t)/Math.log(10));if(e>=0){return i.ROUND(Math.floor(e/t)*t,n)}else if(r===0||r===undefined){return-i.ROUND(Math.ceil(Math.abs(e)/t)*t,n)}return-i.ROUND(Math.floor(Math.abs(e)/t)*t,n)};i.FLOOR.PRECISE=i.FLOOR.MATH;i.GCD=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=e.length;var r=e[0];var n=r<0?-r:r;for(var i=1;i<t;i++){var a=e[i];var o=a<0?-a:a;while(n&&o){if(n>o){n%=o}else{o%=n}}n+=o}return n};i.INT=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.floor(e)};i.ISO={CEILING:i.CEILING};i.LCM=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}for(var t,r,n,i,a=1;(n=e.pop())!==undefined;){while(n>1){if(n%2){for(t=3,r=Math.floor(Math.sqrt(n));t<=r&&n%t;t+=2){}i=t<=r?t:n}else{i=2}for(n/=i,a*=i,t=e.length;t;e[--t]%i===0&&(e[t]/=i)===1&&e.splice(t,1)){}}}return a};i.LN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.log(e)};i.LN10=function(){return Math.log(10)};i.LN2=function(){return Math.log(2)};i.LOG10E=function(){return Math.LOG10E};i.LOG2E=function(){return Math.LOG2E};i.LOG=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}t=t===undefined?10:t;return Math.log(e)/Math.log(t)};i.LOG10=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.log(e)/Math.log(10)};i.MOD=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}if(t===0){return l.div0}var r=Math.abs(e%t);return t>0?r:-r};i.MROUND=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}if(e*t<0){return l.num}return Math.round(e/t)*t};i.MULTINOMIAL=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=0;var r=1;for(var n=0;n<e.length;n++){t+=e[n];r*=i.FACT(e[n])}return i.FACT(t)/r};i.ODD=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.ceil(Math.abs(e));t=t&1?t:t+1;return e>0?t:-t};i.PI=function(){return Math.PI};i.E=function(){return Math.E};i.POWER=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}var r=Math.pow(e,t);if(isNaN(r)){return l.num}return r};i.PRODUCT=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=1;for(var r=0;r<e.length;r++){t*=e[r]}return t};i.QUOTIENT=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return parseInt(e/t,10)};i.RADIANS=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return e*Math.PI/180};i.RAND=function(){return Math.random()};i.RANDBETWEEN=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return e+Math.ceil((t-e+1)*Math.random())-1};i.ROMAN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=String(e).split("");var r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];var n="";var i=3;while(i--){n=(r[+t.pop()+i*10]||"")+n}return new Array(+t.join("")+1).join("M")+n};i.ROUND=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};i.ROUNDDOWN=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}var r=e>0?1:-1;return r*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)};i.ROUNDUP=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}var r=e>0?1:-1;return r*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)};i.SEC=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return 1/Math.cos(e)};i.SECH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return 2/(Math.exp(e)+Math.exp(-e))};i.SERIESSUM=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);n=p.parseNumberArray(n);if(p.anyIsError(e,t,r,n)){return l.value}var i=n[0]*Math.pow(e,t);for(var a=1;a<n.length;a++){i+=n[a]*Math.pow(e,t+a*r)}return i};i.SIGN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}if(e<0){return-1}else if(e===0){return 0}else{return 1}};i.SIN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.sin(e)};i.SINH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return(Math.exp(e)-Math.exp(-e))/2};i.SQRT=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}if(e<0){return l.num}return Math.sqrt(e)};i.SQRTPI=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.sqrt(e*Math.PI)};i.SQRT1_2=function(){return 1/Math.sqrt(2)};i.SQRT2=function(){return Math.sqrt(2)};i.SUBTOTAL=function(e,t){e=p.parseNumber(e);if(e instanceof Error){return e}switch(e){case 1:return a.AVERAGE(t);case 2:return a.COUNT(t);case 3:return a.COUNTA(t);case 4:return a.MAX(t);case 5:return a.MIN(t);case 6:return i.PRODUCT(t);case 7:return a.STDEV.S(t);case 8:return a.STDEV.P(t);case 9:return i.SUM(t);case 10:return a.VAR.S(t);case 11:return a.VAR.P(t);case 101:return a.AVERAGE(t);case 102:return a.COUNT(t);case 103:return a.COUNTA(t);case 104:return a.MAX(t);case 105:return a.MIN(t);case 106:return i.PRODUCT(t);case 107:return a.STDEV.S(t);case 108:return a.STDEV.P(t);case 109:return i.SUM(t);case 110:return a.VAR.S(t);case 111:return a.VAR.P(t)}};i.ADD=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return e+t};i.MINUS=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return e-t};i.DIVIDE=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}if(t===0){return l.div0}return e/t};i.MULTIPLY=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}return e*t};i.GTE=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.error}return e>=t};i.LT=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.error}return e<t};i.LTE=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.error}return e<=t};i.EQ=function(e,t){if(arguments.length!==2){return l.na}return e===t};i.NE=function(e,t){if(arguments.length!==2){return l.na}return e!==t};i.POW=function(e,t){if(arguments.length!==2){return l.na}e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.error}return i.POWER(e,t)};i.SUM=function(){var r=0;p.arrayEach(p.argsToArray(arguments),function(e){if(typeof e==="number"){r+=e}else if(typeof e==="string"){var t=parseFloat(e);!isNaN(t)&&(r+=t)}else if(Array.isArray(e)){r+=i.SUM.apply(null,e)}});return r};i.SUMIF=function(e,t){e=p.parseNumberArray(p.flatten(e));if(e instanceof Error){return e}var r=0;var n=t===void 0||t==="*";var i=n?null:g.parse(t+"");for(var a=0;a<e.length;a++){var o=e[a];if(n){r+=o}else{var s=[g.createToken(o,g.TOKEN_TYPE_LITERAL)].concat(i);r+=g.compute(s)?o:0}}return r};i.SUMIFS=function(){var e=p.argsToArray(arguments);var t=p.parseNumberArray(p.flatten(e.shift()));if(t instanceof Error){return t}var r=e;var n=t.length;var i=r.length;var a=0;for(var o=0;o<n;o++){var s=t[o];var l=false;for(var u=0;u<i;u++){var f=r[u];var c=f===void 0||f==="*";var d=false;if(c){d=true}else{var h=g.parse(f+"");var v=[g.createToken(s,g.TOKEN_TYPE_LITERAL)].concat(h);d=g.compute(v)}if(!d){l=false;break}l=true}if(l){a+=s}}return a};i.SUMPRODUCT=function(){if(!arguments||arguments.length===0){return l.value}var e=arguments.length+1;var t=0;var r;var n;var i;var a;for(var o=0;o<arguments[0].length;o++){if(!(arguments[0][o]instanceof Array)){r=1;for(n=1;n<e;n++){i=p.parseNumber(arguments[n-1][o]);if(i instanceof Error){return i}r*=i}t+=r}else{for(var s=0;s<arguments[0][o].length;s++){r=1;for(n=1;n<e;n++){a=p.parseNumber(arguments[n-1][o][s]);if(a instanceof Error){return a}r*=a}t+=r}}}return t};i.SUMSQ=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=0;var r=e.length;for(var n=0;n<r;n++){t+=o.ISNUMBER(e[n])?e[n]*e[n]:0}return t};i.SUMX2MY2=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return l.value}var r=0;for(var n=0;n<e.length;n++){r+=e[n]*e[n]-t[n]*t[n]}return r};i.SUMX2PY2=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return l.value}var r=0;e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));for(var n=0;n<e.length;n++){r+=e[n]*e[n]+t[n]*t[n]}return r};i.SUMXMY2=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return l.value}var r=0;e=p.flatten(e);t=p.flatten(t);for(var n=0;n<e.length;n++){r+=Math.pow(e[n]-t[n],2)}return r};i.TAN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.tan(e)};i.TANH=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.exp(2*e);return(t-1)/(t+1)};i.TRUNC=function(e,t){t=t===undefined?0:t;e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return l.value}var r=e>0?1:-1;return r*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},function(e,l,t){var s=t(4);var r=t(6);var c=t(10);var p=t(1);var g=t(7);var m=t(0);var f=t(11);var n=2.5066282746310002;l.AVEDEV=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}return c.sum(c(e).subtract(c.mean(e)).abs()[0])/e.length};l.AVERAGE=function(){var e=p.numbers(p.flatten(arguments));var t=e.length;var r=0;var n=0;var i;for(var a=0;a<t;a++){r+=e[a];n+=1}i=r/n;if(isNaN(i)){i=m.num}return i};l.AVERAGEA=function(){var e=p.flatten(arguments);var t=e.length;var r=0;var n=0;var i;for(var a=0;a<t;a++){var o=e[a];if(typeof o==="number"){r+=o}if(o===true){r++}if(o!==null){n++}}i=r/n;if(isNaN(i)){i=m.num}return i};l.AVERAGEIF=function(e,t,r){if(arguments.length<=1){return m.na}r=r||e;e=p.flatten(e);r=p.parseNumberArray(p.flatten(r));if(r instanceof Error){return r}var n=0;var i=0;var a=t===void 0||t==="*";var o=a?null:g.parse(t+"");for(var s=0;s<e.length;s++){var l=e[s];if(a){i+=r[s];n++}else{var u=[g.createToken(l,g.TOKEN_TYPE_LITERAL)].concat(o);if(g.compute(u)){i+=r[s];n++}}}return i/n};l.AVERAGEIFS=function(){var e=p.argsToArray(arguments);var t=(e.length-1)/2;var r=p.flatten(e[0]);var n=0;var i=0;for(var a=0;a<r.length;a++){var o=false;for(var s=0;s<t;s++){var l=e[2*s+1][a];var u=e[2*s+2];var f=u===void 0||u==="*";var c=false;if(f){c=true}else{var d=g.parse(u+"");var h=[g.createToken(l,g.TOKEN_TYPE_LITERAL)].concat(d);c=g.compute(h)}if(!c){o=false;break}o=true}if(o){i+=r[a];n++}}var v=i/n;if(isNaN(v)){return 0}else{return v}};l.BETA={};l.BETA.DIST=function(e,t,r,n,i,a){if(arguments.length<4){return m.value}i=i===undefined?0:i;a=a===undefined?1:a;e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);i=p.parseNumber(i);a=p.parseNumber(a);if(p.anyIsError(e,t,r,i,a)){return m.value}e=(e-i)/(a-i);return n?c.beta.cdf(e,t,r):c.beta.pdf(e,t,r)};l.BETA.INV=function(e,t,r,n,i){n=n===undefined?0:n;i=i===undefined?1:i;e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);n=p.parseNumber(n);i=p.parseNumber(i);if(p.anyIsError(e,t,r,n,i)){return m.value}return c.beta.inv(e,t,r)*(i-n)+n};l.BINOM={};l.BINOM.DIST=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);n=p.parseNumber(n);if(p.anyIsError(e,t,r,n)){return m.value}return n?c.binomial.cdf(e,t,r):c.binomial.pdf(e,t,r)};l.BINOM.DIST.RANGE=function(e,t,r,n){n=n===undefined?r:n;e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);n=p.parseNumber(n);if(p.anyIsError(e,t,r,n)){return m.value}var i=0;for(var a=r;a<=n;a++){i+=s.COMBIN(e,a)*Math.pow(t,a)*Math.pow(1-t,e-a)}return i};l.BINOM.INV=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}var n=0;while(n<=e){if(c.binomial.cdf(n,e,t)>=r){return n}n++}};l.CHISQ={};l.CHISQ.DIST=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return r?c.chisquare.cdf(e,t):c.chisquare.pdf(e,t)};l.CHISQ.DIST.RT=function(e,t){if(!e|!t){return m.na}if(e<1||t>Math.pow(10,10)){return m.num}if(typeof e!=="number"||typeof t!=="number"){return m.value}return 1-c.chisquare.cdf(e,t)};l.CHISQ.INV=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return c.chisquare.inv(e,t)};l.CHISQ.INV.RT=function(e,t){if(!e|!t){return m.na}if(e<0||e>1||t<1||t>Math.pow(10,10)){return m.num}if(typeof e!=="number"||typeof t!=="number"){return m.value}return c.chisquare.inv(1-e,t)};l.CHISQ.TEST=function(e,t){if(arguments.length!==2){return m.na}if(!(e instanceof Array)||!(t instanceof Array)){return m.value}if(e.length!==t.length){return m.value}if(e[0]&&t[0]&&e[0].length!==t[0].length){return m.value}var r=e.length;var n,i,a;for(i=0;i<r;i++){if(!(e[i]instanceof Array)){n=e[i];e[i]=[];e[i].push(n)}if(!(t[i]instanceof Array)){n=t[i];t[i]=[];t[i].push(n)}}var o=e[0].length;var s=o===1?r-1:(r-1)*(o-1);var l=0;var u=Math.PI;for(i=0;i<r;i++){for(a=0;a<o;a++){l+=Math.pow(e[i][a]-t[i][a],2)/t[i][a]}}function f(e,t){var r=Math.exp(-.5*e);if(t%2===1){r=r*Math.sqrt(2*e/u)}var n=t;while(n>=2){r=r*e/n;n=n-2}var i=r;var a=t;while(i>1e-10*r){a=a+2;i=i*e/a;r=r+i}return 1-r}return Math.round(f(l,s)*1e6)/1e6};l.COLUMN=function(e,t){if(arguments.length!==2){return m.na}if(t<0){return m.num}if(!(e instanceof Array)||typeof t!=="number"){return m.value}if(e.length===0){return undefined}return c.col(e,t)};l.COLUMNS=function(e){if(arguments.length!==1){return m.na}if(!(e instanceof Array)){return m.value}if(e.length===0){return 0}return c.cols(e)};l.CONFIDENCE={};l.CONFIDENCE.NORM=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return c.normalci(1,e,t,r)[1]-1};l.CONFIDENCE.T=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return c.tci(1,e,t,r)[1]-1};l.CORREL=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}return c.corrcoeff(e,t)};l.COUNT=function(){return p.numbers(p.flatten(arguments)).length};l.COUNTA=function(){var e=p.flatten(arguments);return e.length-l.COUNTBLANK(e)};l.COUNTIN=function(e,t){var r=0;e=p.flatten(e);for(var n=0;n<e.length;n++){if(e[n]===t){r++}}return r};l.COUNTBLANK=function(){var e=p.flatten(arguments);var t=0;var r;for(var n=0;n<e.length;n++){r=e[n];if(r===null||r===""){t++}}return t};l.COUNTIF=function(e,t){e=p.flatten(e);var r=t===void 0||t==="*";if(r){return e.length}var n=0;var i=g.parse(t+"");for(var a=0;a<e.length;a++){var o=e[a];var s=[g.createToken(o,g.TOKEN_TYPE_LITERAL)].concat(i);if(g.compute(s)){n++}}return n};l.COUNTIFS=function(){var e=p.argsToArray(arguments);var t=new Array(p.flatten(e[0]).length);for(var r=0;r<t.length;r++){t[r]=true}for(r=0;r<e.length;r+=2){var n=p.flatten(e[r]);var i=e[r+1];var a=i===void 0||i==="*";if(!a){var o=g.parse(i+"");for(var s=0;s<n.length;s++){var l=n[s];var u=[g.createToken(l,g.TOKEN_TYPE_LITERAL)].concat(o);t[s]=t[s]&&g.compute(u)}}}var f=0;for(r=0;r<t.length;r++){if(t[r]){f++}}return f};l.COUNTUNIQUE=function(){return f.UNIQUE.apply(null,p.flatten(arguments)).length};l.COVARIANCE={};l.COVARIANCE.P=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}var r=c.mean(e);var n=c.mean(t);var i=0;var a=e.length;for(var o=0;o<a;o++){i+=(e[o]-r)*(t[o]-n)}return i/a};l.COVARIANCE.S=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}return c.covariance(e,t)};l.DEVSQ=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=c.mean(e);var r=0;for(var n=0;n<e.length;n++){r+=Math.pow(e[n]-t,2)}return r};l.EXPON={};l.EXPON.DIST=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return r?c.exponential.cdf(e,t):c.exponential.pdf(e,t)};l.F={};l.F.DIST=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return n?c.centralF.cdf(e,t,r):c.centralF.pdf(e,t,r)};l.F.DIST.RT=function(e,t,r){if(arguments.length!==3){return m.na}if(e<0||t<1||r<1){return m.num}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return m.value}return 1-c.centralF.cdf(e,t,r)};l.F.INV=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}if(e<=0||e>1){return m.num}return c.centralF.inv(e,t,r)};l.F.INV.RT=function(e,t,r){if(arguments.length!==3){return m.na}if(e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)){return m.num}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return m.value}return c.centralF.inv(1-e,t,r)};l.F.TEST=function(e,t){if(!e||!t){return m.na}if(!(e instanceof Array)||!(t instanceof Array)){return m.na}if(e.length<2||t.length<2){return m.div0}var r=function(e,t){var r=0;for(var n=0;n<e.length;n++){r+=Math.pow(e[n]-t,2)}return r};var n=s.SUM(e)/e.length;var i=s.SUM(t)/t.length;var a=r(e,n)/(e.length-1);var o=r(t,i)/(t.length-1);return a/o};l.FISHER=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return Math.log((1+e)/(1-e))/2};l.FISHERINV=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}var t=Math.exp(2*e);return(t-1)/(t+1)};l.FORECAST=function(e,t,r){e=p.parseNumber(e);t=p.parseNumberArray(p.flatten(t));r=p.parseNumberArray(p.flatten(r));if(p.anyIsError(e,t,r)){return m.value}var n=c.mean(r);var i=c.mean(t);var a=r.length;var o=0;var s=0;for(var l=0;l<a;l++){o+=(r[l]-n)*(t[l]-i);s+=Math.pow(r[l]-n,2)}var u=o/s;var f=i-u*n;return f+u*e};l.FREQUENCY=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}var r=e.length;var n=t.length;var i=[];for(var a=0;a<=n;a++){i[a]=0;for(var o=0;o<r;o++){if(a===0){if(e[o]<=t[0]){i[0]+=1}}else if(a<n){if(e[o]>t[a-1]&&e[o]<=t[a]){i[a]+=1}}else if(a===n){if(e[o]>t[n-1]){i[n]+=1}}}}return i};l.GAMMA=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}if(e===0){return m.num}if(parseInt(e,10)===e&&e<0){return m.num}return c.gammafn(e)};l.GAMMA.DIST=function(e,t,r,n){if(arguments.length!==4){return m.na}if(e<0||t<=0||r<=0){return m.value}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return m.value}return n?c.gamma.cdf(e,t,r,true):c.gamma.pdf(e,t,r,false)};l.GAMMA.INV=function(e,t,r){if(arguments.length!==3){return m.na}if(e<0||e>1||t<=0||r<=0){return m.num}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return m.value}return c.gamma.inv(e,t,r)};l.GAMMALN=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return c.gammaln(e)};l.GAMMALN.PRECISE=function(e){if(arguments.length!==1){return m.na}if(e<=0){return m.num}if(typeof e!=="number"){return m.value}return c.gammaln(e)};l.GAUSS=function(e){e=p.parseNumber(e);if(e instanceof Error){return e}return c.normal.cdf(e,0,1)-.5};l.GEOMEAN=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}return c.geomean(e)};l.GROWTH=function(e,t,r,n){e=p.parseNumberArray(e);if(e instanceof Error){return e}var i;if(t===undefined){t=[];for(i=1;i<=e.length;i++){t.push(i)}}if(r===undefined){r=[];for(i=1;i<=e.length;i++){r.push(i)}}t=p.parseNumberArray(t);r=p.parseNumberArray(r);if(p.anyIsError(t,r)){return m.value}if(n===undefined){n=true}var a=e.length;var o=0;var s=0;var l=0;var u=0;for(i=0;i<a;i++){var f=t[i];var c=Math.log(e[i]);o+=f;s+=c;l+=f*c;u+=f*f}o/=a;s/=a;l/=a;u/=a;var d;var h;if(n){d=(l-o*s)/(u-o*o);h=s-d*o}else{d=l/u;h=0}var v=[];for(i=0;i<r.length;i++){v.push(Math.exp(h+d*r[i]))}return v};l.HARMEAN=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=e.length;var r=0;for(var n=0;n<t;n++){r+=1/e[n]}return t/r};l.HYPGEOM={};l.HYPGEOM.DIST=function(e,t,r,n,i){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);n=p.parseNumber(n);if(p.anyIsError(e,t,r,n)){return m.value}function o(e,t,r,n){return s.COMBIN(r,e)*s.COMBIN(n-r,t-e)/s.COMBIN(n,t)}function a(e,t,r,n){var i=0;for(var a=0;a<=e;a++){i+=o(a,t,r,n)}return i}return i?a(e,t,r,n):o(e,t,r,n)};l.INTERCEPT=function(e,t){e=p.parseNumberArray(e);t=p.parseNumberArray(t);if(p.anyIsError(e,t)){return m.value}if(e.length!==t.length){return m.na}return l.FORECAST(0,e,t)};l.KURT=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=c.mean(e);var r=e.length;var n=0;for(var i=0;i<r;i++){n+=Math.pow(e[i]-t,4)}n=n/Math.pow(c.stdev(e,true),4);return r*(r+1)/((r-1)*(r-2)*(r-3))*n-3*(r-1)*(r-1)/((r-2)*(r-3))};l.LARGE=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return e}return e.sort(function(e,t){return t-e})[t-1]};l.LINEST=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}var r=c.mean(e);var n=c.mean(t);var i=t.length;var a=0;var o=0;for(var s=0;s<i;s++){a+=(t[s]-n)*(e[s]-r);o+=Math.pow(t[s]-n,2)}var l=a/o;var u=r-l*n;return[l,u]};l.LOGEST=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}for(var r=0;r<e.length;r++){e[r]=Math.log(e[r])}var n=l.LINEST(e,t);n[0]=Math.round(Math.exp(n[0])*1e6)/1e6;n[1]=Math.round(Math.exp(n[1])*1e6)/1e6;return n};l.LOGNORM={};l.LOGNORM.DIST=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return n?c.lognormal.cdf(e,t,r):c.lognormal.pdf(e,t,r)};l.LOGNORM.INV=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return c.lognormal.inv(e,t,r)};l.MAX=function(){var e=p.numbers(p.flatten(arguments));return e.length===0?0:Math.max.apply(Math,e)};l.MAXA=function(){var e=p.arrayValuesToNumbers(p.flatten(arguments));return e.length===0?0:Math.max.apply(Math,e)};l.MEDIAN=function(){var e=p.arrayValuesToNumbers(p.flatten(arguments));var t=c.median(e);if(isNaN(t)){t=m.num}return t};l.MIN=function(){var e=p.numbers(p.flatten(arguments));return e.length===0?0:Math.min.apply(Math,e)};l.MINA=function(){var e=p.arrayValuesToNumbers(p.flatten(arguments));return e.length===0?0:Math.min.apply(Math,e)};l.MODE={};l.MODE.MULT=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=e.length;var r={};var n=[];var i=0;var a;for(var o=0;o<t;o++){a=e[o];r[a]=r[a]?r[a]+1:1;if(r[a]>i){i=r[a];n=[]}if(r[a]===i){n[n.length]=a}}return n};l.MODE.SNGL=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}return l.MODE.MULT(e).sort(function(e,t){return e-t})[0]};l.NEGBINOM={};l.NEGBINOM.DIST=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return n?c.negbin.cdf(e,t,r):c.negbin.pdf(e,t,r)};l.NORM={};l.NORM.DIST=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}if(r<=0){return m.num}return n?c.normal.cdf(e,t,r):c.normal.pdf(e,t,r)};l.NORM.INV=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return c.normal.inv(e,t,r)};l.NORM.S={};l.NORM.S.DIST=function(e,t){e=p.parseNumber(e);if(e instanceof Error){return m.value}return t?c.normal.cdf(e,0,1):c.normal.pdf(e,0,1)};l.NORM.S.INV=function(e){e=p.parseNumber(e);if(e instanceof Error){return m.value}return c.normal.inv(e,0,1)};l.PEARSON=function(e,t){t=p.parseNumberArray(p.flatten(t));e=p.parseNumberArray(p.flatten(e));if(p.anyIsError(t,e)){return m.value}var r=c.mean(e);var n=c.mean(t);var i=e.length;var a=0;var o=0;var s=0;for(var l=0;l<i;l++){a+=(e[l]-r)*(t[l]-n);o+=Math.pow(e[l]-r,2);s+=Math.pow(t[l]-n,2)}return a/Math.sqrt(o*s)};l.PERCENTILE={};l.PERCENTILE.EXC=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}e=e.sort(function(e,t){{return e-t}});var r=e.length;if(t<1/(r+1)||t>1-1/(r+1)){return m.num}var n=t*(r+1)-1;var i=Math.floor(n);return p.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))};l.PERCENTILE.INC=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}e=e.sort(function(e,t){return e-t});var r=e.length;var n=t*(r-1);var i=Math.floor(n);return p.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))};l.PERCENTRANK={};l.PERCENTRANK.EXC=function(e,t,r){r=r===undefined?3:r;e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}e=e.sort(function(e,t){return e-t});var n=f.UNIQUE.apply(null,e);var i=e.length;var a=n.length;var o=Math.pow(10,r);var s=0;var l=false;var u=0;while(!l&&u<a){if(t===n[u]){s=(e.indexOf(n[u])+1)/(i+1);l=true}else if(t>=n[u]&&(t<n[u+1]||u===a-1)){s=(e.indexOf(n[u])+1+(t-n[u])/(n[u+1]-n[u]))/(i+1);l=true}u++}return Math.floor(s*o)/o};l.PERCENTRANK.INC=function(e,t,r){r=r===undefined?3:r;e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}e=e.sort(function(e,t){return e-t});var n=f.UNIQUE.apply(null,e);var i=e.length;var a=n.length;var o=Math.pow(10,r);var s=0;var l=false;var u=0;while(!l&&u<a){if(t===n[u]){s=e.indexOf(n[u])/(i-1);l=true}else if(t>=n[u]&&(t<n[u+1]||u===a-1)){s=(e.indexOf(n[u])+(t-n[u])/(n[u+1]-n[u]))/(i-1);l=true}u++}return Math.floor(s*o)/o};l.PERMUT=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return s.FACT(e)/s.FACT(e-t)};l.PERMUTATIONA=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return Math.pow(e,t)};l.PHI=function(e){e=p.parseNumber(e);if(e instanceof Error){return m.value}return Math.exp(-.5*e*e)/n};l.POISSON={};l.POISSON.DIST=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return r?c.poisson.cdf(e,t):c.poisson.pdf(e,t)};l.PROB=function(e,t,r,n){if(r===undefined){return 0}n=n===undefined?r:n;e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));r=p.parseNumber(r);n=p.parseNumber(n);if(p.anyIsError(e,t,r,n)){return m.value}if(r===n){return e.indexOf(r)>=0?t[e.indexOf(r)]:0}var i=e.sort(function(e,t){return e-t});var a=i.length;var o=0;for(var s=0;s<a;s++){if(i[s]>=r&&i[s]<=n){o+=t[e.indexOf(i[s])]}}return o};l.QUARTILE={};l.QUARTILE.EXC=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}switch(t){case 1:return l.PERCENTILE.EXC(e,.25);case 2:return l.PERCENTILE.EXC(e,.5);case 3:return l.PERCENTILE.EXC(e,.75);default:return m.num}};l.QUARTILE.INC=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}switch(t){case 1:return l.PERCENTILE.INC(e,.25);case 2:return l.PERCENTILE.INC(e,.5);case 3:return l.PERCENTILE.INC(e,.75);default:return m.num}};l.RANK={};l.RANK.AVG=function(e,t,r){e=p.parseNumber(e);t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}t=p.flatten(t);r=r||false;var n=r?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(n);var i=t.length;var a=0;for(var o=0;o<i;o++){if(t[o]===e){a++}}return a>1?(2*t.indexOf(e)+a+1)/2:t.indexOf(e)+1};l.RANK.EQ=function(e,t,r){e=p.parseNumber(e);t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}r=r||false;var n=r?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(n);return t.indexOf(e)+1};l.ROW=function(e,t){if(arguments.length!==2){return m.na}if(t<0){return m.num}if(!(e instanceof Array)||typeof t!=="number"){return m.value}if(e.length===0){return undefined}return c.row(e,t)};l.ROWS=function(e){if(arguments.length!==1){return m.na}if(!(e instanceof Array)){return m.value}if(e.length===0){return 0}return c.rows(e)};l.RSQ=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}return Math.pow(l.PEARSON(e,t),2)};l.SKEW=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=c.mean(e);var r=e.length;var n=0;for(var i=0;i<r;i++){n+=Math.pow(e[i]-t,3)}return r*n/((r-1)*(r-2)*Math.pow(c.stdev(e,true),3))};l.SKEW.P=function(){var e=p.parseNumberArray(p.flatten(arguments));if(e instanceof Error){return e}var t=c.mean(e);var r=e.length;var n=0;var i=0;for(var a=0;a<r;a++){i+=Math.pow(e[a]-t,3);n+=Math.pow(e[a]-t,2)}i=i/r;n=n/r;return i/Math.pow(n,3/2)};l.SLOPE=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}var r=c.mean(t);var n=c.mean(e);var i=t.length;var a=0;var o=0;for(var s=0;s<i;s++){a+=(t[s]-r)*(e[s]-n);o+=Math.pow(t[s]-r,2)}return a/o};l.SMALL=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return e}return e.sort(function(e,t){return e-t})[t-1]};l.STANDARDIZE=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return(e-t)/r};l.STDEV={};l.STDEV.P=function(){var e=l.VAR.P.apply(this,arguments);var t=Math.sqrt(e);if(isNaN(t)){t=m.num}return t};l.STDEV.S=function(){var e=l.VAR.S.apply(this,arguments);var t=Math.sqrt(e);return t};l.STDEVA=function(){var e=l.VARA.apply(this,arguments);var t=Math.sqrt(e);return t};l.STDEVPA=function(){var e=l.VARPA.apply(this,arguments);var t=Math.sqrt(e);if(isNaN(t)){t=m.num}return t};l.STEYX=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}var r=c.mean(t);var n=c.mean(e);var i=t.length;var a=0;var o=0;var s=0;for(var l=0;l<i;l++){a+=Math.pow(e[l]-n,2);o+=(t[l]-r)*(e[l]-n);s+=Math.pow(t[l]-r,2)}return Math.sqrt((a-o*o/s)/(i-2))};l.TRANSPOSE=function(e){if(!e){return m.na}return c.transpose(e)};l.T=r.T;l.T.DIST=function(e,t,r){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return r?c.studentt.cdf(e,t):c.studentt.pdf(e,t)};l.T.DIST["2T"]=function(e,t){if(arguments.length!==2){return m.na}if(e<0||t<1){return m.num}if(typeof e!=="number"||typeof t!=="number"){return m.value}return(1-c.studentt.cdf(e,t))*2};l.T.DIST.RT=function(e,t){if(arguments.length!==2){return m.na}if(e<0||t<1){return m.num}if(typeof e!=="number"||typeof t!=="number"){return m.value}return 1-c.studentt.cdf(e,t)};l.T.INV=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}return c.studentt.inv(e,t)};l.T.INV["2T"]=function(e,t){e=p.parseNumber(e);t=p.parseNumber(t);if(e<=0||e>1||t<1){return m.num}if(p.anyIsError(e,t)){return m.value}return Math.abs(c.studentt.inv(e/2,t))};l.T.TEST=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));if(p.anyIsError(e,t)){return m.value}var r=c.mean(e);var n=c.mean(t);var i=0;var a=0;var o;for(o=0;o<e.length;o++){i+=Math.pow(e[o]-r,2)}for(o=0;o<t.length;o++){a+=Math.pow(t[o]-n,2)}i=i/(e.length-1);a=a/(t.length-1);var s=Math.abs(r-n)/Math.sqrt(i/e.length+a/t.length);return l.T.DIST["2T"](s,e.length+t.length-2)};l.TREND=function(e,t,r){e=p.parseNumberArray(p.flatten(e));t=p.parseNumberArray(p.flatten(t));r=p.parseNumberArray(p.flatten(r));if(p.anyIsError(e,t,r)){return m.value}var n=l.LINEST(e,t);var i=n[0];var a=n[1];var o=[];r.forEach(function(e){o.push(i*e+a)});return o};l.TRIMMEAN=function(e,t){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}var r=s.FLOOR(e.length*t,2)/2;return c.mean(p.initial(p.rest(e.sort(function(e,t){return e-t}),r),r))};l.VAR={};l.VAR.P=function(){var e=p.numbers(p.flatten(arguments));var t=e.length;var r=0;var n=l.AVERAGE(e);var i;for(var a=0;a<t;a++){r+=Math.pow(e[a]-n,2)}i=r/t;if(isNaN(i)){i=m.num}return i};l.VAR.S=function(){var e=p.numbers(p.flatten(arguments));var t=e.length;var r=0;var n=l.AVERAGE(e);for(var i=0;i<t;i++){r+=Math.pow(e[i]-n,2)}return r/(t-1)};l.VARA=function(){var e=p.flatten(arguments);var t=e.length;var r=0;var n=0;var i=l.AVERAGEA(e);for(var a=0;a<t;a++){var o=e[a];if(typeof o==="number"){r+=Math.pow(o-i,2)}else if(o===true){r+=Math.pow(1-i,2)}else{r+=Math.pow(0-i,2)}if(o!==null){n++}}return r/(n-1)};l.VARPA=function(){var e=p.flatten(arguments);var t=e.length;var r=0;var n=0;var i=l.AVERAGEA(e);var a;for(var o=0;o<t;o++){var s=e[o];if(typeof s==="number"){r+=Math.pow(s-i,2)}else if(s===true){r+=Math.pow(1-i,2)}else{r+=Math.pow(0-i,2)}if(s!==null){n++}}a=r/n;if(isNaN(a)){a=m.num}return a};l.WEIBULL={};l.WEIBULL.DIST=function(e,t,r,n){e=p.parseNumber(e);t=p.parseNumber(t);r=p.parseNumber(r);if(p.anyIsError(e,t,r)){return m.value}return n?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)};l.Z={};l.Z.TEST=function(e,t,r){e=p.parseNumberArray(p.flatten(e));t=p.parseNumber(t);if(p.anyIsError(e,t)){return m.value}r=r||l.STDEV.S(e);var n=e.length;return 1-l.NORM.S.DIST((l.AVERAGE(e)-t)/(r/Math.sqrt(n)),true)}},function(e,t,r){var a=r(1);var o=r(0);t.ASC=function(){throw new Error("ASC is not implemented")};t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")};t.CHAR=function(e){e=a.parseNumber(e);if(e instanceof Error){return e}return String.fromCharCode(e)};t.CLEAN=function(e){e=e||"";var t=/[\0-\x1F]/g;return e.replace(t,"")};t.CODE=function(e){e=e||"";var t=e.charCodeAt(0);if(isNaN(t)){t=o.na}return t};t.CONCATENATE=function(){var e=a.flatten(arguments);var t=0;while((t=e.indexOf(true))>-1){e[t]="TRUE"}var r=0;while((r=e.indexOf(false))>-1){e[r]="FALSE"}return e.join("")};t.DBCS=function(){throw new Error("DBCS is not implemented")};t.DOLLAR=function(){throw new Error("DOLLAR is not implemented")};t.EXACT=function(e,t){if(arguments.length!==2){return o.na}return e===t};t.FIND=function(e,t,r){if(arguments.length<2){return o.na}r=r===undefined?0:r;return t?t.indexOf(e,r-1)+1:null};t.FIXED=function(){throw new Error("FIXED is not implemented")};t.HTML2TEXT=function(e){var t="";if(e){if(e instanceof Array){e.forEach(function(e){if(t!==""){t+="\n"}t+=e.replace(/<(?:.|\n)*?>/gm,"")})}else{t=e.replace(/<(?:.|\n)*?>/gm,"")}}return t};t.LEFT=function(e,t){t=t===undefined?1:t;t=a.parseNumber(t);if(t instanceof Error||typeof e!=="string"){return o.value}return e?e.substring(0,t):null};t.LEN=function(e){if(arguments.length===0){return o.error}if(typeof e==="string"){return e?e.length:0}if(e.length){return e.length}return o.value};t.LOWER=function(e){if(typeof e!=="string"){return o.value}return e?e.toLowerCase():e};t.MID=function(e,t,r){t=a.parseNumber(t);r=a.parseNumber(r);if(a.anyIsError(t,r)||typeof e!=="string"){return r}var n=t-1;var i=n+r;return e.substring(n,i)};t.NUMBERVALUE=function(e,t,r){t=typeof t==="undefined"?".":t;r=typeof r==="undefined"?",":r;return Number(e.replace(t,".").replace(r,""))};t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")};t.PROPER=function(e){if(e===undefined||e.length===0){return o.value}if(e===true){e="TRUE"}if(e===false){e="FALSE"}if(isNaN(e)&&typeof e==="number"){return o.value}if(typeof e==="number"){e=""+e}return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})};t.REGEXEXTRACT=function(e,t){if(arguments.length<2){return o.na}var r=e.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null};t.REGEXMATCH=function(e,t,r){if(arguments.length<2){return o.na}var n=e.match(new RegExp(t));return r?n:!!n};t.REGEXREPLACE=function(e,t,r){if(arguments.length<3){return o.na}return e.replace(new RegExp(t),r)};t.REPLACE=function(e,t,r,n){t=a.parseNumber(t);r=a.parseNumber(r);if(a.anyIsError(t,r)||typeof e!=="string"||typeof n!=="string"){return o.value}return e.substr(0,t-1)+n+e.substr(t-1+r)};t.REPT=function(e,t){t=a.parseNumber(t);if(t instanceof Error){return t}return new Array(t+1).join(e)};t.RIGHT=function(e,t){t=t===undefined?1:t;t=a.parseNumber(t);if(t instanceof Error){return t}return e?e.substring(e.length-t):o.na};t.SEARCH=function(e,t,r){var n;if(typeof e!=="string"||typeof t!=="string"){return o.value}r=r===undefined?0:r;n=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1;return n===0?o.value:n};t.SPLIT=function(e,t){return e.split(t)};t.SUBSTITUTE=function(e,t,r,n){if(arguments.length<2){return o.na}if(!e||!t||!r){return e}else if(n===undefined){return e.replace(new RegExp(t,"g"),r)}else{var i=0;var a=0;while(e.indexOf(t,i)>0){i=e.indexOf(t,i+1);a++;if(a===n){return e.substring(0,i)+r+e.substring(i+t.length)}}}};t.T=function(e){return typeof e==="string"?e:""};t.TEXT=function(){throw new Error("TEXT is not implemented")};t.TRIM=function(e){if(typeof e!=="string"){return o.value}return e.replace(/ +/g," ").trim()};t.UNICHAR=t.CHAR;t.UNICODE=t.CODE;t.UPPER=function(e){if(typeof e!=="string"){return o.value}return e.toUpperCase()};t.VALUE=function(){throw new Error("VALUE is not implemented")}},function(e,t){var a="=";var o=[">",">=","<","<=","=","<>"];var s="operator";var l="literal";var r=[s,l];t.TOKEN_TYPE_OPERATOR=s;t.TOKEN_TYPE_LITERAL=l;function u(e,t){if(r.indexOf(t)===-1){throw new Error("Unsupported token type: "+t)}return{value:e,type:t}}function f(e){if(typeof e!=="string"){return e}if(/^\d+(\.\d+)?$/.test(e)){e=e.indexOf(".")===-1?parseInt(e,10):parseFloat(e)}return e}function n(e){var t=e.length;var r=[];var n=0;var i="";var a="";while(n<t){var o=e.charAt(n);switch(o){case">":case"<":case"=":a=a+o;if(i.length>0){r.push(i);i=""}break;default:if(a.length>0){r.push(a);a=""}i=i+o;break}n++}if(i.length>0){r.push(i)}if(a.length>0){r.push(a)}return r}function i(e){var t="";var r=[];for(var n=0;n<e.length;n++){var i=e[n];if(n===0&&o.indexOf(i)>=0){r.push(u(i,s))}else{t+=i}}if(t.length>0){r.push(u(f(t),l))}if(r.length>0&&r[0].type!==s){r.unshift(u(a,s))}return r}function c(e){var t=[];var r;for(var n=0;n<e.length;n++){var i=e[n];switch(i.type){case s:r=i.value;break;case l:t.push(i.value);break}}return d(t,r)}function d(e,t){var r=false;switch(t){case">":r=e[0]>e[1];break;case">=":r=e[0]>=e[1];break;case"<":r=e[0]<e[1];break;case"<=":r=e[0]<=e[1];break;case"=":r=e[0]==e[1];break;case"<>":r=e[0]!=e[1];break}return r}t.parse=function(e){return i(n(e))};t.createToken=u;t.compute=c},function(e,t,r){var n=r(0);t.CELL=function(){throw new Error("CELL is not implemented")};t.ERROR={};t.ERROR.TYPE=function(e){switch(e){case n.nil:return 1;case n.div0:return 2;case n.value:return 3;case n.ref:return 4;case n.name:return 5;case n.num:return 6;case n.na:return 7;case n.data:return 8}return n.na};t.INFO=function(){throw new Error("INFO is not implemented")};t.ISBLANK=function(e){return e===null};t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)};t.ISERR=function(e){return[n.value,n.ref,n.div0,n.num,n.name,n.nil].indexOf(e)>=0||typeof e==="number"&&(isNaN(e)||!isFinite(e))};t.ISERROR=function(e){return t.ISERR(e)||e===n.na};t.ISEVEN=function(e){return Math.floor(Math.abs(e))&1?false:true};t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")};t.ISLOGICAL=function(e){return e===true||e===false};t.ISNA=function(e){return e===n.na};t.ISNONTEXT=function(e){return typeof e!=="string"};t.ISNUMBER=function(e){return typeof e==="number"&&!isNaN(e)&&isFinite(e)};t.ISODD=function(e){return Math.floor(Math.abs(e))&1?true:false};t.ISREF=function(){throw new Error("ISREF is not implemented")};t.ISTEXT=function(e){return typeof e==="string"};t.N=function(e){if(this.ISNUMBER(e)){return e}if(e instanceof Date){return e.getTime()}if(e===true){return 1}if(e===false){return 0}if(this.ISERROR(e)){return e}return 0};t.NA=function(){return n.na};t.SHEET=function(){throw new Error("SHEET is not implemented")};t.SHEETS=function(){throw new Error("SHEETS is not implemented")};t.TYPE=function(e){if(this.ISNUMBER(e)){return 1}if(this.ISTEXT(e)){return 2}if(this.ISLOGICAL(e)){return 4}if(this.ISERROR(e)){return 16}if(Array.isArray(e)){return 64}}},function(e,t,r){var h=r(0);var v=r(1);var n=new Date(Date.UTC(1900,0,1));var a=[undefined,0,1,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,2,3,4,5,6,0];var i=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];var p=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],undefined,undefined,undefined,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];t.DATE=function(e,t,r){var n;e=v.parseNumber(e);t=v.parseNumber(t);r=v.parseNumber(r);if(v.anyIsError(e,t,r)){n=h.value}else if(e<0||t<0||r<0){n=h.num}else{n=new Date(e,t-1,r)}return n};t.DATEVALUE=function(e){var t=2;var r;if(typeof e!=="string"){return h.value}r=Date.parse(e);if(isNaN(r)){return h.value}if(r<=-22038912e5){t=1}return Math.ceil((r-n)/864e5)+t};t.DAY=function(e){var t=v.parseDate(e);if(t instanceof Error){return t}return t.getDate()};t.DAYS=function(e,t){e=v.parseDate(e);t=v.parseDate(t);if(e instanceof Error){return e}if(t instanceof Error){return t}return o(e)-o(t)};t.DAYS360=function(e,t,r){r=v.parseBool(r);e=v.parseDate(e);t=v.parseDate(t);if(e instanceof Error){return e}if(t instanceof Error){return t}if(r instanceof Error){return r}var n=e.getMonth();var i=t.getMonth();var a,o;if(r){a=e.getDate()===31?30:e.getDate();o=t.getDate()===31?30:t.getDate()}else{var s=new Date(e.getFullYear(),n+1,0).getDate();var l=new Date(t.getFullYear(),i+1,0).getDate();a=e.getDate()===s?30:e.getDate();if(t.getDate()===l){if(a<30){i++;o=1}else{o=30}}else{o=t.getDate()}}return 360*(t.getFullYear()-e.getFullYear())+30*(i-n)+(o-a)};t.EDATE=function(e,t){e=v.parseDate(e);if(e instanceof Error){return e}if(isNaN(t)){return h.value}t=parseInt(t,10);e.setMonth(e.getMonth()+t);return o(e)};t.EOMONTH=function(e,t){e=v.parseDate(e);if(e instanceof Error){return e}if(isNaN(t)){return h.value}t=parseInt(t,10);return o(new Date(e.getFullYear(),e.getMonth()+t+1,0))};t.HOUR=function(e){e=v.parseDate(e);if(e instanceof Error){return e}return e.getHours()};t.INTERVAL=function(e){if(typeof e!=="number"&&typeof e!=="string"){return h.value}else{e=parseInt(e,10)}var t=Math.floor(e/94608e4);e=e%94608e4;var r=Math.floor(e/2592e3);e=e%2592e3;var n=Math.floor(e/86400);e=e%86400;var i=Math.floor(e/3600);e=e%3600;var a=Math.floor(e/60);e=e%60;var o=e;t=t>0?t+"Y":"";r=r>0?r+"M":"";n=n>0?n+"D":"";i=i>0?i+"H":"";a=a>0?a+"M":"";o=o>0?o+"S":"";return"P"+t+r+n+"T"+i+a+o};t.ISOWEEKNUM=function(e){e=v.parseDate(e);if(e instanceof Error){return e}e.setHours(0,0,0);e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)};t.MINUTE=function(e){e=v.parseDate(e);if(e instanceof Error){return e}return e.getMinutes()};t.MONTH=function(e){e=v.parseDate(e);if(e instanceof Error){return e}return e.getMonth()+1};t.NETWORKDAYS=function(e,t,r){return this.NETWORKDAYS.INTL(e,t,1,r)};t.NETWORKDAYS.INTL=function(e,t,r,n){e=v.parseDate(e);if(e instanceof Error){return e}t=v.parseDate(t);if(t instanceof Error){return t}if(r===undefined){r=p[1]}else{r=p[r]}if(!(r instanceof Array)){return h.value}if(n===undefined){n=[]}else if(!(n instanceof Array)){n=[n]}for(var i=0;i<n.length;i++){var a=v.parseDate(n[i]);if(a instanceof Error){return a}n[i]=a}var o=(t-e)/(1e3*60*60*24)+1;var s=o;var l=e;for(i=0;i<o;i++){var u=(new Date).getTimezoneOffset()>0?l.getUTCDay():l.getDay();var f=false;if(u===r[0]||u===r[1]){f=true}for(var c=0;c<n.length;c++){var d=n[c];if(d.getDate()===l.getDate()&&d.getMonth()===l.getMonth()&&d.getFullYear()===l.getFullYear()){f=true;break}}if(f){s--}l.setDate(l.getDate()+1)}return s};t.NOW=function(){return new Date};t.SECOND=function(e){e=v.parseDate(e);if(e instanceof Error){return e}return e.getSeconds()};t.TIME=function(e,t,r){e=v.parseNumber(e);t=v.parseNumber(t);r=v.parseNumber(r);if(v.anyIsError(e,t,r)){return h.value}if(e<0||t<0||r<0){return h.num}return(3600*e+60*t+r)/86400};t.TIMEVALUE=function(e){e=v.parseDate(e);if(e instanceof Error){return e}return(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400};t.TODAY=function(){return new Date};t.WEEKDAY=function(e,t){e=v.parseDate(e);if(e instanceof Error){return e}if(t===undefined){t=1}var r=e.getDay();return i[t][r]};t.WEEKNUM=function(e,t){e=v.parseDate(e);if(e instanceof Error){return e}if(t===undefined){t=1}if(t===21){return this.ISOWEEKNUM(e)}var r=a[t];var n=new Date(e.getFullYear(),0,1);var i=n.getDay()<r?1:0;n-=Math.abs(n.getDay()-r)*24*60*60*1e3;return Math.floor((e-n)/(1e3*60*60*24)/7+1)+i};t.WORKDAY=function(e,t,r){return this.WORKDAY.INTL(e,t,1,r)};t.WORKDAY.INTL=function(e,t,r,n){e=v.parseDate(e);if(e instanceof Error){return e}t=v.parseNumber(t);if(t instanceof Error){return t}if(t<0){return h.num}if(r===undefined){r=p[1]}else{r=p[r]}if(!(r instanceof Array)){return h.value}if(n===undefined){n=[]}else if(!(n instanceof Array)){n=[n]}for(var i=0;i<n.length;i++){var a=v.parseDate(n[i]);if(a instanceof Error){return a}n[i]=a}var o=0;while(o<t){e.setDate(e.getDate()+1);var s=e.getDay();if(s===r[0]||s===r[1]){continue}for(var l=0;l<n.length;l++){var u=n[l];if(u.getDate()===e.getDate()&&u.getMonth()===e.getMonth()&&u.getFullYear()===e.getFullYear()){o--;break}}o++}return e};t.YEAR=function(e){e=v.parseDate(e);if(e instanceof Error){return e}return e.getFullYear()};function g(e){return new Date(e,1,29).getMonth()===1}function m(e,t){return Math.ceil((t-e)/1e3/60/60/24)}t.YEARFRAC=function(e,t,r){e=v.parseDate(e);if(e instanceof Error){return e}t=v.parseDate(t);if(t instanceof Error){return t}r=r||0;var n=e.getDate();var i=e.getMonth()+1;var a=e.getFullYear();var o=t.getDate();var s=t.getMonth()+1;var l=t.getFullYear();switch(r){case 0:if(n===31&&o===31){n=30;o=30}else if(n===31){n=30}else if(n===30&&o===31){o=30}return(o+s*30+l*360-(n+i*30+a*360))/360;case 1:var u=function(e,t){var r=e.getFullYear();var n=new Date(r,2,1);if(g(r)&&e<n&&t>=n){return true}var i=t.getFullYear();var a=new Date(i,2,1);return g(i)&&t>=a&&e<a};var f=365;if(a===l||a+1===l&&(i>s||i===s&&n>=o)){if(a===l&&g(a)||u(e,t)||s===1&&o===29){f=366}return m(e,t)/f}var c=l-a+1;var d=(new Date(l+1,0,1)-new Date(a,0,1))/1e3/60/60/24;var h=d/c;return m(e,t)/h;case 2:return m(e,t)/360;case 3:return m(e,t)/365;case 4:return(o+s*30+l*360-(n+i*30+a*360))/360}};function o(e){var t=e>-22038912e5?2:1;return Math.ceil((e-n)/864e5)+t}},function(r,e,t){(function(e,t){if(true){r.exports=t()}else{}})(this,function(){var h=function(l,u){var t=Array.prototype.concat;var r=Array.prototype.slice;var n=Object.prototype.toString;function f(e,t){var r=e>t?e:t;return l.pow(10,17-~~(l.log(r>0?r:-r)*l.LOG10E))}var c=Array.isArray||function e(t){return n.call(t)==="[object Array]"};function d(e){return n.call(e)==="[object Function]"}function h(e){return typeof e==="number"?e-e===0:false}function e(e){return t.apply([],e)}function v(){return new v._init(arguments)}v.fn=v.prototype;v._init=function e(t){if(c(t[0])){if(c(t[0][0])){if(d(t[1]))t[0]=v.map(t[0],t[1]);for(var r=0;r<t[0].length;r++)this[r]=t[0][r];this.length=t[0].length}else{this[0]=d(t[1])?v.map(t[0],t[1]):t[0];this.length=1}}else if(h(t[0])){this[0]=v.seq.apply(null,t);this.length=1}else if(t[0]instanceof v){return v(t[0].toArray())}else{this[0]=[];this.length=1}return this};v._init.prototype=v.prototype;v._init.constructor=v;v.utils={calcRdx:f,isArray:c,isFunction:d,isNumber:h,toVector:e};v._random_fn=l.random;v.setRandom=function e(t){if(typeof t!=="function")throw new TypeError("fn is not a function");v._random_fn=t};v.extend=function e(t){var r,n;if(arguments.length===1){for(n in t)v[n]=t[n];return this}for(r=1;r<arguments.length;r++){for(n in arguments[r])t[n]=arguments[r][n]}return t};v.rows=function e(t){return t.length||1};v.cols=function e(t){return t[0].length||1};v.dimensions=function e(t){return{rows:v.rows(t),cols:v.cols(t)}};v.row=function e(t,r){if(c(r)){return r.map(function(e){return v.row(t,e)})}return t[r]};v.rowa=function e(t,r){return v.row(t,r)};v.col=function e(n,t){if(c(t)){var i=v.arange(n.length).map(function(){return new Array(t.length)});t.forEach(function(t,r){v.arange(n.length).forEach(function(e){i[e][r]=n[e][t]})});return i}var r=new Array(n.length);for(var a=0;a<n.length;a++)r[a]=[n[a][t]];return r};v.cola=function e(t,r){return v.col(t,r).map(function(e){return e[0]})};v.diag=function e(t){var r=v.rows(t);var n=new Array(r);for(var i=0;i<r;i++)n[i]=[t[i][i]];return n};v.antidiag=function e(t){var r=v.rows(t)-1;var n=new Array(r);for(var i=0;r>=0;r--,i++)n[i]=[t[i][r]];return n};v.transpose=function e(t){var r=[];var n,i,a,o,s;if(!c(t[0]))t=[t];i=t.length;a=t[0].length;for(s=0;s<a;s++){n=new Array(i);for(o=0;o<i;o++)n[o]=t[o][s];r.push(n)}return r.length===1?r[0]:r};v.map=function e(t,r,n){var i,a,o,s,l;if(!c(t[0]))t=[t];a=t.length;o=t[0].length;s=n?t:new Array(a);for(i=0;i<a;i++){if(!s[i])s[i]=new Array(o);for(l=0;l<o;l++)s[i][l]=r(t[i][l],i,l)}return s.length===1?s[0]:s};v.cumreduce=function e(t,r,n){var i,a,o,s,l;if(!c(t[0]))t=[t];a=t.length;o=t[0].length;s=n?t:new Array(a);for(i=0;i<a;i++){if(!s[i])s[i]=new Array(o);if(o>0)s[i][0]=t[i][0];for(l=1;l<o;l++)s[i][l]=r(s[i][l-1],t[i][l])}return s.length===1?s[0]:s};v.alter=function e(t,r){return v.map(t,r,true)};v.create=function e(t,r,n){var i=new Array(t);var a,o;if(d(r)){n=r;r=t}for(a=0;a<t;a++){i[a]=new Array(r);for(o=0;o<r;o++)i[a][o]=n(a,o)}return i};function i(){return 0}v.zeros=function e(t,r){if(!h(r))r=t;return v.create(t,r,i)};function a(){return 1}v.ones=function e(t,r){if(!h(r))r=t;return v.create(t,r,a)};v.rand=function e(t,r){if(!h(r))r=t;return v.create(t,r,v._random_fn)};function o(e,t){return e===t?1:0}v.identity=function e(t,r){if(!h(r))r=t;return v.create(t,r,o)};v.symmetric=function e(t){var r=t.length;var n,i;if(t.length!==t[0].length)return false;for(n=0;n<r;n++){for(i=0;i<r;i++)if(t[i][n]!==t[n][i])return false}return true};v.clear=function e(t){return v.alter(t,i)};v.seq=function e(t,r,n,i){if(!d(i))i=false;var a=[];var o=f(t,r);var s=(r*o-t*o)/((n-1)*o);var l=t;var u;for(u=0;l<=r&&u<n;u++,l=(t*o+s*o*u)/o){a.push(i?i(l,u):l)}return a};v.arange=function e(t,r,n){var i=[];var a;n=n||1;if(r===u){r=t;t=0}if(t===r||n===0){return[]}if(t<r&&n<0){return[]}if(t>r&&n>0){return[]}if(n>0){for(a=t;a<r;a+=n){i.push(a)}}else{for(a=t;a>r;a+=n){i.push(a)}}return i};v.slice=function(){function s(e,t,r,n){var i;var a=[];var o=e.length;if(t===u&&r===u&&n===u){return v.copy(e)}t=t||0;r=r||e.length;t=t>=0?t:o+t;r=r>=0?r:o+r;n=n||1;if(t===r||n===0){return[]}if(t<r&&n<0){return[]}if(t>r&&n>0){return[]}if(n>0){for(i=t;i<r;i+=n){a.push(e[i])}}else{for(i=t;i>r;i+=n){a.push(e[i])}}return a}function e(e,t){var r,n;t=t||{};if(h(t.row)){if(h(t.col))return e[t.row][t.col];var i=v.rowa(e,t.row);r=t.col||{};return s(i,r.start,r.end,r.step)}if(h(t.col)){var a=v.cola(e,t.col);n=t.row||{};return s(a,n.start,n.end,n.step)}n=t.row||{};r=t.col||{};var o=s(e,n.start,n.end,n.step);return o.map(function(e){return s(e,r.start,r.end,r.step)})}return e}();v.sliceAssign=function e(i,t,a){var o,r;if(h(t.row)){if(h(t.col))return i[t.row][t.col]=a;t.col=t.col||{};t.col.start=t.col.start||0;t.col.end=t.col.end||i[0].length;t.col.step=t.col.step||1;o=v.arange(t.col.start,l.min(i.length,t.col.end),t.col.step);var n=t.row;o.forEach(function(e,t){i[n][e]=a[t]});return i}if(h(t.col)){t.row=t.row||{};t.row.start=t.row.start||0;t.row.end=t.row.end||i.length;t.row.step=t.row.step||1;r=v.arange(t.row.start,l.min(i[0].length,t.row.end),t.row.step);var s=t.col;r.forEach(function(e,t){i[e][s]=a[t]});return i}if(a[0].length===u){a=[a]}t.row.start=t.row.start||0;t.row.end=t.row.end||i.length;t.row.step=t.row.step||1;t.col.start=t.col.start||0;t.col.end=t.col.end||i[0].length;t.col.step=t.col.step||1;r=v.arange(t.row.start,l.min(i.length,t.row.end),t.row.step);o=v.arange(t.col.start,l.min(i[0].length,t.col.end),t.col.step);r.forEach(function(r,n){o.forEach(function(e,t){i[r][e]=a[n][t]})});return i};v.diagonal=function e(t){var r=v.zeros(t.length,t.length);t.forEach(function(e,t){r[t][t]=e});return r};v.copy=function e(t){return t.map(function(e){if(h(e))return e;return e.map(function(e){return e})})};var s=v.prototype;s.length=0;s.push=Array.prototype.push;s.sort=Array.prototype.sort;s.splice=Array.prototype.splice;s.slice=Array.prototype.slice;s.toArray=function e(){return this.length>1?r.call(this):r.call(this)[0]};s.map=function e(t,r){return v(v.map(this,t,r))};s.cumreduce=function e(t,r){return v(v.cumreduce(this,t,r))};s.alter=function e(t){v.alter(this,t);return this};(function(e){for(var t=0;t<e.length;t++)(function(n){s[n]=function(e){var t=this,r;if(e){setTimeout(function(){e.call(t,s[n].call(t))});return this}r=v[n](this);return c(r)?v(r):r}})(e[t])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" "));(function(e){for(var t=0;t<e.length;t++)(function(n){s[n]=function(e,t){var r=this;if(t){setTimeout(function(){t.call(r,s[n].call(r,e))});return this}return v(v[n](this,e))}})(e[t])})("row col".split(" "));(function(e){for(var t=0;t<e.length;t++)(function(e){s[e]=function(){return v(v[e].apply(null,arguments))}})(e[t])})("create zeros ones rand identity".split(" "));return v}(Math);(function(l,v){var u=l.utils.isFunction;function p(e,t){return e-t}function g(e,t,r){return v.max(t,v.min(e,r))}l.sum=function e(t){var e=0;var r=t.length;while(--r>=0)e+=t[r];return e};l.sumsqrd=function e(t){var r=0;var n=t.length;while(--n>=0)r+=t[n]*t[n];return r};l.sumsqerr=function e(t){var r=l.mean(t);var n=0;var i=t.length;var a;while(--i>=0){a=t[i]-r;n+=a*a}return n};l.sumrow=function e(t){var r=0;var n=t.length;while(--n>=0)r+=t[n];return r};l.product=function e(t){var r=1;var n=t.length;while(--n>=0)r*=t[n];return r};l.min=function e(t){var r=t[0];var n=0;while(++n<t.length)if(t[n]<r)r=t[n];return r};l.max=function e(t){var r=t[0];var n=0;while(++n<t.length)if(t[n]>r)r=t[n];return r};l.unique=function e(t){var r={},n=[];for(var i=0;i<t.length;i++){if(!r[t[i]]){r[t[i]]=true;n.push(t[i])}}return n};l.mean=function e(t){return l.sum(t)/t.length};l.meansqerr=function e(t){return l.sumsqerr(t)/t.length};l.geomean=function e(t){return v.pow(l.product(t),1/t.length)};l.median=function e(t){var r=t.length;var n=t.slice().sort(p);return!(r&1)?(n[r/2-1]+n[r/2])/2:n[r/2|0]};l.cumsum=function e(t){return l.cumreduce(t,function(e,t){return e+t})};l.cumprod=function e(t){return l.cumreduce(t,function(e,t){return e*t})};l.diff=function e(t){var r=[];var n=t.length;var i;for(i=1;i<n;i++)r.push(t[i]-t[i-1]);return r};l.rank=function(e){var t=e.length;var r=e.slice().sort(p);var n=new Array(t);var i;for(var a=0;a<t;a++){var o=r.indexOf(e[a]);var s=r.lastIndexOf(e[a]);if(o===s){i=o}else{i=(o+s)/2}n[a]=i+1}return n};l.mode=function e(t){var r=t.length;var n=t.slice().sort(p);var i=1;var a=0;var o=0;var s=[];var l;for(l=0;l<r;l++){if(n[l]===n[l+1]){i++}else{if(i>a){s=[n[l]];a=i;o=0}else if(i===a){s.push(n[l]);o++}i=1}}return o===0?s[0]:s};l.range=function e(t){return l.max(t)-l.min(t)};l.variance=function e(t,r){return l.sumsqerr(t)/(t.length-(r?1:0))};l.pooledvariance=function e(t){var r=t.reduce(function(e,t){return e+l.sumsqerr(t)},0);var n=t.reduce(function(e,t){return e+t.length},0);return r/(n-t.length)};l.deviation=function(e){var t=l.mean(e);var r=e.length;var n=new Array(r);for(var i=0;i<r;i++){n[i]=e[i]-t}return n};l.stdev=function e(t,r){return v.sqrt(l.variance(t,r))};l.pooledstdev=function e(t){return v.sqrt(l.pooledvariance(t))};l.meandev=function e(t){var r=l.mean(t);var n=[];for(var i=t.length-1;i>=0;i--){n.push(v.abs(t[i]-r))}return l.mean(n)};l.meddev=function e(t){var r=l.median(t);var n=[];for(var i=t.length-1;i>=0;i--){n.push(v.abs(t[i]-r))}return l.median(n)};l.coeffvar=function e(t){return l.stdev(t)/l.mean(t)};l.quartiles=function e(t){var r=t.length;var n=t.slice().sort(p);return[n[v.round(r/4)-1],n[v.round(r/2)-1],n[v.round(r*3/4)-1]]};l.quantiles=function e(t,r,n,i){var a=t.slice().sort(p);var o=[r.length];var s=t.length;var l,u,f,c,d,h;if(typeof n==="undefined")n=3/8;if(typeof i==="undefined")i=3/8;for(l=0;l<r.length;l++){u=r[l];f=n+u*(1-n-i);c=s*u+f;d=v.floor(g(c,1,s-1));h=g(c-d,0,1);o[l]=(1-h)*a[d-1]+h*a[d]}return o};l.percentile=function e(t,r,n){var i=t.slice().sort(p);var a=r*(i.length+(n?1:-1))+(n?0:1);var o=parseInt(a);var s=a-o;if(o+1<i.length){return i[o-1]+s*(i[o]-i[o-1])}else{return i[o-1]}};l.percentileOfScore=function e(t,r,n){var i=0;var a=t.length;var o=false;var s,l;if(n==="strict")o=true;for(l=0;l<a;l++){s=t[l];if(o&&s<r||!o&&s<=r){i++}}return i/a};l.histogram=function e(t,r){r=r||4;var n=l.min(t);var i=(l.max(t)-n)/r;var a=t.length;var o=[];var s;for(s=0;s<r;s++)o[s]=0;for(s=0;s<a;s++)o[v.min(v.floor((t[s]-n)/i),r-1)]+=1;return o};l.covariance=function e(t,r){var n=l.mean(t);var i=l.mean(r);var a=t.length;var o=new Array(a);var s;for(s=0;s<a;s++)o[s]=(t[s]-n)*(r[s]-i);return l.sum(o)/(a-1)};l.corrcoeff=function e(t,r){return l.covariance(t,r)/l.stdev(t,1)/l.stdev(r,1)};l.spearmancoeff=function(e,t){e=l.rank(e);t=l.rank(t);return l.corrcoeff(e,t)};l.stanMoment=function e(t,r){var n=l.mean(t);var i=l.stdev(t);var a=t.length;var o=0;for(var s=0;s<a;s++)o+=v.pow((t[s]-n)/i,r);return o/t.length};l.skewness=function e(t){return l.stanMoment(t,3)};l.kurtosis=function e(t){return l.stanMoment(t,4)-3};var f=l.prototype;(function(e){for(var t=0;t<e.length;t++)(function(a){f[a]=function(e,t){var r=[];var n=0;var i=this;if(u(e)){t=e;e=false}if(t){setTimeout(function(){t.call(i,f[a].call(i,e))});return this}if(this.length>1){i=e===true?this:this.transpose();for(;n<i.length;n++)r[n]=l[a](i[n]);return r}return l[a](this[0],e)}})(e[t])})("cumsum cumprod".split(" "));(function(e){for(var t=0;t<e.length;t++)(function(a){f[a]=function(e,t){var r=[];var n=0;var i=this;if(u(e)){t=e;e=false}if(t){setTimeout(function(){t.call(i,f[a].call(i,e))});return this}if(this.length>1){if(a!=="sumrow")i=e===true?this:this.transpose();for(;n<i.length;n++)r[n]=l[a](i[n]);return e===true?l[a](l.utils.toVector(r)):r}return l[a](this[0],e)}})(e[t])})(("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr "+"geomean median diff rank mode range variance deviation stdev meandev "+"meddev coeffvar quartiles histogram skewness kurtosis").split(" "));(function(e){for(var t=0;t<e.length;t++)(function(s){f[s]=function(){var e=[];var t=0;var r=this;var n=Array.prototype.slice.call(arguments);var i;if(u(n[n.length-1])){i=n[n.length-1];var a=n.slice(0,n.length-1);setTimeout(function(){i.call(r,f[s].apply(r,a))});return this}else{i=undefined;var o=function e(t){return l[s].apply(r,[t].concat(n))}}if(this.length>1){r=r.transpose();for(;t<r.length;t++)e[t]=o(r[t]);return e}return o(this[0])}})(e[t])})("quantiles percentileOfScore".split(" "))})(h,Math);(function(b,w){b.gammaln=function e(t){var r=0;var n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];var i=1.000000000190015;var a,o,s;s=(o=a=t)+5.5;s-=(a+.5)*w.log(s);for(;r<6;r++)i+=n[r]/++o;return w.log(2.5066282746310007*i/a)-s};b.loggam=function e(t){var r,n,i,a,o;var s,l;var u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];r=t;l=0;if(t==1||t==2){return 0}if(t<=7){l=w.floor(7-t);r=t+l}n=1/(r*r);i=2*w.PI;o=u[9];for(s=8;s>=0;s--){o*=n;o+=u[s]}a=o/r+.5*w.log(i)+(r-.5)*w.log(r)-r;if(t<=7){for(s=1;s<=l;s++){a-=w.log(r-1);r-=1}}return a};b.gammafn=function e(t){var r=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054];var n=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];var i=false;var a=0;var o=0;var s=0;var l=t;var u,f,c,d;if(l<=0){d=l%1+36e-17;if(d){i=(!(l&1)?1:-1)*w.PI/w.sin(w.PI*d);l=1-l}else{return Infinity}}c=l;if(l<1){f=l++}else{f=(l-=a=(l|0)-1)-1}for(u=0;u<8;++u){s=(s+r[u])*f;o=o*f+n[u]}d=s/o+1;if(c<l){d/=c}else if(c>l){for(u=0;u<a;++u){d*=l;l++}}if(i){d=i/d}return d};b.gammap=function e(t,r){return b.lowRegGamma(t,r)*b.gammafn(t)};b.lowRegGamma=function e(t,r){var n=b.gammaln(t);var i=t;var a=1/t;var o=a;var s=r+1-t;var l=1/1e-30;var u=1/s;var f=u;var c=1;var d=-~(w.log(t>=1?t:1/t)*8.5+t*.4+17);var h;if(r<0||t<=0){return NaN}else if(r<t+1){for(;c<=d;c++){a+=o*=r/++i}return a*w.exp(-r+t*w.log(r)-n)}for(;c<=d;c++){h=-c*(c-t);s+=2;u=h*u+s;l=s+h/l;u=1/u;f*=u*l}return 1-f*w.exp(-r+t*w.log(r)-n)};b.factorialln=function e(t){return t<0?NaN:b.gammaln(t+1)};b.factorial=function e(t){return t<0?NaN:b.gammafn(t+1)};b.combination=function e(t,r){return t>170||r>170?w.exp(b.combinationln(t,r)):b.factorial(t)/b.factorial(r)/b.factorial(t-r)};b.combinationln=function e(t,r){return b.factorialln(t)-b.factorialln(r)-b.factorialln(t-r)};b.permutation=function e(t,r){return b.factorial(t)/b.factorial(t-r)};b.betafn=function e(t,r){if(t<=0||r<=0)return undefined;return t+r>170?w.exp(b.betaln(t,r)):b.gammafn(t)*b.gammafn(r)/b.gammafn(t+r)};b.betaln=function e(t,r){return b.gammaln(t)+b.gammaln(r)-b.gammaln(t+r)};b.betacf=function e(t,r,n){var i=1e-30;var a=1;var o=r+n;var s=r+1;var l=r-1;var u=1;var f=1-o*t/s;var c,d,h,v;if(w.abs(f)<i)f=i;f=1/f;v=f;for(;a<=100;a++){c=2*a;d=a*(n-a)*t/((l+c)*(r+c));f=1+d*f;if(w.abs(f)<i)f=i;u=1+d/u;if(w.abs(u)<i)u=i;f=1/f;v*=f*u;d=-(r+a)*(o+a)*t/((r+c)*(s+c));f=1+d*f;if(w.abs(f)<i)f=i;u=1+d/u;if(w.abs(u)<i)u=i;f=1/f;h=f*u;v*=h;if(w.abs(h-1)<3e-7)break}return v};b.gammapinv=function e(t,r){var n=0;var i=r-1;var a=1e-8;var o=b.gammaln(r);var s,l,u,f,c,d,h;if(t>=1)return w.max(100,r+100*w.sqrt(r));if(t<=0)return 0;if(r>1){d=w.log(i);h=w.exp(i*(d-1)-o);c=t<.5?t:1-t;u=w.sqrt(-2*w.log(c));s=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u;if(t<.5)s=-s;s=w.max(.001,r*w.pow(1-1/(9*r)-s/(3*w.sqrt(r)),3))}else{u=1-r*(.253+r*.12);if(t<u)s=w.pow(t/u,1/r);else s=1-w.log(1-(t-u)/(1-u))}for(;n<12;n++){if(s<=0)return 0;l=b.lowRegGamma(r,s)-t;if(r>1)u=h*w.exp(-(s-i)+i*(w.log(s)-d));else u=w.exp(-s+i*w.log(s)-o);f=l/u;s-=u=f/(1-.5*w.min(1,f*((r-1)/s-1)));if(s<=0)s=.5*(s+u);if(w.abs(u)<a*s)break}return s};b.erf=function e(t){var r=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];var n=r.length-1;var i=false;var a=0;var o=0;var s,l,u,f;if(t<0){t=-t;i=true}s=2/(2+t);l=4*s-2;for(;n>0;n--){u=a;a=l*a-o+r[n];o=u}f=s*w.exp(-t*t+.5*(r[0]+l*a)-o);return i?f-1:1-f};b.erfc=function e(t){return 1-b.erf(t)};b.erfcinv=function e(t){var r=0;var n,i,a,o;if(t>=2)return-100;if(t<=0)return 100;o=t<1?t:2-t;a=w.sqrt(-2*w.log(o/2));n=-.70711*((2.30753+a*.27061)/(1+a*(.99229+a*.04481))-a);for(;r<2;r++){i=b.erfc(n)-o;n+=i/(1.1283791670955126*w.exp(-n*n)-n*i)}return t<1?n:-n};b.ibetainv=function e(t,r,n){var i=1e-8;var a=r-1;var o=n-1;var s=0;var l,u,f,c,d,h,v,p,g,m,y;if(t<=0)return 0;if(t>=1)return 1;if(r>=1&&n>=1){f=t<.5?t:1-t;c=w.sqrt(-2*w.log(f));v=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c;if(t<.5)v=-v;p=(v*v-3)/6;g=2/(1/(2*r-1)+1/(2*n-1));m=v*w.sqrt(p+g)/g-(1/(2*n-1)-1/(2*r-1))*(p+5/6-2/(3*g));v=r/(r+n*w.exp(2*m))}else{l=w.log(r/(r+n));u=w.log(n/(r+n));c=w.exp(r*l)/r;d=w.exp(n*u)/n;m=c+d;if(t<c/m)v=w.pow(r*m*t,1/r);else v=1-w.pow(n*m*(1-t),1/n)}y=-b.gammaln(r)-b.gammaln(n)+b.gammaln(r+n);for(;s<10;s++){if(v===0||v===1)return v;h=b.ibeta(v,r,n)-t;c=w.exp(a*w.log(v)+o*w.log(1-v)+y);d=h/c;v-=c=d/(1-.5*w.min(1,d*(a/v-o/(1-v))));if(v<=0)v=.5*(v+c);if(v>=1)v=.5*(v+c+1);if(w.abs(c)<i*v&&s>0)break}return v};b.ibeta=function e(t,r,n){var i=t===0||t===1?0:w.exp(b.gammaln(r+n)-b.gammaln(r)-b.gammaln(n)+r*w.log(t)+n*w.log(1-t));if(t<0||t>1)return false;if(t<(r+1)/(r+n+2))return i*b.betacf(t,r,n)/r;return 1-i*b.betacf(1-t,n,r)/n};b.randn=function e(t,r){var n,i,a,o,s;if(!r)r=t;if(t)return b.create(t,r,function(){return b.randn()});do{n=b._random_fn();i=1.7156*(b._random_fn()-.5);a=n-.449871;o=w.abs(i)+.386595;s=a*a+o*(.196*o-.25472*a)}while(s>.27597&&(s>.27846||i*i>-4*w.log(n)*n*n));return i/n};b.randg=function e(t,r,n){var i=t;var a,o,s,l,u,f;if(!n)n=r;if(!t)t=1;if(r){f=b.zeros(r,n);f.alter(function(){return b.randg(t)});return f}if(t<1)t+=1;a=t-1/3;o=1/w.sqrt(9*a);do{do{u=b.randn();l=1+o*u}while(l<=0);l=l*l*l;s=b._random_fn()}while(s>1-.331*w.pow(u,4)&&w.log(s)>.5*u*u+a*(1-l+w.log(l)));if(t==i)return a*l;do{s=b._random_fn()}while(s===0);return w.pow(s,1/i)*a*l};(function(e){for(var t=0;t<e.length;t++)(function(t){b.fn[t]=function(){return b(b.map(this,function(e){return b[t](e)}))}})(e[t])})("gammaln gammafn factorial factorialln".split(" "));(function(e){for(var t=0;t<e.length;t++)(function(e){b.fn[e]=function(){return b(b[e].apply(null,arguments))}})(e[t])})("randn".split(" "))})(h,Math);(function(L,P){(function(e){for(var t=0;t<e.length;t++)(function(a){L[a]=function(e,t,r){if(!(this instanceof arguments.callee))return new arguments.callee(e,t,r);this._a=e;this._b=t;this._c=r;return this};L.fn[a]=function(e,t,r){var n=L[a](e,t,r);n.data=this;return n};L[a].prototype.sample=function(e){var t=this._a;var r=this._b;var n=this._c;if(e)return L.alter(e,function(){return L[a].sample(t,r,n)});else return L[a].sample(t,r,n)};(function(e){for(var t=0;t<e.length;t++)(function(i){L[a].prototype[i]=function(e){var t=this._a;var r=this._b;var n=this._c;if(!e&&e!==0)e=this.data;if(typeof e!=="number"){return L.fn.map.call(e,function(e){return L[a][i](e,t,r,n)})}return L[a][i](e,t,r,n)}})(e[t])})("pdf cdf inv".split(" "));(function(e){for(var t=0;t<e.length;t++)(function(e){L[a].prototype[e]=function(){return L[a][e](this._a,this._b,this._c)}})(e[t])})("mean median mode variance".split(" "))})(e[t])})(("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy "+"laplace lognormal noncentralt normal pareto studentt weibull uniform "+"binomial negbin hypgeom poisson triangular tukey arcsine").split(" "));L.extend(L.beta,{pdf:function e(t,r,n){if(t>1||t<0)return 0;if(r==1&&n==1)return 1;if(r<512&&n<512){return P.pow(t,r-1)*P.pow(1-t,n-1)/L.betafn(r,n)}else{return P.exp((r-1)*P.log(t)+(n-1)*P.log(1-t)-L.betaln(r,n))}},cdf:function e(t,r,n){return t>1||t<0?(t>1)*1:L.ibeta(t,r,n)},inv:function e(t,r,n){return L.ibetainv(t,r,n)},mean:function e(t,r){return t/(t+r)},median:function e(t,r){return L.ibetainv(.5,t,r)},mode:function e(t,r){return(t-1)/(t+r-2)},sample:function e(t,r){var n=L.randg(t);return n/(n+L.randg(r))},variance:function e(t,r){return t*r/(P.pow(t+r,2)*(t+r+1))}});L.extend(L.centralF,{pdf:function e(t,r,n){var i,a,o;if(t<0)return 0;if(r<=2){if(t===0&&r<2){return Infinity}if(t===0&&r===2){return 1}return 1/L.betafn(r/2,n/2)*P.pow(r/n,r/2)*P.pow(t,r/2-1)*P.pow(1+r/n*t,-(r+n)/2)}i=r*t/(n+t*r);a=n/(n+t*r);o=r*a/2;return o*L.binomial.pdf((r-2)/2,(r+n-2)/2,i)},cdf:function e(t,r,n){if(t<0)return 0;return L.ibeta(r*t/(r*t+n),r/2,n/2)},inv:function e(t,r,n){return n/(r*(1/L.ibetainv(t,r/2,n/2)-1))},mean:function e(t,r){return r>2?r/(r-2):undefined},mode:function e(t,r){return t>2?r*(t-2)/(t*(r+2)):undefined},sample:function e(t,r){var n=L.randg(t/2)*2;var i=L.randg(r/2)*2;return n/t/(i/r)},variance:function e(t,r){if(r<=4)return undefined;return 2*r*r*(t+r-2)/(t*(r-2)*(r-2)*(r-4))}});L.extend(L.cauchy,{pdf:function e(t,r,n){if(n<0){return 0}return n/(P.pow(t-r,2)+P.pow(n,2))/P.PI},cdf:function e(t,r,n){return P.atan((t-r)/n)/P.PI+.5},inv:function(e,t,r){return t+r*P.tan(P.PI*(e-.5))},median:function e(t){return t},mode:function e(t){return t},sample:function e(t,r){return L.randn()*P.sqrt(1/(2*L.randg(.5)))*r+t}});L.extend(L.chisquare,{pdf:function e(t,r){if(t<0)return 0;return t===0&&r===2?.5:P.exp((r/2-1)*P.log(t)-t/2-r/2*P.log(2)-L.gammaln(r/2))},cdf:function e(t,r){if(t<0)return 0;return L.lowRegGamma(r/2,t/2)},inv:function(e,t){return 2*L.gammapinv(e,.5*t)},mean:function(e){return e},median:function e(t){return t*P.pow(1-2/(9*t),3)},mode:function e(t){return t-2>0?t-2:0},sample:function e(t){return L.randg(t/2)*2},variance:function e(t){return 2*t}});L.extend(L.exponential,{pdf:function e(t,r){return t<0?0:r*P.exp(-r*t)},cdf:function e(t,r){return t<0?0:1-P.exp(-r*t)},inv:function(e,t){return-P.log(1-e)/t},mean:function(e){return 1/e},median:function(e){return 1/e*P.log(2)},mode:function e(){return 0},sample:function e(t){return-1/t*P.log(L._random_fn())},variance:function(e){return P.pow(e,-2)}});L.extend(L.gamma,{pdf:function e(t,r,n){if(t<0)return 0;return t===0&&r===1?1/n:P.exp((r-1)*P.log(t)-t/n-L.gammaln(r)-r*P.log(n))},cdf:function e(t,r,n){if(t<0)return 0;return L.lowRegGamma(r,t/n)},inv:function(e,t,r){return L.gammapinv(e,t)*r},mean:function(e,t){return e*t},mode:function e(t,r){if(t>1)return(t-1)*r;return undefined},sample:function e(t,r){return L.randg(t)*r},variance:function e(t,r){return t*r*r}});L.extend(L.invgamma,{pdf:function e(t,r,n){if(t<=0)return 0;return P.exp(-(r+1)*P.log(t)-n/t-L.gammaln(r)+r*P.log(n))},cdf:function e(t,r,n){if(t<=0)return 0;return 1-L.lowRegGamma(r,n/t)},inv:function(e,t,r){return r/L.gammapinv(1-e,t)},mean:function(e,t){return e>1?t/(e-1):undefined},mode:function e(t,r){return r/(t+1)},sample:function e(t,r){return r/L.randg(t)},variance:function e(t,r){if(t<=2)return undefined;return r*r/((t-1)*(t-1)*(t-2))}});L.extend(L.kumaraswamy,{pdf:function e(t,r,n){if(t===0&&r===1)return n;else if(t===1&&n===1)return r;return P.exp(P.log(r)+P.log(n)+(r-1)*P.log(t)+(n-1)*P.log(1-P.pow(t,r)))},cdf:function e(t,r,n){if(t<0)return 0;else if(t>1)return 1;return 1-P.pow(1-P.pow(t,r),n)},inv:function e(t,r,n){return P.pow(1-P.pow(1-t,1/n),1/r)},mean:function(e,t){return t*L.gammafn(1+1/e)*L.gammafn(t)/L.gammafn(1+1/e+t)},median:function e(t,r){return P.pow(1-P.pow(2,-1/r),1/t)},mode:function e(t,r){if(!(t>=1&&r>=1&&(t!==1&&r!==1)))return undefined;return P.pow((t-1)/(t*r-1),1/t)},variance:function e(){throw new Error("variance not yet implemented")}});L.extend(L.lognormal,{pdf:function e(t,r,n){if(t<=0)return 0;return P.exp(-P.log(t)-.5*P.log(2*P.PI)-P.log(n)-P.pow(P.log(t)-r,2)/(2*n*n))},cdf:function e(t,r,n){if(t<0)return 0;return.5+.5*L.erf((P.log(t)-r)/P.sqrt(2*n*n))},inv:function(e,t,r){return P.exp(-1.4142135623730951*r*L.erfcinv(2*e)+t)},mean:function e(t,r){return P.exp(t+r*r/2)},median:function e(t){return P.exp(t)},mode:function e(t,r){return P.exp(t-r*r)},sample:function e(t,r){return P.exp(L.randn()*r+t)},variance:function e(t,r){return(P.exp(r*r)-1)*P.exp(2*t+r*r)}});L.extend(L.noncentralt,{pdf:function e(t,r,n){var i=1e-14;if(P.abs(n)<i)return L.studentt.pdf(t,r);if(P.abs(t)<i){return P.exp(L.gammaln((r+1)/2)-n*n/2-.5*P.log(P.PI*r)-L.gammaln(r/2))}return r/t*(L.noncentralt.cdf(t*P.sqrt(1+2/r),r+2,n)-L.noncentralt.cdf(t,r,n))},cdf:function e(t,r,n){var i=1e-14;var a=200;if(P.abs(n)<i)return L.studentt.cdf(t,r);var o=false;if(t<0){o=true;n=-n}var s=L.normal.cdf(-n,0,1);var l=i+1;var u=l;var f=t*t/(t*t+r);var c=0;var d=P.exp(-n*n/2);var h=P.exp(-n*n/2-.5*P.log(2)-L.gammaln(3/2))*n;while(c<a||u>i||l>i){u=l;if(c>0){d*=n*n/(2*c);h*=n*n/(2*(c+1/2))}l=d*L.beta.cdf(f,c+.5,r/2)+h*L.beta.cdf(f,c+1,r/2);s+=.5*l;c++}return o?1-s:s}});L.extend(L.normal,{pdf:function e(t,r,n){return P.exp(-.5*P.log(2*P.PI)-P.log(n)-P.pow(t-r,2)/(2*n*n))},cdf:function e(t,r,n){return.5*(1+L.erf((t-r)/P.sqrt(2*n*n)))},inv:function(e,t,r){return-1.4142135623730951*r*L.erfcinv(2*e)+t},mean:function(e){return e},median:function e(t){return t},mode:function(e){return e},sample:function e(t,r){return L.randn()*r+t},variance:function(e,t){return t*t}});L.extend(L.pareto,{pdf:function e(t,r,n){if(t<r)return 0;return n*P.pow(r,n)/P.pow(t,n+1)},cdf:function e(t,r,n){if(t<r)return 0;return 1-P.pow(r/t,n)},inv:function e(t,r,n){return r/P.pow(1-t,1/n)},mean:function e(t,r){if(r<=1)return undefined;return r*P.pow(t,r)/(r-1)},median:function e(t,r){return t*(r*P.SQRT2)},mode:function e(t){return t},variance:function(e,t){if(t<=2)return undefined;return e*e*t/(P.pow(t-1,2)*(t-2))}});L.extend(L.studentt,{pdf:function e(t,r){r=r>1e100?1e100:r;return 1/(P.sqrt(r)*L.betafn(.5,r/2))*P.pow(1+t*t/r,-((r+1)/2))},cdf:function e(t,r){var n=r/2;return L.ibeta((t+P.sqrt(t*t+r))/(2*P.sqrt(t*t+r)),n,n)},inv:function(e,t){var r=L.ibetainv(2*P.min(e,1-e),.5*t,.5);r=P.sqrt(t*(1-r)/r);return e>.5?r:-r},mean:function e(t){return t>1?0:undefined},median:function e(){return 0},mode:function e(){return 0},sample:function e(t){return L.randn()*P.sqrt(t/(2*L.randg(t/2)))},variance:function e(t){return t>2?t/(t-2):t>1?Infinity:undefined}});L.extend(L.weibull,{pdf:function e(t,r,n){if(t<0||r<0||n<0)return 0;return n/r*P.pow(t/r,n-1)*P.exp(-P.pow(t/r,n))},cdf:function e(t,r,n){return t<0?0:1-P.exp(-P.pow(t/r,n))},inv:function(e,t,r){return t*P.pow(-P.log(1-e),1/r)},mean:function(e,t){return e*L.gammafn(1+1/t)},median:function e(t,r){return t*P.pow(P.log(2),1/r)},mode:function e(t,r){if(r<=1)return 0;return t*P.pow((r-1)/r,1/r)},sample:function e(t,r){return t*P.pow(-P.log(L._random_fn()),1/r)},variance:function e(t,r){return t*t*L.gammafn(1+2/r)-P.pow(L.weibull.mean(t,r),2)}});L.extend(L.uniform,{pdf:function e(t,r,n){return t<r||t>n?0:1/(n-r)},cdf:function e(t,r,n){if(t<r)return 0;else if(t<n)return(t-r)/(n-r);return 1},inv:function(e,t,r){return t+e*(r-t)},mean:function e(t,r){return.5*(t+r)},median:function e(t,r){return L.mean(t,r)},mode:function e(){throw new Error("mode is not yet implemented")},sample:function e(t,r){return t/2+r/2+(r/2-t/2)*(2*L._random_fn()-1)},variance:function e(t,r){return P.pow(r-t,2)/12}});function c(e,t,r,n){var i=0;var a=1;var o=1;var s=1;var l=0;var u=0;var f;while(P.abs((o-u)/o)>n){u=o;f=-(t+l)*(t+r+l)*e/(t+2*l)/(t+2*l+1);i=o+f*i;a=s+f*a;l=l+1;f=l*(r-l)*e/(t+2*l-1)/(t+2*l);o=i+f*o;s=a+f*s;i=i/s;a=a/s;o=o/s;s=1}return o/t}L.extend(L.binomial,{pdf:function e(t,r,n){return n===0||n===1?r*n===t?1:0:L.combination(r,t)*P.pow(n,t)*P.pow(1-n,r-t)},cdf:function e(t,r,n){var i;var a=1e-10;if(t<0)return 0;if(t>=r)return 1;if(n<0||n>1||r<=0)return NaN;t=P.floor(t);var o=n;var s=t+1;var l=r-t;var u=s+l;var f=P.exp(L.gammaln(u)-L.gammaln(l)-L.gammaln(s)+s*P.log(o)+l*P.log(1-o));if(o<(s+1)/(u+2))i=f*c(o,s,l,a);else i=1-f*c(1-o,l,s,a);return P.round((1-i)*(1/a))/(1/a)}});L.extend(L.negbin,{pdf:function e(t,r,n){if(t!==t>>>0)return false;if(t<0)return 0;return L.combination(t+r-1,r-1)*P.pow(1-n,t)*P.pow(n,r)},cdf:function e(t,r,n){var i=0,a=0;if(t<0)return 0;for(;a<=t;a++){i+=L.negbin.pdf(a,r,n)}return i}});L.extend(L.hypgeom,{pdf:function e(t,r,n,i){if(t!==t|0){return false}else if(t<0||t<n-(r-i)){return 0}else if(t>i||t>n){return 0}else if(n*2>r){if(i*2>r){return L.hypgeom.pdf(r-n-i+t,r,r-n,r-i)}else{return L.hypgeom.pdf(i-t,r,r-n,i)}}else if(i*2>r){return L.hypgeom.pdf(n-t,r,n,r-i)}else if(n<i){return L.hypgeom.pdf(t,r,i,n)}else{var a=1;var o=0;for(var s=0;s<t;s++){while(a>1&&o<i){a*=1-n/(r-o);o++}a*=(i-s)*(n-s)/((s+1)*(r-n-i+s+1))}for(;o<i;o++){a*=1-n/(r-o)}return P.min(1,P.max(0,a))}},cdf:function e(t,r,n,i){if(t<0||t<n-(r-i)){return 0}else if(t>=i||t>=n){return 1}else if(n*2>r){if(i*2>r){return L.hypgeom.cdf(r-n-i+t,r,r-n,r-i)}else{return 1-L.hypgeom.cdf(i-t-1,r,r-n,i)}}else if(i*2>r){return 1-L.hypgeom.cdf(n-t-1,r,n,r-i)}else if(n<i){return L.hypgeom.cdf(t,r,i,n)}else{var a=1;var o=1;var s=0;for(var l=0;l<t;l++){while(a>1&&s<i){var u=1-n/(r-s);o*=u;a*=u;s++}o*=(i-l)*(n-l)/((l+1)*(r-n-i+l+1));a+=o}for(;s<i;s++){a*=1-n/(r-s)}return P.min(1,P.max(0,a))}}});L.extend(L.poisson,{pdf:function e(t,r){if(r<0||t%1!==0||t<0){return 0}return P.pow(r,t)*P.exp(-r)/L.factorial(t)},cdf:function e(t,r){var n=[],i=0;if(t<0)return 0;for(;i<=t;i++){n.push(L.poisson.pdf(i,r))}return L.sum(n)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function e(t){var r=1,n=0,i=P.exp(-t);do{n++;r*=L._random_fn()}while(r>i);return n-1},sampleLarge:function e(t){var r=t;var n;var i,a,o,s,l,u,f,c,d;o=P.sqrt(r);s=P.log(r);u=.931+2.53*o;l=-.059+.02483*u;f=1.1239+1.1328/(u-3.4);c=.9277-3.6224/(u-2);while(1){i=P.random()-.5;a=P.random();d=.5-P.abs(i);n=P.floor((2*l/d+u)*i+r+.43);if(d>=.07&&a<=c){return n}if(n<0||d<.013&&a>d){continue}if(P.log(a)+P.log(f)-P.log(l/(d*d)+u)<=-r+n*s-L.loggam(n+1)){return n}}},sample:function e(t){if(t<10)return this.sampleSmall(t);else return this.sampleLarge(t)}});L.extend(L.triangular,{pdf:function e(t,r,n,i){if(n<=r||i<r||i>n){return NaN}else{if(t<r||t>n){return 0}else if(t<i){return 2*(t-r)/((n-r)*(i-r))}else if(t===i){return 2/(n-r)}else{return 2*(n-t)/((n-r)*(n-i))}}},cdf:function e(t,r,n,i){if(n<=r||i<r||i>n)return NaN;if(t<=r)return 0;else if(t>=n)return 1;if(t<=i)return P.pow(t-r,2)/((n-r)*(i-r));else return 1-P.pow(n-t,2)/((n-r)*(n-i))},inv:function e(t,r,n,i){if(n<=r||i<r||i>n){return NaN}else{if(t<=(i-r)/(n-r)){return r+(n-r)*P.sqrt(t*((i-r)/(n-r)))}else{return r+(n-r)*(1-P.sqrt((1-t)*(1-(i-r)/(n-r))))}}},mean:function e(t,r,n){return(t+r+n)/3},median:function e(t,r,n){if(n<=(t+r)/2){return r-P.sqrt((r-t)*(r-n))/P.sqrt(2)}else if(n>(t+r)/2){return t+P.sqrt((r-t)*(n-t))/P.sqrt(2)}},mode:function e(t,r,n){return n},sample:function e(t,r,n){var i=L._random_fn();if(i<(n-t)/(r-t))return t+P.sqrt(i*(r-t)*(n-t));return r-P.sqrt((1-i)*(r-t)*(r-n))},variance:function e(t,r,n){return(t*t+r*r+n*n-t*r-t*n-r*n)/18}});L.extend(L.arcsine,{pdf:function e(t,r,n){if(n<=r)return NaN;return t<=r||t>=n?0:2/P.PI*P.pow(P.pow(n-r,2)-P.pow(2*t-r-n,2),-.5)},cdf:function e(t,r,n){if(t<r)return 0;else if(t<n)return 2/P.PI*P.asin(P.sqrt((t-r)/(n-r)));return 1},inv:function(e,t,r){return t+(.5-.5*P.cos(P.PI*e))*(r-t)},mean:function e(t,r){if(r<=t)return NaN;return(t+r)/2},median:function e(t,r){if(r<=t)return NaN;return(t+r)/2},mode:function e(){throw new Error("mode is not yet implemented")},sample:function e(t,r){return(t+r)/2+(r-t)/2*P.sin(2*P.PI*L.uniform.sample(0,1))},variance:function e(t,r){if(r<=t)return NaN;return P.pow(r-t,2)/8}});function i(e){return e/P.abs(e)}L.extend(L.laplace,{pdf:function e(t,r,n){return n<=0?0:P.exp(-P.abs(t-r)/n)/(2*n)},cdf:function e(t,r,n){if(n<=0){return 0}if(t<r){return.5*P.exp((t-r)/n)}else{return 1-.5*P.exp(-(t-r)/n)}},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function e(t,r){var n=L._random_fn()-.5;return t-r*i(n)*P.log(1-2*P.abs(n))}});function F(e,t,r){var n=12;var i=6;var a=-30;var o=-50;var s=60;var l=8;var u=3;var f=2;var c=3;var d=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689];var h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277];var v=e*.5;if(v>=l)return 1;var p=2*L.normal.cdf(v,0,1,1,0)-1;if(p>=P.exp(o/r))p=P.pow(p,r);else p=0;var g;if(e>u)g=f;else g=c;var m=v;var y=(l-v)/g;var b=m+y;var w=0;var C=r-1;for(var S=1;S<=g;S++){var E=0;var k=.5*(b+m);var T=.5*(b-m);for(var _=1;_<=n;_++){var x,D;if(i<_){x=n-_+1;D=d[x-1]}else{x=_;D=-d[x-1]}var R=T*D;var I=k+R;var O=I*I;if(O>s)break;var A=2*L.normal.cdf(I,0,1,1,0);var N=2*L.normal.cdf(I,e,1,1,0);var M=A*.5-N*.5;if(M>=P.exp(a/C)){M=h[x-1]*P.exp(-(.5*O))*P.pow(M,C);E+=M}}E*=2*T*r/P.sqrt(2*P.PI);w+=E;m=b;b+=y}p+=w;if(p<=P.exp(a/t))return 0;p=P.pow(p,t);if(p>=1)return 1;return p}function v(e,t,r){var n=.322232421088;var i=.099348462606;var a=-1;var o=.588581570495;var s=-.342242088547;var l=.531103462366;var u=-.204231210125;var f=.10353775285;var c=-453642210148e-16;var d=.0038560700634;var h=.8832;var v=.2368;var p=1.214;var g=1.208;var m=1.4142;var y=120;var b=.5-.5*e;var w=P.sqrt(P.log(1/(b*b)));var C=w+((((w*c+u)*w+s)*w+a)*w+n)/((((w*d+f)*w+l)*w+o)*w+i);if(r<y)C+=(C*C*C+C)/r/4;var S=h-v*C;if(r<y)S+=-p/r+g*C/r;return C*(S*P.log(t-1)+m)}L.extend(L.tukey,{cdf:function e(t,r,n){var i=1;var a=r;var o=16;var s=8;var l=-30;var u=1e-14;var f=100;var c=800;var d=5e3;var h=25e3;var v=1;var p=.5;var g=.25;var m=.125;var y=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744];var b=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(n<2||i<1||a<2)return NaN;if(!Number.isFinite(t))return 1;if(n>h)return F(t,i,a);var w=n*.5;var C=w*P.log(n)-n*P.log(2)-L.gammaln(w);var S=w-1;var E=n*.25;var k;if(n<=f)k=v;else if(n<=c)k=p;else if(n<=d)k=g;else k=m;C+=P.log(k);var T=0;for(var _=1;_<=50;_++){var x=0;var D=(2*_-1)*k;for(var R=1;R<=o;R++){var I,O;if(s<R){I=R-s-1;O=C+S*P.log(D+y[I]*k)-(y[I]*k+D)*E}else{I=R-1;O=C+S*P.log(D-y[I]*k)+(y[I]*k-D)*E}var A;if(O>=l){if(s<R){A=t*P.sqrt((y[I]*k+D)*.5)}else{A=t*P.sqrt((-(y[I]*k)+D)*.5)}var N=F(A,i,a);var M=N*b[I]*P.exp(O);x+=M}}if(_*k>=1&&x<=u)break;T+=x}if(x>u){throw new Error("tukey.cdf failed to converge")}if(T>1)T=1;return T},inv:function(e,t,r){var n=1;var i=t;var a=1e-4;var o=50;if(r<2||n<1||i<2)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return Infinity;var s=v(e,i,r);var l=L.tukey.cdf(s,t,r)-e;var u;if(l>0)u=P.max(0,s-1);else u=s+1;var f=L.tukey.cdf(u,t,r)-e;var c;for(var d=1;d<o;d++){c=u-f*(u-s)/(f-l);l=f;s=u;if(c<0){c=0;f=-e}f=L.tukey.cdf(c,t,r)-e;u=c;var h=P.abs(u-s);if(h<a)return c}throw new Error("tukey.inv failed to converge")}})})(h,Math);(function(m,g){var a=Array.prototype.push;var t=m.utils.isArray;function c(e){return t(e)||e instanceof m}m.extend({add:function e(t,n){if(c(n)){if(!c(n[0]))n=[n];return m.map(t,function(e,t,r){return e+n[t][r]})}return m.map(t,function(e){return e+n})},subtract:function e(t,n){if(c(n)){if(!c(n[0]))n=[n];return m.map(t,function(e,t,r){return e-n[t][r]||0})}return m.map(t,function(e){return e-n})},divide:function e(t,r){if(c(r)){if(!c(r[0]))r=[r];return m.multiply(t,m.inv(r))}return m.map(t,function(e){return e/r})},multiply:function e(t,r){var n,i,a,o,s,l,u,f;if(t.length===undefined&&r.length===undefined){return t*r}s=t.length,l=t[0].length,u=m.zeros(s,a=c(r)?r[0].length:l),f=0;if(c(r)){for(;f<a;f++){for(n=0;n<s;n++){o=0;for(i=0;i<l;i++)o+=t[n][i]*r[i][f];u[n][f]=o}}return s===1&&f===1?u[0][0]:u}return m.map(t,function(e){return e*r})},outer:function e(t,r){return m.multiply(t.map(function(e){return[e]}),[r])},dot:function e(t,r){if(!c(t[0]))t=[t];if(!c(r[0]))r=[r];var n=t[0].length===1&&t.length!==1?m.transpose(t):t,i=r[0].length===1&&r.length!==1?m.transpose(r):r,a=[],o=0,s=n.length,l=n[0].length,u,f;for(;o<s;o++){a[o]=[];u=0;for(f=0;f<l;f++)u+=n[o][f]*i[o][f];a[o]=u}return a.length===1?a[0]:a},pow:function e(t,r){return m.map(t,function(e){return g.pow(e,r)})},exp:function e(t){return m.map(t,function(e){return g.exp(e)})},log:function e(t){return m.map(t,function(e){return g.log(e)})},abs:function e(t){return m.map(t,function(e){return g.abs(e)})},norm:function e(t,r){var n=0,i=0;if(isNaN(r))r=2;if(c(t[0]))t=t[0];for(;i<t.length;i++){n+=g.pow(g.abs(t[i]),r)}return g.pow(n,1/r)},angle:function e(t,r){return g.acos(m.dot(t,r)/(m.norm(t)*m.norm(r)))},aug:function e(t,r){var n=[];var i;for(i=0;i<t.length;i++){n.push(t[i].slice())}for(i=0;i<n.length;i++){a.apply(n[i],r[i])}return n},inv:function e(t){var r=t.length;var n=t[0].length;var i=m.identity(r,n);var a=m.gauss_jordan(t,i);var o=[];var s=0;var l;for(;s<r;s++){o[s]=[];for(l=n;l<a[0].length;l++)o[s][l-n]=a[s][l]}return o},det:function e(t){var r=t.length,n=r*2,i=new Array(n),a=r-1,o=n-1,s=a-r+1,l=o,u=0,f=0,c;if(r===2){return t[0][0]*t[1][1]-t[0][1]*t[1][0]}for(;u<n;u++){i[u]=1}for(u=0;u<r;u++){for(c=0;c<r;c++){i[s<0?s+r:s]*=t[u][c];i[l<r?l+r:l]*=t[u][c];s++;l--}s=--a-r+1;l=--o}for(u=0;u<r;u++){f+=i[u]}for(;u<n;u++){f-=i[u]}return f},gauss_elimination:function e(t,r){var n=0,i=0,a=t.length,o=t[0].length,s=1,l=0,u=[],f,c,d,h;t=m.aug(t,r);f=t[0].length;for(n=0;n<a;n++){c=t[n][n];i=n;for(h=n+1;h<o;h++){if(c<g.abs(t[h][n])){c=t[h][n];i=h}}if(i!=n){for(h=0;h<f;h++){d=t[n][h];t[n][h]=t[i][h];t[i][h]=d}}for(i=n+1;i<a;i++){s=t[i][n]/t[n][n];for(h=n;h<f;h++){t[i][h]=t[i][h]-s*t[n][h]}}}for(n=a-1;n>=0;n--){l=0;for(i=n+1;i<=a-1;i++){l=l+u[i]*t[n][i]}u[n]=(t[n][f-1]-l)/t[n][n]}return u},gauss_jordan:function e(t,r){var n=m.aug(t,r);var i=n.length;var a=n[0].length;var o=0;var s,l,u;for(l=0;l<i;l++){var f=l;for(u=l+1;u<i;u++){if(g.abs(n[u][l])>g.abs(n[f][l]))f=u}var c=n[l];n[l]=n[f];n[f]=c;for(u=l+1;u<i;u++){o=n[u][l]/n[l][l];for(s=l;s<a;s++){n[u][s]-=n[l][s]*o}}}for(l=i-1;l>=0;l--){o=n[l][l];for(u=0;u<l;u++){for(s=a-1;s>l-1;s--){n[u][s]-=n[l][s]*n[u][l]/o}}n[l][l]/=o;for(s=i;s<a;s++){n[l][s]/=o}}return n},triaUpSolve:function e(r,n){var i=r[0].length;var a=m.zeros(1,i)[0];var o;var t=false;if(n[0].length!=undefined){n=n.map(function(e){return e[0]});t=true}m.arange(i-1,-1,-1).forEach(function(t){o=m.arange(t+1,i).map(function(e){return a[e]*r[t][e]});a[t]=(n[t]-m.sum(o))/r[t][t]});if(t)return a.map(function(e){return[e]});return a},triaLowSolve:function e(r,n){var t=r[0].length;var i=m.zeros(1,t)[0];var a;var o=false;if(n[0].length!=undefined){n=n.map(function(e){return e[0]});o=true}m.arange(t).forEach(function(t){a=m.arange(t).map(function(e){return r[t][e]*i[e]});i[t]=(n[t]-m.sum(a))/r[t][t]});if(o)return i.map(function(e){return[e]});return i},lu:function e(n){var t=n.length;var i=m.identity(t);var a=m.zeros(n.length,n[0].length);var o;m.arange(t).forEach(function(e){a[0][e]=n[0][e]});m.arange(1,t).forEach(function(r){m.arange(r).forEach(function(t){o=m.arange(t).map(function(e){return i[r][e]*a[e][t]});i[r][t]=(n[r][t]-m.sum(o))/a[t][t]});m.arange(r,t).forEach(function(t){o=m.arange(r).map(function(e){return i[r][e]*a[e][t]});a[r][t]=n[o.length][t]-m.sum(o)})});return[i,a]},cholesky:function e(n){var t=n.length;var i=m.zeros(n.length,n[0].length);var a;m.arange(t).forEach(function(r){a=m.arange(r).map(function(e){return g.pow(i[r][e],2)});i[r][r]=g.sqrt(n[r][r]-m.sum(a));m.arange(r+1,t).forEach(function(t){a=m.arange(r).map(function(e){return i[r][e]*i[t][e]});i[t][r]=(n[r][t]-m.sum(a))/i[r][r]})});return i},gauss_jacobi:function e(t,r,n,i){var a=0;var o=0;var s=t.length;var l=[];var u=[];var f=[];var c,d,h,v;for(;a<s;a++){l[a]=[];u[a]=[];f[a]=[];for(o=0;o<s;o++){if(a>o){l[a][o]=t[a][o];u[a][o]=f[a][o]=0}else if(a<o){u[a][o]=t[a][o];l[a][o]=f[a][o]=0}else{f[a][o]=t[a][o];l[a][o]=u[a][o]=0}}}h=m.multiply(m.multiply(m.inv(f),m.add(l,u)),-1);d=m.multiply(m.inv(f),r);c=n;v=m.add(m.multiply(h,n),d);a=2;while(g.abs(m.norm(m.subtract(v,c)))>i){c=v;v=m.add(m.multiply(h,c),d);a++}return v},gauss_seidel:function e(t,r,n,i){var a=0;var o=t.length;var s=[];var l=[];var u=[];var f,c,d,h,v;for(;a<o;a++){s[a]=[];l[a]=[];u[a]=[];for(f=0;f<o;f++){if(a>f){s[a][f]=t[a][f];l[a][f]=u[a][f]=0}else if(a<f){l[a][f]=t[a][f];s[a][f]=u[a][f]=0}else{u[a][f]=t[a][f];s[a][f]=l[a][f]=0}}}h=m.multiply(m.multiply(m.inv(m.add(u,s)),l),-1);d=m.multiply(m.inv(m.add(u,s)),r);c=n;v=m.add(m.multiply(h,n),d);a=2;while(g.abs(m.norm(m.subtract(v,c)))>i){c=v;v=m.add(m.multiply(h,c),d);a=a+1}return v},SOR:function e(t,r,n,i,a){var o=0;var s=t.length;var l=[];var u=[];var f=[];var c,d,h,v,p;for(;o<s;o++){l[o]=[];u[o]=[];f[o]=[];for(c=0;c<s;c++){if(o>c){l[o][c]=t[o][c];u[o][c]=f[o][c]=0}else if(o<c){u[o][c]=t[o][c];l[o][c]=f[o][c]=0}else{f[o][c]=t[o][c];l[o][c]=u[o][c]=0}}}v=m.multiply(m.inv(m.add(f,m.multiply(l,a))),m.subtract(m.multiply(f,1-a),m.multiply(u,a)));h=m.multiply(m.multiply(m.inv(m.add(f,m.multiply(l,a))),r),a);d=n;p=m.add(m.multiply(v,n),h);o=2;while(g.abs(m.norm(m.subtract(p,d)))>i){d=p;p=m.add(m.multiply(v,d),h);o++}return p},householder:function e(t){var r=t.length;var n=t[0].length;var i=0;var a=[];var o=[];var s,l,u,f,c;for(;i<r-1;i++){s=0;for(f=i+1;f<n;f++)s+=t[f][i]*t[f][i];c=t[i+1][i]>0?-1:1;s=c*g.sqrt(s);l=g.sqrt((s*s-t[i+1][i]*s)/2);a=m.zeros(r,1);a[i+1][0]=(t[i+1][i]-s)/(2*l);for(u=i+2;u<r;u++)a[u][0]=t[u][i]/(2*l);o=m.subtract(m.identity(r,n),m.multiply(m.multiply(a,m.transpose(a)),2));t=m.multiply(o,m.multiply(t,o))}return t},QR:function(){var s=m.sum;var l=m.arange;function e(t){var e=t.length;var r=t[0].length;var n=m.zeros(r,r);t=m.copy(t);var i,a,o;for(a=0;a<r;a++){n[a][a]=g.sqrt(s(l(e).map(function(e){return t[e][a]*t[e][a]})));for(i=0;i<e;i++){t[i][a]=t[i][a]/n[a][a]}for(o=a+1;o<r;o++){n[a][o]=s(l(e).map(function(e){return t[e][a]*t[e][o]}));for(i=0;i<e;i++){t[i][o]=t[i][o]-t[i][a]*n[a][o]}}}return[t,n]}return e}(),lstsq:function(){function d(s){s=m.copy(s);var e=s.length;var l=m.identity(e);m.arange(e-1,-1,-1).forEach(function(o){m.sliceAssign(l,{row:o},m.divide(m.slice(l,{row:o}),s[o][o]));m.sliceAssign(s,{row:o},m.divide(m.slice(s,{row:o}),s[o][o]));m.arange(o).forEach(function(e){var t=m.multiply(s[e][o],-1);var r=m.slice(s,{row:e});var n=m.multiply(m.slice(s,{row:o}),t);m.sliceAssign(s,{row:e},m.add(r,n));var i=m.slice(l,{row:e});var a=m.multiply(m.slice(l,{row:o}),t);m.sliceAssign(l,{row:e},m.add(i,a))})});return l}function e(e,t){var r=false;if(t[0].length===undefined){t=t.map(function(e){return[e]});r=true}var n=m.QR(e);var i=n[0];var a=n[1];var o=e[0].length;var s=m.slice(i,{col:{end:o}});var l=m.slice(a,{row:{end:o}});var u=d(l);var f=m.transpose(s);if(f[0].length===undefined){f=[f]}var c=m.multiply(m.multiply(u,f),t);if(c.length===undefined){c=[[c]]}if(r)return c.map(function(e){return e[0]});return c}return e}(),jacobi:function e(t){var r=1;var n=t.length;var i=m.identity(n,n);var a=[];var o,s,l,u,f,c,d,h;while(r===1){c=t[0][1];u=0;f=1;for(s=0;s<n;s++){for(l=0;l<n;l++){if(s!=l){if(c<g.abs(t[s][l])){c=g.abs(t[s][l]);u=s;f=l}}}}if(t[u][u]===t[f][f])d=t[u][f]>0?g.PI/4:-g.PI/4;else d=g.atan(2*t[u][f]/(t[u][u]-t[f][f]))/2;h=m.identity(n,n);h[u][u]=g.cos(d);h[u][f]=-g.sin(d);h[f][u]=g.sin(d);h[f][f]=g.cos(d);i=m.multiply(i,h);o=m.multiply(m.multiply(m.inv(h),t),h);t=o;r=0;for(s=1;s<n;s++){for(l=1;l<n;l++){if(s!=l&&g.abs(t[s][l])>.001){r=1}}}}for(s=0;s<n;s++)a.push(t[s][s]);return[i,a]},rungekutta:function e(t,r,n,i,a,o){var s,l,u,f,c;if(o===2){while(i<=n){s=r*t(i,a);l=r*t(i+r,a+s);u=a+(s+l)/2;a=u;i=i+r}}if(o===4){while(i<=n){s=r*t(i,a);l=r*t(i+r/2,a+s/2);f=r*t(i+r/2,a+l/2);c=r*t(i+r,a+f);u=a+(s+2*l+2*f+c)/6;a=u;i=i+r}}return a},romberg:function e(t,r,n,i){var a=0;var o=(n-r)/2;var s=[];var l=[];var u=[];var f,c,d,h,v;while(a<i/2){v=t(r);for(d=r,h=0;d<=n;d=d+o,h++)s[h]=d;f=s.length;for(d=1;d<f-1;d++){v+=(d%2!==0?4:2)*t(s[d])}v=o/3*(v+t(n));u[a]=v;o/=2;a++}c=u.length;f=1;while(c!==1){for(d=0;d<c-1;d++)l[d]=(g.pow(4,f)*u[d+1]-u[d])/(g.pow(4,f)-1);c=l.length;u=l;l=[];f++}return u},richardson:function e(t,r,n,i){function a(e,t){var r=0;var n=e.length;var i;for(;r<n;r++)if(e[r]===t)i=r;return i}var o=g.abs(n-t[a(t,n)+1]);var s=0;var l=[];var u=[];var f,c,d,h,v;while(i>=o){f=a(t,n+i);c=a(t,n);l[s]=(r[f]-2*r[c]+r[2*c-f])/(i*i);i/=2;s++}h=l.length;d=1;while(h!=1){for(v=0;v<h-1;v++)u[v]=(g.pow(4,d)*l[v+1]-l[v])/(g.pow(4,d)-1);h=u.length;l=u;u=[];d++}return l},simpson:function e(t,r,n,i){var a=(n-r)/i;var o=t(r);var s=[];var l=r;var u=0;var f=1;var c;for(;l<=n;l=l+a,u++)s[u]=l;c=s.length;for(;f<c-1;f++){o+=(f%2!==0?4:2)*t(s[f])}return a/3*(o+t(n))},hermite:function e(t,r,n,i){var a=t.length;var o=0;var s=0;var l=[];var u=[];var f=[];var c=[];var d;for(;s<a;s++){l[s]=1;for(d=0;d<a;d++){if(s!=d)l[s]*=(i-t[d])/(t[s]-t[d])}u[s]=0;for(d=0;d<a;d++){if(s!=d)u[s]+=1/(t[s]-t[d])}f[s]=(1-2*(i-t[s])*u[s])*(l[s]*l[s]);c[s]=(i-t[s])*(l[s]*l[s]);o+=f[s]*r[s]+c[s]*n[s]}return o},lagrange:function e(t,r,n){var i=0;var a=0;var o,s;var l=t.length;for(;a<l;a++){s=r[a];for(o=0;o<l;o++){if(a!=o)s*=(n-t[o])/(t[a]-t[o])}i+=s}return i},cubic_spline:function e(t,r,n){var i=t.length;var a=0,o;var s=[];var l=[];var u=[];var f=[];var c=[];var d=[];var h=[];for(;a<i-1;a++)c[a]=t[a+1]-t[a];u[0]=0;for(a=1;a<i-1;a++){u[a]=3/c[a]*(r[a+1]-r[a])-3/c[a-1]*(r[a]-r[a-1])}for(a=1;a<i-1;a++){s[a]=[];l[a]=[];s[a][a-1]=c[a-1];s[a][a]=2*(c[a-1]+c[a]);s[a][a+1]=c[a];l[a][0]=u[a]}f=m.multiply(m.inv(s),l);for(o=0;o<i-1;o++){d[o]=(r[o+1]-r[o])/c[o]-c[o]*(f[o+1][0]+2*f[o][0])/3;h[o]=(f[o+1][0]-f[o][0])/(3*c[o])}for(o=0;o<i;o++){if(t[o]>n)break}o-=1;return r[o]+(n-t[o])*d[o]+m.sq(n-t[o])*f[o]+(n-t[o])*m.sq(n-t[o])*h[o]},gauss_quadrature:function e(){throw new Error("gauss_quadrature not yet implemented")},PCA:function e(t){var r=t.length;var n=t[0].length;var i=0;var a,o;var s=[];var l=[];var u=[];var f=[];var c=[];var d=[];var h=[];var v=[];var p=[];var g=[];for(i=0;i<r;i++){s[i]=m.sum(t[i])/n}for(i=0;i<n;i++){h[i]=[];for(a=0;a<r;a++){h[i][a]=t[a][i]-s[a]}}h=m.transpose(h);for(i=0;i<r;i++){v[i]=[];for(a=0;a<r;a++){v[i][a]=m.dot([h[i]],[h[a]])/(n-1)}}u=m.jacobi(v);p=u[0];l=u[1];g=m.transpose(p);for(i=0;i<l.length;i++){for(a=i;a<l.length;a++){if(l[i]<l[a]){o=l[i];l[i]=l[a];l[a]=o;f=g[i];g[i]=g[a];g[a]=f}}}d=m.transpose(h);for(i=0;i<r;i++){c[i]=[];for(a=0;a<d.length;a++){c[i][a]=m.dot([g[i]],[d[a]])}}return[t,l,g,c]}});(function(e){for(var t=0;t<e.length;t++)(function(n){m.fn[n]=function(e,t){var r=this;if(t){setTimeout(function(){t.call(r,m.fn[n].call(r,e))},15);return this}if(typeof m[n](this,e)==="number")return m[n](this,e);else return m(m[n](this,e))}})(e[t])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(h,Math);(function(f,c){var d=[].slice;var s=f.utils.isNumber;var n=f.utils.isArray;f.extend({zscore:function e(){var t=d.call(arguments);if(s(t[1])){return(t[0]-t[1])/t[2]}return(t[0]-f.mean(t[1]))/f.stdev(t[1],t[2])},ztest:function e(){var t=d.call(arguments);var r;if(n(t[1])){r=f.zscore(t[0],t[1],t[3]);return t[2]===1?f.normal.cdf(-c.abs(r),0,1):f.normal.cdf(-c.abs(r),0,1)*2}else{if(t.length>2){r=f.zscore(t[0],t[1],t[2]);return t[3]===1?f.normal.cdf(-c.abs(r),0,1):f.normal.cdf(-c.abs(r),0,1)*2}else{r=t[0];return t[1]===1?f.normal.cdf(-c.abs(r),0,1):f.normal.cdf(-c.abs(r),0,1)*2}}}});f.extend(f.fn,{zscore:function e(t,r){return(t-this.mean())/this.stdev(r)},ztest:function e(t,r,n){var i=c.abs(this.zscore(t,n));return r===1?f.normal.cdf(-i,0,1):f.normal.cdf(-i,0,1)*2}});f.extend({tscore:function e(){var t=d.call(arguments);return t.length===4?(t[0]-t[1])/(t[2]/c.sqrt(t[3])):(t[0]-f.mean(t[1]))/(f.stdev(t[1],true)/c.sqrt(t[1].length))},ttest:function e(){var t=d.call(arguments);var r;if(t.length===5){r=c.abs(f.tscore(t[0],t[1],t[2],t[3]));return t[4]===1?f.studentt.cdf(-r,t[3]-1):f.studentt.cdf(-r,t[3]-1)*2}if(s(t[1])){r=c.abs(t[0]);return t[2]==1?f.studentt.cdf(-r,t[1]-1):f.studentt.cdf(-r,t[1]-1)*2}r=c.abs(f.tscore(t[0],t[1]));return t[2]==1?f.studentt.cdf(-r,t[1].length-1):f.studentt.cdf(-r,t[1].length-1)*2}});f.extend(f.fn,{tscore:function e(t){return(t-this.mean())/(this.stdev(true)/c.sqrt(this.cols()))},ttest:function e(t,r){return r===1?1-f.studentt.cdf(c.abs(this.tscore(t)),this.cols()-1):f.studentt.cdf(-c.abs(this.tscore(t)),this.cols()-1)*2}});f.extend({anovafscore:function e(){var t=d.call(arguments),r,n,i,a,o,s,l,u;if(t.length===1){o=new Array(t[0].length);for(l=0;l<t[0].length;l++){o[l]=t[0][l]}t=o}n=new Array;for(l=0;l<t.length;l++){n=n.concat(t[l])}i=f.mean(n);r=0;for(l=0;l<t.length;l++){r=r+t[l].length*c.pow(f.mean(t[l])-i,2)}r/=t.length-1;s=0;for(l=0;l<t.length;l++){a=f.mean(t[l]);for(u=0;u<t[l].length;u++){s+=c.pow(t[l][u]-a,2)}}s/=n.length-t.length;return r/s},anovaftest:function e(){var t=d.call(arguments),r,n,i,a;if(s(t[0])){return 1-f.centralF.cdf(t[0],t[1],t[2])}var o=f.anovafscore(t);r=t.length-1;i=0;for(a=0;a<t.length;a++){i=i+t[a].length}n=i-r-1;return 1-f.centralF.cdf(o,r,n)},ftest:function e(t,r,n){return 1-f.centralF.cdf(t,r,n)}});f.extend(f.fn,{anovafscore:function e(){return f.anovafscore(this.toArray())},anovaftes:function e(){var t=0;var r;for(r=0;r<this.length;r++){t=t+this[r].length}return f.ftest(this.anovafscore(),this.length-1,t-this.length)}});f.extend({qscore:function e(){var t=d.call(arguments);var r,n,i,a,o;if(s(t[0])){r=t[0];n=t[1];i=t[2];a=t[3];o=t[4]}else{r=f.mean(t[0]);n=f.mean(t[1]);i=t[0].length;a=t[1].length;o=t[2]}return c.abs(r-n)/(o*c.sqrt((1/i+1/a)/2))},qtest:function e(){var t=d.call(arguments);var r;if(t.length===3){r=t[0];t=t.slice(1)}else if(t.length===7){r=f.qscore(t[0],t[1],t[2],t[3],t[4]);t=t.slice(5)}else{r=f.qscore(t[0],t[1],t[2]);t=t.slice(3)}var n=t[0];var i=t[1];return 1-f.tukey.cdf(r,i,n-i)},tukeyhsd:function e(t){var r=f.pooledstdev(t);var n=t.map(function(e){return f.mean(e)});var i=t.reduce(function(e,t){return e+t.length},0);var a=[];for(var o=0;o<t.length;++o){for(var s=o+1;s<t.length;++s){var l=f.qtest(n[o],n[s],t[o].length,t[s].length,r,i,t.length);a.push([[o,s],l])}}return a}});f.extend({normalci:function e(){var t=d.call(arguments),r=new Array(2),n;if(t.length===4){n=c.abs(f.normal.inv(t[1]/2,0,1)*t[2]/c.sqrt(t[3]))}else{n=c.abs(f.normal.inv(t[1]/2,0,1)*f.stdev(t[2])/c.sqrt(t[2].length))}r[0]=t[0]-n;r[1]=t[0]+n;return r},tci:function e(){var t=d.call(arguments),r=new Array(2),n;if(t.length===4){n=c.abs(f.studentt.inv(t[1]/2,t[3]-1)*t[2]/c.sqrt(t[3]))}else{n=c.abs(f.studentt.inv(t[1]/2,t[2].length-1)*f.stdev(t[2],true)/c.sqrt(t[2].length))}r[0]=t[0]-n;r[1]=t[0]+n;return r},significant:function e(t,r){return t<r}});f.extend(f.fn,{normalci:function e(t,r){return f.normalci(t,r,this.toArray())},tci:function e(t,r){return f.tci(t,r,this.toArray())}});function o(e,t,r,n){if(e>1||r>1||e<=0||r<=0){throw new Error("Proportions should be greater than 0 and less than 1")}var i=(e*t+r*n)/(t+n);var a=c.sqrt(i*(1-i)*(1/t+1/n));return(e-r)/a}f.extend(f.fn,{oneSidedDifferenceOfProportions:function e(t,r,n,i){var a=o(t,r,n,i);return f.ztest(a,1)},twoSidedDifferenceOfProportions:function e(t,r,n,i){var a=o(t,r,n,i);return f.ztest(a,2)}})})(h,Math);h.models=function(){function l(r){var n=r[0].length;var e=h.arange(n).map(function(t){var e=h.arange(n).filter(function(e){return e!==t});return o(h.col(r,t).map(function(e){return e[0]}),h.col(r,e))});return e}function o(e,t){var r=e.length;var n=t[0].length-1;var i=r-n-1;var a=h.lstsq(t,e);var o=h.multiply(t,a.map(function(e){return[e]})).map(function(e){return e[0]});var s=h.subtract(e,o);var l=h.mean(e);var u=h.sum(o.map(function(e){return Math.pow(e-l,2)}));var f=h.sum(e.map(function(e,t){return Math.pow(e-o[t],2)}));var c=u+f;var d=u/c;return{exog:t,endog:e,nobs:r,df_model:n,df_resid:i,coef:a,predict:o,resid:s,ybar:l,SST:c,SSE:u,SSR:f,R2:d}}function s(r){var e=l(r.exog);var n=Math.sqrt(r.SSR/r.df_resid);var i=e.map(function(e){var t=e.SST;var r=e.R2;return n/Math.sqrt(t*(1-r))});var t=r.coef.map(function(e,t){return(e-0)/i[t]});var a=t.map(function(e){var t=h.studentt.cdf(e,r.df_resid);return(t>.5?1-t:t)*2});var o=h.studentt.inv(.975,r.df_resid);var s=r.coef.map(function(e,t){var r=o*i[t];return[e-r,e+r]});return{se:i,t:t,p:a,sigmaHat:n,interval95:s}}function u(e){var t=e.R2/e.df_model/((1-e.R2)/e.df_resid);var r=function(e,t,r){return h.beta.cdf(e/(r/t+e),t/2,r/2)};var n=1-r(t,e.df_model,e.df_resid);return{F_statistic:t,pvalue:n}}function e(e,t){var r=o(e,t);var n=s(r);var i=u(r);var a=1-(1-r.R2)*((r.nobs-1)/r.df_resid);r.t=n;r.f=i;r.adjust_R2=a;return r}return{ols:e}}();h.extend({buildxmatrix:function e(){var t=new Array(arguments.length);for(var r=0;r<arguments.length;r++){var n=[1];t[r]=n.concat(arguments[r])}return h(t)},builddxmatrix:function e(){var t=new Array(arguments[0].length);for(var r=0;r<arguments[0].length;r++){var n=[1];t[r]=n.concat(arguments[0][r])}return h(t)},buildjxmatrix:function e(t){var r=new Array(t.length);for(var n=0;n<t.length;n++){r[n]=t[n]}return h.builddxmatrix(r)},buildymatrix:function e(t){return h(t).transpose()},buildjymatrix:function e(t){return t.transpose()},matrixmult:function e(t,r){var n,i,a,o,s;if(t.cols()==r.rows()){if(r.rows()>1){o=[];for(n=0;n<t.rows();n++){o[n]=[];for(i=0;i<r.cols();i++){s=0;for(a=0;a<t.cols();a++){s+=t.toArray()[n][a]*r.toArray()[a][i]}o[n][i]=s}}return h(o)}o=[];for(n=0;n<t.rows();n++){o[n]=[];for(i=0;i<r.cols();i++){s=0;for(a=0;a<t.cols();a++){s+=t.toArray()[n][a]*r.toArray()[i]}o[n][i]=s}}return h(o)}},regress:function e(t,r){var n=h.xtranspxinv(t);var i=t.transpose();var a=h.matrixmult(h(n),i);return h.matrixmult(a,r)},regresst:function e(t,r,n){var i=h.regress(t,r);var a={};a.anova={};var o=h.jMatYBar(t,i);a.yBar=o;var s=r.mean();a.anova.residuals=h.residuals(r,o);a.anova.ssr=h.ssr(o,s);a.anova.msr=a.anova.ssr/(t[0].length-1);a.anova.sse=h.sse(r,o);a.anova.mse=a.anova.sse/(r.length-(t[0].length-1)-1);a.anova.sst=h.sst(r,s);a.anova.mst=a.anova.sst/(r.length-1);a.anova.r2=1-a.anova.sse/a.anova.sst;if(a.anova.r2<0)a.anova.r2=0;a.anova.fratio=a.anova.msr/a.anova.mse;a.anova.pvalue=h.anovaftest(a.anova.fratio,t[0].length-1,r.length-(t[0].length-1)-1);a.anova.rmse=Math.sqrt(a.anova.mse);a.anova.r2adj=1-a.anova.mse/a.anova.mst;if(a.anova.r2adj<0)a.anova.r2adj=0;a.stats=new Array(t[0].length);var l=h.xtranspxinv(t);var u,f,c;for(var d=0;d<i.length;d++){u=Math.sqrt(a.anova.mse*Math.abs(l[d][d]));f=Math.abs(i[d]/u);c=h.ttest(f,r.length-t[0].length-1,n);a.stats[d]=[i[d],u,f,c]}a.regress=i;return a},xtranspx:function e(t){return h.matrixmult(t.transpose(),t)},xtranspxinv:function e(t){var r=h.matrixmult(t.transpose(),t);var n=h.inv(r);return n},jMatYBar:function e(t,r){var n=h.matrixmult(t,r);return new h(n)},residuals:function e(t,r){return h.matrixsubtract(t,r)},ssr:function e(t,r){var e=0;for(var n=0;n<t.length;n++){e+=Math.pow(t[n]-r,2)}return e},sse:function e(t,r){var e=0;for(var n=0;n<t.length;n++){e+=Math.pow(t[n]-r[n],2)}return e},sst:function e(t,r){var e=0;for(var n=0;n<t.length;n++){e+=Math.pow(t[n]-r,2)}return e},matrixsubtract:function e(t,r){var n=new Array(t.length);for(var i=0;i<t.length;i++){n[i]=new Array(t[i].length);for(var a=0;a<t[i].length;a++){n[i][a]=t[i][a]-r[i][a]}}return h(n)}});h.jStat=h;return h})},function(e,t,r){var n=r(1);var l=r(0);t.UNIQUE=function(){var e=[];for(var t=0;t<arguments.length;++t){var r=false;var n=arguments[t];for(var i=0;i<e.length;++i){r=e[i]===n;if(r){break}}if(!r){e.push(n)}}return e};t.FLATTEN=n.flatten;t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};t.REFERENCE=function(e,t){if(!arguments.length){return l.error}try{var r=t.split(".");var n=e;for(var i=0;i<r.length;++i){var a=r[i];if(a[a.length-1]==="]"){var o=a.indexOf("[");var s=a.substring(o+1,a.length-1);n=n[a.substring(0,o)][s]}else{n=n[a]}}return n}catch(e){}};t.JOIN=function(e,t){return e.join(t)};t.NUMBERS=function(){var e=n.flatten(arguments);return e.filter(function(e){return typeof e==="number"})}},function(e,f,t){var w=t(0);var r=t(10);var a=t(6);var C=t(1);var n=t(26);function i(e){return/^[01]{1,10}$/.test(e)}f.BESSELI=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}return n.besseli(e,t)};f.BESSELJ=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}return n.besselj(e,t)};f.BESSELK=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}return n.besselk(e,t)};f.BESSELY=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}return n.bessely(e,t)};f.BIN2DEC=function(e){if(!i(e)){return w.num}var t=parseInt(e,2);var r=e.toString();if(r.length===10&&r.substring(0,1)==="1"){return parseInt(r.substring(1),2)-512}else{return t}};f.BIN2HEX=function(e,t){if(!i(e)){return w.num}var r=e.toString();if(r.length===10&&r.substring(0,1)==="1"){return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16)}var n=parseInt(e,2).toString(16);if(t===undefined){return n}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=n.length?a.REPT("0",t-n.length)+n:w.num}};f.BIN2OCT=function(e,t){if(!i(e)){return w.num}var r=e.toString();if(r.length===10&&r.substring(0,1)==="1"){return(1073741312+parseInt(r.substring(1),2)).toString(8)}var n=parseInt(e,2).toString(8);if(t===undefined){return n}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=n.length?a.REPT("0",t-n.length)+n:w.num}};f.BITAND=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}if(e<0||t<0){return w.num}if(Math.floor(e)!==e||Math.floor(t)!==t){return w.num}if(e>0xffffffffffff||t>0xffffffffffff){return w.num}return e&t};f.BITLSHIFT=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}if(e<0){return w.num}if(Math.floor(e)!==e){return w.num}if(e>0xffffffffffff){return w.num}if(Math.abs(t)>53){return w.num}return t>=0?e<<t:e>>-t};f.BITOR=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}if(e<0||t<0){return w.num}if(Math.floor(e)!==e||Math.floor(t)!==t){return w.num}if(e>0xffffffffffff||t>0xffffffffffff){return w.num}return e|t};f.BITRSHIFT=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}if(e<0){return w.num}if(Math.floor(e)!==e){return w.num}if(e>0xffffffffffff){return w.num}if(Math.abs(t)>53){return w.num}return t>=0?e>>t:e<<-t};f.BITXOR=function(e,t){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}if(e<0||t<0){return w.num}if(Math.floor(e)!==e||Math.floor(t)!==t){return w.num}if(e>0xffffffffffff||t>0xffffffffffff){return w.num}return e^t};f.COMPLEX=function(e,t,r){e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return e}r=r===undefined?"i":r;if(r!=="i"&&r!=="j"){return w.value}if(e===0&&t===0){return 0}else if(e===0){return t===1?r:t.toString()+r}else if(t===0){return e.toString()}else{var n=t>0?"+":"";return e.toString()+n+(t===1?r:t.toString()+r)}};f.CONVERT=function(e,t,r){e=C.parseNumber(e);if(e instanceof Error){return e}var n=[["a.u. of action","?",null,"action",false,false,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",false,false,160217653141414e-33],["a.u. of energy","Eh",null,"energy",false,false,435974417757576e-32],["a.u. of length","a?",null,"length",false,false,529177210818182e-25],["a.u. of mass","m?",null,"mass",false,false,910938261616162e-45],["a.u. of time","?/Eh",null,"time",false,false,241888432650516e-31],["admiralty knot","admkn",null,"speed",false,true,.514773333],["ampere","A",null,"electric_current",true,false,1],["ampere per meter","A/m",null,"magnetic_field_intensity",true,false,1],["Ã¥ngstrÃ¶m","Ã",["ang"],"length",false,true,1e-10],["are","ar",null,"area",false,true,100],["astronomical unit","ua",null,"length",false,false,149597870691667e-25],["bar","bar",null,"pressure",false,false,1e5],["barn","b",null,"area",false,false,1e-28],["becquerel","Bq",null,"radioactivity",true,false,1],["bit","bit",["b"],"information",false,true,1],["btu","BTU",["btu"],"energy",false,true,1055.05585262],["byte","byte",null,"information",false,true,8],["candela","cd",null,"luminous_intensity",true,false,1],["candela per square metre","cd/m?",null,"luminance",true,false,1],["coulomb","C",null,"electric_charge",true,false,1],["cubic Ã¥ngstrÃ¶m","ang3",["ang^3"],"volume",false,true,1e-30],["cubic foot","ft3",["ft^3"],"volume",false,true,.028316846592],["cubic inch","in3",["in^3"],"volume",false,true,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",false,true,846786664623715e-61],["cubic metre","m?",null,"volume",true,true,1],["cubic mile","mi3",["mi^3"],"volume",false,true,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",false,true,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",false,true,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",false,true,.764554857984],["cup","cup",null,"volume",false,true,.0002365882365],["dalton","Da",["u"],"mass",false,false,166053886282828e-41],["day","d",["day"],"time",false,true,86400],["degree","Â°",null,"angle",false,false,.0174532925199433],["degrees Rankine","Rank",null,"temperature",false,true,.555555555555556],["dyne","dyn",["dy"],"force",false,true,1e-5],["electronvolt","eV",["ev"],"energy",false,true,1.60217656514141],["ell","ell",null,"length",false,true,1.143],["erg","erg",["e"],"energy",false,true,1e-7],["farad","F",null,"electric_capacitance",true,false,1],["fluid ounce","oz",null,"volume",false,true,295735295625e-16],["foot","ft",null,"length",false,true,.3048],["foot-pound","flb",null,"energy",false,true,1.3558179483314],["gal","Gal",null,"acceleration",false,false,.01],["gallon","gal",null,"volume",false,true,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",false,true,1],["grain","grain",null,"mass",false,true,647989e-10],["gram","g",null,"mass",false,true,.001],["gray","Gy",null,"absorbed_dose",true,false,1],["gross registered ton","GRT",["regton"],"volume",false,true,2.8316846592],["hectare","ha",null,"area",false,true,1e4],["henry","H",null,"inductance",true,false,1],["hertz","Hz",null,"frequency",true,false,1],["horsepower","HP",["h"],"power",false,true,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",false,true,2684519.538],["hour","h",["hr"],"time",false,true,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",false,true,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",false,true,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",false,true,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",false,true,1016.046909],["inch","in",null,"length",false,true,.0254],["international acre","uk_acre",null,"area",false,true,4046.8564224],["IT calorie","cal",null,"energy",false,true,4.1868],["joule","J",null,"energy",true,true,1],["katal","kat",null,"catalytic_activity",true,false,1],["kelvin","K",["kel"],"temperature",true,true,1],["kilogram","kg",null,"mass",true,true,1],["knot","kn",null,"speed",false,true,.514444444444444],["light-year","ly",null,"length",false,true,9460730472580800],["litre","L",["l","lt"],"volume",false,true,.001],["lumen","lm",null,"luminous_flux",true,false,1],["lux","lx",null,"illuminance",true,false,1],["maxwell","Mx",null,"magnetic_flux",false,false,1e-18],["measurement ton","MTON",null,"volume",false,true,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",false,true,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",true,true,1],["meter per second squared","m?s??",null,"acceleration",true,false,1],["parsec","pc",["parsec"],"length",false,true,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",true,false,1],["metre","m",null,"length",true,true,1],["miles per hour","mph",null,"speed",false,true,.44704],["millimetre of mercury","mmHg",null,"pressure",false,false,133.322],["minute","?",null,"angle",false,false,.000290888208665722],["minute","min",["mn"],"time",false,true,60],["modern teaspoon","tspm",null,"volume",false,true,5e-6],["mole","mol",null,"amount_of_substance",true,false,1],["morgen","Morgen",null,"area",false,true,2500],["n.u. of action","?",null,"action",false,false,105457168181818e-48],["n.u. of mass","m?",null,"mass",false,false,910938261616162e-45],["n.u. of speed","c?",null,"speed",false,false,299792458],["n.u. of time","?/(me?c??)",null,"time",false,false,128808866778687e-35],["nautical mile","M",["Nmi"],"length",false,true,1852],["newton","N",null,"force",true,true,1],["Årsted","Oe ",null,"magnetic_field_intensity",false,false,79.5774715459477],["ohm","Î©",null,"electric_resistance",true,false,1],["ounce mass","ozm",null,"mass",false,true,.028349523125],["pascal","Pa",null,"pressure",true,false,1],["pascal second","Pa?s",null,"dynamic_viscosity",true,false,1],["pferdestÃ¤rke","PS",null,"power",false,true,735.49875],["phot","ph",null,"illuminance",false,false,1e-4],["pica (1/6 inch)","pica",null,"length",false,true,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",false,true,.00423333333333333],["poise","P",null,"dynamic_viscosity",false,false,.1],["pond","pond",null,"force",false,true,.00980665],["pound force","lbf",null,"force",false,true,4.4482216152605],["pound mass","lbm",null,"mass",false,true,.45359237],["quart","qt",null,"volume",false,true,.000946352946],["radian","rad",null,"angle",true,false,1],["second","?",null,"angle",false,false,484813681109536e-20],["second","s",["sec"],"time",true,true,1],["short hundredweight","cwt",["shweight"],"mass",false,true,45.359237],["siemens","S",null,"electrical_conductance",true,false,1],["sievert","Sv",null,"equivalent_dose",true,false,1],["slug","sg",null,"mass",false,true,14.59390294],["square Ã¥ngstrÃ¶m","ang2",["ang^2"],"area",false,true,1e-20],["square foot","ft2",["ft^2"],"area",false,true,.09290304],["square inch","in2",["in^2"],"area",false,true,64516e-8],["square light-year","ly2",["ly^2"],"area",false,true,895054210748189e17],["square meter","m?",null,"area",true,true,1],["square mile","mi2",["mi^2"],"area",false,true,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",false,true,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",false,true,1792111111111e-17],["square yard","yd2",["yd^2"],"area",false,true,.83612736],["statute mile","mi",null,"length",false,true,1609.344],["steradian","sr",null,"solid_angle",true,false,1],["stilb","sb",null,"luminance",false,false,1e-4],["stokes","St",null,"kinematic_viscosity",false,false,1e-4],["stone","stone",null,"mass",false,true,6.35029318],["tablespoon","tbs",null,"volume",false,true,147868e-10],["teaspoon","tsp",null,"volume",false,true,492892e-11],["tesla","T",null,"magnetic_flux_density",true,true,1],["thermodynamic calorie","c",null,"energy",false,true,4.184],["ton","ton",null,"mass",false,true,907.18474],["tonne","t",null,"mass",false,false,1e3],["U.K. pint","uk_pt",null,"volume",false,true,.00056826125],["U.S. bushel","bushel",null,"volume",false,true,.03523907],["U.S. oil barrel","barrel",null,"volume",false,true,.158987295],["U.S. pint","pt",["us_pt"],"volume",false,true,.000473176473],["U.S. survey mile","survey_mi",null,"length",false,true,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",false,true,4046.87261],["volt","V",null,"voltage",true,false,1],["watt","W",null,"power",true,true,1],["watt-hour","Wh",["wh"],"energy",false,true,3600],["weber","Wb",null,"magnetic_flux",true,false,1],["yard","yd",null,"length",false,true,.9144],["year","yr",null,"time",false,true,31557600]];var i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]};var a={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};var o=null;var s=null;var l=t;var u=r;var f=1;var c=1;var d;for(var h=0;h<n.length;h++){d=n[h][2]===null?[]:n[h][2];if(n[h][1]===l||d.indexOf(l)>=0){o=n[h]}if(n[h][1]===u||d.indexOf(u)>=0){s=n[h]}}if(o===null){var v=i[t.substring(0,2)];var p=a[t.substring(0,1)];if(t.substring(0,2)==="da"){p=["dekao",10,"da"]}if(v){f=v[2];l=t.substring(2)}else if(p){f=p[1];l=t.substring(p[2].length)}for(var g=0;g<n.length;g++){d=n[g][2]===null?[]:n[g][2];if(n[g][1]===l||d.indexOf(l)>=0){o=n[g]}}}if(s===null){var m=i[r.substring(0,2)];var y=a[r.substring(0,1)];if(r.substring(0,2)==="da"){y=["dekao",10,"da"]}if(m){c=m[2];u=r.substring(2)}else if(y){c=y[1];u=r.substring(y[2].length)}for(var b=0;b<n.length;b++){d=n[b][2]===null?[]:n[b][2];if(n[b][1]===u||d.indexOf(u)>=0){s=n[b]}}}if(o===null||s===null){return w.na}if(o[3]!==s[3]){return w.na}return e*o[6]*f/(s[6]*c)};f.DEC2BIN=function(e,t){e=C.parseNumber(e);if(e instanceof Error){return e}if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511){return w.num}if(e<0){return"1"+a.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2)}var r=parseInt(e,10).toString(2);if(typeof t==="undefined"){return r}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=r.length?a.REPT("0",t-r.length)+r:w.num}};f.DEC2HEX=function(e,t){e=C.parseNumber(e);if(e instanceof Error){return e}if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887){return w.num}if(e<0){return(1099511627776+e).toString(16)}var r=parseInt(e,10).toString(16);if(typeof t==="undefined"){return r}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=r.length?a.REPT("0",t-r.length)+r:w.num}};f.DEC2OCT=function(e,t){e=C.parseNumber(e);if(e instanceof Error){return e}if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911){return w.num}if(e<0){return(1073741824+e).toString(8)}var r=parseInt(e,10).toString(8);if(typeof t==="undefined"){return r}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=r.length?a.REPT("0",t-r.length)+r:w.num}};f.DELTA=function(e,t){t=t===undefined?0:t;e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}return e===t?1:0};f.ERF=function(e,t){t=t===undefined?0:t;e=C.parseNumber(e);t=C.parseNumber(t);if(C.anyIsError(e,t)){return w.value}return r.erf(e)};f.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")};f.ERFC=function(e){if(isNaN(e)){return w.value}return r.erfc(e)};f.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")};f.GESTEP=function(e,t){t=t||0;e=C.parseNumber(e);if(C.anyIsError(t,e)){return e}return e>=t?1:0};f.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e)){return w.num}var r=e.length===10&&e.substring(0,1).toLowerCase()==="f"?true:false;var n=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<-512||n>511){return w.num}if(r){return"1"+a.REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2)}var i=n.toString(2);if(t===undefined){return i}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=i.length?a.REPT("0",t-i.length)+i:w.num}};f.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e)){return w.num}var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t};f.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e)){return w.num}var r=parseInt(e,16);if(r>536870911&&r<0xffe0000000){return w.num}if(r>=0xffe0000000){return(r-0xffc0000000).toString(8)}var n=r.toString(8);if(t===undefined){return n}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=n.length?a.REPT("0",t-n.length)+n:w.num}};f.IMABS=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}return Math.sqrt(Math.pow(t,2)+Math.pow(r,2))};f.IMAGINARY=function(e){if(e===undefined||e===true||e===false){return w.value}if(e===0||e==="0"){return 0}if(["i","j"].indexOf(e)>=0){return 1}e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=e.indexOf("+");var r=e.indexOf("-");if(t===0){t=e.indexOf("+",1)}if(r===0){r=e.indexOf("-",1)}var n=e.substring(e.length-1,e.length);var i=n==="i"||n==="j";if(t>=0||r>=0){if(!i){return w.num}if(t>=0){return isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?w.num:Number(e.substring(t+1,e.length-1))}else{return isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?w.num:-Number(e.substring(r+1,e.length-1))}}else{if(i){return isNaN(e.substring(0,e.length-1))?w.num:e.substring(0,e.length-1)}else{return isNaN(e)?w.num:0}}};f.IMARGUMENT=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}if(t===0&&r===0){return w.div0}if(t===0&&r>0){return Math.PI/2}if(t===0&&r<0){return-Math.PI/2}if(r===0&&t>0){return 0}if(r===0&&t<0){return-Math.PI}if(t>0){return Math.atan(r/t)}else if(t<0&&r>=0){return Math.atan(r/t)+Math.PI}else{return Math.atan(r/t)-Math.PI}};f.IMCONJUGATE=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return r!==0?f.COMPLEX(t,-r,n):e};f.IMCOS=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2,n)};f.IMCOSH=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,n)};f.IMCOT=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}return f.IMDIV(f.IMCOS(e),f.IMSIN(e))};f.IMDIV=function(e,t){var r=f.IMREAL(e);var n=f.IMAGINARY(e);var i=f.IMREAL(t);var a=f.IMAGINARY(t);if(C.anyIsError(r,n,i,a)){return w.value}var o=e.substring(e.length-1);var s=t.substring(t.length-1);var l="i";if(o==="j"){l="j"}else if(s==="j"){l="j"}if(i===0&&a===0){return w.num}var u=i*i+a*a;return f.COMPLEX((r*i+n*a)/u,(n*i-r*a)/u,l)};f.IMEXP=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";var i=Math.exp(t);return f.COMPLEX(i*Math.cos(r),i*Math.sin(r),n)};f.IMLN=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.log(Math.sqrt(t*t+r*r)),Math.atan(r/t),n)};f.IMLOG10=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.log(Math.sqrt(t*t+r*r))/Math.log(10),Math.atan(r/t)/Math.log(10),n)};f.IMLOG2=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.log(Math.sqrt(t*t+r*r))/Math.log(2),Math.atan(r/t)/Math.log(2),n)};f.IMPOWER=function(e,t){t=C.parseNumber(t);var r=f.IMREAL(e);var n=f.IMAGINARY(e);if(C.anyIsError(t,r,n)){return w.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";var a=Math.pow(f.IMABS(e),t);var o=f.IMARGUMENT(e);return f.COMPLEX(a*Math.cos(t*o),a*Math.sin(t*o),i)};f.IMPRODUCT=function(){var e=arguments[0];if(!arguments.length){return w.value}for(var t=1;t<arguments.length;t++){var r=f.IMREAL(e);var n=f.IMAGINARY(e);var i=f.IMREAL(arguments[t]);var a=f.IMAGINARY(arguments[t]);if(C.anyIsError(r,n,i,a)){return w.value}e=f.COMPLEX(r*i-n*a,r*a+n*i)}return e};f.IMREAL=function(e){if(e===undefined||e===true||e===false){return w.value}if(e===0||e==="0"){return 0}if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0){return 0}var t=e.indexOf("+");var r=e.indexOf("-");if(t===0){t=e.indexOf("+",1)}if(r===0){r=e.indexOf("-",1)}var n=e.substring(e.length-1,e.length);var i=n==="i"||n==="j";if(t>=0||r>=0){if(!i){return w.num}if(t>=0){return isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?w.num:Number(e.substring(0,t))}else{return isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?w.num:Number(e.substring(0,r))}}else{if(i){return isNaN(e.substring(0,e.length-1))?w.num:0}else{return isNaN(e)?w.num:e}}};f.IMSEC=function(e){if(e===true||e===false){return w.value}var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}return f.IMDIV("1",f.IMCOS(e))};f.IMSECH=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}return f.IMDIV("1",f.IMCOSH(e))};f.IMSIN=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2,n)};f.IMSINH=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";return f.COMPLEX(Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,n)};f.IMSQRT=function(e){var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}var n=e.substring(e.length-1);n=n==="i"||n==="j"?n:"i";var i=Math.sqrt(f.IMABS(e));var a=f.IMARGUMENT(e);return f.COMPLEX(i*Math.cos(a/2),i*Math.sin(a/2),n)};f.IMCSC=function(e){if(e===true||e===false){return w.value}var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.num}return f.IMDIV("1",f.IMSIN(e))};f.IMCSCH=function(e){if(e===true||e===false){return w.value}var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.num}return f.IMDIV("1",f.IMSINH(e))};f.IMSUB=function(e,t){var r=this.IMREAL(e);var n=this.IMAGINARY(e);var i=this.IMREAL(t);var a=this.IMAGINARY(t);if(C.anyIsError(r,n,i,a)){return w.value}var o=e.substring(e.length-1);var s=t.substring(t.length-1);var l="i";if(o==="j"){l="j"}else if(s==="j"){l="j"}return this.COMPLEX(r-i,n-a,l)};f.IMSUM=function(){if(!arguments.length){return w.value}var e=C.flatten(arguments);var t=e[0];for(var r=1;r<e.length;r++){var n=this.IMREAL(t);var i=this.IMAGINARY(t);var a=this.IMREAL(e[r]);var o=this.IMAGINARY(e[r]);if(C.anyIsError(n,i,a,o)){return w.value}t=this.COMPLEX(n+a,i+o)}return t};f.IMTAN=function(e){if(e===true||e===false){return w.value}var t=f.IMREAL(e);var r=f.IMAGINARY(e);if(C.anyIsError(t,r)){return w.value}return this.IMDIV(this.IMSIN(e),this.IMCOS(e))};f.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e)){return w.num}var r=e.length===10&&e.substring(0,1)==="7"?true:false;var n=r?parseInt(e,8)-1073741824:parseInt(e,8);if(n<-512||n>511){return w.num}if(r){return"1"+a.REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2)}var i=n.toString(2);if(typeof t==="undefined"){return i}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=i.length?a.REPT("0",t-i.length)+i:w.num}};f.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e)){return w.num}var t=parseInt(e,8);return t>=536870912?t-1073741824:t};f.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e)){return w.num}var r=parseInt(e,8);if(r>=536870912){return"ff"+(r+3221225472).toString(16)}var n=r.toString(16);if(t===undefined){return n}else{if(isNaN(t)){return w.value}if(t<0){return w.num}t=Math.floor(t);return t>=n.length?a.REPT("0",t-n.length)+n:w.num}}},function(e,t,r){"use strict";t.__esModule=true;var n=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKHDS","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"];t["default"]=n},function(e,t,r){"use strict";t.__esModule=true;t.rowLabelToIndex=o;t.rowIndexToLabel=i;t.columnLabelToIndex=l;t.columnIndexToLabel=u;t.extractLabel=n;t.toLabel=c;function o(e){var t=parseInt(e,10);if(isNaN(t)){t=-1}else{t=Math.max(t-1,-1)}return t}function i(e){var t="";if(e>=0){t=""+(e+1)}return t}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var s=a.length;function l(e){var t=0;if(typeof e==="string"){e=e.toUpperCase();for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1){t+=Math.pow(s,n)*(a.indexOf(e[r])+1)}}--t;return t}function u(e){var t="";while(e>=0){t=String.fromCharCode(e%s+97)+t;e=Math.floor(e/s)-1}return t.toUpperCase()}var f=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function n(e){if(typeof e!=="string"||!f.test(e)){return[]}var t=e.toUpperCase().match(f),r=t[1],n=t[2],i=t[3],a=t[4];return[{index:o(a),label:a,isAbsolute:i==="$"},{index:l(n),label:n,isAbsolute:r==="$"}]}function c(e,t){var r=(e.isAbsolute?"$":"")+i(e.index);var n=(t.isAbsolute?"$":"")+u(t.index);return n+r}},function(e,t,r){"use strict";t.__esModule=true;t.rowLabelToIndex=t.rowIndexToLabel=t.columnLabelToIndex=t.columnIndexToLabel=t.toLabel=t.extractLabel=t.error=t.Parser=t.ERROR_VALUE=t.ERROR_REF=t.ERROR_NUM=t.ERROR_NULL=t.ERROR_NOT_AVAILABLE=t.ERROR_NAME=t.ERROR_DIV_ZERO=t.ERROR=t.SUPPORTED_FORMULAS=undefined;var n=r(16);var i=f(n);var a=r(13);var o=f(a);var s=r(2);var l=f(s);var u=r(14);function f(e){return e&&e.__esModule?e:{default:e}}t.SUPPORTED_FORMULAS=o["default"];t.ERROR=s.ERROR;t.ERROR_DIV_ZERO=s.ERROR_DIV_ZERO;t.ERROR_NAME=s.ERROR_NAME;t.ERROR_NOT_AVAILABLE=s.ERROR_NOT_AVAILABLE;t.ERROR_NULL=s.ERROR_NULL;t.ERROR_NUM=s.ERROR_NUM;t.ERROR_REF=s.ERROR_REF;t.ERROR_VALUE=s.ERROR_VALUE;t.Parser=i["default"];t.error=l["default"];t.extractLabel=u.extractLabel;t.toLabel=u.toLabel;t.columnIndexToLabel=u.columnIndexToLabel;t.columnLabelToIndex=u.columnLabelToIndex;t.rowIndexToLabel=u.rowIndexToLabel;t.rowLabelToIndex=u.rowLabelToIndex},function(e,t,r){"use strict";t.__esModule=true;var n=r(17);var i=h(n);var a=r(18);var o=h(a);var s=r(39);var l=r(40);var u=r(3);var f=r(2);var c=h(f);var d=r(14);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function g(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=function(e){g(t,e);function t(){v(this,t);var n=p(this,e.call(this));n.parser=new s.Parser;n.parser.yy={toNumber:u.toNumber,trimEdges:l.trimEdges,invertNumber:u.invertNumber,throwError:function e(t){return n._throwError(t)},callVariable:function e(t){return n._callVariable(t)},evaluateByOperator:o["default"],callFunction:function e(t,r){return n._callFunction(t,r)},cellValue:function e(t){return n._callCellValue(t)},rangeValue:function e(t,r){return n._callRangeValue(t,r)}};n.variables=Object.create(null);n.functions=Object.create(null);n.setVariable("TRUE",true).setVariable("FALSE",false).setVariable("NULL",null);return n}t.prototype.parse=function e(t){var r=null;var n=null;try{if(t===""){r=""}else{r=this.parser.parse(t)}}catch(e){var i=(0,c["default"])(e.message);if(i){n=i}else{n=(0,c["default"])(f.ERROR)}}if(r instanceof Error){n=(0,c["default"])(r.message)||(0,c["default"])(f.ERROR);r=null}return{error:n,result:r}};t.prototype.setVariable=function e(t,r){this.variables[t]=r;return this};t.prototype.getVariable=function e(t){return this.variables[t]};t.prototype._callVariable=function e(t){var r=this.getVariable(t);this.emit("callVariable",t,function(e){if(e!==void 0){r=e}});if(r===void 0){throw Error(f.ERROR_NAME)}return r};t.prototype.setFunction=function e(t,r){this.functions[t]=r;return this};t.prototype.getFunction=function e(t){return this.functions[t]};t.prototype._callFunction=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var n=this.getFunction(t);var i=void 0;if(n){i=n(r)}this.emit("callFunction",t,r,function(e){if(e!==void 0){i=e}});return i===void 0?(0,o["default"])(t,r):i};t.prototype._callCellValue=function e(t){t=t.toUpperCase();var r=(0,d.extractLabel)(t),n=r[0],i=r[1];var a=void 0;this.emit("callCellValue",{label:t,row:n,column:i},function(e){a=e});return a};t.prototype._callRangeValue=function e(t,r){t=t.toUpperCase();r=r.toUpperCase();var n=(0,d.extractLabel)(t),i=n[0],a=n[1];var o=(0,d.extractLabel)(r),s=o[0],l=o[1];var u={};var f={};if(i.index<=s.index){u.row=i;f.row=s}else{u.row=s;f.row=i}if(a.index<=l.index){u.column=a;f.column=l}else{u.column=l;f.column=a}u.label=(0,d.toLabel)(u.row,u.column);f.label=(0,d.toLabel)(f.row,f.column);var c=[];this.emit("callRangeValue",u,f,function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];c=e});return c};t.prototype._throwError=function e(t){if((0,f.isValidStrict)(t)){throw Error(t)}throw Error(f.ERROR)};return t}(i["default"]);t["default"]=m},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});(n[e]||(n[e]=[])).push({fn:t,ctx:r});return this},once:function(e,t,r){var n=this;function i(){n.off(e,i);t.apply(r,arguments)}i._=t;return this.on(e,i,r)},emit:function(e){var t=[].slice.call(arguments,1);var r=((this.e||(this.e={}))[e]||[]).slice();var n=0;var i=r.length;for(n;n<i;n++){r[n].fn.apply(r[n].ctx,t)}return this},off:function(e,t){var r=this.e||(this.e={});var n=r[e];var i=[];if(n&&t){for(var a=0,o=n.length;a<o;a++){if(n[a].fn!==t&&n[a].fn._!==t)i.push(n[a])}}i.length?r[e]=i:delete r[e];return this}};e.exports=r;e.exports.TinyEmitter=r},function(e,t,r){"use strict";t.__esModule=true;t["default"]=A;t.registerOperation=N;var n=r(19);var i=I(n);var a=r(20);var o=I(a);var s=r(21);var l=I(s);var u=r(22);var f=I(u);var c=r(23);var d=I(c);var h=r(31);var v=I(h);var p=r(32);var g=I(p);var m=r(33);var y=I(m);var b=r(34);var w=I(b);var C=r(35);var S=I(C);var E=r(36);var k=I(E);var T=r(37);var _=I(T);var x=r(38);var D=I(x);var R=r(2);function I(e){return e&&e.__esModule?e:{default:e}}var O=Object.create(null);function A(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];e=e.toUpperCase();if(!O[e]){throw Error(R.ERROR_NAME)}return O[e].apply(O,t)}function N(e,t){if(!Array.isArray(e)){e=[e.toUpperCase()]}e.forEach(function(e){if(t.isFactory){O[e]=t(e)}else{O[e]=t}})}N(i["default"].SYMBOL,i["default"]);N(o["default"].SYMBOL,o["default"]);N(l["default"].SYMBOL,l["default"]);N(f["default"].SYMBOL,f["default"]);N(D["default"].SYMBOL,D["default"]);N(d["default"].SYMBOL,d["default"]);N(v["default"].SYMBOL,v["default"]);N(g["default"].SYMBOL,g["default"]);N(y["default"].SYMBOL,y["default"]);N(w["default"].SYMBOL,w["default"]);N(k["default"].SYMBOL,k["default"]);N(_["default"].SYMBOL,_["default"]);N(S["default"].SYMBOL,S["default"])},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=i;var a=r(3);var o=r(2);var n=t.SYMBOL="+";function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}var i=r.reduce(function(e,t){return e+(0,a.toNumber)(t)},(0,a.toNumber)(e));if(isNaN(i)){throw Error(o.ERROR_VALUE)}return i}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL="&";function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}return t.reduce(function(e,t){return e+t.toString()},"")}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=i;var a=r(3);var o=r(2);var n=t.SYMBOL="/";function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}var i=r.reduce(function(e,t){return e/(0,a.toNumber)(t)},(0,a.toNumber)(e));if(i===Infinity){throw Error(o.ERROR_DIV_ZERO)}if(isNaN(i)){throw Error(o.ERROR_VALUE)}return i}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL="=";function i(e,t){return e===t}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=c;var n=r(24);var l=s(n);var i=r(13);var a=o(i);var u=r(2);function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t["default"]=e;return t}}var f=t.SYMBOL=a["default"];function c(s){return function e(){s=s.toUpperCase();var t=s.split(".");var r=false;var n=void 0;if(t.length===1){if(l[t[0]]){r=true;n=l[t[0]].apply(l,arguments)}}else{var i=t.length;var a=0;var o=l;while(a<i){o=o[t[a]];a++;if(!o){o=null;break}}if(o){r=true;n=o.apply(undefined,arguments)}}if(!r){throw Error(u.ERROR_NAME)}return n}}c.isFactory=true;c.SYMBOL=f},function(e,t,r){var n=[r(25),r(27),r(12),r(28),r(4),r(6),r(9),r(29),r(8),r(30),r(5),r(11)];for(var i in n){var a=n[i];for(var o in a){t[o]=t[o]||a[o]}}},function(e,t,r){var n=r(4);var i=r(5);var a=r(12);var o=r(9);function s(e,t){if(t){for(var r in t){e[r]=t[r]}}return e}t.BETADIST=i.BETA.DIST;t.BETAINV=i.BETA.INV;t.BINOMDIST=i.BINOM.DIST;t.CEILING=t.ISOCEILING=s(n.CEILING.MATH,n.CEILING);t.CEILINGMATH=n.CEILING.MATH;t.CEILINGPRECISE=n.CEILING.PRECISE;t.CHIDIST=i.CHISQ.DIST;t.CHIDISTRT=i.CHISQ.DIST.RT;t.CHIINV=i.CHISQ.INV;t.CHIINVRT=i.CHISQ.INV.RT;t.CHITEST=i.CHISQ.TEST;t.CONFIDENCE=s(i.CONFIDENCE.NORM,i.CONFIDENCE);t.COVAR=i.COVARIANCE.P;t.COVARIANCEP=i.COVARIANCE.P;t.COVARIANCES=i.COVARIANCE.S;t.CRITBINOM=i.BINOM.INV;t.EXPONDIST=i.EXPON.DIST;t.ERFCPRECISE=a.ERFC.PRECISE;t.ERFPRECISE=a.ERF.PRECISE;t.FDIST=i.F.DIST;t.FDISTRT=i.F.DIST.RT;t.FINVRT=i.F.INV.RT;t.FINV=i.F.INV;t.FLOOR=s(n.FLOOR.MATH,n.FLOOR);t.FLOORMATH=n.FLOOR.MATH;t.FLOORPRECISE=n.FLOOR.PRECISE;t.FTEST=i.F.TEST;t.GAMMADIST=i.GAMMA.DIST;t.GAMMAINV=i.GAMMA.INV;t.GAMMALNPRECISE=i.GAMMALN.PRECISE;t.HYPGEOMDIST=i.HYPGEOM.DIST;t.LOGINV=i.LOGNORM.INV;t.LOGNORMINV=i.LOGNORM.INV;t.LOGNORMDIST=i.LOGNORM.DIST;t.MODE=s(i.MODE.SNGL,i.MODE);t.MODEMULT=i.MODE.MULT;t.MODESNGL=i.MODE.SNGL;t.NEGBINOMDIST=i.NEGBINOM.DIST;t.NETWORKDAYSINTL=o.NETWORKDAYS.INTL;t.NORMDIST=i.NORM.DIST;t.NORMINV=i.NORM.INV;t.NORMSDIST=i.NORM.S.DIST;t.NORMSINV=i.NORM.S.INV;t.PERCENTILE=s(i.PERCENTILE.EXC,i.PERCENTILE);t.PERCENTILEEXC=i.PERCENTILE.EXC;t.PERCENTILEINC=i.PERCENTILE.INC;t.PERCENTRANK=s(i.PERCENTRANK.INC,i.PERCENTRANK);t.PERCENTRANKEXC=i.PERCENTRANK.EXC;t.PERCENTRANKINC=i.PERCENTRANK.INC;t.POISSON=s(i.POISSON.DIST,i.POISSON);t.POISSONDIST=i.POISSON.DIST;t.QUARTILE=s(i.QUARTILE.INC,i.QUARTILE);t.QUARTILEEXC=i.QUARTILE.EXC;t.QUARTILEINC=i.QUARTILE.INC;t.RANK=s(i.RANK.EQ,i.RANK);t.RANKAVG=i.RANK.AVG;t.RANKEQ=i.RANK.EQ;t.SKHDS=i.SKEW.P;t.STDEV=s(i.STDEV.S,i.STDEV);t.STDEVP=i.STDEV.P;t.STDEVS=i.STDEV.S;t.TDIST=i.T.DIST;t.TDISTRT=i.T.DIST.RT;t.TINV=i.T.INV;t.TTEST=i.T.TEST;t.VAR=s(i.VAR.S,i.VAR);t.VARP=i.VAR.P;t.VARS=i.VAR.S;t.WEIBULL=s(i.WEIBULL.DIST,i.WEIBULL);t.WEIBULLDIST=i.WEIBULL.DIST;t.WORKDAYINTL=o.WORKDAY.INTL;t.ZTEST=i.Z.TEST},function(e,t,r){var n;(function(e){if(typeof DO_NOT_EXPORT_BESSEL==="undefined"){if(true){e(t)}else{}}else{e(n={})}})(function(e){e.version="1.0.2";var m=Math;function y(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function b(e,t,r,n,i){if(t===0)return r;if(t===1)return n;var a=2/e,o=n;for(var s=1;s<t;++s){o=n*s*a+i*r;r=n;n=o}return o}function p(a,o,e,s,l){return function e(t,r){if(s){if(t===0)return s==1?-Infinity:Infinity;else if(t<0)return NaN}if(r===0)return a(t);if(r===1)return o(t);if(r<0)return NaN;r|=0;var n=a(t),i=o(t);return b(t,r,n,i,l)}}var g=function(){var o=.636619772;var s=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse();var l=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse();var u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse();var f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function d(e){var t=0,r=0,n=0,i=e*e;if(e<8){r=y(s,i);n=y(l,i);t=r/n}else{var a=e-.785398164;i=64/i;r=y(u,i);n=y(f,i);t=m.sqrt(o/e)*(m.cos(a)*r-m.sin(a)*n*8/e)}return t}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse();var h=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse();var v=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse();var p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function g(e){var t=0,r=0,n=0,i=e*e,a=m.abs(e)-2.356194491;if(Math.abs(e)<8){r=e*y(c,i);n=y(h,i);t=r/n}else{i=64/i;r=y(v,i);n=y(p,i);t=m.sqrt(o/m.abs(e))*(m.cos(a)*r-m.sin(a)*n*8/m.abs(e));if(e<0)t=-t}return t}return function e(t,r){r=Math.round(r);if(!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(r===0)return d(t);if(r===1)return g(t);if(t===0)return 0;var n=0;if(t>r){n=b(t,r,d(t),g(t),-1)}else{var i=2*m.floor((r+m.floor(m.sqrt(40*r)))/2);var a=false;var o=0,s=0;var l=1,u=0;var f=2/t;for(var c=i;c>0;c--){u=c*f*l-o;o=l;l=u;if(m.abs(l)>1e10){l*=1e-10;o*=1e-10;n*=1e-10;s*=1e-10}if(a)s+=l;a=!a;if(c==r)n=o}s=2*s-l;n/=s}return n}}();var t=function(){var o=.636619772;var s=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse();var l=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse();var u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse();var f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse();function e(e){var t=0,r=0,n=0,i=e*e,a=e-.785398164;if(e<8){r=y(s,i);n=y(l,i);t=r/n+o*g(e,0)*m.log(e)}else{i=64/i;r=y(u,i);n=y(f,i);t=m.sqrt(o/e)*(m.sin(a)*r+m.cos(a)*n*8/e)}return t}var c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse();var d=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse();var h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse();var v=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function t(e){var t=0,r=0,n=0,i=e*e,a=e-2.356194491;if(e<8){r=e*y(c,i);n=y(d,i);t=r/n+o*(g(e,1)*m.log(e)-1/e)}else{i=64/i;r=y(h,i);n=y(v,i);t=m.sqrt(o/e)*(m.sin(a)*r+m.cos(a)*n*8/e)}return t}return p(e,t,"BESSELY",1,-1)}();var o=function(){var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse();var r=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function f(e){if(e<=3.75)return y(t,e*e/(3.75*3.75));return m.exp(m.abs(e))/m.sqrt(m.abs(e))*y(r,3.75/m.abs(e))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse();var i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function c(e){if(e<3.75)return e*y(n,e*e/(3.75*3.75));return(e<0?-1:1)*m.exp(m.abs(e))/m.sqrt(m.abs(e))*y(i,3.75/m.abs(e))}return function e(t,r){r=Math.round(r);if(r===0)return f(t);if(r===1)return c(t);if(r<0)return NaN;if(m.abs(t)===0)return 0;if(t==Infinity)return Infinity;var n=0,i,a=2/m.abs(t),o=0,s=1,l=0;var u=2*m.round((r+m.round(m.sqrt(40*r)))/2);for(i=u;i>0;i--){l=i*a*s+o;o=s;s=l;if(m.abs(s)>1e10){s*=1e-10;o*=1e-10;n*=1e-10}if(i==r)n=o}n*=e(t,0)/s;return t<0&&r%2?-n:n}}();var r=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse();var r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function e(e){if(e<=2)return-m.log(e/2)*o(e,0)+y(t,e*e/4);return m.exp(-e)/m.sqrt(e)*y(r,2/e)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse();var i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function a(e){if(e<=2)return m.log(e/2)*o(e,1)+1/e*y(n,e*e/4);return m.exp(-e)/m.sqrt(e)*y(i,2/e)}return p(e,a,"BESSELK",2,1)}();e.besselj=g;e.bessely=t;e.besseli=o;e.besselk=r})},function(e,l,t){var u=t(0);var s=t(5);var f=t(4);var c=t(1);var y=t(7);function d(e){var t=[];c.arrayEach(e,function(e){if(e){t.push(e)}});return t}l.FINDFIELD=function(e,r){var n=null;c.arrayEach(e,function(e,t){if(e[0]===r){n=t;return false}});if(n==null){return u.value}return n};function h(e,t){var r={};for(var n=1;n<e[0].length;++n){r[n]=true}var i=t[0].length;for(n=1;n<t.length;++n){if(t[n].length>i){i=t[n].length}}for(var a=1;a<e.length;++a){for(var o=1;o<e[a].length;++o){var s=false;var l=false;for(var u=0;u<t.length;++u){var f=t[u];if(f.length<i){continue}var c=f[0];if(e[a][0]!==c){continue}l=true;for(var d=1;d<f.length;++d){if(!s){var h=f[d]===void 0||f[d]==="*";if(h){s=true}else{var v=y.parse(f[d]+"");var p=[y.createToken(e[a][o],y.TOKEN_TYPE_LITERAL)].concat(v);s=y.compute(p)}}}}if(l){r[o]=r[o]&&s}}}var g=[];for(var m=0;m<e[0].length;++m){if(r[m]){g.push(m-1)}}return g}l.DAVERAGE=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=0;c.arrayEach(n,function(e){o+=i[e]});return n.length===0?u.div0:o/n.length};l.DCOUNT=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});return s.COUNT(o)};l.DCOUNTA=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});return s.COUNTA(o)};l.DGET=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}if(n.length===0){return u.value}if(n.length>1){return u.num}return i[n[0]]};l.DMAX=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=i[n[0]];c.arrayEach(n,function(e){if(o<i[e]){o=i[e]}});return o};l.DMIN=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=i[n[0]];c.arrayEach(n,function(e){if(o>i[e]){o=i[e]}});return o};l.DPRODUCT=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});o=d(o);var s=1;c.arrayEach(o,function(e){s*=e});return s};l.DSTDEV=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});o=d(o);return s.STDEV.S(o)};l.DSTDEVP=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});o=d(o);return s.STDEV.P(o)};l.DSUM=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});return f.SUM(o)};l.DVAR=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});return s.VAR.S(o)};l.DVARP=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return u.value}var n=h(e,r);var i=[];if(typeof t==="string"){var a=l.FINDFIELD(e,t);i=c.rest(e[a])}else{i=c.rest(e[t])}var o=[];c.arrayEach(n,function(e){o.push(i[e])});return s.VAR.P(o)}},function(e,t,r){var l=r(0);var n=r(1);var i=r(8);t.AND=function(){var e=n.flatten(arguments);var t=true;for(var r=0;r<e.length;r++){if(!e[r]){t=false}}return t};t.CHOOSE=function(){if(arguments.length<2){return l.na}var e=arguments[0];if(e<1||e>254){return l.value}if(arguments.length<e+1){return l.value}return arguments[e]};t.FALSE=function(){return false};t.IF=function(e,t,r){return e?t:r};t.IFERROR=function(e,t){if(i.ISERROR(e)){return t}return e};t.IFNA=function(e,t){return e===l.na?t:e};t.NOT=function(e){return!e};t.OR=function(){var e=n.flatten(arguments);var t=false;for(var r=0;r<e.length;r++){if(e[r]){t=true}}return t};t.TRUE=function(){return true};t.XOR=function(){var e=n.flatten(arguments);var t=0;for(var r=0;r<e.length;r++){if(e[r]){t++}}return Math.floor(Math.abs(t))&1?true:false};t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0];var r=arguments.length-1;var n=Math.floor(r/2);var i=false;var a=r%2!==0;var o=r%2===0?null:arguments[arguments.length-1];if(n){for(var s=0;s<n;s++){if(t===arguments[s*2+1]){e=arguments[s*2+2];i=true;break}}}if(!i){e=a?o:l.na}}else{e=l.value}return e}},function(e,u,t){var g=t(0);var s=t(9);var m=t(1);function l(e){return e&&e.getTime&&!isNaN(e.getTime())}function f(e){return e instanceof Date?e:new Date(e)}u.ACCRINT=function(e,t,r,n,i,a,o){e=f(e);t=f(t);r=f(r);if(!l(e)||!l(t)||!l(r)){return g.value}if(n<=0||i<=0){return g.num}if([1,2,4].indexOf(a)===-1){return g.num}if([0,1,2,3,4].indexOf(o)===-1){return g.num}if(r<=e){return g.num}i=i||0;o=o||0;return i*n*s.YEARFRAC(e,r,o)};u.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")};u.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")};u.AMORLINC=function(){throw new Error("AMORLINC is not implemented")};u.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")};u.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")};u.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")};u.COUPNCD=function(){throw new Error("COUPNCD is not implemented")};u.COUPNUM=function(){throw new Error("COUPNUM is not implemented")};u.COUPPCD=function(){throw new Error("COUPPCD is not implemented")};u.CUMIPMT=function(e,t,r,n,i,a){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(e<=0||t<=0||r<=0){return g.num}if(n<1||i<1||n>i){return g.num}if(a!==0&&a!==1){return g.num}var o=u.PMT(e,t,r,0,a);var s=0;if(n===1){if(a===0){s=-r;n++}}for(var l=n;l<=i;l++){if(a===1){s+=u.FV(e,l-2,o,r,1)-o}else{s+=u.FV(e,l-1,o,r,0)}}s*=e;return s};u.CUMPRINC=function(e,t,r,n,i,a){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(e<=0||t<=0||r<=0){return g.num}if(n<1||i<1||n>i){return g.num}if(a!==0&&a!==1){return g.num}var o=u.PMT(e,t,r,0,a);var s=0;if(n===1){if(a===0){s=o+r*e}else{s=o}n++}for(var l=n;l<=i;l++){if(a>0){s+=o-(u.FV(e,l-2,o,r,1)-o)*e}else{s+=o-u.FV(e,l-1,o,r,0)*e}}return s};u.DB=function(e,t,r,n,i){i=i===undefined?12:i;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);if(m.anyIsError(e,t,r,n,i)){return g.value}if(e<0||t<0||r<0||n<0){return g.num}if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i)===-1){return g.num}if(n>r){return g.num}if(t>=e){return 0}var a=(1-Math.pow(t/e,1/r)).toFixed(3);var o=e*a*i/12;var s=o;var l=0;var u=n===r?r-1:n;for(var f=2;f<=u;f++){l=(e-s)*a;s+=l}if(n===1){return o}else if(n===r){return(e-s)*a}else{return l}};u.DDB=function(e,t,r,n,i){i=i===undefined?2:i;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);if(m.anyIsError(e,t,r,n,i)){return g.value}if(e<0||t<0||r<0||n<0||i<=0){return g.num}if(n>r){return g.num}if(t>=e){return 0}var a=0;var o=0;for(var s=1;s<=n;s++){o=Math.min((e-a)*(i/r),e-t-a);a+=o}return o};u.DISC=function(){throw new Error("DISC is not implemented")};u.DOLLARDE=function(e,t){e=m.parseNumber(e);t=m.parseNumber(t);if(m.anyIsError(e,t)){return g.value}if(t<0){return g.num}if(t>=0&&t<1){return g.div0}t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);r=Math.round(r*n)/n;return r};u.DOLLARFR=function(e,t){e=m.parseNumber(e);t=m.parseNumber(t);if(m.anyIsError(e,t)){return g.value}if(t<0){return g.num}if(t>=0&&t<1){return g.div0}t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t;return r};u.DURATION=function(){throw new Error("DURATION is not implemented")};u.EFFECT=function(e,t){e=m.parseNumber(e);t=m.parseNumber(t);if(m.anyIsError(e,t)){return g.value}if(e<=0||t<1){return g.num}t=parseInt(t,10);return Math.pow(1+e/t,t)-1};u.FV=function(e,t,r,n,i){n=n||0;i=i||0;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);if(m.anyIsError(e,t,r,n,i)){return g.value}var a;if(e===0){a=n+r*t}else{var o=Math.pow(1+e,t);if(i===1){a=n*o+r*(1+e)*(o-1)/e}else{a=n*o+r*(o-1)/e}}return-a};u.FVSCHEDULE=function(e,t){e=m.parseNumber(e);t=m.parseNumberArray(m.flatten(t));if(m.anyIsError(e,t)){return g.value}var r=t.length;var n=e;for(var i=0;i<r;i++){n*=1+t[i]}return n};u.INTRATE=function(){throw new Error("INTRATE is not implemented")};u.IPMT=function(e,t,r,n,i,a){i=i||0;a=a||0;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);a=m.parseNumber(a);if(m.anyIsError(e,t,r,n,i,a)){return g.value}var o=u.PMT(e,r,n,i,a);var s;if(t===1){if(a===1){s=0}else{s=-n}}else{if(a===1){s=u.FV(e,t-2,o,n,1)-o}else{s=u.FV(e,t-1,o,n,0)}}return s*e};u.IRR=function(e,t){t=t||0;e=m.parseNumberArray(m.flatten(e));t=m.parseNumber(t);if(m.anyIsError(e,t)){return g.value}var r=function(e,t,r){var n=r+1;var i=e[0];for(var a=1;a<e.length;a++){i+=e[a]/Math.pow(n,(t[a]-t[0])/365)}return i};var n=function(e,t,r){var n=r+1;var i=0;for(var a=1;a<e.length;a++){var o=(t[a]-t[0])/365;i-=o*e[a]/Math.pow(n,o+1)}return i};var i=[];var a=false;var o=false;for(var s=0;s<e.length;s++){i[s]=s===0?0:i[s-1]+365;if(e[s]>0){a=true}if(e[s]<0){o=true}}if(!a||!o){return g.num}t=t===undefined?.1:t;var l=t;var u=1e-10;var f,c,d;var h=true;do{d=r(e,i,l);f=l-d/n(e,i,l);c=Math.abs(f-l);l=f;h=c>u&&Math.abs(d)>u}while(h);return l};u.ISPMT=function(e,t,r,n){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);if(m.anyIsError(e,t,r,n)){return g.value}return n*e*(t/r-1)};u.MDURATION=function(){throw new Error("MDURATION is not implemented")};u.MIRR=function(e,t,r){e=m.parseNumberArray(m.flatten(e));t=m.parseNumber(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}var n=e.length;var i=[];var a=[];for(var o=0;o<n;o++){if(e[o]<0){i.push(e[o])}else{a.push(e[o])}}var s=-u.NPV(r,a)*Math.pow(1+r,n-1);var l=u.NPV(t,i)*(1+t);return Math.pow(s/l,1/(n-1))-1};u.NOMINAL=function(e,t){e=m.parseNumber(e);t=m.parseNumber(t);if(m.anyIsError(e,t)){return g.value}if(e<=0||t<1){return g.num}t=parseInt(t,10);return(Math.pow(e+1,1/t)-1)*t};u.NPER=function(e,t,r,n,i){i=i===undefined?0:i;n=n===undefined?0:n;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);if(m.anyIsError(e,t,r,n,i)){return g.value}var a=t*(1+e*i)-n*e;var o=r*e+t*(1+e*i);return Math.log(a/o)/Math.log(1+e)};u.NPV=function(){var e=m.parseNumberArray(m.flatten(arguments));if(e instanceof Error){return e}var t=e[0];var r=0;for(var n=1;n<e.length;n++){r+=e[n]/Math.pow(1+t,n)}return r};u.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")};u.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")};u.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")};u.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")};u.PDURATION=function(e,t,r){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(e<=0){return g.num}return(Math.log(r)-Math.log(t))/Math.log(1+e)};u.PMT=function(e,t,r,n,i){n=n||0;i=i||0;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);if(m.anyIsError(e,t,r,n,i)){return g.value}var a;if(e===0){a=(r+n)/t}else{var o=Math.pow(1+e,t);if(i===1){a=(n*e/(o-1)+r*e/(1-1/o))/(1+e)}else{a=n*e/(o-1)+r*e/(1-1/o)}}return-a};u.PPMT=function(e,t,r,n,i,a){i=i||0;a=a||0;e=m.parseNumber(e);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);a=m.parseNumber(a);if(m.anyIsError(e,r,n,i,a)){return g.value}return u.PMT(e,r,n,i,a)-u.IPMT(e,t,r,n,i,a)};u.PRICE=function(){throw new Error("PRICE is not implemented")};u.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")};u.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")};u.PV=function(e,t,r,n,i){n=n||0;i=i||0;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);if(m.anyIsError(e,t,r,n,i)){return g.value}if(e===0){return-r*t-n}else{return((1-Math.pow(1+e,t))/e*r*(1+e*i)-n)/Math.pow(1+e,t)}};u.RATE=function(e,t,r,n,i,a){a=a===undefined?.01:a;n=n===undefined?0:n;i=i===undefined?0:i;e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);i=m.parseNumber(i);a=m.parseNumber(a);if(m.anyIsError(e,t,r,n,i,a)){return g.value}var o=1e-10;var s=50;var l,u,f,c,d=0,h=0,v=0;var p=a;if(Math.abs(p)<o){l=r*(1+e*p)+t*(1+p*i)*e+n}else{h=Math.exp(e*Math.log(1+p));l=r*h+t*(1/p+i)*(h-1)+n}u=r+t*e+n;f=r*h+t*(1/p+i)*(h-1)+n;v=c=0;d=p;while(Math.abs(u-f)>o&&v<s){p=(f*c-u*d)/(f-u);c=d;d=p;if(Math.abs(p)<o){l=r*(1+e*p)+t*(1+p*i)*e+n}else{h=Math.exp(e*Math.log(1+p));l=r*h+t*(1/p+i)*(h-1)+n}u=f;f=l;++v}return p};u.RECEIVED=function(){throw new Error("RECEIVED is not implemented")};u.RRI=function(e,t,r){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(e===0||t===0){return g.num}return Math.pow(r/t,1/e)-1};u.SLN=function(e,t,r){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(r===0){return g.num}return(e-t)/r};u.SYD=function(e,t,r,n){e=m.parseNumber(e);t=m.parseNumber(t);r=m.parseNumber(r);n=m.parseNumber(n);if(m.anyIsError(e,t,r,n)){return g.value}if(r===0){return g.num}if(n<1||n>r){return g.num}n=parseInt(n,10);return(e-t)*(r-n+1)*2/(r*(r+1))};u.TBILLEQ=function(e,t,r){e=m.parseDate(e);t=m.parseDate(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(r<=0){return g.num}if(e>t){return g.num}if(t-e>365*24*60*60*1e3){return g.num}return 365*r/(360-r*s.DAYS360(e,t,false))};u.TBILLPRICE=function(e,t,r){e=m.parseDate(e);t=m.parseDate(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(r<=0){return g.num}if(e>t){return g.num}if(t-e>365*24*60*60*1e3){return g.num}return 100*(1-r*s.DAYS360(e,t,false)/360)};u.TBILLYIELD=function(e,t,r){e=m.parseDate(e);t=m.parseDate(t);r=m.parseNumber(r);if(m.anyIsError(e,t,r)){return g.value}if(r<=0){return g.num}if(e>t){return g.num}if(t-e>365*24*60*60*1e3){return g.num}return(100-r)*360/(r*s.DAYS360(e,t,false))};u.VDB=function(){throw new Error("VDB is not implemented")};u.XNPV=function(e,t,r){e=m.parseNumber(e);t=m.parseNumberArray(m.flatten(t));r=m.parseDateArray(m.flatten(r));if(m.anyIsError(e,t,r)){return g.value}var n=0;for(var i=0;i<t.length;i++){n+=t[i]/Math.pow(1+e,s.DAYS(r[i],r[0])/365)}return n};u.YIELD=function(){throw new Error("YIELD is not implemented")};u.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")};u.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(e,t,r){var s=r(0);var l=r(1);t.MATCH=function(e,t,r){if(!e&&!t){return s.na}if(arguments.length===2){r=1}if(!(t instanceof Array)){return s.na}if(r!==-1&&r!==0&&r!==1){return s.na}var n;var i;for(var a=0;a<t.length;a++){if(r===1){if(t[a]===e){return a+1}else if(t[a]<e){if(!i){n=a+1;i=t[a]}else if(t[a]>i){n=a+1;i=t[a]}}}else if(r===0){if(typeof e==="string"){e=e.replace(/\?/g,".");if(t[a].toLowerCase().match(e.toLowerCase())){return a+1}}else{if(t[a]===e){return a+1}}}else if(r===-1){if(t[a]===e){return a+1}else if(t[a]>e){if(!i){n=a+1;i=t[a]}else if(t[a]<i){n=a+1;i=t[a]}}}}return n?n:s.na};t.VLOOKUP=function(e,t,r,n){if(!e||!t||!r){return s.na}n=n||false;for(var i=0;i<t.length;i++){var a=t[i];if(!n&&a[0]===e||(a[0]===e||n&&typeof a[0]==="string"&&a[0].toLowerCase().indexOf(e.toLowerCase())!==-1)){return r<a.length+1?a[r-1]:s.ref}}return s.na};t.HLOOKUP=function(e,t,r,n){if(!e||!t||!r){return s.na}n=n||false;var i=l.transpose(t);for(var a=0;a<i.length;a++){var o=i[a];if(!n&&o[0]===e||(o[0]===e||n&&typeof o[0]==="string"&&o[0].toLowerCase().indexOf(e.toLowerCase())!==-1)){return r<o.length+1?o[r-1]:s.ref}}return s.na}},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL=">";function i(e,t){return e>t}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL=">=";function i(e,t){return e>=t}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL="<";function i(e,t){return e<t}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL="<=";function i(e,t){return e<=t}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=i;var a=r(3);var o=r(2);var n=t.SYMBOL="-";function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}var i=r.reduce(function(e,t){return e-(0,a.toNumber)(t)},(0,a.toNumber)(e));if(isNaN(i)){throw Error(o.ERROR_VALUE)}return i}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=i;var a=r(3);var o=r(2);var n=t.SYMBOL="*";function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}var i=r.reduce(function(e,t){return e*(0,a.toNumber)(t)},(0,a.toNumber)(e));if(isNaN(i)){throw Error(o.ERROR_VALUE)}return i}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=i;var n=t.SYMBOL="<>";function i(e,t){return e!==t}i.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=o;var n=r(3);var i=r(2);var a=t.SYMBOL="^";function o(e,t){var r=Math.pow((0,n.toNumber)(e),(0,n.toNumber)(t));if(isNaN(r)){throw Error(i.ERROR_VALUE)}return r}o.SYMBOL=a},function(e,t,r){var n=function(){var e=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},t=[1,5],r=[1,8],n=[1,6],i=[1,7],a=[1,9],o=[1,14],s=[1,15],l=[1,16],u=[1,12],f=[1,13],c=[1,17],d=[1,19],h=[1,20],v=[1,21],p=[1,22],g=[1,23],m=[1,24],y=[1,25],b=[1,26],w=[1,27],C=[1,28],S=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],E=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],k=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],T=[5,10,11,13,14,15,16,17,29,30],_=[5,10,13,14,15,16,29,30],x=[5,10,11,13,14,15,16,17,18,19,29,30],D=[13,29,30];var R={trace:function e(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function e(t,r,n,i,a,o,s){var l=o.length-1;switch(a){case 1:return o[l-1];break;case 2:this.$=i.callVariable(o[l][0]);break;case 3:this.$=i.toNumber(o[l]);break;case 4:this.$=i.trimEdges(o[l]);break;case 5:this.$=i.evaluateByOperator("&",[o[l-2],o[l]]);break;case 6:this.$=i.evaluateByOperator("=",[o[l-2],o[l]]);break;case 7:this.$=i.evaluateByOperator("+",[o[l-2],o[l]]);break;case 8:this.$=o[l-1];break;case 9:this.$=i.evaluateByOperator("<=",[o[l-3],o[l]]);break;case 10:this.$=i.evaluateByOperator(">=",[o[l-3],o[l]]);break;case 11:this.$=i.evaluateByOperator("<>",[o[l-3],o[l]]);break;case 12:this.$=i.evaluateByOperator("NOT",[o[l-2],o[l]]);break;case 13:this.$=i.evaluateByOperator(">",[o[l-2],o[l]]);break;case 14:this.$=i.evaluateByOperator("<",[o[l-2],o[l]]);break;case 15:this.$=i.evaluateByOperator("-",[o[l-2],o[l]]);break;case 16:this.$=i.evaluateByOperator("*",[o[l-2],o[l]]);break;case 17:this.$=i.evaluateByOperator("/",[o[l-2],o[l]]);break;case 18:this.$=i.evaluateByOperator("^",[o[l-2],o[l]]);break;case 19:var u=i.invertNumber(o[l]);this.$=u;if(isNaN(this.$)){this.$=0}break;case 20:var u=i.toNumber(o[l]);this.$=u;if(isNaN(this.$)){this.$=0}break;case 21:this.$=i.callFunction(o[l-2]);break;case 22:this.$=i.callFunction(o[l-3],o[l-1]);break;case 26:case 27:case 28:this.$=i.cellValue(o[l]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=i.rangeValue(o[l-2],o[l]);break;case 38:case 42:this.$=[o[l]];break;case 39:this.$=i.trimEdges(t).split(",");break;case 40:case 41:o[l-2].push(o[l]);this.$=o[l-2];break;case 43:this.$=Array.isArray(o[l-2])?o[l-2]:[o[l-2]];this.$.push(o[l]);break;case 44:this.$=o[l];break;case 45:this.$=(o[l-2]+"."+o[l])*1;break;case 46:this.$=o[l-1]*.01;break;case 47:this.$=i.throwError(o[l]);break}},table:[{2:11,3:1,4:2,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{1:[3]},{5:[1,18],9:d,10:h,11:v,14:p,15:g,16:m,17:y,18:b,19:w,20:C},e(S,[2,2],{32:[1,29]}),e(S,[2,3],{34:[1,30]}),e(S,[2,4]),{2:11,4:31,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:32,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:33,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{12:[1,34]},e(S,[2,23]),e(S,[2,24],{2:35,35:c}),e(E,[2,42]),e(k,[2,44],{32:[1,36]}),e(S,[2,26],{27:[1,37]}),e(S,[2,27],{27:[1,38]}),e(S,[2,28],{27:[1,39]}),e([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:41,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:42,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:45,6:3,7:4,8:t,10:[1,43],11:r,12:n,15:[1,44],17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:47,6:3,7:4,8:t,10:[1,46],11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:48,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:49,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:50,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:51,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:52,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{31:[1,53]},e(k,[2,46]),{9:d,10:h,11:v,13:[1,54],14:p,15:g,16:m,17:y,18:b,19:w,20:C},e(T,[2,19],{9:d,18:b,19:w,20:C}),e(T,[2,20],{9:d,18:b,19:w,20:C}),{2:11,4:57,6:3,7:4,8:t,11:r,12:n,13:[1,55],17:i,21:a,22:56,23:10,24:o,25:s,26:l,28:[1,58],31:u,33:f,35:c},e(S,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},e(S,[2,5]),e([5,10,13,29,30],[2,6],{9:d,11:v,14:p,15:g,16:m,17:y,18:b,19:w,20:C}),e(T,[2,7],{9:d,18:b,19:w,20:C}),{2:11,4:69,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:70,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},e(_,[2,14],{9:d,11:v,17:y,18:b,19:w,20:C}),{2:11,4:71,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},e(_,[2,13],{9:d,11:v,17:y,18:b,19:w,20:C}),e([5,10,13,16,29,30],[2,12],{9:d,11:v,14:p,15:g,17:y,18:b,19:w,20:C}),e(T,[2,15],{9:d,18:b,19:w,20:C}),e(x,[2,16],{9:d,20:C}),e(x,[2,17],{9:d,20:C}),e([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:d}),e(E,[2,43]),e(S,[2,8]),e(S,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},e(D,[2,38],{9:d,10:h,11:v,14:p,15:g,16:m,17:y,18:b,19:w,20:C}),e(D,[2,39]),e(k,[2,45]),e(S,[2,29]),e(S,[2,30]),e(S,[2,31]),e(S,[2,32]),e(S,[2,33]),e(S,[2,34]),e(S,[2,35]),e(S,[2,36]),e(S,[2,37]),e(_,[2,9],{9:d,11:v,17:y,18:b,19:w,20:C}),e(_,[2,11],{9:d,11:v,17:y,18:b,19:w,20:C}),e(_,[2,10],{9:d,11:v,17:y,18:b,19:w,20:C}),e(S,[2,22]),{2:11,4:75,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},{2:11,4:76,6:3,7:4,8:t,11:r,12:n,17:i,21:a,23:10,24:o,25:s,26:l,31:u,33:f,35:c},e(D,[2,40],{9:d,10:h,11:v,14:p,15:g,16:m,17:y,18:b,19:w,20:C}),e(D,[2,41],{9:d,10:h,11:v,14:p,15:g,16:m,17:y,18:b,19:w,20:C})],defaultActions:{18:[2,1]},parseError:function e(t,r){if(r.recoverable){this.trace(t)}else{var n=new Error(t);n.hash=r;throw n}},parse:function e(t){var r=this,n=[0],i=[],a=[null],o=[],s=this.table,l="",u=0,f=0,c=0,d=2,h=1;var v=o.slice.call(arguments,1);var p=Object.create(this.lexer);var g={yy:{}};for(var m in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,m)){g.yy[m]=this.yy[m]}}p.setInput(t,g.yy);g.yy.lexer=p;g.yy.parser=this;if(typeof p.yylloc=="undefined"){p.yylloc={}}var y=p.yylloc;o.push(y);var b=p.options&&p.options.ranges;if(typeof g.yy.parseError==="function"){this.parseError=g.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function w(e){n.length=n.length-2*e;a.length=a.length-e;o.length=o.length-e}e:var C=function(){var e;e=p.lex()||h;if(typeof e!=="number"){e=r.symbols_[e]||e}return e};var S,E,k,T,_,x,D={},R,I,O,A;while(true){k=n[n.length-1];if(this.defaultActions[k]){T=this.defaultActions[k]}else{if(S===null||typeof S=="undefined"){S=C()}T=s[k]&&s[k][S]}e:if(typeof T==="undefined"||!T.length||!T[0]){var N;var M="";function L(e){var t=n.length-1;var r=0;for(;;){if(d.toString()in s[e]){return r}if(e===0||t<2){return false}t-=2;e=n[t];++r}}if(!c){N=L(k);A=[];for(R in s[k]){if(this.terminals_[R]&&R>d){A.push("'"+this.terminals_[R]+"'")}}if(p.showPosition){M="Parse error on line "+(u+1)+":\n"+p.showPosition()+"\nExpecting "+A.join(", ")+", got '"+(this.terminals_[S]||S)+"'"}else{M="Parse error on line "+(u+1)+": Unexpected "+(S==h?"end of input":"'"+(this.terminals_[S]||S)+"'")}this.parseError(M,{text:p.match,token:this.terminals_[S]||S,line:p.yylineno,loc:y,expected:A,recoverable:N!==false})}else if(E!==h){N=L(k)}if(c==3){if(S===h||E===h){throw new Error(M||"Parsing halted while starting to recover from another error.")}f=p.yyleng;l=p.yytext;u=p.yylineno;y=p.yylloc;S=C()}if(N===false){throw new Error(M||"Parsing halted. No suitable error recovery rule available.")}w(N);E=S==d?null:S;S=d;k=n[n.length-1];T=s[k]&&s[k][d];c=3}if(T[0]instanceof Array&&T.length>1){throw new Error("Parse Error: multiple actions possible at state: "+k+", token: "+S)}switch(T[0]){case 1:n.push(S);a.push(p.yytext);o.push(p.yylloc);n.push(T[1]);S=null;if(!E){f=p.yyleng;l=p.yytext;u=p.yylineno;y=p.yylloc;if(c>0){c--}}else{S=E;E=null}break;case 2:I=this.productions_[T[1]][1];D.$=a[a.length-I];D._$={first_line:o[o.length-(I||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(I||1)].first_column,last_column:o[o.length-1].last_column};if(b){D._$.range=[o[o.length-(I||1)].range[0],o[o.length-1].range[1]]}x=this.performAction.apply(D,[l,f,u,g.yy,T[1],a,o].concat(v));if(typeof x!=="undefined"){return x}if(I){n=n.slice(0,-1*I*2);a=a.slice(0,-1*I);o=o.slice(0,-1*I)}n.push(this.productions_[T[1]][0]);a.push(D.$);o.push(D._$);O=s[n[n.length-2]][n[n.length-1]];n.push(O);break;case 3:return true}}return true}};var I=function(){var e={EOF:1,parseError:function e(t,r){if(this.yy.parser){this.yy.parser.parseError(t,r)}else{throw new Error(t)}},setInput:function(e,t){this.yy=t||this.yy||{};this._input=e;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);if(t){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return e},unput:function(e){var t=e.length;var r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-t);this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(r.length-1){this.yylineno-=r.length-1}var i=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t};if(this.options.ranges){this.yylloc.range=[i[0],i[0]+this.yyleng-t]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;if(e.length<20){e+=this._input.substr(0,20-e.length)}return(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput();var t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer){i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){i.yylloc.range=this.yylloc.range.slice(0)}}n=e[0].match(/(?:\r\n?|\n).*/g);if(n){this.yylineno+=n.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(e[0].length);this.matched+=e[0];r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(r){return r}else if(this._backtrack){for(var a in i){this[a]=i[a]}return false}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var e,t,r,n;if(!this._more){this.yytext="";this.match=""}var i=this._currentRules();for(var a=0;a<i.length;a++){r=this._input.match(this.rules[i[a]]);if(r&&(!t||r[0].length>t[0].length)){t=r;n=a;if(this.options.backtrack_lexer){e=this.test_match(r,i[a]);if(e!==false){return e}else if(this._backtrack){t=false;continue}else{return false}}else if(!this.options.flex){break}}}if(t){e=this.test_match(t,i[n]);if(e!==false){return e}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function e(){var t=this.next();if(t){return t}else{return this.lex()}},begin:function e(t){this.conditionStack.push(t)},popState:function e(){var t=this.conditionStack.length-1;if(t>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function e(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions["INITIAL"].rules}},topState:function e(t){t=this.conditionStack.length-1-Math.abs(t||0);if(t>=0){return this.conditionStack[t]}else{return"INITIAL"}},pushState:function e(t){this.begin(t)},stateStackSize:function e(){return this.conditionStack.length},options:{},performAction:function e(t,r,n,i){var a=i;switch(n){case 0:break;case 1:return 8;break;case 2:return 8;break;case 3:return 21;break;case 4:return 35;break;case 5:return 24;break;case 6:return 26;break;case 7:return 26;break;case 8:return 25;break;case 9:return 21;break;case 10:return 31;break;case 11:return 31;break;case 12:return 33;break;case 13:return 28;break;case 14:return 9;break;case 15:return" ";break;case 16:return 32;break;case 17:return 27;break;case 18:return 29;break;case 19:return 30;break;case 20:return 18;break;case 21:return 19;break;case 22:return 17;break;case 23:return 11;break;case 24:return 20;break;case 25:return 12;break;case 26:return 13;break;case 27:return 15;break;case 28:return 14;break;case 29:return 16;break;case 30:return'"';break;case 31:return"'";break;case 32:return"!";break;case 33:return 10;break;case 34:return 34;break;case 35:return"#";break;case 36:return 5;break}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:true}}};return e}();R.lexer=I;function O(){this.yy={}}O.prototype=R;R.Parser=O;return new O}();if(true){t.parser=n;t.Parser=n.Parser;t.parse=function(){return n.parse.apply(n,arguments)}}},function(e,t,r){"use strict";t.__esModule=true;t.trimEdges=n;function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;e=e.substring(t,e.length-t);return e}}])})},function(e,t,r){"use strict";var n=r(0);r(12);r(23);r(120);r(40);r(52);r(153);t.__esModule=true;t.default=void 0;var g=n(r(18));var i=n(r(1));var a=n(r(2));var m=r(128);var s=r(4);var o=r(3);var l=n(r(62));var u=r(90);var f=/^\$?[A-Z]+\$?\d+$/;var c=/\$?[A-Z]+\$?\d+/;var d=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g;var h=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g;var v=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g;var p=function(){function t(e){(0,i.default)(this,t);this.expression="";this.cells=[];this.customModifier=null;if(typeof e==="string"){this.setExpression(e)}}(0,a.default)(t,[{key:"setExpression",value:function e(t){this.cells.length=0;this.expression=(0,u.toUpperCaseFormula)(t);this._extractCells();this._extractCellsRange();return this}},{key:"useCustomModifier",value:function e(t){this.customModifier=t}},{key:"translate",value:function e(t){var r=this;var n=t.row,i=t.column;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};(0,s.arrayEach)(this.cells,function(e){if(n!==null&&n!==void 0){r._translateCell(e,"row",n,a.row)}if(i!==null&&i!==void 0){r._translateCell(e,"column",i,a.column)}});return this}},{key:"toString",value:function e(){var l=this;var t=this.expression.replace(v,function(e,t,r){var n=e.indexOf(":")===-1;var i=e;var a=e;var o=null;if(n){a=f.test(t)?t:r}var s=l._searchCell(a);if(s){o=s.refError?(0,m.error)(m.ERROR_REF):s.toLabel();if(n){i=e.replace(a,o)}else{i=o}}return i});if(!t.startsWith("=")){t="=".concat(t)}return t}},{key:"_translateCell",value:function e(t,r,n,i){var a=t.start,o=t.end;var s=a[r].index;var l=o[r].index;var u=n;var f=n;var c=false;if(this.customModifier){var d=this.customModifier(t,r,n,i);var h=(0,g.default)(d,3);u=h[0];f=h[1];c=h[2]}else{if(a[r].isAbsolute){u=0}if(o[r].isAbsolute){f=0}}if(u&&!c){if(s+u<0){c=true}a[r].index=Math.max(s+u,0)}if(f&&!c){if(l+f<0){c=true}o[r].index=Math.max(l+f,0)}if(c){t.refError=true}}},{key:"_extractCells",value:function e(){var o=this;var t=this.expression.match(d);if(!t){return}(0,s.arrayEach)(t,function(e){var t=e.match(c);if(!t){return}var r=(0,m.extractLabel)(t[0]),n=(0,g.default)(r,2),i=n[0],a=n[1];o.cells.push(o._createCell({row:i,column:a},{row:i,column:a},t[0]))})}},{key:"_extractCellsRange",value:function e(){var p=this;var t=this.expression.match(h);if(!t){return}(0,s.arrayEach)(t,function(e){var t=e.split(":"),r=(0,g.default)(t,2),n=r[0],i=r[1];var a=(0,m.extractLabel)(n),o=(0,g.default)(a,2),s=o[0],l=o[1];var u=(0,m.extractLabel)(i),f=(0,g.default)(u,2),c=f[0],d=f[1];var h={row:s,column:l};var v={row:c,column:d};p.cells.push(p._createCell(h,v,e))})}},{key:"_searchCell",value:function e(t){var r=(0,s.arrayFilter)(this.cells,function(e){return e.origLabel===t}),n=(0,g.default)(r,1),i=n[0];return i||null}},{key:"_createCell",value:function e(t,r,n){return{start:t,end:r,origLabel:n,type:n.indexOf(":")===-1?"cell":"range",refError:false,toLabel:function e(){var t=(0,m.toLabel)(this.start.row,this.start.column);if(this.type==="range"){t+=":".concat((0,m.toLabel)(this.end.row,this.end.column))}return t}}}}]);return t}();(0,o.mixin)(p,l.default);var y=p;t.default=y},function(e,t,r){"use strict";var n={}.propertyIsEnumerable;var i=Object.getOwnPropertyDescriptor;var a=i&&!n.call({1:2},1);t.f=a?function e(t){var r=i(this,t);return!!r&&r.enumerable}:n},function(e,t,r){var n=r(157);var i=r(132);var a=n("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},function(e,t){var r=0;var n=Math.random();e.exports=function(e){return"Symbol("+String(e===undefined?"":e)+")_"+(++r+n).toString(36)}},function(e,t,r){var n=r(82);var i=Math.max;var a=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):a(r,t)}},function(e,t,r){var n=r(26);var i=/#|\.prototype\./;var a=function(e,t){var r=s[o(e)];return r==u?true:r==l?false:typeof t=="function"?n(t):!!t};var o=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()};var s=a.data={};var l=a.NATIVE="N";var u=a.POLYFILL="P";e.exports=a},function(e,t,r){var n=r(51).f;var i=r(47);var a=r(36);var o=a("toStringTag");e.exports=function(e,t,r){if(e&&!i(e=r?e:e.prototype,o)){n(e,o,{configurable:true,value:t})}}},function(e,t,r){var n=r(106);var i=r(45);var a=r(47);var o=r(51).f;var s=r(132);var l=r(425);var u=s("meta");var f=0;var c=Object.isExtensible||function(){return true};var d=function(e){o(e,u,{value:{objectID:"O"+ ++f,weakData:{}}})};var h=function(e,t){if(!i(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!a(e,u)){if(!c(e))return"F";if(!t)return"E";d(e)}return e[u].objectID};var v=function(e,t){if(!a(e,u)){if(!c(e))return true;if(!t)return false;d(e)}return e[u].weakData};var p=function(e){if(l&&g.REQUIRED&&c(e)&&!a(e,u))d(e);return e};var g=e.exports={REQUIRED:false,fastKey:h,getWeakData:v,onFreeze:p};n[u]=true},function(e,t,r){"use strict";var g=r(20);var m=r(35);var y=r(134);var b=r(68);var w=r(136);var C=r(167);var S=r(168);var E=r(45);var k=r(26);var T=r(212);var _=r(135);var x=r(169);e.exports=function(n,e,t){var i=n.indexOf("Map")!==-1;var r=n.indexOf("Weak")!==-1;var a=i?"set":"add";var o=m[n];var s=o&&o.prototype;var l=o;var u={};var f=function(e){var n=s[e];b(s,e,e=="add"?function e(t){n.call(this,t===0?0:t);return this}:e=="delete"?function(e){return r&&!E(e)?false:n.call(this,e===0?0:e)}:e=="get"?function e(t){return r&&!E(t)?undefined:n.call(this,t===0?0:t)}:e=="has"?function e(t){return r&&!E(t)?false:n.call(this,t===0?0:t)}:function e(t,r){n.call(this,t===0?0:t,r);return this})};if(y(n,typeof o!="function"||!(r||s.forEach&&!k(function(){(new o).entries().next()})))){l=t.getConstructor(e,n,i,a);w.REQUIRED=true}else if(y(n,true)){var c=new l;var d=c[a](r?{}:-0,1)!=c;var h=k(function(){c.has(1)});var v=T(function(e){new o(e)});var p=!r&&k(function(){var e=new o;var t=5;while(t--)e[a](t,t);return!e.has(-0)});if(!v){l=e(function(e,t){S(e,l,n);var r=x(new o,e,l);if(t!=undefined)C(t,r[a],r,i);return r});l.prototype=s;s.constructor=l}if(h||p){f("delete");f("has");i&&f("get")}if(p||d)f(a);if(r&&s.clear)delete s.clear}u[n]=l;g({global:true,forced:l!=o},u);_(l,n);if(!r)t.setStrong(l,n,i);return l}},function(e,t){e.exports=function(e){if(typeof e!="function"){throw TypeError(String(e)+" is not a function")}return e}},function(e,t,r){var n=r(107);e.exports=n("navigator","userAgent")||""},function(e,t,r){"use strict";var d=r(171);var n=r(219);var h=RegExp.prototype.exec;var v=String.prototype.replace;var i=h;var p=function(){var e=/a/;var t=/b*/g;h.call(e,"a");h.call(t,"a");return e.lastIndex!==0||t.lastIndex!==0}();var g=n.UNSUPPORTED_Y||n.BROKEN_CARET;var m=/()??/.exec("")[1]!==undefined;var a=p||m||g;if(a){i=function e(t){var r=this;var n,i,a,o;var s=g&&r.sticky;var l=d.call(r);var u=r.source;var f=0;var c=t;if(s){l=l.replace("y","");if(l.indexOf("g")===-1){l+="g"}c=String(t).slice(r.lastIndex);if(r.lastIndex>0&&(!r.multiline||r.multiline&&t[r.lastIndex-1]!=="\n")){u="(?: "+u+")";c=" "+c;f++}i=new RegExp("^(?:"+u+")",l)}if(m){i=new RegExp("^"+u+"$(?!\\s)",l)}if(p)n=r.lastIndex;a=h.call(s?i:r,c);if(s){if(a){a.input=a.input.slice(f);a[0]=a[0].slice(f);a.index=r.lastIndex;r.lastIndex+=a[0].length}else r.lastIndex=0}else if(p&&a){r.lastIndex=r.global?a.index+a[0].length:n}if(m&&a&&a.length>1){v.call(a[0],i,function(){for(o=1;o<arguments.length-2;o++){if(arguments[o]===undefined)a[o]=undefined}})}return a}}e.exports=i},function(e,t,r){"use strict";r(23);var c=r(68);var d=r(26);var h=r(36);var v=r(140);var p=r(67);var g=h("species");var m=!d(function(){var e=/./;e.exec=function(){var e=[];e.groups={a:"7"};return e};return"".replace(e,"$<a>")!=="7"});var y=function(){return"a".replace(/./,"$0")==="$0"}();var n=h("replace");var b=function(){if(/./[n]){return/./[n]("a","$0")===""}return false}();var w=!d(function(){var e=/(?:)/;var t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});e.exports=function(r,e,t,n){var i=h(r);var a=!d(function(){var e={};e[i]=function(){return 7};return""[r](e)!=7});var o=a&&!d(function(){var e=false;var t=/a/;if(r==="split"){t={};t.constructor={};t.constructor[g]=function(){return t};t.flags="";t[i]=/./[i]}t.exec=function(){e=true;return null};t[i]("");return!e});if(!a||!o||r==="replace"&&!(m&&y&&!b)||r==="split"&&!w){var s=/./[i];var l=t(i,""[r],function(e,t,r,n,i){if(t.exec===v){if(a&&!i){return{done:true,value:s.call(t,r,n)}}return{done:true,value:e.call(r,t,n)}}return{done:false}},{REPLACE_KEEPS_$0:y,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:b});var u=l[0];var f=l[1];c(String.prototype,r,u);c(RegExp.prototype,i,e==2?function(e,t){return f.call(e,this,t)}:function(e){return f.call(e,this)})}if(n)p(RegExp.prototype[i],"sham",true)}},function(e,t,r){var i=r(80);var a=r(140);e.exports=function(e,t){var r=e.exec;if(typeof r==="function"){var n=r.call(e,t);if(typeof n!=="object"){throw TypeError("RegExp exec method returned something other than an Object or null")}return n}if(i(e)!=="RegExp"){throw TypeError("RegExp#exec called on incompatible receiver")}return a.call(e,t)}},function(e,t,r){"use strict";var n=r(20);var i=r(220).trim;var a=r(430);n({target:"String",proto:true,forced:a("trim")},{trim:function e(){return i(this)}})},function(e,t,r){"use strict";var n=r(20);var i=r(114);var a=[].reverse;var o=[1,2];n({target:"Array",proto:true,forced:String(o)===String(o.reverse())},{reverse:function e(){if(i(this))this.length=this.length;return a.call(this)}})},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;var i=n(r(232));t.OrderView=i.default;var a=n(r(435));t.SharedOrderView=a.default},function(e,t,r){"use strict";var n=r(20);var i=r(75).find;var a=r(109);var o=r(59);var s="find";var l=true;var u=o(s);if(s in[])Array(1)[s](function(){l=false});n({target:"Array",proto:true,forced:l||!u},{find:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});a(s)},function(e,t,r){"use strict";r(177);t.__esModule=true;t.spreadsheetColumnLabel=l;t.spreadsheetColumnIndex=n;t.createSpreadsheetData=u;t.createSpreadsheetObjectData=f;t.createEmptySpreadsheetData=c;t.translateRowsToColumns=d;t.cellMethodLookupFactory=h;var a=r(180);var o=r(3);var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var s=i.length;function l(e){var t=e+1;var r="";var n;while(t>0){n=(t-1)%s;r=String.fromCharCode(65+n)+r;t=parseInt((t-n)/s,10)}return r}function n(e){var t=0;if(e){for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1){t+=Math.pow(s,n)*(i.indexOf(e[r])+1)}}t-=1;return t}function u(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;var r=[];var n;var i;for(n=0;n<e;n++){var a=[];for(i=0;i<t;i++){a.push(l(i)+(n+1))}r.push(a)}return r}function f(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;var r=[];var n;var i;for(n=0;n<e;n++){var a={};for(i=0;i<t;i++){a["prop".concat(i)]=l(i)+(n+1)}r.push(a)}return r}function c(e,t){var r=[];var n;for(var i=0;i<e;i++){n=[];for(var a=0;a<t;a++){n.push("")}r.push(n)}return r}function d(e){var t=[];var r;var n;var i;var a;var o=0;for(r=0,n=e.length;r<n;r++){for(i=0,a=e[r].length;i<a;i++){if(i===o){t.push([]);o+=1}t[i].push(e[r][i])}}return t}function h(n,e){var i=typeof e==="undefined"?true:e;return function e(t,r){return function e(t){if(!t){return}else if((0,o.hasOwnProperty)(t,n)&&t[n]!==void 0){return t[n]}else if((0,o.hasOwnProperty)(t,"type")&&t.type){if(typeof t.type!=="string"){throw new Error("Cell type must be a string ")}var r=(0,a.getCellType)(t.type);if((0,o.hasOwnProperty)(r,n)){return r[n]}else if(i){return}}return e(Object.getPrototypeOf(t))}(typeof t==="number"?this.getCellMeta(t,r):t)}}},function(e,t,r){"use strict";var n=r(20);var i=r(75).map;var a=r(116);var o=r(59);var s=a("map");var l=o("map");n({target:"Array",proto:true,forced:!s||!l},{map:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var n=r(20);var i=r(44);var a=r(35);var o=r(47);var s=r(45);var l=r(51).f;var u=r(198);var f=a.Symbol;if(i&&typeof f=="function"&&(!("description"in f.prototype)||f().description!==undefined)){var c={};var d=function e(){var t=arguments.length<1||arguments[0]===undefined?undefined:String(arguments[0]);var r=this instanceof d?new f(t):t===undefined?f():f(t);if(t==="")c[r]=true;return r};u(d,f);var h=d.prototype=f.prototype;h.constructor=d;var v=h.toString;var p=String(f("test"))=="Symbol(test)";var g=/^Symbol\((.*)\)[^)]+$/;l(h,"description",{configurable:true,get:function e(){var t=s(this)?this.valueOf():this;var r=v.call(t);if(o(c,t))return"";var n=p?r.slice(7,-1):r.replace(g,"$1");return n===""?undefined:n}});n({global:true,forced:true},{Symbol:d})}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.registerLanguageDictionary=v;t.getLanguageDictionary=p;t.hasLanguageDictionary=g;t.getDefaultLanguageDictionary=m;t.getLanguagesDictionaries=b;t.DEFAULT_LANGUAGE_CODE=void 0;var i=r(3);var a=r(388);var o=n(r(83));var s=n(r(507));var l=s.default.languageCode;t.DEFAULT_LANGUAGE_CODE=l;var u=(0,o.default)("languagesDictionaries"),f=u.register,c=u.getItem,d=u.hasItem,h=u.getValues;function v(e,t){var r=e;var n=t;if((0,i.isObject)(e)){n=e;r=n.languageCode}y(r,n);f(r,(0,i.deepClone)(n));return(0,i.deepClone)(n)}function p(e){if(!g(e)){return null}return(0,i.deepClone)(c(e))}function g(e){return d(e)}function m(){return s.default}function y(e,t){if(e!==l){(0,a.extendNotExistingKeys)(t,c(l))}}function b(){return h()}v(s.default)},function(e,t,r){"use strict";var n=r(0);r(60);r(15);r(99);r(10);r(88);r(13);r(16);t.__esModule=true;t._getRefCount=v;t._resetState=c;t.isPressed=d;t.isPressedCtrlKey=h;t.startObserving=u;t.stopObserving=f;var i=n(r(25));var a=r(55);var o=new i.default;var s=new Set;var l=0;function u(e){if(l===0){o.addEventListener(e,"keydown",function(e){if(!s.has(e.keyCode)){s.add(e.keyCode)}});o.addEventListener(e,"keyup",function(e){if(s.has(e.keyCode)){s.delete(e.keyCode)}});o.addEventListener(e,"visibilitychange",function(){if(e.hidden){s.clear()}});o.addEventListener(e.defaultView,"blur",function(){s.clear()})}l+=1}function f(){if(l>0){l-=1}if(l===0){c()}}function c(){o.clearEvents();s.clear();l=0}function d(t){return Array.from(s.values()).some(function(e){return(0,a.isKey)(e,t)})}function h(){var e=Array.from(s.values());return e.some(function(e){return(0,a.isCtrlMetaKey)(e)})}function v(){return l}},function(e,t,r){"use strict";var n=r(0);r(124);r(149);r(60);r(31);r(15);r(99);r(78);r(10);r(88);r(39);r(13);r(16);t.__esModule=true;t.detectSelectionType=b;t.normalizeSelectionFactory=a;t.transformSelectionToColumnDistance=o;t.transformSelectionToRowDistance=w;t.isValidCoord=C;t.SELECTION_TYPES=t.SELECTION_TYPE_OBJECT=t.SELECTION_TYPE_ARRAY=t.SELECTION_TYPE_EMPTY=t.SELECTION_TYPE_UNRECOGNIZED=void 0;var l=n(r(18));var s=n(r(42));var u=r(27);var f=r(4);var h=r(29);var c=0;t.SELECTION_TYPE_UNRECOGNIZED=c;var d=1;t.SELECTION_TYPE_EMPTY=d;var v=2;t.SELECTION_TYPE_ARRAY=v;var p=3;t.SELECTION_TYPE_OBJECT=p;var i=[p,v];t.SELECTION_TYPES=i;var g=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]];var m=Symbol("root");var y=Symbol("child");function b(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:m;if(t!==m&&t!==y){throw new Error("The second argument is used internally only and cannot be overwritten.")}var r=Array.isArray(e);var n=t===m;var i=c;if(r){var a=e[0];if(e.length===0){i=d}else if(n&&a instanceof u.CellRange){i=p}else if(n&&Array.isArray(a)){i=b(a,y)}else if(e.length>=2&&e.length<=4){var o=!e.some(function(e,t){return!g[t].includes((0,s.default)(e))});if(o){i=v}}}return i}function a(f){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},t=e.keepDirection,c=t===void 0?false:t,d=e.propToCol;if(!i.includes(f)){throw new Error("Unsupported selection ranges schema type was provided.")}return function(e){var t=f===p;var r=t?e.from.row:e[0];var n=t?e.from.col:e[1];var i=t?e.to.row:e[2];var a=t?e.to.col:e[3];if(typeof d==="function"){if(typeof n==="string"){n=d(n)}if(typeof a==="string"){a=d(a)}}if((0,h.isUndefined)(i)){i=r}if((0,h.isUndefined)(a)){a=n}if(!c){var o=r;var s=n;var l=i;var u=a;r=Math.min(o,l);n=Math.min(s,u);i=Math.max(o,l);a=Math.max(s,u)}return[r,n,i,a]}}function o(e){var t=b(e);if(t===c||t===d){return[]}var o=a(t);var s=new Set;(0,f.arrayEach)(e,function(e){var t=o(e),r=(0,l.default)(t,4),n=r[1],i=r[3];var a=i-n+1;(0,f.arrayEach)(Array.from(new Array(a),function(e,t){return n+t}),function(e){if(!s.has(e)){s.add(e)}})});var r=Array.from(s).sort(function(e,t){return e-t});var n=(0,f.arrayReduce)(r,function(e,t,r,n){if(r!==0&&t===n[r-1]+1){e[e.length-1][1]+=1}else{e.push([t,1])}return e},[]);return n}function w(e){var t=b(e);if(t===c||t===d){return[]}var o=a(t);var s=new Set;(0,f.arrayEach)(e,function(e){var t=o(e),r=(0,l.default)(t,3),n=r[0],i=r[2];var a=i-n+1;(0,f.arrayEach)(Array.from(new Array(a),function(e,t){return n+t}),function(e){if(!s.has(e)){s.add(e)}})});var r=Array.from(s).sort(function(e,t){return e-t});var n=(0,f.arrayReduce)(r,function(e,t,r,n){if(r!==0&&t===n[r-1]+1){e[e.length-1][1]+=1}else{e.push([t,1])}return e},[]);return n}function C(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;return typeof e==="number"&&e>=0&&e<t}},function(e,t,r){"use strict";var n=r(20);var i=r(79).f;var a=r(49);var o=r(175);var s=r(53);var l=r(176);var u=r(94);var f="".startsWith;var c=Math.min;var d=l("startsWith");var h=!u&&!d&&!!function(){var e=i(String.prototype,"startsWith");return e&&!e.writable}();n({target:"String",proto:true,forced:!h&&!d},{startsWith:function e(t){var r=String(s(this));o(t);var n=a(c(arguments.length>1?arguments[1]:undefined,r.length));var i=String(t);return f?f.call(r,i,n):r.slice(n,n+i.length)===i}})},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(4);var s=r(3);var l=n(r(62));var u=n(r(632));var f=function(){function t(e){(0,i.default)(this,t);this.hot=e;this.elements=[];this.hidden=false}(0,a.default)(t,[{key:"reset",value:function e(){(0,o.arrayEach)(this.elements,function(e){return e.reset()})}},{key:"hide",value:function e(){this.hidden=true}},{key:"show",value:function e(){this.hidden=false}},{key:"isHidden",value:function e(){return this.hidden}},{key:"destroy",value:function e(){this.clearLocalHooks();(0,o.arrayEach)(this.elements,function(e){return e.destroy()});this.elements=null;this.hot=null}}]);return t}();(0,s.mixin)(f,l.default);(0,s.mixin)(f,u.default);var c=f;t.default=c},function(e,t,r){var n=r(35);var i=r(45);var a=n.document;var o=i(a)&&i(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}},function(e,t,r){var n=r(35);var i=r(67);e.exports=function(t,r){try{i(n,t,r)}catch(e){n[t]=r}return r}},function(e,t,r){var n=r(94);var i=r(196);(e.exports=function(e,t){return i[e]||(i[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.6.4",mode:n?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var l=r(63);var u=r(49);var f=r(133);var n=function(s){return function(e,t,r){var n=l(e);var i=u(n.length);var a=f(r,i);var o;if(s&&t!=t)while(i>a){o=n[a++];if(o!=o)return true}else for(;i>a;a++){if((s||a in n)&&n[a]===t)return s||a||0}return!s&&-1}};e.exports={includes:n(true),indexOf:n(false)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(26);e.exports=!!Object.getOwnPropertySymbols&&!n(function(){return!String(Symbol())})},function(e,t,r){"use strict";var m=r(20);var y=r(422);var b=r(163);var w=r(207);var C=r(135);var S=r(67);var E=r(68);var n=r(36);var k=r(94);var T=r(112);var i=r(205);var _=i.IteratorPrototype;var x=i.BUGGY_SAFARI_ITERATORS;var D=n("iterator");var R="keys";var I="values";var O="entries";var A=function(){return this};e.exports=function(e,t,r,n,i,a,o){y(r,t,n);var s=function(t){if(t===i&&d)return d;if(!x&&t in f)return f[t];switch(t){case R:return function e(){return new r(this,t)};case I:return function e(){return new r(this,t)};case O:return function e(){return new r(this,t)}}return function(){return new r(this)}};var l=t+" Iterator";var u=false;var f=e.prototype;var c=f[D]||f["@@iterator"]||i&&f[i];var d=!x&&c||s(i);var h=t=="Array"?f.entries||c:c;var v,p,g;if(h){v=b(h.call(new e));if(_!==Object.prototype&&v.next){if(!k&&b(v)!==_){if(w){w(v,_)}else if(typeof v[D]!="function"){S(v,D,A)}}C(v,l,true,true);if(k)T[l]=A}}if(i==I&&c&&c.name!==I){u=true;d=function e(){return c.call(this)}}if((!k||o)&&f[D]!==d){S(f,D,d)}T[t]=d;if(i){p={values:s(I),keys:a?d:s(R),entries:s(O)};if(o)for(g in p){if(x||u||!(g in f)){E(f,g,p[g])}}else m({target:t,proto:true,forced:x||u},p)}return p}},function(e,t,r){var n=r(47);var i=r(58);var a=r(131);var o=r(206);var s=a("IE_PROTO");var l=Object.prototype;e.exports=o?Object.getPrototypeOf:function(e){e=i(e);if(n(e,s))return e[s];if(typeof e.constructor=="function"&&e instanceof e.constructor){return e.constructor.prototype}return e instanceof Object?l:null}},function(e,t,r){var n=r(36);var i=n("toStringTag");var a={};a[i]="z";e.exports=String(a)==="[object z]"},function(e,t,r){var l=r(82);var u=r(53);var n=function(s){return function(e,t){var r=String(u(e));var n=l(t);var i=r.length;var a,o;if(n<0||n>=i)return s?"":undefined;a=r.charCodeAt(n);return a<55296||a>56319||n+1===i||(o=r.charCodeAt(n+1))<56320||o>57343?s?r.charAt(n):a:s?r.slice(n,n+2):(a-55296<<10)+(o-56320)+65536}};e.exports={codeAt:n(false),charAt:n(true)}},function(e,t,r){var i=r(68);e.exports=function(e,t,r){for(var n in t)i(e,n,t[n],r);return e}},function(e,t,r){var h=r(48);var v=r(209);var p=r(49);var g=r(113);var m=r(210);var y=r(211);var b=function(e,t){this.stopped=e;this.result=t};var n=e.exports=function(e,t,r,n,i){var a=g(t,r,n?2:1);var o,s,l,u,f,c,d;if(i){o=e}else{s=m(e);if(typeof s!="function")throw TypeError("Target is not iterable");if(v(s)){for(l=0,u=p(e.length);u>l;l++){f=n?a(h(d=e[l])[0],d[1]):a(e[l]);if(f&&f instanceof b)return f}return new b(false)}o=s.call(e)}c=o.next;while(!(d=c.call(o)).done){f=y(o,a,d.value,n);if(typeof f=="object"&&f&&f instanceof b)return f}return new b(false)};n.stop=function(e){return new b(true,e)}},function(e,t){e.exports=function(e,t,r){if(!(e instanceof t)){throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")}return e}},function(e,t,r){var a=r(45);var o=r(207);e.exports=function(e,t,r){var n,i;if(o&&typeof(n=t.constructor)=="function"&&n!==r&&a(i=n.prototype)&&i!==r.prototype)o(e,i);return e}},function(e,t,r){var n=r(45);var i=r(114);var a=r(36);var o=a("species");e.exports=function(e,t){var r;if(i(e)){r=e.constructor;if(typeof r=="function"&&(r===Array||i(r.prototype)))r=undefined;else if(n(r)){r=r[o];if(r===null)r=undefined}}return new(r===undefined?Array:r)(t===0?0:t)}},function(e,t,r){"use strict";var n=r(48);e.exports=function(){var e=n(this);var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";if(e.dotAll)t+="s";if(e.unicode)t+="u";if(e.sticky)t+="y";return t}},function(e,t,r){var n=r(45);var i=r(80);var a=r(36);var o=a("match");e.exports=function(e){var t;return n(e)&&((t=e[o])!==undefined?!!t:i(e)=="RegExp")}},function(e,t,r){"use strict";var n=r(165).charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},function(e,t,r){"use strict";t.__esModule=true;t.PARTIALLY_VISIBLE_TYPE=t.FULLY_VISIBLE_TYPE=t.RENDER_TYPE=void 0;var n=1;t.RENDER_TYPE=n;var i=2;t.FULLY_VISIBLE_TYPE=i;var a=3;t.PARTIALLY_VISIBLE_TYPE=a},function(e,t,r){var n=r(172);e.exports=function(e){if(n(e)){throw TypeError("The method doesn't accept regular expressions")}return e}},function(e,t,r){var n=r(36);var i=n("match");e.exports=function(t){var r=/./;try{"/./"[t](r)}catch(e){try{r[i]=false;return"/./"[t](r)}catch(e){}}return false}},function(e,t,r){var n=r(20);var i=r(26);var a=r(58);var o=r(163);var s=r(206);var l=i(function(){o(1)});n({target:"Object",stat:true,forced:l,sham:!s},{getPrototypeOf:function e(t){return o(a(t))}})},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(3);var i="calculatedColumns";var a={getFirstRenderedColumn:function e(){var t=this.wot.wtViewport.columnsRenderCalculator.startColumn;if(t===null){return-1}return t},getFirstVisibleColumn:function e(){var t=this.wot.wtViewport.columnsVisibleCalculator.startColumn;if(t===null){return-1}return t},getLastRenderedColumn:function e(){var t=this.wot.wtViewport.columnsRenderCalculator.endColumn;if(t===null){return-1}return t},getLastVisibleColumn:function e(){var t=this.wot.wtViewport.columnsVisibleCalculator.endColumn;if(t===null){return-1}return t},getRenderedColumnsCount:function e(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function e(){return this.wot.wtViewport.columnsVisibleCalculator.count}};(0,n.defineGetter)(a,"MIXIN_NAME",i,{writable:false,enumerable:false});var o=a;t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(3);var i="stickyColumnsLeft";var a={getFirstRenderedColumn:function e(){var t=this.wot.getSetting("totalColumns");if(t===0){return-1}return 0},getFirstVisibleColumn:function e(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function e(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function e(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function e(){var t=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),t)},getVisibleColumnsCount:function e(){return this.getRenderedColumnsCount()}};(0,n.defineGetter)(a,"MIXIN_NAME",i,{writable:false,enumerable:false});var o=a;t.default=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.registerCellType=k;t.getCellType=E;t.getRegisteredCellTypes=t.getRegisteredCellTypeNames=t.hasCellType=void 0;var i=n(r(83));var a=r(57);var o=r(43);var s=r(85);var l=n(r(485));var u=n(r(486));var f=n(r(487));var c=n(r(488));var d=n(r(489));var h=n(r(490));var v=n(r(491));var p=n(r(492));var g=n(r(493));var m=(0,i.default)("cellTypes"),y=m.register,b=m.getItem,w=m.hasItem,C=m.getNames,S=m.getValues;t.getRegisteredCellTypes=S;t.getRegisteredCellTypeNames=C;t.hasCellType=w;k("autocomplete",l.default);k("checkbox",u.default);k("date",f.default);k("dropdown",c.default);k("handsontable",d.default);k("numeric",h.default);k("password",v.default);k("text",p.default);k("time",g.default);function E(e){if(!w(e)){throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method'))}return b(e)}function k(e,t){var r=t.editor,n=t.renderer,i=t.validator;if(r){(0,a.registerEditor)(e,r)}if(n){(0,o.registerRenderer)(e,n)}if(i){(0,s.registerValidator)(e,i)}y(e,t)}},function(e,t,r){"use strict";var n=r(0);r(19);r(60);r(12);r(78);r(33);r(86);r(87);r(23);r(13);r(40);r(495);r(34);t.__esModule=true;t.default=i;var U=n(r(42));var x=n(r(18));var j=n(r(37));var D=r(8);var R=r(182);var I=r(77);var O=r(61);var V=r(29);var s=r(71);var l=n(r(498));var u=n(r(500));var f=n(r(25));var z=r(3);var A=r(4);var N=r(183);var M=r(21);var L=r(43);var P=r(85);var F=r(74);var B=r(17);var H=n(r(505));var q=n(r(506));var Y=r(147);var G=r(98);var X=r(383);var K=r(27);var J=n(r(46));var Q=n(r(386));var Z=r(180);var ee=r(387);var te=r(150);var re=r(388);var ne=r(151);var ie=r(389);var ae=null;function i(e,t){var d=this;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var h=false;var $=this;var v=function e(){};var n=new f.default($);var W;var p;var c;var g;var m;(0,z.extend)(v.prototype,Q.default.prototype);(0,z.extend)(v.prototype,t);(0,z.extend)(v.prototype,_(t));(0,re.applyLanguageSetting)(v.prototype,t.language);if((0,X.hasValidParameter)(r)){(0,X.registerAsRootInstance)(this)}this.rootElement=e;this.rootDocument=e.ownerDocument;this.rootWindow=this.rootDocument.defaultView;(0,ne.startObserving)(this.rootDocument);this.isDestroyed=false;this.isHotTableEnv=(0,D.isChildOfWebComponentTable)(this.rootElement);f.default.isHotTableEnv=this.isHotTableEnv;this.container=this.rootDocument.createElement("div");this.renderCall=false;e.insertBefore(this.container,e.firstChild);if((0,X.isRootInstance)(this)){(0,V._injectProductInfo)(t.licenseKey,e)}this.guid="ht_".concat((0,F.randomString)());var y=(0,G.getTranslator)($);c=new q.default($);if(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_"){this.rootElement.id=this.guid}W={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new v,selRange:null,isPopulated:null,scrollable:null,firstRun:true};var b=new ie.Selection(W.settings,{countCols:function e(){return $.countCols()},countRows:function e(){return $.countRows()},propToCol:function e(t){return p.propToCol(t)},isEditorOpened:function e(){return $.getActiveEditor()?$.getActiveEditor().isOpened():false}});this.selection=b;this.selection.addLocalHook("beforeSetRangeStart",function(e){d.runHooks("beforeSetRangeStart",e)});this.selection.addLocalHook("beforeSetRangeStartOnly",function(e){d.runHooks("beforeSetRangeStartOnly",e)});this.selection.addLocalHook("beforeSetRangeEnd",function(e){d.runHooks("beforeSetRangeEnd",e);if(e.row<0){e.row=d.view.wt.wtTable.getFirstVisibleRow()}if(e.col<0){e.col=d.view.wt.wtTable.getFirstVisibleColumn()}});this.selection.addLocalHook("afterSetRangeEnd",function(e){var t=(0,z.createObjectPropListener)(false);var r=d.selection.getSelectedRange();var n=r.current(),i=n.from,a=n.to;var o=r.size()-1;d.runHooks("afterSelection",i.row,i.col,a.row,a.col,t,o);d.runHooks("afterSelectionByProp",i.row,$.colToProp(i.col),a.row,$.colToProp(a.col),t,o);var s=d.selection.isSelectedByAnyHeader();var l=d.selection.selectedRange.current();var u=true;if(h){u=false}if(t.isTouched()){u=!t.value}var f=d.selection.isSelectedByRowHeader();var c=d.selection.isSelectedByColumnHeader();if(u!==false){if(!s){if(l&&!d.selection.isMultiple()){d.view.scrollViewport(l.from)}else{d.view.scrollViewport(e)}}else if(f){d.view.scrollViewportVertically(e.row)}else if(c){d.view.scrollViewportHorizontally(e.col)}}if(f&&c){(0,D.addClass)(d.rootElement,["ht__selection--rows","ht__selection--columns"])}else if(f){(0,D.removeClass)(d.rootElement,"ht__selection--columns");(0,D.addClass)(d.rootElement,"ht__selection--rows")}else if(c){(0,D.removeClass)(d.rootElement,"ht__selection--rows");(0,D.addClass)(d.rootElement,"ht__selection--columns")}else{(0,D.removeClass)(d.rootElement,["ht__selection--rows","ht__selection--columns"])}d._refreshBorders(null)});this.selection.addLocalHook("afterSelectionFinished",function(e){var t=e.length-1;var r=e[t],n=r.from,i=r.to;d.runHooks("afterSelectionEnd",n.row,n.col,i.row,i.col,t);d.runHooks("afterSelectionEndByProp",n.row,$.colToProp(n.col),i.row,$.colToProp(i.col),t)});this.selection.addLocalHook("afterIsMultipleSelection",function(e){var t=d.runHooks("afterIsMultipleSelection",e.value);if(e.value){e.value=t}});this.selection.addLocalHook("beforeModifyTransformStart",function(e){d.runHooks("modifyTransformStart",e)});this.selection.addLocalHook("afterModifyTransformStart",function(e,t,r){d.runHooks("afterModifyTransformStart",e,t,r)});this.selection.addLocalHook("beforeModifyTransformEnd",function(e){d.runHooks("modifyTransformEnd",e)});this.selection.addLocalHook("afterModifyTransformEnd",function(e,t,r){d.runHooks("afterModifyTransformEnd",e,t,r)});this.selection.addLocalHook("afterDeselect",function(){m.destroyEditor();d._refreshBorders();(0,D.removeClass)(d.rootElement,["ht__selection--rows","ht__selection--columns"]);d.runHooks("afterDeselect")});this.selection.addLocalHook("insertRowRequire",function(e){d.alter("insert_row",e,1,"auto")});this.selection.addLocalHook("insertColRequire",function(e){d.alter("insert_col",e,1,"auto")});g={alter:function e(t,r){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var f=arguments.length>3?arguments[3]:undefined;var n=arguments.length>4?arguments[4]:undefined;var i;function a(e,t,r,n){var i=function e(){var t;if(n==="array"){t=[]}else if(n==="object"){t={}}return t};var a=(0,A.arrayMap)(new Array(r),function(){return i()});a.unshift(t,0);e.splice.apply(e,(0,j.default)(a))}var o=function e(t){if(t.length===0){return[]}var r=(0,j.default)(t);r.sort(function(e,t){var r=(0,x.default)(e,1),n=r[0];var i=(0,x.default)(t,1),a=i[0];if(n===a){return 0}return n>a?1:-1});var n=(0,A.arrayReduce)(r,function(e,t){var r=(0,x.default)(t,2),n=r[0],i=r[1];var a=e[e.length-1];var o=(0,x.default)(a,2),s=o[0],l=o[1];var u=s+l;if(n<=u){var f=Math.max(i-(u-n),0);a[1]+=f}else{e.push([n,i])}return e},[r[0]]);return n};switch(t){case"insert_row":var s=$.countSourceRows();if($.getSettings().maxRows===s){return}r=(0,V.isDefined)(r)?r:s;i=p.createRow(r,u,f);a(W.cellSettings,r,u,"array");if(i){if(b.isSelected()&&b.selectedRange.current().from.row>=r){b.selectedRange.current().from.row+=i;b.transformEnd(i,0)}else{$._refreshBorders()}}break;case"insert_col":i=p.createCol(r,u,f);for(var l=0,c=$.countSourceRows();l<c;l++){if(W.cellSettings[l]){a(W.cellSettings[l],r,u)}}if(i){if(Array.isArray($.getSettings().colHeaders)){var d=[r,0];d.length+=i;Array.prototype.splice.apply($.getSettings().colHeaders,d)}if(b.isSelected()&&b.selectedRange.current().from.col>=r){b.selectedRange.current().from.col+=i;b.transformEnd(0,i)}else{$._refreshBorders()}}break;case"remove_row":var h=function e(t){var l=0;(0,A.arrayEach)(t,function(e){var t=(0,x.default)(e,2),r=t[0],n=t[1];var i=(0,V.isEmpty)(r)?$.countRows()-1:Math.max(r-l,0);if(Number.isInteger(r)){r=Math.max(r-l,0)}p.removeRow(r,n,f);W.cellSettings.splice(i,u);var a=$.countRows();var o=$.getSettings().fixedRowsTop;if(o>=i+1){$.getSettings().fixedRowsTop-=Math.min(n,o-i)}var s=$.getSettings().fixedRowsBottom;if(s&&i>=a-s){$.getSettings().fixedRowsBottom-=Math.min(n,s)}l+=n})};if(Array.isArray(r)){h(o(r))}else{h([[r,u]])}g.adjustRowsAndCols();$._refreshBorders();break;case"remove_col":var v=function e(t){var u=0;(0,A.arrayEach)(t,function(e){var t=(0,x.default)(e,2),r=t[0],n=t[1];var i=(0,V.isEmpty)(r)?$.countCols()-1:Math.max(r-u,0);var a=y.toPhysicalColumn(i);if(Number.isInteger(r)){r=Math.max(r-u,0)}p.removeCol(r,n,f);for(var o=0,s=$.countSourceRows();o<s;o++){if(W.cellSettings[o]){W.cellSettings[o].splice(a,n)}}var l=$.getSettings().fixedColumnsLeft;if(l>=i+1){$.getSettings().fixedColumnsLeft-=Math.min(n,l-i)}if(Array.isArray($.getSettings().colHeaders)){if(typeof a==="undefined"){a=-1}$.getSettings().colHeaders.splice(a,n)}u+=n})};if(Array.isArray(r)){v(o(r))}else{v([[r,u]])}g.adjustRowsAndCols();$._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}if(!n){g.adjustRowsAndCols()}},adjustRowsAndCols:function e(){if(W.settings.minRows){var t=$.countRows();if(t<W.settings.minRows){for(var r=0,n=W.settings.minRows;r<n-t;r++){p.createRow($.countRows(),1,"auto")}}}if(W.settings.minSpareRows){var i=$.countEmptyRows(true);if(i<W.settings.minSpareRows){for(;i<W.settings.minSpareRows&&$.countSourceRows()<W.settings.maxRows;i++){p.createRow($.countRows(),1,"auto")}}}{var a;if(W.settings.minCols||W.settings.minSpareCols){a=$.countEmptyCols(true)}if(W.settings.minCols&&!W.settings.columns&&$.countCols()<W.settings.minCols){for(;$.countCols()<W.settings.minCols;a++){p.createCol($.countCols(),1,"auto")}}if(W.settings.minSpareCols&&!W.settings.columns&&$.dataType==="array"&&a<W.settings.minSpareCols){for(;a<W.settings.minSpareCols&&$.countCols()<W.settings.maxCols;a++){p.createCol($.countCols(),1,"auto")}}}var o=$.countRows();var s=$.countCols();if(o===0||s===0){b.deselect()}if(b.isSelected()){(0,A.arrayEach)(b.selectedRange,function(e){var t=false;var r=e.from.row;var n=e.from.col;var i=e.to.row;var a=e.to.col;if(r>o-1){r=o-1;t=true;if(i>r){i=r}}else if(i>o-1){i=o-1;t=true;if(r>i){r=i}}if(n>s-1){n=s-1;t=true;if(a>n){a=n}}else if(a>s-1){a=s-1;t=true;if(n>a){n=a}}if(t){$.selectCell(r,n,i,a)}})}if($.view){$.view.wt.wtOverlays.adjustElementsSize()}},populateFromArray:function e(t,i,r,n,a,o,s){var l;var u;var f;var c;var d=[];var h={};u=i.length;if(u===0){return false}var v;var p;var g;var m;switch(a){case"shift_down":v=r?r.col-t.col+1:0;p=r?r.row-t.row+1:0;i=(0,Y.translateRowsToColumns)(i);for(f=0,c=i.length,g=Math.max(c,v);f<g;f++){if(f<c){var y;for(l=0,u=i[f].length;l<p-u;l++){i[f].push(i[f][l%u])}i[f].unshift(t.col+f,t.row,0);(y=$).spliceCol.apply(y,(0,j.default)(i[f]))}else{var b;i[f%c][0]=t.col+f;(b=$).spliceCol.apply(b,(0,j.default)(i[f%c]))}}break;case"shift_right":v=r?r.col-t.col+1:0;p=r?r.row-t.row+1:0;for(l=0,u=i.length,m=Math.max(u,p);l<m;l++){if(l<u){var w;for(f=0,c=i[l].length;f<v-c;f++){i[l].push(i[l][f%c])}i[l].unshift(t.row+l,t.col,0);(w=$).spliceRow.apply(w,(0,j.default)(i[l]))}else{var C;i[l%u][0]=t.row+l;(C=$).spliceRow.apply(C,(0,j.default)(i[l%u]))}}break;case"overwrite":default:h.row=t.row;h.col=t.col;var S={row:r&&t?r.row-t.row+1:1,col:r&&t?r.col-t.col+1:1};var E=0;var k=0;var T=true;var _;var x=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=i[t%i.length];if(r!==null){return n[r%n.length]}return n};var D=i.length;var R=r?r.row-t.row+1:0;if(r){u=R}else{u=Math.max(D,R)}for(l=0;l<u;l++){if(r&&h.row>r.row&&R>D||!W.settings.allowInsertRow&&h.row>$.countRows()-1||h.row>=W.settings.maxRows){break}var I=l-E;var O=x(I).length;var A=r?r.col-t.col+1:0;if(r){c=A}else{c=Math.max(O,A)}h.col=t.col;_=$.getCellMeta(h.row,h.col);if((n==="CopyPaste.paste"||n==="Autofill.fill")&&_.skipRowOnPaste){E+=1;h.row+=1;u+=1;continue}k=0;for(f=0;f<c;f++){if(r&&h.col>r.col&&A>O||!W.settings.allowInsertColumn&&h.col>$.countCols()-1||h.col>=W.settings.maxCols){break}_=$.getCellMeta(h.row,h.col);if((n==="CopyPaste.paste"||n==="Autofill.fill")&&_.skipColumnOnPaste){k+=1;h.col+=1;c+=1;continue}if(_.readOnly){h.col+=1;continue}var N=f-k;var M=x(I,N);var L=$.getDataAtCell(h.row,h.col);var P={row:I,col:N};if(n==="Autofill.fill"){var F=$.runHooks("beforeAutofillInsidePopulate",P,o,i,s,{},S);if(F){M=(0,V.isUndefined)(F.value)?M:F.value}}if(M!==null&&(0,U.default)(M)==="object"){if(Array.isArray(M)&&L===null)L=[];if(L===null||(0,U.default)(L)!=="object"){T=false}else{var B=(0,z.duckSchema)(Array.isArray(L)?L:L[0]||L);var H=(0,z.duckSchema)(Array.isArray(M)?M:M[0]||M);if((0,z.isObjectEqual)(B,H)){M=(0,z.deepClone)(M)}else{T=false}}}else if(L!==null&&(0,U.default)(L)==="object"){T=false}if(T){d.push([h.row,h.col,M])}T=true;h.col+=1}h.row+=1}$.setDataAtCell(d,null,null,n||"populateFromArray");break}}};function w(e){var t=(0,re.normalizeLanguageCode)(e);if((0,te.hasLanguageDictionary)(t)){$.runHooks("beforeLanguageChange",t);v.prototype.language=t;$.runHooks("afterLanguageChange",t)}else{(0,re.warnUserAboutLanguageRegistration)(e)}}this.init=function(){c.setData(W.settings.data);$.runHooks("beforeInit");if((0,s.isMobileBrowser)()){(0,D.addClass)($.rootElement,"mobile")}this.updateSettings(W.settings,true);this.view=new H.default(this);m=u.default.getInstance($,W,b,p);this.forceFullRender=true;$.runHooks("init");this.view.render();if((0,U.default)(W.firstRun)==="object"){$.runHooks("afterChange",W.firstRun[0],W.firstRun[1]);W.firstRun=false}$.runHooks("afterInit")};function C(){var t=false;return{validatorsInQueue:0,valid:true,addValidatorToQueue:function e(){this.validatorsInQueue+=1;t=false},removeValidatorFormQueue:function e(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function e(){},checkIfQueueIsEmpty:function e(){if(this.validatorsInQueue===0&&t===false){t=true;this.onQueueEmpty(this.valid)}}}}function S(e){var t=e.replace(",",".");if(isNaN(parseFloat(t))===false){return parseFloat(t)}return e}function E(i,e,t){if(!i.length){return}var r=$.getActiveEditor();var n=$.runHooks("beforeChange",i,e||"edit");var a=true;if((0,I.isFunction)(n)){(0,O.warn)("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed).")}else if(n===false){if(r){r.cancelChanges()}return}var o=new C;var s=function e(t){return t.length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(t)};o.onQueueEmpty=function(e){if(r&&a){r.cancelChanges()}t(e)};for(var l=i.length-1;l>=0;l--){if(i[l]===null){i.splice(l,1)}else{var u=(0,x.default)(i[l],4),f=u[0],c=u[1],d=u[3];var h=p.propToCol(c);var v=$.getCellMeta(f,h);if(v.type==="numeric"&&typeof d==="string"&&s(d)){i[l][3]=S(d)}if($.getCellValidator(v)){o.addValidatorToQueue();$.validateCell(i[l][3],v,function(r,n){return function(e){if(typeof e!=="boolean"){throw new Error("Validation error: result is not boolean")}if(e===false&&n.allowInvalid===false){a=false;i.splice(r,1);n.valid=true;var t=$.getCell(n.visualRow,n.visualCol);if(t!==null){(0,D.removeClass)(t,$.getSettings().invalidCellClassName)}}o.removeValidatorFormQueue()}}(l,v),e)}}}o.checkIfQueueIsEmpty()}function k(e,t){var r=e.length-1;if(r<0){return}for(;r>=0;r--){var n=false;if(e[r]===null){e.splice(r,1);continue}if((e[r][2]===null||e[r][2]===void 0)&&(e[r][3]===null||e[r][3]===void 0)){continue}if(W.settings.allowInsertRow){while(e[r][0]>$.countRows()-1){var i=p.createRow(void 0,void 0,t);if(i===0){n=true;break}}}if($.dataType==="array"&&(!W.settings.columns||W.settings.columns.length===0)&&W.settings.allowInsertColumn){while(p.propToCol(e[r][1])>$.countCols()-1){var a=p.createCol(void 0,void 0,t);if(a===0){n=true;break}}}if(n){continue}p.set(e[r][0],e[r][1],e[r][3])}$.forceFullRender=true;g.adjustRowsAndCols();$.runHooks("beforeChangeRender",e,t);m.lockEditor();$._refreshBorders(null);m.unlockEditor();$.view.wt.wtOverlays.adjustElementsSize();$.runHooks("afterChange",e,t||"edit");var o=$.getActiveEditor();if(o&&(0,V.isDefined)(o.refreshValue)){o.refreshValue()}}this.validateCell=function(t,a,o,r){var e=$.getCellValidator(a);function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!t||a.hidden===true){o(e);return}var r=a.visualCol;var n=a.visualRow;var i=$.getCell(n,r,true);if(i&&i.nodeName!=="TH"){$.view.wt.wtSettings.settings.cellRenderer(n,r,i)}o(e)}if((0,V.isRegExp)(e)){e=function(r){return function(e,t){t(r.test(e))}}(e)}if((0,I.isFunction)(e)){t=$.runHooks("beforeValidate",t,a.visualRow,a.prop,r);$._registerImmediate(function(){e.call(a,t,function(e){if(!$){return}e=$.runHooks("afterValidate",e,t,a.visualRow,a.prop,r);a.valid=e;n(e);$.runHooks("postAfterValidate",e,t,a.visualRow,a.prop,r)})})}else{$._registerImmediate(function(){a.valid=true;n(a.valid,false)})}};function T(e,t,r){if((0,U.default)(e)==="object"){return e}return[[e,t,r]]}this.setDataAtCell=function(e,t,r,n){var i=T(e,t,r);var a=[];var o=n;var s;var l;var u;for(s=0,l=i.length;s<l;s++){if((0,U.default)(i[s])!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof i[s][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}var f=y.toPhysicalRow(i[s][0]);u=p.colToProp(i[s][1]);a.push([i[s][0],u,c.getAtCell(f,i[s][1]),i[s][2]])}if(!o&&(0,U.default)(e)==="object"){o=t}$.runHooks("afterSetDataAtCell",a,o);E(a,o,function(){k(a,o)})};this.setDataAtRowProp=function(e,t,r,n){var i=T(e,t,r);var a=[];var o=n;var s;var l;for(s=0,l=i.length;s<l;s++){var u=y.toPhysicalRow(i[s][0]);a.push([i[s][0],i[s][1],c.getAtCell(u,i[s][1]),i[s][2]])}if(!o&&(0,U.default)(e)==="object"){o=t}$.runHooks("afterSetDataAtRowProp",a,o);E(a,o,function(){k(a,o)})};this.listen=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var t=$,r=t.rootDocument;if(e){var n=!r.activeElement||r.activeElement&&r.activeElement.nodeName===void 0;if(r.activeElement&&r.activeElement!==r.body&&!n){r.activeElement.blur()}else if(n){r.body.focus()}}if($&&!$.isListening()){ae=$.guid;$.runHooks("afterListen")}};this.unlisten=function(){if(this.isListening()){ae=null;$.runHooks("afterUnlisten")}};this.isListening=function(){return ae===$.guid};this.destroyEditor=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$._refreshBorders(e,t)};this.populateFromArray=function(e,t,r,n,i,a,o,s,l){if(!((0,U.default)(r)==="object"&&(0,U.default)(r[0])==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}var u=typeof n==="number"?new K.CellCoords(n,i):null;return g.populateFromArray(new K.CellCoords(e,t),r,u,a,o,s,l)};this.spliceCol=function(e,t,r){var n;for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++){a[o-3]=arguments[o]}return(n=p).spliceCol.apply(n,[e,t,r].concat(a))};this.spliceRow=function(e,t,r){var n;for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++){a[o-3]=arguments[o]}return(n=p).spliceRow.apply(n,[e,t,r].concat(a))};this.getSelected=function(){if(b.isSelected()){return(0,A.arrayMap)(b.getSelectedRange(),function(e){var t=e.from,r=e.to;return[t.row,t.col,r.row,r.col]})}};this.getSelectedLast=function(){var e=this.getSelected();var t;if(e&&e.length>0){t=e[e.length-1]}return t};this.getSelectedRange=function(){if(b.isSelected()){return Array.from(b.getSelectedRange())}};this.getSelectedRangeLast=function(){var e=this.getSelectedRange();var t;if(e&&e.length>0){t=e[e.length-1]}return t};this.emptySelectedCells=function(e){var i=this;if(!b.isSelected()){return}var a=[];(0,A.arrayEach)(b.getSelectedRange(),function(e){var r=e.getTopLeftCorner();var n=e.getBottomRightCorner();(0,B.rangeEach)(r.row,n.row,function(t){(0,B.rangeEach)(r.col,n.col,function(e){if(!i.getCellMeta(t,e).readOnly){a.push([t,e,null])}})})});if(a.length>0){this.setDataAtCell(a,e)}};this.render=function(){if($.view){$.renderCall=true;$.forceFullRender=true;m.lockEditor();$._refreshBorders(null);m.unlockEditor()}};this.refreshDimensions=function(){if(!$.view){return}var e=$.view.getLastSize(),t=e.width,r=e.height;var n=$.rootElement.getBoundingClientRect(),i=n.width,a=n.height;var o=i!==t||a!==r;var s=$.runHooks("beforeRefreshDimensions",{width:t,height:r},{width:i,height:a},o)===false;if(s){return}if(o||$.view.wt.wtOverlays.scrollableElement===$.rootWindow){$.view.setLastSize(i,a);$.render()}$.runHooks("afterRefreshDimensions",{width:t,height:r},{width:i,height:a},o)};this.loadData=function(e){if(Array.isArray(W.settings.dataSchema)){$.dataType="array"}else if((0,I.isFunction)(W.settings.dataSchema)){$.dataType="function"}else{$.dataType="object"}if(p){p.destroy()}p=new l.default($,W,v);if((0,U.default)(e)==="object"&&e!==null){if(!(e.push&&e.splice)){e=[e]}}else if(e===null){var t=p.getSchema();e=[];var r;var n=0;var i=0;for(n=0,i=W.settings.startRows;n<i;n++){if(($.dataType==="object"||$.dataType==="function")&&W.settings.dataSchema){r=(0,z.deepClone)(t);e.push(r)}else if($.dataType==="array"){r=(0,z.deepClone)(t[0]);e.push(r)}else{r=[];for(var a=0,o=W.settings.startCols;a<o;a++){r.push(null)}e.push(r)}}}else{throw new Error("loadData only accepts array of objects or array of arrays (".concat((0,U.default)(e)," given)"))}W.isPopulated=false;v.prototype.data=e;if(Array.isArray(e[0])){$.dataType="array"}p.dataSource=e;c.data=e;c.dataType=$.dataType;c.colToProp=p.colToProp.bind(p);c.propToCol=p.propToCol.bind(p);s();g.adjustRowsAndCols();$.runHooks("afterLoadData",W.firstRun);if(W.firstRun){W.firstRun=[null,"loadData"]}else{$.runHooks("afterChange",null,"loadData");$.render()}W.isPopulated=true;function s(){W.cellSettings.length=0}};this.getData=function(e,t,r,n){if((0,V.isUndefined)(e)){return p.getAll()}return p.getRange(new K.CellCoords(e,t),new K.CellCoords(r,n),p.DESTINATION_RENDERER)};this.getCopyableText=function(e,t,r,n){return p.getCopyableText(new K.CellCoords(e,t),new K.CellCoords(r,n))};this.getCopyableData=function(e,t){return p.getCopyable(e,p.colToProp(t))};this.getSchema=function(){return p.getSchema()};this.updateSettings=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=false;var n;var i;var a;if((0,V.isDefined)(e.rows)){throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?')}if((0,V.isDefined)(e.cols)){throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?')}for(n in e){if(n==="data"){continue}else if(n==="language"){w(e.language);continue}else if(J.default.getSingleton().getRegistered().indexOf(n)>-1){if((0,I.isFunction)(e[n])||Array.isArray(e[n])){e[n].initialHook=true;$.addHook(n,e[n])}}else if(!t&&(0,z.hasOwnProperty)(e,n)){v.prototype[n]=e[n]}}if(e.data===void 0&&W.settings.data===void 0){$.loadData(null)}else if(e.data!==void 0){$.loadData(e.data)}else if(e.columns!==void 0){p.createMap()}a=$.countCols();var o=e.columns||v.prototype.columns;if(o&&(0,I.isFunction)(o)){a=$.countSourceCols();r=true}if(e.cell!==void 0||e.cells!==void 0||e.columns!==void 0){W.cellSettings.length=0}if(a>0){var s;var l;for(n=0,i=0;n<a;n++){if(r&&!o(n)){continue}W.columnSettings[i]=(0,R.columnFactory)(v,W.columnsSettingConflicts);s=W.columnSettings[i].prototype;if(o){if(r){l=o(n)}else{l=o[i]}if(l){(0,z.extend)(s,l);(0,z.extend)(s,_(l))}}i+=1}}if((0,V.isDefined)(e.cell)){(0,z.objectEach)(e.cell,function(e){$.setCellMetaObject(e.row,e.col,e)})}$.runHooks("afterCellMetaReset");if((0,V.isDefined)(e.className)){if(v.prototype.className){(0,D.removeClass)($.rootElement,v.prototype.className)}if(e.className){(0,D.addClass)($.rootElement,e.className)}}var u=$.rootElement.style.height;if(u!==""){u=parseInt($.rootElement.style.height,10)}var f=e.height;if((0,I.isFunction)(f)){f=f()}if(t){var c=$.rootElement.getAttribute("style");if(c){$.rootElement.setAttribute("data-initialstyle",$.rootElement.getAttribute("style"))}}if(f===null){var d=$.rootElement.getAttribute("data-initialstyle");if(d&&(d.indexOf("height")>-1||d.indexOf("overflow")>-1)){$.rootElement.setAttribute("style",d)}else{$.rootElement.style.height="";$.rootElement.style.overflow=""}}else if(f!==void 0){$.rootElement.style.height=isNaN(f)?"".concat(f):"".concat(f,"px");$.rootElement.style.overflow="hidden"}if(typeof e.width!=="undefined"){var h=e.width;if((0,I.isFunction)(h)){h=h()}$.rootElement.style.width=isNaN(h)?"".concat(h):"".concat(h,"px")}if(!t){p.clearLengthCache();if($.view){$.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}$.runHooks("afterUpdateSettings",e)}g.adjustRowsAndCols();if($.view&&!W.firstRun){$.forceFullRender=true;m.lockEditor();$._refreshBorders(null);m.unlockEditor()}if(!t&&$.view&&(u===""||f===""||f===void 0)&&u!==f){$.view.wt.wtOverlays.updateMainScrollableElements()}};this.getValue=function(){var e=$.getSelectedLast();if(v.prototype.getValue){if((0,I.isFunction)(v.prototype.getValue)){return v.prototype.getValue.call($)}else if(e){return $.getData()[e[0][0]][v.prototype.getValue]}}else if(e){return $.getDataAtCell(e[0],e[1])}};function _(e){if(!(0,z.hasOwnProperty)(e,"type")){return}var t={};var r;if((0,U.default)(e.type)==="object"){r=e.type}else if(typeof e.type==="string"){r=(0,Z.getCellType)(e.type)}for(var n in r){if((0,z.hasOwnProperty)(r,n)&&!(0,z.hasOwnProperty)(e,n)){t[n]=r[n]}}return t}this.getSettings=function(){return W.settings};this.clear=function(){this.selectAll();this.emptySelectedCells()};this.alter=function(e,t,r,n,i){g.alter(e,t,r,n,i)};this.getCell=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return $.view.getCellAtCoords(new K.CellCoords(e,t),r)};this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)};this.colToProp=function(e){return p.colToProp(e)};this.propToCol=function(e){return p.propToCol(e)};this.toVisualRow=function(e){return y.toVisualRow(e)};this.toVisualColumn=function(e){return y.toVisualColumn(e)};this.toPhysicalRow=function(e){return y.toPhysicalRow(e)};this.toPhysicalColumn=function(e){return y.toPhysicalColumn(e)};this.getDataAtCell=function(e,t){return p.get(e,p.colToProp(t))};this.getDataAtRowProp=function(e,t){return p.get(e,t)};this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,(0,j.default)(p.getRange(new K.CellCoords(0,e),new K.CellCoords(W.settings.data.length-1,e),p.DESTINATION_RENDERER)))};this.getDataAtProp=function(e){var t;var r=p.getRange(new K.CellCoords(0,p.propToCol(e)),new K.CellCoords(W.settings.data.length-1,p.propToCol(e)),p.DESTINATION_RENDERER);return(t=[]).concat.apply(t,(0,j.default)(r))};this.getSourceData=function(e,t,r,n){var i;if(e===void 0){i=c.getData()}else{i=c.getByRange(new K.CellCoords(e,t),new K.CellCoords(r,n))}return i};this.getSourceDataArray=function(e,t,r,n){var i;if(e===void 0){i=c.getData(true)}else{i=c.getByRange(new K.CellCoords(e,t),new K.CellCoords(r,n),true)}return i};this.getSourceDataAtCol=function(e){return c.getAtColumn(e)};this.getSourceDataAtRow=function(e){return c.getAtRow(e)};this.getSourceDataAtCell=function(e,t){return c.getAtCell(e,t)};this.getDataAtRow=function(e){var t=p.getRange(new K.CellCoords(e,0),new K.CellCoords(e,this.countCols()-1),p.DESTINATION_RENDERER);return t[0]||[]};this.getDataType=function(e,t,r,n){var i=this;var a=e===void 0?[0,0,this.countRows(),this.countCols()]:[e,t,r,n];var o=a[0],s=a[1];var l=a[2],u=a[3];var f=null;var c=null;if(l===void 0){l=o}if(u===void 0){u=s}var d="mixed";(0,B.rangeEach)(Math.min(o,l),Math.max(o,l),function(r){var n=true;(0,B.rangeEach)(Math.min(s,u),Math.max(s,u),function(e){var t=i.getCellMeta(r,e);c=t.type;if(f){n=f===c}else{f=c}return n});d=n?c:"mixed";return n});return d};this.removeCellMeta=function(e,t,r){var n=y.toPhysical(e,t),i=(0,x.default)(n,2),a=i[0],o=i[1];var s=W.cellSettings[a][o][r];var l=$.runHooks("beforeRemoveCellMeta",e,t,r,s);if(l!==false){delete W.cellSettings[a][o][r];$.runHooks("afterRemoveCellMeta",e,t,r,s)}s=null};this.spliceCellsMeta=function(e,t){var r;for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++){i[a-2]=arguments[a]}(r=W.cellSettings).splice.apply(r,[e,t].concat(i))};this.setCellMetaObject=function(r,n,e){var i=this;if((0,U.default)(e)==="object"){(0,z.objectEach)(e,function(e,t){i.setCellMeta(r,n,t,e)})}};this.setCellMeta=function(e,t,r,n){var i=y.toPhysical(e,t),a=(0,x.default)(i,2),o=a[0],s=a[1];if(!W.columnSettings[s]){W.columnSettings[s]=(0,R.columnFactory)(v,W.columnsSettingConflicts)}if(!W.cellSettings[o]){W.cellSettings[o]=[]}if(!W.cellSettings[o][s]){W.cellSettings[o][s]=new W.columnSettings[s]}W.cellSettings[o][s][r]=n;$.runHooks("afterSetCellMeta",e,t,r,n)};this.getCellsMeta=function(){return(0,A.arrayFlatten)(W.cellSettings)};this.getCellMeta=function(e,t){var r=p.colToProp(t);var n=y.toPhysical(e,t),i=(0,x.default)(n,2),a=i[0],o=i[1];var s=a;if(s===null){s=e}if(!W.columnSettings[o]){W.columnSettings[o]=(0,R.columnFactory)(v,W.columnsSettingConflicts)}if(!W.cellSettings[s]){W.cellSettings[s]=[]}if(!W.cellSettings[s][o]){W.cellSettings[s][o]=new W.columnSettings[o]}var l=W.cellSettings[s][o];l.row=s;l.col=o;l.visualRow=e;l.visualCol=t;l.prop=r;l.instance=$;$.runHooks("beforeGetCellMeta",e,t,l);(0,z.extend)(l,_(l));if(l.cells){var u=l.cells.call(l,s,o,r);if(u){(0,z.extend)(l,u);(0,z.extend)(l,_(u))}}$.runHooks("afterGetCellMeta",e,t,l);return l};this.getCellMetaAtRow=function(e){return W.cellSettings[e]};this.isColumnModificationAllowed=function(){return!($.dataType==="object"||$.getSettings().columns)};var i=(0,Y.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(e,t){return(0,L.getRenderer)(i.call(this,e,t))};this.getCellEditor=(0,Y.cellMethodLookupFactory)("editor");var a=(0,Y.cellMethodLookupFactory)("validator");this.getCellValidator=function(e,t){var r=a.call(this,e,t);if(typeof r==="string"){r=(0,P.getValidator)(r)}return r};this.validateCells=function(e){this._validateCells(e)};this.validateRows=function(e,t){if(!Array.isArray(e)){throw new Error("validateRows parameter `rows` must be an array")}this._validateCells(t,e)};this.validateColumns=function(e,t){if(!Array.isArray(e)){throw new Error("validateColumns parameter `columns` must be an array")}this._validateCells(t,undefined,e)};this._validateCells=function(e,t,r){var n=new C;if(e){n.onQueueEmpty=e}var i=$.countRows()-1;while(i>=0){if(t!==undefined&&t.indexOf(i)===-1){i-=1;continue}var a=$.countCols()-1;while(a>=0){if(r!==undefined&&r.indexOf(a)===-1){a-=1;continue}n.addValidatorToQueue();$.validateCell($.getDataAtCell(i,a),$.getCellMeta(i,a),function(e){if(typeof e!=="boolean"){throw new Error("Validation error: result is not boolean")}if(e===false){n.valid=false}n.removeValidatorFormQueue()},"validateCells");a-=1}i-=1}n.checkIfQueueIsEmpty()};this.getRowHeader=function(e){var t=W.settings.rowHeaders;var r=e;if(r!==void 0){r=$.runHooks("modifyRowHeader",r)}if(r===void 0){t=[];(0,B.rangeEach)($.countRows()-1,function(e){t.push($.getRowHeader(e))})}else if(Array.isArray(t)&&t[r]!==void 0){t=t[r]}else if((0,I.isFunction)(t)){t=t(r)}else if(t&&typeof t!=="string"&&typeof t!=="number"){t=r+1}return t};this.hasRowHeaders=function(){return!!W.settings.rowHeaders};this.hasColHeaders=function(){if(W.settings.colHeaders!==void 0&&W.settings.colHeaders!==null){return!!W.settings.colHeaders}for(var e=0,t=$.countCols();e<t;e++){if($.getColHeader(e)){return true}}return false};this.getColHeader=function(e){var t=W.settings.columns&&(0,I.isFunction)(W.settings.columns);var r=$.runHooks("modifyColHeader",e);var n=W.settings.colHeaders;if(r===void 0){var i=[];var a=t?$.countSourceCols():$.countCols();for(var o=0;o<a;o++){i.push($.getColHeader(o))}n=i}else{var s=function e(t){var r=[];var n=$.countSourceCols();var i=0;for(;i<n;i++){if((0,I.isFunction)($.getSettings().columns)&&$.getSettings().columns(i)){r.push(i)}}return r[t]};var l=r;var u=$.runHooks("modifyCol",l);var f=s(u);if(W.settings.colHeaders===false){n=null}else if(W.settings.columns&&(0,I.isFunction)(W.settings.columns)&&W.settings.columns(f)&&W.settings.columns(f).title){n=W.settings.columns(f).title}else if(W.settings.columns&&W.settings.columns[u]&&W.settings.columns[u].title){n=W.settings.columns[u].title}else if(Array.isArray(W.settings.colHeaders)&&W.settings.colHeaders[u]!==void 0){n=W.settings.colHeaders[u]}else if((0,I.isFunction)(W.settings.colHeaders)){n=W.settings.colHeaders(u)}else if(W.settings.colHeaders&&typeof W.settings.colHeaders!=="string"&&typeof W.settings.colHeaders!=="number"){n=(0,Y.spreadsheetColumnLabel)(l)}}return n};this._getColWidthFromSettings=function(e){var t=$.getCellMeta(0,e);var r=t.width;if(r===void 0||r===W.settings.width){r=t.colWidths}if(r!==void 0&&r!==null){switch((0,U.default)(r)){case"object":r=r[e];break;case"function":r=r(e);break;default:break}if(typeof r==="string"){r=parseInt(r,10)}}return r};this.getColWidth=function(e){var t=$._getColWidthFromSettings(e);t=$.runHooks("modifyColWidth",t,e);if(t===void 0){t=K.ViewportColumnsCalculator.DEFAULT_WIDTH}return t};this._getRowHeightFromSettings=function(e){var t=W.settings.rowHeights;if(t!==void 0&&t!==null){switch((0,U.default)(t)){case"object":t=t[e];break;case"function":t=t(e);break;default:break}if(typeof t==="string"){t=parseInt(t,10)}}return t};this.getRowHeight=function(e){var t=$._getRowHeightFromSettings(e);t=$.runHooks("modifyRowHeight",t,e);return t};this.countSourceRows=function(){var e=$.runHooks("modifySourceLength");return e||($.getSourceData()?$.getSourceData().length:0)};this.countSourceCols=function(){var e=0;var t=$.getSourceData()&&$.getSourceData()[0]?$.getSourceData()[0]:[];if((0,z.isObject)(t)){e=(0,z.deepObjectSize)(t)}else{e=t.length||0}return e};this.countRows=function(){return p.getLength()};this.countCols=function(){var e=this.getSettings().maxCols;var t=false;var r=0;if($.dataType==="array"){t=W.settings.data&&W.settings.data[0]&&W.settings.data[0].length}if(t){r=W.settings.data[0].length}if(W.settings.columns){var n=(0,I.isFunction)(W.settings.columns);if(n){if($.dataType==="array"){var i=0;for(var a=0;a<r;a++){if(W.settings.columns(a)){i+=1}}r=i}else if($.dataType==="object"||$.dataType==="function"){r=p.colToPropCache.length}}else{r=W.settings.columns.length}}else if($.dataType==="object"||$.dataType==="function"){r=p.colToPropCache.length}return Math.min(e,r)};this.rowOffset=function(){return $.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return $.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return $.view.wt.drawn?$.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return $.view.wt.drawn?$.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return $.view.wt.drawn?$.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return $.view.wt.drawn?$.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=0;(0,B.rangeEachReverse)($.countRows()-1,function(e){if($.isEmptyRow(e)){r+=1}else if(t===true){return false}});return r};this.countEmptyCols=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if($.countRows()<1){return 0}var r=0;(0,B.rangeEachReverse)($.countCols()-1,function(e){if($.isEmptyCol(e)){r+=1}else if(t===true){return false}});return r};this.isEmptyRow=function(e){return W.settings.isEmptyRow.call($,e)};this.isEmptyCol=function(e){return W.settings.isEmptyCol.call($,e)};this.selectCell=function(e,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;if((0,V.isUndefined)(e)||(0,V.isUndefined)(t)){return false}return this.selectCells([[e,t,r,n]],i,a)};this.selectCells=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[[]];var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(t===false){h=true}var n=b.selectCells(e);if(n&&r){$.listen()}h=false;return n};this.selectColumns=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;return b.selectColumns(e,t)};this.selectRows=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;return b.selectRows(e,t)};this.deselectCell=function(){b.deselect()};this.selectAll=function(){h=true;b.selectAll();h=false};this.scrollViewportTo=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var i=!r;var a=!n;var o=false;if(e!==void 0&&t!==void 0){o=$.view.scrollViewport(new K.CellCoords(e,t),i,n,r,a)}if(typeof e==="number"&&typeof t!=="number"){o=$.view.scrollViewportVertically(e,i,r)}if(typeof t==="number"&&typeof e!=="number"){o=$.view.scrollViewportHorizontally(t,n,a)}return o};this.destroy=function(){$._clearTimeouts();$._clearImmediates();if($.view){$.view.destroy()}if(c){c.destroy()}c=null;(0,ne.stopObserving)();if((0,X.isRootInstance)($)){var e=this.rootDocument.querySelector("#hot-display-license-info");if(e){e.parentNode.removeChild(e)}}(0,D.empty)($.rootElement);n.destroy();if(m){m.destroy()}$.runHooks("afterDestroy");J.default.getSingleton().destroy($);(0,z.objectEach)($,function(e,t,r){if((0,I.isFunction)(e)){r[t]=o(t)}else if(t!=="guid"){r[t]=null}});$.isDestroyed=true;if(p){p.destroy()}p=null;W=null;g=null;b=null;m=null;$=null;v=null};function o(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return m.getActiveEditor()};this.getPlugin=function(e){return(0,M.getPlugin)(this,e)};this.getInstance=function(){return $};this.addHook=function(e,t){J.default.getSingleton().add(e,t,$)};this.hasHook=function(e){return J.default.getSingleton().has(e,$)};this.addHookOnce=function(e,t){J.default.getSingleton().once(e,t,$)};this.removeHook=function(e,t){J.default.getSingleton().remove(e,t,$)};this.runHooks=function(e,t,r,n,i,a,o){return J.default.getSingleton().run($,e,t,r,n,i,a,o)};this.getTranslatedPhrase=function(e,t){return(0,ee.getTranslatedPhrase)(W.settings.language,e,t)};this.toHTML=function(){return(0,N.instanceToHTML)(d)};this.toTableElement=function(){var e=d.rootDocument.createElement("div");e.insertAdjacentHTML("afterbegin",(0,N.instanceToHTML)(d));return e.firstElementChild};this.timeouts=[];this._registerTimeout=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=e;if(typeof r==="function"){r=setTimeout(r,t)}this.timeouts.push(r)};this._clearTimeouts=function(){(0,A.arrayEach)(this.timeouts,function(e){clearTimeout(e)})};this.immediates=[];this._registerImmediate=function(e){this.immediates.push(setImmediate(e))};this._clearImmediates=function(){(0,A.arrayEach)(this.immediates,function(e){clearImmediate(e)})};this._refreshBorders=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;m.destroyEditor(e);$.view.render();if(t&&b.isSelected()){m.prepareEditor()}};J.default.getSingleton().run($,"construct")}},function(e,t,r){"use strict";t.__esModule=true;t.columnFactory=n;var a=r(3);function n(e,t){function r(){}(0,a.inherit)(r,e);for(var n=0,i=t.length;n<i;n++){r.prototype[t[n]]=void 0}return r}},function(e,t,r){"use strict";var n=r(0);r(19);r(50);r(501);r(60);r(31);r(54);r(502);r(148);r(381);r(33);r(65);r(10);r(119);r(23);r(38);r(39);r(13);r(120);r(40);t.__esModule=true;t.instanceToHTML=i;t._dataToHTML=a;t.htmlToGridSettings=o;var I=n(r(37));var O=r(8);var _=r(29);var A={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"};var N=new RegExp(Object.keys(A).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function M(e){return(e&&e.nodeName||"")==="TABLE"}function i(e){var t=e.hasColHeaders();var r=e.hasRowHeaders();var n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1];var i=e.getData.apply(e,n);var a=i.length;var o=a>0?i[0].length:0;var s=["<table>","</table>"];var l=t?["<thead>","</thead>"]:[];var u=["<tbody>","</tbody>"];var f=r?1:0;var c=t?1:0;for(var d=0;d<a;d+=1){var h=t&&d===0;var v=[];for(var p=0;p<o;p+=1){var g=!h&&r&&p===0;var m="";if(h){m="<th>".concat(e.getColHeader(p-f),"</th>")}else if(g){m="<th>".concat(e.getRowHeader(d-c),"</th>")}else{var y=i[d][p];var b=e.getCellMeta(d-f,p-c),w=b.hidden,C=b.rowspan,S=b.colspan;if(!w){var E=[];if(C){E.push('rowspan="'.concat(C,'"'))}if(S){E.push('colspan="'.concat(S,'"'))}if((0,_.isEmpty)(y)){m="<td ".concat(E.join(" "),"></td>")}else{var k=y.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");m="<td ".concat(E.join(" "),">").concat(k,"</td>")}}}v.push(m)}var T=["<tr>"].concat(v,["</tr>"]).join("");if(h){l.splice(1,0,T)}else{u.splice(-1,0,T)}}s.splice(1,0,l.join(""),u.join(""));return s.join("")}function a(e){var t=e.length;var r=["<table>"];for(var n=0;n<t;n+=1){var i=e[n];var a=i.length;var o=[];if(n===0){r.push("<tbody>")}for(var s=0;s<a;s+=1){var l=i[s];var u=(0,_.isEmpty)(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");o.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(o,["</tr>"]));if(n+1===t){r.push("</tbody>")}}r.push("</table>");return r.join("")}function o(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document;var r={};var n=t.createDocumentFragment();var i=t.createElement("div");n.appendChild(i);var a=e;if(typeof a==="string"){var o=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(e){var t=e.match(/<td\b[^>]*?>/g)[0];var r=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");var n="</td>";return"".concat(t).concat(r).concat(n)});i.insertAdjacentHTML("afterbegin","".concat(o));a=i.querySelector("table")}if(!a||!M(a)){return}var s=i.querySelector("style");var l=null;var v=[];if(s){t.body.appendChild(s);s.disabled=true;l=s.sheet;v=l?Array.from(l.cssRules):[];t.body.removeChild(s)}var p=i.querySelector('meta[name$="enerator"]');var u=a.querySelector("tbody th")!==null;var f=Array.from(a.querySelector("tr").cells).reduce(function(e,t){return e+t.colSpan},0)-(u?1:0);var c=a.tFoot&&Array.from(a.tFoot.rows)||[];var d=[];var h=false;var g=0;var m=0;if(a.tHead){var y=Array.from(a.tHead.rows).filter(function(e){var t=e.querySelector("td")!==null;if(t){d.push(e)}return!t});g=y.length;h=g>0;if(g>1){r.nestedHeaders=Array.from(y).reduce(function(e,t){var r=Array.from(t.cells).reduce(function(e,t,r){if(u&&r===0){return e}var n=t.colSpan,i=t.innerHTML;var a=n>1?{label:i,colspan:n}:i;e.push(a);return e},[]);e.push(r);return e},[])}else if(h){r.colHeaders=Array.from(y[0].children).reduce(function(e,t,r){if(u&&r===0){return e}e.push(t.innerHTML);return e},[])}}if(d.length){r.fixedRowsTop=d.length}if(c.length){r.fixedRowsBottom=c.length}var b=[].concat(d,(0,I.default)(Array.from(a.tBodies).reduce(function(e,t){e.push.apply(e,(0,I.default)(Array.from(t.rows)));return e},[])),(0,I.default)(c));m=b.length;var w=new Array(m);for(var C=0;C<m;C++){w[C]=new Array(f)}var S=[];var E=[];for(var k=0;k<m;k++){var T=b[k];var _=Array.from(T.cells);var x=_.length;var D=function e(t){var n=_[t];var r=n.nodeName,i=n.innerHTML,a=n.rowSpan,o=n.colSpan;var s=w[k].findIndex(function(e){return e===void 0});if(r==="TD"){if(a>1||o>1){for(var l=k;l<k+a;l++){if(l<m){for(var u=s;u<s+o;u++){w[l][u]=null}}}var f=n.getAttribute("style");var c=f&&f.includes("mso-ignore:colspan");if(!c){S.push({col:s,row:k,rowspan:a,colspan:o})}}var d=v.reduce(function(e,t){if((0,O.matchesCSSRules)(n,t)){var r=t.style.whiteSpace;if(r){e.whiteSpace=r}}return e},{});var h="";if(d.whiteSpace==="nowrap"){h=i.replace(/[\r\n][\x20]{0,2}/gim," ").replace(/<br(\s*|\/)>/gim,"\r\n")}else if(p&&/excel/gi.test(p.content)){h=i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n")}else{h=i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n")}w[k][s]=h.replace(N,function(e){return A[e]})}else{E.push(i)}};for(var R=0;R<x;R++){D(R)}}if(S.length){r.mergeCells=S}if(E.length){r.rowHeaders=E}if(w.length){r.data=w}return r}},function(e,t,r){"use strict";var n=r(0);r(96);r(143);r(97);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var f=r(8);var c=r(4);var o=function(){function t(e){(0,i.default)(this,t);this.hot=e;this.container=null;this.injected=false;this.rows=[];this.columns=[];this.samples=null;this.settings={useHeaders:true}}(0,a.default)(t,[{key:"addRow",value:function e(t,r){if(this.columns.length){throw new Error("Doesn't support multi-dimensional table")}if(!this.rows.length){this.container=this.createContainer(this.hot.rootElement.className)}var n={row:t};this.rows.push(n);this.samples=r;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tr.appendChild(this.createRow(t));this.container.container.appendChild(this.table.fragment);n.table=this.table.table}},{key:"addColumnHeadersRow",value:function e(t){var r=this.hot.getColHeader(0);if(r!==null&&r!==void 0){var n={row:-1};this.rows.push(n);this.container=this.createContainer(this.hot.rootElement.className);this.samples=t;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tHead.appendChild(this.createColumnHeadersRow());this.container.container.appendChild(this.table.fragment);n.table=this.table.table}}},{key:"addColumn",value:function e(t,r){if(this.rows.length){throw new Error("Doesn't support multi-dimensional table")}if(!this.columns.length){this.container=this.createContainer(this.hot.rootElement.className)}var n={col:t};this.columns.push(n);this.samples=r;this.table=this.createTable(this.hot.table.className);if(this.getSetting("useHeaders")&&this.hot.getColHeader(t)!==null){this.hot.view.appendColHeader(t,this.table.th)}this.table.tBody.appendChild(this.createCol(t));this.container.container.appendChild(this.table.fragment);n.table=this.table.table}},{key:"getHeights",value:function e(t){if(!this.injected){this.injectTable()}(0,c.arrayEach)(this.rows,function(e){t(e.row,(0,f.outerHeight)(e.table)-1)})}},{key:"getWidths",value:function e(t){if(!this.injected){this.injectTable()}(0,c.arrayEach)(this.columns,function(e){t(e.col,(0,f.outerWidth)(e.table))})}},{key:"setSettings",value:function e(t){this.settings=t}},{key:"setSetting",value:function e(t,r){if(!this.settings){this.settings={}}this.settings[t]=r}},{key:"getSettings",value:function e(){return this.settings}},{key:"getSetting",value:function e(t){if(this.settings){return this.settings[t]}return null}},{key:"createColGroupsCol",value:function e(){var t=this;var r=this.hot.rootDocument.createDocumentFragment();if(this.hot.hasRowHeaders()){r.appendChild(this.createColElement(-1))}this.samples.forEach(function(e){(0,c.arrayEach)(e.strings,function(e){r.appendChild(t.createColElement(e.col))})});return r}},{key:"createRow",value:function e(a){var o=this;var s=this.hot.rootDocument;var l=s.createDocumentFragment();var t=s.createElement("th");if(this.hot.hasRowHeaders()){this.hot.view.appendRowHeader(a,t);l.appendChild(t)}this.samples.forEach(function(e){(0,c.arrayEach)(e.strings,function(e){var t=e.col;var r=o.hot.getCellMeta(a,t);r.col=t;r.row=a;var n=o.hot.getCellRenderer(r);var i=s.createElement("td");i.setAttribute("ghost-table",1);n(o.hot,i,a,t,o.hot.colToProp(t),e.value,r);l.appendChild(i)})});return l}},{key:"createColumnHeadersRow",value:function e(){var n=this;var i=this.hot.rootDocument;var a=i.createDocumentFragment();if(this.hot.hasRowHeaders()){var t=i.createElement("th");this.hot.view.appendColHeader(-1,t);a.appendChild(t)}this.samples.forEach(function(e){(0,c.arrayEach)(e.strings,function(e){var t=e.col;var r=i.createElement("th");n.hot.view.appendColHeader(t,r);a.appendChild(r)})});return a}},{key:"createCol",value:function e(o){var s=this;var l=this.hot.rootDocument;var u=l.createDocumentFragment();this.samples.forEach(function(e){(0,c.arrayEach)(e.strings,function(e){var t=e.row;var r=s.hot.getCellMeta(t,o);r.col=o;r.row=t;var n=s.hot.getCellRenderer(r);var i=l.createElement("td");var a=l.createElement("tr");i.setAttribute("ghost-table",1);n(s.hot,i,t,o,s.hot.colToProp(o),e.value,r);a.appendChild(i);u.appendChild(a)})});return u}},{key:"clean",value:function e(){this.rows.length=0;this.rows[-1]=void 0;this.columns.length=0;if(this.samples){this.samples.clear()}this.samples=null;this.removeTable()}},{key:"injectTable",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.injected){(t||this.hot.rootElement).appendChild(this.container.fragment);this.injected=true}}},{key:"removeTable",value:function e(){if(this.injected&&this.container.container.parentNode){this.container.container.parentNode.removeChild(this.container.container);this.container=null;this.injected=false}}},{key:"createColElement",value:function e(t){var r=this.hot.rootDocument.createElement("col");r.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(t),"px");return r}},{key:"createTable",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=this.hot.rootDocument;var n=r.createDocumentFragment();var i=r.createElement("table");var a=r.createElement("thead");var o=r.createElement("tbody");var s=r.createElement("colgroup");var l=r.createElement("tr");var u=r.createElement("th");if(this.isVertical()){i.appendChild(s)}if(this.isHorizontal()){l.appendChild(u);a.appendChild(l);i.style.tableLayout="auto";i.style.width="auto"}i.appendChild(a);if(this.isVertical()){o.appendChild(l)}i.appendChild(o);(0,f.addClass)(i,t);n.appendChild(i);return{fragment:n,table:i,tHead:a,tBody:o,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=this.hot.rootDocument;var n=r.createDocumentFragment();var i=r.createElement("div");var a="htGhostTable htAutoSize ".concat(t.trim());(0,f.addClass)(i,a);n.appendChild(i);return{fragment:n,container:i}}},{key:"isVertical",value:function e(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function e(){return!!(this.columns.length&&!this.rows.length)}}]);return t}();var s=o;t.default=s},function(e,t,r){"use strict";r(100);r(60);r(31);r(12);r(15);r(148);r(86);r(87);r(10);r(88);r(13);r(16);t.__esModule=true;t.areValidSortStates=f;t.getNextSortOrder=c;t.getHeaderSpanElement=d;t.isFirstLevelColumnHeader=h;t.wasHeaderClickedProperly=v;t.HEADER_SPAN_CLASS=t.DESC_SORT_STATE=t.ASC_SORT_STATE=void 0;var n=r(29);var i=r(3);var a=r(32);var o="asc";t.ASC_SORT_STATE=o;var s="desc";t.DESC_SORT_STATE=s;var l="colHeader";t.HEADER_SPAN_CLASS=l;function u(e){if((0,n.isUndefined)(e)){return false}var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[o,s].includes(r)}function f(e){if(Array.isArray(e)===false||e.every(function(e){return(0,i.isObject)(e)})===false){return false}var t=e.map(function(e){var t=e.column;return t});var r=new Set(t).size===t.length;return r&&e.every(u)}function c(e){if(e===s){return}else if(e===o){return s}return o}function d(e){var t=e.querySelector(".".concat(l));return t}function h(e,t){if(e<0||!t.parentNode){return false}var r=t.parentNode.parentNode.childNodes;var n=Array.from(r).indexOf(t.parentNode)-r.length;if(n!==-1){return false}return true}function v(e,t,r){return e===-1&&t>=0&&(0,a.isRightClick)(r)===false}},function(e,t,r){"use strict";t.__esModule=true;t.default=i;t.KEY=void 0;var n="---------";t.KEY=n;function i(){return{name:n}}},function(e,t,r){"use strict";var n=r(0);r(19);r(56);r(65);r(10);r(119);r(23);r(38);r(40);t.__esModule=true;t.default=void 0;var i=n(r(1));var o=n(r(2));var l=n(r(181));var p=r(8);var u=r(4);var s=n(r(560));var f=n(r(25));var g=r(3);var c=r(29);var d=r(77);var h=r(66);var v=r(55);var a=n(r(62));var m=r(89);var y=r(32);var b=r(71);var w=215;var C=function(){function a(e,t){(0,i.default)(this,a);this.hot=e;this.options=t||{parent:null,name:null,className:"",keepInViewport:true,standalone:false,minWidth:w,container:this.hot.rootDocument.documentElement};this.eventManager=new f.default(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.menuItems=null;this.origOutsideClickDeselects=null;this.keyEvent=false;this.offset={above:0,below:0,left:0,right:0};this._afterScrollCallback=null;this.registerEvents()}(0,o.default)(a,[{key:"registerEvents",value:function e(){var t=this;var r=this.hot.rootWindow;while(r){this.eventManager.addEventListener(r.document,"mousedown",function(e){return t.onDocumentMouseDown(e)});r=(0,p.getParentWindow)(r)}}},{key:"setMenuItems",value:function e(t){this.menuItems=t}},{key:"getSelectedItem",value:function e(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function e(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;this.offset[t]=r}},{key:"isSubMenu",value:function e(){return this.parentMenu!==null}},{key:"open",value:function e(){var s=this;this.runLocalHooks("beforeOpen");this.container.removeAttribute("style");this.container.style.display="block";var n=(0,d.debounce)(function(e){return s.openSubMenu(e)},300);var r=this.options.minWidth||w;var t=false;var i=(0,u.arrayFilter)(this.menuItems,function(e){if(e.key===m.NO_ITEMS){t=true}return(0,h.isItemHidden)(e,s.hot)});if(i.length<1&&!t){i.push((0,m.predefinedItems)()[m.NO_ITEMS])}else if(i.length===0){return}i=(0,h.filterSeparators)(i,m.SEPARATOR);var a=false;var o={data:i,colHeaders:false,autoColumnSize:true,autoWrapRow:false,modifyColWidth:function e(t){if((0,c.isDefined)(t)&&t<r){return r}return t},autoRowSize:false,readOnly:true,editor:false,copyPaste:false,columns:[{data:"name",renderer:function e(t,r,n,i,a,o){return s.menuItemRenderer(t,r,n,i,a,o)}}],renderAllRows:true,fragmentSelection:false,outsideClickDeselects:false,disableVisualSelection:"area",beforeKeyDown:function e(t){return s.onBeforeKeyDown(t)},afterOnCellMouseOver:function e(t,r){if(s.isAllSubMenusClosed()){n(r.row)}else{s.openSubMenu(r.row)}},rowHeights:function e(t){return i[t].name===m.SEPARATOR?1:23},afterOnCellContextMenu:function e(t){t.preventDefault();if((0,b.isWindowsOS)()&&a&&s.hasSelectedItem()){s.close(true)}},beforeOnCellMouseUp:function e(t){if(s.hasSelectedItem()){a=!s.isCommandPassive(s.getSelectedItem());s.executeCommand(t)}},afterOnCellMouseUp:function e(t){if((!(0,b.isWindowsOS)()||!(0,y.isRightClick)(t))&&a&&s.hasSelectedItem()){s.close(true)}},afterUnlisten:function e(){if(!s.hasSelectedItem()&&s.isOpened()){s.hotMenu.listen(false)}}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=false;this.hotMenu=new l.default(this.container,o);this.hotMenu.addHook("afterInit",function(){return s.onAfterInit()});this.hotMenu.addHook("afterSelection",function(){return s.onAfterSelection.apply(s,arguments)});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks("afterOpen")}},{key:"close",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.isOpened()){return}if(t&&this.parentMenu){this.parentMenu.close()}else{this.closeAllSubMenus();this.container.style.display="none";this.releaseMainTableCallbacks();this.hotMenu.destroy();this.hotMenu=null;this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects;this.runLocalHooks("afterClose");if(this.parentMenu){this.parentMenu.hotMenu.listen()}}}},{key:"openSubMenu",value:function e(t){if(!this.hotMenu){return false}var r=this.hotMenu.getCell(t,0);this.closeAllSubMenus();if(!r||!(0,h.hasSubMenu)(r)){return false}var n=this.hotMenu.getSourceDataAtRow(t);var i=new a(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:true,container:this.options.container});i.setMenuItems(n.submenu.items);i.open();i.setPosition(r.getBoundingClientRect());this.hotSubMenus[n.key]=i;return i}},{key:"closeSubMenu",value:function e(t){var r=this.hotMenu.getSourceDataAtRow(t);var n=this.hotSubMenus[r.key];if(n){n.destroy();delete this.hotSubMenus[r.key]}}},{key:"closeAllSubMenus",value:function e(){var r=this;(0,u.arrayEach)(this.hotMenu.getData(),function(e,t){return r.closeSubMenu(t)})}},{key:"isAllSubMenusClosed",value:function e(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function e(){var t=this.container.parentNode;this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy();if(t){t.removeChild(this.container)}}},{key:"isOpened",value:function e(){return this.hotMenu!==null}},{key:"executeCommand",value:function e(t){if(!this.isOpened()||!this.hasSelectedItem()){return}var r=this.getSelectedItem();this.runLocalHooks("select",r,t);if(this.isCommandPassive(r)){return}var n=this.hot.getSelectedRange();var i=n?(0,h.normalizeSelection)(n):[];this.runLocalHooks("executeCommand",r.key,i,t);if(this.isSubMenu()){this.parentMenu.runLocalHooks("executeCommand",r.key,i,t)}}},{key:"isCommandPassive",value:function e(t){var r=t.isCommand,n=t.name,i=t.disabled,a=t.submenu;var o=i===true||typeof i==="function"&&i.call(this.hot)===true;return r===false||n===m.SEPARATOR||o===true||a}},{key:"setPosition",value:function e(t){var r=new s.default(t,this.container.ownerDocument.defaultView);if(this.options.keepInViewport){if(r.fitsBelow(this.container)){this.setPositionBelowCursor(r)}else if(r.fitsAbove(this.container)){this.setPositionAboveCursor(r)}else{this.setPositionBelowCursor(r)}if(r.fitsOnRight(this.container)){this.setPositionOnRightOfCursor(r)}else{this.setPositionOnLeftOfCursor(r)}}else{this.setPositionBelowCursor(r);this.setPositionOnRightOfCursor(r)}}},{key:"setPositionAboveCursor",value:function e(t){var r=this.offset.above+t.top-this.container.offsetHeight;if(this.isSubMenu()){r=t.top+t.cellHeight-this.container.offsetHeight+3}this.container.style.top="".concat(r,"px")}},{key:"setPositionBelowCursor",value:function e(t){var r=this.offset.below+t.top;if(this.isSubMenu()){r=t.top-1}this.container.style.top="".concat(r,"px")}},{key:"setPositionOnRightOfCursor",value:function e(t){var r;if(this.isSubMenu()){r=1+t.left+t.cellWidth}else{r=this.offset.right+1+t.left}this.container.style.left="".concat(r,"px")}},{key:"setPositionOnLeftOfCursor",value:function e(t){var r=this.offset.left+t.left-this.container.offsetWidth+(0,p.getScrollbarWidth)(this.hot.rootDocument)+4;this.container.style.left="".concat(r,"px")}},{key:"selectFirstCell",value:function e(){var t=this.hotMenu.getCell(0,0);if((0,h.isSeparator)(t)||(0,h.isDisabled)(t)||(0,h.isSelectionDisabled)(t)){this.selectNextCell(0,0)}else{this.hotMenu.selectCell(0,0)}}},{key:"selectLastCell",value:function e(){var t=this.hotMenu.countRows()-1;var r=this.hotMenu.getCell(t,0);if((0,h.isSeparator)(r)||(0,h.isDisabled)(r)||(0,h.isSelectionDisabled)(r)){this.selectPrevCell(t,0)}else{this.hotMenu.selectCell(t,0)}}},{key:"selectNextCell",value:function e(t,r){var n=t+1;var i=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,r):null;if(!i){return}if((0,h.isSeparator)(i)||(0,h.isDisabled)(i)||(0,h.isSelectionDisabled)(i)){this.selectNextCell(n,r)}else{this.hotMenu.selectCell(n,r)}}},{key:"selectPrevCell",value:function e(t,r){var n=t-1;var i=n>=0?this.hotMenu.getCell(n,r):null;if(!i){return}if((0,h.isSeparator)(i)||(0,h.isDisabled)(i)||(0,h.isSelectionDisabled)(i)){this.selectPrevCell(n,r)}else{this.hotMenu.selectCell(n,r)}}},{key:"menuItemRenderer",value:function e(t,r,n,i,a,o){var s=this;var l=t.getSourceDataAtRow(n);var u=this.hot.rootDocument.createElement("div");var f=function e(t){return(0,g.hasOwnProperty)(t,"submenu")};var c=function e(t){return new RegExp(m.SEPARATOR,"i").test(t.name)};var d=function e(t){return t.disabled===true||typeof t.disabled==="function"&&t.disabled.call(s.hot)===true};var h=function e(t){return t.disableSelection};var v=o;if(typeof v==="function"){v=v.call(this.hot)}(0,p.empty)(r);(0,p.addClass)(u,"htItemWrapper");r.appendChild(u);if(c(l)){(0,p.addClass)(r,"htSeparator")}else if(typeof l.renderer==="function"){(0,p.addClass)(r,"htCustomMenuRenderer");r.appendChild(l.renderer(t,u,n,i,a,v))}else{(0,p.fastInnerHTML)(u,v)}if(d(l)){(0,p.addClass)(r,"htDisabled");this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()})}else if(h(l)){(0,p.addClass)(r,"htSelectionDisabled");this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()})}else if(f(l)){(0,p.addClass)(r,"htSubmenu");if(h(l)){this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()})}else{this.eventManager.addEventListener(r,"mouseenter",function(){return t.selectCell(n,i,void 0,void 0,false,false)})}}else{(0,p.removeClass)(r,["htSubmenu","htDisabled"]);if(h(l)){this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()})}else{this.eventManager.addEventListener(r,"mouseenter",function(){return t.selectCell(n,i,void 0,void 0,false,false)})}}}},{key:"createContainer",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var r=this.options.container.ownerDocument;var n=t;var i;if(n){if((0,d.isFunction)(n)){n=n.call(this.hot);if(n===null||(0,c.isUndefined)(n)){n=""}else{n=n.toString()}}n=n.replace(/[^A-z0-9]/g,"_");n="".concat(this.options.className,"Sub_").concat(n);i=r.querySelector(".".concat(this.options.className,".").concat(n))}if(!i){i=r.createElement("div");(0,p.addClass)(i,"htMenu ".concat(this.options.className));if(n){(0,p.addClass)(i,n)}this.options.container.appendChild(i)}return i}},{key:"blockMainTableCallbacks",value:function e(){this._afterScrollCallback=function(){};this.hot.addHook("afterScrollVertically",this._afterScrollCallback);this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function e(){if(this._afterScrollCallback){this.hot.removeHook("afterScrollVertically",this._afterScrollCallback);this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback);this._afterScrollCallback=null}}},{key:"onBeforeKeyDown",value:function e(t){if((0,p.isInput)(t.target)&&this.container.contains(t.target)){(0,y.stopImmediatePropagation)(t);return}var r=this.hotMenu.getSelectedLast();var n=false;this.keyEvent=true;switch(t.keyCode){case v.KEY_CODES.ESCAPE:this.close();n=true;break;case v.KEY_CODES.ENTER:if(r){if(this.hotMenu.getSourceDataAtRow(r[0]).submenu){n=true}else{this.executeCommand(t);this.close(true)}}break;case v.KEY_CODES.ARROW_DOWN:if(r){this.selectNextCell(r[0],r[1])}else{this.selectFirstCell()}n=true;break;case v.KEY_CODES.ARROW_UP:if(r){this.selectPrevCell(r[0],r[1])}else{this.selectLastCell()}n=true;break;case v.KEY_CODES.ARROW_RIGHT:if(r){var i=this.openSubMenu(r[0]);if(i){i.selectFirstCell()}}n=true;break;case v.KEY_CODES.ARROW_LEFT:if(r&&this.isSubMenu()){this.close();if(this.parentMenu){this.parentMenu.hotMenu.listen()}n=true}break;default:break}if(n){t.preventDefault();(0,y.stopImmediatePropagation)(t)}this.keyEvent=false}},{key:"onAfterInit",value:function e(){var t=this.hotMenu.view.wt.wtTable;var r=this.hotMenu.getSettings().data;var n=t.hider.style;var i=t.holder.style;var a=parseInt(n.width,10);var o=(0,u.arrayReduce)(r,function(e,t){return e+(t.name===m.SEPARATOR?1:26)},0);i.width="".concat(a+22,"px");i.height="".concat(o+4,"px");n.height=i.height}},{key:"onAfterSelection",value:function e(t,r,n,i,a){if(this.keyEvent===false){a.value=true}}},{key:"onDocumentMouseDown",value:function e(t){if(!this.isOpened()){return}if(this.options.standalone&&this.hotMenu&&!(0,p.isChildOf)(t.target,this.hotMenu.rootElement)){this.close(true)}else if((this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,p.isChildOf)(t.target,".htMenu")&&((0,p.isChildOf)(t.target,this.container.ownerDocument)||(0,p.isChildOf)(t.target,this.hot.rootDocument))){this.close(true)}}}]);return a}();(0,g.mixin)(C,a.default);var S=C;t.default=S},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(72));var a=n(r(1));var o=n(r(2));var s=r(27);var l=r(73);function u(){var t=(0,i.default)(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.']);u=function e(){return t};return t}function f(){var t=(0,i.default)(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']);f=function e(){return t};return t}function c(){var t=(0,i.default)(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]);c=function e(){return t};return t}function d(){var t=(0,i.default)(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]);d=function e(){return t};return t}var h=function(){function i(e,t,r,n){(0,a.default)(this,i);this.row=e;this.col=t;this.rowspan=r;this.colspan=n;this.removed=false}(0,o.default)(i,[{key:"normalize",value:function e(t){var r=t.countRows();var n=t.countCols();if(this.row<0){this.row=0}else if(this.row>r-1){this.row=r-1}if(this.col<0){this.col=0}else if(this.col>n-1){this.col=n-1}if(this.row+this.rowspan>r-1){this.rowspan=r-this.row}if(this.col+this.colspan>n-1){this.colspan=n-this.col}}},{key:"includes",value:function e(t,r){return this.row<=t&&this.col<=r&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=r}},{key:"includesHorizontally",value:function e(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function e(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function e(t,r){var n=t[0]||t[1];var i=r+Math.abs(t[0]||t[1])-1;var a=t[0]?"colspan":"rowspan";var o=t[0]?"col":"row";var s=Math.min(r,i);var l=Math.max(r,i);var u=this[o];var f=this[o]+this[a]-1;if(u>=r){this[o]+=n}if(n>0){if(r<=f&&r>u){this[a]+=n}}else if(n<0){if(s<=u&&l>=f){this.removed=true;return false}else if(u>=s&&u<=l){var c=l-u+1;var d=Math.abs(n)-c;this[o]-=d+n;this[a]-=c}else if(u<=s&&f>=l){this[a]+=n}else if(u<=s&&f>=s&&f<l){var h=f-s+1;this[a]-=h}}return true}},{key:"isFarther",value:function e(t,r){if(!t){return true}if(r==="down"){return t.row+t.rowspan-1<this.row+this.rowspan-1}else if(r==="up"){return t.row>this.row}else if(r==="right"){return t.col+t.colspan-1<this.col+this.colspan-1}else if(r==="left"){return t.col>this.col}return null}},{key:"getLastRow",value:function e(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function e(){return this.col+this.colspan-1}},{key:"getRange",value:function e(){return new s.CellRange(new s.CellCoords(this.row,this.col),new s.CellCoords(this.row,this.col),new s.CellCoords(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function e(t){return(0,l.toSingleLine)(d(),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function e(t){return(0,l.toSingleLine)(c(),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function e(t){return(0,l.toSingleLine)(f(),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function e(t){return(0,l.toSingleLine)(u(),t.row,t.col)}},{key:"containsNegativeValues",value:function e(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function e(t){return t.colspan===1&&t.rowspan===1}},{key:"containsZeroSpan",value:function e(t){return t.colspan===0||t.rowspan===0}},{key:"isOutOfBounds",value:function e(t,r,n){return t.row<0||t.col<0||t.row>=r||t.row+t.rowspan-1>=r||t.col>=n||t.col+t.colspan-1>=n}}]);return i}();var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=$;t.TYPES=t.TYPE_DATE=t.TYPE_TEXT=t.TYPE_NUMERIC=void 0;var i=n(r(70));var a=r(3);var o=r(4);var s=r(89);var l=r(30);var u=r(633);t.CONDITION_NONE=u.CONDITION_NAME;var f=r(404);t.CONDITION_EMPTY=f.CONDITION_NAME;var c=r(634);t.CONDITION_NOT_EMPTY=c.CONDITION_NAME;var d=r(405);t.CONDITION_EQUAL=d.CONDITION_NAME;var h=r(635);t.CONDITION_NOT_EQUAL=h.CONDITION_NAME;var v=r(636);t.CONDITION_GREATER_THAN=v.CONDITION_NAME;var p=r(637);t.CONDITION_GREATER_THAN_OR_EQUAL=p.CONDITION_NAME;var g=r(638);t.CONDITION_LESS_THAN=g.CONDITION_NAME;var m=r(639);t.CONDITION_LESS_THAN_OR_EQUAL=m.CONDITION_NAME;var y=r(406);t.CONDITION_BETWEEN=y.CONDITION_NAME;var b=r(640);t.CONDITION_NOT_BETWEEN=b.CONDITION_NAME;var w=r(641);t.CONDITION_BEGINS_WITH=w.CONDITION_NAME;var C=r(642);t.CONDITION_ENDS_WITH=C.CONDITION_NAME;var S=r(409);t.CONDITION_CONTAINS=S.CONDITION_NAME;var E=r(644);t.CONDITION_NOT_CONTAINS=E.CONDITION_NAME;var k=r(408);t.CONDITION_DATE_BEFORE=k.CONDITION_NAME;var T=r(407);t.CONDITION_DATE_AFTER=T.CONDITION_NAME;var _=r(645);t.CONDITION_TOMORROW=_.CONDITION_NAME;var x=r(646);t.CONDITION_TODAY=x.CONDITION_NAME;var D=r(647);t.CONDITION_YESTERDAY=D.CONDITION_NAME;var R=r(648);t.CONDITION_BY_VALUE=R.CONDITION_NAME;var I=r(649);t.CONDITION_TRUE=I.CONDITION_NAME;var O=r(650);t.CONDITION_FALSE=O.CONDITION_NAME;var A=r(190);t.OPERATION_AND=A.OPERATION_ID;var N=r(410);t.OPERATION_OR=N.OPERATION_ID;var M=r(411);t.OPERATION_OR_THEN_VARIABLE=M.OPERATION_ID;var L;var P="numeric";t.TYPE_NUMERIC=P;var F="text";t.TYPE_TEXT=F;var B="date";t.TYPE_DATE=B;var H=(L={},(0,i.default)(L,P,[u.CONDITION_NAME,s.SEPARATOR,f.CONDITION_NAME,c.CONDITION_NAME,s.SEPARATOR,d.CONDITION_NAME,h.CONDITION_NAME,s.SEPARATOR,v.CONDITION_NAME,p.CONDITION_NAME,g.CONDITION_NAME,m.CONDITION_NAME,y.CONDITION_NAME,b.CONDITION_NAME]),(0,i.default)(L,F,[u.CONDITION_NAME,s.SEPARATOR,f.CONDITION_NAME,c.CONDITION_NAME,s.SEPARATOR,d.CONDITION_NAME,h.CONDITION_NAME,s.SEPARATOR,w.CONDITION_NAME,C.CONDITION_NAME,s.SEPARATOR,S.CONDITION_NAME,E.CONDITION_NAME]),(0,i.default)(L,B,[u.CONDITION_NAME,s.SEPARATOR,f.CONDITION_NAME,c.CONDITION_NAME,s.SEPARATOR,d.CONDITION_NAME,h.CONDITION_NAME,s.SEPARATOR,k.CONDITION_NAME,T.CONDITION_NAME,y.CONDITION_NAME,s.SEPARATOR,_.CONDITION_NAME,x.CONDITION_NAME,D.CONDITION_NAME]),L);t.TYPES=H;function $(e){var r=[];var t=e;if(!H[t]){t=F}(0,o.arrayEach)(H[t],function(e){var t;if(e===s.SEPARATOR){t={name:s.SEPARATOR}}else{t=(0,a.clone)((0,l.getConditionDescriptor)(e))}r.push(t)});return r}},function(e,t,r){"use strict";var n=r(9);r(100);t.__esModule=true;t.operationResult=l;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=void 0;var i=n(r(11));var a=r(126);var o="conjunction";t.OPERATION_ID=o;var s=i.FILTERS_LABELS_CONJUNCTION;t.SHORT_NAME_FOR_COMPONENT=s;function l(e,t){return e.every(function(e){return e.func(t)})}(0,a.registerOperation)(o,s,l)},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(28));var s=n(r(5));var l=n(r(14));var u=n(r(2));var f=n(r(7));var c=r(8);var d=r(3);var h=n(r(127));var v=new WeakMap;var p=function(e){(0,f.default)(n,e);(0,u.default)(n,null,[{key:"DEFAULTS",get:function e(){return(0,d.clone)({placeholder:"",type:"text",tagName:"input"})}}]);function n(e,t){var r;(0,i.default)(this,n);r=(0,a.default)(this,(0,s.default)(n).call(this,e,(0,d.extend)(n.DEFAULTS,t)));v.set((0,o.default)(r),{});r.registerHooks();return r}(0,u.default)(n,[{key:"registerHooks",value:function e(){var t=this;this.addLocalHook("click",function(){return t.onClick()});this.addLocalHook("keyup",function(e){return t.onKeyup(e)})}},{key:"build",value:function e(){(0,l.default)((0,s.default)(n.prototype),"build",this).call(this);var t=v.get(this);var r=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild;(0,c.addClass)(this._element,"htUIInput");(0,c.addClass)(r,"htUIInputIcon");this._element.appendChild(r);this.update()}},{key:"update",value:function e(){if(!this.isBuilt()){return}var t=v.get(this).input;t.type=this.options.type;t.placeholder=this.translateIfPossible(this.options.placeholder);t.value=this.translateIfPossible(this.options.value)}},{key:"focus",value:function e(){if(this.isBuilt()){v.get(this).input.focus()}}},{key:"onClick",value:function e(){}},{key:"onKeyup",value:function e(t){this.options.value=t.target.value}}]);return n}(h.default);var g=p;t.default=g},function(e,t,r){"use strict";r(19);r(56);r(10);r(38);t.__esModule=true;t.getMixedMonthObject=a;t.getMixedMonthName=o;t.getShorthand=s;t.getStartDate=l;t.getEndDate=u;t.getAdditionalData=f;t.setStartDate=c;t.setEndDate=d;t.parseDate=h;t.getDateYear=v;t.WEEK_LENGTH=t.DEC_LENGTH=void 0;var n=31;t.DEC_LENGTH=n;var i=7;t.WEEK_LENGTH=i;function a(e,t){return{name:e,days:i,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:t}}function o(e,t){var r=null;var n=s(t[e].name);var i=e>0?s(t[e-1].name):null;var a=s(t[0].name);var o=s(t[t.length-1].name);if(e>0){r="".concat(i,"/").concat(n)}else if(e===t.length-1){r="".concat(n,"/").concat(a)}else{r="".concat(o,"/").concat(n)}return r}function s(e){var t=3;return e.substring(0,t)}function l(e){return h(Array.isArray(e)?e[1]:e.startDate)}function u(e){return h(Array.isArray(e)?e[2]:e.endDate)}function f(e){return Array.isArray(e)?e[3]:e.additionalData}function c(e,t){if(Array.isArray(e)){e[1]=t}else{e.startDate=t}}function d(e,t){if(Array.isArray(e)){e[2]=t}else{e.endDate=t}}function h(e){var t=e;if(t===null){return null}if(!(t instanceof Date)){t=new Date(t);if(t.toString()==="Invalid Date"){return null}}return t}function v(e){var t=h(e);return t?t.getFullYear():null}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=function e(t,r){(0,i.default)(this,e);this.hot=r;this.plugin=t};var o=a;t.default=o},function(e,t,r){var n=r(44);var i=r(26);var a=r(155);e.exports=!n&&!i(function(){return Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a!=7})},function(e,t,r){var n=r(196);var i=Function.toString;if(typeof n.inspectSource!="function"){n.inspectSource=function(e){return i.call(e)}}e.exports=n.inspectSource},function(e,t,r){var n=r(35);var i=r(156);var a="__core-js_shared__";var o=n[a]||i(a,{});e.exports=o},function(e,t,r){var n=r(35);var i=r(195);var a=n.WeakMap;e.exports=typeof a==="function"&&/native code/.test(i(a))},function(e,t,r){var s=r(47);var l=r(199);var u=r(79);var f=r(51);e.exports=function(e,t){var r=l(t);var n=f.f;var i=u.f;for(var a=0;a<r.length;a++){var o=r[a];if(!s(e,o))n(e,o,i(t,o))}}},function(e,t,r){var n=r(107);var i=r(108);var a=r(160);var o=r(48);e.exports=n("Reflect","ownKeys")||function e(t){var r=i.f(o(t));var n=a.f;return n?r.concat(n(t)):r}},function(e,t,r){var n=r(35);e.exports=n},function(e,t,r){var o=r(47);var s=r(63);var l=r(158).indexOf;var u=r(106);e.exports=function(e,t){var r=s(e);var n=0;var i=[];var a;for(a in r)!o(u,a)&&o(r,a)&&i.push(a);while(t.length>n)if(o(r,a=t[n++])){~l(i,a)||i.push(a)}return i}},function(e,t,r){var n=r(63);var i=r(108).f;var a={}.toString;var o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var s=function(e){try{return i(e)}catch(e){return o.slice()}};e.exports.f=function e(t){return o&&a.call(t)=="[object Window]"?s(t):i(n(t))}},function(e,t,r){var n=r(161);e.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(e,t,r){var n=r(107);e.exports=n("document","documentElement")},function(e,t,r){"use strict";var n=r(163);var i=r(67);var a=r(47);var o=r(36);var s=r(94);var l=o("iterator");var u=false;var f=function(){return this};var c,d,h;if([].keys){h=[].keys();if(!("next"in h))u=true;else{d=n(n(h));if(d!==Object.prototype)c=d}}if(c==undefined)c={};if(!s&&!a(c,l)){i(c,l,f)}e.exports={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u}},function(e,t,r){var n=r(26);e.exports=!n(function(){function e(){}e.prototype.constructor=null;return Object.getPrototypeOf(new e)!==e.prototype})},function(e,t,r){var a=r(48);var o=r(423);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n=false;var e={};var i;try{i=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;i.call(e,[]);n=e instanceof Array}catch(e){}return function e(t,r){a(t);o(r);if(n)i.call(t,r);else t.__proto__=r;return t}}():undefined)},function(e,t,r){var n=r(164);var i=r(80);var a=r(36);var o=a("toStringTag");var s=i(function(){return arguments}())=="Arguments";var l=function(e,t){try{return e[t]}catch(e){}};e.exports=n?i:function(e){var t,r,n;return e===undefined?"Undefined":e===null?"Null":typeof(r=l(t=Object(e),o))=="string"?r:s?i(t):(n=i(t))=="Object"&&typeof t.callee=="function"?"Arguments":n}},function(e,t,r){var n=r(36);var i=r(112);var a=n("iterator");var o=Array.prototype;e.exports=function(e){return e!==undefined&&(i.Array===e||o[a]===e)}},function(e,t,r){var n=r(208);var i=r(112);var a=r(36);var o=a("iterator");e.exports=function(e){if(e!=undefined)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){var a=r(48);e.exports=function(t,e,r,n){try{return n?e(a(r)[0],r[1]):e(r)}catch(e){var i=t["return"];if(i!==undefined)a(i.call(t));throw e}}},function(e,t,r){var n=r(36);var i=n("iterator");var a=false;try{var o=0;var s={next:function(){return{done:!!o++}},return:function(){a=true}};s[i]=function(){return this};Array.from(s,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return false;var r=false;try{var n={};n[i]=function(){return{next:function(){return{done:r=true}}}};e(n)}catch(e){}return r}},function(e,t,r){"use strict";var l=r(166);var u=r(136).getWeakData;var f=r(48);var c=r(45);var d=r(168);var h=r(167);var n=r(75);var v=r(47);var i=r(81);var p=i.set;var g=i.getterFor;var a=n.find;var o=n.findIndex;var m=0;var y=function(e){return e.frozen||(e.frozen=new s)};var s=function(){this.entries=[]};var b=function(e,t){return a(e.entries,function(e){return e[0]===t})};s.prototype={get:function(e){var t=b(this,e);if(t)return t[1]},has:function(e){return!!b(this,e)},set:function(e,t){var r=b(this,e);if(r)r[1]=t;else this.entries.push([e,t])},delete:function(t){var e=o(this.entries,function(e){return e[0]===t});if(~e)this.entries.splice(e,1);return!!~e}};e.exports={getConstructor:function(e,r,n,i){var a=e(function(e,t){d(e,a,r);p(e,{type:r,id:m++,frozen:undefined});if(t!=undefined)h(t,e[i],e,n)});var o=g(r);var s=function(e,t,r){var n=o(e);var i=u(f(t),true);if(i===true)y(n).set(t,r);else i[n.id]=r;return e};l(a.prototype,{delete:function(e){var t=o(this);if(!c(e))return false;var r=u(e);if(r===true)return y(t)["delete"](e);return r&&v(r,t.id)&&delete r[t.id]},has:function e(t){var r=o(this);if(!c(t))return false;var n=u(t);if(n===true)return y(r).has(t);return n&&v(n,r.id)}});l(a.prototype,n?{get:function e(t){var r=o(this);if(c(t)){var n=u(t);if(n===true)return y(r).get(t);return n?n[r.id]:undefined}},set:function e(t,r){return s(this,t,r)}}:{add:function e(t){return s(this,t,true)}});return a}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,r){"use strict";var u=r(51).f;var f=r(110);var c=r(166);var d=r(113);var h=r(168);var v=r(167);var o=r(162);var s=r(216);var p=r(44);var g=r(136).fastKey;var n=r(81);var m=n.set;var y=n.getterFor;e.exports={getConstructor:function(e,r,n,i){var a=e(function(e,t){h(e,a,r);m(e,{type:r,index:f(null),first:undefined,last:undefined,size:0});if(!p)e.size=0;if(t!=undefined)v(t,e[i],e,n)});var s=y(r);var o=function(e,t,r){var n=s(e);var i=l(e,t);var a,o;if(i){i.value=r}else{n.last=i={index:o=g(t,true),key:t,value:r,previous:a=n.last,next:undefined,removed:false};if(!n.first)n.first=i;if(a)a.next=i;if(p)n.size++;else e.size++;if(o!=="F")n.index[o]=i}return e};var l=function(e,t){var r=s(e);var n=g(t);var i;if(n!=="F")return r.index[n];for(i=r.first;i;i=i.next){if(i.key==t)return i}};c(a.prototype,{clear:function e(){var t=this;var r=s(t);var n=r.index;var i=r.first;while(i){i.removed=true;if(i.previous)i.previous=i.previous.next=undefined;delete n[i.index];i=i.next}r.first=r.last=undefined;if(p)r.size=0;else t.size=0},delete:function(e){var t=this;var r=s(t);var n=l(t,e);if(n){var i=n.next;var a=n.previous;delete r.index[n.index];n.removed=true;if(a)a.next=i;if(i)i.previous=a;if(r.first==n)r.first=i;if(r.last==n)r.last=a;if(p)r.size--;else t.size--}return!!n},forEach:function e(t){var r=s(this);var n=d(t,arguments.length>1?arguments[1]:undefined,3);var i;while(i=i?i.next:r.first){n(i.value,i.key,this);while(i&&i.removed)i=i.previous}},has:function e(t){return!!l(this,t)}});c(a.prototype,n?{get:function e(t){var r=l(this,t);return r&&r.value},set:function e(t,r){return o(this,t===0?0:t,r)}}:{add:function e(t){return o(this,t=t===0?0:t,t)}});if(p)u(a.prototype,"size",{get:function(){return s(this).size}});return a},setStrong:function(e,t,r){var n=t+" Iterator";var i=y(t);var a=y(n);o(e,t,function(e,t){m(this,{type:n,target:e,state:i(e),kind:t,last:undefined})},function(){var e=a(this);var t=e.kind;var r=e.last;while(r&&r.removed)r=r.previous;if(!e.target||!(e.last=r=r?r.next:e.state.first)){e.target=undefined;return{value:undefined,done:true}}if(t=="keys")return{value:r.key,done:false};if(t=="values")return{value:r.value,done:false};return{value:[r.key,r.value],done:false}},r?"entries":"values",!r,true);s(t)}}},function(e,t,r){"use strict";var n=r(107);var i=r(51);var a=r(36);var o=r(44);var s=a("species");e.exports=function(e){var t=n(e);var r=i.f;if(o&&t&&!t[s]){r(t,s,{configurable:true,get:function(){return this}})}}},function(e,t){function r(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}e.exports=r},function(e,t,r){var n=r(35);var i=r(139);var a=n.process;var o=a&&a.versions;var s=o&&o.v8;var l,u;if(s){l=s.split(".");u=l[0]+l[1]}else if(i){l=i.match(/Edge\/(\d+)/);if(!l||l[1]>=74){l=i.match(/Chrome\/(\d+)/);if(l)u=l[1]}}e.exports=u&&+u},function(e,t,r){"use strict";var n=r(26);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=n(function(){var e=i("a","y");e.lastIndex=2;return e.exec("abcd")!=null});t.BROKEN_CARET=n(function(){var e=i("^r","gy");e.lastIndex=2;return e.exec("str")!=null})},function(e,t,r){var n=r(53);var i=r(221);var a="["+i+"]";var o=RegExp("^"+a+a+"*");var s=RegExp(a+a+"*$");var l=function(r){return function(e){var t=String(n(e));if(r&1)t=t.replace(o,"");if(r&2)t=t.replace(s,"");return t}};e.exports={start:l(1),end:l(2),trim:l(3)}},function(e,t){e.exports="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff"},function(r,e){function n(e,t){r.exports=n=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return n(e,t)}r.exports=n},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var c=n(r(1));var i=n(r(2));var v=r(174);var p=new WeakMap;var a=function(){(0,i.default)(f,null,[{key:"DEFAULT_WIDTH",get:function e(){return 50}}]);function f(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.viewportSize,r=e.scrollOffset,n=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,o=e.calculationType,s=e.stretchMode,l=e.stretchingItemWidthFn,u=l===void 0?function(e){return e}:l;(0,c.default)(this,f);p.set(this,{viewportWidth:t,scrollOffset:r,totalColumns:n,columnWidthFn:i,overrideFn:a,calculationType:o,stretchingColumnWidthFn:u});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=s;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=true;this.stretchAllColumnsWidth=[];this.calculate()}(0,i.default)(f,[{key:"calculate",value:function e(){var t=0;var r=true;var n=[];var i;var a=p.get(this);var o=a.calculationType;var s=a.overrideFn;var l=a.scrollOffset;var u=a.totalColumns;var f=a.viewportWidth;for(var c=0;c<u;c++){i=this._getColumnWidth(c);if(t<=l&&o!==v.FULLY_VISIBLE_TYPE){this.startColumn=c}var d=l>0?f+1:f;if(t>=l&&t+(o===v.FULLY_VISIBLE_TYPE?i:0)<=l+d){if(this.startColumn===null||this.startColumn===void 0){this.startColumn=c}this.endColumn=c}n.push(t);t+=i;if(o!==v.FULLY_VISIBLE_TYPE){this.endColumn=c}if(t>=l+f){r=false;break}}if(this.endColumn===u-1&&r){this.startColumn=this.endColumn;while(this.startColumn>0){var h=n[this.endColumn]+i-n[this.startColumn-1];if(h<=f||o!==v.FULLY_VISIBLE_TYPE){this.startColumn-=1}if(h>f){break}}}if(o===v.RENDER_TYPE&&this.startColumn!==null&&s){s(this)}this.startPosition=n[this.startColumn];if(this.startPosition===void 0){this.startPosition=null}if(u<this.endColumn){this.endColumn=u-1}if(this.startColumn!==null){this.count=this.endColumn-this.startColumn+1}}},{key:"refreshStretching",value:function e(t){if(this.stretch==="none"){return}var r=t;this.totalTargetWidth=r;var n=p.get(this);var i=n.totalColumns;var a=0;for(var o=0;o<i;o++){var s=this._getColumnWidth(o);var l=n.stretchingColumnWidthFn(void 0,o);if(typeof l==="number"){r-=l}else{a+=s}}var u=r-a;if(this.stretch==="all"&&u>0){this.stretchAllRatio=r/a;this.stretchAllColumnsWidth=[];this.needVerifyLastColumnWidth=true}else if(this.stretch==="last"&&r!==Infinity){var f=this._getColumnWidth(i-1);var c=u+f;this.stretchLastWidth=c>=0?c:f}}},{key:"getStretchedColumnWidth",value:function e(t,r){var n=null;if(this.stretch==="all"&&this.stretchAllRatio!==0){n=this._getStretchedAllColumnWidth(t,r)}else if(this.stretch==="last"&&this.stretchLastWidth!==0){n=this._getStretchedLastColumnWidth(t)}return n}},{key:"_getStretchedAllColumnWidth",value:function e(t,r){var n=0;var i=p.get(this);var a=i.totalColumns;if(!this.stretchAllColumnsWidth[t]){var o=Math.round(r*this.stretchAllRatio);var s=i.stretchingColumnWidthFn(o,t);if(s===void 0){this.stretchAllColumnsWidth[t]=o}else{this.stretchAllColumnsWidth[t]=isNaN(s)?this._getColumnWidth(t):s}}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=false;for(var l=0;l<this.stretchAllColumnsWidth.length;l++){n+=this.stretchAllColumnsWidth[l]}if(n!==this.totalTargetWidth){this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n}}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function e(t){var r=p.get(this);var n=r.totalColumns;if(t===n-1){return this.stretchLastWidth}return null}},{key:"_getColumnWidth",value:function e(t){var r=p.get(this).columnWidthFn(t);if(isNaN(r)){r=f.DEFAULT_WIDTH}return r}}]);return f}();var o=a;t.default=o},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var l=n(r(1));var i=n(r(2));var g=r(174);var m=new WeakMap;var a=function(){(0,i.default)(p,null,[{key:"DEFAULT_HEIGHT",get:function e(){return 23}}]);function p(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.viewportSize,r=e.scrollOffset,n=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,o=e.calculationType,s=e.scrollbarHeight;(0,l.default)(this,p);m.set(this,{viewportHeight:t,scrollOffset:r,totalRows:n,rowHeightFn:i,overrideFn:a,calculationType:o,horizontalScrollbarHeight:s});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()}(0,i.default)(p,[{key:"calculate",value:function e(){var t=0;var r=true;var n=[];var i=m.get(this);var a=i.calculationType;var o=i.overrideFn;var s=i.rowHeightFn;var l=i.scrollOffset;var u=i.totalRows;var f=i.viewportHeight;var c=i.horizontalScrollbarHeight||0;var d;for(var h=0;h<u;h++){d=s(h);if(isNaN(d)){d=p.DEFAULT_HEIGHT}if(t<=l&&a!==g.FULLY_VISIBLE_TYPE){this.startRow=h}if(t>=l&&t+(a===g.FULLY_VISIBLE_TYPE?d:0)<=l+f-c){if(this.startRow===null){this.startRow=h}this.endRow=h}n.push(t);t+=d;if(a!==g.FULLY_VISIBLE_TYPE){this.endRow=h}if(t>=l+f-c){r=false;break}}if(this.endRow===u-1&&r){this.startRow=this.endRow;while(this.startRow>0){var v=n[this.endRow]+d-n[this.startRow-1];if(v<=f-c||a!==g.FULLY_VISIBLE_TYPE){this.startRow-=1}if(v>=f-c){break}}}if(a===g.RENDER_TYPE&&this.startRow!==null&&o){o(this)}this.startPosition=n[this.startRow];if(this.startPosition===void 0){this.startPosition=null}if(u<this.endRow){this.endRow=u-1}if(this.startRow!==null){this.count=this.endRow-this.startRow+1}}}]);return p}();var o=a;t.default=o},function(e,t,r){"use strict";var n=r(0);r(31);r(12);r(39);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var h=n(r(118));var o=function(){function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e;(0,i.default)(this,n);this.highlight=e;this.from=t;this.to=r}(0,a.default)(n,[{key:"setHighlight",value:function e(t){this.highlight=t;return this}},{key:"setFrom",value:function e(t){this.from=t;return this}},{key:"setTo",value:function e(t){this.to=t;return this}},{key:"isValid",value:function e(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function e(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function e(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function e(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function e(t){var r=t.row,n=t.col;var i=this.getTopLeftCorner();var a=this.getBottomRightCorner();return i.row<=r&&a.row>=r&&i.col<=n&&a.col>=n}},{key:"includesRange",value:function e(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function e(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function e(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function e(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function e(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function e(t){return this.getTopRightCorner().col>=t.getTopLeftCorner().col&&this.getTopRightCorner().col<=t.getTopRightCorner().col||this.getTopLeftCorner().col<=t.getTopRightCorner().col&&this.getTopLeftCorner().col>=t.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function e(t){return this.getBottomRightCorner().row>=t.getTopRightCorner().row&&this.getBottomRightCorner().row<=t.getBottomRightCorner().row||this.getTopRightCorner().row<=t.getBottomRightCorner().row&&this.getTopRightCorner().row>=t.getTopRightCorner().row}},{key:"expand",value:function e(t){var r=this.getTopLeftCorner();var n=this.getBottomRightCorner();if(t.row<r.row||t.col<r.col||t.row>n.row||t.col>n.col){this.from=new h.default(Math.min(r.row,t.row),Math.min(r.col,t.col));this.to=new h.default(Math.max(n.row,t.row),Math.max(n.col,t.col));return true}return false}},{key:"expandByRange",value:function e(t){if(this.includesRange(t)||!this.overlaps(t)){return false}var r=this.getTopLeftCorner();var n=this.getBottomRightCorner();var i=this.getDirection();var a=t.getTopLeftCorner();var o=t.getBottomRightCorner();var s=Math.min(r.row,a.row);var l=Math.min(r.col,a.col);var u=Math.max(n.row,o.row);var f=Math.max(n.col,o.col);var c=new h.default(s,l);var d=new h.default(u,f);this.from=c;this.to=d;this.setDirection(i);if(this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==="N-S"){this.flipDirectionVertically()}if(this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==="W-E"){this.flipDirectionHorizontally()}return true}},{key:"getDirection",value:function e(){if(this.from.isNorthWestOf(this.to)){return"NW-SE"}else if(this.from.isNorthEastOf(this.to)){return"NE-SW"}else if(this.from.isSouthEastOf(this.to)){return"SE-NW"}else if(this.from.isSouthWestOf(this.to)){return"SW-NE"}}},{key:"setDirection",value:function e(t){switch(t){case"NW-SE":var r=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=r[0];this.to=r[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0];this.to=n[1];break;case"SE-NW":var i=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=i[0];this.to=i[1];break;case"SW-NE":var a=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=a[0];this.to=a[1];break;default:break}}},{key:"getVerticalDirection",value:function e(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function e(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function e(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}},{key:"flipDirectionHorizontally",value:function e(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}},{key:"getTopLeftCorner",value:function e(){return new h.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function e(){return new h.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function e(){return new h.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function e(){return new h.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function e(t,r){if(r&&r.includes(t)&&(this.getTopLeftCorner().isEqual(new h.default(r.from.row,r.from.col))||this.getTopRightCorner().isEqual(new h.default(r.from.row,r.to.col))||this.getBottomLeftCorner().isEqual(new h.default(r.to.row,r.from.col))||this.getBottomRightCorner().isEqual(new h.default(r.to.row,r.to.col)))){return true}return t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function e(t,r){if(!(t instanceof h.default)){return false}if(r){if(r.includes(t)){if(this.getTopLeftCorner().isEqual(new h.default(r.from.row,r.from.col))){return this.getBottomRightCorner()}if(this.getTopRightCorner().isEqual(new h.default(r.from.row,r.to.col))){return this.getBottomLeftCorner()}if(this.getBottomLeftCorner().isEqual(new h.default(r.to.row,r.from.col))){return this.getTopRightCorner()}if(this.getBottomRightCorner().isEqual(new h.default(r.to.row,r.to.col))){return this.getTopLeftCorner()}}}if(t.isEqual(this.getBottomRightCorner())){return this.getTopLeftCorner()}else if(t.isEqual(this.getTopLeftCorner())){return this.getBottomRightCorner()}else if(t.isEqual(this.getTopRightCorner())){return this.getBottomLeftCorner()}else if(t.isEqual(this.getBottomLeftCorner())){return this.getTopRightCorner()}}},{key:"getBordersSharedWith",value:function e(t){if(!this.includesRange(t)){return[]}var r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)};var n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)};var i=[];if(r.top===n.top){i.push("top")}if(r.right===n.right){i.push("right")}if(r.bottom===n.bottom){i.push("bottom")}if(r.left===n.left){i.push("left")}return i}},{key:"getInner",value:function e(){var t=this.getTopLeftCorner();var r=this.getBottomRightCorner();var n=[];for(var i=t.row;i<=r.row;i++){for(var a=t.col;a<=r.col;a++){if(!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)){n.push(new h.default(i,a))}}}return n}},{key:"getAll",value:function e(){var t=this.getTopLeftCorner();var r=this.getBottomRightCorner();var n=[];for(var i=t.row;i<=r.row;i++){for(var a=t.col;a<=r.col;a++){if(t.row===i&&t.col===a){n.push(t)}else if(r.row===i&&r.col===a){n.push(r)}else{n.push(new h.default(i,a))}}}return n}},{key:"forAll",value:function e(t){var r=this.getTopLeftCorner();var n=this.getBottomRightCorner();for(var i=r.row;i<=n.row;i++){for(var a=r.col;a<=n.col;a++){var o=t(i,a);if(o===false){return}}}}},{key:"toObject",value:function e(){return{from:this.from.toObject(),to:this.to.toObject()}}}]);return n}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function n(e,t,r){(0,i.default)(this,n);this.offset=e;this.total=t;this.countTH=r}(0,a.default)(n,[{key:"offsetted",value:function e(t){return t+this.offset}},{key:"unOffsetted",value:function e(t){return t-this.offset}},{key:"renderedToSource",value:function e(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function e(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function e(t){return t-this.countTH}},{key:"unOffsettedTH",value:function e(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function e(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function e(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]);return n}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function n(e,t,r){(0,i.default)(this,n);this.offset=e;this.total=t;this.countTH=r}(0,a.default)(n,[{key:"offsetted",value:function e(t){return t+this.offset}},{key:"unOffsetted",value:function e(t){return t-this.offset}},{key:"renderedToSource",value:function e(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function e(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function e(t){return t-this.countTH}},{key:"unOffsettedTH",value:function e(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function e(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function e(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]);return n}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);r(31);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var g=r(8);var u=n(r(95));var f=n(r(370));var c=n(r(178));var d=r(3);var h=function(e){(0,l.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"alignOverlaysWithTrimmingContainer",value:function e(){var t=(0,g.getTrimmingContainer)(this.wtRootElement);var r=this.wot.rootWindow;if(t===r){var n=this.wot.getSetting("preventOverflow");if(!n){this.holder.style.overflow="visible";this.wtRootElement.style.overflow="visible"}}else{var i=t.parentElement;var a=(0,g.getStyle)(t,"height",r);var o=(0,g.getStyle)(t,"overflow",r);var s=this.holder.style;var l=t.scrollWidth,u=t.scrollHeight;var f=t.getBoundingClientRect(),c=f.width,d=f.height;var h=["auto","hidden","scroll"];if(i&&h.includes(o)){var v=t.cloneNode(false);v.style.overflow="auto";if(t.nextElementSibling){i.insertBefore(v,t.nextElementSibling)}else{i.appendChild(v)}var p=parseInt((0,g.getComputedStyle)(v,r).height,10);i.removeChild(v);if(p===0){d=0}}d=Math.min(d,u);s.height=a==="auto"?"auto":"".concat(d,"px");c=Math.min(c,l);s.width="".concat(c,"px");s.overflow="";this.hasTableHeight=s.height==="auto"?true:d>0;this.hasTableWidth=c>0}this.isTableVisible=(0,g.isVisible)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function e(){var t=this.wot;var r=t.getOverlayName();var n=t.getSetting("columnHeaders");var i=n.length;if(i&&!t.wtViewport.hasOversizedColumnHeadersMarked[r]){var a=t.getSetting("rowHeaders");var o=a.length;var s=this.getRenderedColumnsCount();for(var l=0;l<i;l++){for(var u=-1*o;u<s;u++){this.markIfOversizedColumnHeader(u)}}t.wtViewport.hasOversizedColumnHeadersMarked[r]=true}}}]);return t}(u.default);(0,d.mixin)(h,f.default);(0,d.mixin)(h,c.default);var v=h;t.default=v},function(e,t){function r(e){if(Array.isArray(e))return e}e.exports=r},function(e,t){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}e.exports=r},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.Renderer=void 0;var u=n(r(1));var i=n(r(2));var f=n(r(432));t.RowHeadersRenderer=f.default;var c=n(r(437));t.ColumnHeadersRenderer=c.default;var d=n(r(438));t.ColGroupRenderer=d.default;var h=n(r(439));t.RowsRenderer=h.default;var v=n(r(445));t.CellsRenderer=v.default;var p=n(r(446));t.TableRenderer=p.default;var a=function(){function l(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.TABLE,r=e.THEAD,n=e.COLGROUP,i=e.TBODY,a=e.rowUtils,o=e.columnUtils,s=e.cellRenderer;(0,u.default)(this,l);this.renderer=new p.default(t,{cellRenderer:s});this.renderer.setRenderers({rowHeaders:new f.default,columnHeaders:new c.default(r),colGroup:new d.default(n),rows:new h.default(i),cells:new v.default});this.renderer.setAxisUtils(a,o)}(0,i.default)(l,[{key:"setFilters",value:function e(t,r){this.renderer.setFilters(t,r);return this}},{key:"setViewportSize",value:function e(t,r){this.renderer.setViewportSize(t,r);return this}},{key:"setHeaderContentRenderers",value:function e(t,r){this.renderer.setHeaderContentRenderers(t,r);return this}},{key:"adjust",value:function e(){this.renderer.adjust()}},{key:"render",value:function e(){this.renderer.render()}}]);return l}();t.Renderer=a},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var u=r(233);var o=n(r(433));var s=function(){function n(e,t,r){(0,i.default)(this,n);this.rootNode=e;this.nodesPool=t;this.sizeSet=new o.default;this.childNodeType=r.toUpperCase();this.visualIndex=0;this.collectedNodes=[]}(0,a.default)(n,[{key:"setSize",value:function e(t){this.sizeSet.setSize(t);return this}},{key:"setOffset",value:function e(t){this.sizeSet.setOffset(t);return this}},{key:"isSharedViewSet",value:function e(){return this.sizeSet.isShared()}},{key:"getNode",value:function e(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function e(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function e(){var t=this.rootNode,r=this.sizeSet;var n=0;if(this.isSharedViewSet()){var i=t.firstElementChild;while(i){if(i.tagName===this.childNodeType){n+=1}else if(r.isPlaceOn(u.WORKING_SPACE_TOP)){break}i=i.nextElementSibling}}else{n=t.childElementCount}return n}},{key:"start",value:function e(){this.collectedNodes.length=0;this.visualIndex=0;var t=this.rootNode,r=this.sizeSet;var n=this.isSharedViewSet();var i=r.getViewSize(),a=i.nextSize;var o=this.getRenderedChildCount();while(o<a){var s=this.nodesPool();if(!n||n&&r.isPlaceOn(u.WORKING_SPACE_BOTTOM)){t.appendChild(s)}else{t.insertBefore(s,t.firstChild)}o+=1}var l=n&&r.isPlaceOn(u.WORKING_SPACE_TOP);while(o>a){t.removeChild(l?t.firstChild:t.lastChild);o-=1}}},{key:"render",value:function e(){var t=this.rootNode,r=this.sizeSet;var n=this.visualIndex;if(this.isSharedViewSet()&&r.isPlaceOn(u.WORKING_SPACE_BOTTOM)){n+=r.sharedSize.nextSize}var i=t.childNodes[n];if(i.tagName!==this.childNodeType){var a=this.nodesPool();t.replaceChild(a,i);i=a}this.collectedNodes.push(i);this.visualIndex+=1}},{key:"end",value:function e(){}}]);return n}();t.default=s},function(e,t,r){"use strict";t.__esModule=true;t.WORKING_SPACE_BOTTOM=t.WORKING_SPACE_TOP=t.WORKING_SPACE_ALL=void 0;var n=0;t.WORKING_SPACE_ALL=n;var i=1;t.WORKING_SPACE_TOP=i;var a=2;t.WORKING_SPACE_BOTTOM=a},function(e,t,r){"use strict";var n=r(20);var i=r(441).start;var a=r(442);n({target:"String",proto:true,forced:a},{padStart:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var a=r(82);var o=r(53);e.exports="".repeat||function e(t){var r=String(o(this));var n="";var i=a(t);if(i<0||i==Infinity)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))if(i&1)n+=r;return n}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,r){"use strict";var n=r(0);r(12);t.__esModule=true;t.default=void 0;var a=n(r(1));var o=n(r(2));var s=r(8);var l=r(3);var u=r(74);var f=n(r(364));var c=n(r(365));var d=n(r(367));var h=n(r(368));var v=n(r(228));var p=n(r(369));var i=function(){function i(e){(0,a.default)(this,i);var r=[];this.guid="wt_".concat((0,u.randomString)());this.rootDocument=e.table.ownerDocument;this.rootWindow=this.rootDocument.defaultView;if(e.cloneSource){this.cloneSource=e.cloneSource;this.cloneOverlay=e.cloneOverlay;this.wtSettings=e.cloneSource.wtSettings;this.wtTable=this.cloneOverlay.createTable(this,e.table);this.wtScroll=new d.default(this);this.wtViewport=e.cloneSource.wtViewport;this.wtEvent=new f.default(this);this.selections=this.cloneSource.selections}else{this.wtSettings=new h.default(this,e);this.wtTable=new v.default(this,e.table);this.wtScroll=new d.default(this);this.wtViewport=new p.default(this);this.wtEvent=new f.default(this);this.selections=this.getSetting("selections");this.wtOverlays=new c.default(this);this.exportSettingsAsClassNames()}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++){r.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(e,t){(0,s.fastInnerText)(t,r[e])}])}}this.drawn=false;this.drawInterrupted=false}(0,o.default)(i,[{key:"draw",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.drawInterrupted=false;if(!t&&!this.wtTable.isVisible()){this.drawInterrupted=true}else{this.wtTable.draw(t)}return this}},{key:"getCell",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!r){return this.wtTable.getCell(t)}var n=this.wtSettings.getSetting("totalRows");var i=this.wtSettings.getSetting("fixedRowsTop");var a=this.wtSettings.getSetting("fixedRowsBottom");var o=this.wtSettings.getSetting("fixedColumnsLeft");if(t.row<i&&t.col<o){return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t)}else if(t.row<i){return this.wtOverlays.topOverlay.clone.wtTable.getCell(t)}else if(t.col<o&&t.row>=n-a){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone){return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}}else if(t.col<o){return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t)}else if(t.row<n&&t.row>=n-a){if(this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone){return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}}return this.wtTable.getCell(t)}},{key:"update",value:function e(t,r){return this.wtSettings.update(t,r)}},{key:"scrollViewport",value:function e(t,r,n,i,a){if(t.col<0||t.row<0){return false}return this.wtScroll.scrollViewport(t,r,n,i,a)}},{key:"scrollViewportHorizontally",value:function e(t,r,n){if(t<0){return false}return this.wtScroll.scrollViewportHorizontally(t,r,n)}},{key:"scrollViewportVertically",value:function e(t,r,n){if(t<0){return false}return this.wtScroll.scrollViewportVertically(t,r,n)}},{key:"getViewport",value:function e(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function e(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function e(){var r=this;var t={rowHeaders:["array"],columnHeaders:["array"]};var n=[];var i=[];(0,l.objectEach)(t,function(e,t){if(e.indexOf("array")>-1&&r.getSetting(t).length){i.push("ht".concat((0,u.toUpperCaseFirst)(t)))}n.push("ht".concat((0,u.toUpperCaseFirst)(t)))});(0,s.removeClass)(this.wtTable.wtRootElement.parentNode,n);(0,s.addClass)(this.wtTable.wtRootElement.parentNode,i)}},{key:"getSetting",value:function e(t,r,n,i,a){return this.wtSettings.getSetting(t,r,n,i,a)}},{key:"hasSetting",value:function e(t){return this.wtSettings.has(t)}},{key:"destroy",value:function e(){this.wtOverlays.destroy();this.wtEvent.destroy()}}]);return i}();var g=i;t.default=g},function(e,t,r){"use strict";var n=r(0);r(31);r(15);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var s=r(8);var l=r(77);var o=r(76);var u=r(71);var f=n(r(25));var c=new WeakMap;var d=function(){function t(e){(0,i.default)(this,t);this.instance=e;this.eventManager=new f.default(e);c.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]});this.registerEvents()}(0,a.default)(t,[{key:"registerEvents",value:function e(){var t=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",function(e){return t.onContextMenu(e)});this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(e){return t.onMouseOver(e)});this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(e){return t.onMouseOut(e)});var r=function e(){t.eventManager.addEventListener(t.instance.wtTable.holder,"touchstart",function(e){return t.onTouchStart(e)});t.eventManager.addEventListener(t.instance.wtTable.holder,"touchend",function(e){return t.onTouchEnd(e)});if(!t.instance.momentumScrolling){t.instance.momentumScrolling={}}t.eventManager.addEventListener(t.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout);if(!t.instance.momentumScrolling.ongoing){t.instance.getSetting("onBeforeTouchScroll")}t.instance.momentumScrolling.ongoing=true;t.instance.momentumScrolling._timeout=setTimeout(function(){if(!t.instance.touchApplied){t.instance.momentumScrolling.ongoing=false;t.instance.getSetting("onAfterMomentumScroll")}},200)})};var n=function e(){t.eventManager.addEventListener(t.instance.wtTable.holder,"mouseup",function(e){return t.onMouseUp(e)});t.eventManager.addEventListener(t.instance.wtTable.holder,"mousedown",function(e){return t.onMouseDown(e)})};if((0,u.isMobileBrowser)()){r()}else{if((0,o.isTouchSupported)()){r()}n()}}},{key:"selectedCellWasTouched",value:function e(t){var r=c.get(this);var n=this.parentCell(t);var i=n.coords;if(r.selectedCellBeforeTouchEnd&&i){var a=[i.row,r.selectedCellBeforeTouchEnd.from.row],o=a[0],s=a[1];var l=[i.col,r.selectedCellBeforeTouchEnd.from.col],u=l[0],f=l[1];return o===s&&u===f}return false}},{key:"parentCell",value:function e(t){var r={};var n=this.instance.wtTable.TABLE;var i=(0,s.closestDown)(t,["TD","TH"],n);if(i){r.coords=this.instance.wtTable.getCoords(i);r.TD=i}else if((0,s.hasClass)(t,"wtBorder")&&(0,s.hasClass)(t,"current")){r.coords=this.instance.selections.getCell().cellRange.highlight;r.TD=this.instance.wtTable.getCell(r.coords)}else if((0,s.hasClass)(t,"wtBorder")&&(0,s.hasClass)(t,"area")){if(this.instance.selections.createOrGetArea().cellRange){r.coords=this.instance.selections.createOrGetArea().cellRange.to;r.TD=this.instance.wtTable.getCell(r.coords)}}return r}},{key:"onMouseDown",value:function e(t){var r=c.get(this);var n=this.instance.rootDocument.activeElement;var i=(0,l.partial)(s.getParent,t.realTarget);var a=t.realTarget;if(a===n||i(0)===n||i(1)===n){return}var o=this.parentCell(a);if((0,s.hasClass)(a,"corner")){this.instance.getSetting("onCellCornerMouseDown",t,a)}else if(o.TD&&this.instance.hasSetting("onCellMouseDown")){this.instance.getSetting("onCellMouseDown",t,o.coords,o.TD,this.instance)}if((t.button===0||this.instance.touchApplied)&&o.TD){r.dblClickOrigin[0]=o.TD;clearTimeout(r.dblClickTimeout[0]);r.dblClickTimeout[0]=setTimeout(function(){r.dblClickOrigin[0]=null},1e3)}}},{key:"onContextMenu",value:function e(t){if(this.instance.hasSetting("onCellContextMenu")){var r=this.parentCell(t.realTarget);if(r.TD){this.instance.getSetting("onCellContextMenu",t,r.coords,r.TD,this.instance)}}}},{key:"onMouseOver",value:function e(t){if(!this.instance.hasSetting("onCellMouseOver")){return}var r=this.instance.wtTable.TABLE;var n=(0,s.closestDown)(t.realTarget,["TD","TH"],r);var i=this.instance.cloneSource||this.instance;if(n&&n!==i.lastMouseOver&&(0,s.isChildOf)(n,r)){i.lastMouseOver=n;this.instance.getSetting("onCellMouseOver",t,this.instance.wtTable.getCoords(n),n,this.instance)}}},{key:"onMouseOut",value:function e(t){if(!this.instance.hasSetting("onCellMouseOut")){return}var r=this.instance.wtTable.TABLE;var n=(0,s.closestDown)(t.realTarget,["TD","TH"],r);var i=(0,s.closestDown)(t.relatedTarget,["TD","TH"],r);if(n&&n!==i&&(0,s.isChildOf)(n,r)){this.instance.getSetting("onCellMouseOut",t,this.instance.wtTable.getCoords(n),n,this.instance)}}},{key:"onMouseUp",value:function e(t){var r=c.get(this);var n=this.parentCell(t.realTarget);if(n.TD&&this.instance.hasSetting("onCellMouseUp")){this.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,this.instance)}if(t.button!==0&&!this.instance.touchApplied){return}if(n.TD===r.dblClickOrigin[0]&&n.TD===r.dblClickOrigin[1]){if((0,s.hasClass)(t.realTarget,"corner")){this.instance.getSetting("onCellCornerDblClick",t,n.coords,n.TD,this.instance)}else{this.instance.getSetting("onCellDblClick",t,n.coords,n.TD,this.instance)}r.dblClickOrigin[0]=null;r.dblClickOrigin[1]=null}else if(n.TD===r.dblClickOrigin[0]){r.dblClickOrigin[1]=n.TD;clearTimeout(r.dblClickTimeout[1]);r.dblClickTimeout[1]=setTimeout(function(){r.dblClickOrigin[1]=null},500)}}},{key:"onTouchStart",value:function e(t){var r=c.get(this);r.selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange;this.instance.touchApplied=true;this.onMouseDown(t)}},{key:"onTouchEnd",value:function e(t){var r=["A","BUTTON","INPUT"];var n=t.target;if(this.selectedCellWasTouched(n)===false&&r.includes(n.tagName)){t.preventDefault()}this.onMouseUp(t);this.instance.touchApplied=false}},{key:"destroy",value:function e(){var t=c.get(this);clearTimeout(t.dblClickTimeout[0]);clearTimeout(t.dblClickTimeout[1]);this.eventManager.destroy()}}]);return t}();var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);r(96);r(97);r(34);t.__esModule=true;t.default=void 0;var u=n(r(1));var i=n(r(2));var f=r(8);var a=r(4);var o=r(55);var h=r(71);var c=n(r(25));var s=n(r(92));var l=function(){function l(e){(0,u.default)(this,l);this.wot=e;var t=this.wot,r=t.rootDocument,n=t.rootWindow,i=t.wtTable;var a=parseInt(n.getComputedStyle(r.body).lineHeight,10);var o=parseInt(n.getComputedStyle(r.body).fontSize,10)*1.2;this.instance=this.wot;this.eventManager=new c.default(this.wot);this.scrollbarSize=(0,f.getScrollbarWidth)(r);this.wot.update("scrollbarWidth",this.scrollbarSize);this.wot.update("scrollbarHeight",this.scrollbarSize);var s=n.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=s?i.holder:(0,f.getScrollableElement)(i.TABLE);this.topOverlay=void 0;this.bottomOverlay=void 0;this.leftOverlay=void 0;this.topLeftCornerOverlay=void 0;this.bottomLeftCornerOverlay=void 0;this.prepareOverlays();this.hasScrollbarBottom=false;this.hasScrollbarRight=false;this.destroyed=false;this.keyPressed=false;this.spreaderLastSize={width:null,height:null};this.verticalScrolling=false;this.horizontalScrolling=false;this.browserLineHeight=a||o;this.registerListeners();this.lastScrollX=n.scrollX;this.lastScrollY=n.scrollY}(0,i.default)(l,[{key:"prepareOverlays",value:function e(){var t=false;if(this.topOverlay){t=this.topOverlay.updateStateOfRendering()||t}else{this.topOverlay=s.default.createOverlay(s.default.CLONE_TOP,this.wot)}if(!s.default.hasOverlay(s.default.CLONE_BOTTOM)){this.bottomOverlay={needFullRender:false,updateStateOfRendering:function e(){return false}}}if(!s.default.hasOverlay(s.default.CLONE_BOTTOM_LEFT_CORNER)){this.bottomLeftCornerOverlay={needFullRender:false,updateStateOfRendering:function e(){return false}}}if(this.bottomOverlay){t=this.bottomOverlay.updateStateOfRendering()||t}else{this.bottomOverlay=s.default.createOverlay(s.default.CLONE_BOTTOM,this.wot)}if(this.leftOverlay){t=this.leftOverlay.updateStateOfRendering()||t}else{this.leftOverlay=s.default.createOverlay(s.default.CLONE_LEFT,this.wot)}if(this.topOverlay.needFullRender&&this.leftOverlay.needFullRender){if(this.topLeftCornerOverlay){t=this.topLeftCornerOverlay.updateStateOfRendering()||t}else{this.topLeftCornerOverlay=s.default.createOverlay(s.default.CLONE_TOP_LEFT_CORNER,this.wot)}}if(this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender){if(this.bottomLeftCornerOverlay){t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t}else{this.bottomLeftCornerOverlay=s.default.createOverlay(s.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)}}if(this.wot.getSetting("debug")&&!this.debug){this.debug=s.default.createOverlay(s.default.CLONE_DEBUG,this.wot)}return t}},{key:"refreshAll",value:function e(){if(!this.wot.drawn){return}if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(true);if(this.verticalScrolling){this.leftOverlay.onScroll()}if(this.horizontalScrolling){this.topOverlay.onScroll()}this.verticalScrolling=false;this.horizontalScrolling=false}},{key:"registerListeners",value:function e(){var r=this;var t=this.wot,n=t.rootDocument,i=t.rootWindow;var a=this.topOverlay.mainTableScrollableElement;var o=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",function(e){return r.onKeyDown(e)});this.eventManager.addEventListener(n.documentElement,"keyup",function(){return r.onKeyUp()});this.eventManager.addEventListener(n,"visibilitychange",function(){return r.onKeyUp()});this.eventManager.addEventListener(a,"scroll",function(e){return r.onTableScroll(e)},{passive:true});if(a!==o){this.eventManager.addEventListener(o,"scroll",function(e){return r.onTableScroll(e)},{passive:true})}var s=i.devicePixelRatio&&i.devicePixelRatio>1;var l=this.scrollableElement===i;var u=this.wot.wtSettings.getSetting("preventWheel");var f={passive:l};if(u||s||!(0,h.isChrome)()){this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",function(e){return r.onCloneWheel(e,u)},f)}var c=[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];c.forEach(function(e){if(e&&e.needFullRender){var t=e.clone.wtTable.holder;r.eventManager.addEventListener(t,"wheel",function(e){return r.onCloneWheel(e,u)},f)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d);d=setTimeout(function(){r.wot.getSetting("onWindowResize")},200)})}},{key:"deregisterListeners",value:function e(){this.eventManager.clearEvents(true)}},{key:"onTableScroll",value:function e(t){var r=this.wot.rootWindow;var n=this.leftOverlay.mainTableScrollableElement;var i=this.topOverlay.mainTableScrollableElement;var a=t.target;if(this.keyPressed){if(i!==r&&a!==r&&!t.target.contains(i)||n!==r&&a!==r&&!t.target.contains(n)){return}}this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function e(t,r){var n=this.wot.rootWindow;var i=this.leftOverlay.mainTableScrollableElement;var a=this.topOverlay.mainTableScrollableElement;var o=t.target;var s=a!==n&&o!==n&&!o.contains(a);var l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(s||l)){return}var u=this.translateMouseWheelToScroll(t);if(r||this.scrollableElement!==n&&u){t.preventDefault()}}},{key:"onKeyDown",value:function e(t){this.keyPressed=(0,o.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function e(){this.keyPressed=false}},{key:"translateMouseWheelToScroll",value:function e(t){var r=this.browserLineHeight;var n=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY;var i=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;if(t.deltaMode===1){i+=i*r;n+=n*r}var a=this.scrollVertically(n);var o=this.scrollHorizontally(i);return a||o}},{key:"scrollVertically",value:function e(t){var r=this.scrollableElement.scrollTop;this.scrollableElement.scrollTop+=t;return r!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function e(t){var r=this.scrollableElement.scrollLeft;this.scrollableElement.scrollLeft+=t;return r!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function e(){if(this.destroyed){return}var t=this.wot.rootWindow;var r=this.topOverlay.clone.wtTable.holder;var n=this.leftOverlay.clone.wtTable.holder;var i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],o=i[1];this.horizontalScrolling=r.scrollLeft!==a||this.lastScrollX!==t.scrollX;this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==t.scrollY;this.lastScrollX=t.scrollX;this.lastScrollY=t.scrollY;if(this.horizontalScrolling){r.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;if(s){s.scrollLeft=a}}if(this.verticalScrolling){n.scrollTop=o}this.refreshAll()}},{key:"syncScrollWithMaster",value:function e(){var t=this.topOverlay.mainTableScrollableElement;var r=t.scrollLeft,n=t.scrollTop;if(this.topOverlay.needFullRender){this.topOverlay.clone.wtTable.holder.scrollLeft=r}if(this.bottomOverlay.needFullRender){this.bottomOverlay.clone.wtTable.holder.scrollLeft=r}if(this.leftOverlay.needFullRender){this.leftOverlay.clone.wtTable.holder.scrollTop=n}}},{key:"updateMainScrollableElements",value:function e(){this.deregisterListeners();this.leftOverlay.updateMainScrollableElement();this.topOverlay.updateMainScrollableElement();if(this.bottomOverlay.needFullRender){this.bottomOverlay.updateMainScrollableElement()}var t=this.wot,r=t.rootWindow,n=t.wtTable;if(r.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"){this.scrollableElement=n.holder}else{this.scrollableElement=(0,f.getScrollableElement)(n.TABLE)}this.registerListeners()}},{key:"destroy",value:function e(){this.eventManager.destroy();this.topOverlay.destroy();if(this.bottomOverlay.clone){this.bottomOverlay.destroy()}this.leftOverlay.destroy();if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.destroy()}if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone){this.bottomLeftCornerOverlay.destroy()}if(this.debug){this.debug.destroy()}this.destroyed=true}},{key:"refresh",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var r=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement;var n=r.clientWidth;var i=r.clientHeight;if(n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height){this.spreaderLastSize.width=n;this.spreaderLastSize.height=i;this.adjustElementsSize()}}if(this.bottomOverlay.clone){this.bottomOverlay.refresh(t)}this.leftOverlay.refresh(t);this.topOverlay.refresh(t);if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.refresh(t)}if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone){this.bottomLeftCornerOverlay.refresh(t)}if(this.debug){this.debug.refresh(t)}}},{key:"adjustElementsSize",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=this.wot,n=r.wtViewport,i=r.wtTable;var a=this.wot.getSetting("totalColumns");var o=this.wot.getSetting("totalRows");var s=n.getRowHeaderWidth();var l=n.getColumnHeaderHeight();var u=i.hider.style;u.width="".concat(s+this.leftOverlay.sumCellSizes(0,a),"px");u.height="".concat(l+this.topOverlay.sumCellSizes(0,o)+1,"px");if(this.scrollbarSize>0){var f=i.wtRootElement,c=f.scrollHeight,d=f.scrollWidth;var h=i.holder,v=h.scrollHeight,p=h.scrollWidth;this.hasScrollbarRight=c<v;this.hasScrollbarBottom=d<p;if(this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>d){this.hasScrollbarBottom=true}else if(this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>c){this.hasScrollbarRight=true}}this.topOverlay.adjustElementsSize(t);this.leftOverlay.adjustElementsSize(t);this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function e(){var t=this.wot.wtTable;if(!t.isVisible()){return}if(!this.topOverlay.areElementSizesAdjusted||!this.leftOverlay.areElementSizesAdjusted){this.adjustElementsSize()}this.topOverlay.applyToDOM();if(this.bottomOverlay.clone){this.bottomOverlay.applyToDOM()}this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function e(t){if(!t){return null}var r=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];var n=null;(0,a.arrayEach)(r,function(e){if(!e){return}if(e.clone&&e.clone.wtTable.TABLE.contains(t)){n=e.clone}});return n}}]);return l}();var d=l;t.default=d},function(e,t,r){"use strict";var n=r(75).forEach;var i=r(84);var a=r(59);var o=i("forEach");var s=a("forEach");e.exports=!o||!s?function e(t){return n(this,t,arguments.length>1?arguments[1]:undefined)}:[].forEach},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var p=r(8);var o=function(){function t(e){(0,i.default)(this,t);this.wot=e}(0,a.default)(t,[{key:"scrollViewport",value:function e(t,r,n,i,a){if(t.col<0||t.row<0){return false}var o=this.scrollViewportHorizontally(t.col,n,a);var s=this.scrollViewportVertically(t.row,r,i);return o||s}},{key:"scrollViewportHorizontally",value:function e(t,r,n){if(!this.wot.drawn){return false}var i=this._getVariables(),a=i.fixedColumnsLeft,o=i.leftOverlay,s=i.totalColumns;var l=false;if(t>=0&&t<=Math.max(s-1,0)){var u=this.getFirstVisibleColumn();var f=this.getLastVisibleColumn();if(t>=a&&u>-1&&(t<u||n)){l=o.scrollTo(t)}else if(f===-1||f>-1&&(t>f||r)){l=o.scrollTo(t,true)}}return l}},{key:"scrollViewportVertically",value:function e(t,r,n){if(!this.wot.drawn){return false}var i=this._getVariables(),a=i.fixedRowsBottom,o=i.fixedRowsTop,s=i.topOverlay,l=i.totalRows;var u=false;if(t>=0&&t<=Math.max(l-1,0)){var f=this.getFirstVisibleRow();var c=this.getLastVisibleRow();if(t>=o&&f>-1&&(t<f||r)){u=s.scrollTo(t)}else if(c===-1||c>-1&&(t>c&&t<l-a||n)){u=s.scrollTo(t,true)}}return u}},{key:"getFirstVisibleRow",value:function e(){var t=this._getVariables(),r=t.topOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalRows,o=t.fixedRowsTop;var s=this.wot.rootWindow;var l=n.getFirstVisibleRow();if(r.mainTableScrollableElement===s){var u=(0,p.offset)(n.wtRootElement);var f=(0,p.innerHeight)(n.hider);var c=(0,p.innerHeight)(s);var d=(0,p.getScrollTop)(s,s);if(u.top+f-c<=d){var h=i.getColumnHeaderHeight();h+=r.sumCellSizes(0,o);for(var v=a;v>0;v--){h+=r.sumCellSizes(v-1,v);if(u.top+f-h<=d){l=v;break}}}}return l}},{key:"getLastVisibleRow",value:function e(){var t=this._getVariables(),r=t.topOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalRows;var o=this.wot.rootWindow;var s=n.getLastVisibleRow();if(r.mainTableScrollableElement===o){var l=(0,p.offset)(n.wtRootElement);var u=(0,p.getScrollTop)(o,o);if(l.top>u){var f=(0,p.innerHeight)(o);var c=i.getColumnHeaderHeight();for(var d=1;d<=a;d++){c+=r.sumCellSizes(d-1,d);if(l.top+c-u>=f){s=d-2;break}}}}return s}},{key:"getFirstVisibleColumn",value:function e(){var t=this._getVariables(),r=t.leftOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalColumns;var o=this.wot.rootWindow;var s=n.getFirstVisibleColumn();if(r.mainTableScrollableElement===o){var l=(0,p.offset)(n.wtRootElement);var u=(0,p.innerWidth)(n.hider);var f=(0,p.innerWidth)(o);var c=(0,p.getScrollLeft)(o,o);if(l.left+u-f<=c){var d=i.getRowHeaderWidth();for(var h=a;h>0;h--){d+=r.sumCellSizes(h-1,h);if(l.left+u-d<=c){s=h;break}}}}return s}},{key:"getLastVisibleColumn",value:function e(){var t=this._getVariables(),r=t.leftOverlay,n=t.wtTable,i=t.wtViewport,a=t.totalColumns;var o=this.wot.rootWindow;var s=n.getLastVisibleColumn();if(r.mainTableScrollableElement===o){var l=(0,p.offset)(n.wtRootElement);var u=(0,p.getScrollLeft)(o,o);if(l.left>u){var f=(0,p.innerWidth)(o);var c=i.getRowHeaderWidth();for(var d=1;d<=a;d++){c+=r.sumCellSizes(d-1,d);if(l.left+c-u>=f){s=d-2;break}}}}return s}},{key:"_getVariables",value:function e(){var t=this.wot;var r=t.wtOverlays.topOverlay;var n=t.wtOverlays.leftOverlay;var i=t.wtTable;var a=t.wtViewport;var o=t.getSetting("totalRows");var s=t.getSetting("totalColumns");var l=t.getSetting("fixedRowsTop");var u=t.getSetting("fixedRowsBottom");var f=t.getSetting("fixedColumnsLeft");return{topOverlay:r,leftOverlay:n,wtTable:i,wtViewport:a,totalRows:o,totalColumns:s,fixedRowsTop:l,fixedRowsBottom:u,fixedColumnsLeft:f}}}]);return t}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(8);var s=r(3);var l=function(){function t(e,r){var a=this;(0,i.default)(this,t);this.wot=e;this.instance=e;this.defaults={table:void 0,debug:false,externalRowCalculator:false,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function e(){return false},preventWheel:false,data:void 0,freezeOverlays:false,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function e(){return[]},columnHeaders:function e(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function e(t,r,n){var i=a.getSetting("data",t,r);(0,o.fastInnerText)(n,i===void 0||i===null?"":i)},columnWidth:function e(){},rowHeight:function e(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:false,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function e(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:false,groups:false,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null};this.settings={};(0,s.objectEach)(this.defaults,function(e,t){if(r[t]!==void 0){a.settings[t]=r[t]}else if(e===void 0){throw new Error('A required setting "'.concat(t,'" was not provided'))}else{a.settings[t]=e}})}(0,a.default)(t,[{key:"update",value:function e(t,r){var n=this;if(r===void 0){(0,s.objectEach)(t,function(e,t){n.settings[t]=e})}else{this.settings[t]=r}return this.wot}},{key:"getSetting",value:function e(t,r,n,i,a){if(typeof this.settings[t]==="function"){return this.settings[t](r,n,i,a)}else if(r!==void 0&&Array.isArray(this.settings[t])){return this.settings[t][r]}return this.settings[t]}},{key:"has",value:function e(t){return!!this.settings[t]}}]);return t}();var u=l;t.default=u},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var v=r(8);var o=r(3);var s=n(r(25));var p=r(447);var l=function(){function r(e){var t=this;(0,i.default)(this,r);this.wot=e;this.instance=this.wot;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.hasOversizedColumnHeadersMarked={};this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;this.eventManager=new s.default(this.wot);this.eventManager.addEventListener(this.wot.rootWindow,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})}(0,a.default)(r,[{key:"getWorkspaceHeight",value:function e(){var t=this.wot.rootDocument;var r=this.instance.wtOverlays.topOverlay.trimmingContainer;var n=0;if(r===this.wot.rootWindow){n=t.documentElement.clientHeight}else{var i=(0,v.outerHeight)(r);n=i>0&&r.clientHeight>0?r.clientHeight:Infinity}return n}},{key:"getWorkspaceWidth",value:function e(){var t=this.wot;var r=t.rootDocument,n=t.rootWindow;var i=this.instance.wtOverlays.leftOverlay.trimmingContainer;var a=r.documentElement.offsetWidth;var o=t.getSetting("totalColumns");var s=t.getSetting("preventOverflow");var l;var u;if(s){return(0,v.outerWidth)(this.instance.wtTable.wtRootElement)}if(t.getSetting("freezeOverlays")){l=Math.min(a-this.getWorkspaceOffset().left,a)}else{l=Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a)}if(i===n&&o>0&&this.sumColumnWidths(0,o-1)>l){return r.documentElement.clientWidth}if(i!==n){u=(0,v.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",n);if(u==="scroll"||u==="hidden"||u==="auto"){return Math.max(l,i.clientWidth)}}var f=t.getSetting("stretchH");if(f==="none"||!f){return Math.max(l,(0,v.outerWidth)(this.instance.wtTable.TABLE))}return l}},{key:"hasVerticalScroll",value:function e(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function e(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function e(t,r){var n=this.wot.wtTable;var i=0;var a=t;while(a<r){i+=n.getColumnWidth(a);a+=1}return i}},{key:"getContainerFillWidth",value:function e(){if(this.containerWidth){return this.containerWidth}var t=this.instance.wtTable.holder;var r=this.wot.rootDocument.createElement("div");r.style.width="100%";r.style.height="1px";t.appendChild(r);var n=r.offsetWidth;this.containerWidth=n;t.removeChild(r);return n}},{key:"getWorkspaceOffset",value:function e(){return(0,v.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function e(){return(0,v.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function e(){var t=this.wot.wtTable;return(0,v.outerWidth)(t.TABLE)||(0,v.outerWidth)(t.TBODY)||(0,v.outerWidth)(t.THEAD)}},{key:"getColumnHeaderHeight",value:function e(){var t=this.instance.getSetting("columnHeaders");if(!t.length){this.columnHeaderHeight=0}else if(isNaN(this.columnHeaderHeight)){this.columnHeaderHeight=(0,v.outerHeight)(this.wot.wtTable.THEAD)}return this.columnHeaderHeight}},{key:"getViewportHeight",value:function e(){var t=this.getWorkspaceHeight();if(t===Infinity){return t}var r=this.getColumnHeaderHeight();if(r>0){t-=r}return t}},{key:"getRowHeaderWidth",value:function e(){var t=this.instance.getSetting("rowHeaderWidth");var r=this.instance.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,i=r.length;n<i;n++){this.rowHeaderWidth+=t[n]||t}}if(this.wot.cloneSource){return this.wot.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){if(r.length){var a=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var o=0,s=r.length;o<s;o++){if(a){this.rowHeaderWidth+=(0,v.outerWidth)(a);a=a.nextSibling}else{this.rowHeaderWidth+=50}}}else{this.rowHeaderWidth=0}}this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth;return this.rowHeaderWidth}},{key:"getViewportWidth",value:function e(){var t=this.getWorkspaceWidth();if(t===Infinity){return t}var r=this.getRowHeaderWidth();if(r>0){return t-r}return t}},{key:"createRowsCalculator",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:p.RENDER_TYPE;var r=this.wot;var n=r.wtSettings,i=r.wtOverlays,a=r.wtTable,o=r.rootDocument;var s;var l;var u;this.rowHeaderWidth=NaN;if(n.settings.renderAllRows&&t===p.RENDER_TYPE){s=Infinity}else{s=this.getViewportHeight()}var f=i.topOverlay.getScrollPosition()-i.topOverlay.getTableParentOffset();if(f<0){f=0}var c=r.getSetting("fixedRowsTop");var d=r.getSetting("fixedRowsBottom");var h=r.getSetting("totalRows");if(c){u=i.topOverlay.sumCellSizes(0,c);f+=u;s-=u}if(d&&i.bottomOverlay.clone){u=i.bottomOverlay.sumCellSizes(h-d,h);s-=u}if(a.holder.clientHeight===a.holder.offsetHeight){l=0}else{l=(0,v.getScrollbarWidth)(o)}return new p.ViewportRowsCalculator({viewportSize:s,scrollOffset:f,totalItems:r.getSetting("totalRows"),itemSizeFn:function e(t){return a.getRowHeight(t)},overrideFn:n.settings.viewportRowCalculatorOverride,calculationType:t,scrollbarHeight:l})}},{key:"createColumnsCalculator",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:p.RENDER_TYPE;var n=this.wot;var r=n.wtSettings,i=n.wtOverlays,a=n.wtTable,o=n.rootDocument;var s=this.getViewportWidth();var l=i.leftOverlay.getScrollPosition()-i.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN;if(l<0){l=0}var u=n.getSetting("fixedColumnsLeft");if(u){var f=i.leftOverlay.sumCellSizes(0,u);l+=f;s-=f}if(a.holder.clientWidth!==a.holder.offsetWidth){s-=(0,v.getScrollbarWidth)(o)}return new p.ViewportColumnsCalculator({viewportSize:s,scrollOffset:l,totalItems:n.getSetting("totalColumns"),itemSizeFn:function e(t){return n.wtTable.getColumnWidth(t)},overrideFn:r.settings.viewportColumnCalculatorOverride,calculationType:t,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function e(t,r){return n.getSetting("onBeforeStretchingColumnWidth",t,r)}})}},{key:"createRenderCalculators",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=t;if(r){var n=this.createRowsCalculator(p.FULLY_VISIBLE_TYPE);var i=this.createColumnsCalculator(p.FULLY_VISIBLE_TYPE);if(!(this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(i))){r=false}}if(!r){this.rowsRenderCalculator=this.createRowsCalculator(p.RENDER_TYPE);this.columnsRenderCalculator=this.createColumnsCalculator(p.RENDER_TYPE)}this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;return r}},{key:"createVisibleCalculators",value:function e(){this.rowsVisibleCalculator=this.createRowsCalculator(p.FULLY_VISIBLE_TYPE);this.columnsVisibleCalculator=this.createColumnsCalculator(p.FULLY_VISIBLE_TYPE)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function e(t){if(!this.rowsVisibleCalculator){return false}var r=t.startRow,n=t.endRow;var i=this.rowsRenderCalculator,a=i.startRow,o=i.endRow;if(r<a||r===a&&r>0){return false}else if(n>o||n===o&&n<this.wot.getSetting("totalRows")-1){return false}return true}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function e(t){if(!this.columnsVisibleCalculator){return false}var r=t.startColumn,n=t.endColumn;var i=this.columnsRenderCalculator,a=i.startColumn,o=i.endColumn;if(r<a||r===a&&r>0){return false}else if(n>o||n===o&&n<this.wot.getSetting("totalColumns")-1){return false}return true}},{key:"resetHasOversizedColumnHeadersMarked",value:function e(){(0,o.objectEach)(this.hasOversizedColumnHeadersMarked,function(e,t,r){r[t]=void 0})}}]);return r}();var u=l;t.default=u},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(3);var i="calculatedRows";var a={getFirstRenderedRow:function e(){var t=this.wot.wtViewport.rowsRenderCalculator.startRow;if(t===null){return-1}return t},getFirstVisibleRow:function e(){var t=this.wot.wtViewport.rowsVisibleCalculator.startRow;if(t===null){return-1}return t},getLastRenderedRow:function e(){var t=this.wot.wtViewport.rowsRenderCalculator.endRow;if(t===null){return-1}return t},getLastVisibleRow:function e(){var t=this.wot.wtViewport.rowsVisibleCalculator.endRow;if(t===null){return-1}return t},getRenderedRowsCount:function e(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function e(){return this.wot.wtViewport.rowsVisibleCalculator.count}};(0,n.defineGetter)(a,"MIXIN_NAME",i,{writable:false,enumerable:false});var o=a;t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(3);var i="stickyRowsTop";var a={getFirstRenderedRow:function e(){var t=this.wot.getSetting("totalRows");if(t===0){return-1}return 0},getFirstVisibleRow:function e(){return this.getFirstRenderedRow()},getLastRenderedRow:function e(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function e(){return this.getLastRenderedRow()},getRenderedRowsCount:function e(){var t=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function e(){return this.getRenderedRowsCount()}};(0,n.defineGetter)(a,"MIXIN_NAME",i,{writable:false,enumerable:false});var o=a;t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(3);var i="stickyRowsBottom";var a={getFirstRenderedRow:function e(){var t=this.wot.getSetting("totalRows");var r=this.wot.getSetting("fixedRowsBottom");var n=t-r;if(n<0){return-1}return n},getFirstVisibleRow:function e(){return this.getFirstRenderedRow()},getLastRenderedRow:function e(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function e(){return this.getLastRenderedRow()},getRenderedRowsCount:function e(){var t=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function e(){return this.getRenderedRowsCount()}};(0,n.defineGetter)(a,"MIXIN_NAME",i,{writable:false,enumerable:false});var o=a;t.default=o},function(e,t,r){"use strict";var n=r(0);r(31);r(54);r(39);t.__esModule=true;t.default=void 0;var Z=n(r(18));var i=n(r(1));var a=n(r(2));var ee=r(8);var l=r(32);var s=r(3);var te=r(71);var o=n(r(25));var re=n(r(118));var u=function(){function r(e,t){(0,i.default)(this,r);if(!t){return}this.eventManager=new o.default(e);this.instance=e;this.wot=e;this.settings=t;this.mouseDown=false;this.main=null;this.top=null;this.left=null;this.bottom=null;this.right=null;this.topStyle=null;this.leftStyle=null;this.bottomStyle=null;this.rightStyle=null;this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"};this.corner=null;this.cornerStyle=null;this.createBorders(t);this.registerListeners()}(0,a.default)(r,[{key:"registerListeners",value:function e(){var n=this;var t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",function(){return n.onMouseDown()});this.eventManager.addEventListener(t,"mouseup",function(){return n.onMouseUp()});var r=function e(t,r){n.eventManager.addEventListener(n.main.childNodes[t],"mouseenter",function(e){return n.onMouseEnter(e,n.main.childNodes[t])})};for(var i=0,a=this.main.childNodes.length;i<a;i++){r(i,a)}}},{key:"onMouseDown",value:function e(){this.mouseDown=true}},{key:"onMouseUp",value:function e(){this.mouseDown=false}},{key:"onMouseEnter",value:function e(t,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver")){return}t.preventDefault();(0,l.stopImmediatePropagation)(t);var n=this;var i=this.wot.rootDocument.body;var a=r.getBoundingClientRect();r.style.display="none";function o(e){if(e.clientY<Math.floor(a.top)){return true}if(e.clientY>Math.ceil(a.top+a.height)){return true}if(e.clientX<Math.floor(a.left)){return true}if(e.clientX>Math.ceil(a.left+a.width)){return true}}function s(e){if(o(e)){n.eventManager.removeEventListener(i,"mousemove",s);r.style.display="block"}}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function e(t){var r=this.wot.rootDocument;this.main=r.createElement("div");var n=["top","left","bottom","right","corner"];var i=this.main.style;i.position="absolute";i.top=0;i.left=0;for(var a=0;a<5;a++){var o=n[a];var s=r.createElement("div");s.className="wtBorder ".concat(this.settings.className||"");if(this.settings[o]&&this.settings[o].hide){s.className+=" hidden"}i=s.style;i.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color;i.height=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(t.border.width,"px");i.width=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(t.border.width,"px");this.main.appendChild(s)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");if((0,te.isMobileBrowser)()){this.createMultipleSelectorHandles()}this.disappear();var l=this.wot.wtTable;var u=l.bordersHolder;if(!u){u=r.createElement("div");u.className="htBorders";l.bordersHolder=u;l.spreader.appendChild(u)}u.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function e(){var r=this;var t=this.wot.rootDocument;this.selectionHandles={topLeft:t.createElement("DIV"),topLeftHitArea:t.createElement("DIV"),bottomRight:t.createElement("DIV"),bottomRightHitArea:t.createElement("DIV")};var n=10;var i=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};(0,s.objectEach)(a,function(e,t){r.selectionHandles.styles.bottomRightHitArea[t]=e;r.selectionHandles.styles.topLeftHitArea[t]=e});var o={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};(0,s.objectEach)(o,function(e,t){r.selectionHandles.styles.bottomRight[t]=e;r.selectionHandles.styles.topLeft[t]=e});this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function e(t,r){var n=this.wot.selections.createOrGetArea();if(n.cellRange){if(t!==n.cellRange.to.row||r!==n.cellRange.to.col){return true}}return false}},{key:"updateMultipleSelectionHandlesPosition",value:function e(t,r,n,i,a,o){var s=parseInt(this.selectionHandles.styles.topLeft.width,10);var l=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(n-s,10),"px");this.selectionHandles.styles.topLeft.left="".concat(parseInt(i-s,10),"px");this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(n-l/4*3,10),"px");this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(i-l/4*3,10),"px");this.selectionHandles.styles.bottomRight.top="".concat(parseInt(n+o,10),"px");this.selectionHandles.styles.bottomRight.left="".concat(parseInt(i+a,10),"px");this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(n+o-l/4,10),"px");this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(i+a-l/4,10),"px");if(this.settings.border.cornerVisible&&this.settings.border.cornerVisible()){this.selectionHandles.styles.topLeft.display="block";this.selectionHandles.styles.topLeftHitArea.display="block";if(this.isPartRange(t,r)){this.selectionHandles.styles.bottomRight.display="none";this.selectionHandles.styles.bottomRightHitArea.display="none"}else{this.selectionHandles.styles.bottomRight.display="block";this.selectionHandles.styles.bottomRightHitArea.display="block"}}else{this.selectionHandles.styles.topLeft.display="none";this.selectionHandles.styles.bottomRight.display="none";this.selectionHandles.styles.topLeftHitArea.display="none";this.selectionHandles.styles.bottomRightHitArea.display="none"}if(t===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsLeft")){this.selectionHandles.styles.topLeft.zIndex="9999";this.selectionHandles.styles.topLeftHitArea.zIndex="9999"}else{this.selectionHandles.styles.topLeft.zIndex="";this.selectionHandles.styles.topLeftHitArea.zIndex=""}}},{key:"appear",value:function e(t){if(this.disabled){return}var r=this.wot,n=r.wtTable,i=r.rootDocument,a=r.rootWindow;var o;var s;var l;var u;var f=n.getRenderedRowsCount();for(var c=0;c<f;c+=1){var d=n.rowFilter.renderedToSource(c);if(d>=t[0]&&d<=t[2]){o=d;break}}for(var h=f-1;h>=0;h-=1){var v=n.rowFilter.renderedToSource(h);if(v>=t[0]&&v<=t[2]){s=v;break}}var p=n.getRenderedColumnsCount();for(var g=0;g<p;g+=1){var m=n.columnFilter.renderedToSource(g);if(m>=t[1]&&m<=t[3]){l=m;break}}for(var y=p-1;y>=0;y-=1){var b=n.columnFilter.renderedToSource(y);if(b>=t[1]&&b<=t[3]){u=b;break}}if(o===void 0||l===void 0){this.disappear();return}var w=n.getCell(new re.default(o,l));var C=o!==s||l!==u;var S=C?n.getCell(new re.default(s,u)):w;var E=(0,ee.offset)(w);var k=C?(0,ee.offset)(S):E;var T=(0,ee.offset)(n.TABLE);var _=E.top;var x=E.left;var D=x-T.left-1;var R=k.left+(0,ee.outerWidth)(S)-x;if(this.isEntireColumnSelected(o,s)){var I=this.getDimensionsFromHeader("columns",l,u,T);var O=null;if(I){var A=(0,Z.default)(I,3);O=A[0];D=A[1];R=A[2]}if(O){w=O}}var N=_-T.top-1;var M=k.top+(0,ee.outerHeight)(S)-_;if(this.isEntireRowSelected(l,u)){var L=this.getDimensionsFromHeader("rows",o,s,T);var P=null;if(L){var F=(0,Z.default)(L,3);P=F[0];N=F[1];M=F[2]}if(P){w=P}}var B=(0,ee.getComputedStyle)(w,a);if(parseInt(B.borderTopWidth,10)>0){N+=1;M=M>0?M-1:0}if(parseInt(B.borderLeftWidth,10)>0){D+=1;R=R>0?R-1:0}this.topStyle.top="".concat(N,"px");this.topStyle.left="".concat(D,"px");this.topStyle.width="".concat(R,"px");this.topStyle.display="block";this.leftStyle.top="".concat(N,"px");this.leftStyle.left="".concat(D,"px");this.leftStyle.height="".concat(M,"px");this.leftStyle.display="block";var H=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(N+M-H,"px");this.bottomStyle.left="".concat(D,"px");this.bottomStyle.width="".concat(R,"px");this.bottomStyle.display="block";this.rightStyle.top="".concat(N,"px");this.rightStyle.left="".concat(D+R-H,"px");this.rightStyle.height="".concat(M+1,"px");this.rightStyle.display="block";var $=this.settings.border.cornerVisible;$=typeof $==="function"?$(this.settings.layerLevel):$;var W=this.wot.getSetting("onModifyGetCellCoords",s,u);var U=s,j=u;if(W&&Array.isArray(W)){var V=(0,Z.default)(W,4);U=V[2];j=V[3]}if((0,te.isMobileBrowser)()||!$||this.isPartRange(U,j)){this.cornerStyle.display="none"}else{this.cornerStyle.top="".concat(N+M-4,"px");this.cornerStyle.left="".concat(D+R-4,"px");this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.display="none";var z=(0,ee.getTrimmingContainer)(n.TABLE);var q=z===a;if(q){z=i.documentElement}if(u===this.wot.getSetting("totalColumns")-1){var Y=q?S.getBoundingClientRect().left:S.offsetLeft;var G=Y+(0,ee.outerWidth)(S)+parseInt(this.cornerDefaultStyle.width,10)/2;var X=G>=(0,ee.innerWidth)(z);if(X){this.cornerStyle.left="".concat(Math.floor(D+R-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px");this.cornerStyle.borderRightWidth=0}}if(s===this.wot.getSetting("totalRows")-1){var K=q?S.getBoundingClientRect().top:S.offsetTop;var J=K+(0,ee.outerHeight)(S)+parseInt(this.cornerDefaultStyle.height,10)/2;var Q=J>=(0,ee.innerHeight)(z);if(Q){this.cornerStyle.top="".concat(Math.floor(N+M-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px");this.cornerStyle.borderBottomWidth=0}}this.cornerStyle.display="block"}if((0,te.isMobileBrowser)()){this.updateMultipleSelectionHandlesPosition(s,u,N,D,R,M)}}},{key:"isEntireColumnSelected",value:function e(t,r){return t===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function e(t,r){return t===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function e(t,r,n,i){var a=this.wot.wtTable;var o=a.wtRootElement.parentNode;var s=null;var l=null;var u=null;var f=null;var c=null;var d=null;var h=null;var v=null;switch(t){case"rows":s=function e(){return a.getRowHeader.apply(a,arguments)};l=function e(){return ee.outerHeight.apply(void 0,arguments)};u="ht__selection--rows";d="top";break;case"columns":s=function e(){return a.getColumnHeader.apply(a,arguments)};l=function e(){return ee.outerWidth.apply(void 0,arguments)};u="ht__selection--columns";d="left";break;default:}if(o.className.includes(u)){var p=this.wot.getSetting("columnHeaders").length;h=s(r,p-1);v=s(n,p-1);if(!h||!v){return false}var g=(0,ee.offset)(h);var m=(0,ee.offset)(v);if(h&&v){f=g[d]-i[d]-1;c=m[d]+l(v)-g[d]}return[h,f,c]}return false}},{key:"changeBorderStyle",value:function e(t,r){var n=this[t].style;var i=r[t];if(!i||i.hide){(0,ee.addClass)(this[t],"hidden")}else{if((0,ee.hasClass)(this[t],"hidden")){(0,ee.removeClass)(this[t],"hidden")}n.backgroundColor=i.color;if(t==="top"||t==="bottom"){n.height="".concat(i.width,"px")}if(t==="right"||t==="left"){n.width="".concat(i.width,"px")}}}},{key:"changeBorderToDefaultStyle",value:function e(t){var r={width:1,color:"#000"};var n=this[t].style;n.backgroundColor=r.color;n.width="".concat(r.width,"px");n.height="".concat(r.width,"px")}},{key:"toggleHiddenClass",value:function e(t,r){this.changeBorderToDefaultStyle(t);if(r){(0,ee.addClass)(this[t],"hidden")}else{(0,ee.removeClass)(this[t],"hidden")}}},{key:"disappear",value:function e(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";if((0,te.isMobileBrowser)()){this.selectionHandles.styles.topLeft.display="none";this.selectionHandles.styles.bottomRight.display="none"}}},{key:"destroy",value:function e(){this.eventManager.destroyWithOwnEventsOnly();this.main.parentNode.removeChild(this.main)}}]);return r}();var f=u;t.default=f},function(e,t,r){var n=r(20);var i=r(461).values;n({target:"Object",stat:true},{values:function e(t){return i(t)}})},function(e,t,r){"use strict";var n=r(0);r(50);r(146);r(12);r(15);r(78);r(10);r(23);r(13);r(40);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=r(55);var p=r(29);var d=r(74);var h=r(4);var g=r(8);var v=n(r(376));var m=new WeakMap;var y=function(e){(0,f.default)(v,e);function v(e){var t;(0,i.default)(this,v);t=(0,o.default)(this,(0,l.default)(v).call(this,e));t.query=null;t.strippedChoices=[];t.rawChoices=[];m.set((0,s.default)(t),{skipOne:false});return t}(0,a.default)(v,[{key:"getValue",value:function e(){var r=this;var t=this.rawChoices.find(function(e){var t=r.stripValueIfNeeded(e);return t===r.TEXTAREA.value});if((0,p.isDefined)(t)){return t}return this.TEXTAREA.value}},{key:"createElements",value:function e(){(0,u.default)((0,l.default)(v.prototype),"createElements",this).call(this);(0,g.addClass)(this.htContainer,"autocompleteEditor");(0,g.addClass)(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function e(){var h=this;var t=m.get(this);this.TEXTAREA_PARENT.style.overflow="auto";(0,u.default)((0,l.default)(v.prototype),"open",this).call(this);this.TEXTAREA_PARENT.style.overflow="";var r=this.htEditor.getInstance();var o=this.cellProperties.trimDropdown===void 0?true:this.cellProperties.trimDropdown;this.showEditableElement();this.focus();var n=(0,g.getScrollbarWidth)(this.hot.rootDocument);r.updateSettings({colWidths:o?[(0,g.outerWidth)(this.TEXTAREA)-2]:void 0,width:o?(0,g.outerWidth)(this.TEXTAREA)+n+2:void 0,afterRenderer:function e(t,r,n,i,a){var o=h.cellProperties,s=o.filteringCaseSensitive,l=o.allowHtml;var u=h.query;var f=(0,p.stringify)(a);var c;var d;if(f&&!l){c=s===true?f.indexOf(u):f.toLowerCase().indexOf(u.toLowerCase());if(c!==-1){d=f.substr(c,u.length);f=f.replace(d,"<strong>".concat(d,"</strong>"))}}t.innerHTML=f},autoColumnSize:true,modifyColWidth:function e(t,r){var n=this.getPlugin("autoColumnSize");var i=t;if(n){var a=n.widths;if(a[r]){i=a[r]}}return o?i:i+15}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]="".concat(n+2,"px");if(t.skipOne){t.skipOne=false}this.hot._registerTimeout(function(){h.queryChoices(h.TEXTAREA.value)})}},{key:"close",value:function e(){this.removeHooksByKey("beforeKeyDown");(0,u.default)((0,l.default)(v.prototype),"close",this).call(this)}},{key:"discardEditor",value:function e(t){(0,u.default)((0,l.default)(v.prototype),"discardEditor",this).call(this,t);this.hot.view.render()}},{key:"queryChoices",value:function e(t){var r=this;var n=this.cellProperties.source;this.query=t;if(typeof n==="function"){n.call(this.cellProperties,t,function(e){r.rawChoices=e;r.updateChoicesList(r.stripValuesIfNeeded(e))})}else if(Array.isArray(n)){this.rawChoices=n;this.updateChoicesList(this.stripValuesIfNeeded(n))}else{this.updateChoicesList([])}}},{key:"updateChoicesList",value:function e(t){var r=(0,g.getCaretPosition)(this.TEXTAREA);var n=(0,g.getSelectionEndPosition)(this.TEXTAREA);var i=this.cellProperties.sortByRelevance;var a=this.cellProperties.filter;var o=null;var s=null;var l=t;if(i){o=v.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive)}var u=Array.isArray(o)?o.length:0;if(a===false){if(u){s=o[0]}}else{var f=[];for(var c=0,d=l.length;c<d;c++){if(i&&u<=c){break}if(u){f.push(l[o[c]])}else{f.push(l[c])}}s=0;l=f}this.strippedChoices=l;this.htEditor.loadData((0,h.pivot)([l]));this.updateDropdownHeight();this.flipDropdownIfNeeded();if(this.cellProperties.strict===true){this.highlightBestMatchingChoice(s)}this.hot.listen(false);(0,g.setCaretPosition)(this.TEXTAREA,r,r===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function e(){var t=(0,g.offset)(this.TEXTAREA);var r=(0,g.outerHeight)(this.TEXTAREA);var n=this.getDropdownHeight();var i=(0,g.getTrimmingContainer)(this.hot.view.wt.wtTable.TABLE);var a=i.scrollTop;var o=(0,g.outerHeight)(this.hot.view.wt.wtTable.THEAD);var s={row:0,col:0};if(i!==this.hot.rootWindow){s=(0,g.offset)(i)}var l=t.top-s.top-o+a;var u=i.scrollHeight-l-o-r;var f=n>u&&l>u;if(f){this.flipDropdown(n)}else{this.unflipDropdown()}this.limitDropdownIfNeeded(f?l:u,n);return f}},{key:"limitDropdownIfNeeded",value:function e(t,r){if(r>t){var n=0;var i=0;var a=0;var o=null;do{a=this.htEditor.getRowHeight(i)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;n+=a;i+=1}while(n<t);o=n-a;if(this.htEditor.flipped){this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+r-o,"px")}this.setDropdownHeight(n-a)}}},{key:"flipDropdown",value:function e(t){var r=this.htEditor.rootElement.style;r.position="absolute";r.top="".concat(-t,"px");this.htEditor.flipped=true}},{key:"unflipDropdown",value:function e(){var t=this.htEditor.rootElement.style;if(t.position==="absolute"){t.position="";t.top=""}this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function e(){var t=this.htEditor.getColWidth(0)+(0,g.getScrollbarWidth)(this.hot.rootDocument)+2;var r=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:r?void 0:t});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function e(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function e(t){if(typeof t==="number"){this.htEditor.selectCell(t,0,void 0,void 0,void 0,false)}else{this.htEditor.deselectCell()}}},{key:"getDropdownHeight",value:function e(){var t=this.htEditor.getInstance().getRowHeight(0)||23;var r=this.cellProperties.visibleRows;return this.strippedChoices.length>=r?r*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function e(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function e(t){var r=this.cellProperties.allowHtml;var n=(0,h.arrayMap)(t,function(e){return(0,p.stringify)(e)});var i=(0,h.arrayMap)(n,function(e){return r?e:(0,d.stripTags)(e)});return i}},{key:"allowKeyEventPropagation",value:function e(t){var r=this.htEditor.getSelectedRangeLast();var n={row:r?r.from.row:-1};var i=false;if(t===c.KEY_CODES.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1){i=true}if(t===c.KEY_CODES.ARROW_UP&&n.row>-1){i=true}return i}},{key:"onBeforeKeyDown",value:function e(t){var r=this;var n=m.get(this);n.skipOne=false;if((0,c.isPrintableChar)(t.keyCode)||t.keyCode===c.KEY_CODES.BACKSPACE||t.keyCode===c.KEY_CODES.DELETE||t.keyCode===c.KEY_CODES.INSERT){var i=0;if(t.keyCode===c.KEY_CODES.C&&(t.ctrlKey||t.metaKey)){return}if(!this.isOpened()){i+=10}if(this.htEditor){this.hot._registerTimeout(function(){r.queryChoices(r.TEXTAREA.value);n.skipOne=true},i)}}(0,u.default)((0,l.default)(v.prototype),"onBeforeKeyDown",this).call(this,t)}}]);return v}(v.default);y.sortByRelevance=function(e,t,r){var n=[];var i;var a=e.length;var o;var s;var l=[];var u;var f=t.length;if(a===0){for(u=0;u<f;u++){l.push(u)}return l}for(u=0;u<f;u++){i=(0,d.stripTags)((0,p.stringify)(t[u]));if(r){o=i.indexOf(e)}else{o=i.toLowerCase().indexOf(e.toLowerCase())}if(o!==-1){s=i.length-o-a;n.push({baseIndex:u,index:o,charsLeft:s,value:i})}}n.sort(function(e,t){if(t.index===-1){return-1}if(e.index===-1){return 1}if(e.index<t.index){return-1}else if(t.index<e.index){return 1}else if(e.index===t.index){if(e.charsLeft<t.charsLeft){return-1}else if(e.charsLeft>t.charsLeft){return 1}}return 0});for(u=0,f=n.length;u<f;u++){l.push(n[u].baseIndex)}return l};var b=y;t.default=b},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var f=n(r(5));var c=n(r(14));var s=n(r(7));var l=r(55);var d=r(3);var h=r(8);var v=r(32);var u=n(r(123));var p=function(e){(0,s.default)(u,e);function u(){(0,i.default)(this,u);return(0,o.default)(this,(0,f.default)(u).apply(this,arguments))}(0,a.default)(u,[{key:"open",value:function e(){(0,c.default)((0,f.default)(u.prototype),"open",this).call(this);if(this.htEditor){this.htEditor.destroy()}if(this.htContainer.style.display==="none"){this.htContainer.style.display=""}this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions);this.htEditor.init();this.htEditor.rootElement.style.display="";if(this.cellProperties.strict){this.htEditor.selectCell(0,0)}else{this.htEditor.deselectCell()}(0,h.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function e(){if(this.htEditor){this.htEditor.rootElement.style.display="none"}this.removeHooksByKey("beforeKeyDown");(0,c.default)((0,f.default)(u.prototype),"close",this).call(this)}},{key:"prepare",value:function e(t,r,n,i,a,o){(0,c.default)((0,f.default)(u.prototype),"prepare",this).call(this,t,r,n,i,a,o);var s=this;var l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:false,autoColumnSize:false,autoRowSize:false,readOnly:true,fillHandle:false,autoWrapCol:false,autoWrapRow:false,afterOnCellMouseDown:function e(t,r){var n=this.getSourceData(r.row,r.col);if(n!==void 0){s.setValue(n)}s.instance.destroyEditor()},preventWheel:true};if(this.cellProperties.handsontable){(0,d.extend)(l,o.handsontable)}this.htOptions=l}},{key:"beginEditing",value:function e(t,r){var n=this.hot.getSettings().onBeginEditing;if(n&&n()===false){return}(0,c.default)((0,f.default)(u.prototype),"beginEditing",this).call(this,t,r)}},{key:"focus",value:function e(t){(0,c.default)((0,f.default)(u.prototype),"focus",this).call(this,t)}},{key:"createElements",value:function e(){(0,c.default)((0,f.default)(u.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(t);this.htContainer=t;this.assignHooks()}},{key:"finishEditing",value:function e(t,r,n){if(this.htEditor&&this.htEditor.isListening()){this.hot.listen()}if(this.htEditor&&this.htEditor.getSelectedLast()){var i=this.htEditor.getInstance().getValue();if(i!==void 0){this.setValue(i)}}return(0,c.default)((0,f.default)(u.prototype),"finishEditing",this).call(this,t,r,n)}},{key:"assignHooks",value:function e(){var t=this;this.hot.addHook("afterDestroy",function(){if(t.htEditor){t.htEditor.destroy()}})}},{key:"onBeforeKeyDown",value:function e(t){if((0,v.isImmediatePropagationStopped)(t)){return}var r=this.htEditor.getInstance();var n;var i;if(t.keyCode===l.KEY_CODES.ARROW_DOWN){if(!r.getSelectedLast()&&!r.flipped){n=0}else if(r.getSelectedLast()){if(r.flipped){n=r.getSelectedLast()[0]+1}else if(!r.flipped){var a=r.countRows()-1;i=r.getSelectedLast()[0];n=Math.min(a,i+1)}}}else if(t.keyCode===l.KEY_CODES.ARROW_UP){if(!r.getSelectedLast()&&r.flipped){n=r.countRows()-1}else if(r.getSelectedLast()){if(r.flipped){i=r.getSelectedLast()[0];n=Math.max(0,i-1)}else{i=r.getSelectedLast()[0];n=i-1}}}if(n!==void 0){if(n<0||r.flipped&&n>r.countRows()-1){r.deselectCell()}else{r.selectCell(n,0)}if(r.getData().length){t.preventDefault();(0,v.stopImmediatePropagation)(t);this.hot.listen();this.TEXTAREA.focus()}}(0,c.default)((0,f.default)(u.prototype),"onBeforeKeyDown",this).call(this,t)}}]);return u}(u.default);var g=p;t.default=g},function(t,e,r){var c;var c;!function(e){if(true)t.exports=e();else{}}(function(){return function a(o,s,l){function u(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof c&&c;if(!e&&r)return c(t,!0);if(f)return f(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return u(o[t][1][e]||e)},i,i.exports,a,o,s,l)}return s[t].exports}for(var f="function"==typeof c&&c,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,r,t){!function(e){"use strict";var t,O=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,A=Math.ceil,N=Math.floor,M="[BigNumber Error] ",L=M+"Number primitive has more than 15 significant digits: ",P=1e14,F=14,B=9007199254740991,H=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],$=1e7,W=1e9;function U(e){var t=0|e;return 0<e||e===t?t:t-1}function j(e){for(var t,r,n=1,i=e.length,a=e[0]+"";n<i;){for(t=e[n++]+"",r=F-t.length;r--;t="0"+t);a+=t}for(i=a.length;48===a.charCodeAt(--i););return a.slice(0,i+1||1)}function V(e,t){var r,n,i=e.c,a=t.c,o=e.s,s=t.s,l=e.e,u=t.e;if(!o||!s)return null;if(r=i&&!i[0],n=a&&!a[0],r||n)return r?n?0:-s:o;if(o!=s)return o;if(r=o<0,n=l==u,!i||!a)return n?0:!i^r?1:-1;if(!n)return u<l^r?1:-1;for(s=(l=i.length)<(u=a.length)?l:u,o=0;o<s;o++)if(i[o]!=a[o])return i[o]>a[o]^r?1:-1;return l==u?0:u<l^r?1:-1}function z(e,t,r,n){if(e<t||r<e||e!==(e<0?A(e):N(e)))throw Error(M+(n||"Argument")+("number"==typeof e?e<t||r<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function q(e){var t=e.c.length-1;return U(e.e/F)==t&&e.c[t]%2!=0}function Y(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function G(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(t=function e(t){var y,c,d,r,u,o,s,l,f,h,n=D.prototype={constructor:D,toString:null,valueOf:null},p=new D(1),b=20,w=4,v=-7,g=21,m=-1e7,C=1e7,S=!1,a=1,E=0,k={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},T="0123456789abcdefghijklmnopqrstuvwxyz";function D(e,t){var r,n,i,a,o,s,l,u,f=this;if(!(f instanceof D))return new D(e,t);if(null==t){if(e instanceof D)return f.s=e.s,f.e=e.e,void(f.c=(e=e.c)?e.slice():e);if((s="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,o=e;10<=o;o/=10,a++);return f.e=a,void(f.c=[e])}u=String(e)}else{if(u=String(e),!O.test(u))return d(f,u,s);f.s=45==u.charCodeAt(0)?(u=u.slice(1),-1):1}-1<(a=u.indexOf("."))&&(u=u.replace(".","")),0<(o=u.search(/e/i))?(a<0&&(a=o),a+=+u.slice(o+1),u=u.substring(0,o)):a<0&&(a=u.length)}else{if(z(t,2,T.length,"Base"),u=String(e),10==t)return R(f=new D(e instanceof D?e:u),b+f.e+1,w);if(s="number"==typeof e){if(0*e!=0)return d(f,u,s,t);if(f.s=1/e<0?(u=u.slice(1),-1):1,D.DEBUG&&15<u.replace(/^0\.0*|\./,"").length)throw Error(L+e);s=!1}else f.s=45===u.charCodeAt(0)?(u=u.slice(1),-1):1;for(r=T.slice(0,t),a=o=0,l=u.length;o<l;o++)if(r.indexOf(n=u.charAt(o))<0){if("."==n){if(a<o){a=l;continue}}else if(!i&&(u==u.toUpperCase()&&(u=u.toLowerCase())||u==u.toLowerCase()&&(u=u.toUpperCase()))){i=!0,o=-1,a=0;continue}return d(f,String(e),s,t)}-1<(a=(u=c(u,t,10,f.s)).indexOf("."))?u=u.replace(".",""):a=u.length}for(o=0;48===u.charCodeAt(o);o++);for(l=u.length;48===u.charCodeAt(--l););if(u=u.slice(o,++l)){if(l-=o,s&&D.DEBUG&&15<l&&(B<e||e!==N(e)))throw Error(L+f.s*e);if(C<(a=a-o-1))f.c=f.e=null;else if(a<m)f.c=[f.e=0];else{if(f.e=a,f.c=[],o=(a+1)%F,a<0&&(o+=F),o<l){for(o&&f.c.push(+u.slice(0,o)),l-=F;o<l;)f.c.push(+u.slice(o,o+=F));u=u.slice(o),o=F-u.length}else o-=l;for(;o--;u+="0");f.c.push(+u)}}else f.c=[f.e=0]}function i(e,t,r,n){var i,a,o,s,l;if(null==r?r=w:z(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)l=j(e.c),l=1==n||2==n&&(o<=v||g<=o)?Y(l,o):G(l,o,"0");else if(a=(e=R(new D(e),t,r)).e,s=(l=j(e.c)).length,1==n||2==n&&(t<=a||a<=v)){for(;s<t;l+="0",s++);l=Y(l,a)}else if(t-=o,l=G(l,a,"0"),s<a+1){if(0<--t)for(l+=".";t--;l+="0");}else if(0<(t+=a-s))for(a+1==s&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function _(e,t){for(var r,n=1,i=new D(e[0]);n<e.length;n++){if(!(r=new D(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function x(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,n++);return(r=n+r*F-1)>C?e.c=e.e=null:e.c=r<m?[e.e=0]:(e.e=r,t),e}function R(e,t,r,n){var i,a,o,s,l,u,f,c=e.c,d=H;if(c){e:{for(i=1,s=c[0];10<=s;s/=10,i++);if((a=t-i)<0)a+=F,o=t,f=(l=c[u=0])/d[i-o-1]%10|0;else if((u=A((a+1)/F))>=c.length){if(!n)break e;for(;c.length<=u;c.push(0));l=f=0,o=(a%=F)-F+(i=1)}else{for(l=s=c[u],i=1;10<=s;s/=10,i++);f=(o=(a%=F)-F+i)<0?0:l/d[i-o-1]%10|0}if(n=n||t<0||null!=c[u+1]||(o<0?l:l%d[i-o-1]),n=r<4?(f||n)&&(0==r||r==(e.s<0?3:2)):5<f||5==f&&(4==r||n||6==r&&(0<a?0<o?l/d[i-o]:0:c[u-1])%10&1||r==(e.s<0?8:7)),t<1||!c[0])return c.length=0,n?(t-=e.e+1,c[0]=d[(F-t%F)%F],e.e=-t||0):c[0]=e.e=0,e;if(0==a?(c.length=u,s=1,u--):(c.length=u+1,s=d[F-a],c[u]=0<o?N(l/d[i-o]%d[o])*s:0),n)for(;;){if(0==u){for(a=1,o=c[0];10<=o;o/=10,a++);for(o=c[0]+=s,s=1;10<=o;o/=10,s++);a!=s&&(e.e++,c[0]==P&&(c[0]=1));break}if(c[u]+=s,c[u]!=P)break;c[u--]=0,s=1}for(a=c.length;0===c[--a];c.pop());}e.e>C?e.c=e.e=null:e.e<m&&(e.c=[e.e=0])}return e}function I(e){var t,r=e.e;return null===r?e.toString():(t=j(e.c),t=r<=v||g<=r?Y(t,r):G(t,r,"0"),e.s<0?"-"+t:t)}return D.clone=e,D.ROUND_UP=0,D.ROUND_DOWN=1,D.ROUND_CEIL=2,D.ROUND_FLOOR=3,D.ROUND_HALF_UP=4,D.ROUND_HALF_DOWN=5,D.ROUND_HALF_EVEN=6,D.ROUND_HALF_CEIL=7,D.ROUND_HALF_FLOOR=8,D.EUCLID=9,D.config=D.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(M+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(z(r=e[t],0,W,t),b=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(z(r=e[t],0,8,t),w=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(z(r[0],-W,0,t),z(r[1],0,W,t),v=r[0],g=r[1]):(z(r,-W,W,t),v=-(g=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)z(r[0],-W,-1,t),z(r[1],1,W,t),m=r[0],C=r[1];else{if(z(r,-W,W,t),!r)throw Error(M+t+" cannot be zero: "+r);m=-(C=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(M+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw S=!r,Error(M+"crypto unavailable");S=r}else S=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(z(r=e[t],0,9,t),a=r),e.hasOwnProperty(t="POW_PRECISION")&&(z(r=e[t],0,W,t),E=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(M+t+" not an object: "+r);k=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.$|[+-.\s]|(.).*\1/.test(r))throw Error(M+t+" invalid: "+r);T=r}}return{DECIMAL_PLACES:b,ROUNDING_MODE:w,EXPONENTIAL_AT:[v,g],RANGE:[m,C],CRYPTO:S,MODULO_MODE:a,POW_PRECISION:E,FORMAT:k,ALPHABET:T}},D.isBigNumber=function(e){return e instanceof D||e&&!0===e._isBigNumber||!1},D.maximum=D.max=function(){return _(arguments,n.lt)},D.minimum=D.min=function(){return _(arguments,n.gt)},D.random=(r=9007199254740992,u=Math.random()*r&2097151?function(){return N(Math.random()*r)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,i,a,o=0,s=[],l=new D(p);if(null==e?e=b:z(e,0,W),i=A(e/F),S)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));o<i;)9e15<=(a=131072*t[o]+(t[o+1]>>>11))?(r=crypto.getRandomValues(new Uint32Array(2)),t[o]=r[0],t[o+1]=r[1]):(s.push(a%1e14),o+=2);o=i/2}else{if(!crypto.randomBytes)throw S=!1,Error(M+"crypto unavailable");for(t=crypto.randomBytes(i*=7);o<i;)9e15<=(a=281474976710656*(31&t[o])+1099511627776*t[o+1]+4294967296*t[o+2]+16777216*t[o+3]+(t[o+4]<<16)+(t[o+5]<<8)+t[o+6])?crypto.randomBytes(7).copy(t,o):(s.push(a%1e14),o+=7);o=i/7}if(!S)for(;o<i;)(a=u())<9e15&&(s[o++]=a%1e14);for(i=s[--o],e%=F,i&&e&&(a=H[F-e],s[o]=N(i/a)*a);0===s[o];s.pop(),o--);if(o<0)s=[n=0];else{for(n=-1;0===s[0];s.splice(0,1),n-=F);for(o=1,a=s[0];10<=a;a/=10,o++);o<F&&(n-=F-o)}return l.e=n,l.c=s,l}),D.sum=function(){for(var e=1,t=arguments,r=new D(t[0]);e<t.length;)r=r.plus(t[e++]);return r},c=function(){var g="0123456789";function m(e,t,r,n){for(var i,a,o=[0],s=0,l=e.length;s<l;){for(a=o.length;a--;o[a]*=t);for(o[0]+=n.indexOf(e.charAt(s++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(e,t,r,n,i){var a,o,s,l,u,f,c,d,h=e.indexOf("."),v=b,p=w;for(0<=h&&(l=E,E=0,e=e.replace(".",""),f=(d=new D(t)).pow(e.length-h),E=l,d.c=m(G(j(f.c),f.e,"0"),10,r,g),d.e=d.c.length),s=l=(c=m(e,t,r,i?(a=T,g):(a=g,T))).length;0==c[--l];c.pop());if(!c[0])return a.charAt(0);if(h<0?--s:(f.c=c,f.e=s,f.s=n,c=(f=y(f,d,v,p,r)).c,u=f.r,s=f.e),h=c[o=s+v+1],l=r/2,u=u||o<0||null!=c[o+1],u=p<4?(null!=h||u)&&(0==p||p==(f.s<0?3:2)):l<h||h==l&&(4==p||u||6==p&&1&c[o-1]||p==(f.s<0?8:7)),o<1||!c[0])e=u?G(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(c.length=o,u)for(--r;++c[--o]>r;)c[o]=0,o||(++s,c=[1].concat(c));for(l=c.length;!c[--l];);for(h=0,e="";h<=l;e+=a.charAt(c[h++]));e=G(e,s,a.charAt(0))}return e}}(),y=function(){function T(e,t,r){var n,i,a,o,s=0,l=e.length,u=t%$,f=t/$|0;for(e=e.slice();l--;)s=((i=u*(a=e[l]%$)+(n=f*a+(o=e[l]/$|0)*u)%$*$+s)/r|0)+(n/$|0)+f*o,e[l]=i%r;return s&&(e=[s].concat(e)),e}function _(e,t,r,n){var i,a;if(r!=n)a=n<r?1:-1;else for(i=a=0;i<r;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function x(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(e,t,r,n,i){var a,o,s,l,u,f,c,d,h,v,p,g,m,y,b,w,C,S=e.s==t.s?1:-1,E=e.c,k=t.c;if(!(E&&E[0]&&k&&k[0]))return new D(e.s&&t.s&&(E?!k||E[0]!=k[0]:k)?E&&0==E[0]||!k?0*S:S/0:NaN);for(h=(d=new D(S)).c=[],S=r+(o=e.e-t.e)+1,i||(i=P,o=U(e.e/F)-U(t.e/F),S=S/F|0),s=0;k[s]==(E[s]||0);s++);if(k[s]>(E[s]||0)&&o--,S<0)h.push(1),l=!0;else{for(y=E.length,w=k.length,S+=2,1<(u=N(i/(k[s=0]+1)))&&(k=T(k,u,i),E=T(E,u,i),w=k.length,y=E.length),m=w,p=(v=E.slice(0,w)).length;p<w;v[p++]=0);C=k.slice(),C=[0].concat(C),b=k[0],k[1]>=i/2&&b++;do{if(u=0,(a=_(k,v,w,p))<0){if(g=v[0],w!=p&&(g=g*i+(v[1]||0)),1<(u=N(g/b)))for(i<=u&&(u=i-1),c=(f=T(k,u,i)).length,p=v.length;1==_(f,v,c,p);)u--,x(f,w<c?C:k,c,i),c=f.length,a=1;else 0==u&&(a=u=1),c=(f=k.slice()).length;if(c<p&&(f=[0].concat(f)),x(v,f,p,i),p=v.length,-1==a)for(;_(k,v,w,p)<1;)u++,x(v,w<p?C:k,p,i),p=v.length}else 0===a&&(u++,v=[0]);h[s++]=u,v[0]?v[p++]=E[m]||0:(v=[E[m]],p=1)}while((m++<y||null!=v[0])&&S--);l=null!=v[0],h[0]||h.splice(0,1)}if(i==P){for(s=1,S=h[0];10<=S;S/=10,s++);R(d,r+(d.e=s+o*F-1)+1,n,l)}else d.e=o,d.r=+l;return d}}(),o=/^(-?)0([xbo])(?=\w[\w.]*$)/i,s=/^([^.]+)\.$/,l=/^\.([^.]+)$/,f=/^-?(Infinity|NaN)$/,h=/^\s*\+(?=[\w.])|^\s+|\s+$/g,d=function(e,t,r,n){var i,a=r?t:t.replace(h,"");if(f.test(a))e.s=isNaN(a)?null:a<0?-1:1,e.c=e.e=null;else{if(!r&&(a=a.replace(o,function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t}),n&&(i=n,a=a.replace(s,"$1").replace(l,"0.$1")),t!=a))return new D(a,i);if(D.DEBUG)throw Error(M+"Not a"+(n?" base "+n:"")+" number: "+t);e.c=e.e=e.s=null}},n.absoluteValue=n.abs=function(){var e=new D(this);return e.s<0&&(e.s=1),e},n.comparedTo=function(e,t){return V(this,new D(e,t))},n.decimalPlaces=n.dp=function(e,t){var r,n,i;if(null!=e)return z(e,0,W),null==t?t=w:z(t,0,8),R(new D(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((i=r.length-1)-U(this.e/F))*F,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},n.dividedBy=n.div=function(e,t){return y(this,new D(e,t),b,w)},n.dividedToIntegerBy=n.idiv=function(e,t){return y(this,new D(e,t),0,1)},n.exponentiatedBy=n.pow=function(e,t){var r,n,i,a,o,s,l,u,f=this;if((e=new D(e)).c&&!e.isInteger())throw Error(M+"Exponent not an integer: "+I(e));if(null!=t&&(t=new D(t)),o=14<e.e,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!e.c||!e.c[0])return u=new D(Math.pow(+I(f),o?2-q(e):+I(e))),t?u.mod(t):u;if(s=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new D(NaN);(n=!s&&f.isInteger()&&t.isInteger())&&(f=f.mod(t))}else{if(9<e.e&&(0<f.e||f.e<-1||(0==f.e?1<f.c[0]||o&&24e7<=f.c[1]:f.c[0]<8e13||o&&f.c[0]<=9999975e7)))return a=f.s<0&&q(e)?-0:0,-1<f.e&&(a=1/a),new D(s?1/a:a);E&&(a=A(E/F+2))}for(l=o?(r=new D(.5),s&&(e.s=1),q(e)):(i=Math.abs(+I(e)))%2,u=new D(p);;){if(l){if(!(u=u.times(f)).c)break;a?u.c.length>a&&(u.c.length=a):n&&(u=u.mod(t))}if(i){if(0===(i=N(i/2)))break;l=i%2}else if(R(e=e.times(r),e.e+1,1),14<e.e)l=q(e);else{if(0==(i=+I(e)))break;l=i%2}f=f.times(f),a?f.c&&f.c.length>a&&(f.c.length=a):n&&(f=f.mod(t))}return n?u:(s&&(u=p.div(u)),t?u.mod(t):a?R(u,E,w,void 0):u)},n.integerValue=function(e){var t=new D(this);return null==e?e=w:z(e,0,8),R(t,t.e+1,e)},n.isEqualTo=n.eq=function(e,t){return 0===V(this,new D(e,t))},n.isFinite=function(){return!!this.c},n.isGreaterThan=n.gt=function(e,t){return 0<V(this,new D(e,t))},n.isGreaterThanOrEqualTo=n.gte=function(e,t){return 1===(t=V(this,new D(e,t)))||0===t},n.isInteger=function(){return!!this.c&&U(this.e/F)>this.c.length-2},n.isLessThan=n.lt=function(e,t){return V(this,new D(e,t))<0},n.isLessThanOrEqualTo=n.lte=function(e,t){return-1===(t=V(this,new D(e,t)))||0===t},n.isNaN=function(){return!this.s},n.isNegative=function(){return this.s<0},n.isPositive=function(){return 0<this.s},n.isZero=function(){return!!this.c&&0==this.c[0]},n.minus=function(e,t){var r,n,i,a,o=this,s=o.s;if(t=(e=new D(e,t)).s,!s||!t)return new D(NaN);if(s!=t)return e.s=-t,o.plus(e);var l=o.e/F,u=e.e/F,f=o.c,c=e.c;if(!l||!u){if(!f||!c)return f?(e.s=-t,e):new D(c?o:NaN);if(!f[0]||!c[0])return c[0]?(e.s=-t,e):new D(f[0]?o:3==w?-0:0)}if(l=U(l),u=U(u),f=f.slice(),s=l-u){for((i=(a=s<0)?(s=-s,f):(u=l,c)).reverse(),t=s;t--;i.push(0));i.reverse()}else for(n=(a=(s=f.length)<(t=c.length))?s:t,s=t=0;t<n;t++)if(f[t]!=c[t]){a=f[t]<c[t];break}if(a&&(i=f,f=c,c=i,e.s=-e.s),0<(t=(n=c.length)-(r=f.length)))for(;t--;f[r++]=0);for(t=P-1;s<n;){if(f[--n]<c[n]){for(r=n;r&&!f[--r];f[r]=t);--f[r],f[n]+=P}f[n]-=c[n]}for(;0==f[0];f.splice(0,1),--u);return f[0]?x(e,f,u):(e.s=3==w?-1:1,e.c=[e.e=0],e)},n.modulo=n.mod=function(e,t){var r,n,i=this;return e=new D(e,t),!i.c||!e.s||e.c&&!e.c[0]?new D(NaN):!e.c||i.c&&!i.c[0]?new D(i):(9==a?(n=e.s,e.s=1,r=y(i,e,0,3),e.s=n,r.s*=n):r=y(i,e,0,a),(e=i.minus(r.times(e))).c[0]||1!=a||(e.s=i.s),e)},n.multipliedBy=n.times=function(e,t){var r,n,i,a,o,s,l,u,f,c,d,h,v,p,g,m=this,y=m.c,b=(e=new D(e,t)).c;if(!(y&&b&&y[0]&&b[0]))return!m.s||!e.s||y&&!y[0]&&!b||b&&!b[0]&&!y?e.c=e.e=e.s=null:(e.s*=m.s,y&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=U(m.e/F)+U(e.e/F),e.s*=m.s,(l=y.length)<(c=b.length)&&(v=y,y=b,b=v,i=l,l=c,c=i),i=l+c,v=[];i--;v.push(0));for(p=P,g=$,i=c;0<=--i;){for(r=0,d=b[i]%g,h=b[i]/g|0,a=i+(o=l);i<a;)r=((u=d*(u=y[--o]%g)+(s=h*u+(f=y[o]/g|0)*d)%g*g+v[a]+r)/p|0)+(s/g|0)+h*f,v[a--]=u%p;v[a]=r}return r?++n:v.splice(0,1),x(e,v,n)},n.negated=function(){var e=new D(this);return e.s=-e.s||null,e},n.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new D(e,t)).s,!i||!t)return new D(NaN);if(i!=t)return e.s=-t,n.minus(e);var a=n.e/F,o=e.e/F,s=n.c,l=e.c;if(!a||!o){if(!s||!l)return new D(i/0);if(!s[0]||!l[0])return l[0]?e:new D(s[0]?n:0*i)}if(a=U(a),o=U(o),s=s.slice(),i=a-o){for((r=0<i?(o=a,l):(i=-i,s)).reverse();i--;r.push(0));r.reverse()}for((i=s.length)-(t=l.length)<0&&(r=l,l=s,s=r,t=i),i=0;t;)i=(s[--t]=s[t]+l[t]+i)/P|0,s[t]=P===s[t]?0:s[t]%P;return i&&(s=[i].concat(s),++o),x(e,s,o)},n.precision=n.sd=function(e,t){var r,n,i;if(null!=e&&e!==!!e)return z(e,1,W),null==t?t=w:z(t,0,8),R(new D(this),e,t);if(!(r=this.c))return null;if(n=(i=r.length-1)*F+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];10<=i;i/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},n.shiftedBy=function(e){return z(e,-B,B),this.times("1e"+e)},n.squareRoot=n.sqrt=function(){var e,t,r,n,i,a=this,o=a.c,s=a.s,l=a.e,u=b+4,f=new D("0.5");if(1!==s||!o||!o[0])return new D(!s||s<0&&(!o||o[0])?NaN:o?a:1/0);if((r=0==(s=Math.sqrt(+I(a)))||s==1/0?(((t=j(o)).length+l)%2==0&&(t+="0"),s=Math.sqrt(+t),l=U((l+1)/2)-(l<0||l%2),new D(t=s==1/0?"1e"+l:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+l)):new D(s+"")).c[0])for((s=(l=r.e)+u)<3&&(s=0);;)if(i=r,r=f.times(i.plus(y(a,i,u,1))),j(i.c).slice(0,s)===(t=j(r.c)).slice(0,s)){if(r.e<l&&--s,"9999"!=(t=t.slice(s-3,s+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(R(r,r.e+b+2,1),e=!r.times(r).eq(a));break}if(!n&&(R(i,i.e+b+2,0),i.times(i).eq(a))){r=i;break}u+=4,s+=4,n=1}return R(r,r.e+b+1,w,e)},n.toExponential=function(e,t){return null!=e&&(z(e,0,W),e++),i(this,e,t,1)},n.toFixed=function(e,t){return null!=e&&(z(e,0,W),e=e+this.e+1),i(this,e,t)},n.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=k;else if("object"!=typeof r)throw Error(M+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var i,a=n.split("."),o=+r.groupSize,s=+r.secondaryGroupSize,l=r.groupSeparator||"",u=a[0],f=a[1],c=this.s<0,d=c?u.slice(1):u,h=d.length;if(s&&(i=o,o=s,h-=s=i),0<o&&0<h){for(i=h%o||o,u=d.substr(0,i);i<h;i+=o)u+=l+d.substr(i,o);0<s&&(u+=l+d.slice(i)),c&&(u="-"+u)}n=f?u+(r.decimalSeparator||"")+((s=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+s+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):u}return(r.prefix||"")+n+(r.suffix||"")},n.toFraction=function(e){var t,r,n,i,a,o,s,l,u,f,c,d,h=this,v=h.c;if(null!=e&&(!(s=new D(e)).isInteger()&&(s.c||1!==s.s)||s.lt(p)))throw Error(M+"Argument "+(s.isInteger()?"out of range: ":"not an integer: ")+I(s));if(!v)return new D(h);for(t=new D(p),u=r=new D(p),n=l=new D(p),d=j(v),a=t.e=d.length-h.e-1,t.c[0]=H[(o=a%F)<0?F+o:o],e=!e||0<s.comparedTo(t)?0<a?t:u:s,o=C,C=1/0,s=new D(d),l.c[0]=0;f=y(s,t,0,1),1!=(i=r.plus(f.times(n))).comparedTo(e);)r=n,n=i,u=l.plus(f.times(i=u)),l=i,t=s.minus(f.times(i=t)),s=i;return i=y(e.minus(r),n,0,1),l=l.plus(i.times(u)),r=r.plus(i.times(n)),l.s=u.s=h.s,c=y(u,n,a*=2,w).minus(h).abs().comparedTo(y(l,r,a,w).minus(h).abs())<1?[u,n]:[l,r],C=o,c},n.toNumber=function(){return+I(this)},n.toPrecision=function(e,t){return null!=e&&z(e,1,W),i(this,e,t,2)},n.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(t=null==e?i<=v||g<=i?Y(j(r.c),i):G(j(r.c),i,"0"):10===e?G(j((r=R(new D(r),b+i+1,w)).c),r.e,"0"):(z(e,2,T.length,"Base"),c(G(j(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},n.valueOf=n.toJson=function(){return I(this)},n._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(n[Symbol.toStringTag]="BigNumber",n[Symbol.for("nodejs.util.inspect.custom")]=n.valueOf),null!=t&&D.set(t),D}()).default=t.BigNumber=t,void 0!==r&&r.exports?r.exports=t:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=t)}(this)},{}],2:[function(e,t,r){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,r){"use strict";function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var H=e("./globalState"),o=e("./validating"),s=e("./parsing"),n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T={general:{scale:1024,suffixes:n,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:n,marker:"d"}},$={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=s.parseFormat(t)),!o.validateFormat(t))return"ERROR: invalid format";var n=t.prefix||"",i=t.postfix||"",a=function(e,t,r){switch(t.output){case"currency":return t=D(t,H.currentCurrencyDefaultFormat()),function(e,t,r){var n=r.currentCurrency(),i=Object.assign({},$,t),a=void 0,o="",s=!!i.totalLength||!!i.forceAverage||i.average,l=t.currencyPosition||n.position,u=t.currencySymbol||n.symbol;i.spaceSeparated&&(o=" ");"infix"===l&&(a=o+u+o);var f=x({instance:e,providedFormat:t,state:r,decimalSeparator:a});"prefix"===l&&(f=e._value<0&&"sign"===i.negative?"-".concat(o).concat(u).concat(f.slice(1)):u+o+f);l&&"postfix"!==l||(f=f+(o=s?"":o)+u);return f}(e,t,H);case"percent":return t=D(t,H.currentPercentageDefaultFormat()),function(e,t,r,n){var i=t.prefixSymbol,a=x({instance:n(100*e._value),providedFormat:t,state:r}),o=Object.assign({},$,t);if(i)return"%".concat(o.spaceSeparated?" ":"").concat(a);return"".concat(a).concat(o.spaceSeparated?" ":"","%")}(e,t,H,r);case"byte":return t=D(t,H.currentByteDefaultFormat()),v=e,g=H,m=r,y=(p=t).base||"binary",b=T[y],w=_(v._value,b.suffixes,b.scale),C=w.value,S=w.suffix,E=x({instance:m(C),providedFormat:p,state:g,defaults:g.currentByteDefaultFormat()}),k=g.currentAbbreviations(),"".concat(E).concat(k.spaced?" ":"").concat(S);case"time":return t=D(t,H.currentTimeDefaultFormat()),f=e,c=Math.floor(f._value/60/60),d=Math.floor((f._value-60*c*60)/60),h=Math.round(f._value-60*c*60-60*d),"".concat(c,":").concat(d<10?"0":"").concat(d,":").concat(h<10?"0":"").concat(h);case"ordinal":return t=D(t,H.currentOrdinalDefaultFormat()),n=e,i=t,o=(a=H).currentOrdinal(),s=Object.assign({},$,i),l=x({instance:n,providedFormat:i,state:a}),u=o(n._value),"".concat(l).concat(s.spaceSeparated?" ":"").concat(u);case"number":default:return x({instance:e,providedFormat:t,numbro:r})}var n,i,a,o,s,l,u;var f,c,d,h;var v,p,g,m,y,b,w,C,S,E,k}(e,t,r);return a=(a=n+a)+i}function _(e,t,r){var n=t[0],i=Math.abs(e);if(r<=i){for(var a=1;a<t.length;++a){var o=Math.pow(r,a),s=Math.pow(r,a+1);if(o<=i&&i<s){n=t[a],e/=o;break}}n===t[0]&&(e/=Math.pow(r,t.length-1),n=t[t.length-1])}return{value:e,suffix:n}}function d(e){for(var t="",r=0;r<e;r++)t+="0";return t}function W(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var r=e.toString(),n=B(r.split("e"),2),i=n[0],a=n[1],o=B(i.split("."),2),s=o[0],l=o[1],u=void 0===l?"":l;if(0<+a)r=s+u+d(a-u.length);else{var f=".";f=+s<0?"-0".concat(f):"0".concat(f);var c=(d(-a-1)+Math.abs(s)+u).substr(0,t);c.length<t&&(c+=d(t-c.length)),r=f+c}return 0<+a&&0<t&&(r+=".".concat(d(t))),r}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function x(e){var t=e.instance,r=e.providedFormat,n=e.state,i=void 0===n?H:n,a=e.decimalSeparator,o=e.defaults,s=void 0===o?i.currentDefaults():o,l=t._value;if(0===l&&i.hasZeroFormat())return i.getZeroFormat();if(!isFinite(l))return l.toString();var u,f,c,d,h,v,p,g,m=Object.assign({},$,s,r),y=m.totalLength,b=y?0:m.characteristic,w=m.optionalCharacteristic,C=m.forceAverage,S=!!y||!!C||m.average,E=y?-1:S&&void 0===r.mantissa?0:m.mantissa,k=!y&&(void 0===r.optionalMantissa?-1===E:m.optionalMantissa),T=m.trimMantissa,_=m.thousandSeparated,x=m.spaceSeparated,D=m.negative,R=m.forceSign,I=m.exponential,O="";if(S){var A=function(e){var t=e.value,r=e.forceAverage,n=e.abbreviations,i=e.spaceSeparated,a=void 0!==i&&i,o=e.totalLength,s=void 0===o?0:o,l="",u=Math.abs(t),f=-1;if(u>=Math.pow(10,12)&&!r||"trillion"===r?(l=n.trillion,t/=Math.pow(10,12)):u<Math.pow(10,12)&&u>=Math.pow(10,9)&&!r||"billion"===r?(l=n.billion,t/=Math.pow(10,9)):u<Math.pow(10,9)&&u>=Math.pow(10,6)&&!r||"million"===r?(l=n.million,t/=Math.pow(10,6)):(u<Math.pow(10,6)&&u>=Math.pow(10,3)&&!r||"thousand"===r)&&(l=n.thousand,t/=Math.pow(10,3)),l&&(l=(a?" ":"")+l),s){var c=t.toString().split(".")[0];f=Math.max(s-c.length,0)}return{value:t,abbreviation:l,mantissaPrecision:f}}({value:l,forceAverage:C,abbreviations:i.currentAbbreviations(),spaceSeparated:x,totalLength:y});l=A.value,O+=A.abbreviation,y&&(E=A.mantissaPrecision)}if(I){var N=(f=(u={value:l,characteristicPrecision:b}).value,c=u.characteristicPrecision,d=void 0===c?0:c,h=B(f.toExponential().split("e"),2),v=h[0],p=h[1],g=+v,d&&1<d&&(g*=Math.pow(10,d-1),p=0<=(p=+p-(d-1))?"+".concat(p):p),{value:g,abbreviation:"e".concat(p)});l=N.value,O=N.abbreviation+O}var M,L,P,F=function(e,t,r,n,i){if(-1===n)return e;var a=W(t,n),o=B(a.toString().split("."),2),s=o[0],l=o[1],u=void 0===l?"":l;if(u.match(/^0+$/)&&(r||i))return s;var f=u.match(/0+$/);return i&&f?"".concat(s,".").concat(u.toString().slice(0,f.index)):a.toString()}(l.toString(),l,k,E,T);return F=function(e,t,r,n,i){var a=n.currentDelimiters(),o=a.thousands;i=i||a.decimal;var s=a.thousandsSize||3,l=e.toString(),u=l.split(".")[0],f=l.split(".")[1];return r&&(t<0&&(u=u.slice(1)),function(e,t){for(var r=[],n=0,i=e;0<i;i--)n===t&&(r.unshift(i),n=0),n++;return r}(u.length,s).forEach(function(e,t){u=u.slice(0,e+t)+o+u.slice(e+t)}),t<0&&(u="-".concat(u))),l=f?u+i+f:u}(F=function(e,t,r,n){var i=e,a=B(i.toString().split("."),2),o=a[0],s=a[1];if(o.match(/^-?0$/)&&r)return s?"".concat(o.replace("0",""),".").concat(s):o.replace("0","");if(o.length<n)for(var l=n-o.length,u=0;u<l;u++)i="0".concat(i);return i.toString()}(F,0,w,b),l,_,i,a),(S||I)&&(F=F+O),(R||l<0)&&(M=F,P=D,F=0===(L=l)?M:0==+M?M.replace("-",""):0<L?"+".concat(M):"sign"===P?M:"(".concat(M.replace("-",""),")")),F}function D(e,t){if(!e)return t;var r=Object.keys(e);return 1===r.length&&"output"===r[0]?t:e}t.exports=function(n){return{format:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.apply(void 0,t.concat([n]))},getByteUnit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var t=T.general;return _(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([n]))},getBinaryByteUnit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var t=T.binary;return _(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([n]))},getDecimalByteUnit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var t=T.decimal;return _(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([n]))},formatOrDefault:D}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,r){"use strict";var i=e("./en-US"),n=e("./validating"),a=e("./parsing"),o={},s=void 0,l={},u=null,f={};function c(e){s=e}function d(){return l[s]}o.languages=function(){return Object.assign({},l)},o.currentLanguage=function(){return s},o.currentCurrency=function(){return d().currency},o.currentAbbreviations=function(){return d().abbreviations},o.currentDelimiters=function(){return d().delimiters},o.currentOrdinal=function(){return d().ordinal},o.currentDefaults=function(){return Object.assign({},d().defaults,f)},o.currentOrdinalDefaultFormat=function(){return Object.assign({},o.currentDefaults(),d().ordinalFormat)},o.currentByteDefaultFormat=function(){return Object.assign({},o.currentDefaults(),d().byteFormat)},o.currentPercentageDefaultFormat=function(){return Object.assign({},o.currentDefaults(),d().percentageFormat)},o.currentCurrencyDefaultFormat=function(){return Object.assign({},o.currentDefaults(),d().currencyFormat)},o.currentTimeDefaultFormat=function(){return Object.assign({},o.currentDefaults(),d().timeFormat)},o.setDefaults=function(e){e=a.parseFormat(e),n.validateFormat(e)&&(f=e)},o.getZeroFormat=function(){return u},o.setZeroFormat=function(e){return u="string"==typeof e?e:null},o.hasZeroFormat=function(){return null!==u},o.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return d()},o.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!n.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&c(e.languageTag)},o.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[e]){var r=e.split("-")[0],n=Object.keys(l).find(function(e){return e.split("-")[0]===r});return l[n]?void c(n):void c(t)}c(e)},o.registerLanguage(i),s=i.languageTag,t.exports=o},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,e,t){"use strict";e.exports=function(t){return{loadLanguagesInNode:function(e){return r=t,void e.forEach(function(e){var t=void 0;try{t=n("../languages/".concat(e))}catch(t){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}t&&r.registerLanguage(t)});var r}}}},{}],6:[function(e,t,r){"use strict";var l=e("bignumber.js");function a(e,t,r){var n=new l(e._value),i=t;return r.isNumbro(t)&&(i=t._value),i=new l(i),e._value=n.minus(i).toNumber(),e}t.exports=function(s){return{add:function(e,t){return n=t,i=s,a=new l((r=e)._value),o=n,i.isNumbro(n)&&(o=n._value),o=new l(o),r._value=a.plus(o).toNumber(),r;var r,n,i,a,o},subtract:function(e,t){return a(e,t,s)},multiply:function(e,t){return n=t,i=s,a=new l((r=e)._value),o=n,i.isNumbro(n)&&(o=n._value),o=new l(o),r._value=a.times(o).toNumber(),r;var r,n,i,a,o},divide:function(e,t){return n=t,i=s,a=new l((r=e)._value),o=n,i.isNumbro(n)&&(o=n._value),o=new l(o),r._value=a.dividedBy(o).toNumber(),r;var r,n,i,a,o},set:function(e,t){return r=e,i=n=t,s.isNumbro(n)&&(i=n._value),r._value=i,r;var r,n,i},difference:function(e,t){return r=t,a(i=(n=s)(e._value),r,n),Math.abs(i._value);var r,n,i}}}},{"bignumber.js":1}],7:[function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=e("./globalState"),n=e("./validating"),o=e("./loading")(h),s=e("./unformatting"),l=e("./formatting")(h),u=e("./manipulating")(h),f=e("./parsing"),c=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e}var e,r,n;return e=t,(r=[{key:"clone",value:function(){return h(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=f.parseFormat(e)),(e=l.formatOrDefault(e,a.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return u.difference(this,e)}},{key:"add",value:function(e){return u.add(this,e)}},{key:"subtract",value:function(e){return u.subtract(this,e)}},{key:"multiply",value:function(e){return u.multiply(this,e)}},{key:"divide",value:function(e){return u.divide(this,e)}},{key:"set",value:function(e){return u.set(this,d(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(e.prototype,r),n&&i(e,n),t}();function d(e){var t=e;return h.isNumbro(e)?t=e._value:"string"==typeof e?t=h.unformat(e):isNaN(e)&&(t=NaN),t}function h(e){return new c(d(e))}h.version="2.1.2",h.isNumbro=function(e){return e instanceof c},h.language=a.currentLanguage,h.registerLanguage=a.registerLanguage,h.setLanguage=a.setLanguage,h.languages=a.languages,h.languageData=a.languageData,h.zeroFormat=a.setZeroFormat,h.defaultFormat=a.currentDefaults,h.setDefaults=a.setDefaults,h.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,h.validate=n.validate,h.loadLanguagesInNode=o.loadLanguagesInNode,h.unformat=s.unformat,t.exports=h},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,r){"use strict";t.exports={parseFormat:function(e){var t,r,n,i,a,o,s,l,u,f,c,d,h,v,p,g,m,y,b,w,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(r=C,e=(n=(t=e).match(/^{([^}]*)}/))?(r.prefix=n[1],t.slice(n[0].length)):t,a=C,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(o=(i=e).match(/{([^}]*)}$/))?(a.postfix=o[1],i.slice(0,-o[0].length)):i,C),s=C,(l=e.match(/[1-9]+[0-9]*/))&&(s.totalLength=+l[0]),u=C,(f=e.split(".")[0].match(/0+/))&&(u.characteristic=f[0].length),function(e,t){if(-1!==e.indexOf(".")){var r=e.split(".")[0];t.optionalCharacteristic=-1===r.indexOf("0")}}(e,C),c=C,-1!==e.indexOf("a")&&(c.average=!0),h=C,-1!==(d=e).indexOf("K")?h.forceAverage="thousand":-1!==d.indexOf("M")?h.forceAverage="million":-1!==d.indexOf("B")?h.forceAverage="billion":-1!==d.indexOf("T")&&(h.forceAverage="trillion"),function(e,t){var r=e.split(".")[1];if(r){var n=r.match(/0+/);n&&(t.mantissa=n[0].length)}}(e,C),p=C,(v=e).match(/\[\.]/)?p.optionalMantissa=!0:v.match(/\./)&&(p.optionalMantissa=!1),g=C,-1!==e.indexOf(",")&&(g.thousandSeparated=!0),m=C,-1!==e.indexOf(" ")&&(m.spaceSeparated=!0),b=C,(y=e).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),y.match(/^\+?-/)&&(b.negative="sign"),w=C,e.match(/^\+/)&&(w.forceSign=!0),C)}}},{}],9:[function(d,e,t){"use strict";var C=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function S(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function h(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,o=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===i?0:function e(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,o=5<arguments.length?arguments[5]:void 0,s=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var l="",u=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==t)return-1*e(u,r,n,i,a,o,s);for(var f=0;f<C.length;f++){var c=C[f];if((l=t.replace(c.key,""))!==t)return e(l,r,n,i,a,o,s)*c.factor}if((l=t.replace("%",""))!==t)return e(l,r,n,i,a,o,s)/100;var d=parseFloat(t);if(!isNaN(d)){var h=i(d);if(h&&"."!==h&&(l=t.replace(new RegExp("".concat(S(h),"$")),""))!==t)return e(l,r,n,i,a,o,s);var v={};Object.keys(o).forEach(function(e){v[o[e]]=e});for(var p=Object.keys(v).sort().reverse(),g=p.length,m=0;m<g;m++){var y=p[m],b=v[y];if((l=t.replace(y,""))!==t){var w=void 0;switch(b){case"thousand":w=Math.pow(10,3);break;case"million":w=Math.pow(10,6);break;case"billion":w=Math.pow(10,9);break;case"trillion":w=Math.pow(10,12)}return e(l,r,n,i,a,o,s)*w}}}}(function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=e.replace(r,"");return n=(n=n.replace(new RegExp("([0-9])".concat(S(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,r),t,r,n,i,a,o)}e.exports={unformat:function(e,t){var r,n,i,a=d("./globalState"),o=a.currentDelimiters(),s=a.currentCurrency().symbol,l=a.currentOrdinal(),u=a.getZeroFormat(),f=a.currentAbbreviations(),c=void 0;if("string"==typeof e)c=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var r=e.split(":");if(3!==r.length)return!1;var n=+r[0],i=+r[1],a=+r[2];return!isNaN(n)&&!isNaN(i)&&!isNaN(a)}(e,o)?(r=e.split(":"),n=+r[0],i=+r[1],+r[2]+60*i+3600*n):h(e,o,s,l,u,f,t);else{if("number"!=typeof e)return;c=e}if(void 0!==c)return c}}},{"./globalState":4}],10:[function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=e("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},o={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function s(e){return!!i.unformat(e)}function h(l,u,f){var e=3<arguments.length&&void 0!==arguments[3]&&arguments[3],t=Object.keys(l).map(function(e){if(!u[e])return console.error("".concat(f," Invalid key: ").concat(e)),!1;var t=l[e],r=u[e];if("string"==typeof r&&(r={type:r}),"format"===r.type){if(!h(t,d,"[Validate ".concat(e,"]"),!0))return!1}else if(c(t)!==r.type)return console.error("".concat(f," ").concat(e,' type mismatched: "').concat(r.type,'" expected, "').concat(c(t),'" provided')),!1;if(r.restrictions&&r.restrictions.length)for(var n=r.restrictions.length,i=0;i<n;i++){var a=r.restrictions[i],o=a.restriction,s=a.message;if(!o(t,l))return console.error("".concat(f," ").concat(e," invalid value: ").concat(s)),!1}if(r.restriction&&!r.restriction(t,l))return console.error("".concat(f," ").concat(e," invalid value: ").concat(r.message)),!1;if(r.validValues&&-1===r.validValues.indexOf(t))return console.error("".concat(f," ").concat(e," invalid value: must be among ").concat(JSON.stringify(r.validValues),', "').concat(t,'" provided')),!1;if(r.children&&!h(t,r.children,"[Validate ".concat(e,"]")))return!1;return!0});return e||t.push.apply(t,n(Object.keys(u).map(function(e){var t=u[e];if("string"==typeof t&&(t={type:t}),t.mandatory){var r=t.mandatory;if("function"==typeof r&&(r=r(l)),r&&void 0===l[e])return console.error("".concat(f,' Missing mandatory key "').concat(e,'"')),!1}return!0}))),t.reduce(function(e,t){return e&&t},!0)}function l(e){return h(e,d,"[Validate format]")}t.exports={validate:function(e,t){var r=s(e),n=l(t);return r&&n},validateFormat:l,validateInput:s,validateLanguage:function(e){return h(e,o,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)});window["numbro"]=r(377)},function(e,t,r){"use strict";var n=r(141);var l=r(48);var a=r(53);var u=r(482);var f=r(142);n("search",1,function(i,o,s){return[function e(t){var r=a(this);var n=t==undefined?undefined:t[i];return n!==undefined?n.call(t,r):new RegExp(t)[i](String(r))},function(e){var t=s(o,e,this);if(t.done)return t.value;var r=l(e);var n=String(this);var i=r.lastIndex;if(!u(i,0))r.lastIndex=0;var a=f(r,n);if(!u(r.lastIndex,i))r.lastIndex=i;return a===null?-1:a.index}]})},function(e,t,r){"use strict";t.__esModule=true;t.getNormalizedDate=n;function n(e){var t=new Date(e);if(!isNaN(new Date("".concat(e,"T00:00")).getDate())){return new Date(t.getTime()+t.getTimezoneOffset()*6e4)}return t}},function(e,r,t){"use strict";t(12);t(23);t(40);t(52);(function(e){"use strict";function c(e){return e.split('"').length-1}var t={parse:function e(t){var r,n,i,a=[],o=0,s,l,u,f;i=t.replace(/\r\n|\r/g,"\n").split("\n");if(i.length>1&&i[i.length-1]===""){i.pop()}for(r=0,n=i.length;r<n;r+=1){i[r]=i[r].split("\t");for(s=0,l=i[r].length;s<l;s+=1){if(!a[o]){a[o]=[]}if(u&&s===0){f=a[o].length-1;a[o][f]=a[o][f]+"\n"+i[r][0];if(u&&c(i[r][0])&1){u=false;a[o][f]=a[o][f].substring(0,a[o][f].length-1).replace(/""/g,'"')}}else{if(s===l-1&&i[r][s].indexOf('"')===0&&c(i[r][s])&1){a[o].push(i[r][s].substring(1).replace(/""/g,'"'));u=true}else{a[o].push(i[r][s].replace(/""/g,'"'));u=false}}}if(!u){o+=1}}return a},stringify:function e(t){var r,n,i,a,o="",s;for(r=0,n=t.length;r<n;r+=1){a=t[r].length;for(i=0;i<a;i+=1){if(i>0){o+="\t"}s=t[r][i];if(typeof s==="string"){if(s.indexOf("\n")>-1){o+='"'+s.replace(/"/g,'""')+'"'}else{o+=s}}else if(s===null||s===void 0){o+=""}else{o+=s}}if(r!==n-1){o+="\n"}}return o}};if(true){r.parse=t.parse;r.stringify=t.stringify}else{}})(window)},function(e,t,r){"use strict";var n=r(20);var i=r(504).left;var a=r(84);var o=r(59);var s=a("reduce");var l=o("reduce",{1:0});n({target:"Array",proto:true,forced:!s||!l},{reduce:function e(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";r(15);r(69);r(10);r(13);r(16);t.__esModule=true;t.mouseDown=n;t.mouseOver=i;t.handleMouseEvent=s;var a=r(32);var h=r(27);function n(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,a=e.selection,o=e.controller;var s=a.isSelected()?a.getSelectedRange().current():null;var l=a.isSelectedByCorner();var u=a.isSelectedByRowHeader();if(t&&s){if(i.row>=0&&i.col>=0&&!o.cells){a.setRangeEnd(i)}else if((l||u)&&i.row>=0&&i.col>=0&&!o.cells){a.setRangeEnd(new h.CellCoords(i.row,i.col))}else if(l&&i.row<0&&!o.column){a.setRangeEnd(new h.CellCoords(s.to.row,i.col))}else if(u&&i.col<0&&!o.row){a.setRangeEnd(new h.CellCoords(i.row,s.to.col))}else if((!l&&!u&&i.col<0||l&&i.col<0)&&!o.row){a.selectRows(s.from.row,i.row)}else if((!l&&!u&&i.row<0||u&&i.row<0)&&!o.column){a.selectColumns(s.from.col,i.col)}}else{var f=new h.CellCoords(i.row,i.col);if(f.row<0){f.row=0}if(f.col<0){f.col=0}var c=!a.inInSelection(f);var d=r||n&&c;if(i.row<0&&i.col>=0&&!o.column){if(d){a.selectColumns(i.col)}}else if(i.col<0&&i.row>=0&&!o.row){if(d){a.selectRows(i.row)}}else if(i.col>=0&&i.row>=0&&!o.cells){if(d){a.setRangeStart(i)}}else if(i.col<0&&i.row<0){a.setRangeStart(i)}}}function i(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller;if(!t){return}var a=n.isSelectedByRowHeader();var o=n.isSelectedByColumnHeader();var s=n.tableProps.countCols();var l=n.tableProps.countRows();if(o&&!i.column){n.setRangeEnd(new h.CellCoords(l-1,r.col))}else if(a&&!i.row){n.setRangeEnd(new h.CellCoords(r.row,s-1))}else if(!i.cell){n.setRangeEnd(r)}}var o=new Map([["mousedown",n],["mouseover",i],["touchstart",n]]);function s(e,t){var r=t.coords,n=t.selection,i=t.controller;o.get(e.type)({coords:r,selection:n,controller:i,isShiftKey:e.shiftKey,isLeftClick:(0,a.isLeftClick)(e)||e.type==="touchstart",isRightClick:(0,a.isRightClick)(e)})}},function(e,t,r){"use strict";r(124);r(149);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.registerAsRootInstance=a;t.hasValidParameter=o;t.isRootInstance=s;t.rootInstanceSymbol=t.holder=void 0;var n=new WeakMap;t.holder=n;var i=Symbol("rootInstance");t.rootInstanceSymbol=i;function a(e){n.set(e,true)}function o(e){return e===i}function s(e){return n.has(e)}},function(e,t,r){var n=r(36);t.f=n},function(e,t,r){var n=r(200);var i=r(47);var a=r(384);var o=r(51).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});if(!i(t,e))o(t,e,{value:a.f(e)})}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var o=n(r(42));var s=r(29);var l=r(3);function i(){}i.prototype={licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:false,customBorders:false,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:true,allowInsertColumn:true,allowRemoveRow:true,allowRemoveColumn:true,selectionMode:"multiple",fillHandle:{autoInsertRow:false},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:true,autoWrapCol:true,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function e(t){var r;var n;var i;var a;for(r=0,n=this.countCols();r<n;r++){i=this.getDataAtCell(t,r);if(i!==""&&i!==null&&(0,s.isDefined)(i)){if((0,o.default)(i)==="object"){a=this.getCellMeta(t,r);return(0,l.isObjectEqual)(this.getSchema()[a.prop],i)}return false}}return true},isEmptyCol:function e(t){var r;var n;var i;for(r=0,n=this.countRows();r<n;r++){i=this.getDataAtCell(r,t);if(i!==""&&i!==null&&(0,s.isDefined)(i)){return false}}return true},observeDOMVisibility:true,allowInvalid:true,allowEmpty:true,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:false,readOnly:false,skipColumnOnPaste:false,skipRowOnPaste:false,search:false,type:"text",copyable:true,editor:void 0,visibleRows:10,trimDropdown:true,debug:false,wordWrap:true,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:true,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:false,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:false,manualColumnFreeze:void 0,trimWhitespace:true,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:false,defaultDate:void 0,strict:void 0,allowHtml:false,renderAllRows:void 0,preventOverflow:false,preventWheel:false,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:true,filter:true,filteringCaseSensitive:false,dragToScroll:true,nestedRows:void 0};var a=i;t.default=a},function(e,t,r){"use strict";t.__esModule=true;t.getTranslatedPhrase=n;var i=r(4);var o=r(150);var a=r(508);var s=r(29);function n(e,t,r){var n=(0,o.getLanguageDictionary)(e);if(n===null){return null}var i=n[t];if((0,s.isUndefined)(i)){return null}var a=l(i,r);if(Array.isArray(a)){return a[0]}return a}function l(t,r){var n=t;(0,i.arrayEach)((0,a.getPhraseFormatters)(),function(e){n=e(t,r)});return n}},function(e,t,r){"use strict";var n=r(0);r(19);r(23);t.__esModule=true;t.extendNotExistingKeys=c;t.createCellHeadersRange=d;t.normalizeLanguageCode=h;t.applyLanguageSetting=v;t.warnUserAboutLanguageRegistration=p;var i=n(r(72));var a=r(29);var o=r(3);var s=r(61);var l=r(73);var u=r(150);function f(){var t=(0,i.default)(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);f=function e(){return t};return t}function c(r,e){(0,o.objectEach)(e,function(e,t){if((0,a.isUndefined)(r[t])){r[t]=e}});return r}function d(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:t;var i=r,a=n;if(e>t){var o=[a,i];i=o[0];a=o[1]}return"".concat(i,"-").concat(a)}function h(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/;var r=t.exec(e);if(r){return"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase())}return e}function v(e,t){var r=h(t);if((0,u.hasLanguageDictionary)(r)){e.language=r}else{e.language=u.DEFAULT_LANGUAGE_CODE;p(t)}}function p(e){if((0,a.isDefined)(e)){(0,s.error)((0,l.toSingleLine)(f(),e))}}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;var i=n(r(390));t.Highlight=i.default;var a=n(r(519));t.Selection=a.default;var o=r(382);t.handleMouseEvent=o.handleMouseEvent;var s=r(152);t.detectSelectionType=s.detectSelectionType;t.normalizeSelectionFactory=s.normalizeSelectionFactory},function(e,t,r){"use strict";var n=r(0);r(124);r(149);r(391);r(19);r(510);r(50);r(96);r(31);r(15);r(69);r(392);r(393);r(65);r(10);r(39);r(13);r(97);r(16);t.__esModule=true;t.default=t.CUSTOM_SELECTION=t.HEADER_TYPE=t.FILL_TYPE=t.CELL_TYPE=t.AREA_TYPE=t.ACTIVE_HEADER_TYPE=void 0;var i=n(r(37));var a=n(r(70));var o=n(r(1));var s=n(r(2));var l=r(512);var u=r(4);function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2){f(Object(r),true).forEach(function(e){(0,a.default)(t,e,r[e])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}else{f(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}}return t}var d="active-header";t.ACTIVE_HEADER_TYPE=d;var h="area";t.AREA_TYPE=h;var v="cell";t.CELL_TYPE=v;var p="fill";t.FILL_TYPE=p;var g="header";t.HEADER_TYPE=g;var m="custom-selection";t.CUSTOM_SELECTION=m;var y=function(){function t(e){(0,o.default)(this,t);this.options=e;this.layerLevel=0;this.cell=(0,l.createHighlight)(v,e);this.fill=(0,l.createHighlight)(p,e);this.areas=new Map;this.headers=new Map;this.activeHeaders=new Map;this.customSelections=[]}(0,s.default)(t,[{key:"isEnabledFor",value:function e(t){var r=t==="current"?v:t;var n=this.options.disableHighlight;if(typeof n==="string"){n=[n]}return n===false||Array.isArray(n)&&!n.includes(r)}},{key:"useLayerLevel",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.layerLevel=t;return this}},{key:"getCell",value:function e(){return this.cell}},{key:"getFill",value:function e(){return this.fill}},{key:"createOrGetArea",value:function e(){var t=this.layerLevel;var r;if(this.areas.has(t)){r=this.areas.get(t)}else{r=(0,l.createHighlight)(h,c({layerLevel:t},this.options));this.areas.set(t,r)}return r}},{key:"getAreas",value:function e(){return(0,i.default)(this.areas.values())}},{key:"createOrGetHeader",value:function e(){var t=this.layerLevel;var r;if(this.headers.has(t)){r=this.headers.get(t)}else{r=(0,l.createHighlight)(g,c({},this.options));this.headers.set(t,r)}return r}},{key:"getHeaders",value:function e(){return(0,i.default)(this.headers.values())}},{key:"createOrGetActiveHeader",value:function e(){var t=this.layerLevel;var r;if(this.activeHeaders.has(t)){r=this.activeHeaders.get(t)}else{r=(0,l.createHighlight)(d,c({},this.options));this.activeHeaders.set(t,r)}return r}},{key:"getActiveHeaders",value:function e(){return(0,i.default)(this.activeHeaders.values())}},{key:"getCustomSelections",value:function e(){return(0,i.default)(this.customSelections.values())}},{key:"addCustomSelection",value:function e(t){this.customSelections.push((0,l.createHighlight)(m,c({},t)))}},{key:"clear",value:function e(){this.cell.clear();this.fill.clear();(0,u.arrayEach)(this.areas.values(),function(e){return void e.clear()});(0,u.arrayEach)(this.headers.values(),function(e){return void e.clear()});(0,u.arrayEach)(this.activeHeaders.values(),function(e){return void e.clear()})}},{key:Symbol.iterator,value:function e(){return[this.cell,this.fill].concat((0,i.default)(this.areas.values()),(0,i.default)(this.headers.values()),(0,i.default)(this.activeHeaders.values()),(0,i.default)(this.customSelections))[Symbol.iterator]()}}]);return t}();var b=y;t.default=b},function(e,t,r){var n=r(385);n("iterator")},function(e,t,r){var n=r(20);var i=r(26);var a=r(63);var o=r(79).f;var s=r(44);var l=i(function(){o(1)});var u=!s||l;n({target:"Object",stat:true,forced:u,sham:!s},{getOwnPropertyDescriptor:function e(t,r){return o(a(t),r)}})},function(e,t,r){var n=r(20);var i=r(44);var u=r(199);var f=r(63);var c=r(79);var d=r(115);n({target:"Object",stat:true,sham:!i},{getOwnPropertyDescriptors:function e(t){var r=f(t);var n=c.f;var i=u(r);var a={};var o=0;var s,l;while(i.length>o){l=n(r,s=i[o++]);if(l!==undefined)d(a,s,l)}return a}})},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(69);r(65);r(10);r(13);r(16);t.__esModule=true;t.default=void 0;var v=n(r(70));var i=n(r(1));var a=n(r(2));var p=r(3);var g=r(17);var m=r(29);var o=function(){(0,a.default)(t,null,[{key:"SAMPLE_COUNT",get:function e(){return 3}}]);function t(e){(0,i.default)(this,t);this.samples=null;this.dataFactory=e;this.customSampleCount=null;this.allowDuplicates=false}(0,a.default)(t,[{key:"getSampleCount",value:function e(){if(this.customSampleCount){return this.customSampleCount}return t.SAMPLE_COUNT}},{key:"setSampleCount",value:function e(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function e(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function e(t,r){return this.generateSamples("row",r,t)}},{key:"generateColumnSamples",value:function e(t,r){return this.generateSamples("col",r,t)}},{key:"generateSamples",value:function e(r,n,t){var i=this;var a=new Map;var o=typeof t==="number"?{from:t,to:t}:t,s=o.from,l=o.to;(0,g.rangeEach)(s,l,function(e){var t=i.generateSample(r,n,e);a.set(e,t)});return a}},{key:"generateSample",value:function e(l,t,u){var f=this;if(l!=="row"&&l!=="col"){throw new Error("Unsupported sample type")}var c=new Map;var d=l==="row"?"col":"row";var h=[];(0,g.rangeEach)(t.from,t.to,function(e){var t=l==="row"?f.dataFactory(u,e):f.dataFactory(e,u),r=t.value,n=t.bundleCountSeed;var i=n>0;var a;if((0,p.isObject)(r)){a=Object.keys(r).length}else if(Array.isArray(r)){a=r.length}else{a=(0,m.stringify)(r).length}if(i){a+=n}if(!c.has(a)){c.set(a,{needed:f.getSampleCount(),strings:[]})}var o=c.get(a);if(o.needed){var s=h.indexOf(r)>-1;if(!s||f.allowDuplicates||i){o.strings.push((0,v.default)({value:r},d,e));h.push(r);o.needed-=1}}});return c}}]);return t}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);r(124);r(19);r(100);r(50);r(96);r(15);r(148);r(41);r(78);r(69);r(86);r(87);r(396);r(392);r(393);r(177);r(65);r(10);r(13);r(97);r(16);r(34);t.__esModule=true;t.default=void 0;var l=n(r(37));var i=n(r(70));var u=n(r(531));var a=n(r(1));var o=n(r(2));var s=n(r(6));var f=n(r(28));var c=n(r(5));var d=n(r(14));var h=n(r(7));var v=r(8);var p=r(29);var g=r(3);var m=r(4);var y=r(17);var b=n(r(22));var w=r(21);var C=n(r(46));var S=r(151);var E=r(533);var k=r(185);var T=r(534);var _=n(r(535));var x=r(536);var D=r(93);function R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2){R(Object(r),true).forEach(function(e){(0,i.default)(t,e,r[e])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}else{R(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}}return t}var O="append";var A="replace";var N="columnSorting";(0,D.registerRootComparator)(N,x.rootComparator);C.default.getSingleton().register("beforeColumnSort");C.default.getSingleton().register("afterColumnSort");var M=function(e){(0,h.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,c.default)(r).call(this,e));t.columnStatesManager=new E.ColumnStatesManager;t.rowsMapper=new _.default((0,f.default)(t));t.blockPluginTranslation=true;t.columnMetaCache=new Map;t.pluginKey=N;return t}(0,o.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}if((0,p.isUndefined)(this.hot.getSettings().observeChanges)){this.enableObserveChangesPlugin()}this.addHook("afterTrimRow",function(){return i.sortByPresetSortStates()});this.addHook("afterUntrimRow",function(){return i.sortByPresetSortStates()});this.addHook("modifyRow",function(e,t){return i.onModifyRow(e,t)});this.addHook("unmodifyRow",function(e,t){return i.onUnmodifyRow(e,t)});this.addHook("afterGetColHeader",function(e,t){return i.onAfterGetColHeader(e,t)});this.addHook("beforeOnCellMouseDown",function(e,t,r,n){return i.onBeforeOnCellMouseDown(e,t,r,n)});this.addHook("afterOnCellMouseDown",function(e,t){return i.onAfterOnCellMouseDown(e,t)});this.addHook("afterCreateRow",function(e,t){return i.onAfterCreateRow(e,t)});this.addHook("afterRemoveRow",function(e,t){return i.onAfterRemoveRow(e,t)});this.addHook("afterInit",function(){return i.loadOrSortBySettings()});this.addHook("afterLoadData",function(e){return i.onAfterLoadData(e)});this.addHook("afterCreateCol",function(){return i.onAfterCreateCol()});this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol()});if(this.hot.view){this.loadOrSortBySettings()}(0,d.default)((0,c.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){var i=this;var t=function e(t,r){var n=(0,k.getHeaderSpanElement)(r);if((0,k.isFirstLevelColumnHeader)(t,r)===false||n===null){return}i.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",t);this.hot.addHookOnce("afterRender",function(){i.hot.removeHook("afterGetColHeader",t)});this.rowsMapper.clearMap();(0,d.default)((0,c.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function e(t){var i=this;var r=this.getSortConfig();var n=this.getNormalizedSortConfigs(t);var a=this.areValidSortConfigs(n);var o=this.hot.runHooks("beforeColumnSort",r,n,a);if(o===false){return}if(a){var s=function e(t){var r=t.column,n=(0,u.default)(t,["column"]);return I({column:i.hot.toPhysicalColumn(r)},n)};var l=(0,m.arrayMap)(n,function(e){return s(e)});this.columnStatesManager.setSortStates(l);this.sortByPresetSortStates();this.saveAllSortSettings();this.hot.render();this.hot.view.wt.draw(true)}this.hot.runHooks("afterColumnSort",r,this.getSortConfig(),a)}},{key:"clearSort",value:function e(){this.sort([])}},{key:"isSorted",value:function e(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function e(t){var i=this;var r=function e(t){var r=t.column,n=(0,u.default)(t,["column"]);return I({column:i.hot.toVisualColumn(r)},n)};if((0,p.isDefined)(t)){var n=this.hot.toPhysicalColumn(t);var a=this.columnStatesManager.getColumnSortState(n);if((0,p.isDefined)(a)){return r(a)}return}var o=this.columnStatesManager.getSortStates();return(0,m.arrayMap)(o,function(e){return r(e)})}},{key:"setSortConfig",value:function e(t){var i=this;var r=this.getNormalizedSortConfigs(t);if(this.areValidSortConfigs(r)){var n=function e(t){var r=t.column,n=(0,u.default)(t,["column"]);return I({column:i.hot.toPhysicalColumn(r)},n)};var a=(0,m.arrayMap)(r,function(e){return n(e)});this.columnStatesManager.setSortStates(a)}}},{key:"getNormalizedSortConfigs",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(Array.isArray(t)){return t.slice(0,1)}return[t].slice(0,1)}},{key:"areValidSortConfigs",value:function e(t){if(Array.isArray(t)===false){return false}var r=t.map(function(e){var t=e.column;return t});var n=this.hot.countCols();var i=r.every(function(e){return e<=n&&e>=0});return(0,k.areValidSortStates)(t)&&i}},{key:"saveAllSortSettings",value:function e(){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=this.columnStatesManager.getSortStates();this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"getAllSavedSortSettings",value:function e(){var i=this;var t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var r=t.value;var n=function e(t){var r=t.column,n=(0,u.default)(t,["column"]);return I({column:i.hot.toVisualColumn(r)},n)};if((0,p.isDefined)(r)&&Array.isArray(r.initialConfig)){r.initialConfig=(0,m.arrayMap)(r.initialConfig,n)}return r}},{key:"getColumnNextConfig",value:function e(t){var r=this.hot.toPhysicalColumn(t);if(this.columnStatesManager.isColumnSorted(r)){var n=this.getSortConfig(t);var i=(0,k.getNextSortOrder)(n.sortOrder);if((0,p.isDefined)(i)){n.sortOrder=i;return n}return}var a=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<a){return{column:t,sortOrder:(0,k.getNextSortOrder)()}}}},{key:"getNextSortConfig",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:O;var n=this.hot.toPhysicalColumn(t);var i=this.columnStatesManager.getIndexOfColumnInSortQueue(n);var a=this.columnStatesManager.isColumnSorted(n);var o=this.getSortConfig();var s=this.getColumnNextConfig(t);if(a){if((0,p.isUndefined)(s)){return[].concat((0,l.default)(o.slice(0,i)),(0,l.default)(o.slice(i+1)))}if(r===O){return[].concat((0,l.default)(o.slice(0,i)),(0,l.default)(o.slice(i+1)),[s])}else if(r===A){return[].concat((0,l.default)(o.slice(0,i)),[s],(0,l.default)(o.slice(i+1)))}}if((0,p.isDefined)(s)){return o.concat(s)}return o}},{key:"setMergedPluginSettings",value:function e(t){var r=this.hot.toPhysicalColumn(t);var n=this.hot.getSettings()[this.pluginKey];var i=this.columnStatesManager.getAllColumnsProperties();var a=this.hot.getCellMeta(0,t);var o=Object.getPrototypeOf(a);var s=Object.hasOwnProperty.call(o,this.pluginKey);var l=s?o[this.pluginKey]:{};this.columnMetaCache.set(r,Object.assign(i,n,l))}},{key:"getFirstCellSettings",value:function e(t){var r=this.blockPluginTranslation;this.blockPluginTranslation=true;if(this.columnMetaCache.size===0||this.columnMetaCache.size<this.hot.countCols()){this.rebuildColumnMetaCache()}var n=this.hot.getCellMeta(0,t);this.blockPluginTranslation=r;var i=Object.create(n);i[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(t));return i}},{key:"rebuildColumnMetaCache",value:function e(){var t=this;var r=this.hot.countCols();if(r===0){this.columnMetaCache.clear()}else{(0,y.rangeEach)(r-1,function(e){return t.setMergedPluginSettings(e)})}}},{key:"getNumberOfRowsToSort",value:function e(t){var r=this.hot.getSettings();if(r.maxRows<=t){return r.maxRows}return t-r.minSpareRows}},{key:"sortByPresetSortStates",value:function e(){var r=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty()){this.rowsMapper.clearMap();return}var t=[];var n=this.columnStatesManager.getSortedColumns();var i=this.hot.countRows();this.blockPluginTranslation=true;var a=function e(t){return(0,m.arrayMap)(n,function(e){return r.hot.getDataAtCell(t,r.hot.toVisualColumn(e))})};for(var o=0;o<this.getNumberOfRowsToSort(i);o+=1){t.push([o].concat(a(o)))}(0,D.sort)(t,this.pluginKey,(0,m.arrayMap)(n,function(e){return r.columnStatesManager.getSortOrderOfColumn(e)}),(0,m.arrayMap)(n,function(e){return r.getFirstCellSettings(r.hot.toVisualColumn(e))}));for(var s=t.length;s<i;s+=1){t.push([s].concat(a(s)))}this.blockPluginTranslation=false;this.rowsMapper._arrayMap=(0,m.arrayMap)(t,function(e){return e[0]})}},{key:"loadOrSortBySettings",value:function e(){this.columnMetaCache.clear();var t=this.getAllSavedSortSettings();if((0,g.isObject)(t)){this.sortBySettings(t)}else{var r=this.hot.getSettings()[this.pluginKey];this.sortBySettings(r)}}},{key:"sortBySettings",value:function e(t){if((0,g.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);var r=t.initialConfig;if(Array.isArray(r)||(0,g.isObject)(r)){this.sort(r)}}else{this.hot.render()}}},{key:"enableObserveChangesPlugin",value:function e(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.updateSettings({observeChanges:true})},0))}},{key:"onModifyRow",value:function e(t,r){if(this.blockPluginTranslation===false&&r!==this.pluginName&&this.isSorted()){var n=this.rowsMapper.getValueByIndex(t);t=n===null?t:n}return t}},{key:"onUnmodifyRow",value:function e(t,r){if(this.blockPluginTranslation===false&&r!==this.pluginName&&this.isSorted()){t=this.rowsMapper.getIndexByValue(t)}return t}},{key:"onAfterGetColHeader",value:function e(t,r){var n=(0,k.getHeaderSpanElement)(r);if((0,k.isFirstLevelColumnHeader)(t,r)===false||n===null){return}var i=this.hot.toPhysicalColumn(t);var a=this.getFirstCellSettings(t)[this.pluginKey];var o=a.indicator;var s=a.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,i,o,s)}},{key:"updateHeaderClasses",value:function e(t){(0,v.removeClass)(t,(0,T.getClassedToRemove)(t));if(this.enabled!==false){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++){n[i-1]=arguments[i]}(0,v.addClass)(t,T.getClassesToAdd.apply(void 0,n))}}},{key:"onUpdateSettings",value:function e(t){(0,d.default)((0,c.default)(r.prototype),"onUpdateSettings",this).call(this);this.columnMetaCache.clear();if((0,p.isDefined)(t[this.pluginKey])){this.sortBySettings(t[this.pluginKey])}}},{key:"onAfterLoadData",value:function e(t){this.rowsMapper.clearMap();this.columnMetaCache.clear();if(t===true){if(this.hot.view){this.loadOrSortBySettings()}}}},{key:"onAfterCreateRow",value:function e(t,r){this.rowsMapper.shiftItems(t,r)}},{key:"onAfterRemoveRow",value:function e(t,r){this.rowsMapper.unshiftItems(t,r)}},{key:"onAfterCreateCol",value:function e(){this.columnMetaCache.clear()}},{key:"onAfterRemoveCol",value:function e(){this.columnMetaCache.clear()}},{key:"wasClickableHeaderClicked",value:function e(t,r){var n=this.getFirstCellSettings(r)[this.pluginKey];var i=n.headerAction;return i&&t.realTarget.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function e(t,r,n,i){if((0,k.wasHeaderClickedProperly)(r.row,r.col,t)===false){return}if(this.wasClickableHeaderClicked(t,r.col)&&(0,S.isPressedCtrlKey)()){i.column=true}}},{key:"onAfterOnCellMouseDown",value:function e(t,r){if((0,k.wasHeaderClickedProperly)(r.row,r.col,t)===false){return}if(this.wasClickableHeaderClicked(t,r.col)){if((0,S.isPressedCtrlKey)()){this.hot.deselectCell();this.hot.selectColumns(r.col)}this.sort(this.getColumnNextConfig(r.col))}}},{key:"destroy",value:function e(){this.rowsMapper.destroy();this.columnStatesManager.destroy();(0,d.default)((0,c.default)(r.prototype),"destroy",this).call(this)}}]);return r}(b.default);(0,w.registerPlugin)(N,M);var L=M;t.default=L},function(e,t,r){var n=r(20);var i=r(530);n({target:"Object",stat:true,forced:Object.assign!==i},{assign:i})},function(e,t,r){var n=r(229);var i=r(217);var a=r(230);function o(e){return n(e)||i(e)||a()}e.exports=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.getCompareFunctionFactory=p;t.getRootComparator=t.registerRootComparator=void 0;var i=r(537);var a=r(538);var o=r(539);var s=n(r(83));var l=(0,s.default)("sorting.compareFunctionFactory"),u=l.register,f=l.getItem,c=l.hasItem;var d=(0,s.default)("sorting.mainSortComparator"),h=d.register,v=d.getItem;t.getRootComparator=v;t.registerRootComparator=h;function p(e){if(c(e)){return f(e)}return f(i.COLUMN_DATA_TYPE)}u(a.COLUMN_DATA_TYPE,a.compareFunctionFactory);u(o.COLUMN_DATA_TYPE,o.compareFunctionFactory);u(i.COLUMN_DATA_TYPE,i.compareFunctionFactory)},function(e,t,r){"use strict";var n=r(0);r(54);r(23);r(52);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var c=r(4);var d=r(3);var o=function(){function t(e){(0,i.default)(this,t);this.hot=e;this.commands={};this.commonCallback=null}(0,a.default)(t,[{key:"registerCommand",value:function e(t,r){this.commands[t]=r}},{key:"setCommonCallback",value:function e(t){this.commonCallback=t}},{key:"execute",value:function e(t){var r=this;for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++){i[a-1]=arguments[a]}var o=t.split(":");var s=o[0];var l=o.length===2?o[1]:null;var u=this.commands[s];if(!u){throw new Error("Menu command '".concat(s,"' not exists."))}if(l&&u.submenu){u=h(l,u.submenu.items)}if(u.disabled===true){return}if(typeof u.disabled==="function"&&u.disabled.call(this.hot)===true){return}if((0,d.hasOwnProperty)(u,"submenu")){return}var f=[];if(typeof u.callback==="function"){f.push(u.callback)}if(typeof this.commonCallback==="function"){f.push(this.commonCallback)}i.unshift(o.join(":"));(0,c.arrayEach)(f,function(e){return e.apply(r.hot,i)})}}]);return t}();function h(r,e){var n;(0,c.arrayEach)(e,function(e){var t=e.key?e.key.split(":"):null;if(Array.isArray(t)&&t[1]===r){n=e;return false}});return n}var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);r(12);r(56);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(3);var s=r(4);var l=r(89);var u=function(){function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;(0,i.default)(this,r);this.hot=e;this.predefinedItems=(0,l.predefinedItems)();this.defaultOrderPattern=t}(0,a.default)(r,[{key:"setPredefinedItems",value:function e(t){var n=this;var i={};this.defaultOrderPattern.length=0;(0,o.objectEach)(t,function(e,t){var r="";if(e.name===l.SEPARATOR){i[l.SEPARATOR]=e;r=l.SEPARATOR}else if(isNaN(parseInt(t,10))){e.key=e.key===void 0?t:e.key;i[t]=e;r=e.key}else{i[e.key]=e;r=e.key}n.defaultOrderPattern.push(r)});this.predefinedItems=i}},{key:"getItems",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return f(t,this.defaultOrderPattern,this.predefinedItems)}}]);return r}();function f(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=[];var r=e;if(r&&r.items){r=r.items}else if(!Array.isArray(r)){r=t}if((0,o.isObject)(r)){(0,o.objectEach)(r,function(e,t){var r=n[typeof e==="string"?e:t];if(!r){r=e}if((0,o.isObject)(e)){(0,o.extend)(r,e)}else if(typeof r==="string"){r={name:r}}if(r.key===void 0){r.key=t}i.push(r)})}else{(0,s.arrayEach)(r,function(e,t){var r=n[e];if(!r&&l.ITEMS.indexOf(e)>=0){return}if(!r){r={name:e,key:"".concat(t)}}if((0,o.isObject)(e)){(0,o.extend)(r,e)}if(r.key===void 0){r.key=t}i.push(r)})}return i}var c=u;t.default=c},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(17);var s=0;var l=1;var u=2;var f="px";var c=function(){function t(e){(0,i.default)(this,t);this.hot=e;this._element=null;this.state=s}(0,a.default)(t,[{key:"appendTo",value:function e(t){t.appendChild(this._element);this.state=u}},{key:"build",value:function e(){this._element=this.hot.rootDocument.createElement("div");this.state=l}},{key:"destroy",value:function e(){if(this.isAppended()){this._element.parentElement.removeChild(this._element)}this._element=null;this.state=s}},{key:"isAppended",value:function e(){return this.state===u}},{key:"isBuilt",value:function e(){return this.state>=l}},{key:"setPosition",value:function e(t,r){if((0,o.isNumeric)(t)){this._element.style.top=t+f}if((0,o.isNumeric)(r)){this._element.style.left=r+f}}},{key:"getPosition",value:function e(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function e(t,r){if((0,o.isNumeric)(t)){this._element.style.width=t+f}if((0,o.isNumeric)(r)){this._element.style.height=r+f}}},{key:"getSize",value:function e(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function e(t,r){if((0,o.isNumeric)(t)){this._element.style.marginTop=t+f}if((0,o.isNumeric)(r)){this._element.style.marginLeft=r+f}}},{key:"getOffset",value:function e(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]);return t}();var d=c;t.default=d},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=0;var s=1;var l=2;var u="px";var f=function(){function t(e){(0,i.default)(this,t);this.hot=e;this._element=null;this.state=o}(0,a.default)(t,[{key:"appendTo",value:function e(t){t.appendChild(this._element);this.state=l}},{key:"build",value:function e(){this._element=this.hot.rootDocument.createElement("div");this.state=s}},{key:"destroy",value:function e(){if(this.isAppended()){this._element.parentElement.removeChild(this._element)}this._element=null;this.state=o}},{key:"isAppended",value:function e(){return this.state===l}},{key:"isBuilt",value:function e(){return this.state>=s}},{key:"setPosition",value:function e(t,r){if(t!==void 0){this._element.style.top=t+u}if(r!==void 0){this._element.style.left=r+u}}},{key:"getPosition",value:function e(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function e(t,r){if(t){this._element.style.width=t+u}if(r){this._element.style.height=r+u}}},{key:"getSize",value:function e(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function e(t,r){if(t){this._element.style.marginTop=t+u}if(r){this._element.style.marginLeft=r+u}}},{key:"getOffset",value:function e(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]);return t}();var c=f;t.default=c},function(e,t,r){"use strict";r(10);r(38);t.__esModule=true;t.applySpanProperties=n;function n(e,t,r,n){if(t){if(t.row===r&&t.col===n){e.setAttribute("rowspan",t.rowspan.toString());e.setAttribute("colspan",t.colspan.toString())}else{e.removeAttribute("rowspan");e.removeAttribute("colspan");e.style.display="none"}}else{e.removeAttribute("rowspan");e.removeAttribute("colspan");e.style.display=""}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.condition=s;t.CONDITION_NAME=void 0;var i=n(r(11));var a=r(30);var o="empty";t.CONDITION_NAME=o;function s(e){return e.value===""||e.value===null||e.value===void 0}(0,a.registerCondition)(o,s,{name:i.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=f;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(29);var l=r(30);var u="eq";t.CONDITION_NAME=u;function f(e,t){var r=(0,a.default)(t,1),n=r[0];return(0,s.stringify)(e.value).toLowerCase()===(0,s.stringify)(n)}(0,l.registerCondition)(u,f,{name:o.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=s;t.CONDITION_NAME=void 0;var c=i(r(18));var a=n(r(11));var d=r(30);var h=r(407);var v=r(408);var o="between";t.CONDITION_NAME=o;function s(e,t){var r=(0,c.default)(t,2),n=r[0],i=r[1];var a=n;var o=i;if(e.meta.type==="numeric"){var s=parseFloat(a,10);var l=parseFloat(o,10);a=Math.min(s,l);o=Math.max(s,l)}else if(e.meta.type==="date"){var u=(0,d.getCondition)(v.CONDITION_NAME,[o]);var f=(0,d.getCondition)(h.CONDITION_NAME,[a]);return u(e)&&f(e)}return e.value>=a&&e.value<=o}(0,d.registerCondition)(o,s,{name:a.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=f;t.CONDITION_NAME=void 0;var o=i(r(18));var s=i(r(64));var a=n(r(11));var l=r(30);var u="date_after";t.CONDITION_NAME=u;function f(e,t){var r=(0,o.default)(t,1),n=r[0];var i=(0,s.default)(e.value,e.meta.dateFormat);var a=(0,s.default)(n,e.meta.dateFormat);if(!i.isValid()||!a.isValid()){return false}return i.diff(a)>=0}(0,l.registerCondition)(u,f,{name:a.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=f;t.CONDITION_NAME=void 0;var o=i(r(18));var s=i(r(64));var a=n(r(11));var l=r(30);var u="date_before";t.CONDITION_NAME=u;function f(e,t){var r=(0,o.default)(t,1),n=r[0];var i=(0,s.default)(e.value,e.meta.dateFormat);var a=(0,s.default)(n,e.meta.dateFormat);if(!i.isValid()||!a.isValid()){return false}return i.diff(a)<=0}(0,l.registerCondition)(u,f,{name:a.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(12);t.__esModule=true;t.condition=f;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(29);var l=r(30);var u="contains";t.CONDITION_NAME=u;function f(e,t){var r=(0,a.default)(t,1),n=r[0];return(0,s.stringify)(e.value).toLowerCase().indexOf((0,s.stringify)(n))>=0}(0,l.registerCondition)(u,f,{name:o.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);r(99);t.__esModule=true;t.operationResult=l;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=void 0;var i=n(r(11));var a=r(126);var o="disjunction";t.OPERATION_ID=o;var s=i.FILTERS_LABELS_DISJUNCTION;t.SHORT_NAME_FOR_COMPONENT=s;function l(e,t){return e.some(function(e){return e.func(t)})}(0,a.registerOperation)(o,s,l)},function(e,t,r){"use strict";var n=r(9);r(41);r(99);t.__esModule=true;t.operationResult=l;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=void 0;var i=n(r(11));var a=r(126);var o="disjunctionWithExtraCondition";t.OPERATION_ID=o;var s=i.FILTERS_LABELS_DISJUNCTION;t.SHORT_NAME_FOR_COMPONENT=s;function l(e,t){if(e.length<3){throw Error("Operation doesn't work on less then three conditions.")}return e.slice(0,e.length-1).some(function(e){return e.func(t)})&&e[e.length-1].func(t)}(0,a.registerOperation)(o,s,l)},function(e,t,r){"use strict";var n=r(0);r(12);r(33);r(56);t.__esModule=true;t.default=void 0;var i=n(r(72));var a=n(r(1));var o=n(r(2));var s=r(4);var l=r(3);var u=r(73);var f=n(r(62));var c=r(30);var d=r(190);var h=r(126);function v(){var t=(0,i.default)(["The column of index "," has been already applied with a `","`\n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones.\n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`,\n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\n        use it consequently for a particular column)."]);v=function e(){return t};return t}var p=function(){function e(){(0,a.default)(this,e);this.conditions=this.initConditionsCollection();this.columnTypes={};this.orderStack=[]}(0,o.default)(e,[{key:"isEmpty",value:function e(){return!this.orderStack.length}},{key:"isMatch",value:function e(r,t){var n=this;var i=true;if(t===void 0){(0,l.objectEach)(this.columnTypes,function(e,t){i=n.isMatchInConditions(n.conditions[e][t],r,e);return i})}else{var a=this.columnTypes[t];i=this.isMatchInConditions(this.getConditions(t),r,a)}return i}},{key:"isMatchInConditions",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:d.OPERATION_ID;var i=false;if(t.length){i=(0,h.getOperationFunc)(n)(t,r)}else{i=true}return i}},{key:"addCondition",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:d.OPERATION_ID;var i=(0,s.arrayMap)(r.args,function(e){return typeof e==="string"?e.toLowerCase():e});var a=r.name||r.command.key;this.runLocalHooks("beforeAdd",t);if(this.orderStack.indexOf(t)===-1){this.orderStack.push(t)}var o=this.columnTypes[t];if(o){if(o!==n){throw Error((0,u.toSingleLine)(v(),t,o))}}else{if(!this.conditions[n]){throw new Error("Unexpected operation named `".concat(n,"`. Possible ones are `disjunction` and `conjunction`."))}this.columnTypes[t]=n}this.getConditions(t).push({name:a,args:i,func:(0,c.getCondition)(a,i)});this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function e(t){var r=this.columnTypes[t];if(!r){return[]}if(!this.conditions[r][t]){this.conditions[r][t]=[]}return this.conditions[r][t]}},{key:"exportAllConditions",value:function e(){var n=this;var i=[];(0,s.arrayEach)(this.orderStack,function(e){var t=(0,s.arrayMap)(n.getConditions(e),function(e){var t=e.name,r=e.args;return{name:t,args:r}});var r=n.columnTypes[e];i.push({column:e,operation:r,conditions:t})});return i}},{key:"importAllConditions",value:function e(t){var r=this;this.clean();(0,s.arrayEach)(t,function(t){r.orderStack.push(t.column);(0,s.arrayEach)(t.conditions,function(e){return r.addCondition(t.column,e)})})}},{key:"removeConditions",value:function e(t){this.runLocalHooks("beforeRemove",t);if(this.orderStack.indexOf(t)>=0){this.orderStack.splice(this.orderStack.indexOf(t),1)}this.clearConditions(t);this.runLocalHooks("afterRemove",t)}},{key:"clearConditions",value:function e(t){this.runLocalHooks("beforeClear",t);this.getConditions(t).length=0;delete this.columnTypes[t];this.runLocalHooks("afterClear",t)}},{key:"hasConditions",value:function e(t,r){var n=this.columnTypes[t];var i=false;if(!n){return false}var a=this.getConditions(t);if(r){i=(0,s.arrayFilter)(a,function(e){return e.name===r}).length>0}else{i=a.length>0}return i}},{key:"clean",value:function e(){this.runLocalHooks("beforeClean");this.columnTypes=Object.create(null);this.orderStack.length=0;this.conditions=this.initConditionsCollection();this.runLocalHooks("afterClean")}},{key:"destroy",value:function e(){this.clearLocalHooks();this.conditions=null;this.orderStack=null;this.columnTypes=null}},{key:"initConditionsCollection",value:function e(){var r=Object.create(null);(0,l.objectEach)(h.operations,function(e,t){r[t]=Object.create(null)});return r}}]);return e}();(0,l.mixin)(p,f.default);var g=p;t.default=g},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(4);var s=function(){function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return[]};(0,i.default)(this,r);this.conditionCollection=e;this.columnDataFactory=t}(0,a.default)(r,[{key:"filter",value:function e(){var n=this;var i=[];if(!this.conditionCollection.isEmpty()){(0,o.arrayEach)(this.conditionCollection.orderStack,function(e,t){var r=n.columnDataFactory(e);if(t){r=n._getIntersectData(r,i)}i=n.filterByColumn(e,r)})}return i}},{key:"filterByColumn",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i=[];(0,o.arrayEach)(n,function(e){if(e!==void 0&&r.conditionCollection.isMatch(e,t)){i.push(e)}});return i}},{key:"_getIntersectData",value:function e(r,t){var n=[];(0,o.arrayEach)(t,function(e){var t=e.meta.visualRow;if(r[t]!==void 0){n[t]=r[t]}});return n}}]);return r}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var a=n(r(1));var o=n(r(2));var s=r(128);var l=r(3);var i=function(){function i(e,t){(0,a.default)(this,i);var r=(0,l.isObject)(e);var n=(0,l.isObject)(t);this._row=r?e.index:e;this.rowAbsolute=r?e.isAbsolute:true;this._column=n?t.index:t;this.columnAbsolute=n?t.isAbsolute:true;this.rowOffset=0;this.columnOffset=0;Object.defineProperty(this,"row",{get:function e(){return this.rowOffset+this._row},set:function e(t){this._row=t},enumerable:true,configurable:true});Object.defineProperty(this,"column",{get:function e(){return this.columnOffset+this._column},set:function e(t){this._column=t},enumerable:true,configurable:true})}(0,o.default)(i,[{key:"translateTo",value:function e(t,r){this.row=this.row+t;this.column=this.column+r}},{key:"isEqual",value:function e(t){return t.row===this.row&&t.column===this.column}},{key:"toString",value:function e(){return(0,s.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]);return i}();var u=i;t.default=u},function(e,t,r){"use strict";var n=r(0);r(19);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(2));var l=n(r(7));var h=r(4);var v=r(17);var p=r(8);var u=n(r(193));var f=function(e){(0,l.default)(d,e);(0,s.default)(d,null,[{key:"CSS_CLASSES",get:function e(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]);function d(e,t){var r;(0,i.default)(this,d);r=(0,a.default)(this,(0,o.default)(d).call(this,e,t));r.dataManager=r.plugin.dataManager;r.collapsingUI=r.plugin.collapsingUI;r.rowHeaderWidthCache=null;r.trimRowsPlugin=e.trimRowsPlugin;return r}(0,s.default)(d,[{key:"appendLevelIndicators",value:function e(t,r){var n=this.trimRowsPlugin.rowsMapper.getValueByIndex(t);var i=this.dataManager.getRowLevel(n);var a=this.dataManager.getDataObject(n);var o=r.getElementsByTagName("DIV")[0];var s=o.querySelector("span.rowHeader");var l=o.querySelectorAll('[class^="ht_nesting"]');(0,h.arrayEach)(l,function(e){if(e){o.removeChild(e)}});(0,p.addClass)(r,d.CSS_CLASSES.indicatorContainer);if(i){var u=this.hot.rootDocument;var f=s.cloneNode(true);o.innerHTML="";(0,v.rangeEach)(0,i-1,function(){var e=u.createElement("SPAN");(0,p.addClass)(e,d.CSS_CLASSES.emptyIndicator);o.appendChild(e)});o.appendChild(f)}if(this.dataManager.hasChildren(a)){var c=this.hot.rootDocument.createElement("DIV");(0,p.addClass)(r,d.CSS_CLASSES.parent);if(this.collapsingUI.areChildrenCollapsed(n)){(0,p.addClass)(c,"".concat(d.CSS_CLASSES.button," ").concat(d.CSS_CLASSES.expandButton))}else{(0,p.addClass)(c,"".concat(d.CSS_CLASSES.button," ").concat(d.CSS_CLASSES.collapseButton))}o.appendChild(c)}}},{key:"updateRowHeaderWidth",value:function e(t){var r=t;if(!r){r=this.dataManager.cache.levelCount}this.rowHeaderWidthCache=Math.max(50,11+10*r+25);this.hot.render()}}]);return d}(u.default);var c=f;t.default=c},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(417);t.__esModule=true;t.default=void 0;r(418);r(419);r(420);var a=r(57);var o=r(43);var s=r(85);var l=r(180);var u=i(r(181));var f=i(r(522));var c=n(r(25));var d=i(r(46));var h=i(r(184));var v=n(r(183));var p=n(r(4));var g=n(r(71));var m=n(r(147));var y=n(r(379));var b=n(r(76));var w=n(r(77));var C=n(r(29));var S=n(r(17));var E=n(r(3));var k=n(r(182));var T=n(r(74));var _=n(r(55));var x=n(r(8));var D=n(r(32));var R=n(r(523));var I=r(21);var O=i(r(386));var A=r(383);var N=r(387);var M=n(r(11));var L=r(150);function P(e,t){var r=new u.default(e,t||{},A.rootInstanceSymbol);r.init();return r}(0,f.default)(P);P.Core=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new u.default(e,t,A.rootInstanceSymbol)};P.DefaultSettings=O.default;P.EventManager=c.default;P._getListenersCounter=c.getListenersCounter;P.packageName="handsontable";P.buildDate="19/02/2020 13:44:06";P.version="7.4.2";P.hooks=d.default.getSingleton();P.__GhostTable=h.default;var F=[p,g,m,y,b,w,C,S,E,k,T,_,v];var B=[x,D];P.helper={};P.dom={};p.arrayEach(F,function(t){p.arrayEach(Object.getOwnPropertyNames(t),function(e){if(e.charAt(0)!=="_"){P.helper[e]=t[e]}})});p.arrayEach(B,function(t){p.arrayEach(Object.getOwnPropertyNames(t),function(e){if(e.charAt(0)!=="_"){P.dom[e]=t[e]}})});P.cellTypes={};p.arrayEach((0,l.getRegisteredCellTypeNames)(),function(e){P.cellTypes[e]=(0,l.getCellType)(e)});P.cellTypes.registerCellType=l.registerCellType;P.cellTypes.getCellType=l.getCellType;P.editors={};p.arrayEach((0,a.getRegisteredEditorNames)(),function(e){P.editors["".concat(T.toUpperCaseFirst(e),"Editor")]=(0,a.getEditor)(e)});P.editors.registerEditor=a.registerEditor;P.editors.getEditor=a.getEditor;P.renderers={};p.arrayEach((0,o.getRegisteredRendererNames)(),function(e){var t=(0,o.getRenderer)(e);if(e==="base"){P.renderers.cellDecorator=t}P.renderers["".concat(T.toUpperCaseFirst(e),"Renderer")]=t});P.renderers.registerRenderer=o.registerRenderer;P.renderers.getRenderer=o.getRenderer;P.validators={};p.arrayEach((0,s.getRegisteredValidatorNames)(),function(e){P.validators["".concat(T.toUpperCaseFirst(e),"Validator")]=(0,s.getValidator)(e)});P.validators.registerValidator=s.registerValidator;P.validators.getValidator=s.getValidator;P.plugins={};p.arrayEach(Object.getOwnPropertyNames(R),function(e){var t=R[e];if(e==="Base"){P.plugins["".concat(e,"Plugin")]=t}else{P.plugins[e]=t}});P.plugins.registerPlugin=I.registerPlugin;P.languages={};P.languages.dictionaryKeys=M;P.languages.getLanguageDictionary=L.getLanguageDictionary;P.languages.getLanguagesDictionaries=L.getLanguagesDictionaries;P.languages.registerLanguageDictionary=L.registerLanguageDictionary;P.languages.getTranslatedPhrase=function(){return N.getTranslatedPhrase.apply(void 0,arguments)};var H=P;t.default=H},function(e,t,r){var n=r(20);var i=r(26);var a=r(202).f;var o=i(function(){return!Object.getOwnPropertyNames(1)});n({target:"Object",stat:true,forced:o},{getOwnPropertyNames:a})},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){var n=r(44);var s=r(51);var l=r(48);var u=r(111);e.exports=n?Object.defineProperties:function e(t,r){l(t);var n=u(r);var i=n.length;var a=0;var o;while(i>a)s.f(t,o=n[a++],r[o]);return t}},function(e,t,r){"use strict";var i=r(205).IteratorPrototype;var a=r(110);var o=r(103);var s=r(135);var l=r(112);var u=function(){return this};e.exports=function(e,t,r){var n=t+" Iterator";e.prototype=a(i,{next:o(1,r)});s(e,n,false,true);l[n]=u;return e}},function(e,t,r){var n=r(45);e.exports=function(e){if(!n(e)&&e!==null){throw TypeError("Can't set "+String(e)+" as a prototype")}return e}},function(e,t,r){"use strict";var n=r(164);var i=r(208);e.exports=n?{}.toString:function e(){return"[object "+i(this)+"]"}},function(e,t,r){var n=r(26);e.exports=!n(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(e,t){function r(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++){r[t]=e[t]}return r}}e.exports=r},function(e,t){function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}e.exports=r},function(e,t,r){"use strict";var p=r(113);var g=r(58);var m=r(211);var y=r(209);var b=r(49);var w=r(115);var C=r(210);e.exports=function e(t){var r=g(t);var n=typeof this=="function"?this:Array;var i=arguments.length;var a=i>1?arguments[1]:undefined;var o=a!==undefined;var s=C(r);var l=0;var u,f,c,d,h,v;if(o)a=p(a,i>2?arguments[2]:undefined,2);if(s!=undefined&&!(n==Array&&y(s))){d=s.call(r);h=d.next;f=new n;for(;!(c=h.call(d)).done;l++){v=o?m(d,a,[c.value,l],true):c.value;w(f,l,v)}}else{u=b(r.length);f=new n(u);for(;u>l;l++){v=o?a(r[l],l):r[l];w(f,l,v)}}f.length=l;return f}},function(e,t,r){var i=r(48);var a=r(138);var n=r(36);var o=n("species");e.exports=function(e,t){var r=i(e).constructor;var n;return r===undefined||(n=i(r)[o])==undefined?t:a(n)}},function(e,t,r){var n=r(26);var i=r(221);var a="âÂá ";e.exports=function(e){return n(function(){return!!i[e]()||a[e]()!=a||i[e].name!==e})}},function(e,t){function r(e,t){if(!(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")){return}var r=[];var n=true;var i=false;var a=undefined;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){i=true;a=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(i)throw a}}return r}e.exports=r},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=r(145);var f=n(r(121));var c=function(e){(0,l.default)(t,e);function t(){var e;(0,i.default)(this,t);e=(0,o.default)(this,(0,s.default)(t).call(this,"TH"));e.orderViews=new WeakMap;e.sourceRowIndex=0;return e}(0,a.default)(t,[{key:"obtainOrderView",value:function e(t){var r=this;var n;if(this.orderViews.has(t)){n=this.orderViews.get(t)}else{n=new u.SharedOrderView(t,function(e){return r.nodesPool.obtain(r.sourceRowIndex,e)},this.nodeType);this.orderViews.set(t,n)}return n}},{key:"render",value:function e(){var t=this.table,r=t.rowsToRender,n=t.rowHeaderFunctions,i=t.rowHeadersCount,a=t.rows,o=t.cells;for(var s=0;s<r;s++){var l=this.table.renderedRowToSource(s);var u=a.getRenderedNode(s);this.sourceRowIndex=l;var f=this.obtainOrderView(u);var c=o.obtainOrderView(u);f.appendView(c).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(var d=0;d<i;d++){f.render();var h=f.getCurrentNode();h.className="";h.removeAttribute("style");n[d](l,h,d)}f.end()}}}]);return t}(f.default);t.default=c},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(434));var s=r(233);var l=function(){function e(){(0,i.default)(this,e);this.size=new o.default;this.workingSpace=s.WORKING_SPACE_ALL;this.sharedSize=null}(0,a.default)(e,[{key:"setSize",value:function e(t){this.size.setSize(t)}},{key:"setOffset",value:function e(t){this.size.setOffset(t)}},{key:"getViewSize",value:function e(){return this.size}},{key:"isShared",value:function e(){return this.sharedSize instanceof o.default}},{key:"isPlaceOn",value:function e(t){return this.workingSpace===t}},{key:"append",value:function e(t){this.workingSpace=s.WORKING_SPACE_TOP;t.workingSpace=s.WORKING_SPACE_BOTTOM;this.sharedSize=t.getViewSize()}},{key:"prepend",value:function e(t){this.workingSpace=s.WORKING_SPACE_BOTTOM;t.workingSpace=s.WORKING_SPACE_TOP;this.sharedSize=t.getViewSize()}}]);return e}();t.default=l},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function e(){(0,i.default)(this,e);this.currentSize=0;this.nextSize=0;this.currentOffset=0;this.nextOffset=0}(0,a.default)(e,[{key:"setSize",value:function e(t){this.currentSize=this.nextSize;this.nextSize=t}},{key:"setOffset",value:function e(t){this.currentOffset=this.nextOffset;this.nextOffset=t}}]);return e}();t.default=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=n(r(232));var f=function(e){(0,l.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"prependView",value:function e(t){this.sizeSet.prepend(t.sizeSet);t.sizeSet.append(this.sizeSet);return this}},{key:"appendView",value:function e(t){this.sizeSet.append(t.sizeSet);t.sizeSet.prepend(this.sizeSet);return this}}]);return t}(u.default);t.default=f},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function t(e){(0,i.default)(this,t);this.nodeType=e.toUpperCase()}(0,a.default)(t,[{key:"setRootDocument",value:function e(t){this.rootDocument=t}},{key:"obtain",value:function e(){return this.rootDocument.createElement(this.nodeType)}}]);return t}();t.default=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var c=r(8);var u=n(r(121));var f=function(e){(0,l.default)(t,e);function t(e){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).call(this,null,e))}(0,a.default)(t,[{key:"adjust",value:function e(){var t=this.table,r=t.columnHeadersCount,n=t.rowHeadersCount;var i=this.rootNode.firstChild;if(r){var a=this.table.columnsToRender;var o=a+n;for(var s=0,l=r;s<l;s++){i=this.rootNode.childNodes[s];if(!i){i=this.table.rootDocument.createElement("tr");this.rootNode.appendChild(i)}this.renderedNodes=i.childNodes.length;while(this.renderedNodes<o){i.appendChild(this.table.rootDocument.createElement("th"));this.renderedNodes+=1}while(this.renderedNodes>o){i.removeChild(i.lastChild);this.renderedNodes-=1}}var u=this.rootNode.childNodes.length;if(u>r){for(var f=r;f<u;f++){this.rootNode.removeChild(this.rootNode.lastChild)}}}else if(i){(0,c.empty)(i)}}},{key:"render",value:function e(){var t=this.table.columnHeadersCount;for(var r=0;r<t;r++){var n=this.table,i=n.columnHeaderFunctions,a=n.columnsToRender,o=n.rowHeadersCount;var s=this.rootNode.childNodes[r];for(var l=-1*o;l<a;l++){var u=this.table.renderedColumnToSource(l);var f=s.childNodes[l+o];f.className="";f.removeAttribute("style");i[r](u,f,r)}}}}]);return t}(u.default);t.default=f},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=n(r(121));var c=r(8);var f=function(e){(0,l.default)(t,e);function t(e){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).call(this,null,e))}(0,a.default)(t,[{key:"adjust",value:function e(){var t=this.table,r=t.columnsToRender,n=t.rowHeadersCount;var i=r+n;while(this.renderedNodes<i){this.rootNode.appendChild(this.table.rootDocument.createElement("col"));this.renderedNodes+=1}while(this.renderedNodes>i){this.rootNode.removeChild(this.rootNode.lastChild);this.renderedNodes-=1}}},{key:"render",value:function e(){this.adjust();var t=this.table,r=t.columnsToRender,n=t.rowHeadersCount;for(var i=0;i<n;i++){var a=this.table.renderedColumnToSource(i);var o=this.table.columnUtils.getHeaderWidth(a);this.rootNode.childNodes[i].style.width="".concat(o,"px")}for(var s=0;s<r;s++){var l=this.table.renderedColumnToSource(s);var u=this.table.columnUtils.getStretchedColumnWidth(l);this.rootNode.childNodes[s+n].style.width="".concat(u,"px")}var f=this.rootNode.firstChild;if(f){(0,c.addClass)(f,"rowHeader")}}}]);return t}(u.default);t.default=f},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(72));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var f=r(61);var c=r(73);var d=r(145);var h=n(r(121));function v(){var t=(0,i.default)(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number \n        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number\\x20\n        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']);v=function e(){return t};return t}var p=false;var g=function(e){(0,u.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,"TR",e));t.orderView=new d.OrderView(e,function(e){return t.nodesPool.obtain(e)},t.nodeType);return t}(0,o.default)(r,[{key:"getRenderedNode",value:function e(t){return this.orderView.getNode(t)}},{key:"render",value:function e(){var t=this.table.rowsToRender;if(!p&&t>1e3){p=true;(0,f.warn)((0,c.toSingleLine)(v()))}this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(var r=0;r<t;r++){this.orderView.render()}this.orderView.end()}}]);return r}(h.default);t.default=g},function(e,t,r){"use strict";var n=r(20);var i=r(165).codeAt;n({target:"String",proto:true},{codePointAt:function e(t){return i(this,t)}})},function(e,t,r){var f=r(49);var c=r(235);var d=r(53);var h=Math.ceil;var n=function(u){return function(e,t,r){var n=String(d(e));var i=n.length;var a=r===undefined?" ":String(r);var o=f(t);var s,l;if(o<=i||a=="")return n;s=o-i;l=c.call(a,h(s/a.length));if(l.length>s)l=l.slice(0,s);return u?n+l:l+n}};e.exports={start:n(false),end:n(true)}},function(e,t,r){var n=r(139);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function(){return e.i}});e.webpackPolyfill=1}return e}},function(e,t,r){var n={"./af":236,"./af.js":236,"./ar":237,"./ar-dz":238,"./ar-dz.js":238,"./ar-kw":239,"./ar-kw.js":239,"./ar-ly":240,"./ar-ly.js":240,"./ar-ma":241,"./ar-ma.js":241,"./ar-sa":242,"./ar-sa.js":242,"./ar-tn":243,"./ar-tn.js":243,"./ar.js":237,"./az":244,"./az.js":244,"./be":245,"./be.js":245,"./bg":246,"./bg.js":246,"./bm":247,"./bm.js":247,"./bn":248,"./bn.js":248,"./bo":249,"./bo.js":249,"./br":250,"./br.js":250,"./bs":251,"./bs.js":251,"./ca":252,"./ca.js":252,"./cs":253,"./cs.js":253,"./cv":254,"./cv.js":254,"./cy":255,"./cy.js":255,"./da":256,"./da.js":256,"./de":257,"./de-at":258,"./de-at.js":258,"./de-ch":259,"./de-ch.js":259,"./de.js":257,"./dv":260,"./dv.js":260,"./el":261,"./el.js":261,"./en-SG":262,"./en-SG.js":262,"./en-au":263,"./en-au.js":263,"./en-ca":264,"./en-ca.js":264,"./en-gb":265,"./en-gb.js":265,"./en-ie":266,"./en-ie.js":266,"./en-il":267,"./en-il.js":267,"./en-nz":268,"./en-nz.js":268,"./eo":269,"./eo.js":269,"./es":270,"./es-do":271,"./es-do.js":271,"./es-us":272,"./es-us.js":272,"./es.js":270,"./et":273,"./et.js":273,"./eu":274,"./eu.js":274,"./fa":275,"./fa.js":275,"./fi":276,"./fi.js":276,"./fo":277,"./fo.js":277,"./fr":278,"./fr-ca":279,"./fr-ca.js":279,"./fr-ch":280,"./fr-ch.js":280,"./fr.js":278,"./fy":281,"./fy.js":281,"./ga":282,"./ga.js":282,"./gd":283,"./gd.js":283,"./gl":284,"./gl.js":284,"./gom-latn":285,"./gom-latn.js":285,"./gu":286,"./gu.js":286,"./he":287,"./he.js":287,"./hi":288,"./hi.js":288,"./hr":289,"./hr.js":289,"./hu":290,"./hu.js":290,"./hy-am":291,"./hy-am.js":291,"./id":292,"./id.js":292,"./is":293,"./is.js":293,"./it":294,"./it-ch":295,"./it-ch.js":295,"./it.js":294,"./ja":296,"./ja.js":296,"./jv":297,"./jv.js":297,"./ka":298,"./ka.js":298,"./kk":299,"./kk.js":299,"./km":300,"./km.js":300,"./kn":301,"./kn.js":301,"./ko":302,"./ko.js":302,"./ku":303,"./ku.js":303,"./ky":304,"./ky.js":304,"./lb":305,"./lb.js":305,"./lo":306,"./lo.js":306,"./lt":307,"./lt.js":307,"./lv":308,"./lv.js":308,"./me":309,"./me.js":309,"./mi":310,"./mi.js":310,"./mk":311,"./mk.js":311,"./ml":312,"./ml.js":312,"./mn":313,"./mn.js":313,"./mr":314,"./mr.js":314,"./ms":315,"./ms-my":316,"./ms-my.js":316,"./ms.js":315,"./mt":317,"./mt.js":317,"./my":318,"./my.js":318,"./nb":319,"./nb.js":319,"./ne":320,"./ne.js":320,"./nl":321,"./nl-be":322,"./nl-be.js":322,"./nl.js":321,"./nn":323,"./nn.js":323,"./pa-in":324,"./pa-in.js":324,"./pl":325,"./pl.js":325,"./pt":326,"./pt-br":327,"./pt-br.js":327,"./pt.js":326,"./ro":328,"./ro.js":328,"./ru":329,"./ru.js":329,"./sd":330,"./sd.js":330,"./se":331,"./se.js":331,"./si":332,"./si.js":332,"./sk":333,"./sk.js":333,"./sl":334,"./sl.js":334,"./sq":335,"./sq.js":335,"./sr":336,"./sr-cyrl":337,"./sr-cyrl.js":337,"./sr.js":336,"./ss":338,"./ss.js":338,"./sv":339,"./sv.js":339,"./sw":340,"./sw.js":340,"./ta":341,"./ta.js":341,"./te":342,"./te.js":342,"./tet":343,"./tet.js":343,"./tg":344,"./tg.js":344,"./th":345,"./th.js":345,"./tl-ph":346,"./tl-ph.js":346,"./tlh":347,"./tlh.js":347,"./tr":348,"./tr.js":348,"./tzl":349,"./tzl.js":349,"./tzm":350,"./tzm-latn":351,"./tzm-latn.js":351,"./tzm.js":350,"./ug-cn":352,"./ug-cn.js":352,"./uk":353,"./uk.js":353,"./ur":354,"./ur.js":354,"./uz":355,"./uz-latn":356,"./uz-latn.js":356,"./uz.js":355,"./vi":357,"./vi.js":357,"./x-pseudo":358,"./x-pseudo.js":358,"./yo":359,"./yo.js":359,"./zh-cn":360,"./zh-cn.js":360,"./zh-hk":361,"./zh-hk.js":361,"./zh-tw":362,"./zh-tw.js":362};function i(e){var t=a(e);return r(t)}function a(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");t.code="MODULE_NOT_FOUND";throw t}return n[e]}i.keys=function e(){return Object.keys(n)};i.resolve=a;e.exports=i;i.id=444},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var v=r(8);var u=r(145);var f=n(r(121));var c=function(e){(0,l.default)(t,e);function t(){var e;(0,i.default)(this,t);e=(0,o.default)(this,(0,s.default)(t).call(this,"TD"));e.orderViews=new WeakMap;e.sourceRowIndex=0;return e}(0,a.default)(t,[{key:"obtainOrderView",value:function e(t){var r=this;var n;if(this.orderViews.has(t)){n=this.orderViews.get(t)}else{n=new u.SharedOrderView(t,function(e){return r.nodesPool.obtain(r.sourceRowIndex,e)},this.nodeType);this.orderViews.set(t,n)}return n}},{key:"render",value:function e(){var t=this.table,r=t.rowsToRender,n=t.columnsToRender,i=t.rows,a=t.rowHeaders;for(var o=0;o<r;o++){var s=this.table.renderedRowToSource(o);var l=i.getRenderedNode(o);this.sourceRowIndex=s;var u=this.obtainOrderView(l);var f=a.obtainOrderView(l);u.prependView(f).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<n;c++){u.render();var d=u.getCurrentNode();var h=this.table.renderedColumnToSource(c);if(!(0,v.hasClass)(d,"hide")){d.className=""}d.removeAttribute("style");this.table.cellRenderer(s,h,d)}u.end()}}}]);return t}(f.default);t.default=c},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},r=t.cellRenderer;(0,i.default)(this,n);this.rootNode=e;this.rootDocument=this.rootNode.ownerDocument;this.rowHeaders=null;this.columnHeaders=null;this.colGroup=null;this.rows=null;this.cells=null;this.rowFilter=null;this.columnFilter=null;this.rowUtils=null;this.columnUtils=null;this.rowsToRender=0;this.columnsToRender=0;this.rowHeaderFunctions=[];this.rowHeadersCount=0;this.columnHeaderFunctions=[];this.columnHeadersCount=0;this.cellRenderer=r}(0,a.default)(n,[{key:"setAxisUtils",value:function e(t,r){this.rowUtils=t;this.columnUtils=r}},{key:"setViewportSize",value:function e(t,r){this.rowsToRender=t;this.columnsToRender=r}},{key:"setFilters",value:function e(t,r){this.rowFilter=t;this.columnFilter=r}},{key:"setHeaderContentRenderers",value:function e(t,r){this.rowHeaderFunctions=t;this.rowHeadersCount=t.length;this.columnHeaderFunctions=r;this.columnHeadersCount=r.length}},{key:"setRenderers",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=t.rowHeaders,n=t.columnHeaders,i=t.colGroup,a=t.rows,o=t.cells;r.setTable(this);n.setTable(this);i.setTable(this);a.setTable(this);o.setTable(this);this.rowHeaders=r;this.columnHeaders=n;this.colGroup=i;this.rows=a;this.cells=o}},{key:"renderedRowToSource",value:function e(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function e(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function e(){this.colGroup.adjust();this.columnHeaders.adjust();this.rows.adjust();this.rowHeaders.adjust();this.columnHeaders.render();this.rows.render();this.rowHeaders.render();this.cells.render();this.columnUtils.calculateWidths();this.colGroup.render();var t=this.rowsToRender,r=this.rows;for(var n=0;n<t;n++){var i=r.getRenderedNode(n);if(i.firstChild){var a=this.renderedRowToSource(n);var o=this.rowUtils.getHeight(a);if(o){i.firstChild.style.height="".concat(o-1,"px")}else{i.firstChild.style.height=""}}}}}]);return n}();t.default=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;var i={ViewportColumnsCalculator:true,ViewportRowsCalculator:true};var a=n(r(223));t.ViewportColumnsCalculator=a.default;var o=n(r(224));t.ViewportRowsCalculator=o.default;var s=r(174);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;if(Object.prototype.hasOwnProperty.call(i,e))return;t[e]=s[e]})},function(e,t,r){"use strict";var n=r(0);r(15);r(69);r(10);r(13);r(16);t.__esModule=true;t.default=void 0;var i=n(r(42));var a=n(r(1));var o=n(r(2));var d=r(8);var s=function(){function t(e){(0,a.default)(this,t);this.wot=e;this.headerWidths=new Map}(0,o.default)(t,[{key:"getWidth",value:function e(t){var r=this.wot.wtSettings.settings.columnWidth;if(typeof r==="function"){r=r(t)}else if((0,i.default)(r)==="object"){r=r[t]}return r||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function e(t){var r=this.getWidth(t);var n=this.wot.wtViewport.columnsRenderCalculator;var i=r===null||r===void 0?this.wot.wtSettings.settings.defaultColumnWidth:r;if(n){var a=n.getStretchedColumnWidth(t,i);if(a){i=a}}return i}},{key:"getHeaderHeight",value:function e(t){var r=this.wot.wtSettings.settings.defaultRowHeight;var n=this.wot.wtViewport.oversizedColumnHeaders[t];if(n!==void 0){r=r?Math.max(r,n):n}return r}},{key:"getHeaderWidth",value:function e(t){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function e(){var t=this.wot;var r=t.wtTable,n=t.wtViewport,i=t.cloneSource;var a=i?i.wtTable.holder:r.holder;var o=a.offsetHeight<a.scrollHeight?(0,d.getScrollbarWidth)():0;var s=t.getSetting("rowHeaderWidth");n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-o);s=t.getSetting("onModifyRowHeaderWidth",s);if(s!==null&&s!==void 0){var l=t.getSetting("rowHeaders").length;var u=t.getSetting("defaultColumnWidth");for(var f=0;f<l;f++){var c=Array.isArray(s)?s[f]:s;c=c===null||c===void 0?u:c;this.headerWidths.set(f,c)}}}}]);return t}();t.default=s},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function t(e){(0,i.default)(this,t);this.wot=e}(0,a.default)(t,[{key:"getHeight",value:function e(t){var r=this.wot.wtSettings.settings.rowHeight(t);var n=this.wot.wtViewport.oversizedRows[t];if(n!==void 0){r=r===void 0?n:Math.max(r,n)}return r}}]);return t}();t.default=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(122));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var c=r(8);var f=n(r(451));var d=n(r(92));var h=function(e){(0,u.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.clone=t.makeClone(d.default.CLONE_LEFT);return t}(0,o.default)(r,[{key:"createTable",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(0,i.default)(f.default,r)}},{key:"shouldBeRendered",value:function e(){return!!(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function e(){var t=this.wot.wtTable;if(!this.needFullRender||!t.holder.parentNode){return}var r=this.clone.wtTable.holder.parentNode;var n=0;var i=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!i||i!=="horizontal")){var a=t.hider.getBoundingClientRect();var o=Math.ceil(a.left);var s=Math.ceil(a.right);var l;var u;u=t.hider.style.top;u=u===""?0:u;if(o<0&&s-r.offsetWidth>0){l=-o}else{l=0}n=l;l+="px";(0,c.setOverlayPosition)(r,l,u)}else{n=this.getScrollPosition();(0,c.resetCssTransform)(r)}this.adjustHeaderBordersPosition(n);this.adjustElementsSize()}},{key:"setScrollPosition",value:function e(t){var r=this.wot.rootWindow;var n=false;if(this.mainTableScrollableElement===r&&r.scrollX!==t){r.scrollTo(t,(0,c.getWindowScrollTop)(r));n=true}else if(this.mainTableScrollableElement.scrollLeft!==t){this.mainTableScrollableElement.scrollLeft=t;n=true}return n}},{key:"onScroll",value:function e(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function e(t,r){var n=this.wot.wtSettings.defaultColumnWidth;var i=t;var a=0;while(i<r){a+=this.wot.wtTable.getStretchedColumnWidth(i)||n;i+=1}return a}},{key:"adjustElementsSize",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||t){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!t){this.areElementSizesAdjusted=true}}}},{key:"adjustRootElementSize",value:function e(){var t=this.wot,r=t.wtTable,n=t.rootDocument,i=t.rootWindow;var a=(0,c.getScrollbarWidth)(n);var o=this.clone.wtTable.holder.parentNode;var s=o.style;var l=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="vertical"){var u=this.wot.wtViewport.getWorkspaceHeight();if(this.wot.wtOverlays.hasScrollbarBottom){u-=a}u=Math.min(u,r.wtRootElement.scrollHeight);s.height="".concat(u,"px")}else{s.height=""}this.clone.wtTable.holder.style.height=s.height;var f=(0,c.outerWidth)(this.clone.wtTable.TABLE);s.width="".concat(f===0?f:f+4,"px")}},{key:"adjustRootChildrenSize",value:function e(){var t=(0,c.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;if(t===0){t=30}this.clone.wtTable.holder.style.width="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+t,"px")}},{key:"applyToDOM",value:function e(){var t=this.wot.getSetting("totalColumns");if(!this.areElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px")}else if(t===0){this.spreader.style.left="0"}else{throw new Error("Incorrect value of the columnsRenderCalculator")}this.spreader.style.right="";if(this.needFullRender){this.syncOverlayOffset()}}},{key:"syncOverlayOffset",value:function e(){if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px")}else{this.clone.wtTable.spreader.style.top=""}}},{key:"scrollTo",value:function e(t,r){var n=this.getTableParentOffset();var i=this.wot.cloneSource?this.wot.cloneSource:this.wot;var a=i.wtTable.holder;var o=0;if(r&&a.offsetWidth!==a.clientWidth){o=(0,c.getScrollbarWidth)(this.wot.rootDocument)}if(r){n+=this.sumCellSizes(0,t+1);n-=this.wot.wtViewport.getViewportWidth()}else{n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),t)}n+=o;return this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function e(){var t=this.wot.getSetting("preventOverflow");var r=0;if(!t&&this.trimmingContainer===this.wot.rootWindow){r=this.wot.wtTable.holderOffset.left}return r}},{key:"getScrollPosition",value:function e(){return(0,c.getScrollLeft)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function e(t){var r=this.wot.wtTable.holder.parentNode;var n=this.wot.getSetting("rowHeaders");var i=this.wot.getSetting("fixedColumnsLeft");var a=this.wot.getSetting("totalRows");if(a){(0,c.removeClass)(r,"emptyRows")}else{(0,c.addClass)(r,"emptyRows")}if(i&&!n.length){(0,c.addClass)(r,"innerBorderLeft")}else if(!i&&n.length){var o=(0,c.hasClass)(r,"innerBorderLeft");if(t){(0,c.addClass)(r,"innerBorderLeft")}else{(0,c.removeClass)(r,"innerBorderLeft")}if(!o&&t||o&&!t){this.wot.wtOverlays.adjustElementsSize()}}}}]);return r}(d.default);d.default.registerOverlay(d.default.CLONE_LEFT,h);var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(7));var l=n(r(95));var u=n(r(370));var f=n(r(179));var c=r(3);var d=function(e){(0,s.default)(t,e);function t(){(0,i.default)(this,t);return(0,a.default)(this,(0,o.default)(t).apply(this,arguments))}return t}(l.default);(0,c.mixin)(d,u.default);(0,c.mixin)(d,f.default);var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(122));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var c=r(8);var f=r(4);var d=n(r(453));var h=n(r(92));var v=function(e){(0,u.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.clone=t.makeClone(h.default.CLONE_TOP);return t}(0,o.default)(r,[{key:"createTable",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(0,i.default)(d.default,r)}},{key:"shouldBeRendered",value:function e(){return!!(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function e(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var t=this.clone.wtTable.holder.parentNode;var r=0;var n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!n||n!=="vertical")){var i=this.wot.wtTable;var a=i.hider.getBoundingClientRect();var o=Math.ceil(a.top);var s=Math.ceil(a.bottom);var l;var u;l=i.hider.style.left;l=l===""?0:l;if(o<0&&s-t.offsetHeight>0){u=-o}else{u=0}r=u;u+="px";(0,c.setOverlayPosition)(t,l,u)}else{r=this.getScrollPosition();(0,c.resetCssTransform)(t)}this.adjustHeaderBordersPosition(r);this.adjustElementsSize()}},{key:"setScrollPosition",value:function e(t){var r=this.wot.rootWindow;var n=false;if(this.mainTableScrollableElement===r&&r.scrollY!==t){r.scrollTo((0,c.getWindowScrollLeft)(r),t);n=true}else if(this.mainTableScrollableElement.scrollTop!==t){this.mainTableScrollableElement.scrollTop=t;n=true}return n}},{key:"onScroll",value:function e(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function e(t,r){var n=this.wot.wtSettings.settings.defaultRowHeight;var i=t;var a=0;while(i<r){var o=this.wot.wtTable.getRowHeight(i);a+=o===void 0?n:o;i+=1}return a}},{key:"adjustElementsSize",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||t){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!t){this.areElementSizesAdjusted=true}}}},{key:"adjustRootElementSize",value:function e(){var t=this.wot,r=t.wtTable,n=t.rootDocument,i=t.rootWindow;var a=(0,c.getScrollbarWidth)(n);var o=this.clone.wtTable.holder.parentNode;var s=o.style;var l=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){var u=this.wot.wtViewport.getWorkspaceWidth();if(this.wot.wtOverlays.hasScrollbarRight){u-=a}u=Math.min(u,r.wtRootElement.scrollWidth);s.width="".concat(u,"px")}else{s.width=""}this.clone.wtTable.holder.style.width=s.width;var f=(0,c.outerHeight)(this.clone.wtTable.TABLE);if(!this.wot.wtTable.hasDefinedSize()){f=0}s.height="".concat(f===0?f:f+4,"px")}},{key:"adjustRootChildrenSize",value:function e(){var t=(0,c.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(t===0){t=30}this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t,"px")}},{key:"applyToDOM",value:function e(){var t=this.wot.getSetting("totalRows");if(!this.areElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px")}else if(t===0){this.spreader.style.top="0"}else{throw new Error("Incorrect value of the rowsRenderCalculator")}this.spreader.style.bottom="";if(this.needFullRender){this.syncOverlayOffset()}}},{key:"syncOverlayOffset",value:function e(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px")}else{this.clone.wtTable.spreader.style.left=""}}},{key:"scrollTo",value:function e(t,r){var n=this.wot;var i=n.cloneSource?n.cloneSource:n;var a=i.wtTable.holder;var o=this.getTableParentOffset();var s=0;if(r&&a.offsetHeight!==a.clientHeight){s=(0,c.getScrollbarWidth)(n.rootDocument)}if(r){var l=n.getSetting("fixedRowsBottom");var u=n.getSetting("totalRows");o+=this.sumCellSizes(0,t+1);o-=n.wtViewport.getViewportHeight()-this.sumCellSizes(u-l,u);o+=1}else{o+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t)}o+=s;return this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function e(){if(this.mainTableScrollableElement===this.wot.rootWindow){return this.wot.wtTable.holderOffset.top}return 0}},{key:"getScrollPosition",value:function e(){return(0,c.getScrollTop)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"redrawSelectionBorders",value:function e(t){if(t&&t.cellRange){var r=t.getBorder(this.wot);var n=t.getCorners();r.disappear();r.appear(n)}}},{key:"redrawAllSelectionsBorders",value:function e(){var t=this;var r=this.wot.selections;this.redrawSelectionBorders(r.getCell());(0,f.arrayEach)(r.getAreas(),function(e){t.redrawSelectionBorders(e)});this.redrawSelectionBorders(r.getFill());this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function e(t){var r=this.wot.wtTable.holder.parentNode;var n=this.wot.getSetting("totalColumns");if(n){(0,c.removeClass)(r,"emptyColumns")}else{(0,c.addClass)(r,"emptyColumns")}if(this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0){var i=(0,c.hasClass)(r,"innerBorderTop");if(t||this.wot.getSetting("totalRows")===0){(0,c.addClass)(r,"innerBorderTop")}else{(0,c.removeClass)(r,"innerBorderTop")}if(!i&&t||i&&!t){this.wot.wtOverlays.adjustElementsSize();this.redrawAllSelectionsBorders()}}if(this.wot.getSetting("rowHeaders").length===0){var a=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(a){for(var o=0;o<a.length;o++){a[o].style["border-left-width"]=0}}}}}]);return r}(h.default);h.default.registerOverlay(h.default.CLONE_TOP,v);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(7));var l=n(r(95));var u=n(r(371));var f=n(r(178));var c=r(3);var d=function(e){(0,s.default)(t,e);function t(){(0,i.default)(this,t);return(0,a.default)(this,(0,o.default)(t).apply(this,arguments))}return t}(l.default);(0,c.mixin)(d,u.default);(0,c.mixin)(d,f.default);var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(122));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var d=r(8);var f=n(r(455));var c=n(r(92));var h=function(e){(0,u.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.clone=t.makeClone(c.default.CLONE_TOP_LEFT_CORNER);return t}(0,o.default)(r,[{key:"createTable",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(0,i.default)(f.default,r)}},{key:"shouldBeRendered",value:function e(){var t=this.wot;return!!((t.getSetting("fixedRowsTop")||t.getSetting("columnHeaders").length)&&(t.getSetting("fixedColumnsLeft")||t.getSetting("rowHeaders").length))}},{key:"resetFixedPosition",value:function e(){this.updateTrimmingContainer();if(!this.wot.wtTable.holder.parentNode){return}var t=this.clone.wtTable.holder.parentNode;var r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var n=this.wot.wtTable.hider.getBoundingClientRect();var i=Math.ceil(n.top);var a=Math.ceil(n.left);var o=Math.ceil(n.bottom);var s=Math.ceil(n.right);var l="0";var u="0";if(!r||r==="vertical"){if(a<0&&s-t.offsetWidth>0){l="".concat(-a,"px")}}if(!r||r==="horizontal"){if(i<0&&o-t.offsetHeight>0){u="".concat(-i,"px")}}(0,d.setOverlayPosition)(t,l,u)}else{(0,d.resetCssTransform)(t)}var f=(0,d.outerHeight)(this.clone.wtTable.TABLE);var c=(0,d.outerWidth)(this.clone.wtTable.TABLE);if(!this.wot.wtTable.hasDefinedSize()){f=0}t.style.height="".concat(f===0?f:f+4,"px");t.style.width="".concat(c===0?c:c+4,"px")}}]);return r}(c.default);c.default.registerOverlay(c.default.CLONE_TOP_LEFT_CORNER,h);var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(7));var l=n(r(95));var u=n(r(371));var f=n(r(179));var c=r(3);var d=function(e){(0,s.default)(t,e);function t(){(0,i.default)(this,t);return(0,a.default)(this,(0,o.default)(t).apply(this,arguments))}return t}(l.default);(0,c.mixin)(d,u.default);(0,c.mixin)(d,f.default);var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(122));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var d=r(8);var f=n(r(457));var c=n(r(92));var h=function(e){(0,u.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.clone=t.makeClone(c.default.CLONE_BOTTOM);return t}(0,o.default)(r,[{key:"createTable",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(0,i.default)(f.default,r)}},{key:"repositionOverlay",value:function e(){var t=this.wot,r=t.wtTable,n=t.rootDocument;var i=this.clone.wtTable.holder.parentNode;var a=(0,d.getScrollbarWidth)(n);if(r.holder.clientHeight===r.holder.offsetHeight){a=0}i.style.top="";i.style.bottom="".concat(a,"px")}},{key:"shouldBeRendered",value:function e(){return this.wot.getSetting("fixedRowsBottom")?true:false}},{key:"resetFixedPosition",value:function e(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var t=this.clone.wtTable.holder.parentNode;var r=0;t.style.top="";var n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!n||n!=="vertical")){var i=this.wot,a=i.rootDocument,o=i.wtTable;var s=o.hider.getBoundingClientRect();var l=Math.ceil(s.bottom);var u;var f;var c=a.body.offsetHeight;u=o.hider.style.left;u=u===""?0:u;if(l>c){f=l-c}else{f=0}r=f;f+="px";t.style.top="";t.style.left=u;t.style.bottom=f}else{r=this.getScrollPosition();(0,d.resetCssTransform)(t);this.repositionOverlay()}this.adjustHeaderBordersPosition(r);this.adjustElementsSize()}},{key:"setScrollPosition",value:function e(t){var r=this.wot.rootWindow;var n=false;if(this.mainTableScrollableElement===r){r.scrollTo((0,d.getWindowScrollLeft)(r),t);n=true}else if(this.mainTableScrollableElement.scrollTop!==t){this.mainTableScrollableElement.scrollTop=t;n=true}return n}},{key:"onScroll",value:function e(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function e(t,r){var n=this.wot,i=n.wtTable,a=n.wtSettings;var o=a.settings.defaultRowHeight;var s=t;var l=0;while(s<r){var u=i.getRowHeight(s);l+=u===void 0?o:u;s+=1}return l}},{key:"adjustElementsSize",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||t){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!t){this.areElementSizesAdjusted=true}}}},{key:"adjustRootElementSize",value:function e(){var t=this.wot,r=t.wtTable,n=t.wtViewport,i=t.rootWindow;var a=(0,d.getScrollbarWidth)(this.wot.rootDocument);var o=this.clone.wtTable.holder.parentNode;var s=o.style;var l=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){var u=n.getWorkspaceWidth();if(this.wot.wtOverlays.hasScrollbarRight){u-=a}u=Math.min(u,r.wtRootElement.scrollWidth);s.width="".concat(u,"px")}else{s.width=""}this.clone.wtTable.holder.style.width=s.width;var f=(0,d.outerHeight)(this.clone.wtTable.TABLE);if(!this.wot.wtTable.hasDefinedSize()){f=0}s.height="".concat(f===0?f:f,"px")}},{key:"adjustRootChildrenSize",value:function e(){var t=(0,d.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(t===0){t=30}this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t,"px")}},{key:"applyToDOM",value:function e(){var t=this.wot.getSetting("totalRows");if(!this.areElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px")}else if(t===0){this.spreader.style.top="0"}else{throw new Error("Incorrect value of the rowsRenderCalculator")}this.spreader.style.bottom="";if(this.needFullRender){this.syncOverlayOffset()}}},{key:"syncOverlayOffset",value:function e(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px")}else{this.clone.wtTable.spreader.style.left=""}}},{key:"scrollTo",value:function e(t,r){var n=this.getTableParentOffset();var i=this.wot.cloneSource?this.wot.cloneSource:this.wot;var a=i.wtTable.holder;var o=0;if(r&&a.offsetHeight!==a.clientHeight){o=(0,d.getScrollbarWidth)(this.wot.rootDocument)}if(r){n+=this.sumCellSizes(0,t+1);n-=this.wot.wtViewport.getViewportHeight();n+=1}else{n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),t)}n+=o;this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function e(){if(this.mainTableScrollableElement===this.wot.rootWindow){return this.wot.wtTable.holderOffset.top}return 0}},{key:"getScrollPosition",value:function e(){return(0,d.getScrollTop)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function e(t){if(this.wot.getSetting("fixedRowsBottom")===0&&this.wot.getSetting("columnHeaders").length>0){var r=this.wot.wtTable.holder.parentNode;var n=(0,d.hasClass)(r,"innerBorderTop");if(t){(0,d.addClass)(r,"innerBorderTop")}else{(0,d.removeClass)(r,"innerBorderTop")}if(!n&&t||n&&!t){this.wot.wtOverlays.adjustElementsSize()}}if(this.wot.getSetting("rowHeaders").length===0){var i=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");if(i){i.style["border-left-width"]=0}}}}]);return r}(c.default);c.default.registerOverlay(c.default.CLONE_BOTTOM,h);var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(7));var l=n(r(95));var u=n(r(372));var f=n(r(178));var c=r(3);var d=function(e){(0,s.default)(t,e);function t(){(0,i.default)(this,t);return(0,a.default)(this,(0,o.default)(t).apply(this,arguments))}return t}(l.default);(0,c.mixin)(d,u.default);(0,c.mixin)(d,f.default);var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(122));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var c=r(8);var f=n(r(459));var d=n(r(92));var h=function(e){(0,u.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.clone=t.makeClone(d.default.CLONE_BOTTOM_LEFT_CORNER);return t}(0,o.default)(r,[{key:"createTable",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(0,i.default)(f.default,r)}},{key:"shouldBeRendered",value:function e(){var t=this.wot;return t.getSetting("fixedRowsBottom")&&(t.getSetting("fixedColumnsLeft")||t.getSetting("rowHeaders").length)?true:false}},{key:"repositionOverlay",value:function e(){var t=this.wot,r=t.wtTable,n=t.rootDocument;var i=this.clone.wtTable.holder.parentNode;var a=(0,c.getScrollbarWidth)(n);if(r.holder.clientHeight===r.holder.offsetHeight){a=0}i.style.top="";i.style.bottom="".concat(a,"px")}},{key:"resetFixedPosition",value:function e(){var t=this.wot;this.updateTrimmingContainer();if(!t.wtTable.holder.parentNode){return}var r=this.clone.wtTable.holder.parentNode;r.style.top="";if(this.trimmingContainer===t.rootWindow){var n=t.wtTable.hider.getBoundingClientRect();var i=Math.ceil(n.bottom);var a=Math.ceil(n.left);var o;var s;var l=t.rootDocument.body.offsetHeight;if(a<0){o=-a}else{o=0}if(i>l){s=i-l}else{s=0}s+="px";o+="px";r.style.top="";r.style.left=o;r.style.bottom=s}else{(0,c.resetCssTransform)(r);this.repositionOverlay()}var u=(0,c.outerHeight)(this.clone.wtTable.TABLE);var f=(0,c.outerWidth)(this.clone.wtTable.TABLE);if(!this.wot.wtTable.hasDefinedSize()){u=0}r.style.height="".concat(u===0?u:u,"px");r.style.width="".concat(f===0?f:f,"px")}}]);return r}(d.default);d.default.registerOverlay(d.default.CLONE_BOTTOM_LEFT_CORNER,h);var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(7));var l=n(r(95));var u=n(r(372));var f=n(r(179));var c=r(3);var d=function(e){(0,s.default)(t,e);function t(){(0,i.default)(this,t);return(0,a.default)(this,(0,o.default)(t).apply(this,arguments))}return t}(l.default);(0,c.mixin)(d,u.default);(0,c.mixin)(d,f.default);var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);r(19);r(96);r(31);r(374);r(39);r(97);t.__esModule=true;t.default=void 0;var C=n(r(18));var l=n(r(42));var i=n(r(1));var a=n(r(2));var S=r(8);var o=n(r(373));var u=n(r(118));var s=n(r(225));var f=function(){function r(e,t){(0,i.default)(this,r);this.settings=e;this.cellRange=t||null;this.instanceBorders={};this.classNames=[this.settings.className];this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}(0,a.default)(r,[{key:"getBorder",value:function e(t){if(!this.instanceBorders[t.guid]){this.instanceBorders[t.guid]=new o.default(t,this.settings)}return this.instanceBorders[t.guid]}},{key:"isEmpty",value:function e(){return this.cellRange===null}},{key:"add",value:function e(t){if(this.isEmpty()){this.cellRange=new s.default(t)}else{this.cellRange.expand(t)}return this}},{key:"replace",value:function e(t,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t)){this.cellRange.from=r;return true}if(this.cellRange.to.isEqual(t)){this.cellRange.to=r;return true}}return false}},{key:"clear",value:function e(){this.cellRange=null;return this}},{key:"getCorners",value:function e(){var t=this.cellRange.getTopLeftCorner();var r=this.cellRange.getBottomRightCorner();return[t.row,t.col,r.row,r.col]}},{key:"addClassAtCoords",value:function e(t,r,n,i){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var o=t.wtTable.getCell(new u.default(r,n));if((0,l.default)(o)==="object"){var s=i;if(a){s=this.classNameGenerator(o);if(!this.classNames.includes(s)){this.classNames.push(s)}}(0,S.addClass)(o,s)}return this}},{key:"linearClassNameGenerator",value:function e(s,l){return function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;if(l===0||r===0){return s}var n=r>=0?r:l;var i=s;n-=1;var a=n===0?s:"".concat(s,"-").concat(n);if((0,S.hasClass)(t,a)){var o=n+1;i="".concat(s,"-").concat(o)}else{i=e(t,n)}return i}}},{key:"draw",value:function e(t){if(this.isEmpty()){if(this.settings.border){this.getBorder(t).disappear()}return}var r=t.wtTable.getRenderedRowsCount();var n=t.wtTable.getRenderedColumnsCount();var i=this.getCorners();var a=(0,C.default)(i,4),o=a[0],s=a[1],l=a[2],u=a[3];for(var f=0;f<n;f+=1){var c=t.wtTable.columnFilter.renderedToSource(f);if(c>=s&&c<=u){var d=t.wtTable.getColumnHeader(c);if(d){var h=[];if(this.settings.highlightHeaderClassName){h.push(this.settings.highlightHeaderClassName)}if(this.settings.highlightColumnClassName){h.push(this.settings.highlightColumnClassName)}(0,S.addClass)(d,h)}}}for(var v=0;v<r;v+=1){var p=t.wtTable.rowFilter.renderedToSource(v);if(p>=o&&p<=l){var g=t.wtTable.getRowHeader(p);if(g){var m=[];if(this.settings.highlightHeaderClassName){m.push(this.settings.highlightHeaderClassName)}if(this.settings.highlightRowClassName){m.push(this.settings.highlightRowClassName)}(0,S.addClass)(g,m)}}for(var y=0;y<n;y+=1){var b=t.wtTable.columnFilter.renderedToSource(y);if(p>=o&&p<=l&&b>=s&&b<=u){if(this.settings.className){this.addClassAtCoords(t,p,b,this.settings.className,this.settings.markIntersections)}}else if(p>=o&&p<=l){if(this.settings.highlightRowClassName){this.addClassAtCoords(t,p,b,this.settings.highlightRowClassName)}}else if(b>=s&&b<=u){if(this.settings.highlightColumnClassName){this.addClassAtCoords(t,p,b,this.settings.highlightColumnClassName)}}var w=t.getSetting("onAfterDrawSelection",p,b,i,this.settings.layerLevel);if(typeof w==="string"){this.addClassAtCoords(t,p,b,w)}}}t.getSetting("onBeforeDrawBorders",i,this.settings.className);if(this.settings.border){this.getBorder(t).appear(i)}}},{key:"destroy",value:function e(){Object.values(this.instanceBorders).forEach(function(e){return e.destroy()})}}]);return r}();var c=f;t.default=c},function(e,t,r){var l=r(44);var u=r(111);var f=r(63);var c=r(130).f;var n=function(s){return function(e){var t=f(e);var r=u(t);var n=r.length;var i=0;var a=[];var o;while(n>i){o=r[i++];if(!l||c.call(t,o)){a.push(s?[o,t[o]]:t[o])}}return a}};e.exports={entries:n(true),values:n(false)}},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(4);var i=r(3);var a="hooksRefRegisterer";var o={_hooksStorage:Object.create(null),addHook:function e(t,r){if(!this._hooksStorage[t]){this._hooksStorage[t]=[]}this.hot.addHook(t,r);this._hooksStorage[t].push(r);return this},removeHooksByKey:function e(t){var r=this;(0,n.arrayEach)(this._hooksStorage[t]||[],function(e){r.hot.removeHook(t,e)})},clearHooks:function e(){var r=this;(0,i.objectEach)(this._hooksStorage,function(e,t){return r.removeHooksByKey(t)});this._hooksStorage={}}};(0,i.defineGetter)(o,"MIXIN_NAME",a,{writable:false,enumerable:false});var s=o;t.default=s},function(e,t,r){var n=r(5);function i(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=n(e);if(e===null)break}return e}e.exports=i},function(e,t,r){"use strict";r(34);function n(){var o={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},s,i=document.body,l=document.createTextNode(""),u=document.createElement("SPAN"),a=function e(t,r,n){t.addEventListener(r,n,false)},t=function e(t,r,n){t.removeEventListener(r,n,false)},f=function e(t){var r,n;if(!t){t=""}else if(!/^[a-zA-Z \.,\\\/\|0-9]$/.test(t)){t="."}if(l.textContent!==void 0){l.textContent=s.value+t}else{l.data=s.value+t}u.style.fontSize=v(s).fontSize;u.style.fontFamily=v(s).fontFamily;u.style.whiteSpace="pre";i.appendChild(u);r=u.clientWidth+2;i.removeChild(u);s.style.height=o.minHeight+"px";if(o.minWidth>r){s.style.width=o.minWidth+"px"}else if(r>o.maxWidth){s.style.width=o.maxWidth+"px"}else{s.style.width=r+"px"}n=s.scrollHeight?s.scrollHeight-1:0;if(o.minHeight>n){s.style.height=o.minHeight+"px"}else if(o.maxHeight<n){s.style.height=o.maxHeight+"px";s.style.overflowY="visible"}else{s.style.height=n+"px"}},c=function e(){window.setTimeout(f,0)},d=function e(t){if(t&&t.minHeight){if(t.minHeight=="inherit"){o.minHeight=s.clientHeight}else{var r=parseInt(t.minHeight);if(!isNaN(r)){o.minHeight=r}}}if(t&&t.maxHeight){if(t.maxHeight=="inherit"){o.maxHeight=s.clientHeight}else{var n=parseInt(t.maxHeight);if(!isNaN(n)){o.maxHeight=n}}}if(t&&t.minWidth){if(t.minWidth=="inherit"){o.minWidth=s.clientWidth}else{var i=parseInt(t.minWidth);if(!isNaN(i)){o.minWidth=i}}}if(t&&t.maxWidth){if(t.maxWidth=="inherit"){o.maxWidth=s.clientWidth}else{var a=parseInt(t.maxWidth);if(!isNaN(a)){o.maxWidth=a}}}if(!u.firstChild){u.className="autoResize";u.style.display="inline-block";u.appendChild(l)}},h=function e(t,r,n){s=t;d(r);if(s.nodeName=="TEXTAREA"){s.style.resize="none";s.style.overflowY="";s.style.height=o.minHeight+"px";s.style.minWidth=o.minWidth+"px";s.style.maxWidth=o.maxWidth+"px";s.style.overflowY="hidden"}if(n){a(s,"change",f);a(s,"cut",c);a(s,"paste",c);a(s,"drop",c);a(s,"keydown",c);a(s,"focus",f);a(s,"compositionstart",c);a(s,"compositionupdate",c);a(s,"compositionend",c)}f()};function v(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function e(t,r,n){h(t,r,n)},unObserve:function e(){t(s,"change",f);t(s,"cut",c);t(s,"paste",c);t(s,"drop",c);t(s,"keydown",c);t(s,"focus",f);t(s,"compositionstart",c);t(s,"compositionupdate",c);t(s,"compositionend",c)},resize:f}}if(true){e.exports=n}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=n(r(117));var f=r(8);var c=function(e){(0,l.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"beginEditing",value:function e(t,r){if(r&&r.type==="mouseup"){var n=this.TD.querySelector('input[type="checkbox"]');if(!(0,f.hasClass)(n,"htBadValue")){n.click()}}}},{key:"finishEditing",value:function e(){}},{key:"init",value:function e(){}},{key:"open",value:function e(){}},{key:"close",value:function e(){}},{key:"getValue",value:function e(){}},{key:"setValue",value:function e(){}},{key:"focus",value:function e(){}}]);return t}(u.default);var d=c;t.default=d},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(64));var d=n(r(467));r(468);var h=r(8);var v=r(3);var p=n(r(25));var g=r(55);var m=r(32);var s=n(r(123));var y=function(e){(0,f.default)(s,e);function s(e){var t;(0,i.default)(this,s);t=(0,o.default)(this,(0,l.default)(s).call(this,e));t.defaultDateFormat="DD/MM/YYYY";t.isCellEdited=false;t.parentDestroyed=false;return t}(0,a.default)(s,[{key:"init",value:function e(){var t=this;if(typeof c.default!=="function"){throw new Error("You need to include moment.js to your project.")}if(typeof d.default!=="function"){throw new Error("You need to include Pikaday to your project.")}(0,u.default)((0,l.default)(s.prototype),"init",this).call(this);this.instance.addHook("afterDestroy",function(){t.parentDestroyed=true;t.destroyElements()})}},{key:"createElements",value:function e(){(0,u.default)((0,l.default)(s.prototype),"createElements",this).call(this);this.datePicker=this.hot.rootDocument.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;(0,h.addClass)(this.datePicker,"htDatepickerHolder");this.hot.rootDocument.body.appendChild(this.datePicker);this.$datePicker=new d.default(this.getDatePickerConfig());var t=new p.default(this);t.addEventListener(this.datePicker,"mousedown",function(e){return(0,m.stopPropagation)(e)});this.hideDatepicker()}},{key:"destroyElements",value:function e(){var t=this.datePicker.parentNode;this.$datePicker.destroy();if(t){t.removeChild(this.datePicker)}}},{key:"prepare",value:function e(t,r,n,i,a,o){(0,u.default)((0,l.default)(s.prototype),"prepare",this).call(this,t,r,n,i,a,o)}},{key:"open",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;(0,u.default)((0,l.default)(s.prototype),"open",this).call(this);this.showDatepicker(t)}},{key:"close",value:function e(){var t=this;this._opened=false;this.instance._registerTimeout(function(){t.instance._refreshBorders()});(0,u.default)((0,l.default)(s.prototype),"close",this).call(this)}},{key:"finishEditing",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(t){var n=this.originalValue;if(n!==void 0){this.setValue(n)}}this.hideDatepicker();(0,u.default)((0,l.default)(s.prototype),"finishEditing",this).call(this,t,r)}},{key:"showDatepicker",value:function e(t){this.$datePicker.config(this.getDatePickerConfig());var r=this.TD.getBoundingClientRect();var n=this.cellProperties.dateFormat||this.defaultDateFormat;var i=this.$datePicker.config();var a;var o=this.instance.view.isMouseDown();var s=t?(0,g.isMetaKey)(t.keyCode):false;this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+r.top+(0,h.outerHeight)(this.TD),"px");this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+r.left,"px");this.$datePicker._onInputFocus=function(){};i.format=n;if(this.originalValue){a=this.originalValue;if((0,c.default)(a,n,true).isValid()){this.$datePicker.setMoment((0,c.default)(a,n),true)}if(this.getValue()!==this.originalValue){this.setValue(this.originalValue)}if(!s&&!o){this.setValue("")}}else if(this.cellProperties.defaultDate){a=this.cellProperties.defaultDate;i.defaultDate=a;if((0,c.default)(a,n,true).isValid()){this.$datePicker.setMoment((0,c.default)(a,n),true)}if(!s&&!o){this.setValue("")}}else{this.$datePicker.gotoToday()}this.datePickerStyle.display="block";this.$datePicker.show()}},{key:"hideDatepicker",value:function e(){this.datePickerStyle.display="none";this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function e(){var r=this;var t=this.TEXTAREA;var n={};if(this.cellProperties&&this.cellProperties.datePickerConfig){(0,v.deepExtend)(n,this.cellProperties.datePickerConfig)}var i=n.onSelect;var a=n.onClose;n.field=t;n.trigger=t;n.container=this.datePicker;n.bound=false;n.format=n.format||this.defaultDateFormat;n.reposition=n.reposition||false;n.onSelect=function(e){var t=e;if(!isNaN(t.getTime())){t=(0,c.default)(t).format(r.cellProperties.dateFormat||r.defaultDateFormat)}r.setValue(t);r.hideDatepicker();if(i){i()}};n.onClose=function(){if(!r.parentDestroyed){r.finishEditing(false)}if(a){a()}};return n}}]);return s}(s.default);var b=y;t.default=b},function(n,e,i){(function(e,t){"use strict";var r;if(true){try{r=i(64)}catch(e){}n.exports=t(r)}else{}})(this,function(r){"use strict";var a=typeof r==="function",o=!!window.addEventListener,d=window.document,u=window.setTimeout,s=function(e,t,r,n){if(o){e.addEventListener(t,r,!!n)}else{e.attachEvent("on"+t,r)}},t=function(e,t,r,n){if(o){e.removeEventListener(t,r,!!n)}else{e.detachEvent("on"+t,r)}},n=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},l=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},h=function(e,t){if(!l(e,t)){e.className=e.className===""?t:e.className+" "+t}},v=function(e,t){e.className=n((" "+e.className+" ").replace(" "+t+" "," "))},m=function(e){return/Array/.test(Object.prototype.toString.call(e))},A=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},N=function(e){var t=e.getDay();return t===0||t===6},i=function(e){return e%4===0&&e%100!==0||e%400===0},M=function(e,t){return[31,i(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},L=function(e){if(A(e))e.setHours(0,0,0,0)},P=function(e,t){return e.getTime()===t.getTime()},f=function(e,t,r){var n,i;for(n in t){i=e[n]!==undefined;if(i&&typeof t[n]==="object"&&t[n]!==null&&t[n].nodeName===undefined){if(A(t[n])){if(r){e[n]=new Date(t[n].getTime())}}else if(m(t[n])){if(r){e[n]=t[n].slice(0)}}else{e[n]=f({},t[n],r)}}else if(r||!i){e[n]=t[n]}}return e},c=function(e,t,r){var n;if(d.createEvent){n=d.createEvent("HTMLEvents");n.initEvent(t,true,false);n=f(n,r);e.dispatchEvent(n)}else if(d.createEventObject){n=d.createEventObject();n=f(n,r);e.fireEvent("on"+t,n)}},p=function(e){if(e.month<0){e.year-=Math.ceil(Math.abs(e.month)/12);e.month+=12}if(e.month>11){e.year+=Math.floor(Math.abs(e.month)/12);e.month-=12}return e},g={field:null,bound:undefined,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:true,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:false,firstDay:0,formatStrict:false,minDate:null,maxDate:null,yearRange:10,showWeekNumber:false,pickWholeWeek:false,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:false,yearSuffix:"",showMonthAfterYear:false,showDaysInNextAndPreviousMonths:false,enableSelectionDaysInNextAndPreviousMonths:false,numberOfMonths:1,mainCalendar:"left",container:undefined,blurFieldOnSelect:true,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:true},y=function(e,t,r){t+=e.firstDay;while(t>=7){t-=7}return r?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},F=function(e){var t=[];var r="false";if(e.isEmpty){if(e.showDaysInNextAndPreviousMonths){t.push("is-outside-current-month");if(!e.enableSelectionDaysInNextAndPreviousMonths){t.push("is-selection-disabled")}}else{return'<td class="is-empty"></td>'}}if(e.isDisabled){t.push("is-disabled")}if(e.isToday){t.push("is-today")}if(e.isSelected){t.push("is-selected");r="true"}if(e.hasEvent){t.push("has-event")}if(e.isInRange){t.push("is-inrange")}if(e.isStartRange){t.push("is-startrange")}if(e.isEndRange){t.push("is-endrange")}return'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'">'+'<button class="pika-button pika-day" type="button" '+'data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button>"+"</td>"},B=function(e,t,r){var n=new Date(r,0,1),i=Math.ceil(((new Date(r,t,e)-n)/864e5+n.getDay()+1)/7);return'<td class="pika-week">'+i+"</td>"},H=function(e,t,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},b=function(e){return"<tbody>"+e.join("")+"</tbody>"},w=function(e){var t,r=[];if(e.showWeekNumber){r.push("<th></th>")}for(t=0;t<7;t++){r.push('<th scope="col"><abbr title="'+y(e,t)+'">'+y(e,t,true)+"</abbr></th>")}return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"},C=function(e,t,r,n,i,a){var o,s,l,u=e._o,f=r===u.minYear,c=r===u.maxYear,d='<div id="'+a+'" class="pika-title" role="heading" aria-live="assertive">',h,v,p=true,g=true;for(l=[],o=0;o<12;o++){l.push('<option value="'+(r===i?o-t:12+o-t)+'"'+(o===n?' selected="selected"':"")+(f&&o<u.minMonth||c&&o>u.maxMonth?'disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>")}h='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>";if(m(u.yearRange)){o=u.yearRange[0];s=u.yearRange[1]+1}else{o=r-u.yearRange;s=1+r+u.yearRange}for(l=[];o<s&&o<=u.maxYear;o++){if(o>=u.minYear){l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>")}}v='<div class="pika-label">'+r+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>";if(u.showMonthAfterYear){d+=v+h}else{d+=h+v}if(f&&(n===0||u.minMonth>=n)){p=false}if(c&&(n===11||u.maxMonth<=n)){g=false}if(t===0){d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"}if(t===e._o.numberOfMonths-1){d+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"}return d+="</div>"},$=function(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+w(e)+b(t)+"</table>"},e=function(e){var n=this,i=n.config(e);n._onMouseDown=function(e){if(!n._v){return}e=e||window.event;var t=e.target||e.srcElement;if(!t){return}if(!l(t,"is-disabled")){if(l(t,"pika-button")&&!l(t,"is-empty")&&!l(t.parentNode,"is-disabled")){n.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day")));if(i.bound){u(function(){n.hide();if(i.blurFieldOnSelect&&i.field){i.field.blur()}},100)}}else if(l(t,"pika-prev")){n.prevMonth()}else if(l(t,"pika-next")){n.nextMonth()}}if(!l(t,"pika-select")){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false;return false}}else{n._c=true}};n._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;if(!t){return}if(l(t,"pika-select-month")){n.gotoMonth(t.value)}else if(l(t,"pika-select-year")){n.gotoYear(t.value)}};n._onKeyChange=function(e){e=e||window.event;if(n.isVisible()){switch(e.keyCode){case 13:case 27:if(i.field){i.field.blur()}break;case 37:e.preventDefault();n.adjustDate("subtract",1);break;case 38:n.adjustDate("subtract",7);break;case 39:n.adjustDate("add",1);break;case 40:n.adjustDate("add",7);break}}};n._onInputChange=function(e){var t;if(e.firedBy===n){return}if(i.parse){t=i.parse(i.field.value,i.format)}else if(a){t=r(i.field.value,i.format,i.formatStrict);t=t&&t.isValid()?t.toDate():null}else{t=new Date(Date.parse(i.field.value))}if(A(t)){n.setDate(t)}if(!n._v){n.show()}};n._onInputFocus=function(){n.show()};n._onInputClick=function(){n.show()};n._onInputBlur=function(){var e=d.activeElement;do{if(l(e,"pika-single")){return}}while(e=e.parentNode);if(!n._c){n._b=u(function(){n.hide()},50)}n._c=false};n._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,r=t;if(!t){return}if(!o&&l(t,"pika-select")){if(!t.onchange){t.setAttribute("onchange","return;");s(t,"change",n._onChange)}}do{if(l(r,"pika-single")||r===i.trigger){return}}while(r=r.parentNode);if(n._v&&t!==i.trigger&&r!==i.trigger){n.hide()}};n.el=d.createElement("div");n.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:"");s(n.el,"mousedown",n._onMouseDown,true);s(n.el,"touchend",n._onMouseDown,true);s(n.el,"change",n._onChange);if(i.keyboardInput){s(d,"keydown",n._onKeyChange)}if(i.field){if(i.container){i.container.appendChild(n.el)}else if(i.bound){d.body.appendChild(n.el)}else{i.field.parentNode.insertBefore(n.el,i.field.nextSibling)}s(i.field,"change",n._onInputChange);if(!i.defaultDate){if(a&&i.field.value){i.defaultDate=r(i.field.value,i.format).toDate()}else{i.defaultDate=new Date(Date.parse(i.field.value))}i.setDefaultDate=true}}var t=i.defaultDate;if(A(t)){if(i.setDefaultDate){n.setDate(t,true)}else{n.gotoDate(t)}}else{n.gotoDate(new Date)}if(i.bound){this.hide();n.el.className+=" is-bound";s(i.trigger,"click",n._onInputClick);s(i.trigger,"focus",n._onInputFocus);s(i.trigger,"blur",n._onInputBlur)}else{this.show()}};e.prototype={config:function(e){if(!this._o){this._o=f({},g,true)}var t=f(this._o,e,true);t.isRTL=!!t.isRTL;t.field=t.field&&t.field.nodeName?t.field:null;t.theme=typeof t.theme==="string"&&t.theme?t.theme:null;t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field);t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field;t.disableWeekends=!!t.disableWeekends;t.disableDayFn=typeof t.disableDayFn==="function"?t.disableDayFn:null;var r=parseInt(t.numberOfMonths,10)||1;t.numberOfMonths=r>4?4:r;if(!A(t.minDate)){t.minDate=false}if(!A(t.maxDate)){t.maxDate=false}if(t.minDate&&t.maxDate&&t.maxDate<t.minDate){t.maxDate=t.minDate=false}if(t.minDate){this.setMinDate(t.minDate)}if(t.maxDate){this.setMaxDate(t.maxDate)}if(m(t.yearRange)){var n=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||n;t.yearRange[1]=parseInt(t.yearRange[1],10)||n}else{t.yearRange=Math.abs(parseInt(t.yearRange,10))||g.yearRange;if(t.yearRange>100){t.yearRange=100}}return t},toString:function(e){e=e||this._o.format;if(!A(this._d)){return""}if(this._o.toString){return this._o.toString(this._d,e)}if(a){return r(this._d).format(e)}return this._d.toDateString()},getMoment:function(){return a?r(this._d):null},setMoment:function(e,t){if(a&&r.isMoment(e)){this.setDate(e.toDate(),t)}},getDate:function(){return A(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e){this._d=null;if(this._o.field){this._o.field.value="";c(this._o.field,"change",{firedBy:this})}return this.draw()}if(typeof e==="string"){e=new Date(Date.parse(e))}if(!A(e)){return}var r=this._o.minDate,n=this._o.maxDate;if(A(r)&&e<r){e=r}else if(A(n)&&e>n){e=n}this._d=new Date(e.getTime());L(this._d);this.gotoDate(this._d);if(this._o.field){this._o.field.value=this.toString();c(this._o.field,"change",{firedBy:this})}if(!t&&typeof this._o.onSelect==="function"){this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=true;if(!A(e)){return}if(this.calendars){var r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();n.setMonth(n.getMonth()+1);n.setDate(n.getDate()-1);t=i<r.getTime()||n.getTime()<i}if(t){this.calendars=[{month:e.getMonth(),year:e.getFullYear()}];if(this._o.mainCalendar==="right"){this.calendars[0].month+=1-this._o.numberOfMonths}}this.adjustCalendars()},adjustDate:function(e,t){var r=this.getDate()||new Date;var n=parseInt(t)*24*60*60*1e3;var i;if(e==="add"){i=new Date(r.valueOf()+n)}else if(e==="subtract"){i=new Date(r.valueOf()-n)}this.setDate(i)},adjustCalendars:function(){this.calendars[0]=p(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++){this.calendars[e]=p({month:this.calendars[0].month+e,year:this.calendars[0].year})}this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){if(!isNaN(e)){this.calendars[0].month=parseInt(e,10);this.adjustCalendars()}},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(e){if(!isNaN(e)){this.calendars[0].year=parseInt(e,10);this.adjustCalendars()}},setMinDate:function(e){if(e instanceof Date){L(e);this._o.minDate=e;this._o.minYear=e.getFullYear();this._o.minMonth=e.getMonth()}else{this._o.minDate=g.minDate;this._o.minYear=g.minYear;this._o.minMonth=g.minMonth;this._o.startRange=g.startRange}this.draw()},setMaxDate:function(e){if(e instanceof Date){L(e);this._o.maxDate=e;this._o.maxYear=e.getFullYear();this._o.maxMonth=e.getMonth()}else{this._o.maxDate=g.maxDate;this._o.maxYear=g.maxYear;this._o.maxMonth=g.maxMonth;this._o.endRange=g.endRange}this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e){return}var t=this._o,r=t.minYear,n=t.maxYear,i=t.minMonth,a=t.maxMonth,o="",s;if(this._y<=r){this._y=r;if(!isNaN(i)&&this._m<i){this._m=i}}if(this._y>=n){this._y=n;if(!isNaN(a)&&this._m>a){this._m=a}}s="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var l=0;l<t.numberOfMonths;l++){o+='<div class="pika-lendar">'+C(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,s)+this.render(this.calendars[l].year,this.calendars[l].month,s)+"</div>"}this.el.innerHTML=o;if(t.bound){if(t.field.type!=="hidden"){u(function(){t.trigger.focus()},1)}}if(typeof this._o.onDraw==="function"){this._o.onDraw(this)}if(t.bound){t.field.setAttribute("aria-label",t.ariaLabel)}},adjustPosition:function(){var e,t,r,n,i,a,o,s,l,u,f,c;if(this._o.container)return;this.el.style.position="absolute";e=this._o.trigger;t=e;r=this.el.offsetWidth;n=this.el.offsetHeight;i=window.innerWidth||d.documentElement.clientWidth;a=window.innerHeight||d.documentElement.clientHeight;o=window.pageYOffset||d.body.scrollTop||d.documentElement.scrollTop;f=true;c=true;if(typeof e.getBoundingClientRect==="function"){u=e.getBoundingClientRect();s=u.left+window.pageXOffset;l=u.bottom+window.pageYOffset}else{s=t.offsetLeft;l=t.offsetTop+t.offsetHeight;while(t=t.offsetParent){s+=t.offsetLeft;l+=t.offsetTop}}if(this._o.reposition&&s+r>i||this._o.position.indexOf("right")>-1&&s-r+e.offsetWidth>0){s=s-r+e.offsetWidth;f=false}if(this._o.reposition&&l+n>a+o||this._o.position.indexOf("top")>-1&&l-n-e.offsetHeight>0){l=l-n-e.offsetHeight;c=false}this.el.style.left=s+"px";this.el.style.top=l+"px";h(this.el,f?"left-aligned":"right-aligned");h(this.el,c?"bottom-aligned":"top-aligned");v(this.el,!f?"left-aligned":"right-aligned");v(this.el,!c?"bottom-aligned":"top-aligned")},render:function(e,t,r){var n=this._o,i=new Date,a=M(e,t),o=new Date(e,t,1).getDay(),s=[],l=[];L(i);if(n.firstDay>0){o-=n.firstDay;if(o<0){o+=7}}var u=t===0?11:t-1,f=t===11?0:t+1,c=t===0?e-1:e,d=t===11?e+1:e,h=M(c,u);var v=a+o,p=v;while(p>7){p-=7}v+=7-p;var g=false;for(var m=0,y=0;m<v;m++){var b=new Date(e,t,1+(m-o)),w=A(this._d)?P(b,this._d):false,C=P(b,i),S=n.events.indexOf(b.toDateString())!==-1?true:false,E=m<o||m>=a+o,k=1+(m-o),T=t,_=e,x=n.startRange&&P(n.startRange,b),D=n.endRange&&P(n.endRange,b),R=n.startRange&&n.endRange&&n.startRange<b&&b<n.endRange,I=n.minDate&&b<n.minDate||n.maxDate&&b>n.maxDate||n.disableWeekends&&N(b)||n.disableDayFn&&n.disableDayFn(b);if(E){if(m<o){k=h+k;T=u;_=c}else{k=k-a;T=f;_=d}}var O={day:k,month:T,year:_,hasEvent:S,isSelected:w,isToday:C,isDisabled:I,isEmpty:E,isStartRange:x,isEndRange:D,isInRange:R,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};if(n.pickWholeWeek&&w){g=true}l.push(F(O));if(++y===7){if(n.showWeekNumber){l.unshift(B(m-o,t,e))}s.push(H(l,n.isRTL,n.pickWholeWeek,g));l=[];y=0;g=false}}return $(n,s,r)},isVisible:function(){return this._v},show:function(){if(!this.isVisible()){this._v=true;this.draw();v(this.el,"is-hidden");if(this._o.bound){s(d,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function"){this._o.onOpen.call(this)}}},hide:function(){var e=this._v;if(e!==false){if(this._o.bound){t(d,"click",this._onClick)}this.el.style.position="static";this.el.style.left="auto";this.el.style.top="auto";h(this.el,"is-hidden");this._v=false;if(e!==undefined&&typeof this._o.onClose==="function"){this._o.onClose.call(this)}}},destroy:function(){var e=this._o;this.hide();t(this.el,"mousedown",this._onMouseDown,true);t(this.el,"touchend",this._onMouseDown,true);t(this.el,"change",this._onChange);if(e.keyboardInput){t(d,"keydown",this._onKeyChange)}if(e.field){t(e.field,"change",this._onInputChange);if(e.bound){t(e.trigger,"click",this._onInputClick);t(e.trigger,"focus",this._onInputFocus);t(e.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode){this.el.parentNode.removeChild(this.el)}}};return e})},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(50);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var l=n(r(5));var u=n(r(14));var f=n(r(7));var s=n(r(375));var c=n(r(46));var d=function(e){(0,f.default)(s,e);function s(){(0,i.default)(this,s);return(0,o.default)(this,(0,l.default)(s).apply(this,arguments))}(0,a.default)(s,[{key:"prepare",value:function e(t,r,n,i,a,o){(0,u.default)((0,l.default)(s.prototype),"prepare",this).call(this,t,r,n,i,a,o);this.cellProperties.filter=false;this.cellProperties.strict=true}}]);return s}(s.default);c.default.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));if(n.editor===d){if(n.strict===void 0){n.filter=false;n.strict=true}}});var h=d;t.default=h},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(7));var l=n(r(123));var u=function(e){(0,s.default)(t,e);function t(){(0,i.default)(this,t);return(0,a.default)(this,(0,o.default)(t).apply(this,arguments))}return t}(l.default);var f=u;t.default=f},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=r(8);var c=n(r(123));var d=function(e){(0,u.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"createElements",value:function e(){(0,l.default)((0,s.default)(t.prototype),"createElements",this).call(this);this.TEXTAREA=this.hot.rootDocument.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;(0,f.empty)(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]);return t}(c.default);var h=d;t.default=h},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=void 0;var a=i(r(42));var o=i(r(1));var s=i(r(2));var l=i(r(6));var c=i(r(5));var d=i(r(14));var u=i(r(7));var h=r(8);var v=r(32);var p=r(55);var g=n(r(117));var m=r(3);var y="ht_editor_visible";var f=function(e){(0,u.default)(f,e);function f(){(0,o.default)(this,f);return(0,l.default)(this,(0,c.default)(f).apply(this,arguments))}(0,s.default)(f,[{key:"init",value:function e(){this.select=this.hot.rootDocument.createElement("SELECT");(0,h.addClass)(this.select,"htSelectEditor");this.select.style.display="none";this.hot.rootElement.appendChild(this.select);this.registerHooks()}},{key:"getValue",value:function e(){return this.select.value}},{key:"setValue",value:function e(t){this.select.value=t}},{key:"open",value:function e(){var t=this;this._opened=true;this.refreshDimensions();this.select.style.display="";this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown()})}},{key:"close",value:function e(){this._opened=false;this.select.style.display="none";if((0,h.hasClass)(this.select,y)){(0,h.removeClass)(this.select,y)}this.clearHooks()}},{key:"focus",value:function e(){this.select.focus()}},{key:"registerHooks",value:function e(){var t=this;this.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()});this.addHook("afterScrollVertically",function(){return t.refreshDimensions()});this.addHook("afterColumnResize",function(){return t.refreshDimensions()});this.addHook("afterRowResize",function(){return t.refreshDimensions()})}},{key:"prepare",value:function e(t,r,n,i,a,o){var s=this;(0,d.default)((0,c.default)(f.prototype),"prepare",this).call(this,t,r,n,i,a,o);var l=this.cellProperties.selectOptions;var u;if(typeof l==="function"){u=this.prepareOptions(l(this.row,this.col,this.prop))}else{u=this.prepareOptions(l)}(0,h.empty)(this.select);(0,m.objectEach)(u,function(e,t){var r=s.hot.rootDocument.createElement("OPTION");r.value=t;(0,h.fastInnerHTML)(r,e);s.select.appendChild(r)})}},{key:"prepareOptions",value:function e(t){var r={};if(Array.isArray(t)){for(var n=0,i=t.length;n<i;n++){r[t[n]]=t[n]}}else if((0,a.default)(t)==="object"){r=t}return r}},{key:"refreshValue",value:function e(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t;this.setValue(t);this.refreshDimensions()}},{key:"refreshDimensions",value:function e(){if(this.state!==g.EditorState.EDITING){return}this.TD=this.getEditedCell();if(!this.TD){this.close();return}var t=this.hot.view.wt.wtOverlays;var r=(0,h.offset)(this.TD);var n=(0,h.offset)(this.hot.rootElement);var i=t.scrollableElement;var a=this.checkEditorSection();var o=(0,h.outerWidth)(this.TD)+1;var s=(0,h.outerHeight)(this.TD)+1;var l=r.top-n.top-1-(i.scrollTop||0);var u=r.left-n.left-1-(i.scrollLeft||0);var f;switch(a){case"top":f=(0,h.getCssTransform)(t.topOverlay.clone.wtTable.holder.parentNode);break;case"left":f=(0,h.getCssTransform)(t.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":f=(0,h.getCssTransform)(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":f=(0,h.getCssTransform)(t.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":f=(0,h.getCssTransform)(t.bottomOverlay.clone.wtTable.holder.parentNode);break;default:break}if(this.hot.getSelectedLast()[0]===0){l+=1}if(this.hot.getSelectedLast()[1]===0){u+=1}var c=this.select.style;if(f&&f!==-1){c[f[0]]=f[1]}else{(0,h.resetCssTransform)(this.select)}var d=(0,h.getComputedStyle)(this.TD,this.hot.rootWindow);if(parseInt(d.borderTopWidth,10)>0){s-=1}if(parseInt(d.borderLeftWidth,10)>0){o-=1}c.height="".concat(s,"px");c.minWidth="".concat(o,"px");c.top="".concat(l,"px");c.left="".concat(u,"px");c.margin="0px";(0,h.addClass)(this.select,y)}},{key:"onBeforeKeyDown",value:function e(){var t=this.select.selectedIndex-1;var r=this.select.selectedIndex+1;switch(event.keyCode){case p.KEY_CODES.ARROW_UP:if(t>=0){this.select[t].selected=true}(0,v.stopImmediatePropagation)(event);event.preventDefault();break;case p.KEY_CODES.ARROW_DOWN:if(r<=this.select.length-1){this.select[r].selected=true}(0,v.stopImmediatePropagation)(event);event.preventDefault();break;default:break}}}]);return f}(g.default);var b=f;t.default=b},function(e,t,r){"use strict";r(19);t.__esModule=true;t.default=void 0;var u=r(8);function n(e,t,r,n,i,a,o){var s=[];var l=[];if(o.className){if(t.className){t.className="".concat(t.className," ").concat(o.className)}else{t.className=o.className}}if(o.readOnly){s.push(o.readOnlyCellClassName)}if(o.valid===false&&o.invalidCellClassName){s.push(o.invalidCellClassName)}else{l.push(o.invalidCellClassName)}if(o.wordWrap===false&&o.noWordWrapClassName){s.push(o.noWordWrapClassName)}if(!a&&o.placeholder){s.push(o.placeholderCellClassName)}(0,u.removeClass)(t,l);(0,u.addClass)(t,s)}var i=n;t.default=i},function(e,t,r){"use strict";var n=r(0);r(19);t.__esModule=true;t.default=void 0;var v=r(8);var p=n(r(25));var g=r(27);var m=r(43);function i(t,r,n,i,e,a,o){var s=t.rootDocument;var l=o.allowHtml?"html":"text";var u=s.createElement("DIV");u.className="htAutocompleteArrow";u.appendChild(s.createTextNode(String.fromCharCode(9660)));for(var f=arguments.length,c=new Array(f>7?f-7:0),d=7;d<f;d++){c[d-7]=arguments[d]}(0,m.getRenderer)(l).apply(this,[t,r,n,i,e,a,o].concat(c));if(!r.firstChild){r.appendChild(s.createTextNode(String.fromCharCode(160)))}r.insertBefore(u,r.firstChild);(0,v.addClass)(r,"htAutocomplete");if(!t.acArrowListener){var h=new p.default(t);t.acArrowListener=function(e){if((0,v.hasClass)(e.target,"htAutocompleteArrow")){t.view.wt.getSetting("onCellDblClick",null,new g.CellCoords(n,i),r)}};h.addEventListener(t.rootElement,"mousedown",t.acArrowListener);t.addHookOnce("afterDestroy",function(){h.destroy()})}}var a=i;t.default=a},function(e,t,r){"use strict";var n=r(0);r(19);r(31);r(15);r(10);r(38);r(39);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var w=r(8);var C=r(74);var i=n(r(25));var S=r(55);var E=r(77);var k=r(32);var T=r(43);var _=new WeakMap;var a=new WeakMap;var x="htBadValue";function o(h,e,t,r,n,i,a){var o=h.rootDocument;for(var s=arguments.length,l=new Array(s>7?s-7:0),u=7;u<s;u++){l[u-7]=arguments[u]}(0,T.getRenderer)("base").apply(this,[h,e,t,r,n,i,a].concat(l));D(h);var f=R(o);var c=a.label;var d=false;if(typeof a.checkedTemplate==="undefined"){a.checkedTemplate=true}if(typeof a.uncheckedTemplate==="undefined"){a.uncheckedTemplate=false}(0,w.empty)(e);if(i===a.checkedTemplate||(0,C.equalsIgnoreCase)(i,a.checkedTemplate)){f.checked=true}else if(i===a.uncheckedTemplate||(0,C.equalsIgnoreCase)(i,a.uncheckedTemplate)){f.checked=false}else if(i===null){(0,w.addClass)(f,"noValue")}else{f.style.display="none";(0,w.addClass)(f,x);d=true}f.setAttribute("data-row",t);f.setAttribute("data-col",r);if(!d&&c){var v="";if(c.value){v=typeof c.value==="function"?c.value.call(this,t,r,n,i):c.value}else if(c.property){var p=h.getDataAtRowProp(t,c.property);v=p!==null?p:""}var g=I(o,v);if(c.position==="before"){g.appendChild(f)}else{g.insertBefore(f,g.firstChild)}f=g}e.appendChild(f);if(d){e.appendChild(o.createTextNode("#bad-value#"))}if(!_.has(h)){_.set(h,true);h.addHook("beforeKeyDown",m)}function m(e){var t="SPACE|ENTER";var r="DELETE|BACKSPACE";var n=(0,E.partial)(S.isKey,e.keyCode);if(!h.getSettings().enterBeginsEditing&&n("ENTER")){return}if(n("".concat(t,"|").concat(r))&&!(0,k.isImmediatePropagationStopped)(e)){b(function(){(0,k.stopImmediatePropagation)(e);e.preventDefault()})}if(n(t)){y()}if(n(r)){y(true)}}function y(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var t=h.getSelectedRangeLast();if(!t){return}var r=t.getTopLeftCorner(),n=r.row,i=r.col;var a=t.getBottomRightCorner(),o=a.row,s=a.col;var l=[];for(var u=n;u<=o;u+=1){for(var f=i;f<=s;f+=1){var c=h.getCellMeta(u,f);if(c.type!=="checkbox"){return}if(c.readOnly===true){continue}if(typeof c.checkedTemplate==="undefined"){c.checkedTemplate=true}if(typeof c.uncheckedTemplate==="undefined"){c.uncheckedTemplate=false}var d=h.getDataAtCell(u,f);if(e===false){if([c.checkedTemplate,c.checkedTemplate.toString()].includes(d)){l.push([u,f,c.uncheckedTemplate])}else if([c.uncheckedTemplate,c.uncheckedTemplate.toString(),null,void 0].includes(d)){l.push([u,f,c.checkedTemplate])}}else{l.push([u,f,c.uncheckedTemplate])}}}if(l.length>0){h.setDataAtCell(l)}}function b(e){var t=h.getSelectedRangeLast();if(!t){return}var r=t.getTopLeftCorner();var n=t.getBottomRightCorner();for(var i=r.row;i<=n.row;i++){for(var a=r.col;a<=n.col;a++){var o=h.getCellMeta(i,a);if(o.type!=="checkbox"){return}var s=h.getCell(i,a);if(s===null||s===void 0){e(i,a,o)}else{var l=s.querySelectorAll("input[type=checkbox]");if(l.length>0&&!o.readOnly){e(l)}}}}}}function D(t){var e=a.get(t);if(!e){var r=t.rootElement;e=new i.default(t);e.addEventListener(r,"click",function(e){return l(e,t)});e.addEventListener(r,"mouseup",function(e){return s(e,t)});e.addEventListener(r,"change",function(e){return u(e,t)});a.set(t,e)}return e}function R(e){var t=e.createElement("input");t.className="htCheckboxRendererInput";t.type="checkbox";t.setAttribute("autocomplete","off");t.setAttribute("tabindex","-1");return t.cloneNode(false)}function I(e,t){var r=e.createElement("label");r.className="htCheckboxRendererLabel";r.appendChild(e.createTextNode(t));return r.cloneNode(true)}function s(e,t){if(!f(e.target)){return}setTimeout(t.listen,10)}function l(e,t){if(!f(e.target)){return false}var r=parseInt(e.target.getAttribute("data-row"),10);var n=parseInt(e.target.getAttribute("data-col"),10);var i=t.getCellMeta(r,n);if(i.readOnly){e.preventDefault()}}function u(e,t){if(!f(e.target)){return false}var r=parseInt(e.target.getAttribute("data-row"),10);var n=parseInt(e.target.getAttribute("data-col"),10);var i=t.getCellMeta(r,n);if(!i.readOnly){var a=null;if(e.target.checked){a=i.uncheckedTemplate===void 0?true:i.checkedTemplate}else{a=i.uncheckedTemplate===void 0?false:i.uncheckedTemplate}t.setDataAtCell(r,n,a)}}function f(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var c=o;t.default=c},function(e,t,r){"use strict";r(19);t.__esModule=true;t.default=void 0;var u=r(8);var f=r(43);function n(e,t,r,n,i,a){for(var o=arguments.length,s=new Array(o>6?o-6:0),l=6;l<o;l++){s[l-6]=arguments[l]}(0,f.getRenderer)("base").apply(this,[e,t,r,n,i,a].concat(s));(0,u.fastInnerHTML)(t,a===null||a===void 0?"":a)}var i=n;t.default=i},function(e,t,r){"use strict";var n=r(0);r(12);r(54);r(23);r(40);r(52);t.__esModule=true;t.default=void 0;var p=n(r(377));var g=r(43);var m=r(17);function i(e,t,r,n,i,a,o){var s=a;if((0,m.isNumeric)(s)){var l=o.numericFormat;var u=l&&l.culture||"-";var f=l&&l.pattern;var c=o.className||"";var d=c.length?c.split(" "):[];if(typeof u!=="undefined"&&!p.default.languages()[u]){var h=u.replace("-","");var v=p.default.allLanguages?p.default.allLanguages[u]:p.default[h];if(v){p.default.registerLanguage(v)}}p.default.setLanguage(u);s=(0,p.default)(s).format(f||"0");if(d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0){d.push("htRight")}if(d.indexOf("htNumeric")<0){d.push("htNumeric")}o.className=d.join(" ")}(0,g.getRenderer)("text")(e,t,r,n,i,s,o)}var a=i;t.default=a},function(e,t,r){"use strict";r(19);t.__esModule=true;t.default=void 0;var h=r(8);var v=r(43);var p=r(17);function n(e,t,r,n,i,a,o){for(var s=arguments.length,l=new Array(s>7?s-7:0),u=7;u<s;u++){l[u-7]=arguments[u]}(0,v.getRenderer)("text").apply(this,[e,t,r,n,i,a,o].concat(l));var f=o.hashLength||t.innerHTML.length;var c=o.hashSymbol||"*";var d="";(0,p.rangeEach)(f-1,function(){d+=c});(0,h.fastInnerHTML)(t,d)}var i=n;t.default=i},function(e,t,r){"use strict";r(19);r(23);r(40);t.__esModule=true;t.default=void 0;var d=r(8);var h=r(29);var v=r(43);function n(e,t,r,n,i,a,o){for(var s=arguments.length,l=new Array(s>7?s-7:0),u=7;u<s;u++){l[u-7]=arguments[u]}(0,v.getRenderer)("base").apply(this,[e,t,r,n,i,a,o].concat(l));var f=a;if(!f&&o.placeholder){f=o.placeholder}f=(0,h.stringify)(f);if(!e.getSettings().trimWhitespace){f=f.replace(/ /g,String.fromCharCode(160))}if(o.rendererTemplate){(0,d.empty)(t);var c=e.rootDocument.createElement("TEMPLATE");c.setAttribute("bind","{{}}");c.innerHTML=o.rendererTemplate;HTMLTemplateElement.decorate(c);c.model=e.getSourceDataAtRow(r);t.appendChild(c)}else{(0,d.fastInnerText)(t,f)}}var i=n;t.default=i},function(e,t,r){"use strict";t.__esModule=true;t.default=n;function n(e,t){var r=e;if(r===null||r===void 0){r=""}if(this.allowEmpty&&r===""){t(true);return}if(this.strict&&this.source){if(typeof this.source==="function"){this.source(r,i(r,t))}else{i(r,t)(this.source)}}else{t(true)}}function i(e,i){var a=e;return function(e){var t=false;for(var r=0,n=e.length;r<n;r++){if(a===e[r]){t=true;break}}i(t)}}},function(e,t,r){"use strict";var n=r(0);r(23);r(378);t.__esModule=true;t.default=i;t.correctFormat=d;var f=n(r(64));var o=r(379);var c=r(57);function i(e,t){var r=(0,c.getEditorInstance)("date",this.instance);var n=e;var i=true;if(n===null||n===void 0){n=""}var a=(0,f.default)(n,this.dateFormat||r.defaultDateFormat,true).isValid();var o=(0,f.default)(new Date(n)).isValid()||a;if(this.allowEmpty&&n===""){o=true;a=true}if(!o){i=false}if(!o&&a){i=true}if(o&&!a){if(this.correctFormat===true){var s=d(n,this.dateFormat);var l=this.instance.runHooks("unmodifyRow",this.row);var u=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(l,u,s,"dateValidator");i=true}else{i=false}}t(i)}function d(e,t){var r=(0,f.default)((0,o.getNormalizedDate)(e));var n=(0,f.default)(e,t);var i=e.search(/[A-z]/g)>-1;var a;if(r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i){a=r}else{a=n}return a.format(t)}},function(e,t){e.exports=Object.is||function e(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r}},function(e,t,r){"use strict";t.__esModule=true;t.default=i;var n=r(17);function i(e,t){var r=e;if(r===null||r===void 0){r=""}if(this.allowEmpty&&r===""){t(true)}else if(r===""){t(false)}else{t((0,n.isNumeric)(e))}}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=i;var d=n(r(64));var h=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function i(e,t){var r=this.timeFormat||"h:mm:ss a";var n=true;var i=e;if(i===null){i=""}i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var a=/^\d{1,2}$/.test(i);if(a){i+=":00"}var o=(0,d.default)(i,h,true).isValid()?(0,d.default)(i):(0,d.default)(i,r);var s=o.isValid();var l=(0,d.default)(i,r,true).isValid()&&!a;if(this.allowEmpty&&i===""){s=true;l=true}if(!s){n=false}if(!s&&l){n=true}if(s&&!l){if(this.correctFormat===true){var u=o.format(r);var f=this.instance.runHooks("unmodifyRow",this.row);var c=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(f,c,u,"timeValidator");n=true}else{n=false}}t(n)}},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a=r(85);var o="autocomplete";var s={editor:(0,n.getEditor)(o),renderer:(0,i.getRenderer)(o),validator:(0,a.getValidator)(o)};t.default=s},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a="checkbox";var o={editor:(0,n.getEditor)(a),renderer:(0,i.getRenderer)(a)};t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a=r(85);var o="date";var s={editor:(0,n.getEditor)(o),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,a.getValidator)(o)};t.default=s},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a=r(85);var o="dropdown";var s={editor:(0,n.getEditor)(o),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,a.getValidator)("autocomplete")};t.default=s},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a="handsontable";var o={editor:(0,n.getEditor)(a),renderer:(0,i.getRenderer)("autocomplete")};t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a=r(85);var o="numeric";var s={editor:(0,n.getEditor)(o),renderer:(0,i.getRenderer)(o),validator:(0,a.getValidator)(o),dataType:"number"};t.default=s},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a="password";var o={editor:(0,n.getEditor)(a),renderer:(0,i.getRenderer)(a),copyable:false};t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a="text";var o={editor:(0,n.getEditor)(a),renderer:(0,i.getRenderer)(a)};t.default=o},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(57);var i=r(43);var a=r(85);var o="time";var s={editor:(0,n.getEditor)("text"),renderer:(0,i.getRenderer)("text"),validator:(0,a.getValidator)(o)};t.default=s},function(e,t,r){var n=r(45);var i=Math.floor;e.exports=function e(t){return!n(t)&&isFinite(t)&&i(t)===t}},function(e,t,r){var n=r(20);var i=r(35);var a=r(496);var o=!i.setImmediate||!i.clearImmediate;n({global:true,bind:true,enumerable:true,forced:o},{setImmediate:a.set,clearImmediate:a.clear})},function(e,t,r){var n=r(35);var i=r(26);var a=r(80);var o=r(113);var s=r(204);var l=r(155);var u=r(497);var f=n.location;var c=n.setImmediate;var d=n.clearImmediate;var h=n.process;var v=n.MessageChannel;var p=n.Dispatch;var g=0;var m={};var y="onreadystatechange";var b,w,C;var S=function(e){if(m.hasOwnProperty(e)){var t=m[e];delete m[e];t()}};var E=function(e){return function(){S(e)}};var k=function(e){S(e.data)};var T=function(e){n.postMessage(e+"",f.protocol+"//"+f.host)};if(!c||!d){c=function e(t){var r=[];var n=1;while(arguments.length>n)r.push(arguments[n++]);m[++g]=function(){(typeof t=="function"?t:Function(t)).apply(undefined,r)};b(g);return g};d=function e(t){delete m[t]};if(a(h)=="process"){b=function(e){h.nextTick(E(e))}}else if(p&&p.now){b=function(e){p.now(E(e))}}else if(v&&!u){w=new v;C=w.port2;w.port1.onmessage=k;b=o(C.postMessage,C,1)}else if(n.addEventListener&&typeof postMessage=="function"&&!n.importScripts&&!i(T)){b=T;n.addEventListener("message",k,false)}else if(y in l("script")){b=function(e){s.appendChild(l("script"))[y]=function(){s.removeChild(this);S(e)}}}else{b=function(e){setTimeout(E(e),0)}}}e.exports={set:c,clear:d}},function(e,t,r){var n=r(139);e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(n)},function(e,t,r){"use strict";var n=r(0);r(50);r(12);r(15);r(41);r(78);r(33);r(69);r(10);r(23);r(13);r(52);r(16);r(34);t.__esModule=true;t.default=void 0;var l=n(r(42));var i=n(r(1));var a=n(r(2));var o=n(r(380));var s=r(147);var p=r(182);var g=r(3);var c=r(4);var u=n(r(499));var d=r(17);var f=(0,s.cellMethodLookupFactory)("copyable",false);var h=function(){(0,a.default)(v,null,[{key:"DESTINATION_RENDERER",get:function e(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function e(){return 2}}]);function v(e,t,r){var n=this;(0,i.default)(this,v);this.instance=e;this.priv=t;this.GridSettings=r;this.dataSource=this.instance.getSettings().data;this.cachedLength=null;this.skipCache=false;this.latestSourceRowsCount=0;this.duckSchema=this.dataSource&&this.dataSource[0]?(0,g.duckSchema)(this.dataSource[0]):{};this.colToPropCache=void 0;this.propToColCache=void 0;this.createMap();this.interval=u.default.create(function(){return n.clearLengthCache()},"15fps");this.instance.addHook("skipLengthCache",function(e){return n.onSkipLengthCache(e)});this.onSkipLengthCache(500)}(0,a.default)(v,[{key:"createMap",value:function e(){var t=this.getSchema();var r;if(typeof t==="undefined"){throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`")}this.colToPropCache=[];this.propToColCache=new Map;var n=this.instance.getSettings().columns;if(n){var i=this.instance.getSettings().maxCols;var a=Math.min(i,n.length);var o=0;var s=false;var l=(0,g.deepObjectSize)(t);if(typeof n==="function"){a=l>0?l:this.instance.countSourceCols();s=true}for(r=0;r<a;r++){var u=s?n(r):n[r];if((0,g.isObject)(u)){if(typeof u.data!=="undefined"){var f=s?o:r;this.colToPropCache[f]=u.data;this.propToColCache.set(u.data,f)}o+=1}}}else{this.recursiveDuckColumns(t)}}},{key:"recursiveDuckColumns",value:function e(t,r,n){var i=this;var a=r;var o=n;var s;if(typeof a==="undefined"){a=0;o=""}if((0,l.default)(t)==="object"&&!Array.isArray(t)){(0,g.objectEach)(t,function(e,t){if(e===null){s=o+t;i.colToPropCache.push(s);i.propToColCache.set(s,a);a+=1}else{a=i.recursiveDuckColumns(e,a,"".concat(t,"."))}})}return a}},{key:"colToProp",value:function e(t){var r=this.instance.toPhysicalColumn(t);if(!isNaN(r)&&this.colToPropCache&&typeof this.colToPropCache[r]!=="undefined"){return this.colToPropCache[r]}return r}},{key:"propToCol",value:function e(t){var r;if(typeof this.propToColCache.get(t)==="undefined"){r=t}else{r=this.propToColCache.get(t)}r=this.instance.toVisualColumn(r);return r}},{key:"getSchema",value:function e(){var t=this.instance.getSettings().dataSchema;if(t){if(typeof t==="function"){return t()}return t}return this.duckSchema}},{key:"createRow",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var i=arguments.length>2?arguments[2]:undefined;var a=0;var o=t;if(typeof o!=="number"||o>=this.instance.countSourceRows()){o=this.instance.countSourceRows()}var s=this.instance.runHooks("beforeCreateRow",o,n,i);if(s===false){return 0}var l=this.instance.getSettings().maxRows;var u=this.instance.countCols();var f=function e(){var t=null;if(r.instance.dataType==="array"){if(r.instance.getSettings().dataSchema){t=(0,g.deepClone)(r.getSchema())}else{t=[];(0,d.rangeEach)(u-1,function(){return t.push(null)})}}else if(r.instance.dataType==="function"){t=r.instance.getSettings().dataSchema(o)}else{t={};(0,g.deepExtend)(t,r.getSchema())}if(o===r.instance.countSourceRows()){r.dataSource.push(t)}else{r.spliceData(o,0,t)}a+=1};while(a<n&&this.instance.countSourceRows()<l){f()}this.instance.runHooks("afterCreateRow",o,a,i);this.instance.forceFullRender=true;return a}},{key:"createCol",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=arguments.length>2?arguments[2]:undefined;if(!this.instance.isColumnModificationAllowed()){throw new Error("Cannot create new column. When data source in an object, "+"you can only have as much columns as defined in first data row, data schema or in the 'columns' setting."+"If you want to be able to add new columns, you have to use array datasource.")}var i=this.instance.countSourceRows();var a=this.dataSource;var o=this.instance.countCols();var s=typeof t!=="number"||t>=o?o:t;var l=0;var u;var f=this.instance.runHooks("beforeCreateCol",s,r,n);if(f===false){return 0}u=s;var c=this.instance.getSettings().maxCols;while(l<r&&this.instance.countCols()<c){var d=(0,p.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof s!=="number"||s>=this.instance.countCols()){if(i>0){for(var h=0;h<i;h++){if(typeof a[h]==="undefined"){a[h]=[]}a[h].push(null)}}else{a.push([null])}this.priv.columnSettings.push(d)}else{for(var v=0;v<i;v++){a[v].splice(u,0,null)}this.priv.columnSettings.splice(u,0,d)}l+=1;u+=1}this.instance.runHooks("afterCreateCol",s,l,n);this.instance.forceFullRender=true;return l}},{key:"removeRow",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=arguments.length>2?arguments[2]:undefined;var i=typeof t!=="number"?-r:t;var a=this.instance.runHooks("modifyRemovedAmount",r,i);var o=this.instance.countSourceRows();i=(o+i)%o;var s=this.visualRowsToPhysical(i,a);var l=this.instance.runHooks("beforeRemoveRow",i,a,s,n);if(l===false){return}var u=this.dataSource;var f=this.filterData(i,a);if(f){u.length=0;Array.prototype.push.apply(u,f)}this.instance.runHooks("afterRemoveRow",i,a,s,n);this.instance.forceFullRender=true}},{key:"removeCol",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=arguments.length>2?arguments[2]:undefined;if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}var i=typeof t!=="number"?-r:t;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,r);var o=a.slice(0).sort(function(e,t){return t-e});var s=this.instance.runHooks("beforeRemoveCol",i,r,a,n);if(s===false){return}var l=true;var u=o.length;var f=this.dataSource;for(var c=0;c<u;c++){if(l&&a[0]!==a[c]-c){l=false}}if(l){for(var d=0,h=this.instance.countSourceRows();d<h;d++){f[d].splice(a[0],r)}}else{for(var v=0,p=this.instance.countSourceRows();v<p;v++){for(var g=0;g<u;g++){f[v].splice(o[g],1)}}for(var m=0;m<u;m++){this.priv.columnSettings.splice(a[m],1)}}this.instance.runHooks("afterRemoveCol",i,r,a,n);this.instance.forceFullRender=true}},{key:"spliceCol",value:function e(t,r,n){var i=this.instance.getDataAtCol(t);var a=i.slice(r,r+n);var o=i.slice(r+n);for(var s=arguments.length,l=new Array(s>3?s-3:0),u=3;u<s;u++){l[u-3]=arguments[u]}(0,c.extendArray)(l,o);var f=0;while(f<n){l.push(null);f+=1}(0,c.to2dArray)(l);this.instance.populateFromArray(r,t,l,null,null,"spliceCol");return a}},{key:"spliceRow",value:function e(t,r,n){var i=this.instance.getSourceDataAtRow(t);var a=i.slice(r,r+n);var o=i.slice(r+n);for(var s=arguments.length,l=new Array(s>3?s-3:0),u=3;u<s;u++){l[u-3]=arguments[u]}(0,c.extendArray)(l,o);var f=0;while(f<n){l.push(null);f+=1}this.instance.populateFromArray(t,r,[l],null,null,"spliceRow");return a}},{key:"spliceData",value:function e(t,r,n){var i=this.instance.runHooks("beforeDataSplice",t,r,n);if(i!==false){this.dataSource.splice(t,r,n)}}},{key:"filterData",value:function e(t,r){var n=this.visualRowsToPhysical(t,r);var i=this.instance.runHooks("beforeDataFilter",t,r,n);if(i!==false){var a=this.dataSource.filter(function(e,t){return n.indexOf(t)===-1});return a}}},{key:"get",value:function e(t,r){var n=this.instance.toPhysicalRow(t);var i=this.dataSource[n];var a=this.instance.runHooks("modifyRowData",n);i=isNaN(a)?a:i;var o=null;if(i&&i.hasOwnProperty&&(0,g.hasOwnProperty)(i,r)){o=i[r]}else if(typeof r==="string"&&r.indexOf(".")>-1){var s=r.split(".");var l=i;if(!l){return null}for(var u=0,f=s.length;u<f;u++){l=l[s[u]];if(typeof l==="undefined"){return null}}o=l}else if(typeof r==="function"){o=r(this.dataSource.slice(n,n+1)[0])}if(this.instance.hasHook("modifyData")){var c=(0,g.createObjectPropListener)(o);this.instance.runHooks("modifyData",n,this.propToCol(r),c,"get");if(c.isTouched()){o=c.value}}return o}},{key:"getCopyable",value:function e(t,r){if(f.call(this.instance,t,this.propToCol(r))){return this.get(t,r)}return""}},{key:"set",value:function e(t,r,n,i){var a=this.instance.runHooks("modifyRow",t,i||"datamapGet");var o=n;var s=this.dataSource[a];var l=this.instance.runHooks("modifyRowData",a);s=isNaN(l)?l:s;if(this.instance.hasHook("modifyData")){var u=(0,g.createObjectPropListener)(o);this.instance.runHooks("modifyData",a,this.propToCol(r),u,"set");if(u.isTouched()){o=u.value}}if(s&&s.hasOwnProperty&&(0,g.hasOwnProperty)(s,r)){s[r]=o}else if(typeof r==="string"&&r.indexOf(".")>-1){var f=r.split(".");var c=s;var d=0;var h;for(d=0,h=f.length-1;d<h;d++){if(typeof c[f[d]]==="undefined"){c[f[d]]={}}c=c[f[d]]}c[f[d]]=o}else if(typeof r==="function"){r(this.dataSource.slice(a,a+1)[0],o)}else{s[r]=o}}},{key:"visualRowsToPhysical",value:function e(t,r){var n=this.instance.countSourceRows();var i=[];var a=(n+t)%n;var o=r;var s;while(a<n&&o){s=this.instance.toPhysicalRow(a);i.push(s);o-=1;a+=1}return i}},{key:"visualColumnsToPhysical",value:function e(t,r){var n=this.instance.countCols();var i=[];var a=(n+t)%n;var o=r;while(a<n&&o){var s=this.instance.toPhysicalColumn(a);i.push(s);o-=1;a+=1}return i}},{key:"clear",value:function e(){for(var t=0;t<this.instance.countSourceRows();t++){for(var r=0;r<this.instance.countCols();r++){this.set(t,this.colToProp(r),"")}}}},{key:"clearLengthCache",value:function e(){this.cachedLength=null}},{key:"getLength",value:function e(){var r=this;var t=this.instance.getSettings().maxRows;var n;if(t<0||t===0){n=0}else{n=t||Infinity}var i=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var a=this.skipCache;this.interval.start();if(i!==this.latestSourceRowsCount){a=true}this.latestSourceRowsCount=i;if(this.cachedLength===null||a){(0,d.rangeEach)(i-1,function(e){var t=r.instance.toPhysicalRow(e);if(t===null){i-=1}});this.cachedLength=i}else{i=this.cachedLength}}else{this.interval.stop()}return Math.min(i,n)}},{key:"getAll",value:function e(){var t={row:0,col:0};var r={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};if(t.row-r.row===0&&!this.instance.countSourceRows()){return[]}return this.getRange(t,r,v.DESTINATION_RENDERER)}},{key:"getRange",value:function e(t,r,n){var i=[];var a;var o;var s;var l=this.instance.getSettings().maxRows;var u=this.instance.getSettings().maxCols;if(l===0||u===0){return[]}var f=n===v.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;var c=Math.min(Math.max(l-1,0),Math.max(t.row,r.row));var d=Math.min(Math.max(u-1,0),Math.max(t.col,r.col));for(a=Math.min(t.row,r.row);a<=c;a++){s=[];var h=this.instance.toPhysicalRow(a);for(o=Math.min(t.col,r.col);o<=d;o++){if(h===null){break}s.push(f.call(this,a,this.colToProp(o)))}if(h!==null){i.push(s)}}return i}},{key:"getText",value:function e(t,r){return o.default.stringify(this.getRange(t,r,v.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function e(t,r){return o.default.stringify(this.getRange(t,r,v.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"onSkipLengthCache",value:function e(t){var r=this;this.skipCache=true;setTimeout(function(){r.skipCache=false},t)}},{key:"destroy",value:function e(){this.interval.stop();this.interval=null;this.instance=null;this.priv=null;this.GridSettings=null;this.dataSource=null;this.cachedLength=null;this.duckSchema=null;this.colToPropCache.length=0;this.propToColCache.clear();this.propToColCache=void 0}}]);return v}();var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);r(23);r(40);t.__esModule=true;t.parseDelay=u;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(76);var s=function(){(0,a.default)(n,null,[{key:"create",value:function e(t,r){return new n(t,r)}}]);function n(e,t){var r=this;(0,i.default)(this,n);this.timer=null;this.func=e;this.delay=u(t);this.stopped=true;this._then=null;this._callback=function(){return r.__callback()}}(0,a.default)(n,[{key:"start",value:function e(){if(this.stopped){this._then=Date.now();this.stopped=false;this.timer=(0,o.requestAnimationFrame)(this._callback)}return this}},{key:"stop",value:function e(){if(!this.stopped){this.stopped=true;(0,o.cancelAnimationFrame)(this.timer);this.timer=null}return this}},{key:"__callback",value:function e(){this.timer=(0,o.requestAnimationFrame)(this._callback);if(this.delay){var t=Date.now();var r=t-this._then;if(r>this.delay){this._then=t-r%this.delay;this.func()}}else{this.func()}}}]);return n}();var l=s;t.default=l;function u(e){var t=e;if(typeof t==="string"&&/fps$/.test(t)){t=1e3/parseInt(t.replace("fps","")||0,10)}return t}},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var o=n(r(1));var i=n(r(2));var s=r(27);var l=r(55);var u=r(32);var f=r(57);var c=n(r(25));var d=r(117);var h=r(8);var a=function(){function a(e,t,r){var n=this;(0,o.default)(this,a);this.instance=e;this.priv=t;this.selection=r;this.eventManager=new c.default(e);this.destroyed=false;this.lock=false;this.activeEditor=void 0;this.cellProperties=void 0;this.instance.addHook("afterDocumentKeyDown",function(e){return n.onAfterDocumentKeyDown(e)});var i=this.instance.rootWindow;while(i){this.eventManager.addEventListener(i.document.documentElement,"keydown",function(e){if(!n.destroyed){n.instance.runHooks("afterDocumentKeyDown",e)}});i=(0,h.getParentWindow)(i)}this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(e){if(!n.destroyed&&n.activeEditor&&!n.activeEditor.isOpened()&&n.instance.isListening()){n.openEditor("",e)}});this.instance.view.wt.update("onCellDblClick",function(e,t,r){return n.onCellDblClick(e,t,r)})}(0,i.default)(a,[{key:"lockEditor",value:function e(){this.lock=true}},{key:"unlockEditor",value:function e(){this.lock=false}},{key:"destroyEditor",value:function e(t){if(!this.lock){this.closeEditor(t)}}},{key:"getActiveEditor",value:function e(){return this.activeEditor}},{key:"prepareEditor",value:function e(){var t=this;if(this.lock){return}if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(false,false,function(e){if(e){t.prepareEditor()}});return}var r=this.instance.selection.selectedRange.current().highlight,n=r.row,i=r.col;this.cellProperties=this.instance.getCellMeta(n,i);if(this.cellProperties.readOnly){this.clearActiveEditor();return}var a=this.instance.getCellEditor(this.cellProperties);var o=this.instance.getCell(n,i,true);if(a&&o){var s=this.instance.colToProp(i);var l=this.instance.getSourceDataAtCell(this.instance.runHooks("modifyRow",n),i);this.activeEditor=(0,f.getEditorInstance)(a,this.instance);this.activeEditor.prepare(n,i,s,o,l,this.cellProperties)}else{this.clearActiveEditor()}}},{key:"isEditorOpened",value:function e(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function e(t,r){if(!this.activeEditor){return}this.activeEditor.beginEditing(t,r)}},{key:"closeEditor",value:function e(t,r,n){if(this.activeEditor){this.activeEditor.finishEditing(t,r,n)}else if(n){n(false)}}},{key:"closeEditorAndSaveChanges",value:function e(t){this.closeEditor(false,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function e(t){return this.closeEditor(true,t)}},{key:"clearActiveEditor",value:function e(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function e(t){var r=typeof this.priv.settings.enterMoves==="function"?this.priv.settings.enterMoves(event):this.priv.settings.enterMoves;if(t){this.selection.transformStart(-r.row,-r.col)}else{this.selection.transformStart(r.row,r.col,true)}}},{key:"moveSelectionUp",value:function e(t){if(t){this.selection.transformEnd(-1,0)}else{this.selection.transformStart(-1,0)}}},{key:"moveSelectionDown",value:function e(t){if(t){this.selection.transformEnd(1,0)}else{this.selection.transformStart(1,0)}}},{key:"moveSelectionRight",value:function e(t){if(t){this.selection.transformEnd(0,1)}else{this.selection.transformStart(0,1)}}},{key:"moveSelectionLeft",value:function e(t){if(t){this.selection.transformEnd(0,-1)}else{this.selection.transformStart(0,-1)}}},{key:"onAfterDocumentKeyDown",value:function e(t){if(!this.instance.isListening()){return}this.instance.runHooks("beforeKeyDown",t);if(this.destroyed||t.keyCode===229){return}if((0,u.isImmediatePropagationStopped)(t)){return}this.priv.lastKeyCode=t.keyCode;if(!this.selection.isSelected()){return}var r=(t.ctrlKey||t.metaKey)&&!t.altKey;if(this.activeEditor&&!this.activeEditor.isWaiting()){if(!(0,l.isMetaKey)(t.keyCode)&&!(0,l.isCtrlMetaKey)(t.keyCode)&&!r&&!this.isEditorOpened()){this.openEditor("",t);return}}var n=t.shiftKey;var i=n?this.selection.setRangeEnd:this.selection.setRangeStart;var a;switch(t.keyCode){case l.KEY_CODES.A:if(!this.isEditorOpened()&&r){this.instance.selectAll();t.preventDefault();(0,u.stopPropagation)(t)}break;case l.KEY_CODES.ARROW_UP:if(this.isEditorOpened()&&!this.activeEditor.isWaiting()){this.closeEditorAndSaveChanges(r)}this.moveSelectionUp(n);t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.ARROW_DOWN:if(this.isEditorOpened()&&!this.activeEditor.isWaiting()){this.closeEditorAndSaveChanges(r)}this.moveSelectionDown(n);t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.ARROW_RIGHT:if(this.isEditorOpened()&&!this.activeEditor.isWaiting()){this.closeEditorAndSaveChanges(r)}this.moveSelectionRight(n);t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.ARROW_LEFT:if(this.isEditorOpened()&&!this.activeEditor.isWaiting()){this.closeEditorAndSaveChanges(r)}this.moveSelectionLeft(n);t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.TAB:a=typeof this.priv.settings.tabMoves==="function"?this.priv.settings.tabMoves(t):this.priv.settings.tabMoves;if(n){this.selection.transformStart(-a.row,-a.col)}else{this.selection.transformStart(a.row,a.col,true)}t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.BACKSPACE:case l.KEY_CODES.DELETE:this.instance.emptySelectedCells();this.prepareEditor();t.preventDefault();break;case l.KEY_CODES.F2:if(this.activeEditor){this.activeEditor.enableFullEditMode()}this.openEditor(null,t);t.preventDefault();break;case l.KEY_CODES.ENTER:if(this.isEditorOpened()){if(this.activeEditor&&this.activeEditor.state!==d.EditorState.WAITING){this.closeEditorAndSaveChanges(r)}this.moveSelectionAfterEnter(n)}else if(this.instance.getSettings().enterBeginsEditing){if(this.cellProperties.readOnly){this.moveSelectionAfterEnter()}else if(this.activeEditor){this.activeEditor.enableFullEditMode();this.openEditor(null,t)}}else{this.moveSelectionAfterEnter(n)}t.preventDefault();(0,u.stopImmediatePropagation)(t);break;case l.KEY_CODES.ESCAPE:if(this.isEditorOpened()){this.closeEditorAndRestoreOriginalValue(r);this.activeEditor.focus()}t.preventDefault();break;case l.KEY_CODES.HOME:if(t.ctrlKey||t.metaKey){i.call(this.selection,new s.CellCoords(0,this.selection.selectedRange.current().from.col))}else{i.call(this.selection,new s.CellCoords(this.selection.selectedRange.current().from.row,0))}t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.END:if(t.ctrlKey||t.metaKey){i.call(this.selection,new s.CellCoords(this.instance.countRows()-1,this.selection.selectedRange.current().from.col))}else{i.call(this.selection,new s.CellCoords(this.selection.selectedRange.current().from.row,this.instance.countCols()-1))}t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0);t.preventDefault();(0,u.stopPropagation)(t);break;case l.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0);t.preventDefault();(0,u.stopPropagation)(t);break;default:break}}},{key:"onCellDblClick",value:function e(t,r,n){if(n.nodeName==="TD"){if(this.activeEditor){this.activeEditor.enableFullEditMode()}this.openEditor(null,t)}}},{key:"destroy",value:function e(){this.destroyed=true;this.eventManager.destroy()}}]);return a}();var v=new WeakMap;a.getInstance=function(e,t,r,n){var i=v.get(e);if(!i){i=new a(e,t,r,n);v.set(e,i)}return i};var p=a;t.default=p},function(e,t,r){"use strict";var n=r(20);var i=r(75).findIndex;var a=r(109);var o=r(59);var s="findIndex";var l=true;var u=o(s);if(s in[])Array(1)[s](function(){l=false});n({target:"Array",proto:true,forced:l||!u},{findIndex:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});a(s)},function(e,t,r){var n=r(20);var i=r(503);n({target:"Array",proto:true,forced:i!==[].lastIndexOf},{lastIndexOf:i})},function(e,t,r){"use strict";var a=r(63);var o=r(82);var s=r(49);var n=r(84);var i=r(59);var l=Math.min;var u=[].lastIndexOf;var f=!!u&&1/[1].lastIndexOf(1,-0)<0;var c=n("lastIndexOf");var d=i("indexOf",{ACCESSORS:true,1:0});var h=f||!c||!d;e.exports=h?function e(t){if(f)return u.apply(this,arguments)||0;var r=a(this);var n=s(r.length);var i=n-1;if(arguments.length>1)i=l(i,o(arguments[1]));if(i<0)i=n+i;for(;i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:u},function(e,t,r){var f=r(138);var c=r(58);var d=r(104);var h=r(49);var n=function(u){return function(e,t,r,n){f(t);var i=c(e);var a=d(i);var o=h(i.length);var s=u?o-1:0;var l=u?-1:1;if(r<2)while(true){if(s in a){n=a[s];s+=l;break}s+=l;if(u?s<0:o<=s){throw TypeError("Reduce of empty array with no initial value")}}for(;u?s>=0:o>s;s+=l)if(s in a){n=t(n,a[s],s,i)}return n}};e.exports={left:n(false),right:n(true)}},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var s=n(r(18));var i=n(r(1));var a=n(r(2));var h=r(8);var o=n(r(25));var v=r(32);var l=n(r(27));var u=r(382);var p=new WeakMap;var f=function(){function t(e){(0,i.default)(this,t);this.instance=e;this.eventManager=new o.default(e);this.settings=e.getSettings();this.THEAD=void 0;this.TBODY=void 0;this.wt=void 0;this.activeWt=void 0;p.set(this,{selectionMouseDown:false,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0});this.createElements();this.registerEvents();this.initializeWalkontable()}(0,a.default)(t,[{key:"render",value:function e(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.renderCall=false}},{key:"getCellAtCoords",value:function e(t,r){var n=this.wt.getCell(t,r);if(n<0){return null}return n}},{key:"scrollViewport",value:function e(t,r,n,i,a){return this.wt.scrollViewport(t,r,n,i,a)}},{key:"scrollViewportHorizontally",value:function e(t,r,n){return this.wt.scrollViewportHorizontally(t,r,n)}},{key:"scrollViewportVertically",value:function e(t,r,n){return this.wt.scrollViewportVertically(t,r,n)}},{key:"createElements",value:function e(){var t=p.get(this);var r=this.instance,n=r.rootElement,i=r.rootDocument;var a=n.getAttribute("style");if(a){n.setAttribute("data-originalstyle",a)}(0,h.addClass)(n,"handsontable");t.table=i.createElement("TABLE");(0,h.addClass)(t.table,"htCore");if(this.instance.getSettings().tableClassName){(0,h.addClass)(t.table,this.instance.getSettings().tableClassName)}this.THEAD=i.createElement("THEAD");t.table.appendChild(this.THEAD);this.TBODY=i.createElement("TBODY");t.table.appendChild(this.TBODY);this.instance.table=t.table;this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function e(){var l=this;var u=p.get(this);var t=this.instance,f=t.rootElement,c=t.rootDocument;var d=c.documentElement;this.eventManager.addEventListener(f,"mousedown",function(e){u.selectionMouseDown=true;if(!l.isTextSelectionAllowed(e.target)){var t=l.instance.rootWindow;(0,h.clearTextSelection)(t);e.preventDefault();t.focus()}});this.eventManager.addEventListener(f,"mouseup",function(){u.selectionMouseDown=false});this.eventManager.addEventListener(f,"mousemove",function(e){if(u.selectionMouseDown&&!l.isTextSelectionAllowed(e.target)){if(l.settings.fragmentSelection){(0,h.clearTextSelection)(l.instance.rootWindow)}e.preventDefault()}});this.eventManager.addEventListener(d,"keyup",function(e){if(l.instance.selection.isInProgress()&&!e.shiftKey){l.instance.selection.finish()}});this.eventManager.addEventListener(d,"mouseup",function(e){if(l.instance.selection.isInProgress()&&(0,v.isLeftClick)(e)){l.instance.selection.finish()}u.mouseDown=false;if((0,h.isOutsideInput)(c.activeElement)||!l.instance.selection.isSelected()&&!(0,v.isRightClick)(e)){l.instance.unlisten()}});this.eventManager.addEventListener(d,"contextmenu",function(e){if(l.instance.selection.isInProgress()&&(0,v.isRightClick)(e)){l.instance.selection.finish();u.mouseDown=false}});this.eventManager.addEventListener(d,"touchend",function(){if(l.instance.selection.isInProgress()){l.instance.selection.finish()}u.mouseDown=false});this.eventManager.addEventListener(d,"mousedown",function(e){var t=e.target;var r=e.x||e.clientX;var n=e.y||e.clientY;var i=e.target;if(u.mouseDown||!f||!l.instance.view){return}var a=l.instance.view.wt.wtTable.holder;if(i===a){var o=(0,h.getScrollbarWidth)(c);if(c.elementFromPoint(r+o,n)!==a||c.elementFromPoint(r,n+o)!==a){return}}else{while(i!==d){if(i===null){if(e.isTargetWebComponent){break}return}if(i===f){return}i=i.parentNode}}var s=typeof l.settings.outsideClickDeselects==="function"?l.settings.outsideClickDeselects(t):l.settings.outsideClickDeselects;if(s){l.instance.deselectCell()}else{l.instance.destroyEditor(false,false)}});this.eventManager.addEventListener(u.table,"selectstart",function(e){if(l.settings.fragmentSelection||(0,h.isInput)(e.target)){return}e.preventDefault()})}},{key:"initializeWalkontable",value:function e(){var s=this;var o=p.get(this);var t={debug:function e(){return s.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:o.table,preventOverflow:function e(){return s.settings.preventOverflow},preventWheel:function e(){return s.settings.preventWheel},stretchH:function e(){return s.settings.stretchH},data:this.instance.getDataAtCell,totalRows:function e(){return s.instance.countRows()},totalColumns:function e(){return s.instance.countCols()},fixedColumnsLeft:function e(){return s.settings.fixedColumnsLeft},fixedRowsTop:function e(){return s.settings.fixedRowsTop},fixedRowsBottom:function e(){return s.settings.fixedRowsBottom},minSpareRows:function e(){return s.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function e(){var t=[];if(s.instance.hasRowHeaders()){t.push(function(e,t){return s.appendRowHeader(e,t)})}s.instance.runHooks("afterGetRowHeaderRenderers",t);return t},columnHeaders:function e(){var t=[];if(s.instance.hasColHeaders()){t.push(function(e,t){s.appendColHeader(e,t)})}s.instance.runHooks("afterGetColumnHeaderRenderers",t);return t},columnWidth:this.instance.getColWidth,rowHeight:this.instance.getRowHeight,cellRenderer:function e(t,r,n){var i=s.instance.getCellMeta(t,r);var a=s.instance.colToProp(r);var o=s.instance.getDataAtRowProp(t,a);if(s.instance.hasHook("beforeValueRender")){o=s.instance.runHooks("beforeValueRender",o,i)}s.instance.runHooks("beforeRenderer",n,t,r,a,o,i);s.instance.getCellRenderer(i)(s.instance,n,t,r,a,o,i);s.instance.runHooks("afterRenderer",n,t,r,a,o,i)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function e(){return s.settings.fragmentSelection},onWindowResize:function e(){if(!s.instance||s.instance.isDestroyed){return}s.instance.refreshDimensions()},onCellMouseDown:function e(t,r,n,i){var a={row:false,column:false,cell:false};s.instance.listen();s.activeWt=i;o.mouseDown=true;s.instance.runHooks("beforeOnCellMouseDown",t,r,n,a);if((0,v.isImmediatePropagationStopped)(t)){return}(0,u.handleMouseEvent)(t,{coords:r,selection:s.instance.selection,controller:a});s.instance.runHooks("afterOnCellMouseDown",t,r,n);s.activeWt=s.wt},onCellContextMenu:function e(t,r,n,i){s.activeWt=i;o.mouseDown=false;if(s.instance.selection.isInProgress()){s.instance.selection.finish()}s.instance.runHooks("beforeOnCellContextMenu",t,r,n);if((0,v.isImmediatePropagationStopped)(t)){return}s.instance.runHooks("afterOnCellContextMenu",t,r,n);s.activeWt=s.wt},onCellMouseOut:function e(t,r,n,i){s.activeWt=i;s.instance.runHooks("beforeOnCellMouseOut",t,r,n);if((0,v.isImmediatePropagationStopped)(t)){return}s.instance.runHooks("afterOnCellMouseOut",t,r,n);s.activeWt=s.wt},onCellMouseOver:function e(t,r,n,i){var a={row:false,column:false,cell:false};s.activeWt=i;s.instance.runHooks("beforeOnCellMouseOver",t,r,n,a);if((0,v.isImmediatePropagationStopped)(t)){return}if(o.mouseDown){(0,u.handleMouseEvent)(t,{coords:r,selection:s.instance.selection,controller:a})}s.instance.runHooks("afterOnCellMouseOver",t,r,n);s.activeWt=s.wt},onCellMouseUp:function e(t,r,n,i){s.activeWt=i;s.instance.runHooks("beforeOnCellMouseUp",t,r,n);if((0,v.isImmediatePropagationStopped)(t)){return}s.instance.runHooks("afterOnCellMouseUp",t,r,n);s.activeWt=s.wt},onCellCornerMouseDown:function e(t){t.preventDefault();s.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function e(t){t.preventDefault();s.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function e(t,r){return s.beforeRender(t,r)},onDraw:function e(t){return s.onDraw(t)},onScrollVertically:function e(){return s.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function e(){return s.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function e(){return s.instance.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function e(t,r,n,i){return s.instance.runHooks("afterDrawSelection",t,r,n,i)},onBeforeDrawBorders:function e(t,r){return s.instance.runHooks("beforeDrawBorders",t,r)},onBeforeTouchScroll:function e(){return s.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function e(){return s.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function e(t,r){return s.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function e(t){return s.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function e(t,r,n){return s.instance.runHooks("modifyGetCellCoords",t,r,n)},viewportRowCalculatorOverride:function e(t){var r=s.settings.viewportRowRenderingOffset;if(r==="auto"&&s.settings.fixedRowsTop){r=10}if(r>0||r==="auto"){var n=s.instance.countRows();if(typeof r==="number"){t.startRow=Math.max(t.startRow-r,0);t.endRow=Math.min(t.endRow+r,n-1)}else if(r==="auto"){var i=t.startRow+t.endRow-t.startRow;var a=Math.ceil(i/n*12);t.startRow=Math.max(t.startRow-a,0);t.endRow=Math.min(t.endRow+a,n-1)}}s.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function e(t){var r=s.settings.viewportColumnRenderingOffset;if(r==="auto"&&s.settings.fixedColumnsLeft){r=10}if(r>0||r==="auto"){var n=s.instance.countCols();if(typeof r==="number"){t.startColumn=Math.max(t.startColumn-r,0);t.endColumn=Math.min(t.endColumn+r,n-1)}if(r==="auto"){var i=t.startColumn+t.endColumn-t.startColumn;var a=Math.ceil(i/n*12);t.startRow=Math.max(t.startColumn-a,0);t.endColumn=Math.min(t.endColumn+a,n-1)}}s.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function e(){return s.settings.rowHeaderWidth},columnHeaderHeight:function e(){var e=s.instance.runHooks("modifyColumnHeaderHeight");return s.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",t);this.wt=new l.default(t);this.activeWt=this.wt;var r=this.wt.wtTable.spreader;var n=this.instance.rootElement.getBoundingClientRect(),i=n.width,a=n.height;this.setLastSize(i,a);this.eventManager.addEventListener(r,"mousedown",function(e){if(e.target===r&&e.which===3){(0,v.stopPropagation)(e)}});this.eventManager.addEventListener(r,"contextmenu",function(e){if(e.target===r&&e.which===3){(0,v.stopPropagation)(e)}});this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){if(s.settings.observeDOMVisibility){if(s.wt.drawInterrupted){s.instance.forceFullRender=true;s.render()}}})}},{key:"isTextSelectionAllowed",value:function e(t){if((0,h.isInput)(t)){return true}var r=(0,h.isChildOf)(t,this.instance.view.wt.wtTable.spreader);if(this.settings.fragmentSelection===true&&r){return true}if(this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r){return true}if(!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell()){return true}return false}},{key:"isMouseDown",value:function e(){return p.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function e(){var t=this.instance.getSelectedLast()||[],r=(0,s.default)(t,4),n=r[0],i=r[1],a=r[2],o=r[3];return n!==void 0&&n===a&&i===o}},{key:"isCellEdited",value:function e(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function e(t,r){if(t){this.instance.runHooks("beforeRender",this.instance.forceFullRender,r)}}},{key:"onDraw",value:function e(t){if(t){this.instance.runHooks("afterRender",this.instance.forceFullRender)}}},{key:"appendRowHeader",value:function e(t,r){if(r.firstChild){var n=r.firstChild;if(!(0,h.hasClass)(n,"relative")){(0,h.empty)(r);this.appendRowHeader(t,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,o=i.getRowHeader;var s=a.createElement("div");var l=a.createElement("span");s.className="relative";l.className="rowHeader";this.updateCellHeader(l,t,o);s.appendChild(l);r.appendChild(s)}this.instance.runHooks("afterGetRowHeader",t,r)}},{key:"appendColHeader",value:function e(t,r){if(r.firstChild){var n=r.firstChild;if((0,h.hasClass)(n,"relative")){this.updateCellHeader(n.querySelector(".colHeader"),t,this.instance.getColHeader)}else{(0,h.empty)(r);this.appendColHeader(t,r)}}else{var i=this.instance.rootDocument;var a=i.createElement("div");var o=i.createElement("span");a.className="relative";o.className="colHeader";this.updateCellHeader(o,t,this.instance.getColHeader);a.appendChild(o);r.appendChild(a)}this.instance.runHooks("afterGetColHeader",t,r)}},{key:"updateCellHeader",value:function e(t,r,n){var i=r;var a=this.wt.wtOverlays.getParentOverlay(t)||this.wt;if(t.parentNode){if((0,h.hasClass)(t,"colHeader")){i=a.wtTable.columnFilter.sourceToRendered(r)}else if((0,h.hasClass)(t,"rowHeader")){i=a.wtTable.rowFilter.sourceToRendered(r)}}if(i>-1){(0,h.fastInnerHTML)(t,n(r))}else{(0,h.fastInnerText)(t,String.fromCharCode(160));(0,h.addClass)(t,"cornerHeader")}}},{key:"maximumVisibleElementWidth",value:function e(t){var r=this.wt.wtViewport.getWorkspaceWidth();var n=r-t;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function e(t){var r=this.wt.wtViewport.getWorkspaceHeight();var n=r-t;return n>0?n:0}},{key:"setLastSize",value:function e(t,r){var n=p.get(this);var i=[t,r];n.lastWidth=i[0];n.lastHeight=i[1]}},{key:"getLastSize",value:function e(){var t=p.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"mainViewIsActive",value:function e(){return this.wt===this.activeWt}},{key:"destroy",value:function e(){this.wt.destroy();this.eventManager.destroy()}}]);return t}();var c=f;t.default=c},function(e,t,r){"use strict";var n=r(0);r(41);r(65);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var s=r(3);var o=r(4);var f=r(17);var l=function(){function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];(0,i.default)(this,r);this.hot=e;this.data=t;this.dataType="array";this.colToProp=function(){};this.propToCol=function(){}}(0,a.default)(r,[{key:"getData",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=this.data;if(t){r=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},true)}return r}},{key:"setData",value:function e(t){this.data=t}},{key:"getAtColumn",value:function e(n){var i=this;var a=[];(0,o.arrayEach)(this.data,function(e){var t=i.colToProp(n);var r;if(typeof t==="string"){r=(0,s.getProperty)(e,t)}else if(typeof t==="function"){r=t(e)}else{r=e[t]}a.push(r)});return a}},{key:"getAtRow",value:function e(t){return this.data[t]}},{key:"getAtCell",value:function e(t,r){var n=null;var i=this.hot.runHooks("modifyRowData",t);var a=isNaN(i)?i:this.data[t];if(a){var o=this.colToProp(r);if(typeof o==="string"){n=(0,s.getProperty)(a,o)}else if(typeof o==="function"){n=o(this.data.slice(t,t+1)[0])}else{n=a[o]}}return n}},{key:"getByRange",value:function e(t,r){var i=this;var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var n=Math.min(t.row,r.row);var o=Math.min(t.col,r.col);var s=Math.max(t.row,r.row);var l=Math.max(t.col,r.col);var u=[];(0,f.rangeEach)(n,s,function(e){var r=i.getAtRow(e);var n;if(i.dataType==="array"){n=r.slice(o,l+1)}else if(i.dataType==="object"){n=a?[]:{};(0,f.rangeEach)(o,l,function(e){var t=i.colToProp(e);if(a){n.push(r[t])}else{n[t]=r[t]}})}u.push(n)});return u}},{key:"countRows",value:function e(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function e(){var t=0;if(Array.isArray(this.data)){if(this.dataType==="array"){t=this.data[0].length}else if(this.dataType==="object"){t=Object.keys(this.data[0]).length}}return t}},{key:"destroy",value:function e(){this.data=null;this.hot=null}}]);return r}();var u=l;t.default=u},function(e,t,r){"use strict";var n=r(0);var i=r(9);t.__esModule=true;t.default=void 0;var a=n(r(70));var o=i(r(11));var s;var l=(s={languageCode:"en-US"},(0,a.default)(s,o.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),(0,a.default)(s,o.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),(0,a.default)(s,o.CONTEXTMENU_ITEMS_UNDO,"Undo"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_REDO,"Redo"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_BORDERS,"Borders"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_COPY,"Copy"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_CUT,"Cut"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),(0,a.default)(s,o.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),(0,a.default)(s,o.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),(0,a.default)(s,o.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),(0,a.default)(s,o.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),(0,a.default)(s,o.FILTERS_CONDITIONS_NONE,"None"),(0,a.default)(s,o.FILTERS_CONDITIONS_EMPTY,"Is empty"),(0,a.default)(s,o.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),(0,a.default)(s,o.FILTERS_CONDITIONS_EQUAL,"Is equal to"),(0,a.default)(s,o.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),(0,a.default)(s,o.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),(0,a.default)(s,o.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),(0,a.default)(s,o.FILTERS_CONDITIONS_CONTAINS,"Contains"),(0,a.default)(s,o.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),(0,a.default)(s,o.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),(0,a.default)(s,o.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),(0,a.default)(s,o.FILTERS_CONDITIONS_LESS_THAN,"Less than"),(0,a.default)(s,o.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),(0,a.default)(s,o.FILTERS_CONDITIONS_BETWEEN,"Is between"),(0,a.default)(s,o.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),(0,a.default)(s,o.FILTERS_CONDITIONS_AFTER,"After"),(0,a.default)(s,o.FILTERS_CONDITIONS_BEFORE,"Before"),(0,a.default)(s,o.FILTERS_CONDITIONS_TODAY,"Today"),(0,a.default)(s,o.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),(0,a.default)(s,o.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),(0,a.default)(s,o.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),(0,a.default)(s,o.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),(0,a.default)(s,o.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),(0,a.default)(s,o.FILTERS_LABELS_CONJUNCTION,"And"),(0,a.default)(s,o.FILTERS_LABELS_DISJUNCTION,"Or"),(0,a.default)(s,o.FILTERS_BUTTONS_SELECT_ALL,"Select all"),(0,a.default)(s,o.FILTERS_BUTTONS_CLEAR,"Clear"),(0,a.default)(s,o.FILTERS_BUTTONS_OK,"OK"),(0,a.default)(s,o.FILTERS_BUTTONS_CANCEL,"Cancel"),(0,a.default)(s,o.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),(0,a.default)(s,o.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),(0,a.default)(s,o.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),s);var u=l;t.default=u},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.registerPhraseFormatter=t.register=u;t.getPhraseFormatters=t.getAll=f;var i=n(r(83));var a=n(r(509));var o=(0,i.default)("phraseFormatters"),s=o.register,l=o.getValues;function u(e,t){s(e,t)}function f(){return l()}u("pluralize",a.default)},function(e,t,r){"use strict";r(86);r(87);t.__esModule=true;t.default=n;function n(e,t){var r=Array.isArray(e)&&Number.isInteger(t);if(r){return e[t]}return e}},function(e,t,r){var n=r(20);var i=r(511);var a=r(109);n({target:"Array",proto:true},{fill:i});a("fill")},function(e,t,r){"use strict";var l=r(58);var u=r(133);var f=r(49);e.exports=function e(t){var r=l(this);var n=f(r.length);var i=arguments.length;var a=u(i>1?arguments[1]:undefined,n);var o=i>2?arguments[2]:undefined;var s=o===undefined?n:u(o,n);while(s>a)r[a++]=t;return r}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.createHighlight=v;var i=n(r(83));var a=n(r(513));var o=n(r(514));var s=n(r(515));var l=n(r(516));var u=n(r(517));var f=n(r(518));var c=(0,i.default)("highlight/types"),d=c.register,h=c.getItem;d("active-header",a.default);d("area",o.default);d("cell",s.default);d("custom-selection",l.default);d("fill",u.default);d("header",f.default);function v(e,t){return h(e)(t)}},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(27);function i(e){var t=e.activeHeaderClassName;var r=new n.Selection({highlightHeaderClassName:t});return r}var a=i;t.default=a},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var i=r(27);function n(e){var t=e.layerLevel,r=e.areaCornerVisible;var n=new i.Selection({className:"area",markIntersections:true,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}});return n}var a=n;t.default=a},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(27);function i(e){var t=e.cellCornerVisible;var r=new n.Selection({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}});return r}var a=i;t.default=a},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var i=r(27);function n(e){var t=e.border,r=e.cellRange;var n=new i.Selection(t,r);return n}var a=n;t.default=a},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var n=r(27);function i(){var e=new n.Selection({className:"fill",border:{width:1,color:"#ff0000"}});return e}var a=i;t.default=a},function(e,t,r){"use strict";t.__esModule=true;t.default=void 0;var a=r(27);function n(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName;var i=new a.Selection({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n});return i}var i=n;t.default=i},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(19);r(60);r(31);r(15);r(99);r(86);r(87);r(10);r(88);r(39);r(13);r(16);t.__esModule=true;t.default=void 0;var c=i(r(18));var a=i(r(72));var o=i(r(1));var s=i(r(2));var u=n(r(390));var l=i(r(520));var d=r(27);var f=r(151);var h=r(3);var v=r(29);var p=r(4);var g=i(r(62));var m=i(r(521));var y=r(152);var b=r(73);function w(){var t=(0,a.default)(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."]);w=function e(){return t};return t}var C=function(){function r(t,e){var n=this;(0,o.default)(this,r);this.settings=t;this.tableProps=e;this.inProgress=false;this.selectedByCorner=false;this.selectedByRowHeader=new Set;this.selectedByColumnHeader=new Set;this.selectedRange=new l.default;this.highlight=new u.default({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function e(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function e(){return n.isAreaCornerVisible.apply(n,arguments)}});this.transformation=new m.default(this.selectedRange,{countRows:function e(){return n.tableProps.countRows()},countCols:function e(){return n.tableProps.countCols()},fixedRowsBottom:function e(){return t.fixedRowsBottom},minSpareRows:function e(){return t.minSpareRows},minSpareCols:function e(){return t.minSpareCols},autoWrapRow:function e(){return t.autoWrapRow},autoWrapCol:function e(){return t.autoWrapCol}});this.transformation.addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(t))});this.transformation.addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(t))});this.transformation.addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(t))});this.transformation.addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(t))});this.transformation.addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return n.runLocalHooks.apply(n,["insertRowRequire"].concat(t))});this.transformation.addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return n.runLocalHooks.apply(n,["insertColRequire"].concat(t))})}(0,s.default)(r,[{key:"getSelectedRange",value:function e(){return this.selectedRange}},{key:"begin",value:function e(){this.inProgress=true}},{key:"finish",value:function e(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange));this.inProgress=false}},{key:"isInProgress",value:function e(){return this.inProgress}},{key:"setRangeStart",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=this.settings.selectionMode==="multiple";var a=(0,v.isUndefined)(r)?(0,f.isPressedCtrlKey)():r;var o=t.row<0;var s=t.col<0;var l=o&&s;if(o){t.row=0}if(s){t.col=0}this.selectedByCorner=l;this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),t);if(!i||i&&!a&&(0,v.isUndefined)(r)){this.selectedRange.clear()}this.selectedRange.add(t);if(this.getLayerLevel()===0){this.selectedByRowHeader.clear();this.selectedByColumnHeader.clear()}if(!l&&s){this.selectedByRowHeader.add(this.getLayerLevel())}if(!l&&o){this.selectedByColumnHeader.add(this.getLayerLevel())}if(!n){this.setRangeEnd(t)}}},{key:"setRangeStartOnly",value:function e(t,r){this.setRangeStart(t,r,true)}},{key:"setRangeEnd",value:function e(t){if(this.selectedRange.isEmpty()){return}this.runLocalHooks("beforeSetRangeEnd",t);this.begin();var r=this.selectedRange.current();if(this.settings.selectionMode!=="single"){r.setTo(new d.CellCoords(t.row,t.col))}this.highlight.getCell().clear();if(this.highlight.isEnabledFor(u.CELL_TYPE)){this.highlight.getCell().add(this.selectedRange.current().highlight)}var n=this.getLayerLevel();if(n<this.highlight.layerLevel){(0,p.arrayEach)(this.highlight.getAreas(),function(e){return void e.clear()});(0,p.arrayEach)(this.highlight.getHeaders(),function(e){return void e.clear()});(0,p.arrayEach)(this.highlight.getActiveHeaders(),function(e){return void e.clear()})}this.highlight.useLayerLevel(n);var i=this.highlight.createOrGetArea();var a=this.highlight.createOrGetHeader();var o=this.highlight.createOrGetActiveHeader();i.clear();a.clear();o.clear();if(this.highlight.isEnabledFor(u.AREA_TYPE)&&(this.isMultiple()||n>=1)){i.add(r.from).add(r.to);if(n===1){this.highlight.useLayerLevel(n-1).createOrGetArea().add(this.selectedRange.previous().from);this.highlight.useLayerLevel(n)}}if(this.highlight.isEnabledFor(u.HEADER_TYPE)){if(this.settings.selectionMode==="single"){a.add(r.highlight)}else{a.add(r.from).add(r.to)}}if(this.isSelectedByRowHeader()){var s=this.tableProps.countCols()===r.getWidth();if(s){o.add(new d.CellCoords(r.from.row,-1)).add(new d.CellCoords(r.to.row,-1))}}if(this.isSelectedByColumnHeader()){var l=this.tableProps.countRows()===r.getHeight();if(l){o.add(new d.CellCoords(-1,r.from.col)).add(new d.CellCoords(-1,r.to.col))}}this.runLocalHooks("afterSetRangeEnd",t)}},{key:"isMultiple",value:function e(){var t=(0,h.createObjectPropListener)(!this.selectedRange.current().isSingle());this.runLocalHooks("afterIsMultipleSelection",t);return t.value}},{key:"transformStart",value:function e(t,r,n){this.setRangeStart(this.transformation.transformStart(t,r,n))}},{key:"transformEnd",value:function e(t,r){this.setRangeEnd(this.transformation.transformEnd(t,r))}},{key:"getLayerLevel",value:function e(){return this.selectedRange.size()-1}},{key:"isSelected",value:function e(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getLayerLevel();return t===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getLayerLevel();return t===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function e(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function e(){return this.selectedByCorner}},{key:"inInSelection",value:function e(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function e(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function e(t){if(Number.isInteger(t)&&t!==this.getLayerLevel()){return false}return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function e(){this.selectedRange.clear();this.highlight.clear()}},{key:"deselect",value:function e(){if(!this.isSelected()){return}this.inProgress=false;this.clear();this.runLocalHooks("afterDeselect")}},{key:"selectAll",value:function e(){this.clear();this.setRangeStart(new d.CellCoords(-1,-1));this.selectedByRowHeader.add(this.getLayerLevel());this.selectedByColumnHeader.add(this.getLayerLevel());this.setRangeEnd(new d.CellCoords(this.tableProps.countRows()-1,this.tableProps.countCols()-1))}},{key:"selectCells",value:function e(t){var s=this;var r=(0,y.detectSelectionType)(t);if(r===y.SELECTION_TYPE_EMPTY){return false}else if(r===y.SELECTION_TYPE_UNRECOGNIZED){throw new Error((0,b.toSingleLine)(w()))}var l=(0,y.normalizeSelectionFactory)(r,{propToCol:function e(t){return s.tableProps.propToCol(t)},keepDirection:true});var u=this.tableProps.countRows();var f=this.tableProps.countCols();var n=!t.some(function(e){var t=l(e),r=(0,c.default)(t,4),n=r[0],i=r[1],a=r[2],o=r[3];var s=(0,y.isValidCoord)(n,u)&&(0,y.isValidCoord)(i,f)&&(0,y.isValidCoord)(a,u)&&(0,y.isValidCoord)(o,f);return!s});if(n){this.clear();(0,p.arrayEach)(t,function(e){var t=l(e),r=(0,c.default)(t,4),n=r[0],i=r[1],a=r[2],o=r[3];s.setRangeStartOnly(new d.CellCoords(n,i),false);s.setRangeEnd(new d.CellCoords(a,o));s.finish()})}return n}},{key:"selectColumns",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t;var n=typeof t==="string"?this.tableProps.propToCol(t):t;var i=typeof r==="string"?this.tableProps.propToCol(r):r;var a=this.tableProps.countCols();var o=(0,y.isValidCoord)(n,a)&&(0,y.isValidCoord)(i,a);if(o){this.setRangeStartOnly(new d.CellCoords(-1,n));this.setRangeEnd(new d.CellCoords(this.tableProps.countRows()-1,i));this.finish()}return o}},{key:"selectRows",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t;var n=this.tableProps.countRows();var i=(0,y.isValidCoord)(t,n)&&(0,y.isValidCoord)(r,n);if(i){this.setRangeStartOnly(new d.CellCoords(t,-1));this.setRangeEnd(new d.CellCoords(r,this.tableProps.countCols()-1));this.finish()}return i}}]);return r}();(0,h.mixin)(C,g.default);var S=C;t.default=S},function(e,t,r){"use strict";var n=r(0);r(124);r(149);r(391);r(31);r(15);r(99);r(10);r(39);r(13);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(27);var s=function(){function e(){(0,i.default)(this,e);this.ranges=[]}(0,a.default)(e,[{key:"isEmpty",value:function e(){return this.size()===0}},{key:"set",value:function e(t){this.clear();this.ranges.push(new o.CellRange(t));return this}},{key:"add",value:function e(t){this.ranges.push(new o.CellRange(t));return this}},{key:"current",value:function e(){return this.peekByIndex(0)}},{key:"previous",value:function e(){return this.peekByIndex(-1)}},{key:"includes",value:function e(t){return this.ranges.some(function(e){return e.includes(t)})}},{key:"clear",value:function e(){this.ranges.length=0;return this}},{key:"size",value:function e(){return this.ranges.length}},{key:"peekByIndex",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var r=this.size()+t-1;var n;if(r>=0){n=this.ranges[r]}return n}},{key:Symbol.iterator,value:function e(){return this.ranges[Symbol.iterator]()}}]);return e}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var g=r(27);var o=r(3);var s=n(r(62));var l=function(){function r(e,t){(0,i.default)(this,r);this.range=e;this.options=t}(0,a.default)(r,[{key:"transformStart",value:function e(t,r,n){var i=new g.CellCoords(t,r);this.runLocalHooks("beforeTransformStart",i);var a=this.options.countRows();var o=this.options.countCols();var s=this.options.fixedRowsBottom();var l=this.options.minSpareRows();var u=this.options.minSpareCols();var f=this.options.autoWrapRow();var c=this.options.autoWrapCol();var d=this.range.current().highlight;if(d.row+t>a-1){if(n&&l>0&&!(s&&d.row>=a-s-1)){this.runLocalHooks("insertRowRequire",a);a=this.options.countRows()}else if(c){i.row=1-a;i.col=d.col+i.col===o-1?1-o:1}}else if(c&&d.row+i.row<0&&d.col+i.col>=0){i.row=a-1;i.col=d.col+i.col===0?o-1:-1}if(d.col+i.col>o-1){if(n&&u>0){this.runLocalHooks("insertColRequire",o);o=this.options.countCols()}else if(f){i.row=d.row+i.row===a-1?1-a:1;i.col=1-o}}else if(f&&d.col+i.col<0&&d.row+i.row>=0){i.row=d.row+i.row===0?a-1:-1;i.col=o-1}var h=new g.CellCoords(d.row+i.row,d.col+i.col);var v=0;var p=0;if(h.row<0){v=-1;h.row=0}else if(h.row>0&&h.row>=a){v=1;h.row=a-1}if(h.col<0){p=-1;h.col=0}else if(h.col>0&&h.col>=o){p=1;h.col=o-1}this.runLocalHooks("afterTransformStart",h,v,p);return h}},{key:"transformEnd",value:function e(t,r){var n=new g.CellCoords(t,r);this.runLocalHooks("beforeTransformEnd",n);var i=this.options.countRows();var a=this.options.countCols();var o=this.range.current();var s=new g.CellCoords(o.to.row+n.row,o.to.col+n.col);var l=0;var u=0;if(s.row<0){l=-1;s.row=0}else if(s.row>0&&s.row>=i){l=1;s.row=i-1}if(s.col<0){u=-1;s.col=0}else if(s.col>0&&s.col>=a){u=1;s.col=a-1}this.runLocalHooks("afterTransformEnd",s,l,u);return s}}]);return r}();(0,o.mixin)(l,s.default);var u=l;t.default=u},function(e,t,r){"use strict";r(19);t.__esModule=true;t.default=n;function n(u){var e=typeof window==="undefined"?false:window.jQuery;if(!e){return}e.fn.handsontable=function(e){var t=this.first();var r=t.data("handsontable");if(typeof e!=="string"){var n=e||{};if(r){r.updateSettings(n)}else{r=new u.Core(t[0],n);t.data("handsontable",r);r.init()}return t}var i;if(r){if(typeof r[e]!=="undefined"){var a;for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++){s[l-1]=arguments[l]}i=(a=r[e]).call.apply(a,[r].concat(s));if(e==="destroy"){t.removeData()}}else{throw new Error("Handsontable do not provide action: ".concat(e))}}return i}}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;var i=n(r(524));t.PersistentState=i.default;var a=n(r(526));t.AutoColumnSize=a.default;var o=n(r(527));t.AutoFill=o.default;var s=n(r(529));t.AutoRowSize=s.default;var l=n(r(395));t.ColumnSorting=l.default;var u=n(r(543));t.Comments=u.default;var f=n(r(547));t.ContextMenu=f.default;var c=n(r(562));t.CopyPaste=c.default;var d=n(r(570));t.CustomBorders=d.default;var h=n(r(577));t.DragToScroll=h.default;var v=n(r(578));t.ManualColumnFreeze=v.default;var p=n(r(582));t.ManualColumnMove=p.default;var g=n(r(587));t.ManualColumnResize=g.default;var m=n(r(588));t.ManualRowMove=m.default;var y=n(r(593));t.ManualRowResize=y.default;var b=n(r(594));t.MergeCells=b.default;var w=n(r(600));t.MultipleSelectionHandles=w.default;var C=n(r(601));t.ObserveChanges=C.default;var S=n(r(605));t.Search=S.default;var E=n(r(606));t.TouchScroll=E.default;var k=n(r(607));t.UndoRedo=k.default;var T=n(r(22));t.Base=T.default;var _=n(r(608));t.BindRowsWithHeaders=_.default;var x=n(r(613));t.CollapsibleColumns=x.default;var D=n(r(614));t.ColumnSummary=D.default;var R=n(r(618));t.DropdownMenu=R.default;var I=n(r(620));t.ExportFile=I.default;var O=n(r(625));t.MultiColumnSorting=O.default;var A=n(r(630));t.Filters=A.default;var N=n(r(663));t.Formulas=N.default;var M=n(r(676));t.GanttChart=M.default;var L=n(r(680));t.HeaderTooltips=L.default;var P=n(r(681));t.NestedHeaders=P.default;var F=n(r(684));t.NestedRows=F.default;var B=n(r(689));t.HiddenColumns=B.default;var H=n(r(693));t.HiddenRows=H.default;var $=n(r(697));t.TrimRows=$.default},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(22));var c=r(21);var d=n(r(525));var h=n(r(46));h.default.getSingleton().register("persistentStateSave");h.default.getSingleton().register("persistentStateLoad");h.default.getSingleton().register("persistentStateReset");var v=function(e){(0,u.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,s.default)(n).call(this,e));t.storage=void 0;return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}if(!this.storage){this.storage=new d.default(this.hot.rootElement.id,this.hot.rootWindow)}this.addHook("persistentStateSave",function(e,t){return r.saveValue(e,t)});this.addHook("persistentStateLoad",function(e,t){return r.loadValue(e,t)});this.addHook("persistentStateReset",function(){return r.resetValue()});(0,l.default)((0,s.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.storage=void 0;(0,l.default)((0,s.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,l.default)((0,s.default)(n.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function e(t,r){r.value=this.storage.loadValue(t)}},{key:"saveValue",value:function e(t,r){this.storage.saveValue(t,r)}},{key:"resetValue",value:function e(t){if(typeof t==="undefined"){this.storage.resetAll()}else{this.storage.reset(t)}}},{key:"destroy",value:function e(){(0,l.default)((0,s.default)(n.prototype),"destroy",this).call(this)}}]);return n}(f.default);(0,c.registerPlugin)("persistentState",v);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(0);r(19);r(12);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(4);var s=function(){function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window;(0,i.default)(this,r);this.rootWindow=t;this.prefix=e;this.savedKeys=[];this.loadSavedKeys()}(0,a.default)(r,[{key:"saveValue",value:function e(t,r){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(r));if(this.savedKeys.indexOf(t)===-1){this.savedKeys.push(t);this.saveSavedKeys()}}},{key:"loadValue",value:function e(t,r){var n=typeof t==="undefined"?r:t;var i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function e(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function e(){var r=this;(0,o.arrayEach)(this.savedKeys,function(e,t){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[t]))});this.clearSavedKeys()}},{key:"loadSavedKeys",value:function e(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys"));var r=typeof t==="string"?JSON.parse(t):void 0;this.savedKeys=r||[]}},{key:"saveSavedKeys",value:function e(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function e(){this.savedKeys.length=0;this.saveSavedKeys()}}]);return r}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var s=n(r(18));var i=n(r(1));var a=n(r(6));var o=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(2));var d=n(r(7));var l=n(r(22));var h=r(4);var v=r(76);var p=n(r(184));var g=r(3);var m=r(17);var y=r(21);var b=n(r(394));var w=r(74);var C=r(27);var S=new WeakMap;var E=function(e){(0,d.default)(l,e);(0,c.default)(l,null,[{key:"CALCULATION_STEP",get:function e(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function e(){return 50}}]);function l(e){var f;(0,i.default)(this,l);f=(0,a.default)(this,(0,u.default)(l).call(this,e));S.set((0,o.default)(f),{cachedColumnHeaders:[]});f.widths=[];f.ghostTable=new p.default(f.hot);f.samplesGenerator=new b.default(function(e,t){var r=f.hot.getCellMeta(e,t);var n="";if(!r.spanned){n=f.hot.getDataAtCell(e,t)}var i=0;if(r.label){var a=r.label,o=a.value,s=a.property;var l="";if(o){l=typeof o==="function"?o(e,t,f.hot.colToProp(t),n):o}else if(s){var u=f.hot.getDataAtRowProp(e,s);l=u!==null?u:""}i=l.length}return{value:n,bundleCountSeed:i}});f.firstCalculation=true;f.inProgress=false;f.addHook("beforeColumnResize",function(e,t,r){return f.onBeforeColumnResize(e,t,r)});return f}(0,c.default)(l,[{key:"isEnabled",value:function e(){return this.hot.getSettings().autoColumnSize!==false&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}var t=this.hot.getSettings().autoColumnSize;if(t&&t.useHeaders!==null&&t.useHeaders!==void 0){this.ghostTable.setSetting("useHeaders",t.useHeaders)}this.setSamplingOptions();this.addHook("afterLoadData",function(){return r.onAfterLoadData()});this.addHook("beforeChange",function(e){return r.onBeforeChange(e)});this.addHook("beforeRender",function(e){return r.onBeforeRender(e)});this.addHook("modifyColWidth",function(e,t){return r.getColumnWidth(t,e)});this.addHook("afterInit",function(){return r.onAfterInit()});(0,f.default)((0,u.default)(l.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){var t=this.findColumnsWhereHeaderWasChanged();if(t.length){this.clearCache(t)}(0,f.default)((0,u.default)(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){(0,f.default)((0,u.default)(l.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function e(){var i=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countRows()-1};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=typeof t==="number"?{from:t,to:t}:t;var o=typeof r==="number"?{from:r,to:r}:r;(0,m.rangeEach)(a.from,a.to,function(e){if(n||i.widths[e]===void 0&&!i.hot._getColWidthFromSettings(e)){var t=i.samplesGenerator.generateColumnSamples(e,o);(0,h.arrayEach)(t,function(e){var t=(0,s.default)(e,2),r=t[0],n=t[1];return i.ghostTable.addColumn(r,n)})}});if(this.ghostTable.columns.length){this.ghostTable.getWidths(function(e,t){i.widths[e]=t});this.ghostTable.clean()}}},{key:"calculateAllColumnsWidth",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1};var n=0;var i=this.hot.countCols()-1;var a=null;this.inProgress=true;var o=function e(){if(!t.hot){(0,v.cancelAnimationFrame)(a);t.inProgress=false;return}t.calculateColumnsWidth({from:n,to:Math.min(n+l.CALCULATION_STEP,i)},r);n=n+l.CALCULATION_STEP+1;if(n<i){a=(0,v.requestAnimationFrame)(e)}else{(0,v.cancelAnimationFrame)(a);t.inProgress=false;t.hot.view.wt.wtOverlays.adjustElementsSize()}};var s=this.getSyncCalculationLimit();if(this.firstCalculation&&s>=0){this.calculateColumnsWidth({from:0,to:s},r);this.firstCalculation=false;n=s+1}if(n<i){o()}else{this.inProgress=false}}},{key:"setSamplingOptions",value:function e(){var t=this.hot.getSettings().autoColumnSize;var r=t&&(0,g.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0;var n=t&&(0,g.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;if(r&&!isNaN(r)){this.samplesGenerator.setSampleCount(parseInt(r,10))}if(n){this.samplesGenerator.setAllowDuplicates(n)}}},{key:"recalculateAllColumnsWidth",value:function e(){if(this.hot.view&&this.hot.view.wt.wtTable.isVisible()){this.clearCache();this.calculateAllColumnsWidth()}}},{key:"getSyncCalculationLimit",value:function e(){var t=l.SYNC_CALCULATION_LIMIT;var r=this.hot.countCols()-1;if((0,g.isObject)(this.hot.getSettings().autoColumnSize)){t=this.hot.getSettings().autoColumnSize.syncLimit;if((0,w.isPercentValue)(t)){t=(0,m.valueAccordingPercent)(r,t)}else{t>>=0}}return Math.min(t,r)}},{key:"getColumnWidth",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var i=r;if(i===void 0){i=this.widths[t];if(n&&typeof i==="number"){i=Math.max(i,C.ViewportColumnsCalculator.DEFAULT_WIDTH)}}return i}},{key:"getFirstVisibleColumn",value:function e(){var t=this.hot.view.wt;if(t.wtViewport.columnsVisibleCalculator){return t.wtTable.getFirstVisibleColumn()}if(t.wtViewport.columnsRenderCalculator){return t.wtTable.getFirstRenderedColumn()}return-1}},{key:"getLastVisibleColumn",value:function e(){var t=this.hot.view.wt;if(t.wtViewport.columnsVisibleCalculator){return t.wtTable.getLastVisibleColumn()}if(t.wtViewport.columnsRenderCalculator){return t.wtTable.getLastRenderedColumn()}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function e(){var t=this.hot.getColHeader();var r=S.get(this),i=r.cachedColumnHeaders;var n=(0,h.arrayReduce)(t,function(e,t,r){var n=i.length;if(n-1<r||i[r]!==t){e.push(r)}if(n-1<r){i.push(t)}else{i[r]=t}return e},[]);return n}},{key:"clearCache",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(r.length){(0,h.arrayEach)(r,function(e){t.widths[e]=void 0})}else{this.widths.length=0}}},{key:"isNeedRecalculate",value:function e(){return!!(0,h.arrayFilter)(this.widths,function(e){return e===void 0}).length}},{key:"onBeforeRender",value:function e(){var t=this.hot.renderCall;var r=this.hot.countRows();var n=this.getFirstVisibleColumn();var i=this.getLastVisibleColumn();if(n===-1||i===-1){return}if(!r){return}this.calculateColumnsWidth({from:n,to:i},void 0,t);if(this.isNeedRecalculate()&&!this.inProgress){this.calculateAllColumnsWidth()}}},{key:"onAfterLoadData",value:function e(){var t=this;if(this.hot.view){this.recalculateAllColumnsWidth()}else{setTimeout(function(){if(t.hot){t.recalculateAllColumnsWidth()}},0)}}},{key:"onBeforeChange",value:function e(t){var n=this;var r=(0,h.arrayMap)(t,function(e){var t=(0,s.default)(e,2),r=t[1];return n.hot.propToCol(r)});this.clearCache(r)}},{key:"onBeforeColumnResize",value:function e(t,r,n){var i=r;if(n){this.calculateColumnsWidth(t,void 0,true);i=this.getColumnWidth(t,void 0,false)}return i}},{key:"onAfterInit",value:function e(){S.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function e(){this.ghostTable.clean();(0,f.default)((0,u.default)(l.prototype),"destroy",this).call(this)}}]);return l}(l.default);(0,y.registerPlugin)("autoColumnSize",E);var k=E;t.default=k},function(e,t,r){"use strict";var n=r(0);r(19);r(31);r(12);r(39);r(34);t.__esModule=true;t.default=void 0;var i=n(r(37));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(7));var d=n(r(22));var h=n(r(46));var v=r(8);var p=r(4);var g=r(17);var m=n(r(25));var y=r(21);var b=r(27);var w=r(528);h.default.getSingleton().register("modifyAutofillRange");h.default.getSingleton().register("beforeAutofill");var C="insert_row";var S=200;var E=function(e){(0,c.default)(n,e);function n(e){var t;(0,a.default)(this,n);t=(0,s.default)(this,(0,u.default)(n).call(this,e));t.eventManager=new m.default((0,l.default)(t));t.addingStarted=false;t.mouseDownOnCellCorner=false;t.mouseDragOutside=false;t.handleDraggedCells=0;t.directions=[];t.autoInsertRow=false;return t}(0,o.default)(n,[{key:"isEnabled",value:function e(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}this.mapSettings();this.registerEvents();this.addHook("afterOnCellCornerMouseDown",function(e){return r.onAfterCellCornerMouseDown(e)});this.addHook("afterOnCellCornerDblClick",function(e){return r.onCellCornerDblClick(e)});this.addHook("beforeOnCellMouseOver",function(e,t){return r.onBeforeCellMouseOver(t)});(0,f.default)((0,u.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,f.default)((0,u.default)(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.clearMappedSettings();(0,f.default)((0,u.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"getCopyableRanges",value:function e(){var t=this.hot.getSelectedRangeLast();var r=t.getTopLeftCorner();var n=t.getBottomRightCorner();var i=r.row;var a=r.col;var o=n.row;var s=n.col;var l=[];l.push({startRow:i,startCol:a,endRow:o,endCol:s});l=this.hot.runHooks("modifyCopyableRange",l);return l}},{key:"getSelectionData",value:function e(){var n=this;var t=this.getCopyableRanges();var r=[];var i=[];var a=[];(0,p.arrayEach)(t,function(e){(0,g.rangeEach)(e.startRow,e.endRow,function(e){if(r.indexOf(e)===-1){r.push(e)}});(0,g.rangeEach)(e.startCol,e.endCol,function(e){if(i.indexOf(e)===-1){i.push(e)}})});(0,p.arrayEach)(r,function(t){var r=[];(0,p.arrayEach)(i,function(e){r.push(n.hot.getCopyableData(t,e))});a.push(r)});return a}},{key:"fillIn",value:function e(){if(this.hot.selection.highlight.getFill().isEmpty()){return false}var t=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var r=this.getCornersOfSelectedCells();t=this.hot.runHooks("modifyAutofillRange",t,r);var n=(0,w.getDragDirectionAndRange)(r,t),i=n.directionOfDrag,a=n.startOfDragCoords,o=n.endOfDragCoords;if(a&&a.row>-1&&a.col>-1){var s=this.getSelectionData();this.hot.runHooks("beforeAutofill",a,o,s);var l=(0,w.getDeltas)(a,o,s,i);var u=s;if(["up","left"].indexOf(i)>-1){u=[];var f=null;var c=null;if(i==="up"){f=o.row-a.row+1;c=f%s.length;for(var d=0;d<f;d++){u.push(s[(d+(s.length-c))%s.length])}}else{f=o.col-a.col+1;c=f%s[0].length;for(var h=0;h<s.length;h++){u.push([]);for(var v=0;v<f;v++){u[h].push(s[h][(v+(s[h].length-c))%s[h].length])}}}}this.hot.populateFromArray(a.row,a.col,u,o.row,o.col,"".concat(this.pluginName,".fill"),null,i,l);this.setSelection(t)}else{this.hot._refreshBorders()}return true}},{key:"reduceSelectionAreaIfNeeded",value:function e(t){if(t.row<0){t.row=0}if(t.col<0){t.col=0}return t}},{key:"getCoordsOfDragAndDropBorders",value:function e(t){var r=this.hot.getSelectedRangeLast().getTopLeftCorner();var n=this.hot.getSelectedRangeLast().getBottomRightCorner();var i;if(this.directions.includes(w.DIRECTIONS.vertical)&&(n.row<t.row||r.row>t.row)){i=new b.CellCoords(t.row,n.col)}else if(this.directions.includes(w.DIRECTIONS.horizontal)){i=new b.CellCoords(n.row,t.col)}else{return}return this.reduceSelectionAreaIfNeeded(i)}},{key:"showBorder",value:function e(t){var r=this.getCoordsOfDragAndDropBorders(t);if(r){this.redrawBorders(r)}}},{key:"addRow",value:function e(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.alter(C,void 0,1,"".concat(t.pluginName,".fill"));t.addingStarted=false},S))}},{key:"addNewRowIfNeeded",value:function e(){if(this.hot.selection.highlight.getFill().cellRange&&this.addingStarted===false&&this.autoInsertRow){var t=this.hot.getSelectedLast();var r=this.hot.selection.highlight.getFill().getCorners();var n=this.hot.countRows();if(t[2]<n-1&&r[2]===n-1){this.addingStarted=true;this.addRow()}}}},{key:"getCornersOfSelectedCells",value:function e(){if(this.hot.selection.isMultiple()){return this.hot.selection.highlight.createOrGetArea().getCorners()}return this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function e(t){var r=this.hot.getData();var n=this.hot.countRows();var i;for(var a=t[2]+1;a<n;a++){for(var o=t[1];o<=t[3];o++){var s=r[a][o];if(s){return-1}}var l=r[a][t[1]-1];var u=r[a][t[3]+1];if(!!l||!!u){i=a}}return i}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function e(t,r){this.hot.selection.highlight.getFill().clear().add(new b.CellCoords(t[0],t[1])).add(new b.CellCoords(r,t[3]))}},{key:"setSelection",value:function e(t){var r;(r=this.hot).selectCell.apply(r,(0,i.default)(t).concat([false,false]))}},{key:"selectAdjacent",value:function e(){var t=this.getCornersOfSelectedCells();var r=this.getIndexOfLastAdjacentFilledInRow(t);if(r===-1||r===void 0){return false}this.addSelectionFromStartAreaToSpecificRowIndex(t,r);return true}},{key:"resetSelectionOfDraggedArea",value:function e(){this.handleDraggedCells=0;this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function e(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t);this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function e(t){var r=this.hot.rootDocument.documentElement;var n=(0,v.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+(0,v.outerHeight)(this.hot.table);var i=(0,v.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+(0,v.outerWidth)(this.hot.table);return t.clientY>n&&t.clientX<=i}},{key:"registerEvents",value:function e(){var t=this;var r=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(r,"mouseup",function(){return t.onMouseUp()});this.eventManager.addEventListener(r,"mousemove",function(e){return t.onMouseMove(e)})}},{key:"onCellCornerDblClick",value:function e(){var t=this.selectAdjacent();if(t){this.fillIn()}}},{key:"onAfterCellCornerMouseDown",value:function e(){this.handleDraggedCells=1;this.mouseDownOnCellCorner=true}},{key:"onBeforeCellMouseOver",value:function e(t){if(this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells){this.handleDraggedCells+=1;this.showBorder(t);this.addNewRowIfNeeded()}}},{key:"onMouseUp",value:function e(){if(this.handleDraggedCells){if(this.handleDraggedCells>1){this.fillIn()}this.handleDraggedCells=0;this.mouseDownOnCellCorner=false}}},{key:"onMouseMove",value:function e(t){var r=this.getIfMouseWasDraggedOutside(t);if(this.addingStarted===false&&this.handleDraggedCells>0&&r){this.mouseDragOutside=true;this.addingStarted=true}else{this.mouseDragOutside=false}if(this.mouseDragOutside&&this.autoInsertRow){this.addRow()}}},{key:"clearMappedSettings",value:function e(){this.directions.length=0;this.autoInsertRow=false}},{key:"mapSettings",value:function e(){var t=(0,w.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=t.directions;this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function e(){(0,f.default)((0,u.default)(n.prototype),"destroy",this).call(this)}}]);return n}(d.default);(0,y.registerPlugin)("autofill",E);var k=E;t.default=k},function(e,t,r){"use strict";r(12);r(65);t.__esModule=true;t.getDeltas=s;t.getDragDirectionAndRange=l;t.getMappedFillHandleSetting=u;t.DIRECTIONS=void 0;var n=r(3);var i=r(29);var a=r(27);var o={horizontal:"horizontal",vertical:"vertical"};t.DIRECTIONS=o;function s(e,t,r,n){var i=r.length;var a=r?r[0].length:0;var o=[];var s=t.row-e.row;var l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){var u=[];for(var f=0;f<l;f++){var c=parseInt(r[0][f],10);var d=parseInt(r[i-1][f],10);var h=(n==="down"?d-c:c-d)/(i-1)||0;u.push(h)}o.push(u)}if(["right","left"].indexOf(n)!==-1){for(var v=0;v<s;v++){var p=parseInt(r[v][0],10);var g=parseInt(r[v][a-1],10);var m=(n==="right"?g-p:p-g)/(a-1)||0;o.push([m])}}return o}function l(e,t){var r;var n;var i;if(t[0]===e[0]&&t[1]<e[1]){i="left";r=new a.CellCoords(t[0],t[1]);n=new a.CellCoords(t[2],e[1]-1)}else if(t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]){i="right";r=new a.CellCoords(t[0],e[3]+1);n=new a.CellCoords(t[2],t[3])}else if(t[0]<e[0]&&t[1]===e[1]){i="up";r=new a.CellCoords(t[0],t[1]);n=new a.CellCoords(e[0]-1,t[3])}else if(t[2]>e[2]&&t[1]===e[1]){i="down";r=new a.CellCoords(e[2]+1,t[1]);n=new a.CellCoords(t[2],t[3])}return{directionOfDrag:i,startOfDragCoords:r,endOfDragCoords:n}}function u(e){var t={};if(e===true){t.directions=Object.keys(o);t.autoInsertRow=true}else if((0,n.isObject)(e)){if((0,i.isDefined)(e.autoInsertRow)){if(e.direction===o.horizontal){t.autoInsertRow=false}else{t.autoInsertRow=e.autoInsertRow}}else{t.autoInsertRow=false}if((0,i.isDefined)(e.direction)){t.directions=[e.direction]}else{t.directions=Object.keys(o)}}else if(typeof e==="string"){t.directions=[e];t.autoInsertRow=true}else{t.directions=[];t.autoInsertRow=false}return t}},function(e,t,r){"use strict";var n=r(0);r(34);t.__esModule=true;t.default=void 0;var u=n(r(18));var i=n(r(1));var a=n(r(6));var o=n(r(5));var s=n(r(14));var f=n(r(2));var c=n(r(7));var l=n(r(22));var d=r(4);var h=r(76);var v=r(8);var p=n(r(184));var g=r(3);var m=r(17);var y=r(21);var b=n(r(394));var w=r(74);var C=function(e){(0,c.default)(l,e);(0,f.default)(l,null,[{key:"CALCULATION_STEP",get:function e(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function e(){return 500}}]);function l(e){var n;(0,i.default)(this,l);n=(0,a.default)(this,(0,o.default)(l).call(this,e));n.heights=[];n.ghostTable=new p.default(n.hot);n.samplesGenerator=new b.default(function(e,t){var r;if(e>=0){r=n.hot.getDataAtCell(e,t)}else if(e===-1){r=n.hot.getColHeader(t)}return{value:r}});n.firstCalculation=true;n.inProgress=false;n.addHook("beforeRowResize",function(e,t,r){return n.onBeforeRowResize(e,t,r)});return n}(0,f.default)(l,[{key:"isEnabled",value:function e(){return this.hot.getSettings().autoRowSize===true||(0,g.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}this.setSamplingOptions();this.addHook("afterLoadData",function(){return r.onAfterLoadData()});this.addHook("beforeChange",function(e){return r.onBeforeChange(e)});this.addHook("beforeColumnMove",function(){return r.recalculateAllRowsHeight()});this.addHook("beforeColumnResize",function(){return r.recalculateAllRowsHeight()});this.addHook("beforeColumnSort",function(){return r.clearCache()});this.addHook("beforeRender",function(e){return r.onBeforeRender(e)});this.addHook("beforeRowMove",function(e,t){return r.onBeforeRowMove(e,t)});this.addHook("modifyRowHeight",function(e,t){return r.getRowHeight(t,e)});this.addHook("modifyColumnHeaderHeight",function(){return r.getColumnHeaderHeight()});(0,s.default)((0,o.default)(l.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){(0,s.default)((0,o.default)(l.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function e(){var i=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countCols()-1};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=typeof t==="number"?{from:t,to:t}:t;var o=typeof r==="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){var s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}(0,m.rangeEach)(a.from,a.to,function(e){if(n||i.heights[e]===void 0){var t=i.samplesGenerator.generateRowSamples(e,o);(0,d.arrayEach)(t,function(e){var t=(0,u.default)(e,2),r=t[0],n=t[1];return i.ghostTable.addRow(r,n)})}});if(this.ghostTable.rows.length){this.ghostTable.getHeights(function(e,t){i.heights[e]=t});this.ghostTable.clean()}}},{key:"calculateAllRowsHeight",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1};var n=0;var i=this.hot.countRows()-1;var a=null;this.inProgress=true;var o=function e(){if(!t.hot){(0,h.cancelAnimationFrame)(a);t.inProgress=false;return}t.calculateRowsHeight({from:n,to:Math.min(n+l.CALCULATION_STEP,i)},r);n=n+l.CALCULATION_STEP+1;if(n<i){a=(0,h.requestAnimationFrame)(e)}else{(0,h.cancelAnimationFrame)(a);t.inProgress=false;t.hot.view.wt.wtOverlays.adjustElementsSize(true);if(t.hot.view.wt.wtOverlays.leftOverlay.needFullRender){t.hot.view.wt.wtOverlays.leftOverlay.clone.draw()}}};var s=this.getSyncCalculationLimit();if(this.firstCalculation&&s>=0){this.calculateRowsHeight({from:0,to:s},r);this.firstCalculation=false;n=s+1}if(n<i){o()}else{this.inProgress=false;this.hot.view.wt.wtOverlays.adjustElementsSize(false)}}},{key:"setSamplingOptions",value:function e(){var t=this.hot.getSettings().autoRowSize;var r=t&&(0,g.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0;var n=t&&(0,g.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;if(r&&!isNaN(r)){this.samplesGenerator.setSampleCount(parseInt(r,10))}if(n){this.samplesGenerator.setAllowDuplicates(n)}}},{key:"recalculateAllRowsHeight",value:function e(){if((0,v.isVisible)(this.hot.view.wt.wtTable.TABLE)){this.clearCache();this.calculateAllRowsHeight()}}},{key:"getSyncCalculationLimit",value:function e(){var t=l.SYNC_CALCULATION_LIMIT;var r=this.hot.countRows()-1;if((0,g.isObject)(this.hot.getSettings().autoRowSize)){t=this.hot.getSettings().autoRowSize.syncLimit;if((0,w.isPercentValue)(t)){t=(0,m.valueAccordingPercent)(r,t)}else{t>>=0}}return Math.min(t,r)}},{key:"getRowHeight",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0;var n=r;if(this.heights[t]!==void 0&&this.heights[t]>(r||0)){n=this.heights[t]}return n}},{key:"getColumnHeaderHeight",value:function e(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function e(){var t=this.hot.view.wt;if(t.wtViewport.rowsVisibleCalculator){return t.wtTable.getFirstVisibleRow()}if(t.wtViewport.rowsRenderCalculator){return t.wtTable.getFirstRenderedRow()}return-1}},{key:"getLastVisibleRow",value:function e(){var t=this.hot.view.wt;if(t.wtViewport.rowsVisibleCalculator){return t.wtTable.getLastVisibleRow()}if(t.wtViewport.rowsRenderCalculator){return t.wtTable.getLastRenderedRow()}return-1}},{key:"clearCache",value:function e(){this.heights.length=0;this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function e(t){var r=this;var n=typeof t==="number"?{from:t,to:t}:t,i=n.from,a=n.to;(0,m.rangeEach)(Math.min(i,a),Math.max(i,a),function(e){r.heights[e]=void 0})}},{key:"isNeedRecalculate",value:function e(){return!!(0,d.arrayFilter)(this.heights,function(e){return e===void 0}).length}},{key:"onBeforeRender",value:function e(){var t=this.hot.renderCall;var r=this.hot.getSettings().fixedRowsBottom;var n=this.getFirstVisibleRow();var i=this.getLastVisibleRow();if(n===-1||i===-1){return}this.calculateRowsHeight({from:n,to:i},void 0,t);if(r){var a=this.hot.countRows()-1;this.calculateRowsHeight({from:a-r,to:a})}if(this.isNeedRecalculate()&&!this.inProgress){this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function e(t,r){this.clearCacheByRange({from:t,to:r});this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function e(t,r,n){var i=r;if(n){this.calculateRowsHeight(t,void 0,true);i=this.getRowHeight(t)}return i}},{key:"onAfterLoadData",value:function e(){var t=this;if(this.hot.view){this.recalculateAllRowsHeight()}else{setTimeout(function(){if(t.hot){t.recalculateAllRowsHeight()}},0)}}},{key:"onBeforeChange",value:function e(t){var r=null;if(t.length===1){r=t[0][0]}else if(t.length>1){r={from:t[0][0],to:t[t.length-1][0]}}if(r!==null){this.clearCacheByRange(r)}}},{key:"destroy",value:function e(){this.ghostTable.clean();(0,s.default)((0,o.default)(l.prototype),"destroy",this).call(this)}}]);return l}(l.default);(0,y.registerPlugin)("autoRowSize",C);var S=C;t.default=S},function(e,t,r){"use strict";var h=r(44);var n=r(26);var v=r(111);var p=r(160);var g=r(130);var m=r(58);var y=r(104);var i=Object.assign;var a=Object.defineProperty;e.exports=!i||n(function(){if(h&&i({b:1},i(a({},"a",{enumerable:true,get:function(){a(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return i({},e)[r]!=7||v(i({},t)).join("")!=n})?function e(t,r){var n=m(t);var i=arguments.length;var a=1;var o=p.f;var s=g.f;while(i>a){var l=y(arguments[a++]);var u=o?v(l).concat(o(l)):v(l);var f=u.length;var c=0;var d;while(f>c){d=u[c++];if(!h||s.call(l,d))n[d]=l[d]}}return n}:i},function(e,t,r){var o=r(532);function n(e,t){if(e==null)return{};var r=o(e,t);var n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++){n=a[i];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}e.exports=n},function(e,t){function r(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var i,a;for(a=0;a<n.length;a++){i=n[a];if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}e.exports=r},function(e,t,r){"use strict";var n=r(0);r(146);r(31);r(12);r(39);t.__esModule=true;t.ColumnStatesManager=void 0;var i=n(r(1));var a=n(r(2));var o=r(3);var s=r(4);var l=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];var u=false;var f=true;var c=true;var d=function(){function e(){(0,i.default)(this,e);this.sortedColumnsStates=[];this.sortEmptyCells=u;this.indicator=f;this.headerAction=c;this.compareFunctionFactory=void 0}(0,a.default)(e,[{key:"updateAllColumnsProperties",value:function e(t){var r=this;if(!(0,o.isObject)(t)){return}(0,o.objectEach)(t,function(e,t){if(l.includes(t)){r[t]=e}})}},{key:"getAllColumnsProperties",value:function e(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};if(typeof this.compareFunctionFactory==="function"){t.compareFunctionFactory=this.compareFunctionFactory}return t}},{key:"getFirstSortedColumn",value:function e(){var t;if(this.getNumberOfSortedColumns()>0){t=this.sortedColumnsStates[0].column}return t}},{key:"getSortOrderOfColumn",value:function e(r){var t=this.sortedColumnsStates.find(function(e){var t=e.column;return r===t});var n;if((0,o.isObject)(t)){n=t.sortOrder}return n}},{key:"getSortedColumns",value:function e(){return(0,s.arrayMap)(this.sortedColumnsStates,function(e){var t=e.column;return t})}},{key:"getIndexOfColumnInSortQueue",value:function e(t){return this.getSortedColumns().indexOf(t)}},{key:"getNumberOfSortedColumns",value:function e(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function e(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function e(t){return this.getSortedColumns().includes(t)}},{key:"getSortStates",value:function e(){return(0,o.deepClone)(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function e(t){if(this.isColumnSorted(t)){return(0,o.deepClone)(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(t)])}}},{key:"setSortStates",value:function e(t){this.sortedColumnsStates=t}},{key:"destroy",value:function e(){this.sortedColumnsStates.length=0;this.sortedColumnsStates=null}}]);return e}();t.ColumnStatesManager=d},function(e,t,r){"use strict";r(19);r(60);r(15);r(69);r(10);r(13);r(16);t.__esModule=true;t.getClassesToAdd=f;t.getClassedToRemove=c;var n=r(185);var i="ascending";var a="descending";var o="indicatorDisabled";var s="columnSorting";var l="sortAction";var u=new Map([[n.ASC_SORT_STATE,i],[n.DESC_SORT_STATE,a]]);function f(e,t,r,n){var i=[s];if(n){i.push(l)}if(r===false){i.push(o)}else if(e.isColumnSorted(t)){var a=e.getSortOrderOfColumn(t);i.push(u.get(a))}return i}function c(){return Array.from(u.values()).concat(l,o,s)}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(101));var s=r(3);var l=r(17);var u=function(){function e(){(0,i.default)(this,e)}(0,a.default)(e,[{key:"createMap",value:function e(t){var r=this;var n=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0;(0,l.rangeEach)(n-1,function(e){r._arrayMap[e]=e})}},{key:"destroy",value:function e(){this._arrayMap=null}}]);return e}();(0,s.mixin)(u,o.default);var f=u;t.default=f},function(e,t,r){"use strict";var n=r(0);r(41);t.__esModule=true;t.rootComparator=a;var i=n(r(397));var h=r(93);function a(c,d){return function(e,t){var r=(0,i.default)(e),u=r.slice(1);var n=(0,i.default)(t),f=n.slice(1);return function e(t){var r=c[t];var n=d[t];var i=u[t];var a=f[t];var o=n.columnSorting;var s=o.compareFunctionFactory?o.compareFunctionFactory:(0,h.getCompareFunctionFactory)(n.type);var l=s(r,n,o)(i,a);return l}(0)}}},function(e,t,r){"use strict";t.__esModule=true;t.compareFunctionFactory=n;t.COLUMN_DATA_TYPE=void 0;var a=r(29);var o=r(93);function n(n,e,i){return function(e,t){var r=i.sortEmptyCells;if(typeof e==="string"){e=e.toLowerCase()}if(typeof t==="string"){t=t.toLowerCase()}if(e===t){return o.DO_NOT_SWAP}if((0,a.isEmpty)(e)){if((0,a.isEmpty)(t)){return o.DO_NOT_SWAP}if(r){return n==="asc"?o.FIRST_BEFORE_SECOND:o.FIRST_AFTER_SECOND}return o.FIRST_AFTER_SECOND}if((0,a.isEmpty)(t)){if(r){return n==="asc"?o.FIRST_AFTER_SECOND:o.FIRST_BEFORE_SECOND}return o.FIRST_BEFORE_SECOND}if(isNaN(e)&&!isNaN(t)){return n==="asc"?o.FIRST_AFTER_SECOND:o.FIRST_BEFORE_SECOND}else if(!isNaN(e)&&isNaN(t)){return n==="asc"?o.FIRST_BEFORE_SECOND:o.FIRST_AFTER_SECOND}else if(!(isNaN(e)||isNaN(t))){e=parseFloat(e);t=parseFloat(t)}if(e<t){return n==="asc"?o.FIRST_BEFORE_SECOND:o.FIRST_AFTER_SECOND}if(e>t){return n==="asc"?o.FIRST_AFTER_SECOND:o.FIRST_BEFORE_SECOND}return o.DO_NOT_SWAP}}var i="default";t.COLUMN_DATA_TYPE=i},function(e,t,r){"use strict";t.__esModule=true;t.compareFunctionFactory=n;t.COLUMN_DATA_TYPE=void 0;var s=r(29);var l=r(93);function n(a,e,o){return function(e,t){var r=parseFloat(e);var n=parseFloat(t);var i=o.sortEmptyCells;if(r===n||isNaN(r)&&isNaN(n)){return l.DO_NOT_SWAP}if(i){if((0,s.isEmpty)(e)){return a==="asc"?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND}if((0,s.isEmpty)(t)){return a==="asc"?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND}}if(isNaN(r)){return l.FIRST_AFTER_SECOND}if(isNaN(n)){return l.FIRST_BEFORE_SECOND}if(r<n){return a==="asc"?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND}else if(r>n){return a==="asc"?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND}return l.DO_NOT_SWAP}}var i="numeric";t.COLUMN_DATA_TYPE=i},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.compareFunctionFactory=i;t.COLUMN_DATA_TYPE=void 0;var u=n(r(64));var f=r(29);var c=r(93);function i(o,s,l){return function(e,t){var r=l.sortEmptyCells;if(e===t){return c.DO_NOT_SWAP}if((0,f.isEmpty)(e)){if((0,f.isEmpty)(t)){return c.DO_NOT_SWAP}if(r){return o==="asc"?c.FIRST_BEFORE_SECOND:c.FIRST_AFTER_SECOND}return c.FIRST_AFTER_SECOND}if((0,f.isEmpty)(t)){if(r){return o==="asc"?c.FIRST_AFTER_SECOND:c.FIRST_BEFORE_SECOND}return c.FIRST_BEFORE_SECOND}var n=s.dateFormat;var i=(0,u.default)(e,n);var a=(0,u.default)(t,n);if(!i.isValid()){return c.FIRST_AFTER_SECOND}if(!a.isValid()){return c.FIRST_BEFORE_SECOND}if(a.isAfter(i)){return o==="asc"?c.FIRST_BEFORE_SECOND:c.FIRST_AFTER_SECOND}if(a.isBefore(i)){return o==="asc"?c.FIRST_AFTER_SECOND:c.FIRST_BEFORE_SECOND}return c.DO_NOT_SWAP}}var a="date";t.COLUMN_DATA_TYPE=a},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.sort=u;t.FIRST_AFTER_SECOND=t.FIRST_BEFORE_SECOND=t.DO_NOT_SWAP=void 0;var o=n(r(541));var s=r(398);var i=0;t.DO_NOT_SWAP=i;var a=-1;t.FIRST_BEFORE_SECOND=a;var l=1;t.FIRST_AFTER_SECOND=l;function u(e,t){var r=(0,s.getRootComparator)(t);for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++){i[a-2]=arguments[a]}(0,o.default)(e,r.apply(void 0,i))}},function(e,t,r){"use strict";var n=r(0);r(10);r(38);t.__esModule=true;t.default=o;var h=n(r(542));var a=function e(t,r){var n=t.toString();var i=r.toString();if(n===i){return 0}else if(n<i){return-1}return 1};function o(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:e.length;if(Math.abs(n-r)<=1){return[]}var i=Math.ceil((r+n)/2);o(e,t,r,i);o(e,t,i,n);return s(e,t,r,i,n)}function s(e,t,r,n,i){var a=new h.default;var o=new h.default;var s=n-r;var l=i-n;var u=Math.max(s,l);var f=i-r;for(var c=0;c<u;c+=1){if(c<s){a.push(e[r+c])}if(c<l){o.push(e[n+c])}}var d=0;while(d<f){if(a.first&&o.first){if(t(a.first.data,o.first.data)>0){e[r+d]=o.shift().data}else{e[r+d]=a.shift().data}}else if(a.first){e[r+d]=a.shift().data}else{e[r+d]=o.shift().data}d+=1}return e}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=t.NodeStructure=void 0;var i=n(r(2));var a=n(r(1));var o=function e(t){(0,a.default)(this,e);this.data=t;this.next=null;this.prev=null};t.NodeStructure=o;var s=function(){function e(){(0,a.default)(this,e);this.first=null;this.last=null}(0,i.default)(e,[{key:"push",value:function e(t){var r=new o(t);if(this.first===null){this.first=r;this.last=r}else{var n=this.last;this.last=r;r.prev=n;n.next=r}}},{key:"unshift",value:function e(t){var r=new o(t);if(this.first===null){this.first=r;this.last=r}else{var n=this.first;this.first=r;r.next=n;n.prev=r}}},{key:"inorder",value:function e(t){var r=this.first;while(r){t(r);r=r.next}}},{key:"remove",value:function e(t){if(this.first===null){return false}var r=this.first;var n;var i;while(r){if(r.data===t){n=r.next;i=r.prev;if(n){n.prev=i}if(i){i.next=n}if(r===this.first){this.first=n}if(r===this.last){this.last=i}return true}r=r.next}return false}},{key:"hasCycle",value:function e(){var t=this.first;var r=this.first;while(true){if(t===null){return false}t=t.next;if(t===null){return false}t=t.next;r=r.next;if(t===r){return true}}}},{key:"pop",value:function e(){if(this.last===null){return null}var t=this.last;this.last=this.last.prev;return t}},{key:"shift",value:function e(){if(this.first===null){return null}var t=this.first;this.first=this.first.next;return t}},{key:"recursiveReverse",value:function e(){function r(e,t){if(!t){return}r(t,t.next);t.next=e}if(!this.first){return}r(this.first,this.first.next);this.first.next=null;var t=this.first;this.first=this.last;this.last=t}},{key:"reverse",value:function e(){if(!this.first||!this.first.next){return}var t=this.first.next;var r=this.first;var n;while(t){n=t.next;t.next=r;r.prev=t;r=t;t=n}this.first.next=null;this.last.prev=null;n=this.first;this.first=r;this.last=n}}]);return e}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(15);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var s=i(r(70));var a=i(r(1));var o=i(r(2));var l=i(r(6));var u=i(r(28));var f=i(r(5));var c=i(r(14));var d=i(r(7));var b=r(8);var h=r(3);var v=i(r(25));var p=r(27);var g=r(21);var m=i(r(22));var y=i(r(544));var w=r(66);var C=i(r(545));var S=n(r(11));r(546);var E=new WeakMap;var k="comment";var T="value";var _="style";var x="readOnly";var D=function(e){(0,d.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,l.default)(this,(0,f.default)(r).call(this,e));t.editor=null;t.displaySwitch=null;t.eventManager=null;t.range={};t.mouseDown=false;t.contextMenuEvent=false;t.timer=null;E.set((0,u.default)(t),{tempEditorDimensions:{},cellBelowCursor:null});return t}(0,o.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function e(){var o=this;if(this.enabled){return}if(!this.editor){this.editor=new y.default(this.hot.rootDocument)}if(!this.eventManager){this.eventManager=new v.default(this)}if(!this.displaySwitch){this.displaySwitch=new C.default(this.getDisplayDelaySetting())}this.addHook("afterContextMenuDefaultOptions",function(e){return o.addToContextMenu(e)});this.addHook("afterRenderer",function(e,t,r,n,i,a){return o.onAfterRenderer(e,a)});this.addHook("afterScrollHorizontally",function(){return o.hide()});this.addHook("afterScrollVertically",function(){return o.hide()});this.addHook("afterBeginEditing",function(){return o.onAfterBeginEditing()});this.displaySwitch.addLocalHook("hide",function(){return o.hide()});this.displaySwitch.addLocalHook("show",function(e,t){return o.showAtCell(e,t)});this.registerListeners();(0,c.default)((0,f.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,c.default)((0,f.default)(r.prototype),"updatePlugin",this).call(this);this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function e(){(0,c.default)((0,f.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function e(){var t=this;var r=this.hot.rootDocument;this.eventManager.addEventListener(r,"mouseover",function(e){return t.onMouseOver(e)});this.eventManager.addEventListener(r,"mousedown",function(e){return t.onMouseDown(e)});this.eventManager.addEventListener(r,"mouseup",function(){return t.onMouseUp()});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return t.onEditorBlur()});this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(e){return t.onEditorMouseDown(e)});this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(e){return t.onEditorMouseUp(e)})}},{key:"setRange",value:function e(t){this.range=t}},{key:"clearRange",value:function e(){this.range={}}},{key:"targetIsCellWithComment",value:function e(t){var r=(0,b.closest)(t.target,"TD","TBODY");return!!(r&&(0,b.hasClass)(r,"htCommentCell")&&(0,b.closest)(r,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function e(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function e(t){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var r=this.editor.getValue();var n="";if(t!==null&&t!==void 0){n=t}else if(r!==null&&r!==void 0){n=r}var i=this.range.from.row;var a=this.range.from.col;this.updateCommentMeta(i,a,(0,s.default)({},T,n));this.hot.render()}},{key:"setCommentAtCell",value:function e(t,r,n){this.setRange({from:new p.CellCoords(t,r)});this.setComment(n)}},{key:"removeComment",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}this.hot.setCellMeta(this.range.from.row,this.range.from.col,k,void 0);if(t){this.hot.render()}this.hide()}},{key:"removeCommentAtCell",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;this.setRange({from:new p.CellCoords(t,r)});this.removeComment(n)}},{key:"getComment",value:function e(){var t=this.range.from.row;var r=this.range.from.col;return this.getCommentMeta(t,r,T)}},{key:"getCommentAtCell",value:function e(t,r){return this.getCommentMeta(t,r,T)}},{key:"show",value:function e(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);this.refreshEditor(true);this.editor.setValue(t[k]?t[k][T]:false||"");if(this.editor.hidden){this.editor.show()}return true}},{key:"showAtCell",value:function e(t,r){this.setRange({from:new p.CellCoords(t,r)});return this.show()}},{key:"hide",value:function e(){if(!this.editor.hidden){this.editor.hide()}}},{key:"refreshEditor",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!t&&(!this.range.from||!this.editor.isVisible())){return}var r=this.hot.rootWindow;var n=this.hot.view.wt,i=n.wtTable,a=n.wtOverlays,o=n.wtViewport;var s=a.scrollableElement;var l=i.getCell(this.range.from);var u=this.range.from.row;var f=this.range.from.col;var c=(0,b.offset)(l);var d=i.getStretchedColumnWidth(f);var h=c.top<0?0:c.top;var v=c.left;if(o.hasVerticalScroll()&&s!==r){h-=a.topOverlay.getScrollPosition()}if(o.hasHorizontalScroll()&&s!==r){v-=a.leftOverlay.getScrollPosition()}var p=v+d;var g=h;var m=this.getCommentMeta(u,f,_);var y=this.getCommentMeta(u,f,x);if(m){this.editor.setSize(m.width,m.height)}else{this.editor.resetSize()}this.editor.setReadOnlyState(y);this.editor.setPosition(p,g)}},{key:"checkSelectionCommentsConsistency",value:function e(){var t=this.hot.getSelectedRangeLast();if(!t){return false}var r=false;var n=t.from;if(this.getCommentMeta(n.row,n.col,T)){r=true}return r}},{key:"updateCommentMeta",value:function e(t,r,n){var i=this.hot.getCellMeta(t,r)[k];var a;if(i){a=(0,h.deepClone)(i);(0,h.deepExtend)(a,n)}else{a=n}this.hot.setCellMeta(t,r,k,a)}},{key:"getCommentMeta",value:function e(t,r,n){var i=this.hot.getCellMeta(t,r);if(!i[k]){return void 0}return i[k][n]}},{key:"onMouseDown",value:function e(t){this.mouseDown=true;if(!this.hot.view||!this.hot.view.wt){return}if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var r=(0,b.closest)(t.target,"TD","TBODY");var n=null;if(r){n=this.hot.view.wt.wtTable.getCoords(r)}if(!r||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col)){this.hide()}}this.contextMenuEvent=false}},{key:"onMouseOver",value:function e(t){var r=E.get(this);var n=this.hot.rootDocument;r.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY);if(this.mouseDown||this.editor.isFocused()||(0,b.hasClass)(t.target,"wtBorder")||r.cellBelowCursor!==t.target||!this.editor){return}if(this.targetIsCellWithComment(t)){var i=this.hot.view.wt.wtTable.getCoords(t.target);var a={from:new p.CellCoords(i.row,i.col)};this.displaySwitch.show(a)}else if((0,b.isChildOf)(t.target,n)&&!this.targetIsCommentTextArea(t)){this.displaySwitch.hide()}}},{key:"onMouseUp",value:function e(){this.mouseDown=false}},{key:"onAfterRenderer",value:function e(t,r){if(r[k]&&r[k][T]){(0,b.addClass)(t,r.commentedCellClassName)}}},{key:"onEditorBlur",value:function e(){this.setComment()}},{key:"onEditorMouseDown",value:function e(t){var r=E.get(this);r.tempEditorDimensions={width:(0,b.outerWidth)(t.target),height:(0,b.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function e(t){var r=E.get(this);var n=(0,b.outerWidth)(t.target);var i=(0,b.outerHeight)(t.target);if(n!==r.tempEditorDimensions.width+1||i!==r.tempEditorDimensions.height+2){this.updateCommentMeta(this.range.from.row,this.range.from.col,(0,s.default)({},_,{width:n,height:i}))}}},{key:"onContextMenuAddComment",value:function e(){var t=this;this.displaySwitch.cancelHiding();var r=this.hot.getSelectedRangeLast();this.contextMenuEvent=true;this.setRange({from:r.from});this.show();setTimeout(function(){if(t.hot){t.hot.deselectCell();t.editor.focus()}},10)}},{key:"onContextMenuRemoveComment",value:function e(){var t=this.hot.getSelectedRangeLast(),r=t.from,n=t.to;this.contextMenuEvent=true;for(var i=r.row;i<=n.row;i++){for(var a=r.col;a<=n.col;a++){this.removeCommentAtCell(i,a,false)}}this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function e(){var t=this.hot.getSelectedRangeLast(),r=t.from,n=t.to;this.contextMenuEvent=true;for(var i=r.row;i<=n.row;i++){for(var a=r.col;a<=n.col;a++){var o=!!this.getCommentMeta(i,a,x);this.updateCommentMeta(i,a,(0,s.default)({},x,!o))}}}},{key:"addToContextMenu",value:function e(t){var r=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function e(){if(r.checkSelectionCommentsConsistency()){return r.hot.getTranslatedPhrase(S.CONTEXTMENU_ITEMS_EDIT_COMMENT)}return r.hot.getTranslatedPhrase(S.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function e(){return r.onContextMenuAddComment()},disabled:function e(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function e(){return this.getTranslatedPhrase(S.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function e(){return r.onContextMenuRemoveComment()},disabled:function e(){return r.hot.selection.isSelectedByCorner()}},{key:"commentsReadOnly",name:function e(){var n=this;var t=this.getTranslatedPhrase(S.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);var r=(0,w.checkSelectionConsistency)(this.getSelectedRangeLast(),function(e,t){var r=n.getCellMeta(e,t)[k];if(r){r=r[x]}if(r){return true}});if(r){t=(0,w.markLabelAsSelected)(t)}return t},callback:function e(){return r.onContextMenuMakeReadOnly()},disabled:function e(){return r.hot.selection.isSelectedByCorner()||!r.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function e(){var t=this.hot.getSettings().comments;if((0,h.isObject)(t)){return t.displayDelay}return void 0}},{key:"onAfterBeginEditing",value:function e(){this.hide()}},{key:"destroy",value:function e(){if(this.editor){this.editor.destroy()}if(this.displaySwitch){this.displaySwitch.destroy()}(0,c.default)((0,f.default)(r.prototype),"destroy",this).call(this)}}]);return r}(m.default);(0,g.registerPlugin)("comments",D);var R=D;t.default=R},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(8);var s=function(){(0,a.default)(n,null,[{key:"CLASS_EDITOR_CONTAINER",get:function e(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function e(){return"htComments"}},{key:"CLASS_INPUT",get:function e(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function e(){return"htCommentCell"}}]);function n(e){(0,i.default)(this,n);this.container=null;this.rootDocument=e;this.editor=this.createEditor();this.editorStyle=this.editor.style;this.hidden=true;this.hide()}(0,a.default)(n,[{key:"setPosition",value:function e(t,r){this.editorStyle.left="".concat(t,"px");this.editorStyle.top="".concat(r,"px")}},{key:"setSize",value:function e(t,r){if(t&&r){var n=this.getInputElement();n.style.width="".concat(t,"px");n.style.height="".concat(r,"px")}}},{key:"resetSize",value:function e(){var t=this.getInputElement();t.style.width="";t.style.height=""}},{key:"setReadOnlyState",value:function e(t){var r=this.getInputElement();r.readOnly=t}},{key:"show",value:function e(){this.editorStyle.display="block";this.hidden=false}},{key:"hide",value:function e(){this.editorStyle.display="none";this.hidden=true}},{key:"isVisible",value:function e(){return this.editorStyle.display==="block"}},{key:"setValue",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=t||"";this.getInputElement().value=r}},{key:"getValue",value:function e(){return this.getInputElement().value}},{key:"isFocused",value:function e(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function e(){this.getInputElement().focus()}},{key:"createEditor",value:function e(){var t=this.rootDocument.createElement("div");var r=this.rootDocument.createElement("textarea");this.container=this.rootDocument.querySelector(".".concat(n.CLASS_EDITOR_CONTAINER));if(!this.container){this.container=this.rootDocument.createElement("div");(0,o.addClass)(this.container,n.CLASS_EDITOR_CONTAINER);this.rootDocument.body.appendChild(this.container)}(0,o.addClass)(t,n.CLASS_EDITOR);(0,o.addClass)(r,n.CLASS_INPUT);t.appendChild(r);this.container.appendChild(t);return t}},{key:"getInputElement",value:function e(){return this.editor.querySelector(".".concat(n.CLASS_INPUT))}},{key:"destroy",value:function e(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null;if(t){t.removeChild(this.container)}}}]);return n}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(0);r(34);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=r(77);var s=r(3);var l=n(r(62));var u=250;var f=250;var c=function(){function t(e){(0,i.default)(this,t);this.wasLastActionShow=true;this.showDebounced=null;this.hidingTimer=null;this.updateDelay(e)}(0,a.default)(t,[{key:"hide",value:function e(){var t=this;this.wasLastActionShow=false;this.hidingTimer=setTimeout(function(){if(t.wasLastActionShow===false){t.runLocalHooks("hide")}},f)}},{key:"show",value:function e(t){this.wasLastActionShow=true;this.showDebounced(t)}},{key:"cancelHiding",value:function e(){this.wasLastActionShow=true;clearTimeout(this.hidingTimer);this.hidingTimer=null}},{key:"updateDelay",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:u;this.showDebounced=(0,o.debounce)(function(e){if(t.wasLastActionShow){t.runLocalHooks("show",e.from.row,e.from.col)}},r)}},{key:"destroy",value:function e(){this.clearLocalHooks()}}]);return t}();(0,s.mixin)(c,l.default);var d=c;t.default=d},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(19);t.__esModule=true;t.default=void 0;var i=n(r(1));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var f=n(r(2));var c=n(r(7));var a=n(r(22));var d=n(r(46));var h=r(4);var v=n(r(399));var p=n(r(25));var g=n(r(400));var m=n(r(187));var y=r(21);var b=r(32);var w=r(8);var C=r(89);r(561);d.default.getSingleton().register("afterContextMenuDefaultOptions");d.default.getSingleton().register("beforeContextMenuShow");d.default.getSingleton().register("afterContextMenuShow");d.default.getSingleton().register("afterContextMenuHide");d.default.getSingleton().register("afterContextMenuExecute");var S=function(e){(0,c.default)(a,e);(0,f.default)(a,null,[{key:"DEFAULT_ITEMS",get:function e(){return[C.ROW_ABOVE,C.ROW_BELOW,C.SEPARATOR,C.COLUMN_LEFT,C.COLUMN_RIGHT,C.SEPARATOR,C.REMOVE_ROW,C.REMOVE_COLUMN,C.SEPARATOR,C.UNDO,C.REDO,C.SEPARATOR,C.READ_ONLY,C.SEPARATOR,C.ALIGNMENT]}}]);function a(e){var t;(0,i.default)(this,a);t=(0,o.default)(this,(0,l.default)(a).call(this,e));t.eventManager=new p.default((0,s.default)(t));t.commandExecutor=new v.default(t.hot);t.itemsFactory=null;t.menu=null;return t}(0,f.default)(a,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}var t=this.hot.getSettings().contextMenu;if(typeof t.callback==="function"){this.commandExecutor.setCommonCallback(t.callback)}this.menu=new m.default(this.hot,{className:"htContextMenu",keepInViewport:true,container:t.uiContainer||this.hot.rootDocument.body});this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()});this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()});this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()});this.menu.addLocalHook("executeCommand",function(){var e;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=i.executeCommand).call.apply(e,[i].concat(r))});this.addHook("afterOnCellContextMenu",function(e){return i.onAfterOnCellContextMenu(e)});(0,u.default)((0,l.default)(a.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,u.default)((0,l.default)(a.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.close();if(this.menu){this.menu.destroy();this.menu=null}(0,u.default)((0,l.default)(a.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function e(t){if(!this.menu){return}this.prepareMenuItems();this.menu.open();if(!this.menu.isOpened()){return}var r=0;var n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var i=this.hot.rootWindow.frameElement;var a=i.getBoundingClientRect(),o=a.top,s=a.left;r=o-(0,w.getWindowScrollTop)(t.view);n=s-(0,w.getWindowScrollLeft)(t.view)}else{r=-1*(0,w.getWindowScrollTop)(this.menu.hotMenu.rootWindow);n=-1*(0,w.getWindowScrollLeft)(this.menu.hotMenu.rootWindow)}this.menu.setPosition({top:parseInt((0,b.pageY)(t),10)+r,left:parseInt((0,b.pageX)(t),10)+n});this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv}},{key:"close",value:function e(){if(!this.menu){return}this.menu.close();this.itemsFactory=null}},{key:"executeCommand",value:function e(t){var r;if(this.itemsFactory===null){this.prepareMenuItems()}for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++){i[a-1]=arguments[a]}(r=this.commandExecutor).execute.apply(r,[t].concat(i))}},{key:"prepareMenuItems",value:function e(){var t=this;this.itemsFactory=new g.default(this.hot,a.DEFAULT_ITEMS);var r=this.hot.getSettings().contextMenu;var n={items:this.itemsFactory.getItems(r)};this.hot.runHooks("afterContextMenuDefaultOptions",n);this.itemsFactory.setPredefinedItems(n.items);var i=this.itemsFactory.getItems(r);this.hot.runHooks("beforeContextMenuSetItems",i);this.menu.setMenuItems(i);(0,h.arrayEach)(i,function(e){return t.commandExecutor.registerCommand(e.key,e)})}},{key:"onAfterOnCellContextMenu",value:function e(t){var r=this.hot.getSettings();var n=r.rowHeaders;var i=r.colHeaders;function a(e){return e.nodeName==="TD"||e.parentNode.nodeName==="TD"}var o=t.realTarget;this.close();if((0,w.hasClass)(o,"handsontableInput")){return}t.preventDefault();(0,b.stopPropagation)(t);if(!(n||i)){if(!a(o)&&!((0,w.hasClass)(o,"current")&&(0,w.hasClass)(o,"wtBorder"))){return}}this.open(t)}},{key:"onMenuBeforeOpen",value:function e(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function e(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function e(){this.hot.listen();this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function e(){this.close();if(this.menu){this.menu.destroy()}(0,u.default)((0,l.default)(a.prototype),"destroy",this).call(this)}}]);return a}(a.default);S.SEPARATOR={name:C.SEPARATOR};(0,y.registerPlugin)("contextMenu",S);var E=S;t.default=E},function(e,t,r){"use strict";var n=r(9);r(12);t.__esModule=true;t.default=l;t.KEY=void 0;var o=r(66);var i=r(186);var a=n(r(11));var s="alignment";t.KEY=s;function l(){return{key:s,name:function e(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function e(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(s,":left"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htLeft")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="horizontal";var a="htLeft";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false},{key:"".concat(s,":center"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htCenter")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="horizontal";var a="htCenter";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false},{key:"".concat(s,":right"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htRight")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="horizontal";var a="htRight";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false},{key:"".concat(s,":justify"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htJustify")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="horizontal";var a="htJustify";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false},{name:i.KEY},{key:"".concat(s,":top"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htTop")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="vertical";var a="htTop";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false},{key:"".concat(s,":middle"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htMiddle")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="vertical";var a="htMiddle";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false},{key:"".concat(s,":bottom"),name:function e(){var n=this;var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);var r=(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){var r=n.getCellMeta(e,t).className;if(r&&r.indexOf("htBottom")!==-1){return true}});if(r){t=(0,o.markLabelAsSelected)(t)}return t},callback:function e(){var i=this;var t=this.getSelectedRange();var r=(0,o.getAlignmentClasses)(t,function(e,t){return i.getCellMeta(e,t).className});var n="vertical";var a="htBottom";this.runHooks("beforeCellAlignment",r,t,n,a);(0,o.align)(t,n,a,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});this.render()},disabled:false}]}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(54);t.__esModule=true;t.default=s;t.KEY=void 0;var l=i(r(18));var u=r(66);var a=n(r(11));var o="clear_column";t.KEY=o;function s(){return{key:o,name:function e(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function e(t,r){var n=r[0].start.col;if(this.countRows()){this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),n,"ContextMenu.clearColumn")}},disabled:function e(){var t=(0,u.getValidSelection)(this);if(!t){return true}var r=(0,l.default)(t[0],3),n=r[0],i=r[1],a=r[2];var o=[n,0,a,this.countCols()-1];var s=o.join(",")===t.join(",");return i<0||this.countCols()>=this.getSettings().maxCols||s}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(54);t.__esModule=true;t.default=s;t.KEY=void 0;var u=i(r(18));var f=r(66);var a=n(r(11));var o="col_left";t.KEY=o;function s(){return{key:o,name:function e(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function e(t,r){var n=r[Math.max(r.length-1,0)];this.alter("insert_col",n.start.col,1,"ContextMenu.columnLeft")},disabled:function e(){var t=(0,f.getValidSelection)(this);if(!t){return true}if(!this.isColumnModificationAllowed()){return true}var r=(0,u.default)(t[0],3),n=r[0],i=r[1],a=r[2];var o=[n,0,a,this.countCols()-1];var s=o.join(",")===t.join(",");var l=this.countCols()===1;return i<0||this.countCols()>=this.getSettings().maxCols||!l&&s},hidden:function e(){return!this.getSettings().allowInsertColumn}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(54);t.__esModule=true;t.default=s;t.KEY=void 0;var u=i(r(18));var f=r(66);var a=n(r(11));var o="col_right";t.KEY=o;function s(){return{key:o,name:function e(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function e(t,r){var n=r[Math.max(r.length-1,0)];this.alter("insert_col",n.end.col+1,1,"ContextMenu.columnRight")},disabled:function e(){var t=(0,f.getValidSelection)(this);if(!t){return true}if(!this.isColumnModificationAllowed()){return true}var r=(0,u.default)(t[0],3),n=r[0],i=r[1],a=r[2];var o=[n,0,a,this.countCols()-1];var s=o.join(",")===t.join(",");var l=this.countCols()===1;return i<0||this.countCols()>=this.getSettings().maxCols||!l&&s},hidden:function e(){return!this.getSettings().allowInsertColumn}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=l;t.KEY=void 0;var i=r(66);var a=r(4);var o=n(r(11));var s="make_read_only";t.KEY=s;function l(){return{key:s,name:function e(){var r=this;var t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_READ_ONLY);var n=(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(e,t){return r.getCellMeta(e,t).readOnly});if(n){t=(0,i.markLabelAsSelected)(t)}return t},callback:function e(){var r=this;var t=this.getSelectedRange();var n=(0,i.checkSelectionConsistency)(t,function(e,t){return r.getCellMeta(e,t).readOnly});(0,a.arrayEach)(t,function(e){e.forAll(function(e,t){r.setCellMeta(e,t,"readOnly",!n)})});this.render()},disabled:function e(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=o;t.KEY=void 0;var i=n(r(11));var a="redo";t.KEY=a;function o(){return{key:a,name:function e(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_REDO)},callback:function e(){this.redo()},disabled:function e(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=f;t.KEY=void 0;var o=i(r(18));var a=r(66);var s=r(152);var l=n(r(11));var u="remove_col";t.KEY=u;function f(){return{key:u,name:function e(){var t=this.getSelected();var r=0;if(t){if(t.length>1){r=1}else{var n=(0,o.default)(t[0],4),i=n[1],a=n[3];if(i-a!==0){r=1}}}return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_REMOVE_COLUMN,r)},callback:function e(){this.alter("remove_col",(0,s.transformSelectionToColumnDistance)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function e(){var t=(0,a.getValidSelection)(this);var r=this.countCols();if(!t){return true}return this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!r},hidden:function e(){return!this.getSettings().allowRemoveColumn}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=f;t.KEY=void 0;var o=i(r(18));var a=r(66);var s=r(152);var l=n(r(11));var u="remove_row";t.KEY=u;function f(){return{key:u,name:function e(){var t=this.getSelected();var r=0;if(t){if(t.length>1){r=1}else{var n=(0,o.default)(t[0],3),i=n[0],a=n[2];if(i-a!==0){r=1}}}return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_REMOVE_ROW,r)},callback:function e(){this.alter("remove_row",(0,s.transformSelectionToRowDistance)(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function e(){var t=(0,a.getValidSelection)(this);var r=this.countRows();if(!t){return true}return this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!r},hidden:function e(){return!this.getSettings().allowRemoveRow}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=s;t.KEY=void 0;var i=r(66);var a=n(r(11));var o="row_above";t.KEY=o;function s(){return{key:o,name:function e(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function e(t,r){var n=r[Math.max(r.length-1,0)];this.alter("insert_row",n.start.row,1,"ContextMenu.rowAbove")},disabled:function e(){var t=(0,i.getValidSelection)(this);if(!t){return true}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function e(){return!this.getSettings().allowInsertRow}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=s;t.KEY=void 0;var i=r(66);var a=n(r(11));var o="row_below";t.KEY=o;function s(){return{key:o,name:function e(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function e(t,r){var n=r[Math.max(r.length-1,0)];this.alter("insert_row",n.end.row+1,1,"ContextMenu.rowBelow")},disabled:function e(){var t=(0,i.getValidSelection)(this);if(!t){return true}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function e(){return!this.getSettings().allowInsertRow}}}},function(e,t,r){"use strict";t.__esModule=true;t.default=a;t.KEY=void 0;var n=r(11);var i="no_items";t.KEY=i;function a(){return{key:i,name:function e(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:true,isCommand:false}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=o;t.KEY=void 0;var i=n(r(11));var a="undo";t.KEY=a;function o(){return{key:a,name:function e(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNDO)},callback:function e(){this.undo()},disabled:function e(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var c=n(r(1));var i=n(r(2));var d=r(8);var h=r(32);var a=function(){function f(e,t){(0,c.default)(this,f);var r=(0,d.getWindowScrollTop)(t);var n=(0,d.getWindowScrollLeft)(t);var i;var a;var o;var s;var l;var u;this.rootWindow=t;this.type=this.getSourceType(e);if(this.type==="literal"){i=parseInt(e.top,10);o=parseInt(e.left,10);l=e.height||0;u=e.width||0;a=i;s=o;i+=r;o+=n}else if(this.type==="event"){i=parseInt((0,h.pageY)(e),10);o=parseInt((0,h.pageX)(e),10);l=e.target.clientHeight;u=e.target.clientWidth;a=i-r;s=o-n}this.top=i;this.topRelative=a;this.left=o;this.leftRelative=s;this.scrollTop=r;this.scrollLeft=n;this.cellHeight=l;this.cellWidth=u}(0,i.default)(f,[{key:"getSourceType",value:function e(t){var r="literal";if(t instanceof Event){r="event"}return r}},{key:"fitsAbove",value:function e(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=r}},{key:"fitsOnRight",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=r}},{key:"fitsOnLeft",value:function e(t){return this.leftRelative>=t.offsetWidth}}]);return f}();var o=a;t.default=o},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(54);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var c=n(r(18));var s=n(r(42));var i=n(r(1));var a=n(r(2));var l=n(r(6));var u=n(r(28));var f=n(r(5));var d=n(r(14));var h=n(r(7));var o=n(r(22));var v=n(r(46));var p=n(r(380));var g=r(4);var m=r(17);var y=r(8);var b=r(21);var w=n(r(563));var C=n(r(564));var S=n(r(565));var E=r(567);var k=r(183);r(569);v.default.getSingleton().register("afterCopyLimit");v.default.getSingleton().register("modifyCopyableRange");v.default.getSingleton().register("beforeCut");v.default.getSingleton().register("afterCut");v.default.getSingleton().register("beforePaste");v.default.getSingleton().register("afterPaste");v.default.getSingleton().register("beforeCopy");v.default.getSingleton().register("afterCopy");var T=1e3;var _=1e3;var x=new WeakMap;var D=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var R=function(e){(0,h.default)(o,e);function o(e){var t;(0,i.default)(this,o);t=(0,l.default)(this,(0,f.default)(o).call(this,e));t.columnsLimit=_;t.copyableRanges=[];t.focusableElement=void 0;t.pasteMode="overwrite";t.rowsLimit=T;t.uiContainer=t.hot.rootDocument.body;x.set((0,u.default)(t),{isTriggeredByCopy:false,isTriggeredByCut:false,isBeginEditing:false,isFragmentSelectionEnabled:false});return t}(0,a.default)(o,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}var r=this.hot.getSettings(),n=r.copyPaste,i=r.fragmentSelection;var a=x.get(this);a.isFragmentSelectionEnabled=!!i;if((0,s.default)(n)==="object"){this.pasteMode=n.pasteMode||this.pasteMode;this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit;this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit;this.uiContainer=n.uiContainer||this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)});this.addHook("afterOnCellMouseUp",function(){return t.onAfterOnCellMouseUp()});this.addHook("afterSelectionEnd",function(){return t.onAfterSelectionEnd()});this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown()});this.focusableElement=(0,E.createElement)(this.uiContainer);this.focusableElement.addLocalHook("copy",function(e){return t.onCopy(e)}).addLocalHook("cut",function(e){return t.onCut(e)}).addLocalHook("paste",function(e){return t.onPaste(e)});(0,d.default)((0,f.default)(o.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();this.getOrCreateFocusableElement();(0,d.default)((0,f.default)(o.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){if(this.focusableElement){(0,E.destroyElement)(this.focusableElement)}(0,d.default)((0,f.default)(o.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function e(){var t=x.get(this);t.isTriggeredByCopy=true;this.getOrCreateFocusableElement();this.focusableElement.focus();this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function e(){var t=x.get(this);t.isTriggeredByCut=true;this.getOrCreateFocusableElement();this.focusableElement.focus();this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function e(t){var n=this;var i=[];var r=[];var a=[];(0,g.arrayEach)(t,function(e){(0,m.rangeEach)(e.startRow,e.endRow,function(e){if(r.indexOf(e)===-1){r.push(e)}});(0,m.rangeEach)(e.startCol,e.endCol,function(e){if(a.indexOf(e)===-1){a.push(e)}})});(0,g.arrayEach)(r,function(t){var r=[];(0,g.arrayEach)(a,function(e){r.push(n.hot.getCopyableData(t,e))});i.push(r)});return p.default.stringify(i)}},{key:"getRangedData",value:function e(t){var n=this;var i=[];var r=[];var a=[];(0,g.arrayEach)(t,function(e){(0,m.rangeEach)(e.startRow,e.endRow,function(e){if(r.indexOf(e)===-1){r.push(e)}});(0,m.rangeEach)(e.startCol,e.endCol,function(e){if(a.indexOf(e)===-1){a.push(e)}})});(0,g.arrayEach)(r,function(t){var r=[];(0,g.arrayEach)(a,function(e){r.push(n.hot.getCopyableData(t,e))});i.push(r)});return i}},{key:"paste",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t;if(!t&&!r){return}var n=new S.default;if(t){n.clipboardData.setData("text/plain",t)}if(r){n.clipboardData.setData("text/html",r)}this.getOrCreateFocusableElement();this.onPaste(n)}},{key:"setCopyableText",value:function e(){var t=this.hot.getSelectedRangeLast();if(!t){return}var r=t.getTopLeftCorner();var n=t.getBottomRightCorner();var i=r.row;var a=r.col;var o=n.row;var s=n.col;var l=Math.min(o,i+this.rowsLimit-1);var u=Math.min(s,a+this.columnsLimit-1);this.copyableRanges.length=0;this.copyableRanges.push({startRow:i,startCol:a,endRow:l,endCol:u});this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);if(o!==l||s!==u){this.hot.runHooks("afterCopyLimit",o-i+1,s-a+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function e(){var t=this.hot.getActiveEditor();var r=t?t.TEXTAREA:void 0;if(r){this.focusableElement.setFocusableElement(r)}else{this.focusableElement.useSecondaryElement()}}},{key:"isEditorOpened",value:function e(){var t=this.hot.getActiveEditor();return t&&t.isOpened()}},{key:"populateValues",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.hot.getSelectedLast();if(!t.length){return}var n=t.length-1;var i=t[0].length-1;var a=Math.min(r[0],r[2]);var o=Math.max(r[0],r[2],n+a);var s=Math.min(r[1],r[3]);var l=Math.max(r[1],r[3],i+s);var u=[];for(var f=a,c=0;f<=o;f+=1){var d=[];for(var h=s,v=0;h<=l;h+=1){d.push(t[c][v]);v=v===i?0:v+=1}u.push(d);c=c===n?0:c+=1}this.hot.populateFromArray(a,s,u,void 0,void 0,"CopyPaste.paste",this.pasteMode);return[a,s,o,l]}},{key:"onCopy",value:function e(t){var r=x.get(this);if(!this.hot.isListening()&&!r.isTriggeredByCopy||this.isEditorOpened()){return}this.setCopyableText();r.isTriggeredByCopy=false;var n=this.getRangedData(this.copyableRanges);var i=!!this.hot.runHooks("beforeCopy",n,this.copyableRanges);if(i){var a=p.default.stringify(n);if(t&&t.clipboardData){var o=(0,k._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",a);t.clipboardData.setData("text/html",[D,o].join(""))}else if(typeof ClipboardEvent==="undefined"){this.hot.rootWindow.clipboardData.setData("Text",a)}this.hot.runHooks("afterCopy",n,this.copyableRanges)}t.preventDefault()}},{key:"onCut",value:function e(t){var r=x.get(this);if(!this.hot.isListening()&&!r.isTriggeredByCut||this.isEditorOpened()){return}this.setCopyableText();r.isTriggeredByCut=false;var n=this.getRangedData(this.copyableRanges);var i=!!this.hot.runHooks("beforeCut",n,this.copyableRanges);if(i){var a=p.default.stringify(n);if(t&&t.clipboardData){var o=(0,k._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",a);t.clipboardData.setData("text/html",[D,o].join(""))}else if(typeof ClipboardEvent==="undefined"){this.hot.rootWindow.clipboardData.setData("Text",a)}this.hot.emptySelectedCells("CopyPaste.cut");this.hot.runHooks("afterCut",n,this.copyableRanges)}t.preventDefault()}},{key:"onPaste",value:function e(t){if(!this.hot.isListening()||this.isEditorOpened()){return}if(t&&t.preventDefault){t.preventDefault()}var r;if(t&&typeof t.clipboardData!=="undefined"){var n=t.clipboardData.getData("text/html");if(n&&/(<table)|(<TABLE)/g.test(n)){var i=(0,k.htmlToGridSettings)(n,this.hot.rootDocument);r=i.data}else{r=t.clipboardData.getData("text/plain")}}else if(typeof ClipboardEvent==="undefined"&&typeof this.hot.rootWindow.clipboardData!=="undefined"){r=this.hot.rootWindow.clipboardData.getData("Text")}if(typeof r==="string"){r=p.default.parse(r)}if(r&&r.length===0){return}if(this.hot.runHooks("beforePaste",r,this.copyableRanges)===false){return}var a=this.populateValues(r),o=(0,c.default)(a,4),s=o[0],l=o[1],u=o[2],f=o[3];this.hot.selectCell(s,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,f));this.hot.runHooks("afterPaste",r,this.copyableRanges)}},{key:"onAfterContextMenuDefaultOptions",value:function e(t){t.items.push({name:"---------"},(0,w.default)(this),(0,C.default)(this))}},{key:"onAfterOnCellMouseUp",value:function e(){if(!this.hot.isListening()||this.isEditorOpened()){return}this.getOrCreateFocusableElement();this.focusableElement.focus()}},{key:"onAfterSelectionEnd",value:function e(){var t=x.get(this),r=t.isFragmentSelectionEnabled;if(this.isEditorOpened()){return}this.getOrCreateFocusableElement();if(r&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&(0,y.getSelectionText)()){return}this.setCopyableText();this.focusableElement.focus()}},{key:"onBeforeKeyDown",value:function e(){if(!this.hot.isListening()||this.isEditorOpened()){return}var t=this.hot.rootDocument.activeElement;var r=this.hot.getActiveEditor();if(!r||t!==this.focusableElement.getFocusableElement()&&t!==r.select){return}this.getOrCreateFocusableElement();this.focusableElement.focus()}},{key:"destroy",value:function e(){if(this.focusableElement){(0,E.destroyElement)(this.focusableElement);this.focusableElement=null}(0,d.default)((0,f.default)(o.prototype),"destroy",this).call(this)}}]);return o}(o.default);(0,b.registerPlugin)("CopyPaste",R);var I=R;t.default=I},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=a;var i=n(r(11));function a(t){return{key:"copy",name:function e(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_COPY)},callback:function e(){t.copy()},disabled:function e(){var t=this.getSelected();if(!t||t.length>1){return true}return false},hidden:false}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=a;var i=n(r(11));function a(t){return{key:"cut",name:function e(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_CUT)},callback:function e(){t.cut()},disabled:function e(){var t=this.getSelected();if(!t||t.length>1){return true}return false},hidden:false}}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(566));var o=function e(){(0,i.default)(this,e);this.clipboardData=new a.default};t.default=o},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function e(){(0,i.default)(this,e);this.data={}}(0,a.default)(e,[{key:"setData",value:function e(t,r){this.data[t]=r}},{key:"getData",value:function e(t){return this.data[t]||void 0}}]);return e}();t.default=o},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(568);r(16);t.__esModule=true;t.createElement=h;t.deactivateElement=v;t.destroyElement=b;var i=n(r(1));var a=n(r(2));var o=n(r(25));var s=n(r(62));var l=r(3);var u=r(71);var f=r(8);var c=function(){function t(e){(0,i.default)(this,t);this.rootDocument=e.defaultView?e:e.ownerDocument;this.mainElement=null;this.eventManager=new o.default(this);this.listenersCount=new WeakSet;this.container=e}(0,a.default)(t,[{key:"useSecondaryElement",value:function e(){var t=y(this.container);if(!this.listenersCount.has(t)){this.listenersCount.add(t);g(this.eventManager,t,this)}this.mainElement=t}},{key:"setFocusableElement",value:function e(t){if(!this.listenersCount.has(t)){this.listenersCount.add(t);g(this.eventManager,t,this)}this.mainElement=t}},{key:"getFocusableElement",value:function e(){return this.mainElement}},{key:"focus",value:function e(){this.mainElement.value=" ";if(!(0,u.isMobileBrowser)()){(0,f.selectElementIfAllowed)(this.mainElement)}}}]);return t}();(0,l.mixin)(c,s.default);var d=new WeakMap;function h(e){var t=new c(e);var r=d.get(e);r=isNaN(r)?0:r;d.set(e,r+1);return t}function v(e){e.eventManager.clear()}var p=function e(t,r){return function(e){return r.runLocalHooks(t,e)}};function g(e,t,r){e.addEventListener(t,"copy",p("copy",r));e.addEventListener(t,"cut",p("cut",r));e.addEventListener(t,"paste",p("paste",r))}var m=new WeakMap;function y(e){var t=m.get(e);if(t){if(!t.parentElement){e.appendChild(t)}return t}var r=e.defaultView?e:e.ownerDocument;var n=r.createElement("textarea");m.set(e,n);n.className="HandsontableCopyPaste";n.tabIndex=-1;n.autocomplete="off";n.wrap="hard";n.value=" ";e.appendChild(n);return n}function b(e){if(!(e instanceof c)){return}var t=d.get(e.container);t=isNaN(t)?0:t;if(t>0){t-=1}v(e);if(t<=0){t=0;var r=m.get(e.container);if(r&&r.parentNode){r.parentNode.removeChild(r);m.delete(e.container)}e.mainElement=null}d.set(e.container,t)}},function(e,t,r){"use strict";var n=r(137);var i=r(213);n("WeakSet",function(t){return function e(){return t(this,arguments.length?arguments[0]:undefined)}},i)},function(e,t,r){},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(12);r(33);r(396);r(65);r(374);t.__esModule=true;t.default=void 0;var h=i(r(18));var a=i(r(1));var o=i(r(2));var s=i(r(6));var l=i(r(5));var u=i(r(14));var f=i(r(7));var c=i(r(22));var d=r(21);var v=r(3);var p=r(17);var g=r(4);var m=r(27);var y=n(r(11));var b=r(571);var w=r(102);var C=r(389);var S=function(e){(0,f.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.savedBorders=[];return t}(0,o.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)});this.addHook("init",function(){return t.onAfterInit()});(0,u.default)((0,l.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.hideBorders();(0,u.default)((0,l.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();this.changeBorderSettings();(0,u.default)((0,l.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function e(t,u){var f=this;var r=["top","right","bottom","left"];var c=u?Object.keys(u):r;var n=(0,C.detectSelectionType)(t);var d=(0,C.normalizeSelectionFactory)(n);(0,g.arrayEach)(t,function(e){var t=d(e),r=(0,h.default)(t,4),n=r[0],i=r[1],a=r[2],o=r[3];var s=function e(r){var t=function e(t){(0,g.arrayEach)(c,function(e){f.prepareBorderFromCustomAdded(r,t,u,e)})};for(var n=i;n<=o;n+=1){t(n)}};for(var l=n;l<=a;l+=1){s(l)}});this.hot.view.render()}},{key:"getBorders",value:function e(t){var u=this;if(!Array.isArray(t)){return this.savedBorders}var r=(0,C.detectSelectionType)(t);var f=(0,C.normalizeSelectionFactory)(r);var c=[];(0,g.arrayEach)(t,function(e){var t=f(e),r=(0,h.default)(t,4),n=r[0],i=r[1],a=r[2],o=r[3];var s=function e(r){var t=function e(t){(0,g.arrayEach)(u.savedBorders,function(e){if(e.row===r&&e.col===t){c.push(e)}})};for(var n=i;n<=o;n+=1){t(n)}};for(var l=n;l<=a;l+=1){s(l)}});return c}},{key:"clearBorders",value:function e(t){var r=this;if(t){this.setBorders(t)}else{(0,g.arrayEach)(this.savedBorders,function(e){r.clearBordersFromSelectionSettings(e.id);r.clearNullCellRange();r.hot.removeCellMeta(e.row,e.col,"borders")});this.savedBorders.length=0}}},{key:"insertBorderIntoSettings",value:function e(t,r){var n=this.checkSavedBorders(t);if(!n){this.savedBorders.push(t)}var i={row:t.row,col:t.col};var a=new m.CellRange(i,i,i);var o=this.checkCustomSelections(t,a,r);if(!o){this.hot.selection.highlight.addCustomSelection({border:t,cellRange:a})}}},{key:"prepareBorderFromCustomAdded",value:function e(t,r,n,i){var a=(0,w.createEmptyBorders)(t,r);if(n){a=(0,w.extendDefaultBorder)(a,n);(0,g.arrayEach)(this.hot.selection.highlight.customSelections,function(e){if(a.id===e.settings.id){Object.assign(e.settings,n);a=e.settings;return false}})}this.hot.setCellMeta(t,r,"borders",a);this.insertBorderIntoSettings(a,i)}},{key:"prepareBorderFromCustomAddedRange",value:function e(i){var a=this;var o=i.range;(0,p.rangeEach)(o.from.row,o.to.row,function(n){(0,p.rangeEach)(o.from.col,o.to.col,function(e){var t=(0,w.createEmptyBorders)(n,e);var r=0;if(n===o.from.row){if((0,v.hasOwnProperty)(i,"top")){r+=1;t.top=i.top}}if(n===o.to.row){if((0,v.hasOwnProperty)(i,"bottom")){r+=1;t.bottom=i.bottom}}if(e===o.from.col){if((0,v.hasOwnProperty)(i,"left")){r+=1;t.left=i.left}}if(e===o.to.col){if((0,v.hasOwnProperty)(i,"right")){r+=1;t.right=i.right}}if(r>0){a.hot.setCellMeta(n,e,"borders",t);a.insertBorderIntoSettings(t)}else{}})})}},{key:"removeAllBorders",value:function e(t,r){var n=(0,w.createId)(t,r);this.spliceBorder(n);this.clearBordersFromSelectionSettings(n);this.clearNullCellRange();this.hot.removeCellMeta(t,r,"borders")}},{key:"setBorder",value:function e(t,r,n,i){var a=this.hot.getCellMeta(t,r).borders;if(!a||a.border===void 0){a=(0,w.createEmptyBorders)(t,r)}if(i){a[n]=(0,w.createSingleEmptyBorder)();var o=this.countHide(a);if(o===4){this.removeAllBorders(t,r)}else{var s=this.checkCustomSelectionsFromContextMenu(a,n,i);if(!s){this.insertBorderIntoSettings(a)}this.hot.setCellMeta(t,r,"borders",a)}}else{a[n]=(0,w.createDefaultCustomBorder)();var l=this.checkCustomSelectionsFromContextMenu(a,n,i);if(!l){this.insertBorderIntoSettings(a)}this.hot.setCellMeta(t,r,"borders",a)}}},{key:"prepareBorder",value:function e(t,i,a){var o=this;(0,g.arrayEach)(t,function(e){var r=e.start,n=e.end;if(r.row===n.row&&r.col===n.col){if(i==="noBorders"){o.removeAllBorders(r.row,r.col)}else{o.setBorder(r.row,r.col,i,a)}}else{switch(i){case"noBorders":(0,p.rangeEach)(r.col,n.col,function(t){(0,p.rangeEach)(r.row,n.row,function(e){o.removeAllBorders(e,t)})});break;case"top":(0,p.rangeEach)(r.col,n.col,function(e){o.setBorder(r.row,e,i,a)});break;case"right":(0,p.rangeEach)(r.row,n.row,function(e){o.setBorder(e,n.col,i,a)});break;case"bottom":(0,p.rangeEach)(r.col,n.col,function(e){o.setBorder(n.row,e,i,a)});break;case"left":(0,p.rangeEach)(r.row,n.row,function(e){o.setBorder(e,r.col,i,a)});break;default:break}}})}},{key:"createCustomBorders",value:function e(t){var r=this;(0,g.arrayEach)(t,function(e){if(e.range){r.prepareBorderFromCustomAddedRange(e)}else{r.prepareBorderFromCustomAdded(e.row,e.col,e)}})}},{key:"countHide",value:function e(t){var r=Object.values(t);return(0,g.arrayReduce)(r,function(e,t){var r=e;if(t.hide){r+=1}return r},0)}},{key:"clearBordersFromSelectionSettings",value:function e(t){var r=(0,g.arrayMap)(this.hot.selection.highlight.customSelections,function(e){return e.settings.id}).indexOf(t);if(r>-1){this.hot.selection.highlight.customSelections[r].clear()}}},{key:"clearNullCellRange",value:function e(){var r=this;(0,g.arrayEach)(this.hot.selection.highlight.customSelections,function(e,t){if(e.cellRange===null){r.hot.selection.highlight.customSelections[t].destroy();r.hot.selection.highlight.customSelections.splice(t,1);return false}})}},{key:"hideBorders",value:function e(){var t=this;(0,g.arrayEach)(this.savedBorders,function(e){t.clearBordersFromSelectionSettings(e.id);t.clearNullCellRange()})}},{key:"spliceBorder",value:function e(t){var r=(0,g.arrayMap)(this.savedBorders,function(e){return e.id}).indexOf(t);if(r>-1){this.savedBorders.splice(r,1)}}},{key:"checkSavedBorders",value:function e(r){var n=this;var i=false;var t=this.countHide(r);if(t===4){this.spliceBorder(r.id);i=true}else{(0,g.arrayEach)(this.savedBorders,function(e,t){if(r.id===e.id){n.savedBorders[t]=r;i=true;return false}})}return i}},{key:"checkCustomSelectionsFromContextMenu",value:function e(t,r,n){var i=false;(0,g.arrayEach)(this.hot.selection.highlight.customSelections,function(e){if(t.id===e.settings.id){(0,v.objectEach)(e.instanceBorders,function(e){e.toggleHiddenClass(r,n)});i=true;return false}});return i}},{key:"checkCustomSelections",value:function e(t,r,n){var i=this.countHide(t);var a=false;if(i===4){this.removeAllBorders(t.row,t.col);a=true}else{(0,g.arrayEach)(this.hot.selection.highlight.customSelections,function(e){if(t.id===e.settings.id){e.cellRange=r;if(n){(0,v.objectEach)(e.instanceBorders,function(e){e.changeBorderStyle(n,t)})}a=true;return false}})}return a}},{key:"changeBorderSettings",value:function e(){var t=this.hot.getSettings().customBorders;if(Array.isArray(t)){if(!t.length){this.savedBorders=t}this.createCustomBorders(t)}else if(t!==void 0){this.createCustomBorders(this.savedBorders)}}},{key:"onAfterContextMenuDefaultOptions",value:function e(t){if(!this.hot.getSettings().customBorders){return}t.items.push({name:"---------"},{key:"borders",name:function e(){return this.getTranslatedPhrase(y.CONTEXTMENU_ITEMS_BORDERS)},disabled:function e(){return this.selection.isSelectedByCorner()},submenu:{items:[(0,b.top)(this),(0,b.right)(this),(0,b.bottom)(this),(0,b.left)(this),(0,b.noBorders)(this)]}})}},{key:"onAfterInit",value:function e(){this.changeBorderSettings()}},{key:"destroy",value:function e(){(0,u.default)((0,l.default)(r.prototype),"destroy",this).call(this)}}]);return r}(c.default);(0,d.registerPlugin)("customBorders",S);var E=S;t.default=E},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;var i=n(r(572));t.bottom=i.default;var a=n(r(573));t.left=a.default;var o=n(r(574));t.noBorders=o.default;var s=n(r(575));t.right=s.default;var l=n(r(576));t.top=l.default},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=i;var a=n(r(11));var o=r(102);function i(i){return{key:"borders:bottom",name:function e(){var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);var r=(0,o.checkSelectionBorders)(this,"bottom");if(r){t=(0,o.markSelected)(t)}return t},callback:function e(t,r){var n=(0,o.checkSelectionBorders)(this,"bottom");i.prepareBorder(r,"bottom",n)}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=i;var a=n(r(11));var o=r(102);function i(i){return{key:"borders:left",name:function e(){var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_BORDERS_LEFT);var r=(0,o.checkSelectionBorders)(this,"left");if(r){t=(0,o.markSelected)(t)}return t},callback:function e(t,r){var n=(0,o.checkSelectionBorders)(this,"left");i.prepareBorder(r,"left",n)}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=o;var i=n(r(11));var a=r(102);function o(n){return{key:"borders:no_borders",name:function e(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function e(t,r){n.prepareBorder(r,"noBorders")},disabled:function e(){return!(0,a.checkSelectionBorders)(this)}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=i;var a=n(r(11));var o=r(102);function i(i){return{key:"borders:right",name:function e(){var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_BORDERS_RIGHT);var r=(0,o.checkSelectionBorders)(this,"right");if(r){t=(0,o.markSelected)(t)}return t},callback:function e(t,r){var n=(0,o.checkSelectionBorders)(this,"right");i.prepareBorder(r,"right",n)}}}},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.default=i;var a=n(r(11));var o=r(102);function i(i){return{key:"borders:top",name:function e(){var t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_BORDERS_TOP);var r=(0,o.checkSelectionBorders)(this,"top");if(r){t=(0,o.markSelected)(t)}return t},callback:function e(t,r){var n=(0,o.checkSelectionBorders)(this,"top");i.prepareBorder(r,"top",n)}}}},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(22));var d=n(r(25));var h=r(21);var v=r(32);var p=r(8);var g=function(e){(0,f.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,l.default)(r).call(this,e));t.eventManager=new d.default((0,s.default)(t));t.boundaries=null;t.callback=null;t.listening=false;return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}this.addHook("afterOnCellMouseDown",function(e){return t.setupListening(e)});this.addHook("afterOnCellCornerMouseDown",function(e){return t.setupListening(e)});this.registerEvents();(0,u.default)((0,l.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,u.default)((0,l.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.unregisterEvents();(0,u.default)((0,l.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function e(t){this.boundaries=t}},{key:"setCallback",value:function e(t){this.callback=t}},{key:"check",value:function e(t,r){var n=0;var i=0;if(r<this.boundaries.top){i=r-this.boundaries.top}else if(r>this.boundaries.bottom){i=r-this.boundaries.bottom}if(t<this.boundaries.left){n=t-this.boundaries.left}else if(t>this.boundaries.right){n=t-this.boundaries.right}this.callback(n,i)}},{key:"listen",value:function e(){this.listening=true}},{key:"unlisten",value:function e(){this.listening=false}},{key:"isListening",value:function e(){return this.listening}},{key:"registerEvents",value:function e(){var t=this;var r=this.hot.rootWindow;var n=r;while(n){this.eventManager.addEventListener(n.document,"contextmenu",function(){return t.unlisten()});this.eventManager.addEventListener(n.document,"mouseup",function(){return t.unlisten()});this.eventManager.addEventListener(n.document,"mousemove",function(e){return t.onMouseMove(e)});n=(0,p.getParentWindow)(n)}}},{key:"unregisterEvents",value:function e(){this.eventManager.clear()}},{key:"setupListening",value:function e(t){if((0,v.isRightClick)(t)){return}var r=this.hot.view.wt.wtTable.holder;if(r===this.hot.rootWindow){return}this.setBoundaries(r.getBoundingClientRect());this.setCallback(function(e,t){if(e<0){r.scrollLeft-=50}else if(e>0){r.scrollLeft+=50}if(t<0){r.scrollTop-=20}else if(t>0){r.scrollTop+=20}});this.listen()}},{key:"onMouseMove",value:function e(t){if(!this.isListening()){return}this.check(t.clientX,t.clientY)}},{key:"destroy",value:function e(){(0,u.default)((0,l.default)(r.prototype),"destroy",this).call(this)}}]);return r}(c.default);(0,h.registerPlugin)("dragToScroll",g);var m=g;t.default=m},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(22));var d=r(21);var h=r(4);var v=n(r(579));var p=n(r(580));r(581);var g=new WeakMap;var m=function(e){(0,f.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,l.default)(n).call(this,e));g.set((0,s.default)(t),{moveByFreeze:false,afterFirstUse:false});t.frozenColumnsBasePositions=[];t.manualColumnMovePlugin=void 0;return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}this.addHook("afterContextMenuDefaultOptions",function(e){return r.addContextMenuEntry(e)});this.addHook("afterInit",function(){return r.onAfterInit()});this.addHook("beforeColumnMove",function(e,t){return r.onBeforeColumnMove(e,t)});(0,u.default)((0,l.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){var t=g.get(this);t.afterFirstUse=false;t.moveByFreeze=false;(0,u.default)((0,l.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,u.default)((0,l.default)(n.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function e(t){var r=g.get(this);var n=this.hot.getSettings();if(!r.afterFirstUse){r.afterFirstUse=true}if(n.fixedColumnsLeft===this.hot.countCols()||t<=n.fixedColumnsLeft-1){return}r.moveByFreeze=true;if(t!==this.getMovePlugin().columnsMapper.getValueByIndex(t)){this.frozenColumnsBasePositions[n.fixedColumnsLeft]=t}this.getMovePlugin().moveColumn(t,n.fixedColumnsLeft);n.fixedColumnsLeft+=1}},{key:"unfreezeColumn",value:function e(t){var r=g.get(this);var n=this.hot.getSettings();if(!r.afterFirstUse){r.afterFirstUse=true}if(n.fixedColumnsLeft<=0||t>n.fixedColumnsLeft-1){return}var i=this.getBestColumnReturnPosition(t);r.moveByFreeze=true;n.fixedColumnsLeft-=1;this.getMovePlugin().moveColumn(t,i+1)}},{key:"getMovePlugin",value:function e(){if(!this.manualColumnMovePlugin){this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")}return this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function e(t){var r=this.getMovePlugin();var n=this.hot.getSettings();var i=n.fixedColumnsLeft;var a=r.columnsMapper.getValueByIndex(i);var o;if(this.frozenColumnsBasePositions[t]===null||this.frozenColumnsBasePositions[t]===void 0){o=r.columnsMapper.getValueByIndex(t);while(a!==null&&a<=o){i+=1;a=r.columnsMapper.getValueByIndex(i)}}else{o=this.frozenColumnsBasePositions[t];this.frozenColumnsBasePositions[t]=void 0;while(a!==null&&a<=o){i+=1;a=r.columnsMapper.getValueByIndex(i)}i=a}return i-1}},{key:"addContextMenuEntry",value:function e(t){t.items.push({name:"---------"},(0,v.default)(this),(0,p.default)(this))}},{key:"onAfterInit",value:function e(){if(!this.getMovePlugin().isEnabled()){this.getMovePlugin().enablePlugin()}}},{key:"onBeforeColumnMove",value:function e(t,r){var n=g.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var i=this.hot.getSettings().fixedColumnsLeft;var a=r<i;if(!a){(0,h.arrayEach)(t,function(e){if(e<i){a=true;return false}})}if(a){return false}}if(n.moveByFreeze){n.moveByFreeze=false}}},{key:"destroy",value:function e(){(0,u.default)((0,l.default)(n.prototype),"destroy",this).call(this)}}]);return n}(c.default);(0,d.registerPlugin)("manualColumnFreeze",m);var y=m;t.default=y},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=a;var o=i(r(18));var s=n(r(11));function a(a){return{key:"freeze_column",name:function e(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function e(t,r){var n=(0,o.default)(r,1),i=n[0].start.col;a.freezeColumn(i);this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},hidden:function e(){var t=this.getSelectedRange();var r=false;if(t===void 0){r=true}else if(t.length>1){r=true}else if(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsLeft-1){r=true}return r}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=a;var o=i(r(18));var s=n(r(11));function a(a){return{key:"unfreeze_column",name:function e(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function e(t,r){var n=(0,o.default)(r,1),i=n[0].start.col;a.unfreezeColumn(i);this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},hidden:function e(){var t=this.getSelectedRange();var r=false;if(t===void 0){r=true}else if(t.length>1){r=true}else if(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsLeft){r=true}return r}}}},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var s=n(r(37));var i=n(r(1));var a=n(r(2));var o=n(r(6));var l=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(7));var d=n(r(22));var h=n(r(46));var v=r(4);var E=r(8);var p=r(17);var g=n(r(25));var m=r(21);var y=n(r(583));var b=n(r(584));var w=n(r(585));r(586);h.default.getSingleton().register("beforeColumnMove");h.default.getSingleton().register("afterColumnMove");h.default.getSingleton().register("unmodifyCol");var k=new WeakMap;var C="ht__manualColumnMove";var T="show-ui";var _="on-moving--columns";var x="after-selection--columns";var S=function(e){(0,c.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,u.default)(r).call(this,e));k.set((0,l.default)(t),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}});t.removedColumns=[];t.columnsMapper=new y.default((0,l.default)(t));t.eventManager=new g.default((0,l.default)(t));t.backlight=new b.default(e);t.guideline=new w.default(e);return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}this.addHook("beforeOnCellMouseDown",function(e,t,r,n){return i.onBeforeOnCellMouseDown(e,t,r,n)});this.addHook("beforeOnCellMouseOver",function(e,t,r,n){return i.onBeforeOnCellMouseOver(e,t,r,n)});this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()});this.addHook("modifyCol",function(e,t){return i.onModifyCol(e,t)});this.addHook("beforeRemoveCol",function(e,t){return i.onBeforeRemoveCol(e,t)});this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol()});this.addHook("afterCreateCol",function(e,t){return i.onAfterCreateCol(e,t)});this.addHook("afterLoadData",function(){return i.onAfterLoadData()});this.addHook("unmodifyCol",function(e){return i.onUnmodifyCol(e)});this.registerEvents();(0,E.addClass)(this.hot.rootElement,C);(0,f.default)((0,u.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();(0,f.default)((0,u.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){var t=this.hot.getSettings().manualColumnMove;if(Array.isArray(t)){this.columnsMapper.clearMap()}(0,E.removeClass)(this.hot.rootElement,C);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();(0,f.default)((0,u.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function e(t,r){this.moveColumns([t],r)}},{key:"moveColumns",value:function e(t,n){var i=this;var r=(0,s.default)(t);var a=k.get(this);var o=this.hot.runHooks("beforeColumnMove",r,n);a.disallowMoving=!o;if(o!==false){(0,v.arrayEach)(t,function(e,t,r){r[t]=i.columnsMapper.getValueByIndex(e)});(0,v.arrayEach)(t,function(e,t){var r=i.columnsMapper.getIndexByValue(e);if(r!==n){i.columnsMapper.moveColumn(r,n+t)}});this.columnsMapper.clearNull();this.hot.runHooks("afterColumnMove",r,n)}}},{key:"changeSelection",value:function e(t,r){this.hot.selectColumns(t,r)}},{key:"getColumnsWidth",value:function e(t,r){var n=0;for(var i=t;i<r;i++){var a=0;if(i<0){a=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0}else{a=this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0}n+=a}return n}},{key:"initialSettings",value:function e(){var t=this.hot.getSettings().manualColumnMove;if(Array.isArray(t)){this.moveColumns(t,0)}else if(t!==void 0){this.persistentStateLoad()}}},{key:"isFixedColumnsLeft",value:function e(t){return t<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function e(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function e(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnMove",t);if(t.value){this.columnsMapper._arrayMap=t.value}}},{key:"prepareColumnsToMoving",value:function e(t,r){var n=[];(0,p.rangeEach)(t,r,function(e){n.push(e)});return n}},{key:"refreshPositions",value:function e(){var t=k.get(this);var r=this.hot.view.wt.wtTable.getFirstVisibleColumn();var n=this.hot.view.wt.wtTable.getLastVisibleColumn();var i=this.hot.view.wt.wtTable;var a=this.hot.view.wt.wtOverlays.scrollableElement;var o=typeof a.scrollX==="number"?a.scrollX:a.scrollLeft;var s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.coordsColumn);var l=t.target.eventPageX-(t.rootElementOffset-(a.scrollX===void 0?o:0));var u=i.hider.offsetWidth;var f=i.TBODY.offsetLeft;var c=this.backlight.getOffset().left;var d=this.backlight.getSize().width;var h=0;if(t.rootElementOffset+i.holder.offsetWidth+o<t.target.eventPageX){if(t.coordsColumn<t.countCols){t.coordsColumn+=1}}if(t.hasRowHeaders){h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth}if(this.isFixedColumnsLeft(t.coordsColumn)){s+=o}s+=h;if(t.coordsColumn<0){if(t.fixedColumns>0){t.target.col=0}else{t.target.col=r>0?r-1:r}}else if(t.target.TD.offsetWidth/2+s<=l){var v=t.coordsColumn>=t.countCols?t.countCols-1:t.coordsColumn;t.target.col=v+1;s+=t.target.TD.offsetWidth;if(t.target.col>n&&n<t.countCols){this.hot.scrollViewportTo(void 0,n+1,void 0,true)}}else{t.target.col=t.coordsColumn;if(t.target.col<=r&&t.target.col>=t.fixedColumns&&r>0){this.hot.scrollViewportTo(void 0,r-1)}}if(t.target.col<=r&&t.target.col>=t.fixedColumns&&r>0){this.hot.scrollViewportTo(void 0,r-1)}var p=l;var g=s;if(l+d+c>=u){p=u-d-c}else if(l+c<f+h){p=f+h+Math.abs(c)}if(s>=u-1){g=u-1}else if(g===0){g=1}else if(a.scrollX!==void 0&&t.coordsColumn<t.fixedColumns){g-=t.rootElementOffset<=a.scrollX?t.rootElementOffset:0}this.backlight.setPosition(null,p);this.guideline.setPosition(null,g)}},{key:"updateColumnsMapper",value:function e(){var t=this.hot.countSourceCols();var r=this.columnsMapper._arrayMap.length;if(r===0){this.columnsMapper.createMap(t||this.hot.getSettings().startCols)}else if(r<t){var n=t-r;this.columnsMapper.insertItems(r,n)}else if(r>t){var i=t-1;var a=[];(0,v.arrayEach)(this.columnsMapper._arrayMap,function(e,t){if(e>i){a.push(t)}});this.columnsMapper.removeItems(a)}}},{key:"registerEvents",value:function e(){var t=this;var r=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(r,"mousemove",function(e){return t.onMouseMove(e)});this.eventManager.addEventListener(r,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function e(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function e(t,r,n,i){var a=this.hot.view.wt.wtTable;var o=this.hot.selection.isSelectedByColumnHeader();var s=this.hot.getSelectedRangeLast();var l=k.get(this);var u=(0,E.hasClass)(t.realTarget,"sortAction");if(!s||!o||l.pressed||t.button!==0||u){l.pressed=false;l.columnsToMove.length=0;(0,E.removeClass)(this.hot.rootElement,[_,T]);return}var f=this.guideline.isBuilt()&&!this.guideline.isAppended();var c=this.backlight.isBuilt()&&!this.backlight.isAppended();if(f&&c){this.guideline.appendTo(a.hider);this.backlight.appendTo(a.hider)}var d=s.from,h=s.to;var v=Math.min(d.col,h.col);var p=Math.max(d.col,h.col);if(r.row<0&&r.col>=v&&r.col<=p){i.column=true;l.pressed=true;l.target.eventPageX=t.pageX;l.coordsColumn=r.col;l.target.TD=n;l.target.col=r.col;l.columnsToMove=this.prepareColumnsToMoving(v,p);l.hasRowHeaders=!!this.hot.getSettings().rowHeaders;l.countCols=this.hot.countCols();l.fixedColumns=this.hot.getSettings().fixedColumnsLeft;l.rootElementOffset=(0,E.offset)(this.hot.rootElement).left;var g=l.hasRowHeaders?-1:0;var m=a.holder.scrollTop+a.getColumnHeaderHeight(0)+1;var y=r.col<l.fixedColumns;var b=this.hot.view.wt.wtOverlays.scrollableElement;var w=b.scrollX?b.scrollX-l.rootElementOffset:0;var C=t.layerX-(y?w:0);var S=Math.abs(this.getColumnsWidth(v,r.col)+C);this.backlight.setPosition(m,this.getColumnsWidth(g,v)+S);this.backlight.setSize(this.getColumnsWidth(v,p+1),a.hider.offsetHeight-m);this.backlight.setOffset(null,S*-1);(0,E.addClass)(this.hot.rootElement,_)}else{(0,E.removeClass)(this.hot.rootElement,x);l.pressed=false;l.columnsToMove.length=0}}},{key:"onMouseMove",value:function e(t){var r=k.get(this);if(!r.pressed){return}if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0);setTimeout(function(){this.backlight.setPosition(n)})}r.target.eventPageX=t.pageX;this.refreshPositions()}},{key:"onBeforeOnCellMouseOver",value:function e(t,r,n,i){var a=this.hot.getSelectedRangeLast();var o=k.get(this);if(!a||!o.pressed){return}if(o.columnsToMove.indexOf(r.col)>-1){(0,E.removeClass)(this.hot.rootElement,T)}else{(0,E.addClass)(this.hot.rootElement,T)}i.row=true;i.column=true;i.cell=true;o.coordsColumn=r.col;o.target.TD=n}},{key:"onMouseUp",value:function e(){var t=k.get(this);t.coordsColumn=void 0;t.pressed=false;t.backlightWidth=0;(0,E.removeClass)(this.hot.rootElement,[_,T,x]);if(this.hot.selection.isSelectedByColumnHeader()){(0,E.addClass)(this.hot.rootElement,x)}if(t.columnsToMove.length<1||t.target.col===void 0||t.columnsToMove.indexOf(t.target.col)>-1){return}this.moveColumns(t.columnsToMove,t.target.col);this.persistentStateSave();this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize(true);if(!t.disallowMoving){var r=this.columnsMapper.getIndexByValue(t.columnsToMove[0]);var n=this.columnsMapper.getIndexByValue(t.columnsToMove[t.columnsToMove.length-1]);this.changeSelection(r,n)}t.columnsToMove.length=0}},{key:"onAfterScrollVertically",value:function e(){var t=this.hot.view.wt.wtTable;var r=t.getColumnHeaderHeight(0)+1;var n=t.holder.scrollTop;var i=r+n;this.backlight.setPosition(i);this.backlight.setSize(null,t.hider.offsetHeight-i)}},{key:"onAfterCreateCol",value:function e(t,r){this.columnsMapper.shiftItems(t,r)}},{key:"onBeforeRemoveCol",value:function e(t,r){var n=this;this.removedColumns.length=0;if(t!==false){(0,p.rangeEach)(t,t+r-1,function(e){n.removedColumns.push(n.hot.runHooks("modifyCol",e,n.pluginName))})}}},{key:"onAfterRemoveCol",value:function e(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function e(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function e(t,r){var n=t;if(r!==this.pluginName){var i=this.columnsMapper.getValueByIndex(n);n=i===null?n:i}return n}},{key:"onUnmodifyCol",value:function e(t){var r=this.columnsMapper.getIndexByValue(t);return r===null?t:r}},{key:"onAfterPluginsInitialized",value:function e(){this.updateColumnsMapper();this.initialSettings();this.backlight.build();this.guideline.build()}},{key:"destroy",value:function e(){this.backlight.destroy();this.guideline.destroy();(0,f.default)((0,u.default)(r.prototype),"destroy",this).call(this)}}]);return r}(d.default);(0,m.registerPlugin)("ManualColumnMove",S);var D=S;t.default=D},function(e,t,r){"use strict";var n=r(0);r(33);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(101));var s=r(4);var l=r(3);var u=r(17);var f=function(){function t(e){(0,i.default)(this,t);this.manualColumnMove=e}(0,a.default)(t,[{key:"createMap",value:function e(t){var r=this;var n=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0;(0,u.rangeEach)(n-1,function(e){r._arrayMap[e]=e})}},{key:"destroy",value:function e(){this._arrayMap=null}},{key:"moveColumn",value:function e(t,r){var n=this._arrayMap[t];this._arrayMap[t]=null;this._arrayMap.splice(r,0,n)}},{key:"clearNull",value:function e(){this._arrayMap=(0,s.arrayFilter)(this._arrayMap,function(e){return e!==null})}}]);return t}();(0,l.mixin)(f,o.default);var c=f;t.default=c},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(401));var c=r(8);var d="ht__manualColumnMove--backlight";var h=function(e){(0,u.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"build",value:function e(){(0,l.default)((0,s.default)(t.prototype),"build",this).call(this);(0,c.addClass)(this._element,d)}}]);return t}(f.default);var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(401));var c=r(8);var d="ht__manualColumnMove--guideline";var h=function(e){(0,u.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"build",value:function e(){(0,l.default)((0,s.default)(t.prototype),"build",this).call(this);(0,c.addClass)(this._element,d)}}]);return t}(f.default);var v=h;t.default=v},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(34);t.__esModule=true;t.default=void 0;var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(7));var i=n(r(22));var g=r(8);var d=n(r(25));var h=r(32);var v=r(4);var m=r(17);var p=r(21);var y=function(e){(0,c.default)(i,e);function i(e){var t;(0,a.default)(this,i);t=(0,s.default)(this,(0,u.default)(i).call(this,e));var r=t.hot.rootDocument;t.currentTH=null;t.currentCol=null;t.selectedCols=[];t.currentWidth=null;t.newSize=null;t.startY=null;t.startWidth=null;t.startOffset=null;t.handle=r.createElement("DIV");t.guide=r.createElement("DIV");t.eventManager=new d.default((0,l.default)(t));t.pressed=null;t.dblclick=0;t.autoresizeTimeout=null;t.manualColumnWidths=[];(0,g.addClass)(t.handle,"manualColumnResizer");(0,g.addClass)(t.guide,"manualColumnResizerGuide");return t}(0,o.default)(i,[{key:"isEnabled",value:function e(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function e(){var n=this;if(this.enabled){return}this.manualColumnWidths=[];var t=this.hot.getSettings().manualColumnResize;var r=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(e,t){return n.onModifyColWidth(e,t)});this.addHook("beforeStretchingColumnWidth",function(e,t){return n.onBeforeStretchingColumnWidth(e,t)});this.addHook("beforeColumnResize",function(e,t,r){return n.onBeforeColumnResize(e,t,r)});if(typeof r!=="undefined"){this.manualColumnWidths=r}else if(Array.isArray(t)){this.manualColumnWidths=t}else{this.manualColumnWidths=[]}this.bindEvents();(0,f.default)((0,u.default)(i.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){var t=this.hot.getSettings().manualColumnResize;if(Array.isArray(t)){this.manualColumnWidths=t}else if(!t){this.manualColumnWidths=[]}}},{key:"disablePlugin",value:function e(){(0,f.default)((0,u.default)(i.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function e(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function e(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnWidths",t);return t.value}},{key:"setupHandlePosition",value:function e(t){var r=this;if(!t.parentNode){return false}this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(this.currentTH);var i=n.col;var a=(0,g.outerHeight)(this.currentTH);if(i>=0){var o=this.currentTH.getBoundingClientRect();var s=i<this.hot.getSettings().fixedColumnsLeft;var l=s?this.hot.view.wt.wtOverlays.topLeftCornerOverlay:this.hot.view.wt.wtOverlays.topOverlay;var u=l.getRelativeCellPosition(this.currentTH,n.row,n.col);if(!u){var f=l.clone.wtTable.THEAD.lastChild.children[+!!this.hot.getSettings().rowHeaders+i];u=l.getRelativeCellPosition(f,n.row,n.col)}this.currentCol=i;this.selectedCols=[];if(this.hot.selection.isSelected()&&this.hot.selection.isSelectedByColumnHeader()){var c=this.hot.getSelectedRangeLast(),d=c.from,h=c.to;var v=d.col;var p=h.col;if(v>=p){v=h.col;p=d.col}if(this.currentCol>=v&&this.currentCol<=p){(0,m.rangeEach)(v,p,function(e){return r.selectedCols.push(e)})}else{this.selectedCols.push(this.currentCol)}}else{this.selectedCols.push(this.currentCol)}this.startOffset=u.left-6;this.startWidth=parseInt(o.width,10);this.handle.style.top="".concat(u.top,"px");this.handle.style.left="".concat(this.startOffset+this.startWidth,"px");this.handle.style.height="".concat(a,"px");this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function e(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function e(){var t=parseInt((0,g.outerHeight)(this.handle),10);var r=parseInt(this.handle.style.top,10)+t;var n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,g.addClass)(this.handle,"active");(0,g.addClass)(this.guide,"active");this.guide.style.top="".concat(r,"px");this.guide.style.left=this.handle.style.left;this.guide.style.height="".concat(n-t,"px");this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function e(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function e(){(0,g.removeClass)(this.handle,"active");(0,g.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function e(t){if(t!==this.hot.rootElement){var r=t.parentNode;if(r.tagName==="THEAD"){return true}return this.checkIfColumnHeader(r)}return false}},{key:"getTHFromTargetElement",value:function e(t){if(t.tagName!=="TABLE"){if(t.tagName==="TH"){return t}return this.getTHFromTargetElement(t.parentNode)}return null}},{key:"onMouseOver",value:function e(t){if(this.checkIfColumnHeader(t.target)){var r=this.getTHFromTargetElement(t.target);if(!r){return}var n=r.getAttribute("colspan");if(r&&(n===null||n===1)){if(!this.pressed){this.setupHandlePosition(r)}}}}},{key:"afterMouseDownTimeout",value:function e(){var i=this;var a=function e(){i.hot.forceFullRender=true;i.hot.view.render();i.hot.view.wt.wtOverlays.adjustElementsSize(true)};var t=function e(t,r){var n=i.hot.runHooks("beforeColumnResize",t,i.newSize,true);if(n!==void 0){i.newSize=n}if(i.hot.getSettings().stretchH==="all"){i.clearManualSize(t)}else{i.setManualSize(t,i.newSize)}if(r){a()}i.saveManualColumnWidths();i.hot.runHooks("afterColumnResize",t,i.newSize,true)};if(this.dblclick>=2){var r=this.selectedCols.length;if(r>1){(0,v.arrayEach)(this.selectedCols,function(e){t(e)});a()}else{(0,v.arrayEach)(this.selectedCols,function(e){t(e,true)})}}this.dblclick=0;this.autoresizeTimeout=null}},{key:"onMouseDown",value:function e(t){var r=this;if((0,g.hasClass)(t.target,"manualColumnResizer")){this.setupGuidePosition();this.pressed=this.hot;if(this.autoresizeTimeout===null){this.autoresizeTimeout=setTimeout(function(){return r.afterMouseDownTimeout()},500);this.hot._registerTimeout(this.autoresizeTimeout)}this.dblclick+=1;this.startX=(0,h.pageX)(t);this.newSize=this.startWidth}}},{key:"onMouseMove",value:function e(t){var r=this;if(this.pressed){this.currentWidth=this.startWidth+((0,h.pageX)(t)-this.startX);(0,v.arrayEach)(this.selectedCols,function(e){r.newSize=r.setManualSize(e,r.currentWidth)});this.refreshHandlePosition();this.refreshGuidePosition()}}},{key:"onMouseUp",value:function e(){var n=this;var i=function e(){n.hot.forceFullRender=true;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(true)};var t=function e(t,r){n.hot.runHooks("beforeColumnResize",t,n.newSize,false);if(r){i()}n.saveManualColumnWidths();n.hot.runHooks("afterColumnResize",t,n.newSize)};if(this.pressed){this.hideHandleAndGuide();this.pressed=false;if(this.newSize!==this.startWidth){var r=this.selectedCols.length;if(r>1){(0,v.arrayEach)(this.selectedCols,function(e){t(e)});i()}else{(0,v.arrayEach)(this.selectedCols,function(e){t(e,true)})}}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function e(){var t=this;var r=this.hot,n=r.rootWindow,i=r.rootElement;this.eventManager.addEventListener(i,"mouseover",function(e){return t.onMouseOver(e)});this.eventManager.addEventListener(i,"mousedown",function(e){return t.onMouseDown(e)});this.eventManager.addEventListener(n,"mousemove",function(e){return t.onMouseMove(e)});this.eventManager.addEventListener(n,"mouseup",function(){return t.onMouseUp()})}},{key:"setManualSize",value:function e(t,r){var n=Math.max(r,20);var i=this.hot.runHooks("modifyCol",t);this.manualColumnWidths[i]=n;return n}},{key:"clearManualSize",value:function e(t){var r=this.hot.runHooks("modifyCol",t);this.manualColumnWidths[r]=void 0}},{key:"onModifyColWidth",value:function e(t,r){var n=t;if(this.enabled){var i=this.hot.runHooks("modifyCol",r);var a=this.manualColumnWidths[i];if(this.hot.getSettings().manualColumnResize&&a){n=a}}return n}},{key:"onBeforeStretchingColumnWidth",value:function e(t,r){var n=this.manualColumnWidths[r];if(n===void 0){n=t}return n}},{key:"onBeforeColumnResize",value:function e(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]);return i}(i.default);(0,p.registerPlugin)("manualColumnResize",y);var b=y;t.default=b},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var s=n(r(37));var i=n(r(1));var a=n(r(2));var o=n(r(6));var l=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(7));var d=n(r(22));var h=n(r(46));var v=r(4);var b=r(8);var p=r(17);var g=n(r(25));var m=r(21);var y=n(r(589));var w=n(r(590));var C=n(r(591));r(592);h.default.getSingleton().register("beforeRowMove");h.default.getSingleton().register("afterRowMove");h.default.getSingleton().register("unmodifyRow");var S=new WeakMap;var E="ht__manualRowMove";var k="show-ui";var T="on-moving--rows";var _="after-selection--rows";var x=function(e){(0,c.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,u.default)(r).call(this,e));S.set((0,l.default)(t),{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}});t.removedRows=[];t.rowsMapper=new y.default((0,l.default)(t));t.eventManager=new g.default((0,l.default)(t));t.backlight=new w.default(e);t.guideline=new C.default(e);return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}this.addHook("beforeOnCellMouseDown",function(e,t,r,n){return i.onBeforeOnCellMouseDown(e,t,r,n)});this.addHook("beforeOnCellMouseOver",function(e,t,r,n){return i.onBeforeOnCellMouseOver(e,t,r,n)});this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()});this.addHook("modifyRow",function(e,t){return i.onModifyRow(e,t)});this.addHook("beforeRemoveRow",function(e,t){return i.onBeforeRemoveRow(e,t)});this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow()});this.addHook("afterCreateRow",function(e,t){return i.onAfterCreateRow(e,t)});this.addHook("afterLoadData",function(){return i.onAfterLoadData()});this.addHook("beforeColumnSort",function(e,t){return i.onBeforeColumnSort(e,t)});this.addHook("unmodifyRow",function(e){return i.onUnmodifyRow(e)});this.registerEvents();(0,b.addClass)(this.hot.rootElement,E);(0,f.default)((0,u.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();(0,f.default)((0,u.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t)){this.rowsMapper.clearMap()}(0,b.removeClass)(this.hot.rootElement,E);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();(0,f.default)((0,u.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function e(t,r){this.moveRows([t],r)}},{key:"moveRows",value:function e(t,n){var i=this;var r=(0,s.default)(t);var a=S.get(this);var o=this.hot.runHooks("beforeRowMove",r,n);a.disallowMoving=o===false;if(!a.disallowMoving){(0,v.arrayEach)(t,function(e,t,r){r[t]=i.rowsMapper.getValueByIndex(e)});(0,v.arrayEach)(t,function(e,t){var r=i.rowsMapper.getIndexByValue(e);if(r!==n){i.rowsMapper.moveRow(r,n+t)}});this.rowsMapper.clearNull()}this.hot.runHooks("afterRowMove",r,n)}},{key:"changeSelection",value:function e(t,r){this.hot.selectRows(t,r)}},{key:"getRowsHeight",value:function e(t,r){var n=0;for(var i=t;i<r;i++){var a=this.hot.view.wt.wtTable.getRowHeight(i)||23;n+=a}return n}},{key:"initialSettings",value:function e(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t)){this.moveRows(t,0)}else if(t!==void 0){var r=this.persistentStateLoad();if(r.length){this.moveRows(r,0)}}}},{key:"isFixedRowTop",value:function e(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function e(t){return t>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function e(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function e(){var t={};this.hot.runHooks("persistentStateLoad","manualRowMove",t);return t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function e(){var t=this.hot.getSelectedRangeLast();var r=[];if(!t){return r}var n=t.from,i=t.to;var a=Math.min(n.row,i.row);var o=Math.max(n.row,i.row);(0,p.rangeEach)(a,o,function(e){r.push(e)});return r}},{key:"refreshPositions",value:function e(){var t=S.get(this);var r=t.target.coords;var n=this.hot.view.wt.wtTable.getFirstVisibleRow();var i=this.hot.view.wt.wtTable.getLastVisibleRow();var a=this.hot.getSettings().fixedRowsTop;var o=this.hot.countRows();if(r.row<a&&n>0){this.hot.scrollViewportTo(n-1)}if(r.row>=i&&i<o){this.hot.scrollViewportTo(i+1,undefined,true)}var s=this.hot.view.wt.wtTable;var l=t.target.TD;var u=(0,b.offset)(this.hot.rootElement);var f=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,r.row);var c=t.target.eventPageY-u.top+s.holder.scrollTop;var d=s.hider.offsetHeight;var h=s.TBODY.offsetTop;var v=this.backlight.getOffset().top;var p=this.backlight.getSize().height;if(this.isFixedRowTop(r.row)){f+=s.holder.scrollTop}if(r.row<0){t.target.row=n>0?n-1:n}else if(l.offsetHeight/2+f<=c){t.target.row=r.row+1;f+=r.row===0?l.offsetHeight-1:l.offsetHeight}else{t.target.row=r.row}var g=c;var m=f;if(c+p+v>=d){g=d-p-v}else if(c+v<h){g=h+Math.abs(v)}if(f>=d-1){m=d-1}var y=0;if(this.hot.view.wt.wtOverlays.topOverlay){y=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight}if(r.row>=a&&m-s.holder.scrollTop<y){this.hot.scrollViewportTo(r.row)}this.backlight.setPosition(g);this.guideline.setPosition(m)}},{key:"updateRowsMapper",value:function e(){var t=this.hot.countSourceRows();var r=this.rowsMapper._arrayMap.length;if(r===0){this.rowsMapper.createMap(t||this.hot.getSettings().startRows)}else if(r<t){var n=t-r;this.rowsMapper.insertItems(r,n)}else if(r>t){var i=t-1;var a=[];(0,v.arrayEach)(this.rowsMapper._arrayMap,function(e,t){if(e>i){a.push(t)}});this.rowsMapper.removeItems(a)}}},{key:"registerEvents",value:function e(){var t=this;var r=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(r,"mousemove",function(e){return t.onMouseMove(e)});this.eventManager.addEventListener(r,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function e(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function e(t,r){var n=S.get(this);n.disallowMoving=r!==void 0}},{key:"onBeforeOnCellMouseDown",value:function e(t,r,n,i){var a=this.hot.view.wt,o=a.wtTable,s=a.wtViewport;var l=this.hot.selection.isSelectedByRowHeader();var u=this.hot.getSelectedRangeLast();var f=S.get(this);if(!u||!l||f.pressed||t.button!==0){f.pressed=false;f.rowsToMove.length=0;(0,b.removeClass)(this.hot.rootElement,[T,k]);return}var c=this.guideline.isBuilt()&&!this.guideline.isAppended();var d=this.backlight.isBuilt()&&!this.backlight.isAppended();if(c&&d){this.guideline.appendTo(o.hider);this.backlight.appendTo(o.hider)}var h=u.from,v=u.to;var p=Math.min(h.row,v.row);var g=Math.max(h.row,v.row);if(r.col<0&&r.row>=p&&r.row<=g){i.row=true;f.pressed=true;f.target.eventPageY=t.pageY;f.target.coords=r;f.target.TD=n;f.rowsToMove=this.prepareRowsToMoving();var m=o.holder.scrollLeft+s.getRowHeaderWidth();this.backlight.setPosition(null,m);this.backlight.setSize(o.hider.offsetWidth-m,this.getRowsHeight(p,g+1));this.backlight.setOffset((this.getRowsHeight(p,r.row)+t.layerY)*-1,null);(0,b.addClass)(this.hot.rootElement,T);this.refreshPositions()}else{(0,b.removeClass)(this.hot.rootElement,_);f.pressed=false;f.rowsToMove.length=0}}},{key:"onMouseMove",value:function e(t){var r=S.get(this);if(!r.pressed){return}if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0);setTimeout(function(){this.backlight.setPosition(null,n)})}r.target.eventPageY=t.pageY;this.refreshPositions()}},{key:"onBeforeOnCellMouseOver",value:function e(t,r,n,i){var a=this.hot.getSelectedRangeLast();var o=S.get(this);if(!a||!o.pressed){return}if(o.rowsToMove.indexOf(r.row)>-1){(0,b.removeClass)(this.hot.rootElement,k)}else{(0,b.addClass)(this.hot.rootElement,k)}i.row=true;i.column=true;i.cell=true;o.target.coords=r;o.target.TD=n}},{key:"onMouseUp",value:function e(){var t=S.get(this);var r=t.target.row;var n=t.rowsToMove.length;t.pressed=false;t.backlightHeight=0;(0,b.removeClass)(this.hot.rootElement,[T,k,_]);if(this.hot.selection.isSelectedByRowHeader()){(0,b.addClass)(this.hot.rootElement,_)}if(n<1||r===void 0||t.rowsToMove.indexOf(r)>-1||t.rowsToMove[n-1]===r-1){return}this.moveRows(t.rowsToMove,r);this.persistentStateSave();this.hot.render();if(!t.disallowMoving){var i=this.rowsMapper.getIndexByValue(t.rowsToMove[0]);var a=this.rowsMapper.getIndexByValue(t.rowsToMove[n-1]);this.changeSelection(i,a)}t.rowsToMove.length=0}},{key:"onAfterScrollHorizontally",value:function e(){var t=this.hot.view.wt.wtTable;var r=this.hot.view.wt.wtViewport.getRowHeaderWidth();var n=t.holder.scrollLeft;var i=r+n;this.backlight.setPosition(null,i);this.backlight.setSize(t.hider.offsetWidth-i)}},{key:"onAfterCreateRow",value:function e(t,r){this.rowsMapper.shiftItems(t,r)}},{key:"onBeforeRemoveRow",value:function e(t,r){var n=this;this.removedRows.length=0;if(t!==false){(0,p.rangeEach)(t,t+r-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e,n.pluginName))})}}},{key:"onAfterRemoveRow",value:function e(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function e(){this.updateRowsMapper()}},{key:"onModifyRow",value:function e(t,r){var n=t;if(r!==this.pluginName){var i=this.rowsMapper.getValueByIndex(n);n=i===null?n:i}return n}},{key:"onUnmodifyRow",value:function e(t){var r=this.rowsMapper.getIndexByValue(t);return r===null?t:r}},{key:"onAfterPluginsInitialized",value:function e(){this.updateRowsMapper();this.initialSettings();this.backlight.build();this.guideline.build()}},{key:"destroy",value:function e(){this.backlight.destroy();this.guideline.destroy();this.rowsMapper.destroy();(0,f.default)((0,u.default)(r.prototype),"destroy",this).call(this)}}]);return r}(d.default);(0,m.registerPlugin)("ManualRowMove",x);var D=x;t.default=D},function(e,t,r){"use strict";var n=r(0);r(33);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(101));var s=r(4);var l=r(3);var u=r(17);var f=function(){function t(e){(0,i.default)(this,t);this.manualRowMove=e}(0,a.default)(t,[{key:"createMap",value:function e(t){var r=this;var n=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0;(0,u.rangeEach)(n-1,function(e){r._arrayMap[e]=e})}},{key:"destroy",value:function e(){this._arrayMap=null}},{key:"moveRow",value:function e(t,r){var n=this._arrayMap[t];this._arrayMap[t]=null;this._arrayMap.splice(r,0,n)}},{key:"clearNull",value:function e(){this._arrayMap=(0,s.arrayFilter)(this._arrayMap,function(e){return e!==null})}}]);return t}();(0,l.mixin)(f,o.default);var c=f;t.default=c},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(402));var c=r(8);var d="ht__manualRowMove--backlight";var h=function(e){(0,u.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"build",value:function e(){(0,l.default)((0,s.default)(t.prototype),"build",this).call(this);(0,c.addClass)(this._element,d)}}]);return t}(f.default);var v=h;t.default=v},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(402));var c=r(8);var d="ht__manualRowMove--guideline";var h=function(e){(0,u.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"build",value:function e(){(0,l.default)((0,s.default)(t.prototype),"build",this).call(this);(0,c.addClass)(this._element,d)}}]);return t}(f.default);var v=h;t.default=v},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(34);t.__esModule=true;t.default=void 0;var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(7));var i=n(r(22));var m=r(8);var d=n(r(25));var h=r(32);var v=r(4);var y=r(17);var p=r(21);var g=function(e){(0,c.default)(i,e);function i(e){var t;(0,a.default)(this,i);t=(0,s.default)(this,(0,u.default)(i).call(this,e));var r=t.hot.rootDocument;t.currentTH=null;t.currentRow=null;t.selectedRows=[];t.currentHeight=null;t.newSize=null;t.startY=null;t.startHeight=null;t.startOffset=null;t.handle=r.createElement("DIV");t.guide=r.createElement("DIV");t.eventManager=new d.default((0,l.default)(t));t.pressed=null;t.dblclick=0;t.autoresizeTimeout=null;t.manualRowHeights=[];(0,m.addClass)(t.handle,"manualRowResizer");(0,m.addClass)(t.guide,"manualRowResizerGuide");return t}(0,o.default)(i,[{key:"isEnabled",value:function e(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}this.manualRowHeights=[];var t=this.hot.getSettings().manualRowResize;var n=this.loadManualRowHeights();if(typeof n!=="undefined"){this.manualRowHeights=n}else if(Array.isArray(t)){this.manualRowHeights=t}else{this.manualRowHeights=[]}this.addHook("modifyRowHeight",function(e,t){return r.onModifyRowHeight(e,t)});this.bindEvents();(0,f.default)((0,u.default)(i.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){var t=this.hot.getSettings().manualRowResize;if(Array.isArray(t)){this.manualRowHeights=t}else if(!t){this.manualRowHeights=[]}}},{key:"disablePlugin",value:function e(){(0,f.default)((0,u.default)(i.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function e(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function e(){var t={};this.hot.runHooks("persistentStateLoad","manualRowHeights",t);return t.value}},{key:"setupHandlePosition",value:function e(t){var r=this;this.currentTH=t;var n=this.hot.getCoords(this.currentTH);var i=n.row;var a=(0,m.outerWidth)(this.currentTH);if(i>=0){var o=this.currentTH.getBoundingClientRect();var s=i<this.hot.getSettings().fixedRowsTop;var l=i>=this.hot.countRows()-this.hot.getSettings().fixedRowsBottom;var u=this.hot.view.wt.wtOverlays.leftOverlay;if(s){u=this.hot.view.wt.wtOverlays.topLeftCornerOverlay}else if(l){u=this.hot.view.wt.wtOverlays.bottomLeftCornerOverlay}var f=u.getRelativeCellPosition(this.currentTH,n.row,n.col);if(!f){var c=u.clone.wtTable.TBODY.children[+!!this.hot.getSettings().colHeaders+i].firstChild;f=u.getRelativeCellPosition(c,n.row,n.col)}this.currentRow=i;this.selectedRows=[];if(this.hot.selection.isSelected()&&this.hot.selection.isSelectedByRowHeader()){var d=this.hot.getSelectedRangeLast(),h=d.from,v=d.to;var p=h.row;var g=v.row;if(p>=g){p=v.row;g=h.row}if(this.currentRow>=p&&this.currentRow<=g){(0,y.rangeEach)(p,g,function(e){return r.selectedRows.push(e)})}else{this.selectedRows.push(this.currentRow)}}else{this.selectedRows.push(this.currentRow)}this.startOffset=f.top-6;this.startHeight=parseInt(o.height,10);this.handle.style.top="".concat(this.startOffset+this.startHeight,"px");this.handle.style.left="".concat(f.left,"px");this.handle.style.width="".concat(a,"px");this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function e(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function e(){var t=parseInt((0,m.outerWidth)(this.handle),10);var r=parseInt(this.handle.style.left,10)+t;var n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,m.addClass)(this.handle,"active");(0,m.addClass)(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left="".concat(r,"px");this.guide.style.width="".concat(n-t,"px");this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function e(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function e(){(0,m.removeClass)(this.handle,"active");(0,m.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function e(t){if(t!==this.hot.rootElement){var r=t.parentNode;if(r.tagName==="TBODY"){return true}return this.checkIfRowHeader(r)}return false}},{key:"getTHFromTargetElement",value:function e(t){if(t.tagName!=="TABLE"){if(t.tagName==="TH"){return t}return this.getTHFromTargetElement(t.parentNode)}return null}},{key:"onMouseOver",value:function e(t){if(this.checkIfRowHeader(t.target)){var r=this.getTHFromTargetElement(t.target);if(r){if(!this.pressed){this.setupHandlePosition(r)}}}}},{key:"afterMouseDownTimeout",value:function e(){var i=this;var a=function e(){i.hot.forceFullRender=true;i.hot.view.render();i.hot.view.wt.wtOverlays.adjustElementsSize(true)};var t=function e(t,r){var n=i.hot.runHooks("beforeRowResize",t,i.newSize,true);if(n!==void 0){i.newSize=n}i.setManualSize(t,i.newSize);if(r){a()}i.hot.runHooks("afterRowResize",t,i.newSize,true)};if(this.dblclick>=2){var r=this.selectedRows.length;if(r>1){(0,v.arrayEach)(this.selectedRows,function(e){t(e)});a()}else{(0,v.arrayEach)(this.selectedRows,function(e){t(e,true)})}}this.dblclick=0;this.autoresizeTimeout=null}},{key:"onMouseDown",value:function e(t){var r=this;if((0,m.hasClass)(t.target,"manualRowResizer")){this.setupGuidePosition();this.pressed=this.hot;if(this.autoresizeTimeout===null){this.autoresizeTimeout=setTimeout(function(){return r.afterMouseDownTimeout()},500);this.hot._registerTimeout(this.autoresizeTimeout)}this.dblclick+=1;this.startY=(0,h.pageY)(t);this.newSize=this.startHeight}}},{key:"onMouseMove",value:function e(t){var r=this;if(this.pressed){this.currentHeight=this.startHeight+((0,h.pageY)(t)-this.startY);(0,v.arrayEach)(this.selectedRows,function(e){r.newSize=r.setManualSize(e,r.currentHeight)});this.refreshHandlePosition();this.refreshGuidePosition()}}},{key:"onMouseUp",value:function e(){var n=this;var i=function e(){n.hot.forceFullRender=true;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(true)};var t=function e(t,r){n.hot.runHooks("beforeRowResize",t,n.newSize);if(r){i()}n.saveManualRowHeights();n.hot.runHooks("afterRowResize",t,n.newSize,false)};if(this.pressed){this.hideHandleAndGuide();this.pressed=false;if(this.newSize!==this.startHeight){var r=this.selectedRows.length;if(r>1){(0,v.arrayEach)(this.selectedRows,function(e){t(e)});i()}else{(0,v.arrayEach)(this.selectedRows,function(e){t(e,true)})}}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function e(){var t=this;var r=this.hot,n=r.rootElement,i=r.rootWindow;this.eventManager.addEventListener(n,"mouseover",function(e){return t.onMouseOver(e)});this.eventManager.addEventListener(n,"mousedown",function(e){return t.onMouseDown(e)});this.eventManager.addEventListener(i,"mousemove",function(e){return t.onMouseMove(e)});this.eventManager.addEventListener(i,"mouseup",function(){return t.onMouseUp()})}},{key:"setManualSize",value:function e(t,r){var n=this.hot.runHooks("modifyRow",t);this.manualRowHeights[n]=r;return r}},{key:"onModifyRowHeight",value:function e(t,r){if(this.enabled){var n=this.hot.getPlugin("autoRowSize");var i=n?n.heights[r]:null;var a=this.hot.runHooks("modifyRow",r);var o=this.manualRowHeights[a];if(o!==void 0&&(o===i||o>(t||0))){return o}}return t}}]);return i}(i.default);(0,p.registerPlugin)("manualRowResize",g);var b=g;t.default=b},function(e,t,r){"use strict";var n=r(0);r(19);r(50);r(31);r(15);r(33);r(10);r(39);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var s=n(r(18));var l=n(r(37));var i=n(r(1));var a=n(r(2));var o=n(r(6));var u=n(r(28));var f=n(r(5));var c=n(r(14));var d=n(r(7));var h=n(r(22));var v=n(r(46));var p=r(21);var g=r(32);var m=r(27);var y=n(r(595));var b=n(r(188));var w=n(r(596));var C=n(r(597));var S=n(r(598));var E=r(4);var k=r(3);var T=r(61);var _=r(17);var x=r(403);r(599);v.default.getSingleton().register("beforeMergeCells");v.default.getSingleton().register("afterMergeCells");v.default.getSingleton().register("beforeUnmergeCells");v.default.getSingleton().register("afterUnmergeCells");var D=new WeakMap;var R=function(e){(0,d.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,f.default)(r).call(this,e));D.set((0,u.default)(t),{lastDesiredCoords:null});t.mergedCellsCollection=null;t.autofillCalculations=null;t.selectionCalculations=null;return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}this.mergedCellsCollection=new y.default(this);this.autofillCalculations=new w.default(this);this.selectionCalculations=new C.default(this);this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)});this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown.apply(t,arguments)});this.addHook("modifyTransformStart",function(){return t.onModifyTransformStart.apply(t,arguments)});this.addHook("afterModifyTransformStart",function(){return t.onAfterModifyTransformStart.apply(t,arguments)});this.addHook("modifyTransformEnd",function(){return t.onModifyTransformEnd.apply(t,arguments)});this.addHook("modifyGetCellCoords",function(){return t.onModifyGetCellCoords.apply(t,arguments)});this.addHook("beforeSetRangeEnd",function(){return t.onBeforeSetRangeEnd.apply(t,arguments)});this.addHook("afterIsMultipleSelection",function(){return t.onAfterIsMultipleSelection.apply(t,arguments)});this.addHook("afterRenderer",function(){return t.onAfterRenderer.apply(t,arguments)});this.addHook("afterContextMenuDefaultOptions",function(){return t.addMergeActionsToContextMenu.apply(t,arguments)});this.addHook("afterGetCellMeta",function(){return t.onAfterGetCellMeta.apply(t,arguments)});this.addHook("afterViewportRowCalculatorOverride",function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)});this.addHook("afterViewportColumnCalculatorOverride",function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)});this.addHook("modifyAutofillRange",function(){return t.onModifyAutofillRange.apply(t,arguments)});this.addHook("afterCreateCol",function(){return t.onAfterCreateCol.apply(t,arguments)});this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol.apply(t,arguments)});this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)});this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)});this.addHook("afterChange",function(){return t.onAfterChange.apply(t,arguments)});this.addHook("beforeDrawBorders",function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)});this.addHook("afterDrawSelection",function(){return t.onAfterDrawSelection.apply(t,arguments)});this.addHook("beforeRemoveCellClassNames",function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)});(0,c.default)((0,f.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.clearCollections();this.hot.render();(0,c.default)((0,f.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){var t=this.hot.getSettings().mergeCells;this.disablePlugin();this.enablePlugin();this.generateFromSettings(t);(0,c.default)((0,f.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function e(t){var r=true;if(!t){return false}if(b.default.containsNegativeValues(t)){(0,T.warn)(b.default.NEGATIVE_VALUES_WARNING(t));r=false}else if(b.default.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())){(0,T.warn)(b.default.IS_OUT_OF_BOUNDS_WARNING(t));r=false}else if(b.default.isSingleCell(t)){(0,T.warn)(b.default.IS_SINGLE_CELL(t));r=false}else if(b.default.containsZeroSpan(t)){(0,T.warn)(b.default.ZERO_SPAN_WARNING(t));r=false}return r}},{key:"generateFromSettings",value:function e(t){var i=this;if(Array.isArray(t)){var r;var a=[];(0,E.arrayEach)(t,function(e){if(!i.validateSetting(e)){return}var t=new m.CellCoords(e.row,e.col);var r=new m.CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1);var n=new m.CellRange(t,t,r);a.push(i.mergeRange(n,true,true))});a=a.filter(function(e){return e!==true});var n=this.getBulkCollectionData(a);(r=this.hot).populateFromArray.apply(r,(0,l.default)(n))}}},{key:"getBulkCollectionData",value:function e(t){var r;var a=this.getBulkCollectionDataRange(t);var n=(r=this.hot).getData.apply(r,(0,l.default)(a));var o=n.splice(0);(0,E.arrayEach)(t,function(e){var t=(0,s.default)(e,3),n=t[0],i=t[1],r=t[2];(0,E.arrayEach)(r,function(e,r){(0,E.arrayEach)(e,function(e,t){o[n-a[0]+r][i-a[1]+t]=e})})});return[a[0],a[1],o]}},{key:"getBulkCollectionDataRange",value:function e(t){var r=[0,0];var n=[0,0];var i=null;var a=null;var o=null;(0,E.arrayEach)(t,function(e){i=e[0];a=e[1];o=e[2];r[0]=Math.min(i,r[0]);r[1]=Math.min(a,r[1]);n[0]=Math.max(i+o.length-1,n[0]);n[1]=Math.max(a+o[0].length-1,n[1])});return[].concat(r,n)}},{key:"clearCollections",value:function e(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return r?true:this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function e(){var t=this.hot.getSelectedRangeLast();if(!t){return}t.setDirection("NW-SE");var r=t.from,n=t.to;this.toggleMerge(t);this.hot.selectCell(r.row,r.col,n.row,n.col,false)}},{key:"mergeSelection",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast();if(!t){return}t.setDirection("NW-SE");var r=t.from,n=t.to;this.unmergeRange(t,true);this.mergeRange(t);this.hot.selectCell(r.row,r.col,n.row,n.col,false)}},{key:"unmergeSelection",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast();if(!t){return}var r=t.from,n=t.to;this.unmergeRange(t,true);this.hot.selectCell(r.row,r.col,n.row,n.col,false)}},{key:"mergeRange",value:function e(t){var n=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=t.getTopLeftCorner();var o=t.getBottomRightCorner();var s={row:a.row,col:a.col,rowspan:o.row-a.row+1,colspan:o.col-a.col+1};var l=[];var u=null;if(!this.canMergeRange(s,r)){return false}this.hot.runHooks("beforeMergeCells",t,r);(0,_.rangeEach)(0,s.rowspan-1,function(r){(0,_.rangeEach)(0,s.colspan-1,function(e){var t=null;if(!l[r]){l[r]=[]}if(r===0&&e===0){t=n.hot.getDataAtCell(s.row,s.col)}else{n.hot.setCellMeta(s.row+r,s.col+e,"hidden",true)}l[r][e]=t})});this.hot.setCellMeta(s.row,s.col,"spanned",true);var f=this.mergedCellsCollection.add(s);if(f){if(i){u=[s.row,s.col,l]}else{this.hot.populateFromArray(s.row,s.col,l,void 0,void 0,this.pluginName)}this.hot.runHooks("afterMergeCells",t,s,r);return u}return true}},{key:"unmergeRange",value:function e(t){var n=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=this.mergedCellsCollection.getWithinRange(t);if(!i){return}this.hot.runHooks("beforeUnmergeCells",t,r);(0,E.arrayEach)(i,function(r){n.mergedCellsCollection.remove(r.row,r.col);(0,_.rangeEach)(0,r.rowspan-1,function(t){(0,_.rangeEach)(0,r.colspan-1,function(e){n.hot.removeCellMeta(r.row+t,r.col+e,"hidden")})});n.hot.removeCellMeta(r.row,r.col,"spanned")});this.hot.render();this.hot.runHooks("afterUnmergeCells",t,r)}},{key:"toggleMerge",value:function e(t){var r=this.mergedCellsCollection.get(t.from.row,t.from.col);var n=r.row===t.from.row&&r.col===t.from.col&&r.row+r.rowspan-1===t.to.row&&r.col+r.colspan-1===t.to.col;if(n){this.unmergeRange(t)}else{this.mergeSelection(t)}}},{key:"merge",value:function e(t,r,n,i){var a=new m.CellCoords(t,r);var o=new m.CellCoords(n,i);this.mergeRange(new m.CellRange(a,a,o))}},{key:"unmerge",value:function e(t,r,n,i){var a=new m.CellCoords(t,r);var o=new m.CellCoords(n,i);this.unmergeRange(new m.CellRange(a,a,o))}},{key:"onAfterInit",value:function e(){this.generateFromSettings(this.hot.getSettings().mergeCells);this.hot.render()}},{key:"onBeforeKeyDown",value:function e(t){var r=(t.ctrlKey||t.metaKey)&&!t.altKey;if(r&&t.keyCode===77){this.toggleMerge(this.hot.getSelectedRangeLast());this.hot.render();(0,g.stopImmediatePropagation)(t)}}},{key:"onAfterIsMultipleSelection",value:function e(t){if(t){var r=this.mergedCellsCollection.mergedCells;var n=this.hot.getSelectedRangeLast();for(var i=0;i<r.length;i+=1){if(n.highlight.row===r[i].row&&n.highlight.col===r[i].col&&n.to.row===r[i].row+r[i].rowspan-1&&n.to.col===r[i].col+r[i].colspan-1){return false}}}return t}},{key:"onModifyTransformStart",value:function e(t){var r=D.get(this);var n=this.hot.getSelectedRangeLast();var i={row:t.row,col:t.col};var a=null;var o=new m.CellCoords(n.highlight.row,n.highlight.col);var s=this.mergedCellsCollection.get(o.row,o.col);if(!r.lastDesiredCoords){r.lastDesiredCoords=new m.CellCoords(null,null)}if(s){var l=new m.CellCoords(s.row,s.col);var u=new m.CellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);var f=new m.CellRange(l,l,u);if(!f.includes(r.lastDesiredCoords)){r.lastDesiredCoords=new m.CellCoords(null,null)}i.row=r.lastDesiredCoords.row?r.lastDesiredCoords.row-o.row:i.row;i.col=r.lastDesiredCoords.col?r.lastDesiredCoords.col-o.col:i.col;if(t.row>0){i.row=s.row+s.rowspan-1-o.row+t.row}else if(t.row<0){i.row=o.row-s.row+t.row}if(t.col>0){i.col=s.col+s.colspan-1-o.col+t.col}else if(t.col<0){i.col=o.col-s.col+t.col}}a=new m.CellCoords(n.highlight.row+i.row,n.highlight.col+i.col);var c=this.mergedCellsCollection.get(a.row,a.col);if(c){r.lastDesiredCoords=a;i={row:c.row-o.row,col:c.col-o.col}}if(i.row!==0){t.row=i.row}if(i.col!==0){t.col=i.col}}},{key:"onModifyTransformEnd",value:function e(t){var r=this;var n=this.hot.getSelectedRangeLast();var i=(0,k.clone)(t);var a=this.selectionCalculations.getUpdatedSelectionRange(n,t);var o=(0,k.clone)(i);var s=this.mergedCellsCollection.getWithinRange(a,true);do{o=(0,k.clone)(i);this.selectionCalculations.getUpdatedSelectionRange(n,i);(0,E.arrayEach)(s,function(e){r.selectionCalculations.snapDelta(i,n,e)})}while(i.row!==o.row||i.col!==o.col);t.row=i.row;t.col=i.col}},{key:"onModifyGetCellCoords",value:function e(t,r){var n=this.mergedCellsCollection.get(t,r);return n?[n.row,n.col,n.row+n.rowspan-1,n.col+n.colspan-1]:void 0}},{key:"addMergeActionsToContextMenu",value:function e(t){t.items.push({name:"---------"},(0,S.default)(this))}},{key:"onAfterRenderer",value:function e(t,r,n){var i=this.mergedCellsCollection.get(r,n);(0,x.applySpanProperties)(t,i,r,n)}},{key:"onBeforeSetRangeEnd",value:function e(t){var r=this.hot.getSelectedRangeLast();r.highlight=new m.CellCoords(r.highlight.row,r.highlight.col);r.to=t;var n=false;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){return}do{n=false;for(var i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){var a=this.mergedCellsCollection.mergedCells[i];var o=a.getRange();if(r.expandByRange(o)){t.row=r.to.row;t.col=r.to.col;n=true}}}while(n)}},{key:"onAfterGetCellMeta",value:function e(t,r,n){var i=this.mergedCellsCollection.get(t,r);if(i){if(i.row!==t||i.col!==r){n.copyable=false}else{n.rowspan=i.rowspan;n.colspan=i.colspan}}}},{key:"onAfterViewportRowCalculatorOverride",value:function e(r){var n=this;var t=this.hot.countCols();var i;(0,_.rangeEach)(0,t-1,function(e){i=n.mergedCellsCollection.get(r.startRow,e);if(i){if(i.row<r.startRow){r.startRow=i.row;return n.onAfterViewportRowCalculatorOverride.call(n,r)}}i=n.mergedCellsCollection.get(r.endRow,e);if(i){var t=i.row+i.rowspan-1;if(t>r.endRow){r.endRow=t;return n.onAfterViewportRowCalculatorOverride.call(n,r)}}return true})}},{key:"onAfterViewportColumnCalculatorOverride",value:function e(r){var n=this;var t=this.hot.countRows();var i;(0,_.rangeEach)(0,t-1,function(e){i=n.mergedCellsCollection.get(e,r.startColumn);if(i&&i.col<r.startColumn){r.startColumn=i.col;return n.onAfterViewportColumnCalculatorOverride.call(n,r)}i=n.mergedCellsCollection.get(e,r.endColumn);if(i){var t=i.col+i.colspan-1;if(t>r.endColumn){r.endColumn=t;return n.onAfterViewportColumnCalculatorOverride.call(n,r)}}return true})}},{key:"onModifyAutofillRange",value:function e(t,r){this.autofillCalculations.correctSelectionAreaSize(r);var n=this.autofillCalculations.getDirection(r,t);var i=t;if(this.autofillCalculations.dragAreaOverlapsCollections(r,i,n)){i=r;return i}var a=this.mergedCellsCollection.getWithinRange({from:{row:r[0],col:r[1]},to:{row:r[2],col:r[3]}});if(!a){return i}i=this.autofillCalculations.snapDragArea(r,i,n,a);return i}},{key:"onAfterCreateCol",value:function e(t,r){this.mergedCellsCollection.shiftCollections("right",t,r)}},{key:"onAfterRemoveCol",value:function e(t,r){this.mergedCellsCollection.shiftCollections("left",t,r)}},{key:"onAfterCreateRow",value:function e(t,r,n){if(n==="auto"){return}this.mergedCellsCollection.shiftCollections("down",t,r)}},{key:"onAfterRemoveRow",value:function e(t,r){this.mergedCellsCollection.shiftCollections("up",t,r)}},{key:"onAfterChange",value:function e(t,r){if(r!=="Autofill.fill"){return}this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function e(t,r){if(r&&r==="area"){var n=this.hot.getSelectedRangeLast();var i=this.mergedCellsCollection.getWithinRange(n);(0,E.arrayEach)(i,function(e){if(n.getBottomRightCorner().row===e.getLastRow()&&n.getBottomRightCorner().col===e.getLastColumn()){t[2]=e.row;t[3]=e.col}})}}},{key:"onAfterModifyTransformStart",value:function e(t,r,n){if(!this.enabled){return}var i=this.mergedCellsCollection.get(t.row,t.col);if(!i){return}var a=r>0;var o=r<0;var s=n<0;var l=n>0;var u=i.row+i.rowspan-1===this.hot.countRows()-1;var f=i.row===0;var c=i.col+i.colspan-1===this.hot.countCols()-1;var d=i.col===0;if(a&&u||o&&f||l&&c||s&&d){t.row=i.row;t.col=i.col}}},{key:"onAfterDrawSelection",value:function e(t,r,n,i){return this.selectionCalculations.getSelectedMergedCellClassName(t,r,n,i)}},{key:"onBeforeRemoveCellClassNames",value:function e(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}]);return r}(h.default);(0,p.registerPlugin)("mergeCells",R);var I=R;t.default=I},function(e,t,r){"use strict";var n=r(0);r(12);r(33);t.__esModule=true;t.default=void 0;var i=n(r(72));var o=n(r(37));var a=n(r(1));var s=n(r(2));var c=n(r(188));var l=r(27);var u=r(17);var d=r(61);var h=r(4);var v=r(403);var p=r(73);function g(){var t=(0,i.default)(["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."]);g=function e(){return t};return t}var f=function(){function f(e){(0,a.default)(this,f);this.plugin=e;this.mergedCells=[];this.hot=e.hot}(0,s.default)(f,[{key:"get",value:function e(t,r){var n=this.mergedCells;var i=false;(0,h.arrayEach)(n,function(e){if(e.row<=t&&e.row+e.rowspan-1>=t&&e.col<=r&&e.col+e.colspan-1>=r){i=e;return false}return true});return i}},{key:"getByRange",value:function e(t){var r=this.mergedCells;var n=false;(0,h.arrayEach)(r,function(e){if(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col){n=e;return n}return true});return n}},{key:"getWithinRange",value:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=this.mergedCells;var a=[];var o=t;if(!o.includesRange){var n=new l.CellCoords(o.from.row,o.from.col);var s=new l.CellCoords(o.to.row,o.to.col);o=new l.CellRange(n,n,s)}(0,h.arrayEach)(r,function(e){var t=new l.CellCoords(e.row,e.col);var r=new l.CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1);var n=new l.CellRange(t,t,r);if(i){if(o.overlaps(n)){a.push(e)}}else if(o.includesRange(n)){a.push(e)}});return a.length?a:false}},{key:"add",value:function e(t){var r=this.mergedCells;var n=t.row;var i=t.col;var a=t.rowspan;var o=t.colspan;var s=new c.default(n,i,a,o);var l=this.get(n,i);var u=this.isOverlapping(s);if(!l&&!u){if(this.hot){s.normalize(this.hot)}r.push(s);return s}(0,d.warn)(f.IS_OVERLAPPING_WARNING(s));return false}},{key:"remove",value:function e(t,r){var n=this.mergedCells;var i=this.get(t,r);var a=i?this.mergedCells.indexOf(i):null;if(i&&a!==false){n.splice(a,1);return i}return false}},{key:"clear",value:function e(){var i=this;var t=this.mergedCells;var r=[];var a=[];(0,h.arrayEach)(t,function(e){var t=i.hot.getCell(e.row,e.col);if(t){r.push([t,i.get(e.row,e.col),e.row,e.col])}});this.mergedCells.length=0;(0,h.arrayEach)(r,function(n,e){(0,u.rangeEach)(0,n.rowspan-1,function(r){(0,u.rangeEach)(0,n.colspan-1,function(e){if(e!==0||r!==0){var t=i.hot.getCell(n.row+r,n.col+e);if(t){a.push([t,null,null,null])}}})});r[e][1]=null});(0,h.arrayEach)(r,function(e){v.applySpanProperties.apply(void 0,(0,o.default)(e))});(0,h.arrayEach)(a,function(e){v.applySpanProperties.apply(void 0,(0,o.default)(e))})}},{key:"isOverlapping",value:function e(t){var r=new l.CellRange(null,new l.CellCoords(t.row,t.col),new l.CellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));var n=false;(0,h.arrayEach)(this.mergedCells,function(e){var t=new l.CellRange(null,new l.CellCoords(e.row,e.col),new l.CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));if(t.overlaps(r)){n=true;return false}return true});return n}},{key:"isMergedParent",value:function e(t,r){var n=this.mergedCells;var i=false;(0,h.arrayEach)(n,function(e){if(e.row===t&&e.col===r){i=true;return false}return true});return i}},{key:"shiftCollections",value:function e(t,r,n){var i=this;var a=[0,0];switch(t){case"right":a[0]+=n;break;case"left":a[0]-=n;break;case"down":a[1]+=n;break;case"up":a[1]-=n;break;default:}(0,h.arrayEach)(this.mergedCells,function(e){e.shift(a,r)});(0,u.rangeEachReverse)(this.mergedCells.length-1,0,function(e){var t=i.mergedCells[e];if(t&&t.removed){i.mergedCells.splice(i.mergedCells.indexOf(t),1)}})}}],[{key:"IS_OVERLAPPING_WARNING",value:function e(t){return(0,p.toSingleLine)(g(),t.row,t.col)}}]);return f}();var m=f;t.default=m},function(e,t,r){"use strict";var n=r(0);r(12);r(41);t.__esModule=true;t.default=void 0;var T=n(r(18));var i=n(r(1));var a=n(r(2));var o=r(3);var h=r(27);var w=r(4);var s=function(){function t(e){(0,i.default)(this,t);this.plugin=e;this.mergedCellsCollection=this.plugin.mergedCellsCollection;this.currentFillData=null}(0,a.default)(t,[{key:"correctSelectionAreaSize",value:function e(t){if(t[0]===t[2]&&t[1]===t[3]){var r=this.mergedCellsCollection.get(t[0],t[1]);if(r){t[2]=t[0]+r.rowspan-1;t[3]=t[1]+r.colspan-1}}}},{key:"getDirection",value:function e(t,r){var n=null;if(r[0]===t[0]&&r[1]===t[1]&&r[3]===t[3]){n="down"}else if(r[2]===t[2]&&r[1]===t[1]&&r[3]===t[3]){n="up"}else if(r[1]===t[1]&&r[2]===t[2]){n="right"}else{n="left"}return n}},{key:"snapDragArea",value:function e(t,r,n,i){var a=r.slice(0);var o=this.getAutofillSize(t,r,n);var s=(0,T.default)(t,4),l=s[0],u=s[1],f=s[2],c=s[3];var d=["up","down"].indexOf(n)>-1;var h=d?f-l+1:c-u+1;var v=Math.floor(o/h)*h;var p=o-v;var g=this.getFarthestCollection(t,r,n,i);if(g){if(n==="down"){var m=g.row+g.rowspan-l-p;var y=a[2]+m;if(y>=this.plugin.hot.countRows()){a[2]-=p}else{a[2]+=p?m:0}}else if(n==="right"){var b=g.col+g.colspan-u-p;var w=a[3]+b;if(w>=this.plugin.hot.countCols()){a[3]-=p}else{a[3]+=p?b:0}}else if(n==="up"){var C=f-p-g.row+1;var S=a[0]+C;if(S<0){a[0]+=p}else{a[0]-=p?C:0}}else if(n==="left"){var E=c-p-g.col+1;var k=a[1]+E;if(k<0){a[1]+=p}else{a[1]-=p?E:0}}}this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:a,cycleLength:h});return a}},{key:"updateCurrentFillCache",value:function e(t){if(!this.currentFillData){this.currentFillData={}}(0,o.extend)(this.currentFillData,t)}},{key:"getAutofillSize",value:function e(t,r,n){var i=(0,T.default)(t,4),a=i[0],o=i[1],s=i[2],l=i[3];var u=(0,T.default)(r,4),f=u[0],c=u[1],d=u[2],h=u[3];switch(n){case"up":return a-f;case"down":return d-s;case"left":return o-c;case"right":return h-l;default:return null}}},{key:"getDragArea",value:function e(t,r,n){var i=(0,T.default)(t,4),a=i[0],o=i[1],s=i[2],l=i[3];var u=(0,T.default)(r,4),f=u[0],c=u[1],d=u[2],h=u[3];switch(n){case"up":return[f,c,a-1,l];case"down":return[s+1,o,d,l];case"left":return[f,c,s,o-1];case"right":return[a,l+1,d,h];default:return null}}},{key:"getFarthestCollection",value:function e(t,r,n,i){var a=(0,T.default)(t,4),o=a[0],s=a[1],l=a[2],u=a[3];var f=["up","down"].indexOf(n)>-1;var c=f?l:u;var d=f?o:s;var h=this.getAutofillSize(t,r,n);var v=f?l-o+1:u-s+1;var p=Math.floor(h/v)*v;var g=h-p;var m=null;var y=null;var b=null;switch(n){case"up":m="includesVertically";b=c-g+1;break;case"left":m="includesHorizontally";b=c-g+1;break;case"down":m="includesVertically";b=d+g-1;break;case"right":m="includesHorizontally";b=d+g-1;break;default:}(0,w.arrayEach)(i,function(e){if(e[m](b)&&e.isFarther(y,n)){y=e}});return y}},{key:"recreateAfterDataPopulation",value:function e(t){if(!this.currentFillData){return}var n=this.getRangeFromChanges(t);var r=this.currentFillData.foundMergedCells;var i=this.currentFillData.dragDirection;var a=function e(t,r){switch(i){case"up":return t.row-r>=n.from.row;case"down":return t.row+t.rowspan-1+r<=n.to.row;case"left":return t.col-r>=n.from.column;case"right":return t.col+t.colspan-1+r<=n.to.column;default:return null}};var o=0;var s=null;var l=1;do{for(var u=0;u<r.length;u+=1){s=r[u];o=l*this.currentFillData.cycleLength;if(a(s,o)){switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan});break;default:}}if(u===r.length-1){l+=1}}}while(a(s,o));this.currentFillData=null;this.plugin.hot.render()}},{key:"getRangeFromChanges",value:function e(t){var n=this;var i={min:null,max:null};var a={min:null,max:null};(0,w.arrayEach)(t,function(e){var t=e[0];var r=n.plugin.hot.propToCol(e[1]);if(i.min===null||t<i.min){i.min=t}if(i.max===null||t>i.max){i.max=t}if(a.min===null||r<a.min){a.min=r}if(a.max===null||r>a.max){a.max=r}});return{from:{row:i.min,column:a.min},to:{row:i.max,column:a.max}}}},{key:"dragAreaOverlapsCollections",value:function e(t,r,n){var i=this.getDragArea(t,r,n);var a=(0,T.default)(i,4),o=a[0],s=a[1],l=a[2],u=a[3];var f=new h.CellCoords(o,s);var c=new h.CellCoords(l,u);var d=new h.CellRange(f,f,c);return!!this.mergedCellsCollection.getWithinRange(d,true)}}]);return t}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(0);r(19);r(31);r(39);t.__esModule=true;t.default=void 0;var d=n(r(18));var i=n(r(1));var a=n(r(2));var u=r(27);var o=function(){function t(e){(0,i.default)(this,t);this.plugin=e;this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}(0,a.default)(t,[{key:"snapDelta",value:function e(t,r,n){var i=r.to;var a=i.row+t.row;var o=i.col+t.col;if(t.row){this.jumpOverMergedCell(t,n,a)}else if(t.col){this.jumpOverMergedCell(t,n,o)}}},{key:"jumpOverMergedCell",value:function e(t,r,n){var i=t.row||t.col;var a=null;var o=null;var s=null;if(t.row){a=r.includesVertically(n);o=r.row;s=r.getLastRow()}else if(t.col){a=r.includesHorizontally(n);o=r.col;s=r.getLastColumn()}if(i===0){return}else if(i>0){if(a&&n!==o){i+=s-n+1}}else if(a&&n!==s){i-=n-o+1}if(t.row){t.row=i}else if(t.col){t.col=i}}},{key:"getUpdatedSelectionRange",value:function e(t,r){return new u.CellRange(t.highlight,t.from,new u.CellCoords(t.to.row+r.row,t.to.col+r.col))}},{key:"getSelectedMergedCellClassName",value:function e(t,r,n,i){var a=(0,d.default)(n,4),o=a[0],s=a[1],l=a[2],u=a[3];if(i===void 0){return}if(t>=o&&t<=l&&r>=s&&r<=u){var f=this.plugin.mergedCellsCollection.isMergedParent(t,r);if(!f){return}var c=this.plugin.mergedCellsCollection.get(t,r);if(!c){return}if(c.row+c.rowspan-1<=l&&c.col+c.colspan-1<=u){return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i)}else if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange())){return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}},{key:"isMergeCellFullySelected",value:function e(t,r){var n=[];if(!r||!t){return false}for(var i=0;i<t.rowspan;i+=1){for(var a=0;a<t.colspan;a+=1){n.push(new u.CellCoords(t.row+i,t.col+a))}}for(var o=0;o<n.length;o+=1){var s=[];for(var l=0;l<r.length;l+=1){s[l]=r[l].includes(n[o])}if(!s.includes(true)){return false}}return true}},{key:"getSelectedMergedCellClassNameToRemove",value:function e(){var t=[];for(var r=0;r<=7;r+=1){t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(r))}t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple"));return t}}]);return t}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);var i=r(9);t.__esModule=true;t.default=s;var a=i(r(11));var o=n(r(188));function s(n){return{key:"mergeCells",name:function e(){var t=this.getSelectedLast();if(t){var r=n.mergedCellsCollection.get(t[0],t[1]);if(r.row===t[0]&&r.col===t[1]&&r.row+r.rowspan-1===t[2]&&r.col+r.colspan-1===t[3]){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}}return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function e(){n.toggleMergeOnSelection()},disabled:function e(){var t=this.getSelectedLast();if(!t){return true}var r=o.default.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return r||this.selection.isSelectedByCorner()},hidden:false}}},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(12);r(41);r(33);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var p=r(8);var f=r(71);var c=n(r(22));var d=n(r(25));var h=r(21);var v=r(27);var g=function(e){(0,u.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,s.default)(r).call(this,e));t.dragged=[];t.eventManager=null;t.lastSetCell=null;return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return(0,f.isMobileBrowser)()}},{key:"enablePlugin",value:function e(){if(this.enabled){return}if(!this.eventManager){this.eventManager=new d.default(this)}this.registerListeners();(0,l.default)((0,s.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"registerListeners",value:function e(){var h=this;var v=this;var t=this.hot.rootElement;function r(e){if(v.dragged.length===1){v.dragged.splice(0,v.dragged.length);return true}var t=v.dragged.indexOf(e);if(t===-1){return false}else if(t===0){v.dragged=v.dragged.slice(0,1)}else if(t===1){v.dragged=v.dragged.slice(-1)}}this.eventManager.addEventListener(t,"touchstart",function(e){var t;if((0,p.hasClass)(e.target,"topLeftSelectionHandle-HitArea")){t=v.hot.getSelectedRangeLast();v.dragged.push("topLeft");v.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()};e.preventDefault();return false}else if((0,p.hasClass)(e.target,"bottomRightSelectionHandle-HitArea")){t=v.hot.getSelectedRangeLast();v.dragged.push("bottomRight");v.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()};e.preventDefault();return false}});this.eventManager.addEventListener(t,"touchend",function(e){if((0,p.hasClass)(e.target,"topLeftSelectionHandle-HitArea")){r.call(v,"topLeft");v.touchStartRange=void 0;e.preventDefault();return false}else if((0,p.hasClass)(e.target,"bottomRightSelectionHandle-HitArea")){r.call(v,"bottomRight");v.touchStartRange=void 0;e.preventDefault();return false}});this.eventManager.addEventListener(t,"touchmove",function(e){var t=h.hot,r=t.rootWindow,n=t.rootDocument;var i=(0,p.getWindowScrollTop)(r);var a=(0,p.getWindowScrollLeft)(r);var o;var s;var l;var u;var f;var c;if(v.dragged.length===0){return}var d=n.elementFromPoint(e.touches[0].screenX-a,e.touches[0].screenY-i);if(!d||d===v.lastSetCell){return}if(d.nodeName==="TD"||d.nodeName==="TH"){o=v.hot.getCoords(d);if(o.col===-1){o.col=0}s=v.hot.getSelectedRangeLast();l=s.getWidth();u=s.getHeight();f=s.getDirection();if(l===1&&u===1){v.hot.selection.setRangeEnd(o)}c=v.getCurrentRangeCoords(s,o,v.touchStartRange.direction,f,v.dragged[0]);if(c.start!==null){v.hot.selection.setRangeStart(c.start)}v.hot.selection.setRangeEnd(c.end);v.lastSetCell=d}e.preventDefault()})}},{key:"getCurrentRangeCoords",value:function e(t,r,n,i,a){var o=t.getTopLeftCorner();var s=t.getBottomRightCorner();var l=t.getBottomLeftCorner();var u=t.getTopRightCorner();var f={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":if(a==="topLeft"){f={start:new v.CellCoords(r.row,t.highlight.col),end:new v.CellCoords(l.row,r.col)}}else{f={start:new v.CellCoords(t.highlight.row,r.col),end:new v.CellCoords(r.row,o.col)}}break;case"SE-NW":if(a==="bottomRight"){f={start:new v.CellCoords(s.row,r.col),end:new v.CellCoords(r.row,o.col)}}break;default:break}break;case"NW-SE":switch(i){case"NE-SW":if(a==="topLeft"){f={start:r,end:l}}else{f.end=r}break;case"NW-SE":if(a==="topLeft"){f={start:r,end:s}}else{f.end=r}break;case"SE-NW":if(a==="topLeft"){f={start:r,end:o}}else{f.end=r}break;case"SW-NE":if(a==="topLeft"){f={start:r,end:u}}else{f.end=r}break;default:break}break;case"SW-NE":switch(i){case"NW-SE":if(a==="bottomRight"){f={start:new v.CellCoords(r.row,o.col),end:new v.CellCoords(l.row,r.col)}}else{f={start:new v.CellCoords(o.row,r.col),end:new v.CellCoords(r.row,s.col)}}break;case"SW-NE":if(a==="topLeft"){f={start:new v.CellCoords(t.highlight.row,r.col),end:new v.CellCoords(r.row,s.col)}}else{f={start:new v.CellCoords(r.row,o.col),end:new v.CellCoords(o.row,r.col)}}break;case"SE-NW":if(a==="bottomRight"){f={start:new v.CellCoords(r.row,u.col),end:new v.CellCoords(o.row,r.col)}}else if(a==="topLeft"){f={start:l,end:r}}break;default:break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":if(a==="topLeft"){f.end=r}break;case"SE-NW":if(a==="topLeft"){f.end=r}else{f={start:r,end:o}}break;default:break}break;default:break}return f}},{key:"isDragged",value:function e(){return this.dragged.length>0}}]);return r}(c.default);(0,h.registerPlugin)("multipleSelectionHandles",g);var m=g;t.default=m},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(22));var c=n(r(602));var d=r(4);var h=r(21);var v=function(e){(0,u.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,s.default)(n).call(this,e));t.observer=null;return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}if(!this.observer){this.observer=new c.default(this.hot.getSourceData());this._exposePublicApi()}this.observer.addLocalHook("change",function(e){return r.onDataChange(e)});this.addHook("afterCreateRow",function(){return r.onAfterTableAlter()});this.addHook("afterRemoveRow",function(){return r.onAfterTableAlter()});this.addHook("afterCreateCol",function(){return r.onAfterTableAlter()});this.addHook("afterRemoveCol",function(){return r.onAfterTableAlter()});this.addHook("afterChange",function(e,t){return r.onAfterTableAlter(t)});this.addHook("afterLoadData",function(e){return r.onAfterLoadData(e)});(0,l.default)((0,s.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){if(this.observer){this.observer.destroy();this.observer=null;this._deletePublicApi()}(0,l.default)((0,s.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function e(t){var r=this;if(!this.observer.isPaused()){var n="".concat(this.pluginName,".change");var i={add:function e(t){if(isNaN(t.col)){r.hot.runHooks("afterCreateRow",t.row,1,n)}else{r.hot.runHooks("afterCreateCol",t.col,1,n)}},remove:function e(t){if(isNaN(t.col)){r.hot.runHooks("afterRemoveRow",t.row,1,n)}else{r.hot.runHooks("afterRemoveCol",t.col,1,n)}},replace:function e(t){r.hot.runHooks("afterChange",[[t.row,t.col,null,t.value]],n)}};(0,d.arrayEach)(t,function(e){if(i[e.op]){i[e.op](e)}});this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function e(t){var r=this;if(t!=="loadData"){this.observer.pause();this.hot.addHookOnce("afterChangesObserved",function(){return r.observer.resume()})}}},{key:"onAfterLoadData",value:function e(t){if(!t){this.observer.setObservedData(this.hot.getSourceData())}}},{key:"destroy",value:function e(){if(this.observer){this.observer.destroy();this._deletePublicApi()}(0,l.default)((0,s.default)(n.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function e(){var t=this;var r=this.hot;r.pauseObservingChanges=function(){return t.observer.pause()};r.resumeObservingChanges=function(){return t.observer.resume()};r.isPausedObservingChanges=function(){return t.observer.isPaused()}}},{key:"_deletePublicApi",value:function e(){var t=this.hot;delete t.pauseObservingChanges;delete t.resumeObservingChanges;delete t.isPausedObservingChanges}}]);return n}(f.default);var p=v;t.default=p;(0,h.registerPlugin)("observeChanges",v)},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(603));var s=n(r(62));var l=r(3);var u=r(604);var f=function(){function t(e){(0,i.default)(this,t);this.observedData=null;this.observer=null;this.paused=false;this.setObservedData(e)}(0,a.default)(t,[{key:"setObservedData",value:function e(t){var r=this;if(this.observer){o.default.unobserve(this.observedData,this.observer)}this.observedData=t;this.observer=o.default.observe(this.observedData,function(e){return r.onChange(e)})}},{key:"isPaused",value:function e(){return this.paused}},{key:"pause",value:function e(){this.paused=true}},{key:"resume",value:function e(){this.paused=false}},{key:"onChange",value:function e(t){this.runLocalHooks("change",(0,u.cleanPatches)(t))}},{key:"destroy",value:function e(){o.default.unobserve(this.observedData,this.observer);this.observedData=null;this.observer=null}}]);return t}();(0,l.mixin)(f,s.default);var c=f;t.default=c},function(e,t,r){"use strict";var n=r(0);r(12);r(54);r(41);r(33);r(56);r(65);r(23);r(40);r(52);r(34);var R=n(r(42));var I=void 0&&(void 0).__extends||function(e,t){for(var r in t){if(t.hasOwnProperty(r))e[r]=t[r]}function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var O=Error;var i;(function(l){var d=function e(t){if(T(t)){var r=new Array(t.length);for(var n=0;n<r.length;n++){r[n]=""+n}return r}if(Object.keys){return Object.keys(t)}var r=[];for(var i in t){if(t.hasOwnProperty(i)){r.push(i)}}return r};function o(e,t){switch((0,R.default)(e)){case"undefined":case"boolean":case"string":case"number":return e===t;case"object":if(e===null)return t===null;if(T(e)){if(!T(t)||e.length!==t.length)return false;for(var r=0,n=e.length;r<n;r++){if(!o(e[r],t[r]))return false}return true}var i=d(t);var a=i.length;if(d(e).length!==a)return false;for(var r=0;r<a;r++){if(!o(e[r],t[r]))return false}return true;default:return false}}var v={add:function e(t,r){t[r]=this.value;return true},remove:function e(t,r){delete t[r];return true},replace:function e(t,r){t[r]=this.value;return true},move:function e(t,r,n){var i={op:"_get",path:this.from};a(n,[i]);a(n,[{op:"remove",path:this.from}]);a(n,[{op:"add",path:this.path,value:i.value}]);return true},copy:function e(t,r,n){var i={op:"_get",path:this.from};a(n,[i]);a(n,[{op:"add",path:this.path,value:i.value}]);return true},test:function e(t,r){return o(t[r],this.value)},_get:function e(t,r){this.value=t[r]}};var p={add:function e(t,r){t.splice(r,0,this.value);return true},remove:function e(t,r){t.splice(r,1);return true},replace:function e(t,r){t[r]=this.value;return true},move:v.move,copy:v.copy,test:v.test,_get:v._get};var g={add:function e(t){g.remove.call(this,t);for(var r in this.value){if(this.value.hasOwnProperty(r)){t[r]=this.value[r]}}return true},remove:function e(t){for(var r in t){if(t.hasOwnProperty(r)){v.remove.call(this,t,r)}}return true},replace:function e(t){a(t,[{op:"remove",path:this.path}]);a(t,[{op:"add",path:this.path,value:this.value}]);return true},move:v.move,copy:v.copy,test:function e(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function e(t){this.value=t}};var e={add:function e(t,r){var n={op:"add",path:r+h(this.name),value:this.object[this.name]};t.push(n)},delete:function e(t,r){var n={op:"remove",path:r+h(this.name)};t.push(n)},update:function e(t,r){var n={op:"replace",path:r+h(this.name),value:this.object[this.name]};t.push(n)}};function h(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function i(e,t){var r;for(var n in e){if(e.hasOwnProperty(n)){if(e[n]===t){return h(n)+"/"}else if((0,R.default)(e[n])==="object"){r=i(e[n],t);if(r!=""){return h(n)+"/"+r}}}}return""}function t(e,t){if(e===t){return"/"}var r=i(e,t);if(r===""){throw new O("Object not found in root")}return"/"+r}var c=[];var m=function(){function e(e){this.observers=[];this.obj=e}return e}();var y=function(){function e(e,t){this.callback=e;this.observer=t}return e}();function b(e){for(var t=0,r=c.length;t<r;t++){if(c[t].obj===e){return c[t]}}}function w(e,t){for(var r=0,n=e.observers.length;r<n;r++){if(e.observers[r].callback===t){return e.observers[r].observer}}}function C(e,t){for(var r=0,n=e.observers.length;r<n;r++){if(e.observers[r].observer===t){e.observers.splice(r,1);return}}}function r(e,t){t.unobserve()}l.unobserve=r;function S(e){if((0,R.default)(e)==="object"){return JSON.parse(JSON.stringify(e))}else{return e}}function n(e,t){var r=[];var n=e;var i;var a=b(e);if(!a){a=new m(e);c.push(a)}else{i=w(a,t)}if(i){return i}i={};a.value=S(e);if(t){i.callback=t;i.next=null;var o=this.intervals||[100,1e3,1e4,6e4];if(o.push===void 0){throw new O("jsonpatch.intervals must be an array")}var s=0;var l=function e(){E(i)};var u=function e(){clearTimeout(i.next);i.next=setTimeout(function(){l();s=0;i.next=setTimeout(f,o[s++])},0)};var f=function e(){l();if(s==o.length)s=o.length-1;i.next=setTimeout(e,o[s++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",u);window.addEventListener("mouseup",u);window.addEventListener("keydown",u)}else{document.documentElement.attachEvent("onmousedown",u);document.documentElement.attachEvent("onmouseup",u);document.documentElement.attachEvent("onkeydown",u)}}i.next=setTimeout(f,o[s++])}i.patches=r;i.object=e;i.unobserve=function(){E(i);clearTimeout(i.next);C(a,i);if(a.observers.length===0){c.splice(c.indexOf(a),1)}if(typeof window!=="undefined"){if(window.removeEventListener){window.removeEventListener("mousedown",u);window.removeEventListener("mouseup",u);window.removeEventListener("keydown",u)}else{document.documentElement.detachEvent("onmousedown",u);document.documentElement.detachEvent("onmouseup",u);document.documentElement.detachEvent("onkeydown",u)}}};a.observers.push(new y(t,i));return i}l.observe=n;function E(e){var t;for(var r=0,n=c.length;r<n;r++){if(c[r].obj===e.object){t=c[r];break}}k(t.value,e.object,e.patches,"");if(e.patches.length){a(t.value,e.patches)}var i=e.patches;if(i.length>0){e.patches=[];if(e.callback){e.callback(i)}}return i}l.generate=E;function k(e,t,r,n){var i=d(t);var a=d(e);var o=false;var s=false;for(var l=a.length-1;l>=0;l--){var u=a[l];var f=e[u];if(t.hasOwnProperty(u)){var c=t[u];if((0,R.default)(f)=="object"&&f!=null&&(0,R.default)(c)=="object"&&c!=null){k(f,c,r,n+"/"+h(u))}else{if(f!=c){o=true;r.push({op:"replace",path:n+"/"+h(u),value:S(c)})}}}else{r.push({op:"remove",path:n+"/"+h(u)});s=true}}if(!s&&i.length==a.length){return}for(var l=0;l<i.length;l++){var u=i[l];if(!e.hasOwnProperty(u)){r.push({op:"add",path:n+"/"+h(u),value:S(t[u])})}}}var T;if(Array.isArray){T=Array.isArray}else{T=function e(t){return t.push&&typeof t.length==="number"}}function _(e){var t=0;var r=e.length;var n;while(t<r){n=e.charCodeAt(t);if(n>=48&&n<=57){t++;continue}return false}return true}function a(e,t,r){var n=false,i=0,a=t.length,o,s;while(i<a){o=t[i];i++;var l=o.path||"";var u=l.split("/");var f=e;var c=1;var d=u.length;var h=undefined;while(true){s=u[c];if(r){if(h===undefined){if(f[s]===undefined){h=u.slice(0,c).join("/")}else if(c==d-1){h=o.path}if(h!==undefined){this.validator(o,i-1,e,h)}}}c++;if(s===undefined){if(c>=d){n=g[o.op].call(o,f,s,e);break}}if(T(f)){if(s==="-"){s=f.length}else{if(r&&!_(s)){throw new x("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i-1,o.path,o)}s=parseInt(s,10)}if(c>=d){if(r&&o.op==="add"&&s>f.length){throw new x("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i-1,o.path,o)}n=p[o.op].call(o,f,s,e);break}}else{if(s&&s.indexOf("~")!=-1)s=s.replace(/~1/g,"/").replace(/~0/g,"~");if(c>=d){n=v[o.op].call(o,f,s,e);break}}f=f[s]}}return n}l.apply=a;function s(e,t){var r=[];k(e,t,r,"");return r}l.compare=s;var x=function(a){I(e,a);function e(e,t,r,n,i){a.call(this,e);this.message=e;this.name=t;this.index=r;this.operation=n;this.tree=i}return e}(O);l.JsonPatchError=x;l.Error=x;function u(e){if(e===undefined){return true}if(typeof e=="array"||(0,R.default)(e)=="object"){for(var t in e){if(u(e[t])){return true}}}return false}function f(e,t,r,n){if((0,R.default)(e)!=="object"||e===null||T(e)){throw new x("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r)}else if(!v[e.op]){throw new x("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r)}else if(typeof e.path!=="string"){throw new x("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r)}else if((e.op==="move"||e.op==="copy")&&typeof e.from!=="string"){throw new x("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===undefined){throw new x("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&u(e.value)){throw new x("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r)}else if(r){if(e.op=="add"){var i=e.path.split("/").length;var a=n.split("/").length;if(i!==a+1&&i!==a){throw new x("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==n){throw new x("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:undefined};var s=l.validate([o],r);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE"){throw new x("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}}}l.validator=f;function D(e,t){try{if(!T(e)){throw new x("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}if(t){t=JSON.parse(JSON.stringify(t));a.call(this,t,e,true)}else{for(var r=0;r<e.length;r++){this.validator(e[r],r)}}}catch(e){if(e instanceof x){return e}else{throw e}}}l.validate=D})(i||(i={}));if(true){t.apply=i.apply;t.observe=i.observe;t.unobserve=i.unobserve;t.generate=i.generate;t.compare=i.compare;t.validate=i.validate;t.validator=i.validator;t.JsonPatchError=i.JsonPatchError;t.Error=i.Error}},function(e,t,r){"use strict";var n=r(0);r(12);r(23);r(120);t.__esModule=true;t.cleanPatches=o;t.parsePath=s;var a=n(r(18));var i=r(4);function o(e){var t=[];var r=(0,i.arrayFilter)(e,function(e){if(/[/]length/gi.test(e.path)){return false}if(!s(e.path)){return false}return true});r=(0,i.arrayMap)(r,function(e){var t=s(e.path);e.row=t.row;e.col=t.col;return e});r=(0,i.arrayFilter)(r,function(e){if(["add","remove"].indexOf(e.op)!==-1&&!isNaN(e.col)){if(t.indexOf(e.col)!==-1){return false}t.push(e.col)}return true});t.length=0;return r}function s(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);if(!t){return null}var r=(0,a.default)(t,3),n=r[1],i=r[2];return{row:parseInt(n,10),col:/^\d*$/.test(i)?parseInt(i,10):i}}},function(e,t,r){"use strict";var n=r(0);r(31);r(12);r(54);r(33);r(10);r(23);r(38);r(39);r(378);r(52);t.__esModule=true;t.default=void 0;var f=n(r(37));var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var c=n(r(22));var d=r(21);var h=r(3);var v=r(17);var p=r(29);var g="htSearchResult";var m=function e(t,r,n,i,a){t.getCellMeta(r,n).isSearchResult=a};var y=function e(t,r){if((0,p.isUndefined)(t)||t===null||!t.toLowerCase||t.length===0){return false}if((0,p.isUndefined)(r)||r===null){return false}return r.toString().toLowerCase().indexOf(t.toLowerCase())!==-1};var b=function(e){(0,u.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,s.default)(n).call(this,e));t.callback=m;t.queryMethod=y;t.searchResultClass=g;return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}var r=this.hot.getSettings().search;this.updatePluginSettings(r);this.addHook("beforeRenderer",function(){return t.onBeforeRenderer.apply(t,arguments)});(0,l.default)((0,s.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){var t=this;var r=function e(){return t.onBeforeRenderer.apply(t,arguments)};this.hot.addHook("beforeRenderer",r);this.hot.addHookOnce("afterRender",function(){t.hot.removeHook("beforeRenderer",r)});(0,l.default)((0,s.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,l.default)((0,s.default)(n.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function e(l){var u=this;var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getCallback();var c=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.getQueryMethod();var t=this.hot.countRows();var r=this.hot.countCols();var d=[];var h=this.hot;(0,v.rangeEach)(0,t-1,function(s){(0,v.rangeEach)(0,r-1,function(e){var t=u.hot.getDataAtCell(s,e);var r=u.hot.getCellMeta(s,e);var n=r.search.callback||f;var i=r.search.queryMethod||c;var a=i(l,t,r);if(a){var o={row:s,col:e,data:t};d.push(o)}if(n){n(h,s,e,t,a)}})});return d}},{key:"getCallback",value:function e(){return this.callback}},{key:"setCallback",value:function e(t){this.callback=t}},{key:"getQueryMethod",value:function e(){return this.queryMethod}},{key:"setQueryMethod",value:function e(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function e(){return this.searchResultClass}},{key:"setSearchResultClass",value:function e(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function e(t){if((0,h.isObject)(t)){if(t.searchResultClass){this.setSearchResultClass(t.searchResultClass)}if(t.queryMethod){this.setQueryMethod(t.queryMethod)}if(t.callback){this.setCallback(t.callback)}}}},{key:"onBeforeRenderer",value:function e(t,r,n,i,a,o){var s=o.className||[];var l=[];if(typeof s==="string"){l=s.split(" ")}else{var u;(u=l).push.apply(u,(0,f.default)(s))}if(this.isEnabled()&&o.isSearchResult){if(!l.includes(this.searchResultClass)){l.push("".concat(this.searchResultClass))}}else if(l.includes(this.searchResultClass)){l.splice(l.indexOf(this.searchResultClass),1)}o.className=l.join(" ")}},{key:"destroy",value:function e(){(0,l.default)((0,s.default)(n.prototype),"destroy",this).call(this)}}]);return n}(c.default);(0,d.registerPlugin)("search",b);var w=b;t.default=w},function(e,t,r){"use strict";var n=r(0);r(34);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=r(8);var c=r(4);var d=n(r(22));var h=r(21);var v=r(76);var p=function(e){(0,u.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,s.default)(r).call(this,e));t.scrollbars=[];t.clones=[];t.lockedCollection=false;t.freezeOverlays=false;return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return(0,v.isTouchSupported)()}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}this.addHook("afterRender",function(){return t.onAfterRender()});this.registerEvents();(0,l.default)((0,s.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.lockedCollection=false;(0,l.default)((0,s.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){(0,l.default)((0,s.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function e(){var t=this;this.addHook("beforeTouchScroll",function(){return t.onBeforeTouchScroll()});this.addHook("afterMomentumScroll",function(){return t.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function e(){if(this.lockedCollection){return}var t=this.hot.view.wt.wtOverlays,r=t.topOverlay,n=t.bottomOverlay,i=t.leftOverlay,a=t.topLeftCornerOverlay,o=t.bottomLeftCornerOverlay;this.lockedCollection=true;this.scrollbars.length=0;this.scrollbars.push(r);if(n.clone){this.scrollbars.push(n)}this.scrollbars.push(i);if(a){this.scrollbars.push(a)}if(o&&o.clone){this.scrollbars.push(o)}this.clones.length=0;if(r.needFullRender){this.clones.push(r.clone.wtTable.holder.parentNode)}if(n.needFullRender){this.clones.push(n.clone.wtTable.holder.parentNode)}if(i.needFullRender){this.clones.push(i.clone.wtTable.holder.parentNode)}if(a){this.clones.push(a.clone.wtTable.holder.parentNode)}if(o&&o.clone){this.clones.push(o.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function e(){this.freezeOverlays=true;(0,c.arrayEach)(this.clones,function(e){(0,f.addClass)(e,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function e(){var t=this;this.freezeOverlays=false;(0,c.arrayEach)(this.clones,function(e){(0,f.removeClass)(e,"hide-tween");(0,f.addClass)(e,"show-tween")});setTimeout(function(){(0,c.arrayEach)(t.clones,function(e){(0,f.removeClass)(e,"show-tween")})},400);(0,c.arrayEach)(this.scrollbars,function(e){e.refresh();e.resetFixedPosition()});this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]);return r}(d.default);(0,h.registerPlugin)("touchScroll",p);var g=p;t.default=g},function(e,t,r){"use strict";var n=r(0);r(50);r(146);r(31);r(12);r(381);r(41);r(78);r(33);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=n(r(37));var v=n(r(18));var f=n(r(46));var c=r(4);var p=r(17);var g=r(3);var d=r(32);var h=r(66);function m(d){var h=this;this.instance=d;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;d.addHook("afterChange",function(e,t){var r=e&&e.length;if(!r||["UndoRedo.undo","UndoRedo.redo","MergeCells"].includes(t)){return}var n=e.find(function(e){var t=(0,v.default)(e,4),r=t[2],n=t[3];return r!==n});if(!n){return}var i=e.reduce(function(e,t){e.push((0,u.default)(t));return e},[]);(0,c.arrayEach)(i,function(e){e[1]=d.propToCol(e[1])});var a=r>1?this.getSelected():[[i[0][0],i[0][1]]];h.done(new m.ChangeAction(i,a))});d.addHook("afterCreateRow",function(e,t,r){if(r==="UndoRedo.undo"||r==="UndoRedo.undo"||r==="auto"){return}var n=new m.CreateRowAction(e,t);h.done(n)});d.addHook("beforeRemoveRow",function(e,t,r,n){if(n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto"){return}var i=h.instance.getSourceDataArray();var a=(i.length+e)%i.length;var o=d.toPhysicalRow(a);var s=(0,g.deepClone)(i.slice(o,o+t));h.done(new m.RemoveRowAction(a,s))});d.addHook("afterCreateCol",function(e,t,r){if(r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto"){return}h.done(new m.CreateColumnAction(e,t))});d.addHook("beforeRemoveCol",function(e,n,t,r){if(r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto"){return}var i=h.instance.getSourceDataArray();var a=(h.instance.countCols()+e)%h.instance.countCols();var o=[];var s=[];var l=[];(0,p.rangeEach)(i.length-1,function(e){var t=[];var r=i[e];(0,p.rangeEach)(a,a+(n-1),function(e){t.push(r[d.runHooks("modifyCol",e)])});o.push(t)});(0,p.rangeEach)(n-1,function(e){l.push(d.runHooks("modifyCol",a+e))});if(Array.isArray(d.getSettings().colHeaders)){(0,p.rangeEach)(n-1,function(e){s.push(d.getSettings().colHeaders[d.runHooks("modifyCol",a+e)]||null)})}var u=h.instance.getPlugin("manualColumnMove");var f=u.isEnabled()?u.columnsMapper.__arrayMap:[];var c=new m.RemoveColumnAction(a,l,o,s,f);h.done(c)});d.addHook("beforeCellAlignment",function(e,t,r,n){var i=new m.CellAlignmentAction(e,t,r,n);h.done(i)});d.addHook("beforeFilter",function(e){h.done(new m.FiltersAction(e))});d.addHook("beforeRowMove",function(e,t){if(e===false){return}h.done(new m.RowMoveAction(e,t))});d.addHook("beforeMergeCells",function(e,t){if(t){return}h.done(new m.MergeCellsAction(d,e))});d.addHook("afterUnmergeCells",function(e,t){if(t){return}h.done(new m.UnmergeCellsAction(d,e))})}m.prototype.done=function(e){if(!this.ignoreNewActions){this.doneActions.push(e);this.undoneActions.length=0}};m.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();var t=(0,g.deepClone)(e);var r=this.instance;var n=r.runHooks("beforeUndo",t);if(n===false){return}this.ignoreNewActions=true;var i=this;e.undo(this.instance,function(){i.ignoreNewActions=false;i.undoneActions.push(e)});r.runHooks("afterUndo",t)}};m.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();var t=(0,g.deepClone)(e);var r=this.instance;var n=r.runHooks("beforeRedo",t);if(n===false){return}this.ignoreNewActions=true;var i=this;e.redo(this.instance,function(){i.ignoreNewActions=false;i.doneActions.push(e)});r.runHooks("afterRedo",t)}};m.prototype.isUndoAvailable=function(){return this.doneActions.length>0};m.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};m.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};m.Action=function(){};m.Action.prototype.undo=function(){};m.Action.prototype.redo=function(){};m.ChangeAction=function(e,t){this.changes=e;this.selected=t;this.actionType="change"};(0,g.inherit)(m.ChangeAction,m.Action);m.ChangeAction.prototype.undo=function(e,t){var r=(0,g.deepClone)(this.changes);var n=e.countEmptyRows(true);var i=e.countEmptyCols(true);for(var a=0,o=r.length;a<o;a++){r[a].splice(3,1)}e.addHookOnce("afterChange",t);e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=(0,v.default)(r[s],2),f=u[0],c=u[1];if(e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows){e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows);e.undoRedo.doneActions.pop()}if(e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols){e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols);e.undoRedo.doneActions.pop()}}e.selectCells(this.selected,false,false)};m.ChangeAction.prototype.redo=function(e,t){var r=(0,g.deepClone)(this.changes);for(var n=0,i=r.length;n<i;n++){r[n].splice(2,1)}e.addHookOnce("afterChange",t);e.setDataAtCell(r,null,null,"UndoRedo.redo");if(this.selected){e.selectCells(this.selected,false,false)}};m.CreateRowAction=function(e,t){this.index=e;this.amount=t;this.actionType="insert_row"};(0,g.inherit)(m.CreateRowAction,m.Action);m.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows();var n=e.getSettings().minSpareRows;if(this.index>=r&&this.index-n<r){this.index-=n}e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};m.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t);e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};m.RemoveRowAction=function(e,t){this.index=e;this.data=t;this.actionType="remove_row"};(0,g.inherit)(m.RemoveRowAction,m.Action);m.RemoveRowAction.prototype.undo=function(e,t){e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo");e.addHookOnce("afterRender",t);e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};m.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};m.CreateColumnAction=function(e,t){this.index=e;this.amount=t;this.actionType="insert_col"};(0,g.inherit)(m.CreateColumnAction,m.Action);m.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};m.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t);e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};m.RemoveColumnAction=function(e,t,r,n,i){this.index=e;this.indexes=t;this.data=r;this.amount=this.data[0].length;this.headers=n;this.columnPositions=i.slice(0);this.actionType="remove_col"};(0,g.inherit)(m.RemoveColumnAction,m.Action);m.RemoveColumnAction.prototype.undo=function(r,e){var i=this;var n;var a=this.indexes.slice(0).sort();var t=function e(t,r,n){return n[i.indexes.indexOf(a[r])]};var o=[];(0,p.rangeEach)(this.data.length-1,function(e){o[e]=(0,c.arrayMap)(i.data[e],t)});var s=[];s=(0,c.arrayMap)(this.headers,t);var l=[];r.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo");(0,p.rangeEach)(this.data.length-1,function(t){n=r.getSourceDataAtRow(t);(0,p.rangeEach)(a.length-1,function(e){n.splice(a[e],0,o[t][e]);l.push([t,a[e],null,o[t][e]])})});if(r.getPlugin("formulas")){r.getPlugin("formulas").onAfterSetDataAtCell(l)}if(typeof this.headers!=="undefined"){(0,p.rangeEach)(s.length-1,function(e){r.getSettings().colHeaders.splice(a[e],0,s[e])})}if(r.getPlugin("manualColumnMove")){r.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions}r.addHookOnce("afterRender",e);r.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo");if(r.getPlugin("formulas")){r.getPlugin("formulas").recalculateFull()}r.render()};m.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};m.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e;this.range=t;this.type=r;this.alignment=n};m.CellAlignmentAction.prototype.undo=function(a,e){var o=this;(0,c.arrayEach)(this.range,function(e){var t=e.from,r=e.to;for(var n=t.row;n<=r.row;n+=1){for(var i=t.col;i<=r.col;i+=1){a.setCellMeta(n,i,"className",o.stateBefore[n][i]||" htLeft")}}});a.addHookOnce("afterRender",e);a.render()};m.CellAlignmentAction.prototype.redo=function(i,e){(0,h.align)(this.range,this.type,this.alignment,function(e,t){return i.getCellMeta(e,t)},function(e,t,r,n){return i.setCellMeta(e,t,r,n)});i.addHookOnce("afterRender",e);i.render()};m.FiltersAction=function(e){this.conditionsStack=e;this.actionType="filter"};(0,g.inherit)(m.FiltersAction,m.Action);m.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterRender",t);r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1));r.filter()};m.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterRender",t);r.conditionCollection.importAllConditions(this.conditionsStack);r.filter()};var y=function(e){(0,l.default)(n,e);function n(e,t){var r;(0,i.default)(this,n);r=(0,o.default)(this,(0,s.default)(n).call(this));r.cellRange=t;r.rangeData=e.getData(t.from.row,t.from.col,t.to.row,t.to.col);return r}(0,a.default)(n,[{key:"undo",value:function e(t,r){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",r);n.unmergeRange(this.cellRange,true);t.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function e(t,r){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",r);n.mergeRange(this.cellRange)}}]);return n}(m.Action);m.MergeCellsAction=y;var b=function(e){(0,l.default)(n,e);function n(e,t){var r;(0,i.default)(this,n);r=(0,o.default)(this,(0,s.default)(n).call(this));r.cellRange=t;return r}(0,a.default)(n,[{key:"undo",value:function e(t,r){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",r);n.mergeRange(this.cellRange,true)}},{key:"redo",value:function e(t,r){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",r);n.unmergeRange(this.cellRange,true);t.render()}}]);return n}(m.Action);m.UnmergeCellsAction=b;m.RowMoveAction=function(e,t){this.rows=e.slice();this.target=t};(0,g.inherit)(m.RowMoveAction,m.Action);m.RowMoveAction.prototype.undo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);var n=this.rows[0]<this.target?-1*this.rows.length:0;var i=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0];var a=[];var o=this.rows.length+n;for(var s=n;s<o;s+=1){a.push(this.target+s)}r.moveRows(a.slice(),i);e.render();e.selectCell(this.rows[0],0,this.rows[this.rows.length-1],e.countCols()-1,false,false)};m.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);r.moveRows(this.rows.slice(),this.target);e.render();var n=this.rows[0]<this.target?this.target-this.rows.length:this.target;e.selectCell(n,0,n+this.rows.length-1,e.countCols()-1,false,false)};function w(){var e=this;var t=typeof e.getSettings().undo==="undefined"||e.getSettings().undo;if(t){if(!e.undoRedo){e.undoRedo=new m(e);E(e);e.addHook("beforeKeyDown",C);e.addHook("afterChange",S)}}else if(e.undoRedo){delete e.undoRedo;k(e);e.removeHook("beforeKeyDown",C);e.removeHook("afterChange",S)}}function C(e){if((0,d.isImmediatePropagationStopped)(e)){return}var t=this;var r=t.getActiveEditor();if(r&&r.isOpened()){return}var n=e.altKey,i=e.ctrlKey,a=e.keyCode,o=e.metaKey,s=e.shiftKey;var l=(i||o)&&!n;if(!l){return}var u=a===89||s&&a===90;if(u){t.undoRedo.redo();(0,d.stopImmediatePropagation)(e)}else if(a===90){t.undoRedo.undo();(0,d.stopImmediatePropagation)(e)}}function S(e,t){var r=this;if(t==="loadData"){return r.undoRedo.clear()}}function E(e){e.undo=function(){return e.undoRedo.undo()};e.redo=function(){return e.undoRedo.redo()};e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()};e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()};e.clearUndo=function(){return e.undoRedo.clear()}}function k(e){delete e.undo;delete e.redo;delete e.isUndoAvailable;delete e.isRedoAvailable;delete e.clearUndo}var T=f.default.getSingleton();T.add("afterInit",w);T.add("afterUpdateSettings",w);T.register("beforeUndo");T.register("afterUndo");T.register("beforeRedo");T.register("afterRedo");var _=m;t.default=_},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(22));var c=r(17);var d=r(21);var h=n(r(609));var v=function(e){(0,u.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,s.default)(n).call(this,e));t.bindStrategy=new h.default;t.removedRows=[];return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}var t=this.hot.getSettings().bindRowsWithHeaders;if(typeof t!=="string"){t=h.default.DEFAULT_STRATEGY}this.bindStrategy.setStrategy(t);this.bindStrategy.createMap(this.hot.countSourceRows());this.addHook("modifyRowHeader",function(e){return r.onModifyRowHeader(e)});this.addHook("afterCreateRow",function(e,t){return r.onAfterCreateRow(e,t)});this.addHook("beforeRemoveRow",function(e,t){return r.onBeforeRemoveRow(e,t)});this.addHook("afterRemoveRow",function(){return r.onAfterRemoveRow()});this.addHook("afterLoadData",function(e){return r.onAfterLoadData(e)});(0,l.default)((0,s.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){(0,l.default)((0,s.default)(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.removedRows.length=0;this.bindStrategy.clearMap();(0,l.default)((0,s.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function e(t){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",t))}},{key:"onAfterCreateRow",value:function e(t,r){this.bindStrategy.createRow(t,r)}},{key:"onBeforeRemoveRow",value:function e(t,r){var n=this;this.removedRows.length=0;if(t!==false){(0,c.rangeEach)(t,t+r-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e))})}}},{key:"onAfterRemoveRow",value:function e(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function e(t){if(!t){this.bindStrategy.createMap(this.hot.countSourceRows())}}},{key:"destroy",value:function e(){this.bindStrategy.destroy();(0,l.default)((0,s.default)(n.prototype),"destroy",this).call(this)}}]);return n}(f.default);(0,d.registerPlugin)("bindRowsWithHeaders",v);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=void 0;var a=i(r(1));var o=i(r(2));var s=r(17);var l=r(74);var u=n(r(610));var f=function(){(0,o.default)(e,null,[{key:"DEFAULT_STRATEGY",get:function e(){return"loose"}}]);function e(){(0,a.default)(this,e);this.strategy=null}(0,o.default)(e,[{key:"setStrategy",value:function e(t){var r=u[(0,l.toUpperCaseFirst)(t)];if(!r){throw new Error('Bind strategy "'.concat(t,'" does not exist.'))}this.strategy=new r}},{key:"createMap",value:function e(t){var r=this.strategy;var n=t===void 0?r._arrayMap.length:t;r._arrayMap.length=0;(0,s.rangeEach)(n-1,function(e){r._arrayMap.push(e)})}},{key:"createRow",value:function e(){var t;(t=this.strategy).createRow.apply(t,arguments)}},{key:"removeRow",value:function e(){var t;(t=this.strategy).removeRow.apply(t,arguments)}},{key:"translate",value:function e(){var t;return(t=this.strategy).getValueByIndex.apply(t,arguments)}},{key:"clearMap",value:function e(){this.strategy.clearMap()}},{key:"destroy",value:function e(){if(this.strategy){this.strategy.destroy()}this.strategy=null}}]);return e}();var c=f;t.default=c},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;var i=n(r(611));t.Loose=i.default;var a=n(r(612));t.Strict=a.default},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(101));var s=r(3);var l=function(){function e(){(0,i.default)(this,e)}(0,a.default)(e,[{key:"createRow",value:function e(t,r){this.shiftItems(t,r)}},{key:"removeRow",value:function e(t,r){this.unshiftItems(t,r)}},{key:"destroy",value:function e(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function e(){return"loose"}}]);return e}();(0,s.mixin)(l,o.default);var u=l;t.default=u},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(101));var s=r(3);var l=function(){function e(){(0,i.default)(this,e)}(0,a.default)(e,[{key:"createRow",value:function e(t,r){this.insertItems(t,r)}},{key:"removeRow",value:function e(t,r){this.removeItems(t,r)}},{key:"destroy",value:function e(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function e(){return"strict"}}]);return e}();(0,s.mixin)(l,o.default);var u=l;t.default=u},function(e,t,r){"use strict";var n=r(0);r(12);r(33);r(65);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=r(3);var c=r(4);var d=r(17);var h=r(61);var v=r(8);var p=n(r(25));var g=r(21);var m=r(32);var y=n(r(22));var b=function(e){(0,u.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,s.default)(r).call(this,e));t.settings=null;t.buttonEnabledList={};t.hiddenColumnsPlugin=null;t.nestedHeadersPlugin=null;t.collapsedSections={};t.columnHeaderLevelCount=null;t.eventManager=null;return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function e(){var n=this;if(this.enabled){return}this.settings=this.hot.getSettings().collapsibleColumns;if(typeof this.settings!=="boolean"){this.parseSettings()}this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns");this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.checkDependencies();this.addHook("afterRender",function(){return n.onAfterRender()});this.addHook("afterInit",function(){return n.onAfterInit()});this.addHook("afterGetColHeader",function(e,t){return n.onAfterGetColHeader(e,t)});this.addHook("beforeOnCellMouseDown",function(e,t,r){return n.onBeforeOnCellMouseDown(e,t,r)});this.eventManager=new p.default(this.hot);(0,l.default)((0,s.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.settings=null;this.buttonEnabledList={};this.hiddenColumnsPlugin=null;this.collapsedSections={};this.clearButtons();(0,l.default)((0,s.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function e(){if(!this.hot.view){return}var t=this.hot.view.wt.getSetting("columnHeaders").length;var a=this.hot.view.wt.wtTable.THEAD;var o=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;var s=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;var l=function e(t){if(t){t.parentNode.removeChild(t)}};(0,d.rangeEach)(0,t-1,function(e){var r=a.childNodes[e];var n=o.childNodes[e];var i=s?s.childNodes[e]:null;(0,d.rangeEach)(0,r.childNodes.length-1,function(e){var t=r.childNodes[e].querySelector(".collapsibleIndicator");l(t);if(n&&n.childNodes[e]){t=n.childNodes[e].querySelector(".collapsibleIndicator");l(t)}if(s&&i&&i.childNodes[e]){t=i.childNodes[e].querySelector(".collapsibleIndicator");l(t)}})},true)}},{key:"parseSettings",value:function e(){var t=this;(0,f.objectEach)(this.settings,function(e){if(!t.buttonEnabledList[e.row]){t.buttonEnabledList[e.row]={}}t.buttonEnabledList[e.row][e.col]=e.collapsible})}},{key:"meetsDependencies",value:function e(){var t=this.hot.getSettings();return t.nestedHeaders&&t.hiddenColumns}},{key:"checkDependencies",value:function e(){var t=this.hot.getSettings();if(this.meetsDependencies()){return}if(!t.nestedHeaders){(0,h.warn)("You need to configure the Nested Headers plugin in order to use collapsible headers.")}if(!t.hiddenColumns){(0,h.warn)("You need to configure the Hidden Columns plugin in order to use collapsible headers.")}}},{key:"generateIndicator",value:function e(t,r){var n=r.parentNode;var i=n.parentNode;var a=-1*i.childNodes.length+Array.prototype.indexOf.call(i.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[a]||!this.buttonEnabledList[a][t])){return null}var o=this.hot.rootDocument.createElement("DIV");(0,v.addClass)(o,"collapsibleIndicator");if(this.collapsedSections[a]&&this.collapsedSections[a][t]===true){(0,v.addClass)(o,"collapsed");(0,v.fastInnerText)(o,"+")}else{(0,v.addClass)(o,"expanded");(0,v.fastInnerText)(o,"-")}return o}},{key:"markSectionAs",value:function e(t,r,n,i){if(!this.collapsedSections[r]){this.collapsedSections[r]={}}switch(t){case"collapsed":this.collapsedSections[r][n]=true;break;case"expanded":this.collapsedSections[r][n]=void 0;break;default:break}if(i){var a=this.nestedHeadersPlugin.colspanArray;var o=this.nestedHeadersPlugin.rowCoordsToLevel(r);var s=this.nestedHeadersPlugin.getChildHeaders(r,n);var l=a[o+1];for(var u=1;u<s.length;u++){if(l&&l[s[u]].colspan>1){this.markSectionAs(t,r+1,s[u],true)}}}}},{key:"expandSection",value:function e(t){this.markSectionAs("expanded",t.row,t.col,true);this.toggleCollapsibleSection(t,"expand")}},{key:"collapseSection",value:function e(t){this.markSectionAs("collapsed",t.row,t.col,true);this.toggleCollapsibleSection(t,"collapse")}},{key:"toggleAllCollapsibleSections",value:function e(a){var o=this;var t=this.nestedHeadersPlugin.colspanArray;if(this.settings===true){(0,c.arrayEach)(t,function(e,i){(0,c.arrayEach)(e,function(e,t){if(e.colspan>1){var r=o.nestedHeadersPlugin.levelToRowCoords(parseInt(i,10));var n=parseInt(t,10);o.markSectionAs(a==="collapse"?"collapsed":"expanded",r,n,true);o.toggleCollapsibleSection({row:r,col:n},a)}})})}else{(0,f.objectEach)(this.buttonEnabledList,function(e,i){(0,f.objectEach)(e,function(e,t){var r=parseInt(i,10);var n=parseInt(t,10);o.markSectionAs(a==="collapse"?"collapsed":"expanded",r,n,true);o.toggleCollapsibleSection({row:r,col:n},a)})})}}},{key:"collapseAll",value:function e(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function e(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function e(r,n){var i=this;if(r.row){r.row=parseInt(r.row,10)}if(r.col){r.col=parseInt(r.col,10)}var a=this.hiddenColumnsPlugin.hiddenColumns;var t=this.nestedHeadersPlugin.colspanArray;var o=this.nestedHeadersPlugin.rowCoordsToLevel(r.row);var s=t[o][r.col].colspan;var l=this.nestedHeadersPlugin.getChildHeaders(r.row,r.col);var u=o+1;var f=t[u];var c=f?f[l[0]].colspan||1:1;while(c===s&&u<this.columnHeaderLevelCount){u+=1;f=t[u];c=f?f[l[0]].colspan||1:1}(0,d.rangeEach)(c,s-1,function(e){var t=r.col+e;switch(n){case"collapse":if(!i.hiddenColumnsPlugin.isHidden(t)){a.push(t)}break;case"expand":if(i.hiddenColumnsPlugin.isHidden(t)){a.splice(a.indexOf(t),1)}break;default:break}});this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize(true)}},{key:"onAfterGetColHeader",value:function e(t,r){if(r.hasAttribute("colspan")&&r.getAttribute("colspan")>1&&t>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(t,r);if(n!==null){r.querySelector("div:first-child").appendChild(n)}}}},{key:"onBeforeOnCellMouseDown",value:function e(t,r){if((0,v.hasClass)(t.target,"collapsibleIndicator")){if((0,v.hasClass)(t.target,"expanded")){if(!this.collapsedSections[r.row]){this.collapsedSections[r.row]=[]}this.markSectionAs("collapsed",r.row,r.col,true);this.eventManager.fireEvent(t.target,"mouseup");this.toggleCollapsibleSection(r,"collapse")}else if((0,v.hasClass)(t.target,"collapsed")){this.markSectionAs("expanded",r.row,r.col,true);this.eventManager.fireEvent(t.target,"mouseup");this.toggleCollapsibleSection(r,"expand")}(0,m.stopImmediatePropagation)(t);return false}}},{key:"onAfterInit",value:function e(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function e(){if(!this.nestedHeadersPlugin.enabled||!this.hiddenColumnsPlugin.enabled){this.disablePlugin()}}},{key:"destroy",value:function e(){this.settings=null;this.buttonEnabledList=null;this.hiddenColumnsPlugin=null;this.nestedHeadersPlugin=null;this.collapsedSections=null;this.columnHeaderLevelCount=null;(0,l.default)((0,s.default)(r.prototype),"destroy",this).call(this)}}]);return r}(y.default);(0,g.registerPlugin)("collapsibleColumns",b);var w=b;t.default=w},function(e,t,r){"use strict";var n=r(0);r(19);r(12);r(23);r(40);r(52);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(22));var c=r(3);var d=r(21);var h=n(r(615));var v=function(e){(0,u.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,s.default)(r).call(this,e));t.endpoints=null;return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}this.settings=this.hot.getSettings().columnSummary;this.endpoints=new h.default(this,this.settings);this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)});this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)});this.addHook("beforeCreateRow",function(e,t,r){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,r)});this.addHook("beforeCreateCol",function(e,t,r){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,r)});this.addHook("beforeRemoveRow",function(){var e;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=i.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(r))});this.addHook("beforeRemoveCol",function(){var e;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=i.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(r))});this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)});this.addHook("afterCreateRow",function(e,t,r){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,r)});this.addHook("afterCreateCol",function(e,t,r){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,r)});this.addHook("afterRemoveRow",function(){var e;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=i.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(r))});this.addHook("afterRemoveCol",function(){var e;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=i.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(r))});this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)});(0,l.default)((0,s.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.endpoints=null;this.settings=null;this.currentEndpoint=null}},{key:"calculate",value:function e(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}},{key:"calculateSum",value:function e(t){var r=this;var n=0;(0,c.objectEach)(t.ranges,function(e){n+=r.getPartialSum(e,t.sourceColumn)});return n}},{key:"getPartialSum",value:function e(t,r){var n=0;var i=t[1]||t[0];var a=null;var o=0;do{a=this.getCellValue(i,r)||0;var s=("".concat(a).split(".")[1]||[]).length||1;if(s>o){o=s}n+=a||0;i-=1}while(i>=t[0]);return Math.round(n*Math.pow(10,o))/Math.pow(10,o)}},{key:"calculateMinMax",value:function e(r,n){var i=this;var a=null;(0,c.objectEach)(r.ranges,function(e){var t=i.getPartialMinMax(e,r.sourceColumn,n);if(a===null&&t!==null){a=t}if(t!==null){switch(n){case"min":a=Math.min(a,t);break;case"max":a=Math.max(a,t);break;default:break}}});return a===null?"Not enough data":a}},{key:"getPartialMinMax",value:function e(t,r,n){var i=null;var a=t[1]||t[0];var o;do{o=this.getCellValue(a,r)||null;if(i===null){i=o}else if(o!==null){switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break;default:break}}a-=1}while(a>=t[0]);return i}},{key:"countEmpty",value:function e(t,r){var n;var i=0;var a=t[1]||t[0];do{n=this.getCellValue(a,r);if(!n){i+=1}a-=1}while(a>=t[0]);return i}},{key:"countEntries",value:function e(n){var i=this;var a=0;var t=n.ranges;(0,c.objectEach)(t,function(e){var t=e[1]===void 0?1:e[1]-e[0]+1;var r=i.countEmpty(e,n.sourceColumn);a+=t;a-=r});return a}},{key:"calculateAverage",value:function e(t){var r=this.calculateSum(t);var n=this.countEntries(t);return r/n}},{key:"getCellValue",value:function e(t,r){var n=this.endpoints.getVisualRowIndex(t);var i=this.endpoints.getVisualColumnIndex(r);var a=this.hot.getSourceDataAtCell(t,r);var o=this.hot.getCellMeta(n,i).className||"";if(o.indexOf("columnSummaryResult")>-1){return null}if(this.endpoints.currentEndpoint.forceNumeric){if(typeof a==="string"){a=a.replace(/,/,".")}a=parseFloat(a)}if(isNaN(a)){if(!this.endpoints.currentEndpoint.suppressDataTypeErrors){throw new Error("ColumnSummary plugin: cell at (".concat(t,", ").concat(r,") is not in a numeric format. Cannot do the calculation."))}}return a}},{key:"onAfterInit",value:function e(){this.endpoints.endpoints=this.endpoints.parseSettings();this.endpoints.refreshAllEndpoints(true)}},{key:"onAfterChange",value:function e(t,r){if(t&&r!=="ColumnSummary.reset"&&r!=="ColumnSummary.set"&&r!=="loadData"){this.endpoints.refreshChangedEndpoints(t)}}},{key:"onBeforeRowMove",value:function e(t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName)}},{key:"onAfterRowMove",value:function e(t,r){this.endpoints.resetSetupAfterStructureAlteration("move_row",r,t.length,t,this.pluginName)}}]);return r}(f.default);(0,d.registerPlugin)("columnSummary",v);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(0);r(12);r(616);t.__esModule=true;t.default=void 0;var f=n(r(18));var i=n(r(1));var a=n(r(2));var v=r(4);var o=r(61);var s=r(98);var l=function(){function r(e,t){(0,i.default)(this,r);this.plugin=e;this.hot=this.plugin.hot;this.endpoints=[];this.settings=t;this.settingsType="array";this.currentEndpoint=null;this.cellsToSetCache=[];this.recordTranslator=(0,s.getTranslator)(this.hot)}(0,a.default)(r,[{key:"getEndpoint",value:function e(t){if(this.settingsType==="function"){return this.fillMissingEndpointData(this.settings)[t]}return this.endpoints[t]}},{key:"getAllEndpoints",value:function e(){if(this.settingsType==="function"){return this.fillMissingEndpointData(this.settings)}return this.endpoints}},{key:"fillMissingEndpointData",value:function e(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function e(t){var r=this;var n=[];var i=t;if(!i&&typeof this.settings==="function"){this.settingsType="function";return}if(!i){i=this.settings}(0,v.arrayEach)(i,function(e){var t={};r.assignSetting(e,t,"ranges",[[0,r.hot.countRows()-1]]);r.assignSetting(e,t,"reversedRowCoords",false);r.assignSetting(e,t,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      "));r.assignSetting(e,t,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      "));r.assignSetting(e,t,"sourceColumn",e.destinationColumn);r.assignSetting(e,t,"type","sum");r.assignSetting(e,t,"forceNumeric",false);r.assignSetting(e,t,"suppressDataTypeErrors",true);r.assignSetting(e,t,"suppressDataTypeErrors",true);r.assignSetting(e,t,"customFunction",null);r.assignSetting(e,t,"readOnly",true);r.assignSetting(e,t,"roundFloat",false);n.push(t)});return n}},{key:"assignSetting",value:function e(t,r,n,i){if(n==="ranges"&&t[n]===void 0){r[n]=i;return}else if(n==="ranges"&&t[n].length===0){return}if(t[n]===void 0){if(i instanceof Error){throw i}r[n]=i}else{if(n==="destinationRow"&&r.reversedRowCoords){r[n]=this.hot.countRows()-t[n]-1}else{r[n]=t[n]}}}},{key:"resetSetupBeforeStructureAlteration",value:function e(t,r,n){if(this.settingsType!=="function"){return}var i=t.indexOf("row")>-1?"row":"col";var a=this.getAllEndpoints();(0,v.arrayEach)(a,function(e){if(i==="row"&&e.destinationRow>=r){if(t==="insert_row"){e.alterRowOffset=n}else if(t==="remove_row"){e.alterRowOffset=-1*n}}if(i==="col"&&e.destinationColumn>=r){if(t==="insert_col"){e.alterColumnOffset=n}else if(t==="remove_col"){e.alterColumnOffset=-1*n}}});this.resetAllEndpoints(a,false)}},{key:"resetSetupAfterStructureAlteration",value:function e(t,r,n,i,a){var o=this;var s=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;if(this.settingsType==="function"){var l=function e(){o.hot.removeHook("beforeRender",e);return o.refreshAllEndpoints()};this.hot.addHookOnce("beforeRender",l);return}var u=t.indexOf("row")>-1?"row":"col";var f=t.indexOf("remove")>-1?-1:1;var c=this.getAllEndpoints();var d=t.indexOf("move_row")===0;var h=r;(0,v.arrayEach)(c,function(e){if(u==="row"&&e.destinationRow>=h){e.alterRowOffset=f*n}if(u==="col"&&e.destinationColumn>=h){e.alterColumnOffset=f*n}});this.resetAllEndpoints(c,!d);if(d){(0,v.arrayEach)(c,function(e){o.extendEndpointRanges(e,h,i[0],i.length);o.recreatePhysicalRanges(e);o.clearOffsetInformation(e)})}else{(0,v.arrayEach)(c,function(e){o.shiftEndpointCoordinates(e,h)})}if(s){this.refreshAllEndpoints()}}},{key:"clearOffsetInformation",value:function e(t){t.alterRowOffset=void 0;t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function e(t,r,n,i){(0,v.arrayEach)(t.ranges,function(e){if(e[1]){if(r>=e[0]&&r<=e[1]){if(n>e[1]){e[1]+=i}else if(n<e[0]){e[0]-=i}}else if(n>=e[0]&&n<=e[1]){e[1]-=i;if(r<=e[0]){e[0]+=1;e[1]+=1}}}})}},{key:"recreatePhysicalRanges",value:function e(t){var n=this;var r=t.ranges;var i=[];var a=[];(0,v.arrayEach)(r,function(e){var t=[];if(e[1]){for(var r=e[0];r<=e[1];r++){t.push(n.recordTranslator.toPhysicalRow(r))}}else{t.push(n.recordTranslator.toPhysicalRow(e[0]))}a.push(t)});(0,v.arrayEach)(a,function(r){var n=[];(0,v.arrayEach)(r,function(e,t){if(t===0){n.push(e)}else if(r[t]!==r[t-1]+1){n.push(r[t-1]);i.push(n);n=[];n.push(e)}if(t===r.length-1){n.push(e);i.push(n)}})});t.ranges=i}},{key:"shiftEndpointCoordinates",value:function e(n,i){if(n.alterRowOffset&&n.alterRowOffset!==0){n.destinationRow+=n.alterRowOffset||0;(0,v.arrayEach)(n.ranges,function(r){(0,v.arrayEach)(r,function(e,t){if(e>=i){r[t]+=n.alterRowOffset||0}})})}else if(n.alterColumnOffset&&n.alterColumnOffset!==0){n.destinationColumn+=n.alterColumnOffset||0;n.sourceColumn+=n.alterColumnOffset||0}}},{key:"resetAllEndpoints",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=t;this.cellsToSetCache=[];if(!i){i=this.getAllEndpoints()}(0,v.arrayEach)(i,function(e){r.resetEndpointValue(e,n)});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function e(){var t=this;this.cellsToSetCache=[];(0,v.arrayEach)(this.getAllEndpoints(),function(e){t.currentEndpoint=e;t.plugin.calculate(e);t.setEndpointValue(e,"init")});this.currentEndpoint=null;this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function e(t){var i=this;var a=[];this.cellsToSetCache=[];(0,v.arrayEach)(t,function(e,r,n){if("".concat(e[2]||"")==="".concat(e[3])){return}(0,v.arrayEach)(i.getAllEndpoints(),function(e,t){if(i.hot.propToCol(n[r][1])===e.sourceColumn&&a.indexOf(t)===-1){a.push(t)}})});(0,v.arrayEach)(a,function(e){i.refreshEndpoint(i.getEndpoint(e))});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function e(t){this.currentEndpoint=t;this.plugin.calculate(t);this.setEndpointValue(t);this.currentEndpoint=null}},{key:"resetEndpointValue",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=t.alterRowOffset||0;var i=t.alterColumnOffset||0;var a=this.recordTranslator.toVisual(t.destinationRow,t.destinationColumn),o=(0,f.default)(a,2),s=o[0],l=o[1];var u=this.hot.getCellMeta(s,l);u.readOnly=false;u.className="";this.cellsToSetCache.push([this.recordTranslator.toVisualRow(t.destinationRow+(r?n:0)),this.recordTranslator.toVisualColumn(t.destinationColumn+(r?i:0)),""])}},{key:"setEndpointValue",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=-1*t.alterRowOffset||0;var a=-1*t.alterColumnOffset||0;var o=this.getVisualRowIndex(t.destinationRow);var s=this.hot.getCellMeta(this.getVisualRowIndex(t.destinationRow+i),t.destinationColumn+a);if(o>this.hot.countRows()||t.destinationColumn>this.hot.countCols()){this.throwOutOfBoundsWarning();return}if(r==="init"||s.readOnly!==t.readOnly){s.readOnly=t.readOnly;s.className="columnSummaryResult"}if(t.roundFloat&&!isNaN(t.result)){t.result=t.result.toFixed(t.roundFloat)}if(n){this.hot.setDataAtCell(o,t.destinationColumn,t.result,"ColumnSummary.set")}else{this.cellsToSetCache.push([o,t.destinationColumn,t.result])}t.alterRowOffset=void 0;t.alterColumnOffset=void 0}},{key:"getVisualRowIndex",value:function e(t){return this.hot.runHooks("unmodifyRow",t,"columnSummary")}},{key:"getVisualColumnIndex",value:function e(t){return this.hot.runHooks("unmodifyCol",t,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function e(){(0,o.warn)("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]);return r}();var u=l;t.default=u},function(e,t,r){"use strict";var n=r(20);var v=r(82);var p=r(617);var g=r(235);var i=r(26);var a=1..toFixed;var m=Math.floor;var y=function(e,t,r){return t===0?r:t%2===1?y(e,t-1,r*e):y(e*e,t/2,r)};var b=function(e){var t=0;var r=e;while(r>=4096){t+=12;r/=4096}while(r>=2){t+=1;r/=2}return t};var o=a&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(0xde0b6b3a7640080).toFixed(0)!=="1000000000000000128")||!i(function(){a.call({})});n({target:"Number",proto:true,forced:o},{toFixed:function e(t){var r=p(this);var n=v(t);var i=[0,0,0,0,0,0];var a="";var o="0";var s,l,u,f;var c=function(e,t){var r=-1;var n=t;while(++r<6){n+=e*i[r];i[r]=n%1e7;n=m(n/1e7)}};var d=function(e){var t=6;var r=0;while(--t>=0){r+=i[t];i[t]=m(r/e);r=r%e*1e7}};var h=function(){var e=6;var t="";while(--e>=0){if(t!==""||e===0||i[e]!==0){var r=String(i[e]);t=t===""?r:t+g.call("0",7-r.length)+r}}return t};if(n<0||n>20)throw RangeError("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return String(r);if(r<0){a="-";r=-r}if(r>1e-21){s=b(r*y(2,69,1))-69;l=s<0?r*y(2,-s,1):r/y(2,s,1);l*=4503599627370496;s=52-s;if(s>0){c(0,l);u=n;while(u>=7){c(1e7,0);u-=7}c(y(10,u,1),0);u=s-1;while(u>=23){d(1<<23);u-=23}d(1<<u);c(1,1);d(2);o=h()}else{c(0,l);c(1<<-s,0);o=h()+g.call("0",n)}}if(n>0){f=o.length;o=a+(f<=n?"0."+g.call("0",n-f)+o:o.slice(0,f-n)+"."+o.slice(f-n))}else{o=a+o}return o}})},function(e,t,r){var n=r(80);e.exports=function(e){if(typeof e!="number"&&n(e)!="Number"){throw TypeError("Incorrect invocation")}return+e}},function(e,t,r){"use strict";var n=r(0);r(19);r(12);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(28));var s=n(r(5));var l=n(r(14));var u=n(r(2));var f=n(r(7));var c=n(r(22));var d=r(4);var h=n(r(399));var v=n(r(25));var p=r(8);var g=n(r(400));var m=n(r(187));var y=r(21);var b=n(r(46));var w=r(32);var C=r(89);r(619);b.default.getSingleton().register("afterDropdownMenuDefaultOptions");b.default.getSingleton().register("beforeDropdownMenuShow");b.default.getSingleton().register("afterDropdownMenuShow");b.default.getSingleton().register("afterDropdownMenuHide");b.default.getSingleton().register("afterDropdownMenuExecute");var S="changeType";var E=function(e){(0,f.default)(n,e);(0,u.default)(n,null,[{key:"DEFAULT_ITEMS",get:function e(){return[C.COLUMN_LEFT,C.COLUMN_RIGHT,C.SEPARATOR,C.REMOVE_COLUMN,C.SEPARATOR,C.CLEAR_COLUMN,C.SEPARATOR,C.READ_ONLY,C.SEPARATOR,C.ALIGNMENT]}}]);function n(e){var r;(0,i.default)(this,n);r=(0,a.default)(this,(0,s.default)(n).call(this,e));r.eventManager=new v.default((0,o.default)(r));r.commandExecutor=new h.default(r.hot);r.itemsFactory=null;r.menu=null;r.hot.addHook("afterGetColHeader",function(e,t){return r.onAfterGetColHeader(e,t)});return r}(0,u.default)(n,[{key:"isEnabled",value:function e(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}this.itemsFactory=new g.default(this.hot,n.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu;var r={items:this.itemsFactory.getItems(t)};this.registerEvents();if(typeof t.callback==="function"){this.commandExecutor.setCommonCallback(t.callback)}(0,l.default)((0,s.default)(n.prototype),"enablePlugin",this).call(this);this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",r);i.itemsFactory.setPredefinedItems(r.items);var e=i.itemsFactory.getItems(t);if(i.menu){i.menu.destroy()}i.menu=new m.default(i.hot,{className:"htDropdownMenu",keepInViewport:true,container:t.uiContainer||i.hot.rootDocument.body});i.hot.runHooks("beforeDropdownMenuSetItems",e);i.menu.setMenuItems(e);i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()});i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()});i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()});i.menu.addLocalHook("executeCommand",function(){var e;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=i.executeCommand).call.apply(e,[i].concat(r))});(0,d.arrayEach)(e,function(e){return i.commandExecutor.registerCommand(e.key,e)})})}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,l.default)((0,s.default)(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.close();if(this.menu){this.menu.destroy()}(0,l.default)((0,s.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function e(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(e){return t.onTableClick(e)})}},{key:"open",value:function e(t){if(!this.menu){return}this.menu.open();if(t.width){this.menu.setOffset("left",t.width)}this.menu.setPosition(t);this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv}},{key:"close",value:function e(){if(!this.menu){return}this.menu.close()}},{key:"executeCommand",value:function e(t){var r;for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++){i[a-1]=arguments[a]}(r=this.commandExecutor).execute.apply(r,[t].concat(i))}},{key:"setListening",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this.menu.isOpened()){if(t){this.menu.hotMenu.listen()}else{this.menu.hotMenu.unlisten()}}}},{key:"onTableClick",value:function e(t){(0,w.stopPropagation)(t);if((0,p.hasClass)(t.target,S)&&!this.menu.isOpened()){var r=0;var n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var i=this.hot.rootWindow.frameElement;var a=i.getBoundingClientRect(),o=a.top,s=a.left;r=o;n=s}var l=t.target.getBoundingClientRect();this.open({left:l.left+n,top:l.top+t.target.offsetHeight+3+r,width:l.width,height:l.height})}}},{key:"onAfterGetColHeader",value:function e(t,r){var n=r.parentNode;if(!n){return}var i=n.parentNode.childNodes;var a=Array.prototype.indexOf.call(i,n);if(t<0||a!==i.length-1){return}var o=r.querySelector(".".concat(S));if(this.enabled&&o){return}if(!this.enabled){if(o){o.parentNode.removeChild(o)}return}var s=this.hot.rootDocument.createElement("button");s.className=S;s.onclick=function(){return false};r.firstChild.insertBefore(s,r.firstChild.firstChild)}},{key:"onMenuBeforeOpen",value:function e(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function e(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function e(){this.hot.listen();this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function e(){this.close();if(this.menu){this.menu.destroy()}(0,l.default)((0,s.default)(n.prototype),"destroy",this).call(this)}}]);return n}(c.default);E.SEPARATOR={name:C.SEPARATOR};(0,y.registerPlugin)("dropdownMenu",E);var k=E;t.default=k},function(e,t,r){},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(19);r(34);t.__esModule=true;t.default=void 0;var a=i(r(1));var o=i(r(2));var s=i(r(6));var l=i(r(5));var u=i(r(7));var f=i(r(22));var c=r(21);var d=i(r(621));var h=n(r(622));var v=function(e){(0,u.default)(t,e);function t(){(0,a.default)(this,t);return(0,s.default)(this,(0,l.default)(t).apply(this,arguments))}(0,o.default)(t,[{key:"isEnabled",value:function e(){return true}},{key:"exportAsString",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this._createTypeFormatter(t,r).export()}},{key:"exportAsBlob",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,r))}},{key:"downloadFile",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this.hot,i=n.rootDocument,a=n.rootWindow;var o=this._createTypeFormatter(t,r);var s=this._createBlob(o);var l=a.URL||a.webkitURL;var u=i.createElement("a");var f="".concat(o.options.filename,".").concat(o.options.fileExtension);if(u.download!==void 0){var c=l.createObjectURL(s);u.style.display="none";u.setAttribute("href",c);u.setAttribute("download",f);i.body.appendChild(u);u.dispatchEvent(new MouseEvent("click"));i.body.removeChild(u);setTimeout(function(){l.revokeObjectURL(c)},100)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(s,f)}}},{key:"_createTypeFormatter",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!h.EXPORT_TYPES[t]){throw new Error('Export format type "'.concat(t,'" is not supported.'))}return(0,h.default)(t,new d.default(this.hot),r)}},{key:"_createBlob",value:function e(t){var r=null;if(typeof Blob!=="undefined"){r=new Blob([t.export()],{type:"".concat(t.options.mimeType,";charset=").concat(t.options.encoding)})}return r}}]);return t}(f.default);(0,c.registerPlugin)("exportFile",v);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var d=n(r(18));var i=n(r(1));var a=n(r(2));var u=r(17);var o=function(){function t(e){(0,i.default)(this,t);this.hot=e;this.options={}}(0,a.default)(t,[{key:"setOptions",value:function e(t){this.options=t}},{key:"getData",value:function e(){var n=this;var t=this._getDataRange(),r=t.startRow,i=t.startCol,a=t.endRow,o=t.endCol;var s=this.options;var l=[];(0,u.rangeEach)(r,a,function(t){var r=[];if(!s.exportHiddenRows&&n._isHiddenRow(t)){return}(0,u.rangeEach)(i,o,function(e){if(!s.exportHiddenColumns&&n._isHiddenColumn(e)){return}r.push(n.hot.getDataAtCell(t,e))});l.push(r)});return l}},{key:"getRowHeaders",value:function e(){var t=this;var r=[];if(this.options.rowHeaders){var n=this._getDataRange(),i=n.startRow,a=n.endRow;var o=this.hot.getRowHeader();(0,u.rangeEach)(i,a,function(e){if(!t.options.exportHiddenRows&&t._isHiddenRow(e)){return}r.push(o[e])})}return r}},{key:"getColumnHeaders",value:function e(){var t=this;var r=[];if(this.options.columnHeaders){var n=this._getDataRange(),i=n.startCol,a=n.endCol;var o=this.hot.getColHeader();(0,u.rangeEach)(i,a,function(e){if(!t.options.exportHiddenColumns&&t._isHiddenColumn(e)){return}r.push(o[e])})}return r}},{key:"_getDataRange",value:function e(){var t=this.hot.countCols()-1;var r=this.hot.countRows()-1;var n=(0,d.default)(this.options.range,4),i=n[0],a=i===void 0?0:i,o=n[1],s=o===void 0?0:o,l=n[2],u=l===void 0?r:l,f=n[3],c=f===void 0?t:f;a=Math.max(a,0);s=Math.max(s,0);u=Math.min(u,r);c=Math.min(c,t);return{startRow:a,startCol:s,endRow:u,endCol:c}}},{key:"_isHiddenRow",value:function e(t){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",t)}},{key:"_isHiddenColumn",value:function e(t){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",t)}}]);return t}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=f;t.EXPORT_TYPES=t.TYPE_PDF=t.TYPE_EXCEL=t.TYPE_CSV=void 0;var i=n(r(70));var a=n(r(623));var o="csv";t.TYPE_CSV=o;var s="excel";t.TYPE_EXCEL=s;var l="pdf";t.TYPE_PDF=l;var u=(0,i.default)({},o,a.default);t.EXPORT_TYPES=u;function f(e,t,r){if(typeof u[e]==="function"){return new u[e](t,r)}return null}},function(e,t,r){"use strict";var n=r(0);r(12);r(54);r(148);r(119);r(23);r(38);r(40);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=r(4);var f=r(29);var c=n(r(624));var d=String.fromCharCode(13);var h=String.fromCharCode(34);var v=String.fromCharCode(10);var p=function(e){(0,l.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"export",value:function e(){var r=this;var n=this.options;var t=this.dataProvider.getData();var i=this.dataProvider.getColumnHeaders();var a=i.length>0;var o=this.dataProvider.getRowHeaders();var s=o.length>0;var l=n.bom?String.fromCharCode(65279):"";if(a){i=(0,u.arrayMap)(i,function(e){return r._escapeCell(e,true)});if(s){l+=n.columnDelimiter}l+=i.join(n.columnDelimiter);l+=n.rowDelimiter}(0,u.arrayEach)(t,function(e,t){if(t>0){l+=n.rowDelimiter}if(s){l+=r._escapeCell(o[t])+n.columnDelimiter}l+=e.map(function(e){return r._escapeCell(e)}).join(n.columnDelimiter)});return l}},{key:"_escapeCell",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=(0,f.stringify)(t);if(n!==""&&(r||n.indexOf(d)>=0||n.indexOf(h)>=0||n.indexOf(v)>=0||n.indexOf(this.options.columnDelimiter)>=0)){n=n.replace(new RegExp('"',"g"),'""');n='"'.concat(n,'"')}return n}}],[{key:"DEFAULT_OPTIONS",get:function e(){return{mimeType:"text/csv",fileExtension:"csv",bom:true,columnDelimiter:",",rowDelimiter:"\r\n"}}}]);return t}(c.default);var g=p;t.default=g},function(e,t,r){"use strict";var n=r(0);r(234);t.__esModule=true;t.default=void 0;var a=n(r(1));var o=n(r(2));var s=r(3);var l=r(74);var i=function(){(0,o.default)(i,null,[{key:"DEFAULT_OPTIONS",get:function e(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:false,columnHeaders:false,rowHeaders:false,exportHiddenColumns:false,exportHiddenRows:false,range:[]}}}]);function i(e,t){(0,a.default)(this,i);this.dataProvider=e;this.options=this._mergeOptions(t);this.dataProvider.setOptions(this.options)}(0,o.default)(i,[{key:"_mergeOptions",value:function e(t){var r=(0,s.clone)(this.constructor.DEFAULT_OPTIONS);var n=new Date;r=(0,s.extend)((0,s.clone)(i.DEFAULT_OPTIONS),r);r=(0,s.extend)(r,t);r.filename=(0,l.substitute)(r.filename,{YYYY:n.getFullYear(),MM:"".concat(n.getMonth()+1).padStart(2,"0"),DD:"".concat(n.getDate()).padStart(2,"0")});return r}}]);return i}();var u=i;t.default=u},function(e,t,r){"use strict";var n=r(0);r(19);r(78);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(14));var f=n(r(7));var o=n(r(395));var c=r(93);var d=r(185);var h=r(21);var v=r(151);var p=r(8);var g=r(626);var m=r(627);var y=r(628);r(629);var b="append";var w="multiColumnSorting";var C="columnSorting";(0,c.registerRootComparator)(w,g.rootComparator);var S=function(e){(0,f.default)(o,e);function o(e){var t;(0,i.default)(this,o);t=(0,s.default)(this,(0,l.default)(o).call(this,e));t.pluginKey=w;return t}(0,a.default)(o,[{key:"isEnabled",value:function e(){return(0,u.default)((0,l.default)(o.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function e(){if(!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[C]){(0,m.warnAboutPluginsConflict)()}return(0,u.default)((0,l.default)(o.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){return(0,u.default)((0,l.default)(o.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function e(t){return(0,u.default)((0,l.default)(o.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function e(){return(0,u.default)((0,l.default)(o.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function e(){return(0,u.default)((0,l.default)(o.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function e(t){return(0,u.default)((0,l.default)(o.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function e(t){return(0,u.default)((0,l.default)(o.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(Array.isArray(t)){return t}return[t]}},{key:"updateHeaderClasses",value:function e(t){var r;for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++){i[a-1]=arguments[a]}(r=(0,u.default)((0,l.default)(o.prototype),"updateHeaderClasses",this)).call.apply(r,[this,t].concat(i));(0,p.removeClass)(t,(0,y.getClassedToRemove)(t));if(this.enabled!==false){(0,p.addClass)(t,y.getClassesToAdd.apply(void 0,i))}}},{key:"onUpdateSettings",value:function e(t){if(this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[C]){(0,m.warnAboutPluginsConflict)()}return(0,u.default)((0,l.default)(o.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function e(t,r){if((0,d.wasHeaderClickedProperly)(r.row,r.col,t)===false){return}if(this.wasClickableHeaderClicked(t,r.col)){if((0,v.isPressedCtrlKey)()){this.hot.deselectCell();this.hot.selectColumns(r.col);this.sort(this.getNextSortConfig(r.col,b))}else{this.sort(this.getColumnNextConfig(r.col))}}}}]);return o}(o.default);(0,h.registerPlugin)(w,S);var E=S;t.default=E},function(e,t,r){"use strict";var n=r(0);r(41);t.__esModule=true;t.rootComparator=a;var i=n(r(397));var v=r(93);function a(d,h){return function(e,t){var r=(0,i.default)(e),f=r.slice(1);var n=(0,i.default)(t),c=n.slice(1);return function e(t){var r=d[t];var n=h[t];var i=f[t];var a=c[t];var o=n.multiColumnSorting;var s=o.compareFunctionFactory?o.compareFunctionFactory:(0,v.getCompareFunctionFactory)(n.type);var l=s(r,n,o)(i,a);if(l===v.DO_NOT_SWAP){var u=t+1;if(typeof h[u]!=="undefined"){return e(u)}}return l}(0)}}},function(e,t,r){"use strict";t.__esModule=true;t.warnAboutPluginsConflict=i;var n=r(61);function i(){(0,n.warn)("Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously.")}},function(e,t,r){"use strict";r(50);r(119);r(23);r(38);r(52);t.__esModule=true;t.getClassesToAdd=n;t.getClassedToRemove=a;var i="sort";function n(e,t,r){var n=[];if(r===false){return n}if(e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1){n.push("".concat(i,"-").concat(e.getIndexOfColumnInSortQueue(t)+1))}return n}function a(e){var t=e.className.split(" ");var r=new RegExp("^".concat(i,"-[0-9]{1,2}$"));return t.filter(function(e){return r.test(e)})}},function(e,t,r){},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(19);r(50);r(96);r(31);r(12);r(15);r(33);r(56);r(69);r(10);r(39);r(13);r(97);r(16);t.__esModule=true;t.default=void 0;var a=i(r(72));var o=i(r(18));var s=i(r(1));var l=i(r(2));var f=i(r(6));var c=i(r(28));var d=i(r(5));var h=i(r(14));var v=i(r(7));var u=i(r(22));var p=r(4);var g=r(73);var m=r(61);var y=r(17);var b=i(r(25));var w=r(8);var C=r(21);var S=r(89);var E=n(r(11));var k=i(r(631));var T=i(r(652));var _=i(r(654));var x=i(r(660));var D=i(r(412));var R=i(r(413));var I=i(r(661));var O=r(125);var A=r(189);r(662);function N(){var t=(0,a.default)(["The filter conditions have been applied properly, but couldnât be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldnât be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]);N=function e(){return t};return t}var M=function(e){(0,v.default)(u,e);function u(e){var r;(0,s.default)(this,u);r=(0,f.default)(this,(0,d.default)(u).call(this,e));r.eventManager=new b.default((0,c.default)(r));r.trimRowsPlugin=null;r.dropdownMenuPlugin=null;r.conditionCollection=null;r.conditionUpdateObserver=null;r.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]);r.lastSelectedColumn=null;r.hiddenRowsCache=new Map;r.hot.addHook("afterGetColHeader",function(e,t){return r.onAfterGetColHeader(e,t)});return r}(0,l.default)(u,[{key:"isEnabled",value:function e(){return this.hot.getSettings().filters?true:false}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu;var n=t&&t.uiContainer||this.hot.rootDocument.body;var i=function e(t){t.addLocalHook("accept",function(){return r.onActionBarSubmit("accept")});t.addLocalHook("cancel",function(){return r.onActionBarSubmit("cancel")});t.addLocalHook("change",function(e){return r.onComponentChange(t,e)});return t};var a=function e(){return"".concat(r.hot.getTranslatedPhrase(E.FILTERS_DIVS_FILTER_BY_CONDITION),":")};var o=function e(){return"".concat(r.hot.getTranslatedPhrase(E.FILTERS_DIVS_FILTER_BY_VALUE),":")};if(!this.components.get("filter_by_condition")){var s=new k.default(this.hot,{id:"filter_by_condition",name:a,addSeparator:false,menuContainer:n});s.addLocalHook("afterClose",function(){return r.onSelectUIClosed()});this.components.set("filter_by_condition",i(s))}if(!this.components.get("filter_operators")){this.components.set("filter_operators",new T.default(this.hot,{id:"filter_operators",name:"Operators"}))}if(!this.components.get("filter_by_condition2")){var l=new k.default(this.hot,{id:"filter_by_condition2",name:"",addSeparator:true,menuContainer:n});l.addLocalHook("afterClose",function(){return r.onSelectUIClosed()});this.components.set("filter_by_condition2",i(l))}if(!this.components.get("filter_by_value")){this.components.set("filter_by_value",i(new _.default(this.hot,{id:"filter_by_value",name:o})))}if(!this.components.get("filter_action_bar")){this.components.set("filter_action_bar",i(new x.default(this.hot,{id:"filter_action_bar",name:"Action bar"})))}if(!this.conditionCollection){this.conditionCollection=new D.default}if(!this.conditionUpdateObserver){this.conditionUpdateObserver=new I.default(this.conditionCollection,function(e){return r.getDataMapAtColumn(e)});this.conditionUpdateObserver.addLocalHook("update",function(e){return r.updateComponents(e)})}this.components.forEach(function(e){e.show()});this.registerEvents();this.addHook("beforeDropdownMenuSetItems",function(e){return r.onBeforeDropdownMenuSetItems(e)});this.addHook("afterDropdownMenuDefaultOptions",function(e){return r.onAfterDropdownMenuDefaultOptions(e)});this.addHook("afterDropdownMenuShow",function(){return r.onAfterDropdownMenuShow()});this.addHook("afterDropdownMenuHide",function(){return r.onAfterDropdownMenuHide()});this.addHook("afterChange",function(e){return r.onAfterChange(e)});this.hot.getSettings().trimRows=true;this.trimRowsPlugin.enablePlugin();if(this.hot.getSettings().dropdownMenu){this.dropdownMenuPlugin.disablePlugin();this.dropdownMenuPlugin.enablePlugin()}(0,h.default)((0,d.default)(u.prototype),"enablePlugin",this).call(this)}},{key:"registerEvents",value:function e(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(e){return t.onTableClick(e)})}},{key:"disablePlugin",value:function e(){if(this.enabled){if(this.dropdownMenuPlugin.enabled){this.dropdownMenuPlugin.menu.clearLocalHooks()}this.components.forEach(function(e){e.hide()});this.conditionCollection.clean();this.trimRowsPlugin.untrimAll()}(0,h.default)((0,d.default)(u.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:A.OPERATION_AND;var a=this.t.toPhysicalColumn(t);this.conditionCollection.addCondition(a,{command:{key:r},args:n},i)}},{key:"removeConditions",value:function e(t){var r=this.t.toPhysicalColumn(t);this.conditionCollection.removeConditions(r)}},{key:"clearConditions",value:function e(t){if(t===void 0){this.conditionCollection.clean()}else{var r=this.t.toPhysicalColumn(t);this.conditionCollection.clearConditions(r)}}},{key:"filter",value:function e(){var t=this._createDataFilter();var r=!this.conditionCollection.isEmpty();var n=[];var i=this.conditionCollection.exportAllConditions();var a=this.hot.runHooks("beforeFilter",i);if(a!==false){if(r){var o=[];this.trimRowsPlugin.trimmedRows.length=0;n=(0,p.arrayMap)(t.filter(),function(e){return e.meta.visualRow});var s=(0,O.createArrayAssertion)(n);(0,y.rangeEach)(this.hot.countSourceRows()-1,function(e){if(!s(e)){o.push(e)}});this.trimRowsPlugin.trimRows(o);if(!n.length){this.hot.deselectCell()}}else{this.trimRowsPlugin.untrimAll()}}this.hot.view.wt.wtOverlays.adjustElementsSize(true);this.hot.render();this.clearColumnSelection();this.hot.runHooks("afterFilter",i)}},{key:"getSelectedColumn",value:function e(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function e(){var t=this.hot.getSelectedLast()||[],r=(0,o.default)(t,2),n=r[0],i=r[1];if(n!==void 0&&i!==void 0){this.hot.selectCell(n,i)}}},{key:"getDataMapAtColumn",value:function e(t){var f=this;var c=this.t.toVisualColumn(t);var d=[];(0,p.arrayEach)(this.hot.getSourceDataAtCol(c),function(e,t){var r=f.hot.getCellMeta(t,c),n=r.row,i=r.col,a=r.visualCol,o=r.visualRow,s=r.type,l=r.instance,u=r.dateFormat;d.push({meta:{row:n,col:i,visualCol:a,visualRow:o,type:s,instance:l,dateFormat:u},value:(0,O.toEmptyString)(e)})});return d}},{key:"onAfterChange",value:function e(t){var i=this;if(t){(0,p.arrayEach)(t,function(e){var t=(0,o.default)(e,2),r=t[1];var n=i.hot.propToCol(r);if(i.conditionCollection.hasConditions(n)){i.updateValueComponentCondition(n)}})}}},{key:"updateValueComponentCondition",value:function e(t){var r=this.hot.getDataAtCol(t);var n=(0,O.unifyColumnValues)(r);this.conditionUpdateObserver.updateStatesAtColumn(t,n)}},{key:"restoreComponents",value:function e(t){var r=this.getSelectedColumn();var n=r&&r.physicalIndex;t.forEach(function(e){if(e.isHidden()===false){e.restoreState(n)}})}},{key:"onAfterDropdownMenuShow",value:function e(){this.restoreComponents([this.components.get("filter_by_condition"),this.components.get("filter_operators"),this.components.get("filter_by_condition2"),this.components.get("filter_by_value")])}},{key:"onAfterDropdownMenuHide",value:function e(){this.components.get("filter_by_condition").getSelectElement().closeOptions();this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function e(t){var r=(0,p.arrayMap)(t,function(e){return e.key});this.components.forEach(function(e){e[r.indexOf(e.getMenuItemDescriptor().key)===-1?"hide":"show"]()});this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function e(t){t.items.push({name:S.SEPARATOR});this.components.forEach(function(e){t.items.push(e.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function e(t,r,n,i){var a=t;if(a===A.OPERATION_OR&&r.command.key!==A.CONDITION_NONE&&n.command.key!==A.CONDITION_NONE&&i.command.key!==A.CONDITION_NONE){a=A.OPERATION_OR_THEN_VARIABLE}else if(i.command.key!==A.CONDITION_NONE){if(r.command.key===A.CONDITION_NONE||n.command.key===A.CONDITION_NONE){a=A.OPERATION_AND}}return a}},{key:"onActionBarSubmit",value:function e(t){if(t==="accept"){var r=this.getSelectedColumn();var n=r&&r.physicalIndex;var i=this.components.get("filter_by_condition").getState();var a=this.components.get("filter_by_condition2").getState();var o=this.components.get("filter_by_value").getState();var s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,a,o);this.conditionUpdateObserver.groupChanges();this.conditionCollection.clearConditions(n);if(i.command.key===A.CONDITION_NONE&&a.command.key===A.CONDITION_NONE&&o.command.key===A.CONDITION_NONE){this.conditionCollection.removeConditions(n)}else{if(i.command.key!==A.CONDITION_NONE){this.conditionCollection.addCondition(n,i,s);if(a.command.key!==A.CONDITION_NONE){this.conditionCollection.addCondition(n,a,s)}}if(o.command.key!==A.CONDITION_NONE){this.conditionCollection.addCondition(n,o,s)}}this.conditionUpdateObserver.flush();this.components.get("filter_operators").saveState(n);this.components.get("filter_by_value").saveState(n);this.saveHiddenRowsCache(n);this.trimRowsPlugin.trimmedRows.length=0;this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function e(t,r){if(t===this.components.get("filter_by_condition")){if(r.showOperators){this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))}else{this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))}}if(t.constructor===k.default&&!r.inputsCount){this.setListeningDropdownMenu()}}},{key:"onSelectUIClosed",value:function e(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function e(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function e(t,r){var n=this.t.toPhysicalColumn(t);if(this.enabled&&this.conditionCollection.hasConditions(n)){(0,w.addClass)(r,"htFiltersActive")}else{(0,w.removeClass)(r,"htFiltersActive")}}},{key:"onTableClick",value:function e(t){var r=(0,w.closest)(t.target,"TH");if(r){var n=this.hot.getCoords(r).col;var i=this.t.toPhysicalColumn(n);this.lastSelectedColumn={visualIndex:n,physicalIndex:i}}}},{key:"destroy",value:function e(){if(this.enabled){this.components.forEach(function(e){e.destroy()});this.conditionCollection.destroy();this.conditionUpdateObserver.destroy();this.hiddenRowsCache.clear();this.trimRowsPlugin.disablePlugin()}(0,h.default)((0,d.default)(u.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.conditionCollection;return new R.default(r,function(e){return t.getDataMapAtColumn(e)})}},{key:"updateComponents",value:function e(t){if(!this.dropdownMenuPlugin.enabled){return}var r=t.editedConditionStack.conditions;var n=t.editedConditionStack.column;var i=r.filter(function(e){return e.name===A.CONDITION_BY_VALUE});var a=r.filter(function(e){return e.name!==A.CONDITION_BY_VALUE});var o=this.conditionCollection.columnTypes[n];if(i.length===2||a.length===3){(0,m.warn)((0,g.toSingleLine)(N()))}else{if(a.length>0){this.showComponentForParticularColumn(this.components.get("filter_operators"),n)}this.components.get("filter_by_condition").updateState(a[0],n);this.components.get("filter_by_condition2").updateState(a[1],n);this.components.get("filter_by_value").updateState(t);this.components.get("filter_operators").updateState(o,n)}}},{key:"showComponentForParticularColumn",value:function e(t,r){if(!this.hiddenRowsCache.has(r)){this.hiddenRowsCache.set(r,[])}else{var n=this.getIndexesOfComponents(t);this.removeIndexesFromHiddenRowsCache(r,n)}}},{key:"removeIndexesFromHiddenRowsCache",value:function e(t,r){var n=this.hiddenRowsCache.get(t);(0,p.arrayEach)(r,function(e){if(n.includes(e)){n.splice(n.indexOf(e),1)}})}},{key:"getIndexesOfComponents",value:function e(){var t=this.dropdownMenuPlugin.menu;var n=[];for(var r=arguments.length,i=new Array(r),a=0;a<r;a++){i[a]=arguments[a]}(0,p.arrayEach)(i,function(r){(0,p.arrayEach)(t.menuItems,function(e,t){if(e.key===r.getMenuItemDescriptor().key){n.push(t)}})});return n}},{key:"changeComponentsVisibility",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var r=this.dropdownMenuPlugin.menu;var n=r.hotMenu;var i=n.getPlugin("hiddenRows");for(var a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++){o[s-1]=arguments[s]}var l=this.getIndexesOfComponents.apply(this,o);if(t){i.showRows(l)}else{i.hideRows(l)}n.render()}},{key:"initHiddenRowsCache",value:function e(){var t=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var e=t.lastSelectedColumn.physicalIndex;if(!t.hiddenRowsCache.has(e)){t.hiddenRowsCache.set(e,t.getIndexesOfComponents(t.components.get("filter_operators"),t.components.get("filter_by_condition2")))}t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:t.hiddenRowsCache.get(e)}})})}},{key:"saveHiddenRowsCache",value:function e(t){this.hiddenRowsCache.set(t,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.changeComponentsVisibility.apply(this,[false].concat(r))}},{key:"showComponents",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.changeComponentsVisibility.apply(this,[true].concat(r))}}]);return u}(u.default);(0,C.registerPlugin)("filters",M);var L=M;t.default=L},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(50);r(56);r(153);r(34);t.__esModule=true;t.default=void 0;var s=i(r(37));var a=i(r(1));var l=i(r(2));var u=i(r(6));var f=i(r(5));var c=i(r(14));var d=i(r(7));var h=r(8);var v=r(32);var p=r(4);var g=r(55);var m=r(3);var y=n(r(11));var o=i(r(154));var b=n(r(189));var w=i(r(191));var C=i(r(651));var S=r(30);var E=function(e){(0,d.default)(o,e);function o(e,t){var r;(0,a.default)(this,o);r=(0,u.default)(this,(0,f.default)(o).call(this,e));r.id=t.id;r.name=t.name;r.addSeparator=t.addSeparator;r.elements.push(new C.default(r.hot,{menuContainer:t.menuContainer}));r.elements.push(new w.default(r.hot,{placeholder:y.FILTERS_BUTTONS_PLACEHOLDER_VALUE}));r.elements.push(new w.default(r.hot,{placeholder:y.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE}));r.registerHooks();return r}(0,l.default)(o,[{key:"registerHooks",value:function e(){var t=this;this.getSelectElement().addLocalHook("select",function(e){return t.onConditionSelect(e)});this.getSelectElement().addLocalHook("afterClose",function(){return t.onSelectUIClosed()});(0,p.arrayEach)(this.getInputElements(),function(e){e.addLocalHook("keydown",function(e){return t.onInputKeyDown(e)})})}},{key:"setState",value:function e(t){var n=this;this.reset();if(t){var i=(0,m.clone)(t.command);if(i.name.startsWith(y.FILTERS_CONDITIONS_NAMESPACE)){i.name=this.hot.getTranslatedPhrase(i.name)}this.getSelectElement().setValue(i);(0,p.arrayEach)(t.args,function(e,t){if(t>i.inputsCount-1){return false}var r=n.getInputElement(t);r.setValue(e);r[i.inputsCount>t?"show":"hide"]();if(!t){setTimeout(function(){return r.focus()},10)}})}}},{key:"getState",value:function e(){var r=this.getSelectElement().getValue()||(0,S.getConditionDescriptor)(b.CONDITION_NONE);var n=[];(0,p.arrayEach)(this.getInputElements(),function(e,t){if(r.inputsCount>t){n.push(e.getValue())}});return{command:r,args:n}}},{key:"updateState",value:function e(t,r){var n=t?(0,S.getConditionDescriptor)(t.name):(0,S.getConditionDescriptor)(b.CONDITION_NONE);this.setCachedState(r,{command:n,args:t?t.args:[]});if(!t){(0,p.arrayEach)(this.getInputElements(),function(e){return e.setValue(null)})}}},{key:"getSelectElement",value:function e(){return this.elements.filter(function(e){return e instanceof C.default})[0]}},{key:"getInputElement",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function e(){return this.elements.filter(function(e){return e instanceof w.default})}},{key:"getMenuItemDescriptor",value:function e(){var l=this;return{key:this.id,name:this.name,isCommand:false,disableSelection:true,hidden:function e(){return l.isHidden()},renderer:function e(t,r,n,i,a,o){(0,h.addClass)(r.parentNode,"htFiltersMenuCondition");if(l.addSeparator){(0,h.addClass)(r.parentNode,"border")}var s=l.hot.rootDocument.createElement("div");(0,h.addClass)(s,"htFiltersMenuLabel");s.textContent=o;r.appendChild(s);if(!r.parentNode.hasAttribute("ghost-table")){(0,p.arrayEach)(l.elements,function(e){return r.appendChild(e.element)})}return r}}}},{key:"reset",value:function e(){var t;var r=this.hot.getPlugin("filters").getSelectedColumn();var n=r&&r.visualIndex;var i=(t=this.hot).getDataType.apply(t,(0,s.default)(this.hot.getSelectedLast()||[0,n]));var a=(0,b.default)(i);(0,p.arrayEach)(this.getInputElements(),function(e){return e.hide()});this.getSelectElement().setItems(a);(0,c.default)((0,f.default)(o.prototype),"reset",this).call(this);this.getSelectElement().setValue(a[0])}},{key:"onConditionSelect",value:function e(r){(0,p.arrayEach)(this.getInputElements(),function(e,t){e[r.inputsCount>t?"show":"hide"]();if(!t){setTimeout(function(){return e.focus()},10)}});this.runLocalHooks("change",r)}},{key:"onSelectUIClosed",value:function e(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function e(t){if((0,g.isKey)(t.keyCode,"ENTER")){this.runLocalHooks("accept");(0,v.stopImmediatePropagation)(t)}else if((0,g.isKey)(t.keyCode,"ESCAPE")){this.runLocalHooks("cancel");(0,v.stopImmediatePropagation)(t)}}}]);return o}(o.default);var k=E;t.default=k},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(70));var a=r(3);var o;var s="stateSaver";var l="state_";var u="_states";var f=function e(t,r){return t[u][l+r]};var c=function e(t,r,n){t[u][l+r]=n};var d=(o={},(0,i.default)(o,u,{}),(0,i.default)(o,"getCachedState",function e(t){return f(this,t)}),(0,i.default)(o,"setCachedState",function e(t,r){c(this,t,r)}),(0,i.default)(o,"saveState",function e(t){c(this,t,this.getState())}),(0,i.default)(o,"restoreState",function e(t){this.setState(f(this,t))}),(0,i.default)(o,"hasSavedState",function e(t){return f(this,t)!==void 0}),(0,i.default)(o,"clearState",function e(t){c(this,t)}),(0,i.default)(o,"clearStates",function e(){this[u]={}}),o);(0,a.defineGetter)(d,"MIXIN_NAME",s,{writable:false,enumerable:false});var h=d;t.default=h},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.condition=s;t.CONDITION_NAME=void 0;var i=n(r(11));var a=r(30);var o="none";t.CONDITION_NAME=o;function s(){return true}(0,a.registerCondition)(o,s,{name:i.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:false})},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.condition=l;t.CONDITION_NAME=void 0;var i=n(r(11));var a=r(30);var o=r(404);var s="not_empty";t.CONDITION_NAME=s;function l(e,t){return!(0,a.getCondition)(o.CONDITION_NAME,t)(e)}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:true})},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.condition=l;t.CONDITION_NAME=void 0;var i=n(r(11));var a=r(30);var o=r(405);var s="neq";t.CONDITION_NAME=s;function l(e,t){return!(0,a.getCondition)(o.CONDITION_NAME,t)(e)}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(30);var l="gt";t.CONDITION_NAME=l;function u(e,t){var r=(0,a.default)(t,1),n=r[0];var i=n;if(e.meta.type==="numeric"){i=parseFloat(i,10)}return e.value>i}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(30);var l="gte";t.CONDITION_NAME=l;function u(e,t){var r=(0,a.default)(t,1),n=r[0];var i=n;if(e.meta.type==="numeric"){i=parseFloat(i,10)}return e.value>=i}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(30);var l="lt";t.CONDITION_NAME=l;function u(e,t){var r=(0,a.default)(t,1),n=r[0];var i=n;if(e.meta.type==="numeric"){i=parseFloat(i,10)}return e.value<i}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(30);var l="lte";t.CONDITION_NAME=l;function u(e,t){var r=(0,a.default)(t,1),n=r[0];var i=n;if(e.meta.type==="numeric"){i=parseFloat(i,10)}return e.value<=i}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.condition=l;t.CONDITION_NAME=void 0;var i=n(r(11));var a=r(30);var o=r(406);var s="not_between";t.CONDITION_NAME=s;function l(e,t){return!(0,a.getCondition)(o.CONDITION_NAME,t)(e)}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(153);t.__esModule=true;t.condition=f;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(29);var l=r(30);var u="begins_with";t.CONDITION_NAME=u;function f(e,t){var r=(0,a.default)(t,1),n=r[0];return(0,s.stringify)(e.value).toLowerCase().startsWith((0,s.stringify)(n))}(0,l.registerCondition)(u,f,{name:o.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(643);t.__esModule=true;t.condition=f;t.CONDITION_NAME=void 0;var a=i(r(18));var o=n(r(11));var s=r(29);var l=r(30);var u="ends_with";t.CONDITION_NAME=u;function f(e,t){var r=(0,a.default)(t,1),n=r[0];return(0,s.stringify)(e.value).toLowerCase().endsWith((0,s.stringify)(n))}(0,l.registerCondition)(u,f,{name:o.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(20);var i=r(79).f;var s=r(49);var l=r(175);var u=r(53);var a=r(176);var o=r(94);var f="".endsWith;var c=Math.min;var d=a("endsWith");var h=!o&&!d&&!!function(){var e=i(String.prototype,"endsWith");return e&&!e.writable}();n({target:"String",proto:true,forced:!h&&!d},{endsWith:function e(t){var r=String(u(this));l(t);var n=arguments.length>1?arguments[1]:undefined;var i=s(r.length);var a=n===undefined?i:c(s(n),i);var o=String(t);return f?f.call(r,o,a):r.slice(a-o.length,a)===o}})},function(e,t,r){"use strict";var n=r(9);t.__esModule=true;t.condition=l;t.CONDITION_NAME=void 0;var i=n(r(11));var a=r(30);var o=r(409);var s="not_contains";t.CONDITION_NAME=s;function l(e,t){return!(0,a.getCondition)(o.CONDITION_NAME,t)(e)}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:true})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(64));var o=n(r(11));var s=r(30);var l="date_tomorrow";t.CONDITION_NAME=l;function u(e){var t=(0,a.default)(e.value,e.meta.dateFormat);if(!t.isValid()){return false}return t.isSame((0,a.default)().subtract(-1,"days").startOf("day"),"d")}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(64));var o=n(r(11));var s=r(30);var l="date_today";t.CONDITION_NAME=l;function u(e){var t=(0,a.default)(e.value,e.meta.dateFormat);if(!t.isValid()){return false}return t.isSame((0,a.default)().startOf("day"),"d")}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_TODAY,inputsCount:0})},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.condition=u;t.CONDITION_NAME=void 0;var a=i(r(64));var o=n(r(11));var s=r(30);var l="date_yesterday";t.CONDITION_NAME=l;function u(e){var t=(0,a.default)(e.value,e.meta.dateFormat);if(!t.isValid()){return false}return t.isSame((0,a.default)().subtract(1,"days").startOf("day"),"d")}(0,s.registerCondition)(l,u,{name:o.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.condition=l;t.CONDITION_NAME=void 0;var i=n(r(18));var a=r(30);var o=r(125);var s="by_value";t.CONDITION_NAME=s;function l(e,t){var r=(0,i.default)(t,1),n=r[0];return n(e.value)}(0,a.registerCondition)(s,l,{name:"By value",inputsCount:0,inputValuesDecorator:function e(t){var r=(0,i.default)(t,1),n=r[0];return[(0,o.createArrayAssertion)(n)]},showOperators:false})},function(e,t,r){"use strict";t.__esModule=true;t.condition=a;t.CONDITION_NAME=void 0;var n=r(30);var i="true";t.CONDITION_NAME=i;function a(){return true}(0,n.registerCondition)(i,a,{name:"True"})},function(e,t,r){"use strict";t.__esModule=true;t.condition=a;t.CONDITION_NAME=void 0;var n=r(30);var i="false";t.CONDITION_NAME=i;function a(){return false}(0,n.registerCondition)(i,a,{name:"False"})},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(15);r(56);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var o=i(r(1));var s=i(r(6));var l=i(r(28));var u=i(r(5));var f=i(r(14));var c=i(r(2));var d=i(r(7));var h=i(r(187));var v=r(3);var p=r(4);var g=n(r(11));var m=r(89);var y=i(r(127));var b=new WeakMap;var a=function(e){(0,d.default)(a,e);(0,c.default)(a,null,[{key:"DEFAULTS",get:function e(){return(0,v.clone)({className:"htUISelect",wrapIt:false})}}]);function a(e,t){var r;(0,o.default)(this,a);r=(0,s.default)(this,(0,u.default)(a).call(this,e,(0,v.extend)(a.DEFAULTS,t)));b.set((0,l.default)(r),{});r.menu=null;r.items=[];r.registerHooks();return r}(0,c.default)(a,[{key:"registerHooks",value:function e(){var t=this;this.addLocalHook("click",function(){return t.onClick()})}},{key:"setItems",value:function e(t){this.items=this.translateNames(t);if(this.menu){this.menu.setMenuItems(this.items)}}},{key:"translateNames",value:function e(t){var r=this;(0,p.arrayEach)(t,function(e){e.name=r.translateIfPossible(e.name)});return t}},{key:"build",value:function e(){var t=this;(0,f.default)((0,u.default)(a.prototype),"build",this).call(this);this.menu=new h.default(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:false,standalone:true,container:this.options.menuContainer});this.menu.setMenuItems(this.items);var r=new y.default(this.hot,{className:"htUISelectCaption"});var n=new y.default(this.hot,{className:"htUISelectDropdown"});var i=b.get(this);i.caption=r;i.captionElement=r.element;i.dropdown=n;(0,p.arrayEach)([r,n],function(e){return t._element.appendChild(e.element)});this.menu.addLocalHook("select",function(e){return t.onMenuSelect(e)});this.menu.addLocalHook("afterClose",function(){return t.onMenuClosed()});this.update()}},{key:"update",value:function e(){if(!this.isBuilt()){return}var t;if(this.options.value){t=this.options.value.name}else{t=this.menu.hot.getTranslatedPhrase(g.FILTERS_CONDITIONS_NONE)}b.get(this).captionElement.textContent=t;(0,f.default)((0,u.default)(a.prototype),"update",this).call(this)}},{key:"openOptions",value:function e(){var t=this.element.getBoundingClientRect();if(this.menu){this.menu.open();this.menu.setPosition({left:t.left-5,top:t.top,width:t.width,height:t.height})}}},{key:"closeOptions",value:function e(){if(this.menu){this.menu.close()}}},{key:"onMenuSelect",value:function e(t){if(t.name!==m.SEPARATOR){this.options.value=t;this.update();this.runLocalHooks("select",this.options.value)}}},{key:"onMenuClosed",value:function e(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function e(){this.openOptions()}},{key:"destroy",value:function e(){if(this.menu){this.menu.destroy();this.menu=null}var t=b.get(this),r=t.caption,n=t.dropdown;if(r){r.destroy()}if(n){n.destroy()}(0,f.default)((0,u.default)(a.prototype),"destroy",this).call(this)}}]);return a}(y.default);var w=a;t.default=w},function(e,t,r){"use strict";var n=r(0);r(146);r(56);t.__esModule=true;t.default=void 0;var i=n(r(72));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var f=r(8);var c=r(4);var d=r(73);var h=n(r(154));var v=r(126);var p=r(190);var g=r(410);var m=r(411);var y=n(r(653));function b(){var t=(0,i.default)(["Radio button with index "," doesn't exist."]);b=function e(){return t};return t}var w=0;var C=function(e){(0,u.default)(n,e);function n(e,t){var r;(0,a.default)(this,n);r=(0,s.default)(this,(0,l.default)(n).call(this,e));r.id=t.id;r.name=t.name;r.buildOperatorsElement();return r}(0,o.default)(n,[{key:"getMenuItemDescriptor",value:function e(){var n=this;return{key:this.id,name:this.name,isCommand:false,disableSelection:true,hidden:function e(){return n.isHidden()},renderer:function e(t,r){(0,f.addClass)(r.parentNode,"htFiltersMenuOperators");if(!r.parentNode.hasAttribute("ghost-table")){(0,c.arrayEach)(n.elements,function(e){return r.appendChild(e.element)})}return r}}}},{key:"buildOperatorsElement",value:function e(){var r=this;var n=[p.OPERATION_ID,g.OPERATION_ID];(0,c.arrayEach)(n,function(e){var t=new y.default(r.hot,{name:"operator",label:{htmlFor:e,textContent:(0,v.getOperationName)(e)},value:e,checked:e===n[w],id:e});t.addLocalHook("change",function(e){return r.onRadioInputChange(e)});r.elements.push(t)})}},{key:"setChecked",value:function e(r){if(this.elements.length<r){throw Error((0,d.toSingleLine)(b(),r))}(0,c.arrayEach)(this.elements,function(e,t){e.setChecked(t===r)})}},{key:"getActiveOperationId",value:function e(){var t=this.elements.find(function(e){return e instanceof y.default&&e.isChecked()});if(t){return t.getValue()}return p.OPERATION_ID}},{key:"getState",value:function e(){return this.getActiveOperationId()}},{key:"setState",value:function e(t){this.reset();if(t&&this.getActiveOperationId()!==t){(0,c.arrayEach)(this.elements,function(e){e.setChecked(e.getValue()===t)})}}},{key:"updateState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:p.OPERATION_ID;var r=arguments.length>1?arguments[1]:undefined;var n=t;if(n===m.OPERATION_ID){n=g.OPERATION_ID}this.setCachedState(r,n)}},{key:"reset",value:function e(){this.setChecked(w)}},{key:"onRadioInputChange",value:function e(t){this.setState(t.realTarget.value)}}]);return n}(h.default);var S=C;t.default=S},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(28));var s=n(r(5));var l=n(r(14));var u=n(r(2));var f=n(r(7));var c=r(3);var d=n(r(127));var h=new WeakMap;var v=function(e){(0,f.default)(n,e);(0,u.default)(n,null,[{key:"DEFAULTS",get:function e(){return(0,c.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]);function n(e,t){var r;(0,i.default)(this,n);r=(0,a.default)(this,(0,s.default)(n).call(this,e,(0,c.extend)(n.DEFAULTS,t)));h.set((0,o.default)(r),{});return r}(0,u.default)(n,[{key:"build",value:function e(){(0,l.default)((0,s.default)(n.prototype),"build",this).call(this);var t=h.get(this);t.input=this._element.firstChild;var r=this.hot.rootDocument.createElement("label");r.textContent=this.translateIfPossible(this.options.label.textContent);r.htmlFor=this.translateIfPossible(this.options.label.htmlFor);t.label=r;this._element.appendChild(r);this.update()}},{key:"update",value:function e(){if(!this.isBuilt()){return}var t=h.get(this);t.input.checked=this.options.checked;t.label.textContent=this.translateIfPossible(this.options.label.textContent)}},{key:"isChecked",value:function e(){return this.options.checked}},{key:"setChecked",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.options.checked=t;this.update()}},{key:"focus",value:function e(){if(this.isBuilt()){h.get(this).input.focus()}}}]);return n}(d.default);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(50);r(56);t.__esModule=true;t.default=void 0;var p=i(r(18));var a=i(r(1));var o=i(r(2));var s=i(r(6));var l=i(r(5));var u=i(r(14));var f=i(r(7));var c=r(8);var d=r(32);var g=r(4);var h=r(55);var m=n(r(11));var y=r(125);var v=i(r(154));var b=i(r(655));var w=r(189);var C=r(30);var S=function(e){(0,f.default)(i,e);function i(e,t){var r;(0,a.default)(this,i);r=(0,s.default)(this,(0,l.default)(i).call(this,e));r.id=t.id;r.name=t.name;r.elements.push(new b.default(r.hot));r.registerHooks();return r}(0,o.default)(i,[{key:"registerHooks",value:function e(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",function(e){return t.onInputKeyDown(e)})}},{key:"setState",value:function e(t){this.reset();if(t&&t.command.key===w.CONDITION_BY_VALUE){var r=this.getMultipleSelectElement();r.setItems(t.itemsSnapshot);r.setValue(t.args[0])}}},{key:"getState",value:function e(){var t=this.getMultipleSelectElement();var r=t.getItems();return{command:{key:t.isSelectedAllValues()||!r.length?w.CONDITION_NONE:w.CONDITION_BY_VALUE},args:[t.getValue()],itemsSnapshot:r}}},{key:"updateState",value:function e(t){var v=this;var r=function e(t,r,n,i,a){var o=(0,g.arrayFilter)(r,function(e){return e.name===w.CONDITION_BY_VALUE}),s=(0,p.default)(o,1),l=s[0];var u={};var f=v.hot.getTranslatedPhrase(m.FILTERS_VALUES_BLANK_CELLS);if(l){var c=(0,g.arrayMap)(i(t,a),function(e){return e.value});c=(0,y.unifyColumnValues)(c);if(n){l.args[0]=n}var d=[];var h=(0,y.intersectValues)(c,l.args[0],f,function(e){if(e.checked){d.push(e.value)}});u.args=[d];u.command=(0,C.getConditionDescriptor)(w.CONDITION_BY_VALUE);u.itemsSnapshot=h}else{u.args=[];u.command=(0,C.getConditionDescriptor)(w.CONDITION_NONE)}v.setCachedState(t,u)};r(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory);if(t.dependentConditionStacks.length){r(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}}},{key:"getMultipleSelectElement",value:function e(){return this.elements.filter(function(e){return e instanceof b.default})[0]}},{key:"getMenuItemDescriptor",value:function e(){var l=this;return{key:this.id,name:this.name,isCommand:false,disableSelection:true,hidden:function e(){return l.isHidden()},renderer:function e(t,r,n,i,a,o){(0,c.addClass)(r.parentNode,"htFiltersMenuValue");var s=l.hot.rootDocument.createElement("div");(0,c.addClass)(s,"htFiltersMenuLabel");s.textContent=o;r.appendChild(s);if(!r.parentNode.hasAttribute("ghost-table")){(0,g.arrayEach)(l.elements,function(e){return r.appendChild(e.element)})}return r}}}},{key:"reset",value:function e(){var t=this.hot.getTranslatedPhrase(m.FILTERS_VALUES_BLANK_CELLS);var r=(0,y.unifyColumnValues)(this._getColumnVisibleValues());var n=(0,y.intersectValues)(r,r,t);this.getMultipleSelectElement().setItems(n);(0,u.default)((0,l.default)(i.prototype),"reset",this).call(this);this.getMultipleSelectElement().setValue(r)}},{key:"onInputKeyDown",value:function e(t){if((0,h.isKey)(t.keyCode,"ESCAPE")){this.runLocalHooks("cancel");(0,d.stopImmediatePropagation)(t)}}},{key:"_getColumnVisibleValues",value:function e(){var t=this.hot.getPlugin("filters").getSelectedColumn();var r=t&&t.visualIndex;return(0,g.arrayMap)(this.hot.getDataAtCol(r),function(e){return(0,y.toEmptyString)(e)})}}]);return i}(v.default);var E=S;t.default=E},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(12);r(15);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var a=i(r(37));var s=i(r(1));var l=i(r(6));var u=i(r(28));var f=i(r(5));var c=i(r(14));var d=i(r(2));var h=i(r(7));var v=r(8);var p=r(3);var g=r(4);var m=r(55);var y=r(77);var b=n(r(11));var w=r(32);var C=i(r(127));var S=i(r(191));var E=i(r(656));var o=r(125);var k=new WeakMap;var T=function(e){(0,h.default)(o,e);(0,d.default)(o,null,[{key:"DEFAULTS",get:function e(){return(0,p.clone)({className:"htUIMultipleSelect",value:[]})}}]);function o(e,t){var r;(0,s.default)(this,o);r=(0,l.default)(this,(0,f.default)(o).call(this,e,(0,p.extend)(o.DEFAULTS,t)));k.set((0,u.default)(r),{});r.searchInput=new S.default(r.hot,{placeholder:b.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"});r.selectAllUI=new E.default(r.hot,{textContent:b.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"});r.clearAllUI=new E.default(r.hot,{textContent:b.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"});r.items=[];r.itemsBox=null;r.registerHooks();return r}(0,d.default)(o,[{key:"registerHooks",value:function e(){var t=this;this.searchInput.addLocalHook("keydown",function(e){return t.onInputKeyDown(e)});this.searchInput.addLocalHook("input",function(e){return t.onInput(e)});this.selectAllUI.addLocalHook("click",function(e){return t.onSelectAllClick(e)});this.clearAllUI.addLocalHook("click",function(e){return t.onClearAllClick(e)})}},{key:"setItems",value:function e(t){this.items=t;if(this.itemsBox){this.itemsBox.loadData(this.items)}}},{key:"getItems",value:function e(){return(0,a.default)(this.items)}},{key:"getValue",value:function e(){return D(this.items)}},{key:"isSelectedAllValues",value:function e(){return this.items.length===this.getValue().length}},{key:"build",value:function e(){var r=this;(0,c.default)((0,f.default)(o.prototype),"build",this).call(this);var n=this.hot.rootDocument;var t=n.createElement("div");var i=new C.default(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element);this._element.appendChild(i.element);this._element.appendChild(t);var a=function e(t){if(!r._element){return}if(r.itemsBox){r.itemsBox.destroy()}(0,v.addClass)(t,"htUIMultipleSelectHot");r.itemsBox=new r.hot.constructor(t,{data:r.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function e(t,r,n,i,a,o){t.title=o.instance.getDataAtRowProp(r,o.label.property)},autoWrapCol:true,height:110,colWidths:function e(){return r.itemsBox.container.scrollWidth-(0,v.getScrollbarWidth)(n)},copyPaste:false,disableVisualSelection:"area",fillHandle:false,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function e(t){return r.onItemsBoxBeforeKeyDown(t)}});r.itemsBox.init()};a(t);setTimeout(function(){return a(t)},100)}},{key:"reset",value:function e(){this.searchInput.reset();this.selectAllUI.reset();this.clearAllUI.reset()}},{key:"update",value:function e(){if(!this.isBuilt()){return}this.itemsBox.loadData(x(this.items,this.options.value));(0,c.default)((0,f.default)(o.prototype),"update",this).call(this)}},{key:"destroy",value:function e(){if(this.itemsBox){this.itemsBox.destroy()}this.searchInput.destroy();this.clearAllUI.destroy();this.selectAllUI.destroy();this.searchInput=null;this.clearAllUI=null;this.selectAllUI=null;this.itemsBox=null;this.items=null;(0,c.default)((0,f.default)(o.prototype),"destroy",this).call(this)}},{key:"onInput",value:function e(t){var r=t.target.value.toLowerCase();var n;if(r===""){n=(0,a.default)(this.items)}else{n=(0,g.arrayFilter)(this.items,function(e){return"".concat(e.value).toLowerCase().indexOf(r)>=0})}this.itemsBox.loadData(n)}},{key:"onInputKeyDown",value:function e(t){this.runLocalHooks("keydown",t,this);var r=(0,y.partial)(m.isKey,t.keyCode);if(r("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()){(0,w.stopImmediatePropagation)(t);this.itemsBox.listen();this.itemsBox.selectCell(0,0)}}},{key:"onItemsBoxBeforeKeyDown",value:function e(t){var r=(0,y.partial)(m.isKey,t.keyCode);if(r("ESCAPE")){this.runLocalHooks("keydown",t,this)}if(!r("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")){(0,w.stopImmediatePropagation)(t);this.itemsBox.unlisten();this.itemsBox.deselectCell();this.searchInput.focus()}}},{key:"onSelectAllClick",value:function e(t){t.preventDefault();(0,g.arrayEach)(this.itemsBox.getSourceData(),function(e){e.checked=true});this.itemsBox.render()}},{key:"onClearAllClick",value:function e(t){t.preventDefault();(0,g.arrayEach)(this.itemsBox.getSourceData(),function(e){e.checked=false});this.itemsBox.render()}}]);return o}(C.default);var _=T;t.default=_;function x(e,t){var r=(0,o.createArrayAssertion)(t);return(0,g.arrayMap)(e,function(e){e.checked=r(e.value);return e})}function D(e){var t=[];(0,g.arrayEach)(e,function(e){if(e.checked){t.push(e.value)}});return t}},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(13);r(657);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(6));var o=n(r(28));var s=n(r(5));var l=n(r(14));var u=n(r(2));var f=n(r(7));var c=r(3);var d=n(r(127));var h=new WeakMap;var v=function(e){(0,f.default)(n,e);(0,u.default)(n,null,[{key:"DEFAULTS",get:function e(){return(0,c.clone)({href:"#",tagName:"a"})}}]);function n(e,t){var r;(0,i.default)(this,n);r=(0,a.default)(this,(0,s.default)(n).call(this,e,(0,c.extend)(n.DEFAULTS,t)));h.set((0,o.default)(r),{});return r}(0,u.default)(n,[{key:"build",value:function e(){(0,l.default)((0,s.default)(n.prototype),"build",this).call(this);var t=h.get(this);t.link=this._element.firstChild}},{key:"update",value:function e(){if(!this.isBuilt()){return}h.get(this).link.textContent=this.translateIfPossible(this.options.textContent)}}]);return n}(d.default);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(20);var i=r(658);var a=r(659);n({target:"String",proto:true,forced:a("link")},{link:function e(t){return i(this,"a","href",t)}})},function(e,t,r){var o=r(53);var s=/"/g;e.exports=function(e,t,r,n){var i=String(o(e));var a="<"+t;if(r!=="")a+=" "+r+'="'+String(n).replace(s,"&quot;")+'"';return a+">"+i+"</"+t+">"}},function(e,t,r){var n=r(26);e.exports=function(t){return n(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})}},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(56);t.__esModule=true;t.default=void 0;var a=i(r(1));var o=i(r(6));var s=i(r(5));var l=i(r(2));var u=i(r(7));var f=r(8);var c=r(4);var d=n(r(11));var h=i(r(154));var v=i(r(191));var p=function(e){(0,u.default)(n,e);(0,l.default)(n,null,[{key:"BUTTON_OK",get:function e(){return"ok"}},{key:"BUTTON_CANCEL",get:function e(){return"cancel"}}]);function n(e,t){var r;(0,a.default)(this,n);r=(0,o.default)(this,(0,s.default)(n).call(this,e));r.id=t.id;r.name=t.name;r.elements.push(new v.default(r.hot,{type:"button",value:d.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:n.BUTTON_OK}));r.elements.push(new v.default(r.hot,{type:"button",value:d.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:n.BUTTON_CANCEL}));r.registerHooks();return r}(0,l.default)(n,[{key:"registerHooks",value:function e(){var r=this;(0,c.arrayEach)(this.elements,function(e){e.addLocalHook("click",function(e,t){return r.onButtonClick(e,t)})})}},{key:"getMenuItemDescriptor",value:function e(){var n=this;return{key:this.id,name:this.name,isCommand:false,disableSelection:true,hidden:function e(){return n.isHidden()},renderer:function e(t,r){(0,f.addClass)(r.parentNode,"htFiltersMenuActionBar");if(!r.parentNode.hasAttribute("ghost-table")){(0,c.arrayEach)(n.elements,function(e){return r.appendChild(e.element)})}return r}}}},{key:"accept",value:function e(){this.runLocalHooks("accept")}},{key:"cancel",value:function e(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function e(t,r){if(r.options.identifier===n.BUTTON_OK){this.accept()}else{this.cancel()}}}]);return n}(h.default);var g=p;t.default=g},function(e,t,r){"use strict";var n=r(0);r(19);r(50);r(12);r(41);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var f=r(4);var o=r(3);var c=r(77);var s=n(r(62));var d=n(r(412));var h=n(r(413));var v=r(125);var l=function(){function n(e){var t=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return[]};(0,i.default)(this,n);this.conditionCollection=e;this.columnDataFactory=r;this.changes=[];this.grouping=false;this.latestEditedColumnPosition=-1;this.latestOrderStack=[];this.conditionCollection.addLocalHook("beforeRemove",function(e){return t._onConditionBeforeModify(e)});this.conditionCollection.addLocalHook("afterAdd",function(e){return t.updateStatesAtColumn(e)});this.conditionCollection.addLocalHook("afterClear",function(e){return t.updateStatesAtColumn(e)});this.conditionCollection.addLocalHook("beforeClean",function(){return t._onConditionBeforeClean()});this.conditionCollection.addLocalHook("afterClean",function(){return t._onConditionAfterClean()})}(0,a.default)(n,[{key:"groupChanges",value:function e(){this.grouping=true}},{key:"flush",value:function e(){var t=this;this.grouping=false;(0,f.arrayEach)(this.changes,function(e){t.updateStatesAtColumn(e)});this.changes.length=0}},{key:"_onConditionBeforeModify",value:function e(t){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(t)}},{key:"updateStatesAtColumn",value:function e(t,r){var l=this;if(this.grouping){if(this.changes.indexOf(t)===-1){this.changes.push(t)}return}var n=this.conditionCollection.exportAllConditions();var i=this.conditionCollection.orderStack.indexOf(t);if(i===-1){i=this.latestEditedColumnPosition}var a=n.slice(0,i);var o=n.slice(i);if(o.length&&o[0].column===t){o.shift()}var s=(0,c.curry)(function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var n=new d.default;var i=[].concat(e,r);n.importAllConditions(i);var a=l.columnDataFactory(t);var o;if(n.isEmpty()){o=a}else{o=new h.default(n,function(e){return l.columnDataFactory(e)}).filter()}o=(0,f.arrayMap)(o,function(e){return e.meta.visualRow});var s=(0,v.createArrayAssertion)(o);return(0,f.arrayFilter)(a,function(e){return s(e.meta.visualRow)})})(a);var u=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:u},dependentConditionStacks:o,filteredRowsFactory:s,conditionArgsChange:r})}},{key:"_onConditionBeforeClean",value:function e(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function e(){var t=this;(0,f.arrayEach)(this.latestOrderStack,function(e){t.updateStatesAtColumn(e)})}},{key:"destroy",value:function e(){var r=this;this.clearLocalHooks();(0,o.objectEach)(this,function(e,t){r[t]=null})}}]);return n}();(0,o.mixin)(l,s.default);var u=l;t.default=u},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var f=n(r(18));var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var c=n(r(7));var d=n(r(22));var h=r(4);var v=r(3);var p=n(r(25));var g=r(21);var m=r(90);var y=n(r(664));var b=n(r(673));var w=n(r(674));var C=function(e){(0,c.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,l.default)(n).call(this,e));t.eventManager=new p.default((0,s.default)(t));t.dataProvider=new b.default(t.hot);t.sheet=new y.default(t.hot,t.dataProvider);t.undoRedoSnapshot=new w.default(t.sheet);t._skipRendering=false;return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return this.hot.getSettings().formulas?true:false}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}var t=this.hot.getSettings().formulas;if((0,v.isObject)(t)){if((0,v.isObject)(t.variables)){(0,v.objectEach)(t.variables,function(e,t){return r.setVariable(t,e)})}}this.addHook("afterColumnSort",function(){return r.onAfterColumnSort.apply(r,arguments)});this.addHook("afterCreateCol",function(){return r.onAfterCreateCol.apply(r,arguments)});this.addHook("afterCreateRow",function(){return r.onAfterCreateRow.apply(r,arguments)});this.addHook("afterLoadData",function(){return r.onAfterLoadData()});this.addHook("afterRemoveCol",function(){return r.onAfterRemoveCol.apply(r,arguments)});this.addHook("afterRemoveRow",function(){return r.onAfterRemoveRow.apply(r,arguments)});this.addHook("afterSetDataAtCell",function(){return r.onAfterSetDataAtCell.apply(r,arguments)});this.addHook("afterSetDataAtRowProp",function(){return r.onAfterSetDataAtCell.apply(r,arguments)});this.addHook("beforeColumnSort",function(){return r.onBeforeColumnSort.apply(r,arguments)});this.addHook("beforeCreateCol",function(){return r.onBeforeCreateCol.apply(r,arguments)});this.addHook("beforeCreateRow",function(){return r.onBeforeCreateRow.apply(r,arguments)});this.addHook("beforeRemoveCol",function(){return r.onBeforeRemoveCol.apply(r,arguments)});this.addHook("beforeRemoveRow",function(){return r.onBeforeRemoveRow.apply(r,arguments)});this.addHook("beforeValidate",function(){return r.onBeforeValidate.apply(r,arguments)});this.addHook("beforeValueRender",function(){return r.onBeforeValueRender.apply(r,arguments)});this.addHook("modifyData",function(){return r.onModifyData.apply(r,arguments)});this.sheet.addLocalHook("afterRecalculate",function(){return r.onSheetAfterRecalculate.apply(r,arguments)});(0,u.default)((0,l.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){(0,u.default)((0,l.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function e(t,r){var n=this.sheet.getCellAt(t,r);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function e(t,r){return this.sheet.getCellAt(t,r)!==null}},{key:"recalculate",value:function e(){this.sheet.recalculate()}},{key:"recalculateFull",value:function e(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function e(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function e(t,r){this.sheet.setVariable(t,r)}},{key:"getVariable",value:function e(t){return this.sheet.getVariable(t)}},{key:"onSheetAfterRecalculate",value:function e(t){if(this._skipRendering){this._skipRendering=false;return}var n=this.hot;(0,h.arrayEach)(t,function(e){var t=e.row,r=e.column;n.validateCell(n.getDataAtCell(t,r),n.getCellMeta(t,r),function(){})});n.render()}},{key:"onModifyData",value:function e(t,r,n,i){if(i==="get"&&this.hasComputedCellValue(t,r)){n.value=this.getCellValue(t,r)}else if(i==="set"&&(0,m.isFormulaExpression)(n.value)){n.value=(0,m.toUpperCaseFormula)(n.value)}}},{key:"onBeforeValueRender",value:function e(t){var r=t;if((0,m.isFormulaExpressionEscaped)(r)){r=(0,m.unescapeFormulaExpression)(r)}return r}},{key:"onBeforeValidate",value:function e(t,r,n){var i=this.hot.propToCol(n);var a=t;if(this.hasComputedCellValue(r,i)){a=this.getCellValue(r,i)}return a}},{key:"onAfterSetDataAtCell",value:function e(t,r){var u=this;if(r==="loadData"){return}this.dataProvider.clearChanges();(0,h.arrayEach)(t,function(e){var t=(0,f.default)(e,4),r=t[0],n=t[1],i=t[2],a=t[3];var o=u.hot.propToCol(n);var s=u.t.toPhysicalRow(r);var l=a;if((0,m.isFormulaExpression)(l)){l=(0,m.toUpperCaseFormula)(l)}u.dataProvider.collectChanges(s,o,l);if(i!==l){u.sheet.applyChanges(s,o,l)}});this.recalculate()}},{key:"onBeforeCreateRow",value:function e(t,r,n){if(n==="UndoRedo.undo"){this.undoRedoSnapshot.restore()}}},{key:"onAfterCreateRow",value:function e(t,r,n){this.sheet.alterManager.triggerAlter("insert_row",t,r,n!=="UndoRedo.undo")}},{key:"onBeforeRemoveRow",value:function e(t,r){this.undoRedoSnapshot.save("row",t,r)}},{key:"onAfterRemoveRow",value:function e(t,r){this.sheet.alterManager.triggerAlter("remove_row",t,r)}},{key:"onBeforeCreateCol",value:function e(t,r,n){if(n==="UndoRedo.undo"){this.undoRedoSnapshot.restore()}}},{key:"onAfterCreateCol",value:function e(t,r,n){this.sheet.alterManager.triggerAlter("insert_column",t,r,n!=="UndoRedo.undo")}},{key:"onBeforeRemoveCol",value:function e(t,r){this.undoRedoSnapshot.save("column",t,r)}},{key:"onAfterRemoveCol",value:function e(t,r){this.sheet.alterManager.triggerAlter("remove_column",t,r)}},{key:"onBeforeColumnSort",value:function e(t,r){this.sheet.alterManager.prepareAlter("column_sorting",t,r)}},{key:"onAfterColumnSort",value:function e(t,r){this.sheet.alterManager.triggerAlter("column_sorting",t,r)}},{key:"onAfterLoadData",value:function e(){this._skipRendering=true;this.recalculateFull()}},{key:"destroy",value:function e(){this.dataProvider.destroy();this.dataProvider=null;this.sheet.destroy();this.sheet=null;(0,u.default)((0,l.default)(n.prototype),"destroy",this).call(this)}}]);return n}(d.default);(0,g.registerPlugin)("formulas",C);var S=C;t.default=S},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var a=n(r(37));var i=n(r(1));var o=n(r(2));var v=r(128);var u=r(4);var s=n(r(62));var l=r(98);var f=r(3);var c=n(r(91));var p=n(r(665));var g=r(90);var d=n(r(666));var h=n(r(667));var m=1;var y=2;var b=3;var w=function(){function n(e,t){var r=this;(0,i.default)(this,n);this.hot=e;this.t=(0,l.getTranslator)(this.hot);this.dataProvider=t;this.parser=new v.Parser;this.matrix=new d.default(this.t);this.alterManager=new h.default(this);this._processingCell=null;this._state=b;this.parser.on("callCellValue",function(){return r._onCallCellValue.apply(r,arguments)});this.parser.on("callRangeValue",function(){return r._onCallRangeValue.apply(r,arguments)});this.alterManager.addLocalHook("afterAlter",function(){return r._onAfterAlter.apply(r,arguments)})}(0,o.default)(n,[{key:"recalculate",value:function e(){switch(this._state){case b:this.recalculateFull();break;case y:this.recalculateOptimized();break;default:break}}},{key:"recalculateOptimized",value:function e(){var r=this;var t=this.matrix.getOutOfDateCells();(0,u.arrayEach)(t,function(e){var t=r.dataProvider.getSourceDataAtCell(e.row,e.column);if((0,g.isFormulaExpression)(t)){r.parseExpression(e,t.substr(1))}});this._state=m;this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function e(){var n=this;var t=this.dataProvider.getSourceDataByRange();this.matrix.reset();(0,u.arrayEach)(t,function(e,r){(0,u.arrayEach)(e,function(e,t){if((0,g.isFormulaExpression)(e)){n.parseExpression(new c.default(r,t),e.substr(1))}})});this._state=m;this.runLocalHooks("afterRecalculate",t,"full")}},{key:"setVariable",value:function e(t,r){this.parser.setVariable(t,r)}},{key:"getVariable",value:function e(t){return this.parser.getVariable(t)}},{key:"applyChanges",value:function e(t,r,n){this.matrix.remove({row:t,column:r});if((0,g.isFormulaExpression)(n)){this.parseExpression(new c.default(t,r),n.substr(1))}var i=this.getCellDependencies.apply(this,(0,a.default)(this.t.toVisual(t,r)));(0,u.arrayEach)(i,function(e){e.setState(c.default.STATE_OUT_OFF_DATE)});this._state=y}},{key:"parseExpression",value:function e(t,r){t.setState(c.default.STATE_COMPUTING);this._processingCell=t;var n=this.parser.parse((0,g.toUpperCaseFormula)(r)),i=n.error,a=n.result;if((0,g.isFormulaExpression)(a)){this.parseExpression(t,a.substr(1))}else{t.setValue(a);t.setError(i);t.setState(c.default.STATE_UP_TO_DATE)}this.matrix.add(t);this._processingCell=null}},{key:"getCellAt",value:function e(t,r){return this.matrix.getCellAt(t,r)}},{key:"getCellDependencies",value:function e(t,r){return this.matrix.getDependencies({row:t,column:r})}},{key:"_onCallCellValue",value:function e(t,r){var n=t.row,i=t.column;var a=new p.default(n,i);if(!this.dataProvider.isInDataRange(a.row,a.column)){throw Error(v.ERROR_REF)}this.matrix.registerCellRef(a);this._processingCell.addPrecedent(a);var o=this.dataProvider.getRawDataAtCell(n.index,i.index);if((0,v.error)(o)){var s=this.matrix.getCellAt(n.index,i.index);if(s&&s.hasError()){throw Error(o)}}if((0,g.isFormulaExpression)(o)){var l=this.parser.parse(o.substr(1)),u=l.error,f=l.result;if(u){throw Error(u)}r(f)}else{r(o)}}},{key:"_onCallRangeValue",value:function e(t,r,n){var c=this;var d=t.row,h=t.column;var i=r.row,a=r.column;var o=this.dataProvider.getRawDataByRange(d.index,h.index,i.index,a.index);var s=function e(t,f){return(0,u.arrayMap)(t,function(e,t){var r=d.index+f;var n=h.index+t;var i=new p.default(r,n);if(!c.dataProvider.isInDataRange(i.row,i.column)){throw Error(v.ERROR_REF)}c.matrix.registerCellRef(i);c._processingCell.addPrecedent(i);var a=e;if((0,v.error)(a)){var o=c.matrix.getCellAt(i.row,i.column);if(o&&o.hasError()){throw Error(a)}}if((0,g.isFormulaExpression)(a)){var s=c.parser.parse(a.substr(1)),l=s.error,u=s.result;if(l){throw Error(l)}a=u}return a})};var l=(0,u.arrayMap)(o,function(e,t){return s(e,t)});n(l)}},{key:"_onAfterAlter",value:function e(){this.recalculateOptimized()}},{key:"destroy",value:function e(){this.hot=null;this.t=null;this.dataProvider.destroy();this.dataProvider=null;this.alterManager.destroy();this.alterManager=null;this.parser=null;this.matrix.reset();this.matrix=null}}]);return n}();(0,f.mixin)(w,s.default);var C=w;t.default=C},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(7));var u=r(128);var f=n(r(414));var c=function(e){(0,l.default)(t,e);function t(){(0,i.default)(this,t);return(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}(0,a.default)(t,[{key:"toString",value:function e(){return(0,u.toLabel)({index:this.row,isAbsolute:false},{index:this.column,isAbsolute:false})}}]);return t}(f.default);var d=c;t.default=d},function(e,t,r){"use strict";var n=r(0);r(19);r(12);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var f=r(4);var o=n(r(91));var s=function(){function t(e){(0,i.default)(this,t);this.t=e;this.data=[];this.cellReferences=[]}(0,a.default)(t,[{key:"getCellAt",value:function e(t,r){var n=null;(0,f.arrayEach)(this.data,function(e){if(e.row===t&&e.column===r){n=e;return false}});return n}},{key:"getOutOfDateCells",value:function e(){return(0,f.arrayFilter)(this.data,function(e){return e.isState(o.default.STATE_OUT_OFF_DATE)})}},{key:"add",value:function e(t){if(!(0,f.arrayFilter)(this.data,function(e){return e.isEqual(t)}).length){this.data.push(t)}}},{key:"remove",value:function e(t){var i=Array.isArray(t);var r=function e(t,r){var n=false;if(i){(0,f.arrayEach)(r,function(e){if(t.isEqual(e)){n=true;return false}})}else{n=t.isEqual(r)}return n};this.data=(0,f.arrayFilter)(this.data,function(e){return!r(e,t)})}},{key:"getDependencies",value:function n(e){var i=this;var n=function e(r){return(0,f.arrayReduce)(i.data,function(e,t){if(t.hasPrecedent(r)&&e.indexOf(t)===-1){e.push(t)}return e},[])};var t=function t(e){var r=n(e);if(r.length){(0,f.arrayEach)(r,function(e){if(e.hasPrecedents()){r=r.concat(t(i.t.toVisual(e)))}})}return r};return t(e)}},{key:"registerCellRef",value:function e(t){if(!(0,f.arrayFilter)(this.cellReferences,function(e){return e.isEqual(t)}).length){this.cellReferences.push(t)}}},{key:"removeCellRefsAtRange",value:function e(t,r){var n=t.row,i=t.column;var a=r.row,o=r.column;var s=[];var l=function e(t){return n===void 0?true:t.row>=n&&t.row<=a};var u=function e(t){return i===void 0?true:t.column>=i&&t.column<=o};this.cellReferences=(0,f.arrayFilter)(this.cellReferences,function(e){if(l(e)&&u(e)){s.push(e);return false}return true});return s}},{key:"reset",value:function e(){this.data.length=0;this.cellReferences.length=0}}]);return t}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(19);r(15);r(69);r(10);r(13);r(16);t.__esModule=true;t.registerOperation=y;t.default=void 0;var a=i(r(1));var o=i(r(2));var s=r(3);var l=i(r(62));var u=n(r(668));var f=n(r(669));var c=n(r(670));var d=n(r(671));var h=n(r(672));var v=new Map;y(u.OPERATION_NAME,u);y(f.OPERATION_NAME,f);y(c.OPERATION_NAME,c);y(d.OPERATION_NAME,d);y(h.OPERATION_NAME,h);var p=function(){function t(e){(0,a.default)(this,t);this.sheet=e;this.hot=e.hot;this.dataProvider=e.dataProvider;this.matrix=e.matrix}(0,o.default)(t,[{key:"prepareAlter",value:function e(t){if(!v.has(t)){throw Error('Alter operation "'.concat(t,'" not exist.'))}for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++){n[i-1]=arguments[i]}v.get(t).prepare.apply(this,n)}},{key:"triggerAlter",value:function e(t){if(!v.has(t)){throw Error('Alter operation "'.concat(t,'" not exist.'))}for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++){n[i-1]=arguments[i]}v.get(t).operate.apply(this,n);this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function e(){this.sheet=null;this.hot=null;this.dataProvider=null;this.matrix=null}}]);return t}();(0,s.mixin)(p,l.default);var g=p;t.default=g;var m=function e(){};function y(e,t){if(!v.has(e)){v.set(e,{prepare:t.prepare||m,operate:t.operate||m})}}},function(e,t,r){"use strict";var n=r(0);r(15);r(10);r(38);r(13);r(24);r(16);t.__esModule=true;t.prepare=o;t.operate=c;t.OPERATION_NAME=void 0;var i=r(4);var s=r(90);var l=n(r(91));var u=n(r(129));var a="column_sorting";t.OPERATION_NAME=a;var f;function o(){var e=this.matrix,t=this.dataProvider;f=new WeakMap;(0,i.arrayEach)(e.data,function(e){f.set(e,t.t.toVisualRow(e.row))})}function c(){var e=this.matrix,o=this.dataProvider;e.cellReferences.length=0;(0,i.arrayEach)(e.data,function(e){e.setState(l.default.STATE_OUT_OFF_DATE);e.clearPrecedents();var t=e.row,r=e.column;var n=o.getSourceDataAtCell(t,r);if((0,s.isFormulaExpression)(n)){var i=f.get(e);var a=new u.default(n);a.translate({row:o.t.toVisualRow(t)-i});o.updateSourceData(t,r,a.toString())}});f=null}},function(e,t,r){"use strict";var n=r(0);r(10);r(38);t.__esModule=true;t.operate=o;t.OPERATION_NAME=void 0;var i=r(4);var h=r(90);var v=n(r(91));var p=n(r(129));var a="insert_column";t.OPERATION_NAME=a;function o(l,u){var f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var e=this.matrix,c=this.dataProvider;var d=[0,u];(0,i.arrayEach)(e.cellReferences,function(e){if(e.column>=l){e.translateTo.apply(e,d)}});(0,i.arrayEach)(e.data,function(e){var t=e.row,r=e.column;if(e.column>=l){e.translateTo.apply(e,d);e.setState(v.default.STATE_OUT_OFF_DATE)}if(f){var n=e.row,i=e.column;var a=c.getSourceDataAtCell(n,i);if((0,h.isFormulaExpression)(a)){var o=(0,h.cellCoordFactory)("column",l);var s=new p.default(a);s.useCustomModifier(g);s.translate({column:u},o({row:t,column:r}));c.updateSourceData(n,i,s.toString())}}})}function g(e,t,r,n){var i=e.start,a=e.end;var o=i[t].index;var s=a[t].index;var l=r;var u=r;if(n>o){l=0}if(n>s){u=0}return[l,u,false]}},function(e,t,r){"use strict";var n=r(0);r(10);r(38);t.__esModule=true;t.operate=o;t.OPERATION_NAME=void 0;var i=r(4);var h=r(90);var v=n(r(91));var p=n(r(129));var a="insert_row";t.OPERATION_NAME=a;function o(l,u){var f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var e=this.matrix,c=this.dataProvider;var d=[u,0];(0,i.arrayEach)(e.cellReferences,function(e){if(e.row>=l){e.translateTo.apply(e,d)}});(0,i.arrayEach)(e.data,function(e){var t=e.row,r=e.column;if(e.row>=l){e.translateTo.apply(e,d);e.setState(v.default.STATE_OUT_OFF_DATE)}if(f){var n=e.row,i=e.column;var a=c.getSourceDataAtCell(n,i);if((0,h.isFormulaExpression)(a)){var o=(0,h.cellCoordFactory)("row",l);var s=new p.default(a);s.useCustomModifier(g);s.translate({row:u},o({row:t,column:r}));c.updateSourceData(n,i,s.toString())}}})}function g(e,t,r,n){var i=e.start,a=e.end;var o=i[t].index;var s=a[t].index;var l=r;var u=r;if(n>o){l=0}if(n>s){u=0}return[l,u,false]}},function(e,t,r){"use strict";var n=r(0);r(10);r(38);t.__esModule=true;t.operate=a;t.OPERATION_NAME=void 0;var o=r(4);var h=r(90);var v=n(r(91));var p=n(r(129));var i="remove_column";t.OPERATION_NAME=i;function a(l,e){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var f=-e;var t=this.matrix,c=this.dataProvider,r=this.sheet;var d=[0,f];var n=Math.abs(f)-1;var i=t.removeCellRefsAtRange({column:l},{column:l+n});var a=[];(0,o.arrayEach)(t.data,function(t){(0,o.arrayEach)(i,function(e){if(!t.hasPrecedent(e)){return}t.removePrecedent(e);t.setState(v.default.STATE_OUT_OFF_DATE);(0,o.arrayEach)(r.getCellDependencies(t.row,t.column),function(e){e.setState(v.default.STATE_OUT_OFF_DATE)})});if(t.column>=l&&t.column<=l+n){a.push(t)}});t.remove(a);(0,o.arrayEach)(t.cellReferences,function(e){if(e.column>=l){e.translateTo.apply(e,d)}});(0,o.arrayEach)(t.data,function(e){var t=e.row,r=e.column;if(e.column>=l){e.translateTo.apply(e,d);e.setState(v.default.STATE_OUT_OFF_DATE)}if(u){var n=e.row,i=e.column;var a=c.getSourceDataAtCell(n,i);if((0,h.isFormulaExpression)(a)){var o=(0,h.cellCoordFactory)("column",l);var s=new p.default(a);s.useCustomModifier(g);s.translate({column:f},o({row:t,column:r}));c.updateSourceData(n,i,s.toString())}}})}function g(e,t,r,n){var i=e.start,a=e.end,o=e.type;var s=i[t].index;var l=a[t].index;var u=Math.abs(r)-1;var f=r;var c=r;var d=false;if(s>=n&&l<=n+u){d=true}if(!d&&o==="cell"){if(n>=s){f=0;c=0}}if(!d&&o==="range"){if(n>=s){f=0}if(n>l){c=0}else if(l<=n+u){c-=Math.min(l-(n+u),0)}}if(s+f<0){f-=s+f}return[f,c,d]}},function(e,t,r){"use strict";var n=r(0);r(10);r(38);t.__esModule=true;t.operate=a;t.OPERATION_NAME=void 0;var o=r(4);var h=r(90);var v=n(r(91));var p=n(r(129));var i="remove_row";t.OPERATION_NAME=i;function a(l,e){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var f=-e;var t=this.matrix,c=this.dataProvider,r=this.sheet;var d=[f,0];var n=Math.abs(f)-1;var i=t.removeCellRefsAtRange({row:l},{row:l+n});var a=[];(0,o.arrayEach)(t.data,function(t){(0,o.arrayEach)(i,function(e){if(!t.hasPrecedent(e)){return}t.removePrecedent(e);t.setState(v.default.STATE_OUT_OFF_DATE);(0,o.arrayEach)(r.getCellDependencies(t.row,t.column),function(e){e.setState(v.default.STATE_OUT_OFF_DATE)})});if(t.row>=l&&t.row<=l+n){a.push(t)}});t.remove(a);(0,o.arrayEach)(t.cellReferences,function(e){if(e.row>=l){e.translateTo.apply(e,d)}});(0,o.arrayEach)(t.data,function(e){var t=e.row,r=e.column;if(e.row>=l){e.translateTo.apply(e,d);e.setState(v.default.STATE_OUT_OFF_DATE)}if(u){var n=e.row,i=e.column;var a=c.getSourceDataAtCell(n,i);if((0,h.isFormulaExpression)(a)){var o=(0,h.cellCoordFactory)("row",l);var s=new p.default(a);s.useCustomModifier(g);s.translate({row:f},o({row:t,column:r}));c.updateSourceData(n,i,s.toString())}}})}function g(e,t,r,n){var i=e.start,a=e.end,o=e.type;var s=i[t].index;var l=a[t].index;var u=Math.abs(r)-1;var f=r;var c=r;var d=false;if(s>=n&&l<=n+u){d=true}if(!d&&o==="cell"){if(n>=s){f=0;c=0}}if(!d&&o==="range"){if(n>=s){f=0}if(n>l){c=0}else if(l<=n+u){c-=Math.min(l-(n+u),0)}}if(s+f<0){f-=s+f}return[f,c,d]}},function(e,t,r){"use strict";var n=r(0);r(19);t.__esModule=true;t.default=void 0;var u=n(r(18));var l=n(r(37));var i=n(r(1));var a=n(r(2));var f=r(4);var c=r(17);var d=r(3);var o=r(98);var s=function(){function t(e){(0,i.default)(this,t);this.hot=e;this.changes={};this.t=(0,o.getTranslator)(this.hot)}(0,a.default)(t,[{key:"collectChanges",value:function e(t,r,n){this.changes[this._coordId(t,r)]=n}},{key:"clearChanges",value:function e(){this.changes={}}},{key:"isInDataRange",value:function e(t,r){return t>=0&&t<this.hot.countRows()&&r>=0&&r<this.hot.countCols()}},{key:"getDataAtCell",value:function e(t,r){var n=this._coordId.apply(this,(0,l.default)(this.t.toPhysical(t,r)));var i;if((0,d.hasOwnProperty)(this.changes,n)){i=this.changes[n]}else{i=this.hot.getDataAtCell(t,r)}return i}},{key:"getDataByRange",value:function e(i,a,t,r){var o=this;var s=this.hot.getData(i,a,t,r);(0,f.arrayEach)(s,function(e,n){(0,f.arrayEach)(e,function(e,t){var r=o._coordId.apply(o,(0,l.default)(o.t.toPhysical(n+i,t+a)));if((0,d.hasOwnProperty)(o.changes,r)){s[n][t]=o.changes[r]}})});return s}},{key:"getSourceDataAtCell",value:function e(t,r){var n=this._coordId(t,r);var i;if((0,d.hasOwnProperty)(this.changes,n)){i=this.changes[n]}else{i=this.hot.getSourceDataAtCell(t,r)}return i}},{key:"getSourceDataByRange",value:function e(t,r,n,i){return this.hot.getSourceDataArray(t,r,n,i)}},{key:"getRawDataAtCell",value:function e(t,r){return this.getSourceDataAtCell.apply(this,(0,l.default)(this.t.toPhysical(t,r)))}},{key:"getRawDataByRange",value:function e(t,r,n,i){var l=this;var a=[];(0,c.rangeEach)(t,n,function(o){var s=[];(0,c.rangeEach)(r,i,function(e){var t=l.t.toPhysical(o,e),r=(0,u.default)(t,2),n=r[0],i=r[1];var a=l._coordId(n,i);if((0,d.hasOwnProperty)(l.changes,a)){s.push(l.changes[a])}else{s.push(l.getSourceDataAtCell(n,i))}});a.push(s)});return a}},{key:"updateSourceData",value:function e(t,r,n){this.hot.getSourceData()[t][this.hot.colToProp(r)]=n}},{key:"_coordId",value:function e(t,r){return"".concat(t,":").concat(r)}},{key:"destroy",value:function e(){this.hot=null;this.changes=null;this.t=null}}]);return t}();var h=s;t.default=h},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var f=r(4);var o=n(r(675));var c=n(r(91));var s=function(){function t(e){(0,i.default)(this,t);this.sheet=e;this.stack=new o.default}(0,a.default)(t,[{key:"save",value:function e(i,a,o){var t=this.sheet,r=t.matrix,s=t.dataProvider;var l=[];(0,f.arrayEach)(r.data,function(e){var t=e.row,r=e.column;if(e[i]<a||e[i]>a+(o-1)){var n=s.getSourceDataAtCell(t,r);l.push({row:t,column:r,value:n})}});this.stack.push({axis:i,index:a,amount:o,changes:l})}},{key:"restore",value:function e(){var t=this.sheet,a=t.matrix,o=t.dataProvider;var r=this.stack.pop(),s=r.axis,l=r.index,u=r.amount,n=r.changes;if(n){(0,f.arrayEach)(n,function(e){if(e[s]>l+(u-1)){e[s]-=u}var t=e.row,r=e.column,n=e.value;var i=o.getSourceDataAtCell(t,r);if(i!==n){o.updateSourceData(t,r,n);a.getCellAt(t,r).setState(c.default.STATE_OUT_OFF_DATE)}})}}},{key:"destroy",value:function e(){this.sheet=null;this.stack=null}}]);return t}();var l=s;t.default=l},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];(0,i.default)(this,t);this.items=e}(0,a.default)(t,[{key:"push",value:function e(){var t;(t=this.items).push.apply(t,arguments)}},{key:"pop",value:function e(){return this.items.pop()}},{key:"peek",value:function e(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function e(){return!this.size()}},{key:"size",value:function e(){return this.items.length}}]);return t}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);r(19);r(41);r(23);r(40);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=n(r(22));var c=r(8);var d=r(3);var h=r(61);var v=r(147);var p=r(21);var g=r(192);var m=n(r(677));var y=n(r(678));r(679);var b=function(e){(0,u.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,s.default)(r).call(this,e));t.settings={};t.dateCalculator=null;t.currentYear=null;t.monthList=[];t.monthHeadersArray=[];t.weekHeadersArray=[];t.rangeBars={};t.rangeList={};t.nestedHeadersPlugin=null;t.hotSource=null;t.overallWeekSectionCount=null;t.initialSettings=null;t.dataFeed=null;t.colorData={};t.rangeBarMeta=Object.create(null);return t}(0,a.default)(r,[{key:"checkDependencies",value:function e(){if(!this.hot.getSettings().colHeaders){(0,h.warn)("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}}},{key:"isEnabled",value:function e(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function e(){var t=this;if(this.enabled){return}this.checkDependencies();this.parseSettings();this.currentYear=this.settings.startYear||(new Date).getFullYear();this.dateCalculator=new m.default({year:this.currentYear,allowSplitWeeks:this.settings.allowSplitWeeks,hideDaysBeforeFullWeeks:this.settings.hideDaysBeforeFullWeeks,hideDaysAfterFullWeeks:this.settings.hideDaysAfterFullWeeks});this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay);this.monthList=this.dateCalculator.getMonthList();this.monthHeadersArray=this.generateMonthHeaders();this.weekHeadersArray=this.generateWeekHeaders();this.overallWeekSectionCount=this.dateCalculator.countWeekSections();this.assignGanttSettings();if(this.nestedHeadersPlugin){this.applyDataSource();if(this.colorData){this.setRangeBarColors(this.colorData)}}this.addHook("afterInit",function(){return t.onAfterInit()});(0,c.addClass)(this.hot.rootElement,"ganttChart");(0,l.default)((0,s.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){if(this.internalUpdateSettings){return}if(this.dataFeed&&this.dataFeed.hotSource){this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource)}this.settings={};this.dataFeed={};this.currentYear=null;this.monthList=[];this.rangeBars={};this.rangeList={};this.rangeBarMeta={};this.hotSource=null;this.deassignGanttSettings();(0,c.removeClass)(this.hot.rootElement,"ganttChart");(0,l.default)((0,s.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,l.default)((0,s.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function e(){this.settings=this.hot.getSettings().ganttChart;if(typeof this.settings==="boolean"){this.settings={}}if(!this.settings.firstWeekDay){this.settings.firstWeekDay="monday"}if(this.settings.allowSplitWeeks===void 0){this.settings.allowSplitWeeks=true}if(typeof this.settings.weekHeaderGenerator!=="function"){this.settings.weekHeaderGenerator=null}}},{key:"applyDataSource",value:function e(){if(this.settings.dataSource){var t=this.settings.dataSource;if(t.instance){this.loadData(t.instance,t.startDateColumn,t.endDateColumn,t.additionalData,t.asyncUpdates)}else{this.loadData(t)}}}},{key:"loadData",value:function e(t,r,n,i,a){this.dataFeed=new y.default(this.hot,t,r,n,i,a);this.hot.render()}},{key:"clearRangeBars",value:function e(){this.rangeBars={}}},{key:"clearRangeList",value:function e(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function e(t){return this.rangeList[t]}},{key:"generateMonthHeaders",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("months",this.settings.weekHeaderGenerator,t)}},{key:"generateWeekHeaders",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("weeks",this.settings.weekHeaderGenerator,t)}},{key:"assignGanttSettings",value:function e(){var l=this;this.initialSettings=(0,d.deepClone)(this.hot.getSettings());var t={data:(0,v.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:true,renderer:function e(t,r,n,i,a,o,s){return l.uniformBackgroundRenderer(t,r,n,i,a,o,s)},colWidths:60,hiddenColumns:this.hot.getSettings().hiddenColumns?this.hot.getSettings().hiddenColumns:true,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:this.hot.getSettings().collapsibleColumns?this.hot.getSettings().collapsibleColumns:true,columnSorting:false,copyPaste:false};this.internalUpdateSettings=true;this.hot.updateSettings(t);this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function e(){this.internalUpdateSettings=true;if(this.initialSettings){this.hot.updateSettings(this.initialSettings)}this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function e(t,r,n,i){if(!this.rangeBarMeta[t]){this.rangeBarMeta[t]={}}if(!this.rangeBarMeta[t][r]){this.rangeBarMeta[t][r]={}}this.rangeBarMeta[t][r][n]=i}},{key:"applyRangeBarMetaCache",value:function e(){var i=this;(0,d.objectEach)(this.rangeBarMeta,function(e,n){(0,d.objectEach)(e,function(e,r){(0,d.objectEach)(e,function(e,t){i.hot.setCellMeta(n,r,t,e)})})})}},{key:"getAdjacentWeekColumn",value:function e(t,r,n){var i=(0,g.parseDate)(t);var a=n===true?-7:7;var o=i.setDate(i.getDate()+a);return this.dateCalculator.dateToColumn(o)}},{key:"addRangeBar",value:function e(r,t,n,i){var a=this;if(t!==null&&n!==null){this.prepareDaysInColumnsInfo((0,g.parseDate)(t),(0,g.parseDate)(n))}var o=this.dateCalculator.dateToColumn(t);var s=this.dateCalculator.dateToColumn(n);var l=(0,g.getDateYear)(t);var u=false;var f=false;if(o===null&&this.settings.hideDaysBeforeFullWeeks){o=this.getAdjacentWeekColumn(t,true,false);if(o!==false){u=true}}if(s===null&&this.settings.hideDaysAfterFullWeeks){s=this.getAdjacentWeekColumn(n,false,true);if(s!==false){f=true}}if(!this.dateCalculator.isValidRangeBarData(t,n)||o===false||s===false){return false}if(!this.rangeBars[l]){this.rangeBars[l]={}}if(!this.rangeBars[l][r]){this.rangeBars[l][r]={}}this.rangeBars[l][r][o]={barLength:s-o+1,partialStart:u?false:!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:f?false:!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}};(0,d.objectEach)(i,function(e,t){a.rangeBars[l][r][o].additionalData[t]=e});if(l===this.dateCalculator.getYear()){if(this.colorData[r]){this.rangeBars[l][r][o].colors=this.colorData[r]}this.rangeList[r]=[r,o];this.renderRangeBar(r,o,s,i)}return[r,o]}},{key:"prepareDaysInColumnsInfo",value:function e(t,r){for(var n=t.getFullYear();n<=r.getFullYear();n++){if(this.dateCalculator.daysInColumns[n]===void 0){this.dateCalculator.calculateWeekStructure(n);this.dateCalculator.generateHeaderSet("weeks",null,n)}}}},{key:"getRangeBarData",value:function e(t,r){var n=this.dateCalculator.getYear();var i=this.getRangeBarCoordinates(t);if(!i){return false}var a=this.rangeBars[n][i[0]][i[1]];if(a&&t===i[0]&&(r===i[1]||r>i[1]&&r<i[1]+a.barLength)){return a}return false}},{key:"updateRangeBarData",value:function e(t,r,n){var i=this.getRangeBarData(t,r);(0,d.objectEach)(n,function(e,t){if(i[t]!==e){i[t]=e}})}},{key:"renderRangeBar",value:function e(t,r,n){var i=this.dateCalculator.getYear();var a=this.rangeBars[i][t][r];for(var o=r;o<=n;o++){var s=this.hot.getCellMeta(t,o);var l="".concat(s.className||""," rangeBar");if(o===r&&a.partialStart||o===n&&a.partialEnd){l+=" partial"}if(o===n){l+=" last"}this.hot.setCellMeta(t,o,"originalClassName",s.className);this.hot.setCellMeta(t,o,"className",l);this.hot.setCellMeta(t,o,"additionalData",a.additionalData);this.cacheRangeBarMeta(t,o,"originalClassName",s.className);this.cacheRangeBarMeta(t,o,"className",l);this.cacheRangeBarMeta(t,o,"additionalData",a.additionalData)}}},{key:"removeRangeBarByDate",value:function e(t,r){var n=this.dateCalculator.dateToColumn(r);this.removeRangeBarByColumn(t,n)}},{key:"removeRangeBarByColumn",value:function e(n,i){var a=this;var t=this.dateCalculator.getYear();var r=this.rangeBars[t][n][i];if(!r){return}this.unrenderRangeBar(n,i,i+r.barLength-1);this.rangeBars[t][n][i]=null;(0,d.objectEach)(this.rangeList,function(e,t){var r=parseInt(t,10);if(JSON.stringify(e)===JSON.stringify([n,i])){a.rangeList[r]=null}})}},{key:"removeAllRangeBars",value:function e(){var n=this;(0,d.objectEach)(this.rangeBars,function(e,r){(0,d.objectEach)(e,function(e,t){n.removeRangeBarByColumn(r,t)})})}},{key:"unrenderRangeBar",value:function e(t,r,n){for(var i=r;i<=n;i++){var a=this.hot.getCellMeta(t,i);this.hot.setCellMeta(t,i,"className",a.originalClassName);this.hot.setCellMeta(t,i,"originalClassName",void 0);this.cacheRangeBarMeta(t,i,"className",a.originalClassName);this.cacheRangeBarMeta(t,i,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function e(t,r,n,i,a,o,s){var l=this.getRangeBarData(n,i);var u=this.getRangeBarCoordinates(n);r.innerHTML="";if(s.className){r.className=s.className}var f="";(0,d.objectEach)(s.additionalData,function(e,t){f+="".concat(t,": ").concat(e,"\n")});f=f.replace(/\n$/,"");r.title=f;if(l&&l.colors){if(i===u[1]&&l.partialStart||i===u[1]+l.barLength-1&&l.partialEnd){r.style.background=l.colors[1]}else{r.style.background=l.colors[0]}}else{r.style.background=""}}},{key:"setRangeBarColors",value:function e(t){var n=this;this.colorData=t;(0,d.objectEach)(t,function(e,t){var r=n.getRangeBarCoordinates(t);if(r){n.updateRangeBarData(r[0],r[1],{colors:e})}});this.hot.render()}},{key:"setYear",value:function e(t){var r=(0,d.extend)(this.hot.getSettings().ganttChart,{startYear:t});this.hot.updateSettings({ganttChart:r})}},{key:"onAfterInit",value:function e(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.applyDataSource()}},{key:"onUpdateSettings",value:function e(){if(this.internalUpdateSettings){this.applyRangeBarMetaCache();return}(0,l.default)((0,s.default)(r.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function e(){if(this.hotSource){this.dataFeed.removeSourceHotHooks(this.hotSource)}(0,l.default)((0,s.default)(r.prototype),"destroy",this).call(this)}}]);return r}(f.default);(0,p.registerPlugin)("ganttChart",b);var w=b;t.default=w},function(e,t,r){"use strict";var n=r(0);r(19);r(12);r(41);r(33);r(56);r(65);t.__esModule=true;t.default=void 0;var C=n(r(18));var u=n(r(1));var i=n(r(2));var v=r(4);var f=r(3);var a=r(61);var g=r(192);var o=function(){function l(e){var t=e.year,r=e.allowSplitWeeks,n=r===void 0?true:r,i=e.hideDaysBeforeFullWeeks,a=i===void 0?false:i,o=e.hideDaysAfterFullWeeks,s=o===void 0?false:o;(0,u.default)(this,l);this.year=t;this.firstWeekDay="monday";this.allowSplitWeeks=n;this.hideDaysBeforeFullWeeks=a;this.hideDaysAfterFullWeeks=s;this.weekSectionCount=0;this.monthListCache={};this.daysInColumns={};this.calculateWeekStructure()}(0,i.default)(l,[{key:"setYear",value:function e(t){this.year=t;this.monthListCache[t]=this.calculateMonthData(t);this.calculateWeekStructure(t)}},{key:"setFirstWeekDay",value:function e(t){var r=t.toLowerCase();if(r!=="monday"&&r!=="sunday"){(0,a.warn)("First day of the week must be set to either Monday or Sunday")}this.firstWeekDay=r;this.calculateWeekStructure()}},{key:"countWeekSections",value:function e(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function e(){return this.firstWeekDay}},{key:"getYear",value:function e(){return this.year}},{key:"getMonthList",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.year;if(!this.monthListCache[t]){this.monthListCache[t]=this.calculateMonthData(t)}return this.monthListCache[t]}},{key:"getFullMonthList",value:function e(){return this.monthListCache}},{key:"dateToColumn",value:function e(t){var r=(0,g.parseDate)(t);if(!r){return false}var n=r.getMonth();var i=r.getDate()-1;var a=r.getFullYear();return this.getWeekColumn(i,n,a)}},{key:"getWeekColumn",value:function e(r,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.getYear();var i=null;var a=this.getMonthCacheArray(t,n);(0,v.arrayEach)(a,function(e){(0,f.objectEach)(e,function(e,t){if(e.indexOf(r+1)>-1){i=parseInt(t,10);return false}});if(i){return false}});return i}},{key:"getMonthCacheArray",value:function e(n){var i=this;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getYear();var o=this.getMonthList(a);var s=[];if(this.allowSplitWeeks){s.push(this.daysInColumns[a][n])}else{var l=-1;(0,f.objectEach)(this.daysInColumns[a],function(e,t){var r=o[t];if(Object.keys(e).length>1){l+=1}if(l===n){if(r.daysBeforeFullWeeks>0){s.push(i.daysInColumns[a][parseInt(t,10)-1])}s.push(e);if(r.daysAfterFullWeeks>0){s.push(i.daysInColumns[a][parseInt(t,10)+1])}return false}})}return s}},{key:"columnToDate",value:function e(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getYear();var n=null;(0,f.objectEach)(this.daysInColumns[t],function(e,t){if(e[r]){n=t;return false}});var i=this.daysInColumns[t][n][r];if(i.length===1){var a=new Date(t,n,i[0]);return{start:a,end:a}}return{start:new Date(t,n,i[0]),end:new Date(t,n,i[i.length-1])}}},{key:"isOnTheEdgeOfWeek",value:function r(e){var n=this;var i=(0,g.parseDate)(e);if(!i){return null}var t=i.getMonth();var a=i.getDate()-1;var o=i.getFullYear();var s=this.getMonthCacheArray(t,o);var r=false;(0,v.arrayEach)(s,function(e){(0,f.objectEach)(e,function(e){if(!n.allowSplitWeeks&&e.length!==7){if(a===0||a===new Date(i.getYear(),i.getMonth()+1,0).getDate()-1){return true}}var t=e.indexOf(a+1);if(t===0){r=[1,0];return false}else if(t===e.length-1){r=[0,1];return false}});if(r){return false}});return r}},{key:"generateHeaderSet",value:function e(g,m){var y=this;var b=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.year;var t=this.getMonthList(b);var w=[];(0,f.objectEach)(t,function(e,t){var r=e.daysBeforeFullWeeks>0?1:0;var n=e.daysAfterFullWeeks>0?1:0;var i=y.hideDaysBeforeFullWeeks?0:r;var a=y.hideDaysAfterFullWeeks?0:n;var o=e.fullWeeks+(y.allowSplitWeeks?i+a:0);var s=parseInt(t,10);var l="";if(g==="months"){w.push({label:e.name,colspan:o})}else if(g==="weeks"){for(var u=0;u<o;u++){var f=null;var c=null;if(!y.allowSplitWeeks&&e.fullWeeks===1){var d=y.getWeekColumnRange({monthObject:e,monthNumber:s,headerIndex:u,headerCount:o,areDaysBeforeFullWeeksVisible:i,areDaysAfterFullWeeksVisible:a,mixedMonth:true,year:b});var h=(0,C.default)(d,2);f=h[0];c=h[1]}else{var v=y.getWeekColumnRange({monthObject:e,monthNumber:s,headerIndex:u,areDaysBeforeFullWeeksVisible:i,areDaysAfterFullWeeksVisible:a,headerCount:o,year:b});var p=(0,C.default)(v,2);f=p[0];c=p[1]}if(f===c){l="".concat(f)}else{l="".concat(f," -  ").concat(c)}w.push(m?m.call(y,f,c):l);y.addDaysToCache(s,w.length-1,f,c,b)}}});return w}},{key:"getWeekColumnRange",value:function e(t){var r=t.monthObject,n=t.monthNumber,i=t.headerIndex,a=t.headerCount,o=t.areDaysBeforeFullWeeksVisible,s=t.areDaysAfterFullWeeksVisible,l=t.mixedMonth,u=l===void 0?false:l,f=t.year,c=f===void 0?this.year:f;var d=this.getMonthList(c);var h=this.allowSplitWeeks;var v=null;var p=null;if(u){if(n===0){p=d[n+1].daysBeforeFullWeeks;v=g.DEC_LENGTH-(g.WEEK_LENGTH-p)+1}else if(n===d.length-1){p=g.WEEK_LENGTH-d[n-1].daysAfterFullWeeks;v=d[n-1].days-d[n-1].daysAfterFullWeeks+1}else{p=d[n+1].daysBeforeFullWeeks;v=d[n-1].days-(g.WEEK_LENGTH-p)+1}}else if(h&&o&&i===0){v=i+1;p=r.daysBeforeFullWeeks}else if(h&&s&&i===a-1){v=r.days-r.daysAfterFullWeeks+1;p=r.days}else{v=null;if(h){v=r.daysBeforeFullWeeks+(i-o)*g.WEEK_LENGTH+1}else{v=r.daysBeforeFullWeeks+i*g.WEEK_LENGTH+1}p=v+g.WEEK_LENGTH-1}return[v,p]}},{key:"addDaysToCache",value:function e(t,r,n,i){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:this.getYear();if(!this.daysInColumns[a]){this.daysInColumns[a]={}}if(!this.daysInColumns[a][t]){this.daysInColumns[a][t]={}}if(!this.daysInColumns[a][t][r]){this.daysInColumns[a][t][r]=[]}if(n<=i){for(var o=n;o<=i;o++){this.daysInColumns[a][t][r].push(o)}}else{var s=t-1>=0?this.countMonthDays(t):31;for(var l=n;l<=s;l++){this.daysInColumns[a][t][r].push(l)}for(var u=1;u<=i;u++){this.daysInColumns[a][t][r].push(u)}}}},{key:"isValidRangeBarData",value:function e(t,r){var n=(0,g.parseDate)(t);var i=(0,g.parseDate)(r);return n&&i&&n.getTime()<=i.getTime()}},{key:"calculateMonthData",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.year;return[{name:"January",days:31},{name:"February",days:new Date(t,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getYear();return this.monthListCache[t].length}},{key:"countMonthDays",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getYear();return this.monthListCache[r][t-1].days}},{key:"countMonthFullWeeks",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getYear();return this.monthListCache[r][t-1].fullWeeks}},{key:"calculateWeekStructure",value:function e(){var o=this;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getYear();this.monthListCache[s]=this.calculateMonthData(s);var t=this.getFirstWeekDay();var l=this.getMonthList(s);var u=[];var f=this.hideDaysBeforeFullWeeks?0:1;var c=this.hideDaysAfterFullWeeks?0:1;var d=0;var h=0;if(t==="monday"){d=1}(0,v.arrayEach)(l,function(e,t){var r=new Date(s,t,1).getDay();var n=0;e.daysBeforeFullWeeks=(7-r+d)%7;if(!o.allowSplitWeeks&&e.daysBeforeFullWeeks){u.push((0,g.getMixedMonthObject)((0,g.getMixedMonthName)(t,l),t));n+=1}e.fullWeeks=Math.floor((e.days-e.daysBeforeFullWeeks)/7);e.daysAfterFullWeeks=e.days-e.daysBeforeFullWeeks-7*e.fullWeeks;if(!o.allowSplitWeeks){if(t===l.length-1&&e.daysAfterFullWeeks){u.push((0,g.getMixedMonthObject)((0,g.getMixedMonthName)(t,l),null));n+=1}h+=e.fullWeeks+n}else{var i=f*(e.daysBeforeFullWeeks?1:0);var a=c*(e.daysAfterFullWeeks?1:0);h+=e.fullWeeks+i+a}});(0,v.arrayEach)(u,function(e,t){var r=e.index;delete e.index;o.addMixedMonth(r===null?r:t+r,e,s)});if(s===this.getYear()){this.weekSectionCount=h}}},{key:"addMixedMonth",value:function e(t,r,n){if(t===null){this.monthListCache[n].push(r)}else{this.monthListCache[n].splice(t,0,r)}}}]);return l}();var s=o;t.default=s},function(e,t,r){"use strict";var n=r(0);r(19);r(10);r(38);r(34);t.__esModule=true;t.default=void 0;var s=n(r(1));var i=n(r(2));var f=r(3);var a=r(4);var l=r(17);var u=r(192);var o=function(){function o(e,t,r,n,i,a){(0,s.default)(this,o);this.data=t;this.chartInstance=e;this.chartPlugin=this.chartInstance.getPlugin("ganttChart");this.hotSource=null;this.sourceHooks={};this.ongoingAsync=false;this.applyData(t,r,n,i,a||false)}(0,i.default)(o,[{key:"applyData",value:function e(t,r,n,i,a){if(Object.prototype.toString.call(t)==="[object Array]"){if(t.length>1){this.chartInstance.alter("insert_row",0,t.length-1,"".concat(this.pluginName,".loadData"))}this.loadData(t)}else if(t instanceof this.chartInstance.constructor){var o=t.countRows();if(o>1){this.chartInstance.alter("insert_row",0,o-1,"".concat(this.pluginName,".loadData"))}this.bindWithHotInstance(t,r,n,i,a)}}},{key:"bindWithHotInstance",value:function e(t,r,n,i,a){this.hotSource={instance:t,startColumn:r,endColumn:n,additionalData:i,asyncUpdates:a};this.addSourceHotHooks();this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function e(t){var r=this;if(!this.hotSource.asyncUpdates){t.call(this);return}this.asyncStart();setTimeout(function(){t.call(r);r.asyncEnd()},0)}},{key:"asyncStart",value:function e(){this.ongoingAsync=true}},{key:"asyncEnd",value:function e(){this.ongoingAsync=false}},{key:"addSourceHotHooks",value:function e(){var r=this;this.sourceHooks={afterLoadData:function e(){return r.onAfterSourceLoadData()},afterChange:function e(t){return r.onAfterSourceChange(t)},afterColumnSort:function e(){return r.onAfterColumnSort()}};this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData);this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange);this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function e(t){if(this.sourceHooks.afterLoadData){t.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData)}if(this.sourceHooks.afterChange){t.instance.removeHook("afterChange",this.sourceHooks.afterChange)}if(this.sourceHooks.afterColumnSort){t.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}}},{key:"getDataFromSource",value:function e(t){var i={};var a=this.hotSource;var o;var s=[];if(t===void 0){o=a.instance.getData(0,0,a.instance.countRows()-1,a.instance.countCols()-1)}else{o=[];o[t]=a.instance.getDataAtRow(t)}var r=function e(t,r){i={};var n=o[t];if(n[a.startColumn]===null||n[a.startColumn]===""){return"continue"}(0,f.objectEach)(a.additionalData,function(e,t){i[t]=n[e]});s.push([t,n[a.startColumn],n[a.endColumn],i,t])};for(var n=t||0,l=o.length;n<(t?t+1:l);n++){var u=r(n,l);if(u==="continue")continue}return s}},{key:"updateFromSource",value:function e(t){var r=this.getDataFromSource(t);if(!t&&isNaN(t)){this.chartPlugin.clearRangeBars();this.chartPlugin.clearRangeList()}this.loadData(r);this.chartInstance.render()}},{key:"loadData",value:function e(t){var n=this;var i=[];(0,a.arrayEach)(t,function(e,t){e.row=t;var r=n.splitRangeIfNeeded(e);i=i.concat(r)});(0,a.arrayEach)(i,function(e){n.chartPlugin.addRangeBar(e.row,(0,u.getStartDate)(e),(0,u.getEndDate)(e),(0,u.getAdditionalData)(e));delete e.row})}},{key:"splitRangeIfNeeded",value:function e(r){var n=[];var t=new Date((0,u.getStartDate)(r));var i=new Date((0,u.getEndDate)(r));if(typeof t==="string"||typeof i==="string"){return false}var a=t.getFullYear();var o=i.getFullYear();if(a===o){return[r]}(0,l.rangeEach)(a,o,function(e){var t=(0,f.clone)(r);if(e!==a){(0,u.setStartDate)(t,"01/01/".concat(e))}if(e!==o){(0,u.setEndDate)(t,"12/31/".concat(e))}n.push(t)});return n}},{key:"onAfterSourceChange",value:function e(o){var s=this;this.asyncCall(function(){if(!o){return}var e={};for(var t=0,r=o.length;t<r;t++){var n=o[t];var i=parseInt(n[0],10);var a=parseInt(n[1],10);if(!e[i]){e[i]={}}e[i][a]=[n[2],n[3]]}(0,f.objectEach)(e,function(e,t){var r=parseInt(t,10);if(s.chartPlugin.getRangeBarCoordinates(r)){s.chartPlugin.removeRangeBarByColumn(r,s.chartPlugin.rangeList[r][1])}s.updateFromSource(t)})})}},{key:"onAfterSourceLoadData",value:function e(){var t=this;this.asyncCall(function(){t.chartPlugin.removeAllRangeBars();t.updateFromSource()})}},{key:"onAfterColumnSort",value:function e(){var t=this;this.asyncCall(function(){t.chartPlugin.removeAllRangeBars();t.updateFromSource()})}}]);return o}();var c=o;t.default=c},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(5));var l=n(r(14));var u=n(r(7));var f=r(8);var c=r(21);var d=r(17);var h=n(r(22));var v=function(e){(0,u.default)(n,e);function n(e){var t;(0,i.default)(this,n);t=(0,o.default)(this,(0,s.default)(n).call(this,e));t.settings=null;return t}(0,a.default)(n,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function e(){var r=this;if(this.enabled){return}this.settings=this.hot.getSettings().headerTooltips;this.parseSettings();this.addHook("afterGetColHeader",function(e,t){return r.onAfterGetHeader(e,t)});this.addHook("afterGetRowHeader",function(e,t){return r.onAfterGetHeader(e,t)});(0,l.default)((0,s.default)(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.settings=null;this.clearTitleAttributes();(0,l.default)((0,s.default)(n.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function e(){if(typeof this.settings==="boolean"){this.settings={rows:true,columns:true,onlyTrimmed:false}}}},{key:"clearTitleAttributes",value:function e(){var t=this.hot.view.wt.getSetting("columnHeaders").length;var i=this.hot.view.wt.wtTable.THEAD;var a=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;var r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay;var o=r?r.clone.wtTable.THEAD:null;(0,d.rangeEach)(0,t-1,function(e){var t=i.childNodes[e];var r=a.childNodes[e];var n=o?o.childNodes[e]:null;(0,d.rangeEach)(0,t.childNodes.length-1,function(e){t.childNodes[e].removeAttribute("title");if(r&&r.childNodes[e]){r.childNodes[e].removeAttribute("title")}if(o&&n&&n.childNodes[e]){n.childNodes[e].removeAttribute("title")}})},true)}},{key:"onAfterGetHeader",value:function e(t,r){var n=r.querySelector("span");var i=r.parentNode.parentNode.nodeName==="THEAD";if(i&&this.settings.columns||!i&&this.settings.rows){if(this.settings.onlyTrimmed){if((0,f.outerWidth)(n)>=(0,f.outerWidth)(r)&&(0,f.outerWidth)(n)!==0){r.setAttribute("title",n.textContent)}}else{r.setAttribute("title",n.textContent)}}}},{key:"destroy",value:function e(){this.settings=null;(0,l.default)((0,s.default)(n.prototype),"destroy",this).call(this)}}]);return n}(h.default);(0,c.registerPlugin)("headerTooltips",v);var p=v;t.default=p},function(e,t,r){"use strict";var n=r(0);r(12);r(144);t.__esModule=true;t.default=void 0;var i=n(r(72));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(28));var u=n(r(5));var f=n(r(14));var c=n(r(7));var y=r(8);var b=r(17);var w=r(4);var d=r(3);var h=r(73);var v=r(61);var p=r(21);var g=n(r(22));var m=r(27);var C=n(r(682));r(683);function S(){var t=(0,i.default)(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\n                is currently not supported and might result in glitches."]);S=function e(){return t};return t}function E(){var t=(0,i.default)(["You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns."]);E=function e(){return t};return t}var k=function(e){(0,c.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,u.default)(r).call(this,e));t.settings=[];t.columnHeaderLevelCount=0;t.colspanArray=[];t.ghostTable=new C.default((0,l.default)(t));return t}(0,o.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function e(){var i=this;if(this.enabled){return}this.settings=this.hot.getSettings().nestedHeaders;this.addHook("afterGetColumnHeaderRenderers",function(e){return i.onAfterGetColumnHeaderRenderers(e)});this.addHook("afterInit",function(){return i.onAfterInit()});this.addHook("afterOnCellMouseDown",function(e,t){return i.onAfterOnCellMouseDown(e,t)});this.addHook("beforeOnCellMouseOver",function(e,t,r,n){return i.onBeforeOnCellMouseOver(e,t,r,n)});this.addHook("afterViewportColumnCalculatorOverride",function(e){return i.onAfterViewportColumnCalculatorOverride(e)});this.addHook("modifyColWidth",function(e,t){return i.onModifyColWidth(e,t)});this.setupColspanArray();this.checkForFixedColumnsCollision();this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0;(0,f.default)((0,u.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.clearColspans();this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable.clear();(0,f.default)((0,u.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,f.default)((0,u.default)(r.prototype),"updatePlugin",this).call(this);this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function e(){if(!this.hot.view){return}var t=this.hot.view.wt.getSetting("columnHeaders").length;var r=this.hot.view.wt.wtTable.THEAD;var n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;var i=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;for(var a=0;a<t;a++){var o=r.childNodes[a];if(!o){break}var s=n.childNodes[a];var l=i?i.childNodes[a]:null;for(var u=0,f=o.childNodes.length;u<f;u++){o.childNodes[u].removeAttribute("colspan");if(s&&s.childNodes[u]){s.childNodes[u].removeAttribute("colspan")}if(i&&l&&l.childNodes[u]){l.childNodes[u].removeAttribute("colspan")}}}}},{key:"checkForFixedColumnsCollision",value:function e(){var r=this;var n=this.hot.getSettings().fixedColumnsLeft;(0,w.arrayEach)(this.colspanArray,function(e,t){if(r.getNestedParent(t,n)!==n){(0,v.warn)((0,h.toSingleLine)(E()))}})}},{key:"checkForOverlappingHeaders",value:function e(){var o=this;(0,w.arrayEach)(this.colspanArray,function(e,a){(0,w.arrayEach)(o.colspanArray[a],function(e,t){if(e.colspan>1){var r=o.levelToRowCoords(a);var n=o.getChildHeaders(r,t);if(n.length>0){var i=0;(0,w.arrayEach)(n,function(e){i+=o.getColspan(r+1,e)});if(i>e.colspan){(0,v.warn)((0,h.toSingleLine)(S()))}return false}}})})}},{key:"setupColspanArray",value:function e(){var a=this;function o(e,t){if(!e[t]){e[t]=[]}}(0,d.objectEach)(this.settings,function(e,i){(0,d.objectEach)(e,function(e,t,r){o(a.colspanArray,i);if(r[t].colspan===void 0){a.colspanArray[i].push({label:r[t]||"",colspan:1,hidden:false})}else{var n=r[t].colspan||1;a.colspanArray[i].push({label:r[t].label||"",colspan:n,hidden:false});a.fillColspanArrayWithDummies(n,i)}})})}},{key:"fillColspanArrayWithDummies",value:function e(t,r){var n=this;(0,b.rangeEach)(0,t-2,function(){n.colspanArray[r].push({label:"",colspan:1,hidden:true})})}},{key:"headerRendererFactory",value:function e(d){var h=this;return function(e,t){var r=h.hot.rootDocument;t.removeAttribute("colspan");(0,y.removeClass)(t,"hiddenHeader");if(h.colspanArray[d][e]&&h.colspanArray[d][e].colspan){var n=h.colspanArray[d][e].colspan;var i=h.hot.getSettings().fixedColumnsLeft||0;var a=h.hot.view.wt.wtOverlays,o=a.leftOverlay,s=a.topLeftCornerOverlay;var l=s?s.clone.wtTable.THEAD.contains(t):false;var u=o?o.clone.wtTable.THEAD.contains(t):false;if(n>1){t.setAttribute("colspan",l||u?Math.min(n,i-e):n)}if(l||u&&e===i-1){(0,y.addClass)(t,"overlayEdge")}}if(h.colspanArray[d][e]&&h.colspanArray[d][e].hidden){(0,y.addClass)(t,"hiddenHeader")}(0,y.empty)(t);var f=r.createElement("DIV");(0,y.addClass)(f,"relative");var c=r.createElement("SPAN");(0,y.addClass)(c,"colHeader");(0,y.fastInnerHTML)(c,h.colspanArray[d][e]?h.colspanArray[d][e].label||"":"");f.appendChild(c);t.appendChild(f);h.hot.runHooks("afterGetColHeader",e,t)}}},{key:"getColspan",value:function e(t,r){var n=this.colspanArray[this.rowCoordsToLevel(t)][r];return n?n.colspan:1}},{key:"levelToRowCoords",value:function e(t){return t-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function e(t){return t+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function e(t,r){if(t<0){return false}var n=this.colspanArray[t][r]?this.colspanArray[t][r].colspan:1;var i=this.colspanArray[t][r]?this.colspanArray[t][r].hidden:false;if(n>1||n===1&&i===false){return r}var a=r-1;do{if(this.colspanArray[t][a].colspan>1){break}a-=1}while(r>=0);return a}},{key:"getChildHeaders",value:function e(t,r){var n=this.rowCoordsToLevel(t);var i=this.colspanArray[n+1];var a=this.getNestedParent(n,r);var o=this.colspanArray[n][r].colspan;var s=[];if(!i){return s}(0,b.rangeEach)(a,a+o-1,function(e){if(i[e]&&i[e].colspan>1){o-=i[e].colspan-1}if(i[e]&&!i[e].hidden&&s.indexOf(e)===-1){s.push(e)}});return s}},{key:"fillTheRemainingColspans",value:function e(){var n=this;(0,d.objectEach)(this.settings,function(t,r){(0,b.rangeEach)(n.colspanArray[r].length-1,n.hot.countCols()-1,function(e){n.colspanArray[r].push({label:t[e]||"",colspan:1,hidden:false})},true)})}},{key:"updateHeadersHighlight",value:function e(){var u=this;var t=this.hot.getSelectedLast();if(t===void 0){return}var f=this.hot.view.wt.wtOverlays;var c=this.hot.selection.isSelectedByColumnHeader();var d=Math.min(t[1],t[3]);var h=Math.max(t[1],t[3]);var v=c?-1:this.columnHeaderLevelCount-1;var p=[];var r=function e(r){return function(e,t){return function(){return t(e,r)}}};var g=r("ht__highlight");var m=r("ht__active_highlight");(0,b.rangeEach)(d,h,function(l){var e=function e(t){var r=u.getNestedParent(t,l);var n=f.topOverlay?f.topOverlay.clone.wtTable.getColumnHeader(r,t):void 0;var i=f.topLeftCornerOverlay?f.topLeftCornerOverlay.clone.wtTable.getColumnHeader(r,t):void 0;var a=[n,i];var o=u.getColspan(t-u.columnHeaderLevelCount,r);var s=r>=d&&r+o-1<=h;(0,w.arrayEach)(a,function(e){if(e===void 0){return false}if(!c&&t<v||c&&!s){p.push(g(e,y.removeClass));if(c){p.push(m(e,y.removeClass))}}else{p.push(g(e,y.addClass));if(c){p.push(m(e,y.addClass))}}})};for(var t=u.columnHeaderLevelCount-1;t>-1;t--){e(t)}});(0,w.arrayEach)(p,function(e){return void e()});p.length=0}},{key:"onAfterViewportColumnCalculatorOverride",value:function e(r){var n=this;var i=r.startColumn;(0,b.rangeEach)(0,Math.max(this.columnHeaderLevelCount-1,0),function(e){var t=n.getNestedParent(e,r.startColumn);if(t<r.startColumn){i=Math.min(i,t)}});r.startColumn=i}},{key:"onAfterOnCellMouseDown",value:function e(t,r){if(r.row<0){var n=this.getColspan(r.row,r.col);var i=r.col+n-1;if(n>1){var a=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new m.CellCoords(a,i))}}}},{key:"onBeforeOnCellMouseOver",value:function e(t,r,n,i){if(r.row>=0||r.col<0||!this.hot.view.isMouseDown()){return}var a=this.hot.getSelectedRangeLast(),o=a.from,s=a.to;var l=this.getColspan(r.row,r.col);var u=r.col+l-1;var f=false;if(o.col<=s.col){if(r.col<o.col&&u===s.col||r.col<o.col&&u<o.col||r.col<o.col&&u>=o.col&&u<s.col){f=true}}else if(r.col<s.col&&u>o.col||r.col>o.col||r.col<=s.col&&u>o.col||r.col>s.col&&u>o.col){f=true}if(f){var c=[s.col,o.col];o.col=c[0];s.col=c[1]}if(l>1){var d;i.column=true;i.cell=true;var h=[];if(o.col===s.col){if(u<=o.col&&r.col<o.col){h.push(s.col,r.col)}else{h.push(r.col<o.col?r.col:o.col,u>s.col?u:s.col)}}if(o.col<s.col){h.push(r.col<o.col?r.col:o.col,u)}if(o.col>s.col){h.push(o.col,r.col)}(d=this.hot).selectColumns.apply(d,h)}}},{key:"onAfterInit",value:function e(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length;this.fillTheRemainingColspans();this.checkForOverlappingHeaders();this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function e(t){if(t){t.length=0;for(var r=this.colspanArray.length,n=r-1;n>=0;n--){t.push(this.headerRendererFactory(n))}t.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function e(t,r){var n=this.ghostTable.widthsCache[r];return t>n?t:n}},{key:"destroy",value:function e(){this.settings=null;this.columnHeaderLevelCount=null;this.colspanArray=null;(0,f.default)((0,u.default)(r.prototype),"destroy",this).call(this)}}]);return r}(g.default);(0,p.registerPlugin)("nestedHeaders",k);var T=k;t.default=T},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var y=r(8);var b=r(3);var o=function(){function t(e){(0,i.default)(this,t);this.nestedHeaders=e;this.container=void 0;this.widthsCache=[]}(0,a.default)(t,[{key:"buildWidthsMapper",value:function e(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div");this.buildGhostTable(this.container);this.nestedHeaders.hot.rootElement.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th");var r=t.length;for(var n=0;n<r;n++){this.widthsCache.push(t[n].offsetWidth)}this.container.parentNode.removeChild(this.container);this.container=null;this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function e(t){var r=this.nestedHeaders.hot.rootDocument;var n=r.createDocumentFragment();var i=r.createElement("table");var a=false;var o=!!this.nestedHeaders.hot.getSettings().dropdownMenu;var s=this.nestedHeaders.colspanArray.length;var l=this.nestedHeaders.hot.countCols();var u=s-1;for(var f=0;f<s;f++){var c=r.createElement("tr");a=false;for(var d=0;d<l;d++){var h=r.createElement("th");var v=(0,b.clone)(this.nestedHeaders.colspanArray[f][d]);if(v&&!v.hidden){if(f===u){if(v.colspan>1){a=true}if(o){v.label+='<button class="changeType"></button>'}}(0,y.fastInnerHTML)(h,v.label);h.colSpan=v.colspan;c.appendChild(h)}}i.appendChild(c)}if(a){{var p=r.createElement("tr");for(var g=0;g<l;g++){var m=r.createElement("th");p.appendChild(m)}i.appendChild(p)}}n.appendChild(i);t.appendChild(n)}},{key:"clear",value:function e(){this.container=null;this.widthsCache.length=0}}]);return t}();var s=o;t.default=s},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(144);r(10);r(13);r(24);r(16);r(34);t.__esModule=true;t.default=void 0;var d=n(r(37));var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(22));var h=r(21);var v=r(17);var p=r(4);var g=r(27);var m=n(r(685));var y=n(r(686));var b=n(r(415));var w=n(r(687));r(688);var C=new WeakMap;var S=function(e){(0,f.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,l.default)(r).call(this,e));t.sourceData=null;t.trimRowsPlugin=null;t.bindRowsWithHeadersPlugin=null;t.dataManager=null;t.headersUI=null;C.set((0,s.default)(t),{changeSelection:false,movedToFirstChild:false,movedToCollapsed:false,skipRender:null});return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function e(){var t=this;this.sourceData=this.hot.getSourceData();this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove");this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders");this.dataManager=new m.default(this,this.hot,this.sourceData);this.collapsingUI=new y.default(this,this.hot,this.trimRowsPlugin);this.headersUI=new b.default(this,this.hot);this.contextMenuUI=new w.default(this,this.hot);this.dataManager.rewriteCache();this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)});this.addHook("beforeRender",function(){return t.onBeforeRender.apply(t,arguments)});this.addHook("modifyRowData",function(){return t.onModifyRowData.apply(t,arguments)});this.addHook("modifySourceLength",function(){return t.onModifySourceLength.apply(t,arguments)});this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice.apply(t,arguments)});this.addHook("beforeDataFilter",function(){return t.onBeforeDataFilter.apply(t,arguments)});this.addHook("afterContextMenuDefaultOptions",function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)});this.addHook("afterGetRowHeader",function(){return t.onAfterGetRowHeader.apply(t,arguments)});this.addHook("beforeOnCellMouseDown",function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)});this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)});this.addHook("modifyRemovedAmount",function(){return t.onModifyRemovedAmount.apply(t,arguments)});this.addHook("beforeAddChild",function(){return t.onBeforeAddChild.apply(t,arguments)});this.addHook("afterAddChild",function(){return t.onAfterAddChild.apply(t,arguments)});this.addHook("beforeDetachChild",function(){return t.onBeforeDetachChild.apply(t,arguments)});this.addHook("afterDetachChild",function(){return t.onAfterDetachChild.apply(t,arguments)});this.addHook("modifyRowHeaderWidth",function(){return t.onModifyRowHeaderWidth.apply(t,arguments)});this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)});this.addHook("beforeRowMove",function(){return t.onBeforeRowMove.apply(t,arguments)});this.addHook("afterRowMove",function(){return t.onAfterRowMove.apply(t,arguments)});this.addHook("afterLoadData",function(){return t.onAfterLoadData.apply(t,arguments)});if(!this.trimRowsPlugin.isEnabled()){this.trimRowsPlugin.enablePlugin();this.hot.getSettings().trimRows=true}(0,u.default)((0,l.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){(0,u.default)((0,l.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,u.default)((0,l.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function e(t,r){var n=C.get(this);var i=t.length;var a=[];var o=this.dataManager.translateTrimmedRow(r);var s=true;var l;var u=null;var f=null;var c=null;for(l=0;l<i;l++){a.push(this.dataManager.translateTrimmedRow(t[l]));if(this.dataManager.isParent(a[l])){s=false}}if(a.indexOf(o)>-1||!s){return false}u=this.dataManager.getRowParent(a[0]);f=this.dataManager.getRowParent(o);if(f===null||f===void 0){f=this.dataManager.getRowParent(o-1)}if(f===null||f===void 0){f=this.dataManager.getDataObject(o-1);n.movedToFirstChild=true}if(!f){return false}c=u===f;n.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f);this.collapsingUI.collapsedRowsStash.stash();if(!c){if(Math.max.apply(Math,a)<=o){this.collapsingUI.collapsedRowsStash.shiftStash(a[0],-1*t.length)}else{this.collapsingUI.collapsedRowsStash.shiftStash(o,t.length)}}n.changeSelection=true;if(a[i-1]<=o&&c||n.movedToFirstChild===true){t.reverse();a.reverse();if(n.movedToFirstChild!==true){o-=1}}for(l=0;l<i;l++){this.dataManager.moveRow(a[l],o)}var d=a[a.length-1]<o;if(d){for(l=i-1;l>=0;l--){this.dataManager.moveCellMeta(a[l],o)}}else{for(l=0;l<i;l++){this.dataManager.moveCellMeta(a[l],o)}}if(a[i-1]<=o&&c||this.dataManager.isParent(o)){t.reverse()}this.dataManager.rewriteCache();return false}},{key:"onAfterRowMove",value:function e(t,r){var n=C.get(this);if(!n.changeSelection){return}var i=t.length;var a=0;var o=0;var s=null;var l=null;var u=null;this.collapsingUI.collapsedRowsStash.applyStash();s=this.dataManager.translateTrimmedRow(r);if(n.movedToFirstChild){n.movedToFirstChild=false;a=r;o=r+i-1;if(r>=Math.max.apply(Math,(0,d.default)(t))){a-=i;o-=i}}else if(n.movedToCollapsed){var f=this.dataManager.getRowParent(s-1);if(f===null||f===void 0){f=this.dataManager.getDataObject(s-1)}var c=this.dataManager.getRowIndex(f);a=c;o=a}else if(t[i-1]<r){o=r-1;a=o-i+1}else{a=r;o=a+i-1}l=this.hot.selection;u=this.hot.countCols()-1;l.setRangeStart(new g.CellCoords(a,0));l.setRangeEnd(new g.CellCoords(o,u),true);n.changeSelection=false}},{key:"onBeforeOnCellMouseDown",value:function e(t,r,n){this.collapsingUI.toggleState(t,r,n)}},{key:"onModifyRowData",value:function e(t){return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function e(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function e(t,r,n){this.dataManager.spliceData(t,r,n);return false}},{key:"onBeforeDataFilter",value:function e(t,r){var n=[];var i=this.dataManager.translateTrimmedRow(t);var a=C.get(this);(0,v.rangeEach)(i,i+r-1,function(e){n.push(e)});this.collapsingUI.collapsedRowsStash.stash();this.collapsingUI.collapsedRowsStash.trimStash(i,r);this.collapsingUI.collapsedRowsStash.shiftStash(i,-1*r);this.dataManager.filterData(t,r,n);a.skipRender=true;return false}},{key:"onAfterContextMenuDefaultOptions",value:function e(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function e(t,r){this.headersUI.appendLevelIndicators(t,r)}},{key:"onModifyRowHeaderWidth",value:function e(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function e(t,r,n,i){var a=this;if(i===this.pluginName){return}var o=C.get(this);setTimeout(function(){o.skipRender=null;a.headersUI.updateRowHeaderWidth();a.collapsingUI.collapsedRowsStash.applyStash()},0)}},{key:"onModifyRemovedAmount",value:function e(t,r){var i=this;var a=[];var o=0;(0,v.rangeEach)(r,r+t-1,function(e){var t=false;var r=i.collapsingUI.translateTrimmedRow(e);var n=i.dataManager.getDataObject(r);if(i.dataManager.hasChildren(n)){a.push(n);(0,p.arrayEach)(a,function(e){if(e.__children.indexOf(n)>-1){t=true;return false}});if(!t){o+=i.dataManager.countChildren(n)}}t=false;(0,p.arrayEach)(a,function(e){if(e.__children.indexOf(n)>-1){t=true;return false}});if(t){o-=1}});return t+o}},{key:"onBeforeAddChild",value:function e(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function e(t,r){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(r));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function e(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function e(t,r){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(r));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function e(t,r,n){if(n===this.pluginName){return}this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function e(){if(this.bindRowsWithHeadersPlugin.bindStrategy.strategy){this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows())}var t=Math.max.apply(Math,(0,d.default)(this.dataManager.cache.levels));if(t>0){this.headersUI.updateRowHeaderWidth(t)}}},{key:"onBeforeRender",value:function e(t,r){var n=C.get(this);if(n.skipRender){r.skipRender=true}}},{key:"onAfterLoadData",value:function e(){this.dataManager.data=this.hot.getSourceData();this.dataManager.rewriteCache()}}]);return r}(c.default);(0,h.registerPlugin)("nestedRows",S);var E=S;t.default=E},function(e,t,r){"use strict";var n=r(0);r(12);r(15);r(41);r(33);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var i=n(r(42));var a=n(r(1));var o=n(r(2));var d=r(17);var s=r(3);var u=r(4);var l=r(98);var f=function(){function n(e,t,r){(0,a.default)(this,n);this.hot=t;this.data=r;this.plugin=e;this.parentReference=new WeakMap;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};this.recordTranslator=(0,l.getTranslator)(this.hot)}(0,o.default)(n,[{key:"rewriteCache",value:function e(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};(0,d.rangeEach)(0,this.data.length-1,function(e){t.cacheNode(t.data[e],0,null)})}},{key:"cacheNode",value:function e(t,r,n){var i=this;if(!this.cache.levels[r]){this.cache.levels[r]=[];this.cache.levelCount+=1}this.cache.levels[r].push(t);this.cache.rows.push(t);this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:r});if(this.hasChildren(t)){(0,u.arrayEach)(t.__children,function(e){i.cacheNode(e,r+1,t)})}}},{key:"getDataObject",value:function e(t){return t===null||t===void 0?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function e(t,r,n,i){var a=this;var o=false;var s=r;if(isNaN(s)&&s.end){return s}var l=t;if(!l){l={__children:this.data};o=true;s-=1}if(n!==null&&n!==void 0&&s===n){return{result:l,end:true}}if(i!==null&&i!==void 0&&l===i){return{result:s,end:true}}s+=1;if(l.__children){(0,u.arrayEach)(l.__children,function(e){a.parentReference.set(e,o?null:l);s=a.readTreeNodes(e,s,n,i);if(isNaN(s)&&s.end){return false}})}return s}},{key:"updateParentReference",value:function e(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function e(){var t=this.mockNode();t.__children=this.data;return t}},{key:"mockNode",value:function e(){var r={};(0,s.objectEach)(this.data[0],function(e,t){r[t]=null});return r}},{key:"getRowIndex",value:function e(t){return t===null||t===void 0?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function e(t){var r=null;if(isNaN(t)){r=t}else{r=this.getDataObject(t)}var n=this.getRowParent(t);if(n===null||n===void 0){return this.data.indexOf(r)}return n.__children.indexOf(r)}},{key:"countAllRows",value:function e(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function e(t){var r=this;var n=0;var i=t;if(!isNaN(i)){i=this.getDataObject(i)}if(!i||!i.__children){return 0}(0,u.arrayEach)(i.__children,function(e){n+=1;if(e.__children){n+=r.countChildren(e)}});return n}},{key:"getRowParent",value:function e(t){var r;if(isNaN(t)){r=t}else{r=this.getDataObject(t)}return this.getRowObjectParent(r)}},{key:"getRowObjectParent",value:function e(t){if((0,i.default)(t)!=="object"){return null}return this.cache.nodeInfo.get(t).parent}},{key:"getRowLevel",value:function e(t){var r=null;if(isNaN(t)){r=t}else{r=this.getDataObject(t)}return r?this.getRowObjectLevel(r):null}},{key:"getRowObjectLevel",value:function e(t){return t===null||t===void 0?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function e(t){var r=t;if(!isNaN(r)){r=this.getDataObject(r)}return!!(r.__children&&r.__children.length)}},{key:"isParent",value:function e(t){var r=t;if(!isNaN(r)){r=this.getDataObject(r)}return!!(0,s.hasOwnProperty)(r,"__children")}},{key:"addChild",value:function e(t,r){var n=r;this.hot.runHooks("beforeAddChild",t,n);var i=null;if(t){i=this.getRowIndex(t)}this.hot.runHooks("beforeCreateRow",i+this.countChildren(t)+1,1);var a=t;if(!t){a=this.mockParent()}if(!a.__children){a.__children=[]}if(!n){n=this.mockNode()}a.__children.push(n);this.rewriteCache();var o=this.getRowIndex(n);this.hot.runHooks("afterCreateRow",o,1);this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function e(t,r,n,i){var a=n;this.hot.runHooks("beforeAddChild",t,a,r);this.hot.runHooks("beforeCreateRow",i+1,1);var o=t;if(!t){o=this.mockParent()}if(!o.__children){o.__children=[]}if(!a){a=this.mockNode()}o.__children.splice(r,null,a);this.rewriteCache();this.hot.runHooks("afterCreateRow",i+1,1);this.hot.runHooks("afterAddChild",t,a,r)}},{key:"addSibling",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"below";var n=this.translateTrimmedRow(t);var i=this.getRowParent(n);var a=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,a+1,null,t);break;case"above":this.addChildAtIndex(i,a,null,t);break;default:break}}},{key:"detachFromParent",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=null;var a=[];if(Array.isArray(t)){(0,d.rangeEach)(t[0],t[2],function(e){var t=r.translateTrimmedRow(e);a.push(r.getDataObject(t))});(0,d.rangeEach)(0,a.length-2,function(e){r.detachFromParent(a[e],false)});i=a[a.length-1]}else{i=t}var o=this.getRowIndex(i);var s=this.getRowIndexWithinParent(i);var l=this.getRowParent(i);var u=this.getRowParent(l);var f=this.getRowIndex(u);var c=null;this.hot.runHooks("beforeDetachChild",l,i);if(s!==null&&s!==void 0){this.hot.runHooks("beforeRemoveRow",o,1,[o],this.plugin.pluginName);l.__children.splice(s,1);this.rewriteCache();this.hot.runHooks("afterRemoveRow",o,1,[o],this.plugin.pluginName);if(u){c=f+this.countChildren(u);this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName);u.__children.push(i)}else{c=this.hot.countRows()+1;this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName);this.data.push(i)}}this.rewriteCache();this.hot.runHooks("afterCreateRow",c,1,this.plugin.pluginName);if(n){this.hot.render()}this.hot.runHooks("afterDetachChild",l,i)}},{key:"filterData",value:function e(t,r,n){var i=this;var a=[];(0,u.arrayEach)(n,function(e){a.push(i.getDataObject(e))});(0,u.arrayEach)(a,function(e){var t=i.getRowIndexWithinParent(e);var r=i.getRowParent(e);if(r===null){i.data.splice(t,1)}else{r.__children.splice(t,1)}});this.rewriteCache()}},{key:"spliceData",value:function e(t,r,n){var i=this.translateTrimmedRow(t);if(i===null||i===void 0){return}var a=this.getDataObject(i-1);var o=null;var s=null;if(a&&a.__children&&a.__children.length===0){o=a;s=0}else{o=this.getRowParent(i);s=this.getRowIndexWithinParent(i)}if(o){if(n){o.__children.splice(s,r,n)}else{o.__children.splice(s,r)}}else if(n){this.data.splice(s,r,n)}else{this.data.splice(s,r)}this.rewriteCache()}},{key:"moveRow",value:function e(t,r){var n=this.isParent(r);var i=this.getRowParent(t);var a=this.getRowIndexWithinParent(t);var o=this.getRowParent(r);if(o===null||o===void 0){o=this.getRowParent(r-1)}if(o===null||o===void 0){o=this.getDataObject(r-1)}if(!o){o=this.getDataObject(r);o.__children=[]}else if(!o.__children){o.__children=[]}var s=this.getRowParent(r-1);var l=n?this.countChildren(s):this.getRowIndexWithinParent(r);var u=i.__children.slice(a,a+1);i.__children.splice(a,1);o.__children.splice(l,0,u[0])}},{key:"moveCellMeta",value:function e(t,r){var n=this.hot.getCellMetaAtRow(t);this.hot.spliceCellsMeta(r,0,n);this.hot.spliceCellsMeta(t+(t<r?0:1),1)}},{key:"translateTrimmedRow",value:function e(t){if(this.plugin.collapsingUI){return this.plugin.collapsingUI.translateTrimmedRow(t)}return t}}]);return n}();var c=f;t.default=c},function(e,t,r){"use strict";var n=r(0);r(12);r(41);r(33);t.__esModule=true;t.default=void 0;var o=n(r(37));var a=n(r(1));var i=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(7));var f=r(32);var c=r(4);var d=r(17);var h=r(8);var v=n(r(193));var p=n(r(415));var g=function(e){(0,u.default)(r,e);function r(e,t){var i;(0,a.default)(this,r);i=(0,s.default)(this,(0,l.default)(r).call(this,e,t));i.trimRowsPlugin=e.trimRowsPlugin;i.dataManager=i.plugin.dataManager;i.collapsedRows=[];i.collapsedRowsStash={stash:function e(){i.lastCollapsedRows=i.collapsedRows.slice(0);i.expandMultipleChildren(i.lastCollapsedRows,false)},shiftStash:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=i.translateTrimmedRow(t);(0,c.arrayEach)(i.lastCollapsedRows,function(e,t){if(e>n-1){i.lastCollapsedRows[t]=e+r}})},applyStash:function e(){i.hot.runHooks("skipLengthCache",100);i.collapseMultipleChildren(i.lastCollapsedRows,true);i.lastCollapsedRows=void 0},trimStash:function e(t,r){(0,d.rangeEach)(t,t+r-1,function(e){var t=i.lastCollapsedRows.indexOf(e);if(t>-1){i.lastCollapsedRows.splice(t,1)}})}};return i}(0,i.default)(r,[{key:"collapseChildren",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var a=[];var o=null;var s=null;var l=null;if(isNaN(t)){o=t;s=this.dataManager.getRowIndex(o)}else{o=this.dataManager.getDataObject(t);s=t}if(this.dataManager.hasChildren(o)){(0,c.arrayEach)(o.__children,function(e){a.push(r.dataManager.getRowIndex(e))})}l=this.collapseRows(a,true,false);if(i){this.trimRowsPlugin.trimRows(l)}if(n){this.renderAndAdjust()}if(this.collapsedRows.indexOf(s)===-1){this.collapsedRows.push(s)}return l}},{key:"collapseMultipleChildren",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var a=[];(0,c.arrayEach)(t,function(e){a.push.apply(a,(0,o.default)(r.collapseChildren(e,false,false)))});if(i){this.trimRowsPlugin.trimRows(a)}if(n){this.renderAndAdjust()}}},{key:"collapseRow",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.collapseRows([t],r)}},{key:"collapseRows",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=[];(0,c.arrayEach)(t,function(e){a.push(e);if(n){r.collapseChildRows(e,a)}});if(i){this.trimRowsPlugin.trimRows(a)}return a}},{key:"collapseChildRows",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);(0,c.arrayEach)(o.__children,function(e){var t=r.dataManager.getRowIndex(e);n.push(t);r.collapseChildRows(t,n)})}if(a){this.trimRowsPlugin.trimRows(n)}}},{key:"expandRow",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.expandRows([t],r)}},{key:"expandRows",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=[];(0,c.arrayEach)(t,function(e){a.push(e);if(n){r.expandChildRows(e,a)}});if(i){this.trimRowsPlugin.untrimRows(a)}return a}},{key:"expandChildRows",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);(0,c.arrayEach)(o.__children,function(e){if(!r.isAnyParentCollapsed(e)){var t=r.dataManager.getRowIndex(e);n.push(t);r.expandChildRows(t,n)}})}if(a){this.trimRowsPlugin.untrimRows(n)}}},{key:"expandChildren",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var a=[];var o=null;var s=null;var l=null;if(isNaN(t)){o=t;s=this.dataManager.getRowIndex(t)}else{o=this.dataManager.getDataObject(t);s=t}this.collapsedRows.splice(this.collapsedRows.indexOf(s),1);if(this.dataManager.hasChildren(o)){(0,c.arrayEach)(o.__children,function(e){var t=r.dataManager.getRowIndex(e);a.push(t)})}l=this.expandRows(a,true,false);if(i){this.trimRowsPlugin.untrimRows(l)}if(n){this.renderAndAdjust()}return l}},{key:"expandMultipleChildren",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var a=[];(0,c.arrayEach)(t,function(e){a.push.apply(a,(0,o.default)(r.expandChildren(e,false,false)))});if(i){this.trimRowsPlugin.untrimRows(a)}if(n){this.renderAndAdjust()}}},{key:"collapseAll",value:function e(){var t=this;var r=this.hot.getSourceData();var n=[];(0,c.arrayEach)(r,function(e){if(t.dataManager.hasChildren(e)){n.push(e)}});this.collapseMultipleChildren(n);this.renderAndAdjust()}},{key:"expandAll",value:function e(){var t=this;var r=this.hot.getSourceData();var n=[];(0,c.arrayEach)(r,function(e){if(t.dataManager.hasChildren(e)){n.push(e)}});this.expandMultipleChildren(n);this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function e(t){var r=this;var n=null;var i=true;if(isNaN(t)){n=t}else{n=this.dataManager.getDataObject(t)}if(this.dataManager.hasChildren(n)){(0,c.arrayEach)(n.__children,function(e){var t=r.dataManager.getRowIndex(e);if(!r.trimRowsPlugin.isTrimmed(t)){i=false;return false}})}return i}},{key:"isAnyParentCollapsed",value:function e(t){var r=t;while(r!==null){r=this.dataManager.getRowParent(r);var n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1){return true}}return false}},{key:"toggleState",value:function e(t,r){if(r.col>=0){return}var n=this.translateTrimmedRow(r.row);if((0,h.hasClass)(t.target,p.default.CSS_CLASSES.button)){if(this.areChildrenCollapsed(n)){this.expandChildren(n)}else{this.collapseChildren(n)}(0,f.stopImmediatePropagation)(t)}}},{key:"translateTrimmedRow",value:function e(t){return this.trimRowsPlugin.rowsMapper.getValueByIndex(t)}},{key:"renderAndAdjust",value:function e(){this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize()}}]);return r}(v.default);var m=g;t.default=m},function(e,t,r){"use strict";var n=r(9);var i=r(0);r(15);r(33);r(10);r(13);r(24);r(16);t.__esModule=true;t.default=void 0;var a=i(r(1));var o=i(r(2));var s=i(r(6));var l=i(r(5));var u=i(r(28));var f=i(r(7));var c=r(17);var d=r(4);var h=n(r(11));var v=i(r(193));var p=new WeakMap;var g=function(e){(0,f.default)(r,e);function r(e,t){var n;(0,a.default)(this,r);n=(0,s.default)(this,(0,l.default)(r).call(this,e,t));p.set((0,u.default)(n),{row_above:function e(t,r){n.dataManager.addSibling(r.start.row,"above")},row_below:function e(t,r){n.dataManager.addSibling(r.start.row,"below")}});n.dataManager=n.plugin.dataManager;return n}(0,o.default)(r,[{key:"appendOptions",value:function e(n){var i=this;var t=[{key:"add_child",name:function e(){return this.getTranslatedPhrase(h.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function e(){var t=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]);var r=i.dataManager.getDataObject(t);i.dataManager.addChild(r)},disabled:function e(){var t=i.hot.getSelectedLast();return!t||t[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function e(){return this.getTranslatedPhrase(h.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function e(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function e(){var t=i.hot.getSelectedLast();var r=i.dataManager.translateTrimmedRow(t[0]);var n=i.dataManager.getRowParent(r);return!n||!t||t[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];(0,c.rangeEach)(0,n.items.length-1,function(r){if(r===0){(0,d.arrayEach)(t,function(e,t){n.items.splice(r+t,0,e)});return false}});return this.modifyRowInsertingOptions(n)}},{key:"modifyRowInsertingOptions",value:function e(r){var n=p.get(this);(0,c.rangeEach)(0,r.items.length-1,function(e){var t=n[r.items[e].key];if(t!==null&&t!==void 0){r.items[e].callback=t}});return r}}]);return r}(v.default);var m=g;t.default=m},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(19);r(100);r(50);r(60);r(31);r(12);r(15);r(54);r(33);r(86);r(87);r(10);r(23);r(88);r(39);r(13);r(52);r(16);t.__esModule=true;t.default=void 0;var i=n(r(42));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(22));var d=r(8);var h=r(17);var v=r(4);var p=r(21);var g=r(89);var m=n(r(46));var y=n(r(690));var b=n(r(691));r(692);m.default.getSingleton().register("beforeHideColumns");m.default.getSingleton().register("afterHideColumns");m.default.getSingleton().register("beforeUnhideColumns");m.default.getSingleton().register("afterUnhideColumns");var w=function(e){(0,f.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.settings={};t.hiddenColumns=[];t.lastSelectedColumn=-1;return t}(0,o.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function e(){var n=this;if(this.enabled){return}if(this.hot.hasColHeaders()){this.addHook("afterGetColHeader",function(e,t){return n.onAfterGetColHeader(e,t)})}else{this.addHook("afterRenderer",function(e,t,r){return n.onAfterGetColHeader(r,e)})}this.addHook("afterContextMenuDefaultOptions",function(e){return n.onAfterContextMenuDefaultOptions(e)});this.addHook("afterGetCellMeta",function(e,t,r){return n.onAfterGetCellMeta(e,t,r)});this.addHook("modifyColWidth",function(e,t){return n.onModifyColWidth(e,t)});this.addHook("beforeSetRangeStartOnly",function(e){return n.onBeforeSetRangeStart(e)});this.addHook("beforeSetRangeEnd",function(e){return n.onBeforeSetRangeEnd(e)});this.addHook("hiddenColumn",function(e){return n.isHidden(e)});this.addHook("beforeStretchingColumnWidth",function(e,t){return n.onBeforeStretchingColumnWidth(e,t)});this.addHook("afterCreateCol",function(e,t){return n.onAfterCreateCol(e,t)});this.addHook("afterRemoveCol",function(e,t){return n.onAfterRemoveCol(e,t)});this.addHook("init",function(){return n.onInit()});if(this.hot.view){this.onInit()}(0,u.default)((0,l.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();(0,u.default)((0,l.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1;this.hot.render();(0,u.default)((0,l.default)(r.prototype),"disablePlugin",this).call(this);this.resetCellsMeta()}},{key:"showColumns",value:function e(t){var r=this.hiddenColumns;var n=this.isColumnDataValid(t);var i=r;if(n){i=this.hiddenColumns.filter(function(e){return t.includes(e)===false})}var a=this.hot.runHooks("beforeUnhideColumns",r,i,n);if(a===false){return}if(n){this.hiddenColumns=i}this.hot.runHooks("afterUnhideColumns",r,i,n,n&&i.length<r.length)}},{key:"showColumn",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.showColumns(r)}},{key:"hideColumns",value:function e(t){var r=this.hiddenColumns;var n=this.isColumnDataValid(t);var i=r;if(n){i=Array.from(new Set(r.concat(t)))}var a=this.hot.runHooks("beforeHideColumns",r,i,n);if(a===false){return}if(n){this.hiddenColumns=i}this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length)}},{key:"hideColumn",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.hideColumns(r)}},{key:"isHidden",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=t;if(!r){n=this.hot.toPhysicalColumn(t)}return this.hiddenColumns.includes(n)}},{key:"isColumnDataValid",value:function e(t){var r=this;return t.every(function(e){return Number.isInteger(e)&&e>=0&&e<r.hot.countCols()})}},{key:"resetCellsMeta",value:function e(){(0,v.arrayEach)(this.hot.getCellsMeta(),function(e){if(e){e.skipColumnOnPaste=false;if(e.baseRenderer!==null){e.renderer=e.baseRenderer;e.baseRenderer=null}}})}},{key:"onBeforeStretchingColumnWidth",value:function e(t,r){var n=t;if(this.isHidden(r)){n=0}return n}},{key:"onModifyColWidth",value:function e(t,r){if(this.isHidden(r)){return.1}else if(this.settings.indicators&&(this.isHidden(r+1)||this.isHidden(r-1))){return t+(this.hot.hasColHeaders()?15:0)}}},{key:"onAfterGetCellMeta",value:function e(t,r,n){var i=this.hot.runHooks("unmodifyCol",r);if(this.settings.copyPasteEnabled===false&&this.isHidden(r)){n.skipColumnOnPaste=true}if(this.isHidden(i)){if(n.renderer!==C){n.baseRenderer=n.renderer}n.renderer=C}else if(n.baseRenderer!==null){n.renderer=n.baseRenderer;n.baseRenderer=null}if(this.isHidden(n.visualCol-1)){var a=true;var o=n.visualCol-1;n.className=n.className||"";if(n.className.indexOf("afterHiddenColumn")===-1){n.className+=" afterHiddenColumn"}do{if(!this.isHidden(o)){a=false;break}o-=1}while(o>=0);if(a&&n.className.indexOf("firstVisibleColumn")===-1){n.className+=" firstVisibleColumn"}}else if(n.className){var s=n.className.split(" ");if(s.length){var l=s.indexOf("afterHiddenColumn");if(l>-1){s.splice(l,1)}var u=s.indexOf("firstVisibleColumn");if(u>-1){s.splice(u,1)}n.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function e(t){var i=this;var a=[];var o=function e(t,r,n,i){a.push({startRow:t,endRow:r,startCol:n,endCol:i})};(0,v.arrayEach)(t,function(t){var r=true;var n=0;(0,h.rangeEach)(t.startCol,t.endCol,function(e){if(i.isHidden(e)){if(!r){o(t.startRow,t.endRow,n,e-1)}r=true}else{if(r){n=e}if(e===t.endCol){o(t.startRow,t.endRow,n,e)}r=false}})});return a}},{key:"onAfterGetColHeader",value:function e(t,r){if(this.isHidden(t)){return}var n=true;var i=t-1;do{if(!this.isHidden(i)){n=false;break}i-=1}while(i>=0);if(n){(0,d.addClass)(r,"firstVisibleColumn")}if(!this.settings.indicators){return}if(this.isHidden(t-1)){(0,d.addClass)(r,"afterHiddenColumn")}if(this.isHidden(t+1)&&t>-1){(0,d.addClass)(r,"beforeHiddenColumn")}}},{key:"onBeforeSetRangeStart",value:function e(t){var i=this;if(t.col>0){return}t.col=0;var r=function e(t){var r=t;var n=i.hot.toPhysicalColumn(r);if(i.isHidden(n,true)){r+=1;r=e(r)}return r};t.col=r(t.col)}},{key:"onBeforeSetRangeEnd",value:function e(i){var a=this;var o=this.hot.countCols();var t=function e(t){var r=t;var n=a.hot.toPhysicalColumn(r);if(a.isHidden(n,true)){if(a.lastSelectedColumn>r||i.col===o-1){if(r>0){r-=1;r=e(r)}else{(0,h.rangeEach)(0,a.lastSelectedColumn,function(e){if(!a.isHidden(e)){r=e;return false}})}}else{r+=1;r=e(r)}}return r};i.col=t(i.col);this.lastSelectedColumn=i.col}},{key:"onAfterContextMenuDefaultOptions",value:function e(t){t.items.push({name:g.SEPARATOR},(0,y.default)(this),(0,b.default)(this))}},{key:"onAfterCreateCol",value:function e(r,n){var i=[];(0,v.arrayEach)(this.hiddenColumns,function(e){var t=e;if(t>=r){t+=n}i.push(t)});this.hiddenColumns=i}},{key:"onAfterRemoveCol",value:function e(r,n){var i=[];(0,v.arrayEach)(this.hiddenColumns,function(e){var t=e;if(t>=r){t-=n}i.push(t)});this.hiddenColumns=i}},{key:"onInit",value:function e(){var t=this;var r=this.hot.getSettings().hiddenColumns;if((0,i.default)(r)==="object"){this.settings=r;if(r.copyPasteEnabled===void 0){r.copyPasteEnabled=true}if(Array.isArray(r.columns)){this.hideColumns(r.columns)}if(!r.copyPasteEnabled){this.addHook("modifyCopyableRange",function(e){return t.onModifyCopyableRange(e)})}}}},{key:"destroy",value:function e(){(0,u.default)((0,l.default)(r.prototype),"destroy",this).call(this)}}]);return r}(c.default);function C(e,t){t.textContent=""}(0,p.registerPlugin)("hiddenColumns",w);var S=w;t.default=S},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=a;var s=i(r(18));var l=r(17);var u=n(r(11));function a(o){return{key:"hidden_columns_hide",name:function e(){var t=this.getSelectedLast();var r=0;if(Array.isArray(t)){var n=(0,s.default)(t,4),i=n[1],a=n[3];if(i-a!==0){r=1}}return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_HIDE_COLUMN,r)},callback:function e(){var t=this.getSelectedRangeLast(),r=t.from,n=t.to;var i=Math.min(r.col,n.col);var a=Math.max(r.col,n.col);(0,l.rangeEach)(i,a,function(e){return o.hideColumn(e)});this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function e(){return!this.selection.isSelectedByColumnHeader()}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=a;var c=i(r(18));var d=r(17);var h=n(r(11));function a(l){var u=[];var f=[];return{key:"hidden_columns_show",name:function e(){var t=this.getSelectedLast();var r=0;if(Array.isArray(t)){var n=(0,c.default)(t,4),i=n[1],a=n[3];if(i>a){var o=[a,i];i=o[0];a=o[1]}var s=0;if(i===a){s=u.length+f.length}else{(0,d.rangeEach)(i,a,function(e){if(l.isHidden(e)){s+=1}})}r=s<=1?0:1}return this.getTranslatedPhrase(h.CONTEXTMENU_ITEMS_SHOW_COLUMN,r)},callback:function e(){var t=this.getSelectedRangeLast(),r=t.from,n=t.to;var i=Math.min(r.col,n.col);var a=Math.max(r.col,n.col);if(i===a){if(u.length===i){l.showColumns(u);u.length=0}if(f.length===this.countSourceCols()-(i+1)){l.showColumns(f);f.length=0}}else{(0,d.rangeEach)(i,a,function(e){return l.showColumn(e)})}this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function e(){if(!l.hiddenColumns.length||!this.selection.isSelectedByColumnHeader()){return true}u.length=0;f.length=0;var t=this.getSelectedRangeLast(),r=t.from,n=t.to;var i=Math.min(r.col,n.col);var a=Math.max(r.col,n.col);var o=false;if(i===a){var s=this.countSourceCols();(0,d.rangeEach)(0,s,function(e){var t=u.length+f.length;if(t===l.hiddenColumns.length){return false}if(e<i&&l.isHidden(e)){u.push(e)}else if(l.isHidden(e)){f.push(e)}});s-=1;if(u.length===i&&i>0||f.length===s-i&&i<s){o=true}}else{(0,d.rangeEach)(i,a,function(e){if(l.isHidden(e)){o=true;return false}})}return!o}}}},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(19);r(100);r(50);r(60);r(31);r(12);r(15);r(54);r(33);r(86);r(87);r(10);r(23);r(88);r(39);r(13);r(52);r(16);t.__esModule=true;t.default=void 0;var i=n(r(42));var a=n(r(1));var o=n(r(2));var s=n(r(6));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(22));var d=r(8);var h=r(17);var v=r(4);var p=r(21);var g=n(r(46));var m=n(r(694));var y=n(r(695));r(696);g.default.getSingleton().register("beforeHideRows");g.default.getSingleton().register("afterHideRows");g.default.getSingleton().register("beforeUnhideRows");g.default.getSingleton().register("afterUnhideRows");var b=function(e){(0,f.default)(r,e);function r(e){var t;(0,a.default)(this,r);t=(0,s.default)(this,(0,l.default)(r).call(this,e));t.settings={};t.hiddenRows=[];t.lastSelectedRow=-1;return t}(0,o.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function e(){var n=this;if(this.enabled){return}if(this.hot.hasRowHeaders()){this.addHook("afterGetRowHeader",function(e,t){return n.onAfterGetRowHeader(e,t)})}else{this.addHook("afterRenderer",function(e,t){return n.onAfterGetRowHeader(t,e)})}this.addHook("afterContextMenuDefaultOptions",function(e){return n.onAfterContextMenuDefaultOptions(e)});this.addHook("afterGetCellMeta",function(e,t,r){return n.onAfterGetCellMeta(e,t,r)});this.addHook("modifyRowHeight",function(e,t){return n.onModifyRowHeight(e,t)});this.addHook("beforeSetRangeStartOnly",function(e){return n.onBeforeSetRangeStartOnly(e)});this.addHook("beforeSetRangeStart",function(e){return n.onBeforeSetRangeStart(e)});this.addHook("beforeSetRangeEnd",function(e){return n.onBeforeSetRangeEnd(e)});this.addHook("hiddenRow",function(e){return n.isHidden(e)});this.addHook("afterCreateRow",function(e,t){return n.onAfterCreateRow(e,t)});this.addHook("afterRemoveRow",function(e,t){return n.onAfterRemoveRow(e,t)});this.addHook("init",function(){return n.onInit()});if(this.hot.view){this.onInit()}(0,u.default)((0,l.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){this.disablePlugin();this.enablePlugin();this.onInit();(0,u.default)((0,l.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1;(0,u.default)((0,l.default)(r.prototype),"disablePlugin",this).call(this);this.resetCellsMeta()}},{key:"showRows",value:function e(t){var r=this;var n=this.hiddenRows;var i=this.isRowDataValid(t);var a=(0,v.arrayMap)(t,function(e){return r.hot.toPhysicalRow(e)});var o=n;if(i){o=this.hiddenRows.filter(function(e){return a.includes(e)===false})}var s=this.hot.runHooks("beforeUnhideRows",n,o,i);if(s===false){return}if(i){this.hiddenRows=o}this.hot.runHooks("afterUnhideRows",n,o,i,i&&o.length<n.length)}},{key:"showRow",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.showRows(r)}},{key:"hideRows",value:function e(t){var r=this;var n=this.hiddenRows;var i=this.isRowDataValid(t);var a=(0,v.arrayMap)(t,function(e){return r.hot.toPhysicalRow(e)});var o=n;if(i){o=Array.from(new Set(n.concat(a)))}var s=this.hot.runHooks("beforeHideRows",n,o,i);if(s===false){return}if(i){this.hiddenRows=o}this.hot.runHooks("afterHideRows",n,o,i,i&&o.length>n.length)}},{key:"hideRow",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.hideRows(r)}},{key:"isHidden",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=t;if(!r){n=this.hot.toPhysicalRow(t)}return this.hiddenRows.includes(n)}},{key:"isRowDataValid",value:function e(t){var r=this;return t.every(function(e){return Number.isInteger(e)&&e>=0&&e<r.hot.countRows()})}},{key:"resetCellsMeta",value:function e(){(0,v.arrayEach)(this.hot.getCellsMeta(),function(e){if(e){e.skipRowOnPaste=false}})}},{key:"onAfterGetCellMeta",value:function e(t,r,n){var i=this.hot.runHooks("unmodifyRow",t);if(this.settings.copyPasteEnabled===false&&this.isHidden(i)){n.skipRowOnPaste=true}else{n.skipRowOnPaste=false}if(this.isHidden(i-1)){var a=true;var o=i-1;n.className=n.className||"";if(n.className.indexOf("afterHiddenRow")===-1){n.className+=" afterHiddenRow"}do{if(!this.isHidden(o)){a=false;break}o-=1}while(o>=0);if(a&&n.className.indexOf("firstVisibleRow")===-1){n.className+=" firstVisibleRow"}}else if(n.className){var s=n.className.split(" ");if(s.length){var l=s.indexOf("afterHiddenRow");if(l>-1){s.splice(l,1)}var u=s.indexOf("firstVisibleRow");if(u>-1){s.splice(u,1)}n.className=s.join(" ")}}}},{key:"onAfterGetRowHeader",value:function e(t,r){var n=r.parentNode;if(n){if(this.isHidden(t)){(0,d.addClass)(n,"hide")}else{(0,d.removeClass)(n,"hide")}}var i=true;var a=t-1;do{if(!this.isHidden(a)){i=false;break}a-=1}while(a>=0);if(i){(0,d.addClass)(r,"firstVisibleRow")}if(this.settings.indicators&&this.hot.hasRowHeaders()){if(this.isHidden(t-1)){(0,d.addClass)(r,"afterHiddenRow")}if(this.isHidden(t+1)){(0,d.addClass)(r,"beforeHiddenRow")}}}},{key:"onModifyRowHeight",value:function e(t,r){if(this.isHidden(r)){return.1}return t}},{key:"onModifyCopyableRange",value:function e(t){var i=this;var a=[];var o=function e(t,r,n,i){a.push({startRow:t,endRow:r,startCol:n,endCol:i})};(0,v.arrayEach)(t,function(t){var r=true;var n=0;(0,h.rangeEach)(t.startRow,t.endRow,function(e){if(i.isHidden(e)){if(!r){o(n,e-1,t.startCol,t.endCol)}r=true}else{if(r){n=e}if(e===t.endRow){o(n,e,t.startCol,t.endCol)}r=false}})});return a}},{key:"onBeforeSetRangeStart",value:function e(t){var i=this;var a=this.hot.getSelectedLast()||false;var o=this.hot.countRows()-1;var r=function e(t){var r=0;var n=t;if(a){r=n>a[0]?1:-1;i.lastSelectedRow=a[0]}if(o<n||n<0){return i.lastSelectedRow}if(i.isHidden(n)){n=e(n+r)}return n};t.row=r(t.row)}},{key:"onBeforeSetRangeStartOnly",value:function e(t){var n=this;if(t.row>0){return}t.row=0;var r=function e(t){var r=t;if(n.isHidden(r)){r+=1;r=e(r)}return r};t.row=r(t.row)}},{key:"onBeforeSetRangeEnd",value:function e(n){var i=this;var a=this.hot.countRows();var t=function e(t){var r=t;if(i.isHidden(r)){if(i.lastSelectedRow>r||n.row===a-1){if(r>0){r-=1;r=e(r)}else{(0,h.rangeEach)(0,i.lastSelectedRow,function(e){if(!i.isHidden(e)){r=e;return false}})}}else{r+=1;r=e(r)}}return r};n.row=t(n.row);this.lastSelectedRow=n.row}},{key:"onAfterContextMenuDefaultOptions",value:function e(t){t.items.push({name:"---------"},(0,m.default)(this),(0,y.default)(this))}},{key:"onAfterCreateRow",value:function e(r,n){var i=[];(0,v.arrayEach)(this.hiddenRows,function(e){var t=e;if(t>=r){t+=n}i.push(t)});this.hiddenRows=i}},{key:"onAfterRemoveRow",value:function e(r,n){var i=[];(0,v.arrayEach)(this.hiddenRows,function(e){var t=e;if(t>=r){t-=n}i.push(t)});this.hiddenRows=i}},{key:"onInit",value:function e(){var t=this;var r=this.hot.getSettings().hiddenRows;if((0,i.default)(r)==="object"){this.settings=r;if(r.copyPasteEnabled===void 0){r.copyPasteEnabled=true}if(Array.isArray(r.rows)){this.hideRows(r.rows)}if(!r.copyPasteEnabled){this.addHook("modifyCopyableRange",function(e){return t.onModifyCopyableRange(e)})}}}},{key:"destroy",value:function e(){(0,u.default)((0,l.default)(r.prototype),"destroy",this).call(this)}}]);return r}(c.default);(0,p.registerPlugin)("hiddenRows",b);var w=b;t.default=w},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=a;var s=i(r(18));var l=r(17);var u=n(r(11));function a(o){return{key:"hidden_rows_hide",name:function e(){var t=this.getSelectedLast();var r=0;if(Array.isArray(t)){var n=(0,s.default)(t,3),i=n[0],a=n[2];if(i-a!==0){r=1}}return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_HIDE_ROW,r)},callback:function e(){var t=this.getSelectedRangeLast(),r=t.from,n=t.to;var i=Math.min(r.row,n.row);var a=Math.max(r.row,n.row);(0,l.rangeEach)(i,a,function(e){return o.hideRow(e)});this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function e(){return!this.selection.isSelectedByRowHeader()}}}},function(e,t,r){"use strict";var n=r(9);var i=r(0);t.__esModule=true;t.default=a;var c=i(r(18));var d=r(17);var h=n(r(11));function a(l){var u=[];var f=[];return{key:"hidden_rows_show",name:function e(){var t=this.getSelectedLast();var r=0;if(Array.isArray(t)){var n=(0,c.default)(t,3),i=n[0],a=n[2];if(i>a){var o=[a,i];i=o[0];a=o[1]}var s=0;if(i===a){s=u.length+f.length}else{(0,d.rangeEach)(i,a,function(e){if(l.isHidden(e)){s+=1}})}r=s<=1?0:1}return this.getTranslatedPhrase(h.CONTEXTMENU_ITEMS_SHOW_ROW,r)},callback:function e(){var t=this.getSelectedRangeLast(),r=t.from,n=t.to;var i=Math.min(r.row,n.row);var a=Math.max(r.row,n.row);if(i===a){if(u.length===i){l.showRows(u);u.length=0}if(f.length===this.countSourceRows()-(i+1)){l.showRows(f);f.length=0}}else{(0,d.rangeEach)(i,a,function(e){return l.showRow(e)})}this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function e(){if(!l.hiddenRows.length||!this.selection.isSelectedByRowHeader()){return true}u.length=0;f.length=0;var t=this.getSelectedRangeLast(),r=t.from,n=t.to;var i=Math.min(r.row,n.row);var a=Math.max(r.row,n.row);var o=false;if(i===a){var s=this.countSourceRows();(0,d.rangeEach)(0,s,function(e){var t=u.length+f.length;if(t===l.hiddenRows.length){return false}if(e<i){if(l.isHidden(e)){u.push(e)}}else if(l.isHidden(e)){f.push(e)}});s-=1;if(u.length===i&&i>0||f.length===s-i&&i<s){o=true}}else{(0,d.rangeEach)(i,a,function(e){if(l.isHidden(e)){o=true;return false}})}return!o}}}},function(e,t,r){},function(e,t,r){"use strict";var n=r(0);r(19);r(100);r(50);r(60);r(31);r(15);r(86);r(87);r(10);r(88);r(39);r(13);r(16);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(6));var s=n(r(28));var l=n(r(5));var u=n(r(14));var f=n(r(7));var c=n(r(22));var d=r(17);var h=r(21);var v=n(r(698));var p=r(4);var g=function(e){(0,f.default)(r,e);function r(e){var t;(0,i.default)(this,r);t=(0,o.default)(this,(0,l.default)(r).call(this,e));t.trimmedRows=[];t.removedRows=[];t.rowsMapper=new v.default((0,s.default)(t));return t}(0,a.default)(r,[{key:"isEnabled",value:function e(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function e(){var n=this;if(this.enabled){return}var t=this.hot.getSettings().trimRows;if(Array.isArray(t)){this.trimmedRows=t}this.rowsMapper.createMap(this.hot.countSourceRows());this.addHook("modifyRow",function(e,t){return n.onModifyRow(e,t)});this.addHook("unmodifyRow",function(e,t){return n.onUnmodifyRow(e,t)});this.addHook("beforeCreateRow",function(e,t,r){return n.onBeforeCreateRow(e,t,r)});this.addHook("afterCreateRow",function(e,t){return n.onAfterCreateRow(e,t)});this.addHook("beforeRemoveRow",function(e,t){return n.onBeforeRemoveRow(e,t)});this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow()});this.addHook("afterLoadData",function(e){return n.onAfterLoadData(e)});(0,u.default)((0,l.default)(r.prototype),"enablePlugin",this).call(this)}},{key:"updatePlugin",value:function e(){var t=this.hot.getSettings().trimRows;if(Array.isArray(t)){this.disablePlugin();this.enablePlugin()}(0,u.default)((0,l.default)(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function e(){this.trimmedRows=[];this.removedRows.length=0;this.rowsMapper.clearMap();(0,u.default)((0,l.default)(r.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function e(t){var r=this.trimmedRows;var n=this.isValidConfig(t);var i=r;if(n){i=Array.from(new Set(r.concat(t)))}var a=this.hot.runHooks("beforeTrimRow",r,i,n);if(a===false){return}if(n){this.trimmedRows=i;this.hot.runHooks("skipLengthCache",100);this.rowsMapper.createMap(this.hot.countSourceRows())}this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length)}},{key:"trimRow",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.trimRows(r)}},{key:"untrimRows",value:function e(t){var r=this.trimmedRows;var n=this.isValidConfig(t);var i=r;if(n){i=this.trimmedRows.filter(function(e){return t.includes(e)===false})}var a=this.hot.runHooks("beforeUntrimRow",r,i,n);if(a===false){return}if(n){this.trimmedRows=i;this.hot.runHooks("skipLengthCache",100);this.rowsMapper.createMap(this.hot.countSourceRows())}this.hot.runHooks("afterUntrimRow",r,i,n,n&&i.length<r.length)}},{key:"untrimRow",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this.untrimRows(r)}},{key:"isTrimmed",value:function e(t){return this.trimmedRows.includes(t)}},{key:"untrimAll",value:function e(){this.untrimRows([].concat(this.trimmedRows))}},{key:"isValidConfig",value:function e(t){var r=this;return t.every(function(e){return Number.isInteger(e)&&e>=0&&e<r.hot.countSourceRows()})}},{key:"onModifyRow",value:function e(t,r){var n=t;if(r!==this.pluginName){n=this.rowsMapper.getValueByIndex(n)}return n}},{key:"onUnmodifyRow",value:function e(t,r){var n=t;if(r!==this.pluginName){n=this.rowsMapper.getIndexByValue(n)}return n}},{key:"onBeforeCreateRow",value:function e(t,r,n){if(this.isEnabled()&&this.trimmedRows.length>0&&n==="auto"){return false}}},{key:"onAfterCreateRow",value:function e(t,r){var n=this;this.rowsMapper.shiftItems(t,r);this.trimmedRows=(0,p.arrayMap)(this.trimmedRows,function(e){if(e>=n.rowsMapper.getValueByIndex(t)){return e+r}return e})}},{key:"onBeforeRemoveRow",value:function e(t,r){var n=this;this.removedRows.length=0;if(t!==false){(0,d.rangeEach)(t,t+r-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e,n.pluginName))})}}},{key:"onAfterRemoveRow",value:function e(){var r=this;this.rowsMapper.unshiftItems(this.removedRows);this.trimmedRows=(0,p.arrayMap)(this.trimmedRows,function(t){return t-r.removedRows.filter(function(e){return e<t}).length})}},{key:"onAfterLoadData",value:function e(t){if(!t){this.rowsMapper.createMap(this.hot.countSourceRows())}}},{key:"destroy",value:function e(){this.rowsMapper.destroy();(0,u.default)((0,l.default)(r.prototype),"destroy",this).call(this)}}]);return r}(c.default);(0,h.registerPlugin)("trimRows",g);var m=g;t.default=m},function(e,t,r){"use strict";var n=r(0);t.__esModule=true;t.default=void 0;var i=n(r(1));var a=n(r(2));var o=n(r(101));var s=r(3);var l=r(17);var u=function(){function t(e){(0,i.default)(this,t);this.trimRows=e}(0,a.default)(t,[{key:"createMap",value:function e(t){var r=this;var n=0;var i=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0;(0,l.rangeEach)(i-1,function(e){if(r.trimRows.isTrimmed(e)){n+=1}else{r._arrayMap[e-n]=e}})}},{key:"destroy",value:function e(){this._arrayMap=null}}]);return t}();(0,s.mixin)(u,o.default);var f=u;t.default=f}])["default"]});(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r(require("../../handsontable"));else if(typeof define==="function"&&define.amd)define(["../../handsontable"],r);else{var n=typeof exports==="object"?r(require("../../handsontable")):r(t["Handsontable"]);for(var i in n)(typeof exports==="object"?exports:t)[i]=n[i]}})(typeof self!=="undefined"?self:this,function(r){return function(r){var n={};function i(e){if(n[e]){return n[e].exports}var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=r;i.c=n;i.d=function(e,t,r){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);i.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=11)}([,function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}e.exports=r},function(e,t){function r(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}e.exports=r},function(e,t){e.exports=r},,,,,,,,function(e,t,r){"use strict";var n=r(1);t.__esModule=true;t.default=void 0;var i=n(r(2));var a=n(r(3));var o;var s=a.default.languages.dictionaryKeys;var l=(o={languageCode:"ko-KR"},(0,i.default)(o,s.CONTEXTMENU_ITEMS_ROW_ABOVE,"ììª½ì í ì½ì"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ROW_BELOW,"ìëìª½ì í ì½ì"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_INSERT_LEFT,"ì¼ìª½ì ì´ ì½ì"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_INSERT_RIGHT,"ì¤ë¥¸ìª½ì ì´ ì½ì"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_REMOVE_ROW,["í ì­ì ","ì¬ë¬ í ì­ì "]),(0,i.default)(o,s.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["ì´ ì­ì ","ì¬ë¬ ì´ ì­ì "]),(0,i.default)(o,s.CONTEXTMENU_ITEMS_UNDO,"ëëë¦¬ê¸°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_REDO,"ë¤ìíê¸°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_READ_ONLY,"ì½ê¸° ì ì©"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"ì´ ì§ì°ê¸°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT,"ì ë ¬"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"ì¼ìª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"ì¤ì"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"ì¤ë¥¸ìª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"ìë"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"ììª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"ê°ì´ë°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"ìëìª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"ì´ ê³ ì "),(0,i.default)(o,s.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"ì´ ê³ ì  í´ì "),(0,i.default)(o,s.CONTEXTMENU_ITEMS_BORDERS,"íëë¦¬"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_BORDERS_TOP,"ììª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"ì¤ë¥¸ìª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"ìëìª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_BORDERS_LEFT,"ì¼ìª½"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"íëë¦¬ ì§ì°ê¸°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_ADD_COMMENT,"ëê¸ ë¬ê¸°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_EDIT_COMMENT,"ëê¸ í¸ì§"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"ëê¸ ì­ì "),(0,i.default)(o,s.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"ì½ê¸° ì ì© ëê¸"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_MERGE_CELLS,"ì ë³í©"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"ì ë³í© í´ì "),(0,i.default)(o,s.CONTEXTMENU_ITEMS_COPY,"ë³µì¬"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_CUT,"ìë¼ë´ê¸°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"ìë í ì¶ê°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"ë¶ëª¨íìì ì ê±°"),(0,i.default)(o,s.CONTEXTMENU_ITEMS_HIDE_COLUMN,["ì´ ì¨ê¸°ê¸°","ì¬ë¬ ì´ ì¨ê¸°ê¸°"]),(0,i.default)(o,s.CONTEXTMENU_ITEMS_SHOW_COLUMN,["ì´ ì¨ê¸°ê¸° í´ì ","ì¬ë¬ ì´ ì¨ê¸°ê¸° í´ì "]),(0,i.default)(o,s.CONTEXTMENU_ITEMS_HIDE_ROW,["í ì¨ê¸°ê¸°","ì¬ë¬ í ì¨ê¸°ê¸°"]),(0,i.default)(o,s.CONTEXTMENU_ITEMS_SHOW_ROW,["í ì¨ê¸°ê¸° í´ì ","ì¬ë¬ í ì¨ê¸°ê¸° í´ì "]),(0,i.default)(o,s.FILTERS_CONDITIONS_NONE,"ì¡°ê±´ìì"),(0,i.default)(o,s.FILTERS_CONDITIONS_EMPTY,"ë¹ì´ìì"),(0,i.default)(o,s.FILTERS_CONDITIONS_NOT_EMPTY,"ë¹ì´ìì§ ìì"),(0,i.default)(o,s.FILTERS_CONDITIONS_EQUAL,"ê°ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_NOT_EQUAL,"ê°ì§ ìì"),(0,i.default)(o,s.FILTERS_CONDITIONS_BEGINS_WITH,"ìì ë¬¸ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_ENDS_WITH,"ë ë¬¸ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_CONTAINS,"í¬í¨"),(0,i.default)(o,s.FILTERS_CONDITIONS_NOT_CONTAIN,"í¬í¨íì§ ìì"),(0,i.default)(o,s.FILTERS_CONDITIONS_GREATER_THAN,"ë³´ë¤ í¼"),(0,i.default)(o,s.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"í¬ê±°ë ê°ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_LESS_THAN,"ë³´ë¤ ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"ìê±°ë ê°ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_BETWEEN,"ì¬ì´"),(0,i.default)(o,s.FILTERS_CONDITIONS_NOT_BETWEEN,"ì¬ì´ ì ì¸"),(0,i.default)(o,s.FILTERS_CONDITIONS_AFTER,"ë¤ì"),(0,i.default)(o,s.FILTERS_CONDITIONS_BEFORE,"ì "),(0,i.default)(o,s.FILTERS_CONDITIONS_TODAY,"ì¤ë"),(0,i.default)(o,s.FILTERS_CONDITIONS_TOMORROW,"ë´ì¼"),(0,i.default)(o,s.FILTERS_CONDITIONS_YESTERDAY,"ì´ì "),(0,i.default)(o,s.FILTERS_VALUES_BLANK_CELLS,"ê³µë"),(0,i.default)(o,s.FILTERS_DIVS_FILTER_BY_CONDITION,"ì¡°ê±´ë¶ íí°"),(0,i.default)(o,s.FILTERS_DIVS_FILTER_BY_VALUE,"ê° íí°"),(0,i.default)(o,s.FILTERS_LABELS_CONJUNCTION,"ê·¸ë¦¬ê³ "),(0,i.default)(o,s.FILTERS_LABELS_DISJUNCTION,"ëë"),(0,i.default)(o,s.FILTERS_BUTTONS_SELECT_ALL,"ì ì²´ì í"),(0,i.default)(o,s.FILTERS_BUTTONS_CLEAR,"ì§ì°ê¸°"),(0,i.default)(o,s.FILTERS_BUTTONS_OK,"íì¸"),(0,i.default)(o,s.FILTERS_BUTTONS_CANCEL,"ì·¨ì"),(0,i.default)(o,s.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"ì°¾ê¸°"),(0,i.default)(o,s.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"ê°"),(0,i.default)(o,s.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"ëë²ì§¸ ê°"),o);a.default.languages.registerLanguageDictionary(l);var u=l;t.default=u}])["___"]});(function(r){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t){t=typeof window!=="undefined"?require("jquery"):require("jquery")(e)}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(j,I,C,V){"use strict";var A=function(D){this.$=function(e,t){return this.api(true).$(e,t)};this._=function(e,t){return this.api(true).rows(e,t).data()};this.api=function(e){return e?new y(ft(this[v.iApiIndex])):new y(this)};this.fnAddData=function(e,t){var r=this.api(true);var n=Array.isArray(e)&&(Array.isArray(e[0])||j.isPlainObject(e[0]))?r.rows.add(e):r.row.add(e);if(t===V||t){r.draw()}return n.flatten().toArray()};this.fnAdjustColumnSizing=function(e){var t=this.api(true).columns.adjust();var r=t.settings()[0];var n=r.oScroll;if(e===V||e){t.draw(false)}else if(n.sX!==""||n.sY!==""){qe(r)}};this.fnClearTable=function(e){var t=this.api(true).clear();if(e===V||e){t.draw()}};this.fnClose=function(e){this.api(true).row(e).child.hide()};this.fnDeleteRow=function(e,t,r){var n=this.api(true);var i=n.rows(e);var a=i.settings()[0];var o=a.aoData[i[0][0]];i.remove();if(t){t.call(this,a,o)}if(r===V||r){n.draw()}return o};this.fnDestroy=function(e){this.api(true).destroy(e)};this.fnDraw=function(e){this.api(true).draw(e)};this.fnFilter=function(e,t,r,n,i,a){var o=this.api(true);if(t===null||t===V){o.search(e,r,n,a)}else{o.column(t).search(e,r,n,a)}o.draw()};this.fnGetData=function(e,t){var r=this.api(true);if(e!==V){var n=e.nodeName?e.nodeName.toLowerCase():"";return t!==V||n=="td"||n=="th"?r.cell(e,t).data():r.row(e).data()||null}return r.data().toArray()};this.fnGetNodes=function(e){var t=this.api(true);return e!==V?t.row(e).node():t.rows().nodes().flatten().toArray()};this.fnGetPosition=function(e){var t=this.api(true);var r=e.nodeName.toUpperCase();if(r=="TR"){return t.row(e).index()}else if(r=="TD"||r=="TH"){var n=t.cell(e).index();return[n.row,n.columnVisible,n.column]}return null};this.fnIsOpen=function(e){return this.api(true).row(e).child.isShown()};this.fnOpen=function(e,t,r){return this.api(true).row(e).child(t,r).show().child()[0]};this.fnPageChange=function(e,t){var r=this.api(true).page(e);if(t===V||t){r.draw(false)}};this.fnSetColumnVis=function(e,t,r){var n=this.api(true).column(e).visible(t);if(r===V||r){n.columns.adjust().draw()}};this.fnSettings=function(){return ft(this[v.iApiIndex])};this.fnSort=function(e){this.api(true).order(e).draw()};this.fnSortListener=function(e,t,r){this.api(true).order.listener(e,t,r)};this.fnUpdate=function(e,t,r,n,i){var a=this.api(true);if(r===V||r===null){a.row(t).data(e)}else{a.cell(t,r).data(e)}if(i===V||i){a.columns.adjust()}if(n===V||n){a.draw()}return 0};this.fnVersionCheck=v.fnVersionCheck;var R=this;var I=D===V;var O=this.length;if(I){D={}}this.oApi=this.internal=v.internal;for(var e in A.ext.internal){if(e){this[e]=Yt(e)}}this.each(function(){var e={};var a=O>1?ht(e,D,true):D;var o=0,s,t,r,n,i;var l=this.getAttribute("id");var u=false;var f=A.defaults;var c=j(this);if(this.nodeName.toLowerCase()!="table"){ct(null,0,"Non-table node initialisation ("+this.nodeName+")",2);return}L(f);P(f.column);N(f,f,true);N(f.column,f.column,true);N(f,j.extend(a,c.data()),true);var d=A.settings;for(o=0,s=d.length;o<s;o++){var h=d[o];if(h.nTable==this||h.nTHead&&h.nTHead.parentNode==this||h.nTFoot&&h.nTFoot.parentNode==this){var v=a.bRetrieve!==V?a.bRetrieve:f.bRetrieve;var p=a.bDestroy!==V?a.bDestroy:f.bDestroy;if(I||v){return h.oInstance}else if(p){h.oInstance.fnDestroy();break}else{ct(h,0,"Cannot reinitialise DataTable",3);return}}if(h.sTableId==this.id){d.splice(o,1);break}}if(l===null||l===""){l="DataTables_Table_"+A.ext._unique++;this.id=l}var g=j.extend(true,{},A.models.oSettings,{sDestroyWidth:c[0].style.width,sInstance:l,sTableId:l});g.nTable=this;g.oApi=R.internal;g.oInit=a;d.push(g);g.oInstance=R.length===1?R:c.dataTable();L(a);M(a.oLanguage);if(a.aLengthMenu&&!a.iDisplayLength){a.iDisplayLength=Array.isArray(a.aLengthMenu[0])?a.aLengthMenu[0][0]:a.aLengthMenu[0]}a=ht(j.extend(true,{},f),a);dt(g.oFeatures,a,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]);dt(g,a,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"]]);dt(g.oScroll,a,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);dt(g.oLanguage,a,"fnInfoCallback");pt(g,"aoDrawCallback",a.fnDrawCallback,"user");pt(g,"aoServerParams",a.fnServerParams,"user");pt(g,"aoStateSaveParams",a.fnStateSaveParams,"user");pt(g,"aoStateLoadParams",a.fnStateLoadParams,"user");pt(g,"aoStateLoaded",a.fnStateLoaded,"user");pt(g,"aoRowCallback",a.fnRowCallback,"user");pt(g,"aoRowCreatedCallback",a.fnCreatedRow,"user");pt(g,"aoHeaderCallback",a.fnHeaderCallback,"user");pt(g,"aoFooterCallback",a.fnFooterCallback,"user");pt(g,"aoInitComplete",a.fnInitComplete,"user");pt(g,"aoPreDrawCallback",a.fnPreDrawCallback,"user");g.rowIdFn=te(a.rowId);F(g);var m=g.oClasses;j.extend(m,A.ext.classes,a.oClasses);c.addClass(m.sTable);if(g.iInitDisplayStart===V){g.iInitDisplayStart=a.iDisplayStart;g._iDisplayStart=a.iDisplayStart}if(a.iDeferLoading!==null){g.bDeferLoading=true;var y=Array.isArray(a.iDeferLoading);g._iRecordsDisplay=y?a.iDeferLoading[0]:a.iDeferLoading;g._iRecordsTotal=y?a.iDeferLoading[1]:a.iDeferLoading}var b=g.oLanguage;j.extend(true,b,a.oLanguage);if(b.sUrl){j.ajax({dataType:"json",url:b.sUrl,success:function(e){M(e);N(f.oLanguage,e);j.extend(true,b,e);gt(g,null,"i18n",[g]);Fe(g)},error:function(){Fe(g)}});u=true}else{gt(g,null,"i18n",[g])}if(a.asStripeClasses===null){g.asStripeClasses=[m.sStripeOdd,m.sStripeEven]}var w=g.asStripeClasses;var C=c.children("tbody").find("tr").eq(0);if(j.inArray(true,j.map(w,function(e,t){return C.hasClass(e)}))!==-1){j("tbody tr",this).removeClass(w.join(" "));g.asDestroyStripes=w.slice()}var S=[];var E;var k=this.getElementsByTagName("thead");if(k.length!==0){pe(g.aoHeader,k[0]);S=ge(g)}if(a.aoColumns===null){E=[];for(o=0,s=S.length;o<s;o++){E.push(null)}}else{E=a.aoColumns}for(o=0,s=E.length;o<s;o++){B(g,S?S[o]:null)}W(g,a.aoColumnDefs,E,function(e,t){H(g,e,t)});if(C.length){var T=function(e,t){return e.getAttribute("data-"+t)!==null?t:null};j(C[0]).children("th, td").each(function(e,t){var r=g.aoColumns[e];if(r.mData===e){var n=T(t,"sort")||T(t,"order");var i=T(t,"filter")||T(t,"search");if(n!==null||i!==null){r.mData={_:e+".display",sort:n!==null?e+".@data-"+n:V,type:n!==null?e+".@data-"+n:V,filter:i!==null?e+".@data-"+i:V};H(g,e)}}})}var _=g.oFeatures;var x=function(){if(a.aaSorting===V){var e=g.aaSorting;for(o=0,s=e.length;o<s;o++){e[o][1]=g.aoColumns[o].asSorting[0]}}ot(g);if(_.bSort){pt(g,"aoDrawCallback",function(){if(g.bSorted){var e=tt(g);var r={};j.each(e,function(e,t){r[t.src]=t.dir});gt(g,null,"order",[g,e,r]);nt(g)}})}pt(g,"aoDrawCallback",function(){if(g.bSorted||bt(g)==="ssp"||_.bDeferRender){ot(g)}},"sc");var t=c.children("caption").each(function(){this._captionSide=j(this).css("caption-side")});var r=c.children("thead");if(r.length===0){r=j("<thead/>").appendTo(c)}g.nTHead=r[0];var n=c.children("tbody");if(n.length===0){n=j("<tbody/>").appendTo(c)}g.nTBody=n[0];var i=c.children("tfoot");if(i.length===0&&t.length>0&&(g.oScroll.sX!==""||g.oScroll.sY!=="")){i=j("<tfoot/>").appendTo(c)}if(i.length===0||i.children().length===0){c.addClass(m.sNoFooter)}else if(i.length>0){g.nTFoot=i[0];pe(g.aoFooter,g.nTFoot)}if(a.aaData){for(o=0;o<a.aaData.length;o++){U(g,a.aaData[o])}}else if(g.bDeferLoading||bt(g)=="dom"){G(g,j(g.nTBody).children("tr"))}g.aiDisplay=g.aiDisplayMaster.slice();g.bInitialised=true;if(u===false){Fe(g)}};if(a.bStateSave){_.bStateSave=true;pt(g,"aoDrawCallback",lt,"state_save");ut(g,a,x)}else{x()}});R=null;return this};var v;var y;var t;var e;var r={};var n=/[\r\n\u2028]/g;var i=/<.*?>/g;var a=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/;var o=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g");var s=/['\u00A0,$Â£â¬Â¥%\u2009\u202F\u20BD\u20a9\u20BArfkÉÎ]/gi;var l=function(e){return!e||e===true||e==="-"?true:false};var h=function(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null};var u=function(e,t){if(!r[t]){r[t]=new RegExp(De(t),"g")}return typeof e==="string"&&t!=="."?e.replace(/\./g,"").replace(r[t],"."):e};var f=function(e,t,r){var n=typeof e==="string";if(l(e)){return true}if(t&&n){e=u(e,t)}if(r&&n){e=e.replace(s,"")}return!isNaN(parseFloat(e))&&isFinite(e)};var c=function(e){return l(e)||typeof e==="string"};var d=function(e,t,r){if(l(e)){return true}var n=c(e);return!n?null:f(b(e),t,r)?true:null};var z=function(e,t,r){var n=[];var i=0,a=e.length;if(r!==V){for(;i<a;i++){if(e[i]&&e[i][t]){n.push(e[i][t][r])}}}else{for(;i<a;i++){if(e[i]){n.push(e[i][t])}}}return n};var g=function(e,t,r,n){var i=[];var a=0,o=t.length;if(n!==V){for(;a<o;a++){if(e[t[a]][r]){i.push(e[t[a]][r][n])}}}else{for(;a<o;a++){i.push(e[t[a]][r])}}return i};var p=function(e,t){var r=[];var n;if(t===V){t=0;n=e}else{n=t;t=e}for(var i=t;i<n;i++){r.push(i)}return r};var m=function(e){var t=[];for(var r=0,n=e.length;r<n;r++){if(e[r]){t.push(e[r])}}return t};var b=function(e){return e.replace(i,"")};var w=function(e){if(e.length<2){return true}var t=e.slice().sort();var r=t[0];for(var n=1,i=t.length;n<i;n++){if(t[n]===r){return false}r=t[n]}return true};var S=function(e){if(w(e)){return e.slice()}var t=[],r,n,i=e.length,a,o=0;e:for(n=0;n<i;n++){r=e[n];for(a=0;a<o;a++){if(t[a]===r){continue e}}t.push(r);o++}return t};var E=function(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++){E(e,t[r])}}else{e.push(t)}return e};if(!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}A.util={throttle:function(n,e){var i=e!==V?e:200,a,o;return function(){var e=this,t=+new Date,r=arguments;if(a&&t<a+i){clearTimeout(o);o=setTimeout(function(){a=V;n.apply(e,r)},i)}else{a=t;n.apply(e,r)}}},escapeRegex:function(e){return e.replace(o,"\\$1")}};function k(r){var n="a aa ai ao as b fn i m o s ",i,a,o={};j.each(r,function(e,t){i=e.match(/^([^A-Z]+?)([A-Z])/);if(i&&n.indexOf(i[1]+" ")!==-1){a=e.replace(i[0],i[2].toLowerCase());o[a]=e;if(i[1]==="o"){k(r[e])}}});r._hungarianMap=o}function N(r,n,i){if(!r._hungarianMap){k(r)}var a;j.each(n,function(e,t){a=r._hungarianMap[e];if(a!==V&&(i||n[a]===V)){if(a.charAt(0)==="o"){if(!n[a]){n[a]={}}j.extend(true,n[a],n[e]);N(r[a],n[a],i)}else{n[a]=n[e]}}})}function M(e){var t=A.defaults.oLanguage;var r=t.sDecimal;if(r){zt(r)}if(e){var n=e.sZeroRecords;if(!e.sEmptyTable&&n&&t.sEmptyTable==="No data available in table"){dt(e,e,"sZeroRecords","sEmptyTable")}if(!e.sLoadingRecords&&n&&t.sLoadingRecords==="Loading..."){dt(e,e,"sZeroRecords","sLoadingRecords")}if(e.sInfoThousands){e.sThousands=e.sInfoThousands}var i=e.sDecimal;if(i&&r!==i){zt(i)}}}var T=function(e,t,r){if(e[t]!==V){e[r]=e[t]}};function L(e){T(e,"ordering","bSort");T(e,"orderMulti","bSortMulti");T(e,"orderClasses","bSortClasses");T(e,"orderCellsTop","bSortCellsTop");T(e,"order","aaSorting");T(e,"orderFixed","aaSortingFixed");T(e,"paging","bPaginate");T(e,"pagingType","sPaginationType");T(e,"pageLength","iDisplayLength");T(e,"searching","bFilter");if(typeof e.sScrollX==="boolean"){e.sScrollX=e.sScrollX?"100%":""}if(typeof e.scrollX==="boolean"){e.scrollX=e.scrollX?"100%":""}var t=e.aoSearchCols;if(t){for(var r=0,n=t.length;r<n;r++){if(t[r]){N(A.models.oSearch,t[r])}}}}function P(e){T(e,"orderable","bSortable");T(e,"orderData","aDataSort");T(e,"orderSequence","asSorting");T(e,"orderDataType","sortDataType");var t=e.aDataSort;if(typeof t==="number"&&!Array.isArray(t)){e.aDataSort=[t]}}function F(e){if(!A.__browser){var t={};A.__browser=t;var r=j("<div/>").css({position:"fixed",top:0,left:j(I).scrollLeft()*-1,height:1,width:1,overflow:"hidden"}).append(j("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(j("<div/>").css({width:"100%",height:10}))).appendTo("body");var n=r.children();var i=n.children();t.barWidth=n[0].offsetWidth-n[0].clientWidth;t.bScrollOversize=i[0].offsetWidth===100&&n[0].clientWidth!==100;t.bScrollbarLeft=Math.round(i.offset().left)!==1;t.bBounding=r[0].getBoundingClientRect().width?true:false;r.remove()}j.extend(e.oBrowser,A.__browser);e.oScroll.iBarWidth=A.__browser.barWidth}function _(e,t,r,n,i,a){var o=n,s,l=false;if(r!==V){s=r;l=true}while(o!==i){if(!e.hasOwnProperty(o)){continue}s=l?t(s,e[o],o,e):e[o];l=true;o+=a}return s}function B(e,t){var r=A.defaults.column;var n=e.aoColumns.length;var i=j.extend({},A.models.oColumn,r,{nTh:t?t:C.createElement("th"),sTitle:r.sTitle?r.sTitle:t?t.innerHTML:"",aDataSort:r.aDataSort?r.aDataSort:[n],mData:r.mData?r.mData:n,idx:n});e.aoColumns.push(i);var a=e.aoPreSearchCols;a[n]=j.extend({},A.models.oSearch,a[n]);H(e,n,j(t).data())}function H(e,t,r){var n=e.aoColumns[t];var i=e.oClasses;var a=j(n.nTh);if(!n.sWidthOrig){n.sWidthOrig=a.attr("width")||null;var o=(a.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);if(o){n.sWidthOrig=o[1]}}if(r!==V&&r!==null){P(r);N(A.defaults.column,r,true);if(r.mDataProp!==V&&!r.mData){r.mData=r.mDataProp}if(r.sType){n._sManualType=r.sType}if(r.className&&!r.sClass){r.sClass=r.className}if(r.sClass){a.addClass(r.sClass)}j.extend(n,r);dt(n,r,"sWidth","sWidthOrig");if(r.iDataSort!==V){n.aDataSort=[r.iDataSort]}dt(n,r,"aDataSort")}var s=n.mData;var l=te(s);var u=n.mRender?te(n.mRender):null;var f=function(e){return typeof e==="string"&&e.indexOf("@")!==-1};n._bAttrSrc=j.isPlainObject(s)&&(f(s.sort)||f(s.type)||f(s.filter));n._setter=null;n.fnGetData=function(e,t,r){var n=l(e,t,V,r);return u&&t?u(n,t,e,r):n};n.fnSetData=function(e,t,r){return re(s)(e,t,r)};if(typeof s!=="number"){e._rowReadObject=true}if(!e.oFeatures.bSort){n.bSortable=false;a.addClass(i.sSortableNone)}var c=j.inArray("asc",n.asSorting)!==-1;var d=j.inArray("desc",n.asSorting)!==-1;if(!n.bSortable||!c&&!d){n.sSortingClass=i.sSortableNone;n.sSortingClassJUI=""}else if(c&&!d){n.sSortingClass=i.sSortableAsc;n.sSortingClassJUI=i.sSortJUIAscAllowed}else if(!c&&d){n.sSortingClass=i.sSortableDesc;n.sSortingClassJUI=i.sSortJUIDescAllowed}else{n.sSortingClass=i.sSortable;n.sSortingClassJUI=i.sSortJUI}}function q(e){if(e.oFeatures.bAutoWidth!==false){var t=e.aoColumns;Xe(e);for(var r=0,n=t.length;r<n;r++){t[r].nTh.style.width=t[r].sWidth}}var i=e.oScroll;if(i.sY!==""||i.sX!==""){qe(e)}gt(e,null,"column-sizing",[e])}function Y(e,t){var r=$(e,"bVisible");return typeof r[t]==="number"?r[t]:null}function x(e,t){var r=$(e,"bVisible");var n=j.inArray(t,r);return n!==-1?n:null}function O(e){var r=0;j.each(e.aoColumns,function(e,t){if(t.bVisible&&j(t.nTh).css("display")!=="none"){r++}});return r}function $(e,r){var n=[];j.map(e.aoColumns,function(e,t){if(e[r]){n.push(t)}});return n}function D(e){var t=e.aoColumns;var r=e.aoData;var n=A.ext.type.detect;var i,a,o,s,l,u;var f,c,d,h;for(i=0,a=t.length;i<a;i++){f=t[i];h=[];if(!f.sType&&f._sManualType){f.sType=f._sManualType}else if(!f.sType){for(o=0,s=n.length;o<s;o++){for(l=0,u=r.length;l<u;l++){if(h[l]===V){h[l]=K(e,l,i,"type")}d=n[o](h[l],e);if(!d&&o!==n.length-1){break}if(d==="html"){break}}if(d){f.sType=d;break}}if(!f.sType){f.sType="string"}}}}function W(e,t,r,n){var i,a,o,s,l,u,f;var c=e.aoColumns;if(t){for(i=t.length-1;i>=0;i--){f=t[i];var d=f.targets!==V?f.targets:f.aTargets;if(!Array.isArray(d)){d=[d]}for(o=0,s=d.length;o<s;o++){if(typeof d[o]==="number"&&d[o]>=0){while(c.length<=d[o]){B(e)}n(d[o],f)}else if(typeof d[o]==="number"&&d[o]<0){n(c.length+d[o],f)}else if(typeof d[o]==="string"){for(l=0,u=c.length;l<u;l++){if(d[o]=="_all"||j(c[l].nTh).hasClass(d[o])){n(l,f)}}}}}}if(r){for(i=0,a=r.length;i<a;i++){n(i,r[i])}}}function U(e,t,r,n){var i=e.aoData.length;var a=j.extend(true,{},A.models.oRow,{src:r?"dom":"data",idx:i});a._aData=t;e.aoData.push(a);var o,s;var l=e.aoColumns;for(var u=0,f=l.length;u<f;u++){l[u].sType=null}e.aiDisplayMaster.push(i);var c=e.rowIdFn(t);if(c!==V){e.aIds[c]=a}if(r||!e.oFeatures.bDeferRender){le(e,i,r,n)}return i}function G(r,e){var n;if(!(e instanceof j)){e=j(e)}return e.map(function(e,t){n=se(r,t);return U(r,n.data,t,n.cells)})}function R(e,t){return t._DT_RowIndex!==V?t._DT_RowIndex:null}function X(e,t,r){return j.inArray(r,e.aoData[t].anCells)}function K(e,t,r,n){var i=e.iDraw;var a=e.aoColumns[r];var o=e.aoData[t]._aData;var s=a.sDefaultContent;var l=a.fnGetData(o,n,{settings:e,row:t,col:r});if(l===V){if(e.iDrawError!=i&&s===null){ct(e,0,"Requested unknown parameter "+(typeof a.mData=="function"?"{function}":"'"+a.mData+"'")+" for row "+t+", column "+r,4);e.iDrawError=i}return s}if((l===o||l===null)&&s!==null&&n!==V){l=s}else if(typeof l==="function"){return l.call(o)}if(l===null&&n=="display"){return""}return l}function J(e,t,r,n){var i=e.aoColumns[r];var a=e.aoData[t]._aData;i.fnSetData(a,n,{settings:e,row:t,col:r})}var Q=/\[.*?\]$/;var Z=/\(\)$/;function ee(e){return j.map(e.match(/(\\.|[^\.])+/g)||[""],function(e){return e.replace(/\\\./g,".")})}function te(i){if(j.isPlainObject(i)){var a={};j.each(i,function(e,t){if(t){a[e]=te(t)}});return function(e,t,r,n){var i=a[t]||a._;return i!==V?i(e,t,r,n):e}}else if(i===null){return function(e){return e}}else if(typeof i==="function"){return function(e,t,r,n){return i(e,t,r,n)}}else if(typeof i==="string"&&(i.indexOf(".")!==-1||i.indexOf("[")!==-1||i.indexOf("(")!==-1)){var h=function(e,t,r){var n,i,a,o;if(r!==""){var s=ee(r);for(var l=0,u=s.length;l<u;l++){n=s[l].match(Q);i=s[l].match(Z);if(n){s[l]=s[l].replace(Q,"");if(s[l]!==""){e=e[s[l]]}a=[];s.splice(0,l+1);o=s.join(".");if(Array.isArray(e)){for(var f=0,c=e.length;f<c;f++){a.push(h(e[f],t,o))}}var d=n[0].substring(1,n[0].length-1);e=d===""?a:a.join(d);break}else if(i){s[l]=s[l].replace(Z,"");e=e[s[l]]();continue}if(e===null||e[s[l]]===V){return V}e=e[s[l]]}}return e};return function(e,t){return h(e,t,i)}}else{return function(e,t){return e[i]}}}function re(n){if(j.isPlainObject(n)){return re(n._)}else if(n===null){return function(){}}else if(typeof n==="function"){return function(e,t,r){n(e,"set",t,r)}}else if(typeof n==="string"&&(n.indexOf(".")!==-1||n.indexOf("[")!==-1||n.indexOf("(")!==-1)){var v=function(e,t,r){var n=ee(r),i;var a=n[n.length-1];var o,s,l,u;for(var f=0,c=n.length-1;f<c;f++){if(n[f]==="__proto__"||n[f]==="constructor"){throw new Error("Cannot set prototype values")}o=n[f].match(Q);s=n[f].match(Z);if(o){n[f]=n[f].replace(Q,"");e[n[f]]=[];i=n.slice();i.splice(0,f+1);u=i.join(".");if(Array.isArray(t)){for(var d=0,h=t.length;d<h;d++){l={};v(l,t[d],u);e[n[f]].push(l)}}else{e[n[f]]=t}return}else if(s){n[f]=n[f].replace(Z,"");e=e[n[f]](t)}if(e[n[f]]===null||e[n[f]]===V){e[n[f]]={}}e=e[n[f]]}if(a.match(Z)){e=e[a.replace(Z,"")](t)}else{e[a.replace(Q,"")]=t}};return function(e,t){return v(e,t,n)}}else{return function(e,t){e[n]=t}}}function ne(e){return z(e.aoData,"_aData")}function ie(e){e.aoData.length=0;e.aiDisplayMaster.length=0;e.aiDisplay.length=0;e.aIds={}}function ae(e,t,r){var n=-1;for(var i=0,a=e.length;i<a;i++){if(e[i]==t){n=i}else if(e[i]>t){e[i]--}}if(n!=-1&&r===V){e.splice(n,1)}}function oe(r,n,e,t){var i=r.aoData[n];var a,o;var s=function(e,t){while(e.childNodes.length){e.removeChild(e.firstChild)}e.innerHTML=K(r,n,t,"display")};if(e==="dom"||(!e||e==="auto")&&i.src==="dom"){i._aData=se(r,i,t,t===V?V:i._aData).data}else{var l=i.anCells;if(l){if(t!==V){s(l[t],t)}else{for(a=0,o=l.length;a<o;a++){s(l[a],a)}}}}i._aSortData=null;i._aFilterData=null;var u=r.aoColumns;if(t!==V){u[t].sType=null}else{for(a=0,o=u.length;a<o;a++){u[a].sType=null}ue(r,i)}}function se(e,t,r,a){var n=[],i=t.firstChild,o,s,l,u=0,f,c=e.aoColumns,d=e._rowReadObject;a=a!==V?a:d?{}:[];var h=function(e,t){if(typeof e==="string"){var r=e.indexOf("@");if(r!==-1){var n=e.substring(r+1);var i=re(e);i(a,t.getAttribute(n))}}};var v=function(e){if(r===V||r===u){s=c[u];f=e.innerHTML.trim();if(s&&s._bAttrSrc){var t=re(s.mData._);t(a,f);h(s.mData.sort,e);h(s.mData.type,e);h(s.mData.filter,e)}else{if(d){if(!s._setter){s._setter=re(s.mData)}s._setter(a,f)}else{a[u]=f}}}u++};if(i){while(i){o=i.nodeName.toUpperCase();if(o=="TD"||o=="TH"){v(i);n.push(i)}i=i.nextSibling}}else{n=t.anCells;for(var p=0,g=n.length;p<g;p++){v(n[p])}}var m=t.firstChild?t:t.nTr;if(m){var y=m.getAttribute("id");if(y){re(e.rowId)(a,y)}}return{data:a,cells:n}}function le(e,t,r,n){var i=e.aoData[t],a=i._aData,o=[],s,l,u,f,c,d;if(i.nTr===null){s=r||C.createElement("tr");i.nTr=s;i.anCells=o;s._DT_RowIndex=t;ue(e,i);for(f=0,c=e.aoColumns.length;f<c;f++){u=e.aoColumns[f];d=r?false:true;l=d?C.createElement(u.sCellType):n[f];l._DT_CellIndex={row:t,column:f};o.push(l);if(d||(u.mRender||u.mData!==f)&&(!j.isPlainObject(u.mData)||u.mData._!==f+".display")){l.innerHTML=K(e,t,f,"display")}if(u.sClass){l.className+=" "+u.sClass}if(u.bVisible&&!r){s.appendChild(l)}else if(!u.bVisible&&r){l.parentNode.removeChild(l)}if(u.fnCreatedCell){u.fnCreatedCell.call(e.oInstance,l,K(e,t,f),a,t,f)}}gt(e,"aoRowCreatedCallback",null,[s,a,t,o])}}function ue(e,t){var r=t.nTr;var n=t._aData;if(r){var i=e.rowIdFn(n);if(i){r.id=i}if(n.DT_RowClass){var a=n.DT_RowClass.split(" ");t.__rowc=t.__rowc?S(t.__rowc.concat(a)):a;j(r).removeClass(t.__rowc.join(" ")).addClass(n.DT_RowClass)}if(n.DT_RowAttr){j(r).attr(n.DT_RowAttr)}if(n.DT_RowData){j(r).data(n.DT_RowData)}}}function fe(e){var t,r,n,i,a;var o=e.nTHead;var s=e.nTFoot;var l=j("th, td",o).length===0;var u=e.oClasses;var f=e.aoColumns;if(l){i=j("<tr/>").appendTo(o)}for(t=0,r=f.length;t<r;t++){a=f[t];n=j(a.nTh).addClass(a.sClass);if(l){n.appendTo(i)}if(e.oFeatures.bSort){n.addClass(a.sSortingClass);if(a.bSortable!==false){n.attr("tabindex",e.iTabIndex).attr("aria-controls",e.sTableId);at(e,a.nTh,t)}}if(a.sTitle!=n[0].innerHTML){n.html(a.sTitle)}yt(e,"header")(e,n,a,u)}if(l){pe(e.aoHeader,o)}j(o).children("tr").attr("role","row");j(o).children("tr").children("th, td").addClass(u.sHeaderTH);j(s).children("tr").children("th, td").addClass(u.sFooterTH);if(s!==null){var c=e.aoFooter[0];for(t=0,r=c.length;t<r;t++){a=f[t];a.nTf=c[t].cell;if(a.sClass){j(a.nTf).addClass(a.sClass)}}}}function ce(e,t,r){var n,i,a,o,s,l,u,f;var c=[];var d=[];var h=e.aoColumns.length;var v,p;if(!t){return}if(r===V){r=false}for(n=0,i=t.length;n<i;n++){c[n]=t[n].slice();c[n].nTr=t[n].nTr;for(a=h-1;a>=0;a--){if(!e.aoColumns[a].bVisible&&!r){c[n].splice(a,1)}}d.push([])}for(n=0,i=c.length;n<i;n++){f=c[n].nTr;if(f){while(u=f.firstChild){f.removeChild(u)}}for(a=0,o=c[n].length;a<o;a++){v=1;p=1;if(d[n][a]===V){f.appendChild(c[n][a].cell);d[n][a]=1;while(c[n+v]!==V&&c[n][a].cell==c[n+v][a].cell){d[n+v][a]=1;v++}while(c[n][a+p]!==V&&c[n][a].cell==c[n][a+p].cell){for(s=0;s<v;s++){d[n+s][a+p]=1}p++}j(c[n][a].cell).attr("rowspan",v).attr("colspan",p)}}}}function de(e){var t=gt(e,"aoPreDrawCallback","preDraw",[e]);if(j.inArray(false,t)!==-1){Ve(e,false);return}var r,n,i;var a=[];var o=0;var s=e.asStripeClasses;var l=s.length;var u=e.aoOpenRows.length;var f=e.oLanguage;var c=e.iInitDisplayStart;var d=bt(e)=="ssp";var h=e.aiDisplay;e.bDrawing=true;if(c!==V&&c!==-1){e._iDisplayStart=d?c:c>=e.fnRecordsDisplay()?0:c;e.iInitDisplayStart=-1}var v=e._iDisplayStart;var p=e.fnDisplayEnd();if(e.bDeferLoading){e.bDeferLoading=false;e.iDraw++;Ve(e,false)}else if(!d){e.iDraw++}else if(!e.bDestroying&&!ye(e)){return}if(h.length!==0){var g=d?0:v;var m=d?e.aoData.length:p;for(var y=g;y<m;y++){var b=h[y];var w=e.aoData[b];if(w.nTr===null){le(e,b)}var C=w.nTr;if(l!==0){var S=s[o%l];if(w._sRowStripe!=S){j(C).removeClass(w._sRowStripe).addClass(S);w._sRowStripe=S}}gt(e,"aoRowCallback",null,[C,w._aData,o,y,b]);a.push(C);o++}}else{var E=f.sZeroRecords;if(e.iDraw==1&&bt(e)=="ajax"){E=f.sLoadingRecords}else if(f.sEmptyTable&&e.fnRecordsTotal()===0){E=f.sEmptyTable}a[0]=j("<tr/>",{class:l?s[0]:""}).append(j("<td />",{valign:"top",colSpan:O(e),class:e.oClasses.sRowEmpty}).html(E))[0]}gt(e,"aoHeaderCallback","header",[j(e.nTHead).children("tr")[0],ne(e),v,p,h]);gt(e,"aoFooterCallback","footer",[j(e.nTFoot).children("tr")[0],ne(e),v,p,h]);var k=j(e.nTBody);k.children().detach();k.append(j(a));gt(e,"aoDrawCallback","draw",[e]);e.bSorted=false;e.bFiltered=false;e.bDrawing=false}function he(e,t){var r=e.oFeatures,n=r.bSort,i=r.bFilter;if(n){rt(e)}if(i){Ee(e,e.oPreviousSearch)}else{e.aiDisplay=e.aiDisplayMaster.slice()}if(t!==true){e._iDisplayStart=0}e._drawHold=t;de(e);e._drawHold=false}function ve(e){var t=e.oClasses;var r=j(e.nTable);var n=j("<div/>").insertBefore(r);var i=e.oFeatures;var a=j("<div/>",{id:e.sTableId+"_wrapper",class:t.sWrapper+(e.nTFoot?"":" "+t.sNoFooter)});e.nHolding=n[0];e.nTableWrapper=a[0];e.nTableReinsertBefore=e.nTable.nextSibling;var o=e.sDom.split("");var s,l,u,f,c,d;for(var h=0;h<o.length;h++){s=null;l=o[h];if(l=="<"){u=j("<div/>")[0];f=o[h+1];if(f=="'"||f=='"'){c="";d=2;while(o[h+d]!=f){c+=o[h+d];d++}if(c=="H"){c=t.sJUIHeader}else if(c=="F"){c=t.sJUIFooter}if(c.indexOf(".")!=-1){var v=c.split(".");u.id=v[0].substr(1,v[0].length-1);u.className=v[1]}else if(c.charAt(0)=="#"){u.id=c.substr(1,c.length-1)}else{u.className=c}h+=d}a.append(u);a=j(u)}else if(l==">"){a=a.parent()}else if(l=="l"&&i.bPaginate&&i.bLengthChange){s=$e(e)}else if(l=="f"&&i.bFilter){s=Se(e)}else if(l=="r"&&i.bProcessing){s=je(e)}else if(l=="t"){s=ze(e)}else if(l=="i"&&i.bInfo){s=Me(e)}else if(l=="p"&&i.bPaginate){s=We(e)}else if(A.ext.feature.length!==0){var p=A.ext.feature;for(var g=0,m=p.length;g<m;g++){if(l==p[g].cFeature){s=p[g].fnInit(e);break}}}if(s){var y=e.aanFeatures;if(!y[l]){y[l]=[]}y[l].push(s);a.append(s)}}n.replaceWith(a);e.nHolding=null}function pe(e,t){var r=j(t).children("tr");var n,i;var a,o,s,l,u,f,c,d,h;var v;var p=function(e,t,r){var n=e[t];while(n[r]){r++}return r};e.splice(0,e.length);for(a=0,l=r.length;a<l;a++){e.push([])}for(a=0,l=r.length;a<l;a++){n=r[a];c=0;i=n.firstChild;while(i){if(i.nodeName.toUpperCase()=="TD"||i.nodeName.toUpperCase()=="TH"){d=i.getAttribute("colspan")*1;h=i.getAttribute("rowspan")*1;d=!d||d===0||d===1?1:d;h=!h||h===0||h===1?1:h;f=p(e,a,c);v=d===1?true:false;for(s=0;s<d;s++){for(o=0;o<h;o++){e[a+o][f+s]={cell:i,unique:v};e[a+o].nTr=n}}}i=i.nextSibling}}}function ge(e,t,r){var n=[];if(!r){r=e.aoHeader;if(t){r=[];pe(r,t)}}for(var i=0,a=r.length;i<a;i++){for(var o=0,s=r[i].length;o<s;o++){if(r[i][o].unique&&(!n[o]||!e.bSortCellsTop)){n[o]=r[i][o].cell}}}return n}function me(i,e,t){gt(i,"aoServerParams","serverParams",[e]);if(e&&Array.isArray(e)){var a={};var o=/(.*?)\[\]$/;j.each(e,function(e,t){var r=t.name.match(o);if(r){var n=r[0];if(!a[n]){a[n]=[]}a[n].push(t.value)}else{a[t.name]=t.value}});e=a}var r;var n=i.ajax;var s=i.oInstance;var l=function(e){gt(i,null,"xhr",[i,e,i.jqXHR]);t(e)};if(j.isPlainObject(n)&&n.data){r=n.data;var u=typeof r==="function"?r(e,i):r;e=typeof r==="function"&&u?u:j.extend(true,e,u);delete n.data}var f={data:e,success:function(e){var t=e.error||e.sError;if(t){ct(i,0,t)}i.json=e;l(e)},dataType:"json",cache:false,type:i.sServerMethod,error:function(e,t,r){var n=gt(i,null,"xhr",[i,null,i.jqXHR]);if(j.inArray(true,n)===-1){if(t=="parsererror"){ct(i,0,"Invalid JSON response",1)}else if(e.readyState===4){ct(i,0,"Ajax error",7)}}Ve(i,false)}};i.oAjaxData=e;gt(i,null,"preXhr",[i,e]);if(i.fnServerData){i.fnServerData.call(s,i.sAjaxSource,j.map(e,function(e,t){return{name:t,value:e}}),l,i)}else if(i.sAjaxSource||typeof n==="string"){i.jqXHR=j.ajax(j.extend(f,{url:n||i.sAjaxSource}))}else if(typeof n==="function"){i.jqXHR=n.call(s,e,l,i)}else{i.jqXHR=j.ajax(j.extend(f,n));n.data=r}}function ye(t){if(t.bAjaxDataGet){t.iDraw++;Ve(t,true);me(t,be(t),function(e){we(t,e)});return false}return true}function be(e){var t=e.aoColumns,r=t.length,n=e.oFeatures,i=e.oPreviousSearch,a=e.aoPreSearchCols,o,s=[],l,u,f,c=tt(e),d=e._iDisplayStart,h=n.bPaginate!==false?e._iDisplayLength:-1;var v=function(e,t){s.push({name:e,value:t})};v("sEcho",e.iDraw);v("iColumns",r);v("sColumns",z(t,"sName").join(","));v("iDisplayStart",d);v("iDisplayLength",h);var p={draw:e.iDraw,columns:[],order:[],start:d,length:h,search:{value:i.sSearch,regex:i.bRegex}};for(o=0;o<r;o++){u=t[o];f=a[o];l=typeof u.mData=="function"?"function":u.mData;p.columns.push({data:l,name:u.sName,searchable:u.bSearchable,orderable:u.bSortable,search:{value:f.sSearch,regex:f.bRegex}});v("mDataProp_"+o,l);if(n.bFilter){v("sSearch_"+o,f.sSearch);v("bRegex_"+o,f.bRegex);v("bSearchable_"+o,u.bSearchable)}if(n.bSort){v("bSortable_"+o,u.bSortable)}}if(n.bFilter){v("sSearch",i.sSearch);v("bRegex",i.bRegex)}if(n.bSort){j.each(c,function(e,t){p.order.push({column:t.col,dir:t.dir});v("iSortCol_"+e,t.col);v("sSortDir_"+e,t.dir)});v("iSortingCols",c.length)}var g=A.ext.legacy.ajax;if(g===null){return e.sAjaxSource?s:p}return g?s:p}function we(e,r){var t=function(e,t){return r[e]!==V?r[e]:r[t]};var n=Ce(e,r);var i=t("sEcho","draw");var a=t("iTotalRecords","recordsTotal");var o=t("iTotalDisplayRecords","recordsFiltered");if(i!==V){if(i*1<e.iDraw){return}e.iDraw=i*1}ie(e);e._iRecordsTotal=parseInt(a,10);e._iRecordsDisplay=parseInt(o,10);for(var s=0,l=n.length;s<l;s++){U(e,n[s])}e.aiDisplay=e.aiDisplayMaster.slice();e.bAjaxDataGet=false;de(e);if(!e._bInitComplete){Be(e,r)}e.bAjaxDataGet=true;Ve(e,false)}function Ce(e,t){var r=j.isPlainObject(e.ajax)&&e.ajax.dataSrc!==V?e.ajax.dataSrc:e.sAjaxDataProp;if(r==="data"){return t.aaData||t[r]}return r!==""?te(r)(t):t}function Se(r){var e=r.oClasses;var t=r.sTableId;var n=r.oLanguage;var i=r.oPreviousSearch;var a=r.aanFeatures;var o='<input type="search" class="'+e.sFilterInput+'"/>';var s=n.sSearch;s=s.match(/_INPUT_/)?s.replace("_INPUT_",o):s+o;var l=j("<div/>",{id:!a.f?t+"_filter":null,class:e.sFilter}).append(j("<label/>").append(s));var u=function(){var e=a.f;var t=!this.value?"":this.value;if(t!=i.sSearch){Ee(r,{sSearch:t,bRegex:i.bRegex,bSmart:i.bSmart,bCaseInsensitive:i.bCaseInsensitive});r._iDisplayStart=0;de(r)}};var f=r.searchDelay!==null?r.searchDelay:bt(r)==="ssp"?400:0;var c=j("input",l).val(i.sSearch).attr("placeholder",n.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",f?Ke(u,f):u).on("mouseup",function(e){setTimeout(function(){u.call(c[0])},10)}).on("keypress.DT",function(e){if(e.keyCode==13){return false}}).attr("aria-controls",t);j(r.nTable).on("search.dt.DT",function(e,t){if(r===t){try{if(c[0]!==C.activeElement){c.val(i.sSearch)}}catch(e){}}});return l[0]}function Ee(e,t,r){var n=e.oPreviousSearch;var i=e.aoPreSearchCols;var a=function(e){n.sSearch=e.sSearch;n.bRegex=e.bRegex;n.bSmart=e.bSmart;n.bCaseInsensitive=e.bCaseInsensitive};var o=function(e){return e.bEscapeRegex!==V?!e.bEscapeRegex:e.bRegex};D(e);if(bt(e)!="ssp"){_e(e,t.sSearch,r,o(t),t.bSmart,t.bCaseInsensitive);a(t);for(var s=0;s<i.length;s++){Te(e,i[s].sSearch,s,o(i[s]),i[s].bSmart,i[s].bCaseInsensitive)}ke(e)}else{a(t)}e.bFiltered=true;gt(e,null,"search",[e])}function ke(e){var t=A.ext.search;var r=e.aiDisplay;var n,i;for(var a=0,o=t.length;a<o;a++){var s=[];for(var l=0,u=r.length;l<u;l++){i=r[l];n=e.aoData[i];if(t[a](e,n._aFilterData,i,n._aData,l)){s.push(i)}}r.length=0;j.merge(r,s)}}function Te(e,t,r,n,i,a){if(t===""){return}var o;var s=[];var l=e.aiDisplay;var u=xe(t,n,i,a);for(var f=0;f<l.length;f++){o=e.aoData[l[f]]._aFilterData[r];if(u.test(o)){s.push(l[f])}}e.aiDisplay=s}function _e(e,t,r,n,i,a){var o=xe(t,n,i,a);var s=e.oPreviousSearch.sSearch;var l=e.aiDisplayMaster;var u,f,c;var d=[];if(A.ext.search.length!==0){r=true}f=Oe(e);if(t.length<=0){e.aiDisplay=l.slice()}else{if(f||r||n||s.length>t.length||t.indexOf(s)!==0||e.bSorted){e.aiDisplay=l.slice()}u=e.aiDisplay;for(c=0;c<u.length;c++){if(o.test(e.aoData[u[c]]._sFilterRow)){d.push(u[c])}}e.aiDisplay=d}}function xe(e,t,r,n){e=t?e:De(e);if(r){var i=j.map(e.match(/"[^"]+"|[^ ]+/g)||[""],function(e){if(e.charAt(0)==='"'){var t=e.match(/^"(.*)"$/);e=t?t[1]:e}return e.replace('"',"")});e="^(?=.*?"+i.join(")(?=.*?")+").*$"}return new RegExp(e,n?"i":"")}var De=A.util.escapeRegex;var Re=j("<div>")[0];var Ie=Re.textContent!==V;function Oe(e){var t=e.aoColumns;var r;var n,i,a,o,s,l,u;var f=A.ext.type.search;var c=false;for(n=0,a=e.aoData.length;n<a;n++){u=e.aoData[n];if(!u._aFilterData){s=[];for(i=0,o=t.length;i<o;i++){r=t[i];if(r.bSearchable){l=K(e,n,i,"filter");if(f[r.sType]){l=f[r.sType](l)}if(l===null){l=""}if(typeof l!=="string"&&l.toString){l=l.toString()}}else{l=""}if(l.indexOf&&l.indexOf("&")!==-1){Re.innerHTML=l;l=Ie?Re.textContent:Re.innerText}if(l.replace){l=l.replace(/[\r\n\u2028]/g,"")}s.push(l)}u._aFilterData=s;u._sFilterRow=s.join("  ");c=true}}return c}function Ae(e){return{search:e.sSearch,smart:e.bSmart,regex:e.bRegex,caseInsensitive:e.bCaseInsensitive}}function Ne(e){return{sSearch:e.search,bSmart:e.smart,bRegex:e.regex,bCaseInsensitive:e.caseInsensitive}}function Me(e){var t=e.sTableId,r=e.aanFeatures.i,n=j("<div/>",{class:e.oClasses.sInfo,id:!r?t+"_info":null});if(!r){e.aoDrawCallback.push({fn:Le,sName:"information"});n.attr("role","status").attr("aria-live","polite");j(e.nTable).attr("aria-describedby",t+"_info")}return n[0]}function Le(e){var t=e.aanFeatures.i;if(t.length===0){return}var r=e.oLanguage,n=e._iDisplayStart+1,i=e.fnDisplayEnd(),a=e.fnRecordsTotal(),o=e.fnRecordsDisplay(),s=o?r.sInfo:r.sInfoEmpty;if(o!==a){s+=" "+r.sInfoFiltered}s+=r.sInfoPostFix;s=Pe(e,s);var l=r.fnInfoCallback;if(l!==null){s=l.call(e.oInstance,e,n,i,a,o,s)}j(t).html(s)}function Pe(e,t){var r=e.fnFormatNumber,n=e._iDisplayStart+1,i=e._iDisplayLength,a=e.fnRecordsDisplay(),o=i===-1;return t.replace(/_START_/g,r.call(e,n)).replace(/_END_/g,r.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,r.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,r.call(e,a)).replace(/_PAGE_/g,r.call(e,o?1:Math.ceil(n/i))).replace(/_PAGES_/g,r.call(e,o?1:Math.ceil(a/i)))}function Fe(r){var n,e,i=r.iInitDisplayStart;var t=r.aoColumns,a;var o=r.oFeatures;var s=r.bDeferLoading;if(!r.bInitialised){setTimeout(function(){Fe(r)},200);return}ve(r);fe(r);ce(r,r.aoHeader);ce(r,r.aoFooter);Ve(r,true);if(o.bAutoWidth){Xe(r)}for(n=0,e=t.length;n<e;n++){a=t[n];if(a.sWidth){a.nTh.style.width=et(a.sWidth)}}gt(r,null,"preInit",[r]);he(r);var l=bt(r);if(l!="ssp"||s){if(l=="ajax"){me(r,[],function(e){var t=Ce(r,e);for(n=0;n<t.length;n++){U(r,t[n])}r.iInitDisplayStart=i;he(r);Ve(r,false);Be(r,e)},r)}else{Ve(r,false);Be(r)}}}function Be(e,t){e._bInitComplete=true;if(t||e.oInit.aaData){q(e)}gt(e,null,"plugin-init",[e,t]);gt(e,"aoInitComplete","init",[e,t])}function He(e,t){var r=parseInt(t,10);e._iDisplayLength=r;mt(e);gt(e,null,"length",[e,r])}function $e(n){var e=n.oClasses,t=n.sTableId,r=n.aLengthMenu,i=Array.isArray(r[0]),a=i?r[0]:r,o=i?r[1]:r;var s=j("<select/>",{name:t+"_length","aria-controls":t,class:e.sLengthSelect});for(var l=0,u=a.length;l<u;l++){s[0][l]=new Option(typeof o[l]==="number"?n.fnFormatNumber(o[l]):o[l],a[l])}var f=j("<div><label/></div>").addClass(e.sLength);if(!n.aanFeatures.l){f[0].id=t+"_length"}f.children().append(n.oLanguage.sLengthMenu.replace("_MENU_",s[0].outerHTML));j("select",f).val(n._iDisplayLength).on("change.DT",function(e){He(n,j(this).val());de(n)});j(n.nTable).on("length.dt.DT",function(e,t,r){if(n===t){j("select",f).val(r)}});return f[0]}function We(e){var t=e.sPaginationType,f=A.ext.pager[t],c=typeof f==="function",d=function(e){de(e)},r=j("<div/>").addClass(e.oClasses.sPaging+t)[0],h=e.aanFeatures;if(!c){f.fnInit(e,r,d)}if(!h.p){r.id=e.sTableId+"_paginate";e.aoDrawCallback.push({fn:function(e){if(c){var t=e._iDisplayStart,r=e._iDisplayLength,n=e.fnRecordsDisplay(),i=r===-1,a=i?0:Math.ceil(t/r),o=i?1:Math.ceil(n/r),s=f(a,o),l,u;for(l=0,u=h.p.length;l<u;l++){yt(e,"pageButton")(e,h.p[l],l,s,a,o)}}else{f.fnUpdate(e,d)}},sName:"pagination"})}return r}function Ue(e,t,r){var n=e._iDisplayStart,i=e._iDisplayLength,a=e.fnRecordsDisplay();if(a===0||i===-1){n=0}else if(typeof t==="number"){n=t*i;if(n>a){n=0}}else if(t=="first"){n=0}else if(t=="previous"){n=i>=0?n-i:0;if(n<0){n=0}}else if(t=="next"){if(n+i<a){n+=i}}else if(t=="last"){n=Math.floor((a-1)/i)*i}else{ct(e,0,"Unknown paging action: "+t,5)}var o=e._iDisplayStart!==n;e._iDisplayStart=n;if(o){gt(e,null,"page",[e]);if(r){de(e)}}return o}function je(e){return j("<div/>",{id:!e.aanFeatures.r?e.sTableId+"_processing":null,class:e.oClasses.sProcessing}).html(e.oLanguage.sProcessing).insertBefore(e.nTable)[0]}function Ve(e,t){if(e.oFeatures.bProcessing){j(e.aanFeatures.r).css("display",t?"block":"none")}gt(e,null,"processing",[e,t])}function ze(e){var t=j(e.nTable);t.attr("role","grid");var r=e.oScroll;if(r.sX===""&&r.sY===""){return e.nTable}var n=r.sX;var i=r.sY;var a=e.oClasses;var o=t.children("caption");var s=o.length?o[0]._captionSide:null;var l=j(t[0].cloneNode(false));var u=j(t[0].cloneNode(false));var f=t.children("tfoot");var c="<div/>";var d=function(e){return!e?null:et(e)};if(!f.length){f=null}var h=j(c,{class:a.sScrollWrapper}).append(j(c,{class:a.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:n?d(n):"100%"}).append(j(c,{class:a.sScrollHeadInner}).css({"box-sizing":"content-box",width:r.sXInner||"100%"}).append(l.removeAttr("id").css("margin-left",0).append(s==="top"?o:null).append(t.children("thead"))))).append(j(c,{class:a.sScrollBody}).css({position:"relative",overflow:"auto",width:d(n)}).append(t));if(f){h.append(j(c,{class:a.sScrollFoot}).css({overflow:"hidden",border:0,width:n?d(n):"100%"}).append(j(c,{class:a.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append(s==="bottom"?o:null).append(t.children("tfoot")))))}var v=h.children();var p=v[0];var g=v[1];var m=f?v[2]:null;if(n){j(g).on("scroll.DT",function(e){var t=this.scrollLeft;p.scrollLeft=t;if(f){m.scrollLeft=t}})}j(g).css("max-height",i);if(!r.bCollapse){j(g).css("height",i)}e.nScrollHead=p;e.nScrollBody=g;e.nScrollFoot=m;e.aoDrawCallback.push({fn:qe,sName:"scrolling"});return h[0]}function qe(r){var e=r.oScroll,t=e.sX,n=e.sXInner,i=e.sY,a=e.iBarWidth,o=j(r.nScrollHead),s=o[0].style,l=o.children("div"),u=l[0].style,f=l.children("table"),c=r.nScrollBody,d=j(c),h=c.style,v=j(r.nScrollFoot),p=v.children("div"),g=p.children("table"),m=j(r.nTHead),y=j(r.nTable),b=y[0],w=b.style,C=r.nTFoot?j(r.nTFoot):null,S=r.oBrowser,E=S.bScrollOversize,k=z(r.aoColumns,"nTh"),T,_,x,D,R,I,O=[],A=[],N=[],M=[],L,P,F,B=function(e){var t=e.style;t.paddingTop="0";t.paddingBottom="0";t.borderTopWidth="0";t.borderBottomWidth="0";t.height=0};var H=c.scrollHeight>c.clientHeight;if(r.scrollBarVis!==H&&r.scrollBarVis!==V){r.scrollBarVis=H;q(r);return}else{r.scrollBarVis=H}y.children("thead, tfoot").remove();if(C){I=C.clone().prependTo(y);_=C.find("tr");D=I.find("tr")}R=m.clone().prependTo(y);T=m.find("tr");x=R.find("tr");R.find("th, td").removeAttr("tabindex");if(!t){h.width="100%";o[0].style.width="100%"}j.each(ge(r,R),function(e,t){L=Y(r,e);t.style.width=r.aoColumns[L].sWidth});if(C){Ye(function(e){e.style.width=""},D)}F=y.outerWidth();if(t===""){w.width="100%";if(E&&(y.find("tbody").height()>c.offsetHeight||d.css("overflow-y")=="scroll")){w.width=et(y.outerWidth()-a)}F=y.outerWidth()}else if(n!==""){w.width=et(n);F=y.outerWidth()}Ye(B,x);Ye(function(e){N.push(e.innerHTML);O.push(et(j(e).css("width")))},x);Ye(function(e,t){if(j.inArray(e,k)!==-1){e.style.width=O[t]}},T);j(x).height(0);if(C){Ye(B,D);Ye(function(e){M.push(e.innerHTML);A.push(et(j(e).css("width")))},D);Ye(function(e,t){e.style.width=A[t]},_);j(D).height(0)}Ye(function(e,t){e.innerHTML='<div class="dataTables_sizing">'+N[t]+"</div>";e.childNodes[0].style.height="0";e.childNodes[0].style.overflow="hidden";e.style.width=O[t]},x);if(C){Ye(function(e,t){e.innerHTML='<div class="dataTables_sizing">'+M[t]+"</div>";e.childNodes[0].style.height="0";e.childNodes[0].style.overflow="hidden";e.style.width=A[t]},D)}if(y.outerWidth()<F){P=c.scrollHeight>c.offsetHeight||d.css("overflow-y")=="scroll"?F+a:F;if(E&&(c.scrollHeight>c.offsetHeight||d.css("overflow-y")=="scroll")){w.width=et(P-a)}if(t===""||n!==""){ct(r,1,"Possible column misalignment",6)}}else{P="100%"}h.width=et(P);s.width=et(P);if(C){r.nScrollFoot.style.width=et(P)}if(!i){if(E){h.height=et(b.offsetHeight+a)}}var $=y.outerWidth();f[0].style.width=et($);u.width=et($);var W=y.height()>c.clientHeight||d.css("overflow-y")=="scroll";var U="padding"+(S.bScrollbarLeft?"Left":"Right");u[U]=W?a+"px":"0px";if(C){g[0].style.width=et($);p[0].style.width=et($);p[0].style[U]=W?a+"px":"0px"}y.children("colgroup").insertBefore(y.children("thead"));d.trigger("scroll");if((r.bSorted||r.bFiltered)&&!r._drawHold){c.scrollTop=0}}function Ye(e,t,r){var n=0,i=0,a=t.length;var o,s;while(i<a){o=t[i].firstChild;s=r?r[i].firstChild:null;while(o){if(o.nodeType===1){if(r){e(o,s,n)}else{e(o,n)}n++}o=o.nextSibling;s=r?s.nextSibling:null}i++}}var Ge=/<.*?>/g;function Xe(e){var t=e.nTable,r=e.aoColumns,n=e.oScroll,i=n.sY,a=n.sX,o=n.sXInner,s=r.length,l=$(e,"bVisible"),u=j("th",e.nTHead),f=t.getAttribute("width"),c=t.parentNode,d=false,h,v,p,g,m,y=e.oBrowser,b=y.bScrollOversize;var w=t.style.width;if(w&&w.indexOf("%")!==-1){f=w}for(h=0;h<l.length;h++){v=r[l[h]];if(v.sWidth!==null){v.sWidth=Je(v.sWidthOrig,c);d=true}}if(b||!d&&!a&&!i&&s==O(e)&&s==u.length){for(h=0;h<s;h++){var C=Y(e,h);if(C!==null){r[C].sWidth=et(u.eq(h).width())}}}else{var S=j(t).clone().css("visibility","hidden").removeAttr("id");S.find("tbody tr").remove();var E=j("<tr/>").appendTo(S.find("tbody"));S.find("thead, tfoot").remove();S.append(j(e.nTHead).clone()).append(j(e.nTFoot).clone());S.find("tfoot th, tfoot td").css("width","");u=ge(e,S.find("thead")[0]);for(h=0;h<l.length;h++){v=r[l[h]];u[h].style.width=v.sWidthOrig!==null&&v.sWidthOrig!==""?et(v.sWidthOrig):"";if(v.sWidthOrig&&a){j(u[h]).append(j("<div/>").css({width:v.sWidthOrig,margin:0,padding:0,border:0,height:1}))}}if(e.aoData.length){for(h=0;h<l.length;h++){p=l[h];v=r[p];j(Qe(e,p)).clone(false).append(v.sContentPadding).appendTo(E)}}j("[name]",S).removeAttr("name");var k=j("<div/>").css(a||i?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(S).appendTo(c);if(a&&o){S.width(o)}else if(a){S.css("width","auto");S.removeAttr("width");if(S.width()<c.clientWidth&&f){S.width(c.clientWidth)}}else if(i){S.width(c.clientWidth)}else if(f){S.width(f)}var T=0;for(h=0;h<l.length;h++){var _=j(u[h]);var x=_.outerWidth()-_.width();var D=y.bBounding?Math.ceil(u[h].getBoundingClientRect().width):_.outerWidth();T+=D;r[l[h]].sWidth=et(D-x)}t.style.width=et(T);k.remove()}if(f){t.style.width=et(f)}if((f||a)&&!e._reszEvt){var R=function(){j(I).on("resize.DT-"+e.sInstance,Ke(function(){q(e)}))};if(b){setTimeout(R,1e3)}else{R()}e._reszEvt=true}}var Ke=A.util.throttle;function Je(e,t){if(!e){return 0}var r=j("<div/>").css("width",et(e)).appendTo(t||C.body);var n=r[0].offsetWidth;r.remove();return n}function Qe(e,t){var r=Ze(e,t);if(r<0){return null}var n=e.aoData[r];return!n.nTr?j("<td/>").html(K(e,r,t,"display"))[0]:n.anCells[t]}function Ze(e,t){var r,n=-1,i=-1;for(var a=0,o=e.aoData.length;a<o;a++){r=K(e,a,t,"display")+"";r=r.replace(Ge,"");r=r.replace(/&nbsp;/g," ");if(r.length>n){n=r.length;i=a}}return i}function et(e){if(e===null){return"0px"}if(typeof e=="number"){return e<0?"0px":e+"px"}return e.match(/\d$/)?e+"px":e}function tt(e){var t,r,n,i,a=[],o=[],s=e.aoColumns,l,u,f,c,d=e.aaSortingFixed,h=j.isPlainObject(d),v=[],p=function(e){if(e.length&&!Array.isArray(e[0])){v.push(e)}else{j.merge(v,e)}};if(Array.isArray(d)){p(d)}if(h&&d.pre){p(d.pre)}p(e.aaSorting);if(h&&d.post){p(d.post)}for(t=0;t<v.length;t++){c=v[t][0];l=s[c].aDataSort;for(n=0,i=l.length;n<i;n++){u=l[n];f=s[u].sType||"string";if(v[t]._idx===V){v[t]._idx=j.inArray(v[t][1],s[u].asSorting)}a.push({src:c,col:u,dir:v[t][1],index:v[t]._idx,type:f,formatter:A.ext.type.order[f+"-pre"]})}}return a}function rt(e){var t,r,n,i,a,o,s,l,u,d=[],h=A.ext.type.order,v=e.aoData,f=e.aoColumns,c,p,g,m,y,b=0,w,C=e.aiDisplayMaster,S;D(e);S=tt(e);for(t=0,r=S.length;t<r;t++){w=S[t];if(w.formatter){b++}st(e,w.col)}if(bt(e)!="ssp"&&S.length!==0){for(t=0,n=C.length;t<n;t++){d[C[t]]=t}if(b===S.length){C.sort(function(e,t){var r,n,i,a,o,s=S.length,l=v[e]._aSortData,u=v[t]._aSortData;for(i=0;i<s;i++){o=S[i];r=l[o.col];n=u[o.col];a=r<n?-1:r>n?1:0;if(a!==0){return o.dir==="asc"?a:-a}}r=d[e];n=d[t];return r<n?-1:r>n?1:0})}else{C.sort(function(e,t){var r,n,i,a,o,s,l,u=S.length,f=v[e]._aSortData,c=v[t]._aSortData;for(i=0;i<u;i++){s=S[i];r=f[s.col];n=c[s.col];l=h[s.type+"-"+s.dir]||h["string-"+s.dir];o=l(r,n);if(o!==0){return o}}r=d[e];n=d[t];return r<n?-1:r>n?1:0})}}e.bSorted=true}function nt(e){var t;var r;var n=e.aoColumns;var i=tt(e);var a=e.oLanguage.oAria;for(var o=0,s=n.length;o<s;o++){var l=n[o];var u=l.asSorting;var f=l.sTitle.replace(/<.*?>/g,"");var c=l.nTh;c.removeAttribute("aria-sort");if(l.bSortable){if(i.length>0&&i[0].col==o){c.setAttribute("aria-sort",i[0].dir=="asc"?"ascending":"descending");r=u[i[0].index+1]||u[0]}else{r=u[0]}t=f+(r==="asc"?a.sSortAscending:a.sSortDescending)}else{t=f}c.setAttribute("aria-label",t)}}function it(e,t,r,n){var i=e.aoColumns[t];var a=e.aaSorting;var o=i.asSorting;var s;var l=function(e,t){var r=e._idx;if(r===V){r=j.inArray(e[1],o)}return r+1<o.length?r+1:t?null:0};if(typeof a[0]==="number"){a=e.aaSorting=[a]}if(r&&e.oFeatures.bSortMulti){var u=j.inArray(t,z(a,"0"));if(u!==-1){s=l(a[u],true);if(s===null&&a.length===1){s=0}if(s===null){a.splice(u,1)}else{a[u][1]=o[s];a[u]._idx=s}}else{a.push([t,o[0],0]);a[a.length-1]._idx=0}}else if(a.length&&a[0][0]==t){s=l(a[0]);a.length=1;a[0][1]=o[s];a[0]._idx=s}else{a.length=0;a.push([t,o[0]]);a[0]._idx=0}he(e);if(typeof n=="function"){n(e)}}function at(t,e,r,n){var i=t.aoColumns[r];vt(e,{},function(e){if(i.bSortable===false){return}if(t.oFeatures.bProcessing){Ve(t,true);setTimeout(function(){it(t,r,e.shiftKey,n);if(bt(t)!=="ssp"){Ve(t,false)}},0)}else{it(t,r,e.shiftKey,n)}})}function ot(e){var t=e.aLastSort;var r=e.oClasses.sSortColumn;var n=tt(e);var i=e.oFeatures;var a,o,s;if(i.bSort&&i.bSortClasses){for(a=0,o=t.length;a<o;a++){s=t[a].src;j(z(e.aoData,"anCells",s)).removeClass(r+(a<2?a+1:3))}for(a=0,o=n.length;a<o;a++){s=n[a].src;j(z(e.aoData,"anCells",s)).addClass(r+(a<2?a+1:3))}}e.aLastSort=n}function st(e,t){var r=e.aoColumns[t];var n=A.ext.order[r.sSortDataType];var i;if(n){i=n.call(e.oInstance,e,t,x(e,t))}var a,o;var s=A.ext.type.order[r.sType+"-pre"];for(var l=0,u=e.aoData.length;l<u;l++){a=e.aoData[l];if(!a._aSortData){a._aSortData=[]}if(!a._aSortData[t]||n){o=n?i[l]:K(e,l,t,"sort");a._aSortData[t]=s?s(o):o}}}function lt(r){if(!r.oFeatures.bStateSave||r.bDestroying){return}var e={time:+new Date,start:r._iDisplayStart,length:r._iDisplayLength,order:j.extend(true,[],r.aaSorting),search:Ae(r.oPreviousSearch),columns:j.map(r.aoColumns,function(e,t){return{visible:e.bVisible,search:Ae(r.aoPreSearchCols[t])}})};gt(r,"aoStateSaveParams","stateSaveParams",[r,e]);r.oSavedState=e;r.fnStateSaveCallback.call(r.oInstance,r,e)}function ut(i,e,a){var o,s;var l=i.aoColumns;var t=function(e){if(!e||!e.time){a();return}var t=gt(i,"aoStateLoadParams","stateLoadParams",[i,e]);if(j.inArray(false,t)!==-1){a();return}var r=i.iStateDuration;if(r>0&&e.time<+new Date-r*1e3){a();return}if(e.columns&&l.length!==e.columns.length){a();return}i.oLoadedState=j.extend(true,{},e);if(e.start!==V){i._iDisplayStart=e.start;i.iInitDisplayStart=e.start}if(e.length!==V){i._iDisplayLength=e.length}if(e.order!==V){i.aaSorting=[];j.each(e.order,function(e,t){i.aaSorting.push(t[0]>=l.length?[0,t[1]]:t)})}if(e.search!==V){j.extend(i.oPreviousSearch,Ne(e.search))}if(e.columns){for(o=0,s=e.columns.length;o<s;o++){var n=e.columns[o];if(n.visible!==V){l[o].bVisible=n.visible}if(n.search!==V){j.extend(i.aoPreSearchCols[o],Ne(n.search))}}}gt(i,"aoStateLoaded","stateLoaded",[i,e]);a()};if(!i.oFeatures.bStateSave){a();return}var r=i.fnStateLoadCallback.call(i.oInstance,i,t);if(r!==V){t(r)}}function ft(e){var t=A.settings;var r=j.inArray(e,z(t,"nTable"));return r!==-1?t[r]:null}function ct(e,t,r,n){r="DataTables warning: "+(e?"table id="+e.sTableId+" - ":"")+r;if(n){r+=". For more information about this error, please see "+"http://datatables.net/tn/"+n}if(!t){var i=A.ext;var a=i.sErrMode||i.errMode;if(e){gt(e,null,"error",[e,n,r])}if(a=="alert"){alert(r)}else if(a=="throw"){throw new Error(r)}else if(typeof a=="function"){a(e,n,r)}}else if(I.console&&console.log){console.log(r)}}function dt(r,n,e,t){if(Array.isArray(e)){j.each(e,function(e,t){if(Array.isArray(t)){dt(r,n,t[0],t[1])}else{dt(r,n,t)}});return}if(t===V){t=e}if(n[e]!==V){r[t]=n[e]}}function ht(e,t,r){var n;for(var i in t){if(t.hasOwnProperty(i)){n=t[i];if(j.isPlainObject(n)){if(!j.isPlainObject(e[i])){e[i]={}}j.extend(true,e[i],n)}else if(r&&i!=="data"&&i!=="aaData"&&Array.isArray(n)){e[i]=n.slice()}else{e[i]=n}}}return e}function vt(t,e,r){j(t).on("click.DT",e,function(e){j(t).trigger("blur");r(e)}).on("keypress.DT",e,function(e){if(e.which===13){e.preventDefault();r(e)}}).on("selectstart.DT",function(){return false})}function pt(e,t,r,n){if(r){e[t].push({fn:r,sName:n})}}function gt(r,e,t,n){var i=[];if(e){i=j.map(r[e].slice().reverse(),function(e,t){return e.fn.apply(r.oInstance,n)})}if(t!==null){var a=j.Event(t+".dt");j(r.nTable).trigger(a,n);i.push(a.result)}return i}function mt(e){var t=e._iDisplayStart,r=e.fnDisplayEnd(),n=e._iDisplayLength;if(t>=r){t=r-n}t-=t%n;if(n===-1||t<0){t=0}e._iDisplayStart=t}function yt(e,t){var r=e.renderer;var n=A.ext.renderer[t];if(j.isPlainObject(r)&&r[t]){return n[r[t]]||n._}else if(typeof r==="string"){return n[r]||n._}return n._}function bt(e){if(e.oFeatures.bServerSide){return"ssp"}else if(e.ajax||e.sAjaxSource){return"ajax"}return"dom"}var wt=[];var Ct=Array.prototype;var St=function(e){var t,r;var n=A.settings;var i=j.map(n,function(e,t){return e.nTable});if(!e){return[]}else if(e.nTable&&e.oApi){return[e]}else if(e.nodeName&&e.nodeName.toLowerCase()==="table"){t=j.inArray(e,i);return t!==-1?[n[t]]:null}else if(e&&typeof e.settings==="function"){return e.settings().toArray()}else if(typeof e==="string"){r=j(e)}else if(e instanceof j){r=e}if(r){return r.map(function(e){t=j.inArray(this,i);return t!==-1?n[t]:null}).toArray()}};y=function(e,t){if(!(this instanceof y)){return new y(e,t)}var r=[];var n=function(e){var t=St(e);if(t){r.push.apply(r,t)}};if(Array.isArray(e)){for(var i=0,a=e.length;i<a;i++){n(e[i])}}else{n(e)}this.context=S(r);if(t){j.merge(this,t)}this.selector={rows:null,cols:null,opts:null};y.extend(this,this,wt)};A.Api=y;j.extend(y.prototype,{any:function(){return this.count()!==0},concat:Ct.concat,context:[],count:function(){return this.flatten().length},each:function(e){for(var t=0,r=this.length;t<r;t++){e.call(this,this[t],t,this)}return this},eq:function(e){var t=this.context;return t.length>e?new y(t[e],this[e]):null},filter:function(e){var t=[];if(Ct.filter){t=Ct.filter.call(this,e,this)}else{for(var r=0,n=this.length;r<n;r++){if(e.call(this,this[r],r,this)){t.push(this[r])}}}return new y(this.context,t)},flatten:function(){var e=[];return new y(this.context,e.concat.apply(e,this.toArray()))},join:Ct.join,indexOf:Ct.indexOf||function(e,t){for(var r=t||0,n=this.length;r<n;r++){if(this[r]===e){return r}}return-1},iterator:function(e,t,r,n){var i=[],a,o,s,l,u,f=this.context,c,d,h,v=this.selector;if(typeof e==="string"){n=r;r=t;t=e;e=false}for(o=0,s=f.length;o<s;o++){var p=new y(f[o]);if(t==="table"){a=r.call(p,f[o],o);if(a!==V){i.push(a)}}else if(t==="columns"||t==="rows"){a=r.call(p,f[o],this[o],o);if(a!==V){i.push(a)}}else if(t==="column"||t==="column-rows"||t==="row"||t==="cell"){d=this[o];if(t==="column-rows"){c=Dt(f[o],v.opts)}for(l=0,u=d.length;l<u;l++){h=d[l];if(t==="cell"){a=r.call(p,f[o],h.row,h.column,o,l)}else{a=r.call(p,f[o],h,o,l,c)}if(a!==V){i.push(a)}}}}if(i.length||n){var g=new y(f,e?i.concat.apply([],i):i);var m=g.selector;m.rows=v.rows;m.cols=v.cols;m.opts=v.opts;return g}return this},lastIndexOf:Ct.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(e){var t=[];if(Ct.map){t=Ct.map.call(this,e,this)}else{for(var r=0,n=this.length;r<n;r++){t.push(e.call(this,this[r],r))}}return new y(this.context,t)},pluck:function(t){return this.map(function(e){return e[t]})},pop:Ct.pop,push:Ct.push,reduce:Ct.reduce||function(e,t){return _(this,e,t,0,this.length,1)},reduceRight:Ct.reduceRight||function(e,t){return _(this,e,t,this.length-1,-1,-1)},reverse:Ct.reverse,selector:null,shift:Ct.shift,slice:function(){return new y(this.context,this)},sort:Ct.sort,splice:Ct.splice,toArray:function(){return Ct.slice.call(this)},to$:function(){return j(this)},toJQuery:function(){return j(this)},unique:function(){return new y(this.context,S(this))},unshift:Ct.unshift});y.extend=function(e,t,r){if(!r.length||!t||!(t instanceof y)&&!t.__dt_wrapper){return}var n,i,a,o=function(t,r,n){return function(){var e=r.apply(t,arguments);y.extend(e,e,n.methodExt);return e}};for(n=0,i=r.length;n<i;n++){a=r[n];t[a.name]=a.type==="function"?o(e,a.val,a):a.type==="object"?{}:a.val;t[a.name].__dt_wrapper=true;y.extend(e,t[a.name],a.propExt)}};y.register=t=function(e,t){if(Array.isArray(e)){for(var r=0,n=e.length;r<n;r++){y.register(e[r],t)}return}var i,a,o=e.split("."),s=wt,l,u;var f=function(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r].name===t){return e[r]}}return null};for(i=0,a=o.length;i<a;i++){u=o[i].indexOf("()")!==-1;l=u?o[i].replace("()",""):o[i];var c=f(s,l);if(!c){c={name:l,val:{},methodExt:[],propExt:[],type:"object"};s.push(c)}if(i===a-1){c.val=t;c.type=typeof t==="function"?"function":j.isPlainObject(t)?"object":"other"}else{s=u?c.methodExt:c.propExt}}};y.registerPlural=e=function(e,t,r){y.register(e,r);y.register(t,function(){var e=r.apply(this,arguments);if(e===this){return this}else if(e instanceof y){return e.length?Array.isArray(e[0])?new y(e.context,e[0]):e[0]:V}return e})};var Et=function(e,r){if(Array.isArray(e)){return j.map(e,function(e){return Et(e,r)})}if(typeof e==="number"){return[r[e]]}var n=j.map(r,function(e,t){return e.nTable});return j(n).filter(e).map(function(e){var t=j.inArray(this,n);return r[t]}).toArray()};t("tables()",function(e){return e!==V&&e!==null?new y(Et(e,this.context)):this});t("table()",function(e){var t=this.tables(e);var r=t.context;return r.length?new y(r[0]):t});e("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)});e("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)});e("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)});e("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)});e("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)});t("draw()",function(t){return this.iterator("table",function(e){if(t==="page"){de(e)}else{if(typeof t==="string"){t=t==="full-hold"?false:true}he(e,t===false)}})});t("page()",function(t){if(t===V){return this.page.info().page}return this.iterator("table",function(e){Ue(e,t)})});t("page.info()",function(e){if(this.context.length===0){return V}var t=this.context[0],r=t._iDisplayStart,n=t.oFeatures.bPaginate?t._iDisplayLength:-1,i=t.fnRecordsDisplay(),a=n===-1;return{page:a?0:Math.floor(r/n),pages:a?1:Math.ceil(i/n),start:r,end:t.fnDisplayEnd(),length:n,recordsTotal:t.fnRecordsTotal(),recordsDisplay:i,serverSide:bt(t)==="ssp"}});t("page.len()",function(t){if(t===V){return this.context.length!==0?this.context[0]._iDisplayLength:V}return this.iterator("table",function(e){He(e,t)})});var kt=function(i,a,e){if(e){var t=new y(i);t.one("draw",function(){e(t.ajax.json())})}if(bt(i)=="ssp"){he(i,a)}else{Ve(i,true);var r=i.jqXHR;if(r&&r.readyState!==4){r.abort()}me(i,[],function(e){ie(i);var t=Ce(i,e);for(var r=0,n=t.length;r<n;r++){U(i,t[r])}he(i,a);Ve(i,false)})}};t("ajax.json()",function(){var e=this.context;if(e.length>0){return e[0].json}});t("ajax.params()",function(){var e=this.context;if(e.length>0){return e[0].oAjaxData}});t("ajax.reload()",function(t,r){return this.iterator("table",function(e){kt(e,r===false,t)})});t("ajax.url()",function(t){var e=this.context;if(t===V){if(e.length===0){return V}e=e[0];return e.ajax?j.isPlainObject(e.ajax)?e.ajax.url:e.ajax:e.sAjaxSource}return this.iterator("table",function(e){if(j.isPlainObject(e.ajax)){e.ajax.url=t}else{e.ajax=t}})});t("ajax.url().load()",function(t,r){return this.iterator("table",function(e){kt(e,r===false,t)})});var Tt=function(e,t,r,n,i){var a=[],o,s,l,u,f,c,d=typeof t;if(!t||d==="string"||d==="function"||t.length===V){t=[t]}for(l=0,u=t.length;l<u;l++){s=t[l]&&t[l].split&&!t[l].match(/[\[\(:]/)?t[l].split(","):[t[l]];for(f=0,c=s.length;f<c;f++){o=r(typeof s[f]==="string"?s[f].trim():s[f]);if(o&&o.length){a=a.concat(o)}}}var h=v.selector[e];if(h.length){for(l=0,u=h.length;l<u;l++){a=h[l](n,i,a)}}return S(a)};var _t=function(e){if(!e){e={}}if(e.filter&&e.search===V){e.search=e.filter}return j.extend({search:"none",order:"current",page:"all"},e)};var xt=function(e){for(var t=0,r=e.length;t<r;t++){if(e[t].length>0){e[0]=e[t];e[0].length=1;e.length=1;e.context=[e.context[t]];return e}}e.length=0;return e};var Dt=function(e,t){var r,n,i,a=[],o=e.aiDisplay,s=e.aiDisplayMaster;var l=t.search,u=t.order,f=t.page;if(bt(e)=="ssp"){return l==="removed"?[]:p(0,s.length)}else if(f=="current"){for(r=e._iDisplayStart,n=e.fnDisplayEnd();r<n;r++){a.push(o[r])}}else if(u=="current"||u=="applied"){if(l=="none"){a=s.slice()}else if(l=="applied"){a=o.slice()}else if(l=="removed"){var c={};for(var r=0,n=o.length;r<n;r++){c[o[r]]=null}a=j.map(s,function(e){return!c.hasOwnProperty(e)?e:null})}}else if(u=="index"||u=="original"){for(r=0,n=e.aoData.length;r<n;r++){if(l=="none"){a.push(r)}else{i=j.inArray(r,o);if(i===-1&&l=="removed"||i>=0&&l=="applied"){a.push(r)}}}}return a};var Rt=function(f,e,c){var d;var t=function(r){var e=h(r);var t,n;var i=f.aoData;if(e!==null&&!c){return[e]}if(!d){d=Dt(f,c)}if(e!==null&&j.inArray(e,d)!==-1){return[e]}else if(r===null||r===V||r===""){return d}if(typeof r==="function"){return j.map(d,function(e){var t=i[e];return r(e,t._aData,t.nTr)?e:null})}if(r.nodeName){var a=r._DT_RowIndex;var o=r._DT_CellIndex;if(a!==V){return i[a]&&i[a].nTr===r?[a]:[]}else if(o){return i[o.row]&&i[o.row].nTr===r.parentNode?[o.row]:[]}else{var s=j(r).closest("*[data-dt-row]");return s.length?[s.data("dt-row")]:[]}}if(typeof r==="string"&&r.charAt(0)==="#"){var l=f.aIds[r.replace(/^#/,"")];if(l!==V){return[l.idx]}}var u=m(g(f.aoData,d,"nTr"));return j(u).filter(r).map(function(){return this._DT_RowIndex}).toArray()};return Tt("row",e,t,f,c)};t("rows()",function(t,r){if(t===V){t=""}else if(j.isPlainObject(t)){r=t;t=""}r=_t(r);var e=this.iterator("table",function(e){return Rt(e,t,r)},1);e.selector.rows=t;e.selector.opts=r;return e});t("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||V},1)});t("rows().data()",function(){return this.iterator(true,"rows",function(e,t){return g(e.aoData,t,"_aData")},1)});e("rows().cache()","row().cache()",function(n){return this.iterator("row",function(e,t){var r=e.aoData[t];return n==="search"?r._aFilterData:r._aSortData},1)});e("rows().invalidate()","row().invalidate()",function(r){return this.iterator("row",function(e,t){oe(e,t,r)})});e("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t},1)});e("rows().ids()","row().id()",function(e){var t=[];var r=this.context;for(var n=0,i=r.length;n<i;n++){for(var a=0,o=this[n].length;a<o;a++){var s=r[n].rowIdFn(r[n].aoData[this[n][a]]._aData);t.push((e===true?"#":"")+s)}}return new y(r,t)});e("rows().remove()","row().remove()",function(){var d=this;this.iterator("row",function(e,t,r){var n=e.aoData;var i=n[t];var a,o,s,l;var u,f;n.splice(t,1);for(a=0,o=n.length;a<o;a++){u=n[a];f=u.anCells;if(u.nTr!==null){u.nTr._DT_RowIndex=a}if(f!==null){for(s=0,l=f.length;s<l;s++){f[s]._DT_CellIndex.row=a}}}ae(e.aiDisplayMaster,t);ae(e.aiDisplay,t);ae(d[r],t,false);if(e._iRecordsDisplay>0){e._iRecordsDisplay--}mt(e);var c=e.rowIdFn(i._aData);if(c!==V){delete e.aIds[c]}});this.iterator("table",function(e){for(var t=0,r=e.aoData.length;t<r;t++){e.aoData[t].idx=t}});return this});t("rows.add()",function(a){var e=this.iterator("table",function(e){var t,r,n;var i=[];for(r=0,n=a.length;r<n;r++){t=a[r];if(t.nodeName&&t.nodeName.toUpperCase()==="TR"){i.push(G(e,t)[0])}else{i.push(U(e,t))}}return i},1);var t=this.rows(-1);t.pop();j.merge(t,e);return t});t("row()",function(e,t){return xt(this.rows(e,t))});t("row().data()",function(e){var t=this.context;if(e===V){return t.length&&this.length?t[0].aoData[this[0]]._aData:V}var r=t[0].aoData[this[0]];r._aData=e;if(Array.isArray(e)&&r.nTr&&r.nTr.id){re(t[0].rowId)(e,r.nTr.id)}oe(t[0],this[0],"data");return this});t("row().node()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]].nTr||null:null});t("row.add()",function(t){if(t instanceof j&&t.length){t=t[0]}var e=this.iterator("table",function(e){if(t.nodeName&&t.nodeName.toUpperCase()==="TR"){return G(e,t)[0]}return U(e,t)});return this.row(e[0])});var It=function(a,e,t,r){var o=[];var s=function(e,t){if(Array.isArray(e)||e instanceof j){for(var r=0,n=e.length;r<n;r++){s(e[r],t)}return}if(e.nodeName&&e.nodeName.toLowerCase()==="tr"){o.push(e)}else{var i=j("<tr><td></td></tr>").addClass(t);j("td",i).addClass(t).html(e)[0].colSpan=O(a);o.push(i[0])}};s(t,r);if(e._details){e._details.detach()}e._details=j(o);if(e._detailsShow){e._details.insertAfter(e.nTr)}};var Ot=function(e,t){var r=e.context;if(r.length){var n=r[0].aoData[t!==V?t:e[0]];if(n&&n._details){n._details.remove();n._detailsShow=V;n._details=V}}};var At=function(e,t){var r=e.context;if(r.length&&e.length){var n=r[0].aoData[e[0]];if(n._details){n._detailsShow=t;if(t){n._details.insertAfter(n.nTr)}else{n._details.detach()}Nt(r[0])}}};var Nt=function(l){var i=new y(l);var e=".dt.DT_details";var t="draw"+e;var r="column-visibility"+e;var n="destroy"+e;var u=l.aoData;i.off(t+" "+r+" "+n);if(z(u,"_details").length>0){i.on(t,function(e,t){if(l!==t){return}i.rows({page:"current"}).eq(0).each(function(e){var t=u[e];if(t._detailsShow){t._details.insertAfter(t.nTr)}})});i.on(r,function(e,t,r,n){if(l!==t){return}var i,a=O(t);for(var o=0,s=u.length;o<s;o++){i=u[o];if(i._details){i._details.children("td[colspan]").attr("colspan",a)}}});i.on(n,function(e,t){if(l!==t){return}for(var r=0,n=u.length;r<n;r++){if(u[r]._details){Ot(i,r)}}})}};var Mt="";var Lt=Mt+"row().child";var Pt=Lt+"()";t(Pt,function(e,t){var r=this.context;if(e===V){return r.length&&this.length?r[0].aoData[this[0]]._details:V}else if(e===true){this.child.show()}else if(e===false){Ot(this)}else if(r.length&&this.length){It(r[0],r[0].aoData[this[0]],e,t)}return this});t([Lt+".show()",Pt+".show()"],function(e){At(this,true);return this});t([Lt+".hide()",Pt+".hide()"],function(){At(this,false);return this});t([Lt+".remove()",Pt+".remove()"],function(){Ot(this);return this});t(Lt+".isShown()",function(){var e=this.context;if(e.length&&this.length){return e[0].aoData[this[0]]._detailsShow||false}return false});var Ft=/^([^:]+):(name|visIdx|visible)$/;var Bt=function(e,t,r,n,i){var a=[];for(var o=0,s=i.length;o<s;o++){a.push(K(e,i[o],t))}return a};var Ht=function(l,e,u){var f=l.aoColumns,c=z(f,"sName"),d=z(f,"nTh");var t=function(r){var e=h(r);if(r===""){return p(f.length)}if(e!==null){return[e>=0?e:f.length+e]}if(typeof r==="function"){var n=Dt(l,u);return j.map(f,function(e,t){return r(t,Bt(l,t,0,0,n),d[t])?t:null})}var i=typeof r==="string"?r.match(Ft):"";if(i){switch(i[2]){case"visIdx":case"visible":var t=parseInt(i[1],10);if(t<0){var a=j.map(f,function(e,t){return e.bVisible?t:null});return[a[a.length+t]]}return[Y(l,t)];case"name":return j.map(c,function(e,t){return e===i[1]?t:null});default:return[]}}if(r.nodeName&&r._DT_CellIndex){return[r._DT_CellIndex.column]}var o=j(d).filter(r).map(function(){return j.inArray(this,d)}).toArray();if(o.length||!r.nodeName){return o}var s=j(r).closest("*[data-dt-column]");return s.length?[s.data("dt-column")]:[]};return Tt("column",e,t,l,u)};var $t=function(e,t,r){var n=e.aoColumns,i=n[t],a=e.aoData,o,s,l,u,f;if(r===V){return i.bVisible}if(i.bVisible===r){return}if(r){var c=j.inArray(true,z(n,"bVisible"),t+1);for(l=0,u=a.length;l<u;l++){f=a[l].nTr;s=a[l].anCells;if(f){f.insertBefore(s[t],s[c]||null)}}}else{j(z(e.aoData,"anCells",t)).detach()}i.bVisible=r};t("columns()",function(t,r){if(t===V){t=""}else if(j.isPlainObject(t)){r=t;t=""}r=_t(r);var e=this.iterator("table",function(e){return Ht(e,t,r)},1);e.selector.cols=t;e.selector.opts=r;return e});e("columns().header()","column().header()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh},1)});e("columns().footer()","column().footer()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf},1)});e("columns().data()","column().data()",function(){return this.iterator("column-rows",Bt,1)});e("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].mData},1)});e("columns().cache()","column().cache()",function(a){return this.iterator("column-rows",function(e,t,r,n,i){return g(e.aoData,i,a==="search"?"_aFilterData":"_aSortData",t)},1)});e("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,r,n,i){return g(e.aoData,i,"anCells",t)},1)});e("columns().visible()","column().visible()",function(r,n){var t=this;var e=this.iterator("column",function(e,t){if(r===V){return e.aoColumns[t].bVisible}$t(e,t,r)});if(r!==V){this.iterator("table",function(e){ce(e,e.aoHeader);ce(e,e.aoFooter);if(!e.aiDisplay.length){j(e.nTBody).find("td[colspan]").attr("colspan",O(e))}lt(e);t.iterator("column",function(e,t){gt(e,null,"column-visibility",[e,t,r,n])});if(n===V||n){t.columns.adjust()}})}return e});e("columns().indexes()","column().index()",function(r){return this.iterator("column",function(e,t){return r==="visible"?x(e,t):t},1)});t("columns.adjust()",function(){return this.iterator("table",function(e){q(e)},1)});t("column.index()",function(e,t){if(this.context.length!==0){var r=this.context[0];if(e==="fromVisible"||e==="toData"){return Y(r,t)}else if(e==="fromData"||e==="toVisible"){return x(r,t)}}});t("column()",function(e,t){return xt(this.columns(e,t))});var Wt=function(n,e,t){var i=n.aoData;var a=Dt(n,t);var r=m(g(i,a,"anCells"));var o=j(E([],r));var s;var l=n.aoColumns.length;var u,f,c,d,h,v;var p=function(e){var t=typeof e==="function";if(e===null||e===V||t){u=[];for(f=0,c=a.length;f<c;f++){s=a[f];for(d=0;d<l;d++){h={row:s,column:d};if(t){v=i[s];if(e(h,K(n,s,d),v.anCells?v.anCells[d]:null)){u.push(h)}}else{u.push(h)}}}return u}if(j.isPlainObject(e)){return e.column!==V&&e.row!==V&&j.inArray(e.row,a)!==-1?[e]:[]}var r=o.filter(e).map(function(e,t){return{row:t._DT_CellIndex.row,column:t._DT_CellIndex.column}}).toArray();if(r.length||!e.nodeName){return r}v=j(e).closest("*[data-dt-row]");return v.length?[{row:v.data("dt-row"),column:v.data("dt-column")}]:[]};return Tt("cell",e,p,n,t)};t("cells()",function(t,e,r){if(j.isPlainObject(t)){if(t.row===V){r=t;t=null}else{r=e;e=null}}if(j.isPlainObject(e)){r=e;e=null}if(e===null||e===V){return this.iterator("table",function(e){return Wt(e,t,_t(r))})}var n=r?{page:r.page,order:r.order,search:r.search}:{};var i=this.columns(e,n);var a=this.rows(t,n);var o,s,l,u;var f=this.iterator("table",function(e,t){var r=[];for(o=0,s=a[t].length;o<s;o++){for(l=0,u=i[t].length;l<u;l++){r.push({row:a[t][o],column:i[t][l]})}}return r},1);var c=r&&r.selected?this.cells(f,r):f;j.extend(c.selector,{cols:e,rows:t,opts:r});return c});e("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,r){var n=e.aoData[t];return n&&n.anCells?n.anCells[r]:V},1)});t("cells().data()",function(){return this.iterator("cell",function(e,t,r){return K(e,t,r)},1)});e("cells().cache()","cell().cache()",function(n){n=n==="search"?"_aFilterData":"_aSortData";return this.iterator("cell",function(e,t,r){return e.aoData[t][n][r]},1)});e("cells().render()","cell().render()",function(n){return this.iterator("cell",function(e,t,r){return K(e,t,r,n)},1)});e("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,r){return{row:t,column:r,columnVisible:x(e,r)}},1)});e("cells().invalidate()","cell().invalidate()",function(n){return this.iterator("cell",function(e,t,r){oe(e,t,n,r)})});t("cell()",function(e,t,r){return xt(this.cells(e,t,r))});t("cell().data()",function(e){var t=this.context;var r=this[0];if(e===V){return t.length&&r.length?K(t[0],r[0].row,r[0].column):V}J(t[0],r[0].row,r[0].column,e);oe(t[0],r[0].row,"data",r[0].column);return this});t("order()",function(t,e){var r=this.context;if(t===V){return r.length!==0?r[0].aaSorting:V}if(typeof t==="number"){t=[[t,e]]}else if(t.length&&!Array.isArray(t[0])){t=Array.prototype.slice.call(arguments)}return this.iterator("table",function(e){e.aaSorting=t.slice()})});t("order.listener()",function(t,r,n){return this.iterator("table",function(e){at(e,t,r,n)})});t("order.fixed()",function(t){if(!t){var e=this.context;var r=e.length?e[0].aaSortingFixed:V;return Array.isArray(r)?{pre:r}:r}return this.iterator("table",function(e){e.aaSortingFixed=j.extend(true,{},t)})});t(["columns().order()","column().order()"],function(n){var i=this;return this.iterator("table",function(e,t){var r=[];j.each(i[t],function(e,t){r.push([t,n])});e.aaSorting=r})});t("search()",function(t,r,n,i){var e=this.context;if(t===V){return e.length!==0?e[0].oPreviousSearch.sSearch:V}return this.iterator("table",function(e){if(!e.oFeatures.bFilter){return}Ee(e,j.extend({},e.oPreviousSearch,{sSearch:t+"",bRegex:r===null?false:r,bSmart:n===null?true:n,bCaseInsensitive:i===null?true:i}),1)})});e("columns().search()","column().search()",function(n,i,a,o){return this.iterator("column",function(e,t){var r=e.aoPreSearchCols;if(n===V){return r[t].sSearch}if(!e.oFeatures.bFilter){return}j.extend(r[t],{sSearch:n+"",bRegex:i===null?false:i,bSmart:a===null?true:a,bCaseInsensitive:o===null?true:o});Ee(e,e.oPreviousSearch,1)})});t("state()",function(){return this.context.length?this.context[0].oSavedState:null});t("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})});t("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null});t("state.save()",function(){return this.iterator("table",function(e){lt(e)})});A.versionCheck=A.fnVersionCheck=function(e){var t=A.version.split(".");var r=e.split(".");var n,i;for(var a=0,o=r.length;a<o;a++){n=parseInt(t[a],10)||0;i=parseInt(r[a],10)||0;if(n===i){continue}return n>i}return true};A.isDataTable=A.fnIsDataTable=function(e){var i=j(e).get(0);var a=false;if(e instanceof A.Api){return true}j.each(A.settings,function(e,t){var r=t.nScrollHead?j("table",t.nScrollHead)[0]:null;var n=t.nScrollFoot?j("table",t.nScrollFoot)[0]:null;if(t.nTable===i||r===i||n===i){a=true}});return a};A.tables=A.fnTables=function(t){var e=false;if(j.isPlainObject(t)){e=t.api;t=t.visible}var r=j.map(A.settings,function(e){if(!t||t&&j(e.nTable).is(":visible")){return e.nTable}});return e?new y(r):r};A.camelToHungarian=N;t("$()",function(e,t){var r=this.rows(t).nodes(),n=j(r);return j([].concat(n.filter(e).toArray(),n.find(e).toArray()))});j.each(["on","one","off"],function(e,r){t(r+"()",function(){var e=Array.prototype.slice.call(arguments);e[0]=j.map(e[0].split(/\s/),function(e){return!e.match(/\.dt\b/)?e+".dt":e}).join(" ");var t=j(this.tables().nodes());t[r].apply(t,e);return this})});t("clear()",function(){return this.iterator("table",function(e){ie(e)})});t("settings()",function(){return new y(this.context,this.context)});t("init()",function(){var e=this.context;return e.length?e[0].oInit:null});t("data()",function(){return this.iterator("table",function(e){return z(e.aoData,"_aData")}).flatten()});t("destroy()",function(p){p=p||false;return this.iterator("table",function(t){var e=t.nTableWrapper.parentNode;var r=t.oClasses;var n=t.nTable;var i=t.nTBody;var a=t.nTHead;var o=t.nTFoot;var s=j(n);var l=j(i);var u=j(t.nTableWrapper);var f=j.map(t.aoData,function(e){return e.nTr});var c,d;t.bDestroying=true;gt(t,"aoDestroyCallback","destroy",[t]);if(!p){new y(t).columns().visible(true)}u.off(".DT").find(":not(tbody *)").off(".DT");j(I).off(".DT-"+t.sInstance);if(n!=a.parentNode){s.children("thead").detach();s.append(a)}if(o&&n!=o.parentNode){s.children("tfoot").detach();s.append(o)}t.aaSorting=[];t.aaSortingFixed=[];ot(t);j(f).removeClass(t.asStripeClasses.join(" "));j("th, td",a).removeClass(r.sSortable+" "+r.sSortableAsc+" "+r.sSortableDesc+" "+r.sSortableNone);l.children().detach();l.append(f);var h=p?"remove":"detach";s[h]();u[h]();if(!p&&e){e.insertBefore(n,t.nTableReinsertBefore);s.css("width",t.sDestroyWidth).removeClass(r.sTable);d=t.asDestroyStripes.length;if(d){l.children().each(function(e){j(this).addClass(t.asDestroyStripes[e%d])})}}var v=j.inArray(t,A.settings);if(v!==-1){A.settings.splice(v,1)}})});j.each(["column","row","cell"],function(e,l){t(l+"s().every()",function(a){var o=this.selector.opts;var s=this;return this.iterator(l,function(e,t,r,n,i){a.call(s[l](t,l==="cell"?r:o,l==="cell"?o:V),t,r,n,i)})})});t("i18n()",function(e,t,r){var n=this.context[0];var i=te(e)(n.oLanguage);if(i===V){i=t}if(r!==V&&j.isPlainObject(i)){i=i[r]!==V?i[r]:i._}return i.replace("%d",r)});A.version="1.10.24";A.settings=[];A.models={};A.models.oSearch={bCaseInsensitive:true,sSearch:"",bRegex:false,bSmart:true};A.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1};A.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:false,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};A.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:true,bDeferRender:false,bDestroy:false,bFilter:true,bInfo:true,bLengthChange:true,bPaginate:true,bProcessing:false,bRetrieve:false,bScrollCollapse:false,bServerSide:false,bSort:true,bSortMulti:true,bSortCellsTop:false,bSortClasses:true,bStateSave:false,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(e){try{return JSON.parse((e.iStateDuration===-1?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(e){return{}}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(e,t){try{(e.iStateDuration===-1?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(e){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:j.extend({},A.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"};k(A.defaults);A.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:true,bSortable:true,bVisible:true,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};k(A.defaults.column);A.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:false,bScrollbarLeft:false,bBounding:false,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:false,bInitialised:false,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:true,jqXHR:null,json:V,oAjaxData:V,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:false,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,oClasses:{},bFiltered:false,bSorted:false,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return bt(this)=="ssp"?this._iRecordsTotal*1:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return bt(this)=="ssp"?this._iRecordsDisplay*1:this.aiDisplay.length},fnDisplayEnd:function(){var e=this._iDisplayLength,t=this._iDisplayStart,r=t+e,n=this.aiDisplay.length,i=this.oFeatures,a=i.bPaginate;if(i.bServerSide){return a===false||e===-1?t+n:Math.min(t+e,this._iRecordsDisplay)}else{return!a||r>n||e===-1?n:r}},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null};A.ext=v={buttons:{},classes:{},build:"dt/dt-1.10.24/fc-3.3.2/fh-3.1.8/r-2.2.7/rg-1.1.2/sc-2.0.3/sp-1.2.2/sl-1.3.3",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:A.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:A.version};j.extend(v,{afnFiltering:v.search,aTypes:v.type.detect,ofnSearch:v.type.search,oSort:v.type.order,afnSortData:v.order,aoFeatures:v.feature,oApi:v.internal,oStdClasses:v.classes,oPagination:v.pager});j.extend(A.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_desc_disabled",sSortableDesc:"sorting_asc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var Ut=A.ext.pager;function jt(e,t){var r=[],n=Ut.numbers_length,i=Math.floor(n/2),a=1;if(t<=n){r=p(0,t)}else if(e<=i){r=p(0,n-2);r.push("ellipsis");r.push(t-1)}else if(e>=t-1-i){r=p(t-(n-2),t);r.splice(0,0,"ellipsis");r.splice(0,0,0)}else{r=p(e-i+2,e+i-1);r.push("ellipsis");r.push(t-1);r.splice(0,0,"ellipsis");r.splice(0,0,0)}r.DT_el="span";return r}j.extend(Ut,{simple:function(e,t){return["previous","next"]},full:function(e,t){return["first","previous","next","last"]},numbers:function(e,t){return[jt(e,t)]},simple_numbers:function(e,t){return["previous",jt(e,t),"next"]},full_numbers:function(e,t){return["first","previous",jt(e,t),"next","last"]},first_last_numbers:function(e,t){return["first",jt(e,t),"last"]},_numbers:jt,numbers_length:7});j.extend(true,A.ext.renderer,{pageButton:{_:function(f,e,c,t,d,h){var v=f.oClasses;var p=f.oLanguage.oPaginate;var g=f.oLanguage.oAria.paginate||{};var m,y,b=0;var w=function(e,t){var r,n,i,a,o;var s=v.sPageButtonDisabled;var l=function(e){Ue(f,e.data.action,true)};for(r=0,n=t.length;r<n;r++){a=t[r];if(Array.isArray(a)){var u=j("<"+(a.DT_el||"div")+"/>").appendTo(e);w(u,a)}else{m=null;y=a;o=f.iTabIndex;switch(a){case"ellipsis":e.append('<span class="ellipsis">&#x2026;</span>');break;case"first":m=p.sFirst;if(d===0){o=-1;y+=" "+s}break;case"previous":m=p.sPrevious;if(d===0){o=-1;y+=" "+s}break;case"next":m=p.sNext;if(h===0||d===h-1){o=-1;y+=" "+s}break;case"last":m=p.sLast;if(h===0||d===h-1){o=-1;y+=" "+s}break;default:m=f.fnFormatNumber(a+1);y=d===a?v.sPageButtonActive:"";break}if(m!==null){i=j("<a>",{class:v.sPageButton+" "+y,"aria-controls":f.sTableId,"aria-label":g[a],"data-dt-idx":b,tabindex:o,id:c===0&&typeof a==="string"?f.sTableId+"_"+a:null}).html(m).appendTo(e);vt(i,{action:a},l);b++}}}};var r;try{r=j(e).find(C.activeElement).data("dt-idx")}catch(e){}w(j(e).empty(),t);if(r!==V){j(e).find("[data-dt-idx="+r+"]").trigger("focus")}}}});j.extend(A.ext.type.detect,[function(e,t){var r=t.oLanguage.sDecimal;return f(e,r)?"num"+r:null},function(e,t){if(e&&!(e instanceof Date)&&!a.test(e)){return null}var r=Date.parse(e);return r!==null&&!isNaN(r)||l(e)?"date":null},function(e,t){var r=t.oLanguage.sDecimal;return f(e,r,true)?"num-fmt"+r:null},function(e,t){var r=t.oLanguage.sDecimal;return d(e,r)?"html-num"+r:null},function(e,t){var r=t.oLanguage.sDecimal;return d(e,r,true)?"html-num-fmt"+r:null},function(e,t){return l(e)||typeof e==="string"&&e.indexOf("<")!==-1?"html":null}]);j.extend(A.ext.type.search,{html:function(e){return l(e)?e:typeof e==="string"?e.replace(n," ").replace(i,""):""},string:function(e){return l(e)?e:typeof e==="string"?e.replace(n," "):e}});var Vt=function(e,t,r,n){if(e!==0&&(!e||e==="-")){return-Infinity}if(t){e=u(e,t)}if(e.replace){if(r){e=e.replace(r,"")}if(n){e=e.replace(n,"")}}return e*1};function zt(r){j.each({num:function(e){return Vt(e,r)},"num-fmt":function(e){return Vt(e,r,s)},"html-num":function(e){return Vt(e,r,i)},"html-num-fmt":function(e){return Vt(e,r,i,s)}},function(e,t){v.type.order[e+r+"-pre"]=t;if(e.match(/^html\-/)){v.type.search[e+r]=v.type.search.html}})}j.extend(v.type.order,{"date-pre":function(e){var t=Date.parse(e);return isNaN(t)?-Infinity:t},"html-pre":function(e){return l(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return l(e)?"":typeof e==="string"?e.toLowerCase():!e.toString?"":e.toString()},"string-asc":function(e,t){return e<t?-1:e>t?1:0},"string-desc":function(e,t){return e<t?1:e>t?-1:0}});zt("");j.extend(true,A.ext.renderer,{header:{_:function(a,o,s,l){j(a.nTable).on("order.dt.DT",function(e,t,r,n){if(a!==t){return}var i=s.idx;o.removeClass(l.sSortAsc+" "+l.sSortDesc).addClass(n[i]=="asc"?l.sSortAsc:n[i]=="desc"?l.sSortDesc:s.sSortingClass)})},jqueryui:function(a,o,s,l){j("<div/>").addClass(l.sSortJUIWrapper).append(o.contents()).append(j("<span/>").addClass(l.sSortIcon+" "+s.sSortingClassJUI)).appendTo(o);j(a.nTable).on("order.dt.DT",function(e,t,r,n){if(a!==t){return}var i=s.idx;o.removeClass(l.sSortAsc+" "+l.sSortDesc).addClass(n[i]=="asc"?l.sSortAsc:n[i]=="desc"?l.sSortDesc:s.sSortingClass);o.find("span."+l.sSortIcon).removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed).addClass(n[i]=="asc"?l.sSortJUIAsc:n[i]=="desc"?l.sSortJUIDesc:s.sSortingClassJUI)})}}});var qt=function(e){return typeof e==="string"?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e};A.render={number:function(a,o,s,l,u){return{display:function(e){if(typeof e!=="number"&&typeof e!=="string"){return e}var t=e<0?"-":"";var r=parseFloat(e);if(isNaN(r)){return qt(e)}r=r.toFixed(s);e=Math.abs(r);var n=parseInt(e,10);var i=s?o+(e-n).toFixed(s).substring(2):"";return t+(l||"")+n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+i+(u||"")}}},text:function(){return{display:qt,filter:qt}}};function Yt(t){return function(){var e=[ft(this[A.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return A.ext.internal[t].apply(this,e)}}j.extend(A.ext.internal,{_fnExternApiFunc:Yt,_fnBuildAjax:me,_fnAjaxUpdate:ye,_fnAjaxParameters:be,_fnAjaxUpdateDraw:we,_fnAjaxDataSrc:Ce,_fnAddColumn:B,_fnColumnOptions:H,_fnAdjustColumnSizing:q,_fnVisibleToColumnIndex:Y,_fnColumnIndexToVisible:x,_fnVisbleColumns:O,_fnGetColumns:$,_fnColumnTypes:D,_fnApplyColumnDefs:W,_fnHungarianMap:k,_fnCamelToHungarian:N,_fnLanguageCompat:M,_fnBrowserDetect:F,_fnAddData:U,_fnAddTr:G,_fnNodeToDataIndex:R,_fnNodeToColumnIndex:X,_fnGetCellData:K,_fnSetCellData:J,_fnSplitObjNotation:ee,_fnGetObjectDataFn:te,_fnSetObjectDataFn:re,_fnGetDataMaster:ne,_fnClearTable:ie,_fnDeleteIndex:ae,_fnInvalidate:oe,_fnGetRowElements:se,_fnCreateTr:le,_fnBuildHead:fe,_fnDrawHead:ce,_fnDraw:de,_fnReDraw:he,_fnAddOptionsHtml:ve,_fnDetectHeader:pe,_fnGetUniqueThs:ge,_fnFeatureHtmlFilter:Se,_fnFilterComplete:Ee,_fnFilterCustom:ke,_fnFilterColumn:Te,_fnFilter:_e,_fnFilterCreateSearch:xe,_fnEscapeRegex:De,_fnFilterData:Oe,_fnFeatureHtmlInfo:Me,_fnUpdateInfo:Le,_fnInfoMacros:Pe,_fnInitialise:Fe,_fnInitComplete:Be,_fnLengthChange:He,_fnFeatureHtmlLength:$e,_fnFeatureHtmlPaginate:We,_fnPageChange:Ue,_fnFeatureHtmlProcessing:je,_fnProcessingDisplay:Ve,_fnFeatureHtmlTable:ze,_fnScrollDraw:qe,_fnApplyToChildren:Ye,_fnCalculateColumnWidths:Xe,_fnThrottle:Ke,_fnConvertToWidth:Je,_fnGetWidestNode:Qe,_fnGetMaxLenString:Ze,_fnStringToCss:et,_fnSortFlatten:tt,_fnSort:rt,_fnSortAria:nt,_fnSortListener:it,_fnSortAttachListener:at,_fnSortingClasses:ot,_fnSortData:st,_fnSaveState:lt,_fnLoadState:ut,_fnSettingsFromNode:ft,_fnLog:ct,_fnMap:dt,_fnBindAction:vt,_fnCallbackReg:pt,_fnCallbackFire:gt,_fnLengthOverflow:mt,_fnRenderer:yt,_fnDataSource:bt,_fnRowAttributes:ue,_fnExtend:ht,_fnCalculateEnd:function(){}});j.fn.dataTable=A;A.$=j;j.fn.dataTableSettings=A.settings;j.fn.dataTableExt=A.ext;j.fn.DataTable=function(e){return j(this).dataTable(e).api()};j.each(A,function(e,t){j.fn.DataTable[e]=t});return j.fn.dataTable});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(T,c,d,_){"use strict";var a=T.fn.dataTable;var t;var h=function(e,t){var r=this;if(!(this instanceof h)){alert("FixedColumns warning: FixedColumns must be initialised with the 'new' keyword.");return}if(t===_||t===true){t={}}var n=T.fn.dataTable.camelToHungarian;if(n){n(h.defaults,h.defaults,true);n(h.defaults,t)}var i=new T.fn.dataTable.Api(e).settings()[0];this.s={dt:i,iTableColumns:i.aoColumns.length,aiOuterWidths:[],aiInnerWidths:[],rtl:T(i.nTable).css("direction")==="rtl"};this.dom={scroller:null,header:null,body:null,footer:null,grid:{wrapper:null,dt:null,left:{wrapper:null,head:null,body:null,foot:null},right:{wrapper:null,head:null,body:null,foot:null}},clone:{left:{header:null,body:null,footer:null},right:{header:null,body:null,footer:null}}};if(i._oFixedColumns){throw"FixedColumns already initialised on this table"}i._oFixedColumns=this;if(!i._bInitComplete){i.oApi._fnCallbackReg(i,"aoInitComplete",function(){r._fnConstruct(t)},"FixedColumns")}else{this._fnConstruct(t)}};T.extend(h.prototype,{fnUpdate:function(){this._fnDraw(true)},fnRedrawLayout:function(){this._fnColCalc();this._fnGridLayout();this.fnUpdate()},fnRecalculateHeight:function(e){delete e._DTTC_iHeight;e.style.height="auto"},fnSetRowHeight:function(e,t){e.style.height=t+"px"},fnGetPosition:function(e){var t;var r=this.s.dt.oInstance;if(!T(e).parents(".DTFC_Cloned").length){return r.fnGetPosition(e)}else{if(e.nodeName.toLowerCase()==="tr"){t=T(e).index();return r.fnGetPosition(T("tr",this.s.dt.nTBody)[t])}else{var n=T(e).index();t=T(e.parentNode).index();var i=r.fnGetPosition(T("tr",this.s.dt.nTBody)[t]);return[i,n,r.oApi._fnVisibleToColumnIndex(this.s.dt,n)]}}},fnToFixedNode:function(e,t){var r;if(t<this.s.iLeftColumns){r=T(this.dom.clone.left.body).find("[data-dt-row="+e+"][data-dt-column="+t+"]")}else if(t>=this.s.iRightColumns){r=T(this.dom.clone.right.body).find("[data-dt-row="+e+"][data-dt-column="+t+"]")}if(r&&r.length){return r[0]}var n=new T.fn.dataTable.Api(this.s.dt);return n.cell(e,t).node()},_fnConstruct:function(e){var t,r,n,a=this;if(typeof this.s.dt.oInstance.fnVersionCheck!="function"||this.s.dt.oInstance.fnVersionCheck("1.8.0")!==true){alert("FixedColumns "+h.VERSION+" required DataTables 1.8.0 or later. "+"Please upgrade your DataTables installation");return}if(this.s.dt.oScroll.sX===""){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"FixedColumns is not needed (no "+"x-scrolling in DataTables enabled), so no action will be taken. Use 'FixedHeader' for "+"column fixing when scrolling is not enabled");return}this.s=T.extend(true,this.s,h.defaults,e);var i=this.s.dt.oClasses;this.dom.grid.dt=T(this.s.dt.nTable).parents("div."+i.sScrollWrapper)[0];this.dom.scroller=T("div."+i.sScrollBody,this.dom.grid.dt)[0];this._fnColCalc();this._fnGridSetup();var o;var s=false;T(this.s.dt.nTableWrapper).on("mousedown.DTFC",function(e){if(e.button===0){s=true;T(d).one("mouseup",function(){s=false})}});T(this.dom.scroller).on("mouseover.DTFC touchstart.DTFC",function(){if(!s){o="main"}}).on("scroll.DTFC",function(e){if(!o&&e.originalEvent){o="main"}if(o==="main"||o==="key"){if(a.s.iLeftColumns>0){a.dom.grid.left.liner.scrollTop=a.dom.scroller.scrollTop}if(a.s.iRightColumns>0){a.dom.grid.right.liner.scrollTop=a.dom.scroller.scrollTop}}});var l="onwheel"in d.createElement("div")?"wheel.DTFC":"mousewheel.DTFC";if(a.s.iLeftColumns>0){T(a.dom.grid.left.liner).on("mouseover.DTFC touchstart.DTFC",function(){if(!s&&o!=="key"){o="left"}}).on("scroll.DTFC",function(e){if(!o&&e.originalEvent){o="left"}if(o==="left"){a.dom.scroller.scrollTop=a.dom.grid.left.liner.scrollTop;if(a.s.iRightColumns>0){a.dom.grid.right.liner.scrollTop=a.dom.grid.left.liner.scrollTop}}}).on(l,function(e){o="left";var t=e.type==="wheel"?-e.originalEvent.deltaX:e.originalEvent.wheelDeltaX;a.dom.scroller.scrollLeft-=t});T(a.dom.grid.left.head).on("mouseover.DTFC touchstart.DTFC",function(){o="main"})}if(a.s.iRightColumns>0){T(a.dom.grid.right.liner).on("mouseover.DTFC touchstart.DTFC",function(){if(!s&&o!=="key"){o="right"}}).on("scroll.DTFC",function(e){if(!o&&e.originalEvent){o="right"}if(o==="right"){a.dom.scroller.scrollTop=a.dom.grid.right.liner.scrollTop;if(a.s.iLeftColumns>0){a.dom.grid.left.liner.scrollTop=a.dom.grid.right.liner.scrollTop}}}).on(l,function(e){o="right";var t=e.type==="wheel"?-e.originalEvent.deltaX:e.originalEvent.wheelDeltaX;a.dom.scroller.scrollLeft-=t});T(a.dom.grid.right.head).on("mouseover.DTFC touchstart.DTFC",function(){o="main"})}T(c).on("resize.DTFC",function(){a._fnGridLayout.call(a)});var u=true;var f=T(this.s.dt.nTable);f.on("draw.dt.DTFC",function(){a._fnColCalc();a._fnDraw.call(a,u);u=false}).on("key-focus.dt.DTFC",function(){o="key"}).on("column-sizing.dt.DTFC",function(){a._fnColCalc();a._fnGridLayout(a)}).on("column-visibility.dt.DTFC",function(e,t,r,n,i){if(i===_||i){a._fnColCalc();a._fnGridLayout(a);a._fnDraw(true)}}).on("select.dt.DTFC deselect.dt.DTFC",function(e,t,r,n){if(e.namespace==="dt"){a._fnDraw(false)}}).on("position.dts.dt.DTFC",function(e,t){if(a.dom.grid.left.body){T(a.dom.grid.left.body).find("table").eq(0).css("top",t)}if(a.dom.grid.right.body){T(a.dom.grid.right.body).find("table").eq(0).css("top",t)}}).on("destroy.dt.DTFC",function(){f.off(".DTFC");T(a.dom.scroller).off(".DTFC");T(c).off(".DTFC");T(a.s.dt.nTableWrapper).off(".DTFC");T(a.dom.grid.left.liner).off(".DTFC "+l);T(a.dom.grid.left.wrapper).remove();T(a.dom.grid.right.liner).off(".DTFC "+l);T(a.dom.grid.right.wrapper).remove()});this._fnGridLayout();this.s.dt.oInstance.fnDraw(false)},_fnColCalc:function(){var a=this;var o=0;var s=0;this.s.aiInnerWidths=[];this.s.aiOuterWidths=[];T.each(this.s.dt.aoColumns,function(e,t){var r=T(t.nTh);var n;if(!r.filter(":visible").length){a.s.aiInnerWidths.push(0);a.s.aiOuterWidths.push(0)}else{var i=r.outerWidth();if(a.s.aiOuterWidths.length===0){n=T(a.s.dt.nTable).css("border-left-width");i+=typeof n==="string"&&n.indexOf("px")===-1?1:parseInt(n,10)}if(a.s.aiOuterWidths.length===a.s.dt.aoColumns.length-1){n=T(a.s.dt.nTable).css("border-right-width");i+=typeof n==="string"&&n.indexOf("px")===-1?1:parseInt(n,10)}a.s.aiOuterWidths.push(i);a.s.aiInnerWidths.push(r.width());if(e<a.s.iLeftColumns){o+=i}if(a.s.iTableColumns-a.s.iRightColumns<=e){s+=i}}});this.s.iLeftWidth=o;this.s.iRightWidth=s},_fnGridSetup:function(){var e=this;var t=this._fnDTOverflow();var r;this.dom.body=this.s.dt.nTable;this.dom.header=this.s.dt.nTHead.parentNode;this.dom.header.parentNode.parentNode.style.position="relative";var n=T('<div class="DTFC_ScrollWrapper" style="position:relative; clear:both;">'+'<div class="DTFC_LeftWrapper" style="position:absolute; top:0; left:0;" aria-hidden="true">'+'<div class="DTFC_LeftHeadWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div>'+'<div class="DTFC_LeftBodyWrapper" style="position:relative; top:0; left:0; height:0; overflow:hidden;">'+'<div class="DTFC_LeftBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div>'+"</div>"+'<div class="DTFC_LeftFootWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div>'+"</div>"+'<div class="DTFC_RightWrapper" style="position:absolute; top:0; right:0;" aria-hidden="true">'+'<div class="DTFC_RightHeadWrapper" style="position:relative; top:0; left:0;">'+'<div class="DTFC_RightHeadBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div>'+"</div>"+'<div class="DTFC_RightBodyWrapper" style="position:relative; top:0; left:0; height:0; overflow:hidden;">'+'<div class="DTFC_RightBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div>'+"</div>"+'<div class="DTFC_RightFootWrapper" style="position:relative; top:0; left:0;">'+'<div class="DTFC_RightFootBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div>'+"</div>"+"</div>"+"</div>")[0];var i=n.childNodes[0];var a=n.childNodes[1];this.dom.grid.dt.parentNode.insertBefore(n,this.dom.grid.dt);n.appendChild(this.dom.grid.dt);this.dom.grid.wrapper=n;if(this.s.iLeftColumns>0){this.dom.grid.left.wrapper=i;this.dom.grid.left.head=i.childNodes[0];this.dom.grid.left.body=i.childNodes[1];this.dom.grid.left.liner=T("div.DTFC_LeftBodyLiner",n)[0];n.appendChild(i)}if(this.s.iRightColumns>0){this.dom.grid.right.wrapper=a;this.dom.grid.right.head=a.childNodes[0];this.dom.grid.right.body=a.childNodes[1];this.dom.grid.right.liner=T("div.DTFC_RightBodyLiner",n)[0];a.style.right=t.bar+"px";r=T("div.DTFC_RightHeadBlocker",n)[0];r.style.width=t.bar+"px";r.style.right=-t.bar+"px";this.dom.grid.right.headBlock=r;r=T("div.DTFC_RightFootBlocker",n)[0];r.style.width=t.bar+"px";r.style.right=-t.bar+"px";this.dom.grid.right.footBlock=r;n.appendChild(a)}if(this.s.dt.nTFoot){this.dom.footer=this.s.dt.nTFoot.parentNode;if(this.s.iLeftColumns>0){this.dom.grid.left.foot=i.childNodes[2]}if(this.s.iRightColumns>0){this.dom.grid.right.foot=a.childNodes[2]}}if(this.s.rtl){T("div.DTFC_RightHeadBlocker",n).css({left:-t.bar+"px",right:""})}},_fnGridLayout:function(){var r=this;var e=this.dom.grid;var t=T(e.wrapper).width();var n=this.s.dt.nTable.parentNode.offsetHeight;var i=this.s.dt.nTable.parentNode.parentNode.offsetHeight;var a=this._fnDTOverflow();var o=this.s.iLeftWidth;var s=this.s.iRightWidth;var l=T(this.dom.body).css("direction")==="rtl";var u;var f=function(e,t){if(!a.bar){e.style.width=t+20+"px";e.style.paddingRight="20px";e.style.boxSizing="border-box"}else if(r._firefoxScrollError()){if(T(e).height()>34){e.style.width=t+a.bar+"px"}}else{e.style.width=t+a.bar+"px"}};if(a.x){n-=a.bar}e.wrapper.style.height=i+"px";if(this.s.iLeftColumns>0){u=e.left.wrapper;u.style.width=o+"px";u.style.height="1px";if(l){u.style.left="";u.style.right=0}else{u.style.left=0;u.style.right=""}e.left.body.style.height=n+"px";if(e.left.foot){e.left.foot.style.top=(a.x?a.bar:0)+"px"}f(e.left.liner,o);e.left.liner.style.height=n+"px";e.left.liner.style.maxHeight=n+"px"}if(this.s.iRightColumns>0){u=e.right.wrapper;u.style.width=s+"px";u.style.height="1px";if(this.s.rtl){u.style.left=a.y?a.bar+"px":0;u.style.right=""}else{u.style.left="";u.style.right=a.y?a.bar+"px":0}e.right.body.style.height=n+"px";if(e.right.foot){e.right.foot.style.top=(a.x?a.bar:0)+"px"}f(e.right.liner,s);e.right.liner.style.height=n+"px";e.right.liner.style.maxHeight=n+"px";e.right.headBlock.style.display=a.y?"block":"none";e.right.footBlock.style.display=a.y?"block":"none"}},_fnDTOverflow:function(){var e=this.s.dt.nTable;var t=e.parentNode;var r={x:false,y:false,bar:this.s.dt.oScroll.iBarWidth};if(e.offsetWidth>t.clientWidth){r.x=true}if(e.offsetHeight>t.clientHeight){r.y=true}return r},_fnDraw:function(e){this._fnGridLayout();this._fnCloneLeft(e);this._fnCloneRight(e);T(this.dom.scroller).trigger("scroll");if(this.s.fnDrawCallback!==null){this.s.fnDrawCallback.call(this,this.dom.clone.left,this.dom.clone.right)}T(this).trigger("draw.dtfc",{leftClone:this.dom.clone.left,rightClone:this.dom.clone.right})},_fnCloneRight:function(e){if(this.s.iRightColumns<=0){return}var t=this,r,n,i=[];for(r=this.s.iTableColumns-this.s.iRightColumns;r<this.s.iTableColumns;r++){if(this.s.dt.aoColumns[r].bVisible){i.push(r)}}this._fnClone(this.dom.clone.right,this.dom.grid.right,i,e)},_fnCloneLeft:function(e){if(this.s.iLeftColumns<=0){return}var t=this,r,n,i=[];for(r=0;r<this.s.iLeftColumns;r++){if(this.s.dt.aoColumns[r].bVisible){i.push(r)}}this._fnClone(this.dom.clone.left,this.dom.grid.left,i,e)},_fnCopyLayout:function(e,t,r){var n=[];var i=[];var a=[];for(var o=0,s=e.length;o<s;o++){var l=[];l.nTr=T(e[o].nTr).clone(r,false)[0];for(var u=0,f=this.s.iTableColumns;u<f;u++){if(T.inArray(u,t)===-1){continue}var c=T.inArray(e[o][u].cell,a);if(c===-1){var d=T(e[o][u].cell).clone(r,false)[0];i.push(d);a.push(e[o][u].cell);l.push({cell:d,unique:e[o][u].unique})}else{l.push({cell:i[c],unique:e[o][u].unique})}}n.push(l)}return n},_fnClone:function(e,t,i,r){var a=this,n,o,s,l,u,f,c,d,h,v,p,g,m=this.s.dt;if(r){T(e.header).remove();e.header=T(this.dom.header).clone(true,false)[0];e.header.className+=" DTFC_Cloned";e.header.style.width="100%";t.head.appendChild(e.header);v=this._fnCopyLayout(m.aoHeader,i,true);p=T(">thead",e.header);p.empty();for(n=0,o=v.length;n<o;n++){p[0].appendChild(v[n].nTr)}m.oApi._fnDrawHead(m,v,true)}else{v=this._fnCopyLayout(m.aoHeader,i,false);g=[];m.oApi._fnDetectHeader(g,T(">thead",e.header)[0]);for(n=0,o=v.length;n<o;n++){for(s=0,l=v[n].length;s<l;s++){g[n][s].cell.className=v[n][s].cell.className;T("span.DataTables_sort_icon",g[n][s].cell).each(function(){this.className=T("span.DataTables_sort_icon",v[n][s].cell)[0].className})}}}this._fnEqualiseHeights("thead",this.dom.header,e.header);if(this.s.sHeightMatch=="auto"){T(">tbody>tr",a.dom.body).css("height","auto")}if(e.body!==null){T(e.body).remove();e.body=null}e.body=T(this.dom.body).clone(true)[0];e.body.className+=" DTFC_Cloned";e.body.style.paddingBottom=m.oScroll.iBarWidth+"px";e.body.style.marginBottom=m.oScroll.iBarWidth*2+"px";if(e.body.getAttribute("id")!==null){e.body.removeAttribute("id")}T(">thead>tr",e.body).empty();T(">tfoot",e.body).remove();var y=T("tbody",e.body)[0];T(y).empty();if(m.aiDisplay.length>0){var b=T(">thead>tr",e.body)[0];for(h=0;h<i.length;h++){c=i[h];d=T(m.aoColumns[c].nTh).clone(true)[0];d.innerHTML="";var w=d.style;w.paddingTop="0";w.paddingBottom="0";w.borderTopWidth="0";w.borderBottomWidth="0";w.height=0;w.width=a.s.aiInnerWidths[c]+"px";b.appendChild(d)}T(">tbody>tr",a.dom.body).each(function(e){var t=a.s.dt.oFeatures.bServerSide===false?a.s.dt.aiDisplay[a.s.dt._iDisplayStart+e]:e;var r=a.s.dt.aoData[t].anCells||T(this).children("td, th");var n=this.cloneNode(false);n.removeAttribute("id");n.setAttribute("data-dt-row",t);for(h=0;h<i.length;h++){c=i[h];if(r.length>0){d=T(r[c]).clone(true,true)[0];d.removeAttribute("id");d.setAttribute("data-dt-row",t);d.setAttribute("data-dt-column",c);n.appendChild(d)}}y.appendChild(n)})}else{T(">tbody>tr",a.dom.body).each(function(e){d=this.cloneNode(true);d.className+=" DTFC_NoData";T("td",d).html("");y.appendChild(d)})}e.body.style.width="100%";e.body.style.margin="0";e.body.style.padding="0";if(m.oScroller!==_){var C=m.oScroller.dom.force;if(!t.forcer){t.forcer=C.cloneNode(true);t.liner.appendChild(t.forcer)}else{t.forcer.style.height=C.style.height}}t.liner.appendChild(e.body);this._fnEqualiseHeights("tbody",a.dom.body,e.body);if(m.nTFoot!==null){if(r){if(e.footer!==null){e.footer.parentNode.removeChild(e.footer)}e.footer=T(this.dom.footer).clone(true,true)[0];e.footer.className+=" DTFC_Cloned";e.footer.style.width="100%";t.foot.appendChild(e.footer);v=this._fnCopyLayout(m.aoFooter,i,true);var S=T(">tfoot",e.footer);S.empty();for(n=0,o=v.length;n<o;n++){S[0].appendChild(v[n].nTr)}m.oApi._fnDrawHead(m,v,true)}else{v=this._fnCopyLayout(m.aoFooter,i,false);var E=[];m.oApi._fnDetectHeader(E,T(">tfoot",e.footer)[0]);for(n=0,o=v.length;n<o;n++){for(s=0,l=v[n].length;s<l;s++){E[n][s].cell.className=v[n][s].cell.className}}}this._fnEqualiseHeights("tfoot",this.dom.footer,e.footer)}var k=m.oApi._fnGetUniqueThs(m,T(">thead",e.header)[0]);T(k).each(function(e){c=i[e];this.style.width=a.s.aiInnerWidths[c]+"px"});if(a.s.dt.nTFoot!==null){k=m.oApi._fnGetUniqueThs(m,T(">tfoot",e.footer)[0]);T(k).each(function(e){c=i[e];this.style.width=a.s.aiInnerWidths[c]+"px"})}},_fnGetTrNodes:function(e){var t=[];for(var r=0,n=e.childNodes.length;r<n;r++){if(e.childNodes[r].nodeName.toUpperCase()=="TR"){t.push(e.childNodes[r])}}return t},_fnEqualiseHeights:function(e,t,r){if(this.s.sHeightMatch=="none"&&e!=="thead"&&e!=="tfoot"){return}var n=this,i,a,o,s,l,u,f=t.getElementsByTagName(e)[0],c=r.getElementsByTagName(e)[0],d=T(">"+e+">tr:eq(0)",t).children(":first"),h=d.outerHeight()-d.height(),v=this._fnGetTrNodes(f),p=this._fnGetTrNodes(c),g=[];for(i=0,a=p.length;i<a;i++){l=v[i].offsetHeight;u=p[i].offsetHeight;o=u>l?u:l;if(this.s.sHeightMatch=="semiauto"){v[i]._DTTC_iHeight=o}g.push(o)}for(i=0,a=p.length;i<a;i++){p[i].style.height=g[i]+"px";v[i].style.height=g[i]+"px"}},_firefoxScrollError:function(){if(t===_){var e=T("<div/>").css({position:"absolute",top:0,left:0,height:10,width:50,overflow:"scroll"}).appendTo("body");t=e[0].clientWidth===e[0].offsetWidth&&this._fnDTOverflow().bar!==0;e.remove()}return t}});h.defaults={iLeftColumns:1,iRightColumns:0,fnDrawCallback:null,sHeightMatch:"semiauto"};h.version="3.3.2";a.Api.register("fixedColumns()",function(){return this});a.Api.register("fixedColumns().update()",function(){return this.iterator("table",function(e){if(e._oFixedColumns){e._oFixedColumns.fnUpdate()}})});a.Api.register("fixedColumns().relayout()",function(){return this.iterator("table",function(e){if(e._oFixedColumns){e._oFixedColumns.fnRedrawLayout()}})});a.Api.register("rows().recalcHeight()",function(){return this.iterator("row",function(e,t){if(e._oFixedColumns){e._oFixedColumns.fnRecalculateHeight(this.row(t).node())}})});a.Api.register("fixedColumns().rowIndex()",function(e){e=T(e);return e.parents(".DTFC_Cloned").length?this.rows({page:"current"}).indexes()[e.index()]:this.row(e).index()});a.Api.register("fixedColumns().cellIndex()",function(e){e=T(e);if(e.parents(".DTFC_Cloned").length){var t=e.parent().index();var r=this.rows({page:"current"}).indexes()[t];var n;if(e.parents(".DTFC_LeftWrapper").length){n=e.index()}else{var i=this.columns().flatten().length;n=i-this.context[0]._oFixedColumns.s.iRightColumns+e.index()}return{row:r,column:this.column.index("toData",n),columnVisible:n}}else{return this.cell(e).index()}});a.Api.registerPlural("cells().fixedNodes()","cell().fixedNode()",function(){return this.iterator("cell",function(e,t,r){return e._oFixedColumns?e._oFixedColumns.fnToFixedNode(t,r):this.cell(t,r).node()},1)});T(d).on("init.dt.fixedColumns",function(e,t){if(e.namespace!=="dt"){return}var r=t.oInit.fixedColumns;var n=a.defaults.fixedColumns;if(r||n){var i=T.extend({},r,n);if(r!==false){new h(t,i)}}});T.fn.dataTable.FixedColumns=h;T.fn.DataTable.FixedColumns=h;return h});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(u,i,f,a){"use strict";var o=u.fn.dataTable;var n=0;var s=function(e,t){if(!(this instanceof s)){throw"FixedHeader must be initialised with the 'new' keyword."}if(t===true){t={}}e=new o.Api(e);this.c=u.extend(true,{},s.defaults,t);this.s={dt:e,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:u(i).height(),visible:true},headerMode:null,footerMode:null,autoWidth:e.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+n++,scrollLeft:{header:-1,footer:-1},enable:true};this.dom={floatingHeader:null,thead:u(e.table().header()),tbody:u(e.table().body()),tfoot:u(e.table().footer()),header:{host:null,floating:null,placeholder:null},footer:{host:null,floating:null,placeholder:null}};this.dom.header.host=this.dom.thead.parent();this.dom.footer.host=this.dom.tfoot.parent();var r=e.settings()[0];if(r._fixedHeader){throw"FixedHeader already initialised on table "+r.nTable.id}r._fixedHeader=this;this._constructor()};u.extend(s.prototype,{destroy:function(){this.s.dt.off(".dtfc");u(i).off(this.s.namespace);if(this.c.header){this._modeChange("in-place","header",true)}if(this.c.footer&&this.dom.tfoot.length){this._modeChange("in-place","footer",true)}},enable:function(e,t){this.s.enable=e;if(t||t===a){this._positions();this._scroll(true)}},enabled:function(){return this.s.enable},headerOffset:function(e){if(e!==a){this.c.headerOffset=e;this.update()}return this.c.headerOffset},footerOffset:function(e){if(e!==a){this.c.footerOffset=e;this.update()}return this.c.footerOffset},update:function(){var e=this.s.dt.table().node();if(u(e).is(":visible")){this.enable(true,false)}else{this.enable(false,false)}this._positions();this._scroll(true)},_constructor:function(){var e=this;var t=this.s.dt;u(i).on("scroll"+this.s.namespace,function(){e._scroll()}).on("resize"+this.s.namespace,o.util.throttle(function(){e.s.position.windowHeight=u(i).height();e.update()},50));var r=u(".fh-fixedHeader");if(!this.c.headerOffset&&r.length){this.c.headerOffset=r.outerHeight()}var n=u(".fh-fixedFooter");if(!this.c.footerOffset&&n.length){this.c.footerOffset=n.outerHeight()}t.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc column-sizing.dt.dtfc responsive-display.dt.dtfc",function(){e.update()});t.on("destroy.dtfc",function(){e.destroy()});this._positions();this._scroll()},_clone:function(e,t){var r=this.s.dt;var n=this.dom[e];var i=e==="header"?this.dom.thead:this.dom.tfoot;if(!t&&n.floating){n.floating.removeClass("fixedHeader-floating fixedHeader-locked")}else{if(n.floating){n.placeholder.remove();this._unsize(e);n.floating.children().detach();n.floating.remove()}n.floating=u(r.table().node().cloneNode(false)).css("table-layout","fixed").attr("aria-hidden","true").removeAttr("id").append(i).appendTo("body");n.placeholder=i.clone(false);n.placeholder.find("*[id]").removeAttr("id");n.host.prepend(n.placeholder);this._matchWidths(n.placeholder,n.floating)}},_matchWidths:function(t,r){var e=function(e){return u(e,t).map(function(){return u(this).css("width").replace(/[^\d\.]/g,"")*1}).toArray()};var n=function(e,t){u(e,r).each(function(e){u(this).css({width:t[e],minWidth:t[e]})})};var i=e("th");var a=e("td");n("th",i);n("td",a)},_unsize:function(e){var t=this.dom[e].floating;if(t&&(e==="footer"||e==="header"&&!this.s.autoWidth)){u("th, td",t).css({width:"",minWidth:""})}else if(t&&e==="header"){u("th, td",t).css("min-width","")}},_horizontal:function(e,t){var r=this.dom[e];var n=this.s.position;var i=this.s.scrollLeft;if(r.floating&&i[e]!==t){r.floating.css("left",n.left-t);i[e]=t}},_modeChange:function(e,t,r){var n=this.s.dt;var i=this.dom[t];var a=this.s.position;var o=function(r){i.floating.attr("style",function(e,t){return(t||"")+"width: "+r+"px !important;"})};var s=this.dom[t==="footer"?"tfoot":"thead"];var l=u.contains(s[0],f.activeElement)?f.activeElement:null;if(l){l.blur()}if(e==="in-place"){if(i.placeholder){i.placeholder.remove();i.placeholder=null}this._unsize(t);if(t==="header"){i.host.prepend(s)}else{i.host.append(s)}if(i.floating){i.floating.remove();i.floating=null}}else if(e==="in"){this._clone(t,r);i.floating.addClass("fixedHeader-floating").css(t==="header"?"top":"bottom",this.c[t+"Offset"]).css("left",a.left+"px");o(a.width);if(t==="footer"){i.floating.css("top","")}}else if(e==="below"){this._clone(t,r);i.floating.addClass("fixedHeader-locked").css("top",a.tfootTop-a.theadHeight).css("left",a.left+"px");o(a.width)}else if(e==="above"){this._clone(t,r);i.floating.addClass("fixedHeader-locked").css("top",a.tbodyTop).css("left",a.left+"px");o(a.width)}if(l&&l!==f.activeElement){setTimeout(function(){l.focus()},10)}this.s.scrollLeft.header=-1;this.s.scrollLeft.footer=-1;this.s[t+"Mode"]=e},_positions:function(){var e=this.s.dt;var t=e.table();var r=this.s.position;var n=this.dom;var i=u(t.node());var a=i.children("thead");var o=i.children("tfoot");var s=n.tbody;r.visible=i.is(":visible");r.width=i.outerWidth();r.left=i.offset().left;r.theadTop=a.offset().top;r.tbodyTop=s.offset().top;r.tbodyHeight=s.outerHeight();r.theadHeight=r.tbodyTop-r.theadTop;if(o.length){r.tfootTop=o.offset().top;r.tfootBottom=r.tfootTop+o.outerHeight();r.tfootHeight=r.tfootBottom-r.tfootTop}else{r.tfootTop=r.tbodyTop+s.outerHeight();r.tfootBottom=r.tfootTop;r.tfootHeight=r.tfootTop}},_scroll:function(e){var t=u(f).scrollTop();var r=u(f).scrollLeft();var n=this.s.position;var i,a;if(this.c.header){if(!this.s.enable){i="in-place"}else if(!n.visible||t<=n.theadTop-this.c.headerOffset){i="in-place"}else if(t<=n.tfootTop-n.theadHeight-this.c.headerOffset){i="in"}else{i="below"}if(e||i!==this.s.headerMode){this._modeChange(i,"header",e)}this._horizontal("header",r)}if(this.c.footer&&this.dom.tfoot.length){if(!this.s.enable){a="in-place"}else if(!n.visible||t+n.windowHeight>=n.tfootBottom+this.c.footerOffset){a="in-place"}else if(n.windowHeight+t>n.tbodyTop+n.tfootHeight+this.c.footerOffset){a="in"}else{a="above"}if(e||a!==this.s.footerMode){this._modeChange(a,"footer",e)}this._horizontal("footer",r)}}});s.version="3.1.8";s.defaults={header:true,footer:false,headerOffset:0,footerOffset:0};u.fn.dataTable.FixedHeader=s;u.fn.DataTable.FixedHeader=s;u(f).on("init.dt.dtfh",function(e,t,r){if(e.namespace!=="dt"){return}var n=t.oInit.fixedHeader;var i=o.defaults.fixedHeader;if((n||i)&&!t._fixedHeader){var a=u.extend({},i,n);if(n!==false){new s(t,a)}}});o.Api.register("fixedHeader()",function(){});o.Api.register("fixedHeader.adjust()",function(){return this.iterator("table",function(e){var t=e._fixedHeader;if(t){t.update()}})});o.Api.register("fixedHeader.enable()",function(r){return this.iterator("table",function(e){var t=e._fixedHeader;r=r!==a?r:true;if(t&&r!==t.enabled()){t.enable(r)}})});o.Api.register("fixedHeader.enabled()",function(){if(this.context.length){var e=this.context[0]._fixedHeader;if(e){return e.enabled()}}return false});o.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(e){var t=e._fixedHeader;if(t&&t.enabled()){t.enable(false)}})});u.each(["header","footer"],function(e,n){o.Api.register("fixedHeader."+n+"Offset()",function(r){var e=this.context;if(r===a){return e.length&&e[0]._fixedHeader?e[0]._fixedHeader[n+"Offset"]():a}return this.iterator("table",function(e){var t=e._fixedHeader;if(t){t[n+"Offset"](r)}})})});return s});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(p,v,o,h){"use strict";var a=p.fn.dataTable;var i=function(e,t){if(!a.versionCheck||!a.versionCheck("1.10.10")){throw"DataTables Responsive requires DataTables 1.10.10 or newer"}this.s={dt:new a.Api(e),columns:[],current:[]};if(this.s.dt.settings()[0].responsive){return}if(t&&typeof t.details==="string"){t.details={type:t.details}}else if(t&&t.details===false){t.details={type:false}}else if(t&&t.details===true){t.details={type:"inline"}}this.c=p.extend(true,{},i.defaults,a.defaults.responsive,t);e.responsive=this;this._constructor()};p.extend(i.prototype,{_constructor:function(){var n=this;var i=this.s.dt;var e=i.settings()[0];var t=p(v).innerWidth();i.settings()[0]._responsive=this;p(v).on("resize.dtr orientationchange.dtr",a.util.throttle(function(){var e=p(v).innerWidth();if(e!==t){n._resize();t=e}}));e.oApi._fnCallbackReg(e,"aoRowCreatedCallback",function(e,t,r){if(p.inArray(false,n.s.current)!==-1){p(">td, >th",e).each(function(e){var t=i.column.index("toData",e);if(n.s.current[t]===false){p(this).css("display","none")}})}});i.on("destroy.dtr",function(){i.off(".dtr");p(i.table().body()).off(".dtr");p(v).off("resize.dtr orientationchange.dtr");i.cells(".dtr-control").nodes().to$().removeClass("dtr-control");p.each(n.s.current,function(e,t){if(t===false){n._setColumnVis(e,true)}})});this.c.breakpoints.sort(function(e,t){return e.width<t.width?1:e.width>t.width?-1:0});this._classLogic();this._resizeAuto();var r=this.c.details;if(r.type!==false){n._detailsInit();i.on("column-visibility.dtr",function(){if(n._timer){clearTimeout(n._timer)}n._timer=setTimeout(function(){n._timer=null;n._classLogic();n._resizeAuto();n._resize(true);n._redrawChildren()},100)});i.on("draw.dtr",function(){n._redrawChildren()});p(i.table().node()).addClass("dtr-"+r.type)}i.on("column-reorder.dtr",function(e,t,r){n._classLogic();n._resizeAuto();n._resize(true)});i.on("column-sizing.dtr",function(){n._resizeAuto();n._resize()});i.on("preXhr.dtr",function(){var e=[];i.rows().every(function(){if(this.child.isShown()){e.push(this.id(true))}});i.one("draw.dtr",function(){n._resizeAuto();n._resize();i.rows(e).every(function(){n._detailsDisplay(this,false)})})});i.on("draw.dtr",function(){n._controlClass()}).on("init.dtr",function(e,t,r){if(e.namespace!=="dt"){return}n._resizeAuto();n._resize();if(p.inArray(false,n.s.current)){i.columns.adjust()}});this._resize()},_columnsVisiblity:function(r){var n=this.s.dt;var e=this.s.columns;var t,i;var a=e.map(function(e,t){return{columnIdx:t,priority:e.priority}}).sort(function(e,t){if(e.priority!==t.priority){return e.priority-t.priority}return e.columnIdx-t.columnIdx});var o=p.map(e,function(e,t){if(n.column(t).visible()===false){return"not-visible"}return e.auto&&e.minWidth===null?false:e.auto===true?"-":p.inArray(r,e.includeIn)!==-1});var s=0;for(t=0,i=o.length;t<i;t++){if(o[t]===true){s+=e[t].minWidth}}var l=n.settings()[0].oScroll;var u=l.sY||l.sX?l.iBarWidth:0;var f=n.table().container().offsetWidth-u;var c=f-s;for(t=0,i=o.length;t<i;t++){if(e[t].control){c-=e[t].minWidth}}var d=false;for(t=0,i=a.length;t<i;t++){var h=a[t].columnIdx;if(o[h]==="-"&&!e[h].control&&e[h].minWidth){if(d||c-e[h].minWidth<0){d=true;o[h]=false}else{o[h]=true}c-=e[h].minWidth}}var v=false;for(t=0,i=e.length;t<i;t++){if(!e[t].control&&!e[t].never&&o[t]===false){v=true;break}}for(t=0,i=e.length;t<i;t++){if(e[t].control){o[t]=v}if(o[t]==="not-visible"){o[t]=false}}if(p.inArray(true,o)===-1){o[0]=true}return o},_classLogic:function(){var s=this;var e={};var l=this.c.breakpoints;var a=this.s.dt;var u=a.columns().eq(0).map(function(e){var t=this.column(e);var r=t.header().className;var n=a.settings()[0].aoColumns[e].responsivePriority;var i=t.header().getAttribute("data-priority");if(n===h){n=i===h||i===null?1e4:i*1}return{className:r,includeIn:[],auto:false,control:false,never:r.match(/\bnever\b/)?true:false,priority:n}});var f=function(e,t){var r=u[e].includeIn;if(p.inArray(t,r)===-1){r.push(t)}};var c=function(e,t,r,n){var i,a,o;if(!r){u[e].includeIn.push(t)}else if(r==="max-"){i=s._find(t).width;for(a=0,o=l.length;a<o;a++){if(l[a].width<=i){f(e,l[a].name)}}}else if(r==="min-"){i=s._find(t).width;for(a=0,o=l.length;a<o;a++){if(l[a].width>=i){f(e,l[a].name)}}}else if(r==="not-"){for(a=0,o=l.length;a<o;a++){if(l[a].name.indexOf(n)===-1){f(e,l[a].name)}}}};u.each(function(e,a){var t=e.className.split(" ");var o=false;for(var r=0,n=t.length;r<n;r++){var s=t[r].trim();if(s==="all"){o=true;e.includeIn=p.map(l,function(e){return e.name});return}else if(s==="none"||e.never){o=true;return}else if(s==="control"||s==="dtr-control"){o=true;e.control=true;return}p.each(l,function(e,t){var r=t.name.split("-");var n=new RegExp("(min\\-|max\\-|not\\-)?("+r[0]+")(\\-[_a-zA-Z0-9])?");var i=s.match(n);if(i){o=true;if(i[2]===r[0]&&i[3]==="-"+r[1]){c(a,t.name,i[1],i[2]+i[3])}else if(i[2]===r[0]&&!i[3]){c(a,t.name,i[1],i[2])}}})}if(!o){e.auto=true}});this.s.columns=u},_controlClass:function(){if(this.c.details.type==="inline"){var e=this.s.dt;var t=this.s.current;var r=p.inArray(true,t);e.cells(null,function(e){return e!==r},{page:"current"}).nodes().to$().filter(".dtr-control").removeClass("dtr-control");e.cells(null,r,{page:"current"}).nodes().to$().addClass("dtr-control")}},_detailsDisplay:function(e,t){var r=this;var n=this.s.dt;var i=this.c.details;if(i&&i.type!==false){var a=i.display(e,t,function(){return i.renderer(n,e[0],r._detailsObj(e[0]))});if(a===true||a===false){p(n.table().node()).triggerHandler("responsive-display.dt",[n,e,a,t])}}},_detailsInit:function(){var n=this;var i=this.s.dt;var e=this.c.details;if(e.type==="inline"){e.target="td.dtr-control, th.dtr-control"}i.on("draw.dtr",function(){n._tabIndexes()});n._tabIndexes();p(i.table().body()).on("keyup.dtr","td, th",function(e){if(e.keyCode===13&&p(this).data("dtr-keyboard")){p(this).click()}});var a=e.target;var t=typeof a==="string"?a:"td, th";if(a!==h||a!==null){p(i.table().body()).on("click.dtr mousedown.dtr mouseup.dtr",t,function(e){if(!p(i.table().node()).hasClass("collapsed")){return}if(p.inArray(p(this).closest("tr").get(0),i.rows().nodes().toArray())===-1){return}if(typeof a==="number"){var t=a<0?i.columns().eq(0).length+a:a;if(i.cell(this).index().column!==t){return}}var r=i.row(p(this).closest("tr"));if(e.type==="click"){n._detailsDisplay(r,false)}else if(e.type==="mousedown"){p(this).css("outline","none")}else if(e.type==="mouseup"){p(this).trigger("blur").css("outline","")}})}},_detailsObj:function(n){var i=this;var a=this.s.dt;return p.map(this.s.columns,function(e,t){if(e.never||e.control){return}var r=a.settings()[0].aoColumns[t];return{className:r.sClass,columnIndex:t,data:a.cell(n,t).render(i.c.orthogonal),hidden:a.column(t).visible()&&!i.s.current[t],rowIndex:n,title:r.sTitle!==null?r.sTitle:p(a.column(t).header()).text()}})},_find:function(e){var t=this.c.breakpoints;for(var r=0,n=t.length;r<n;r++){if(t[r].name===e){return t[r]}}},_redrawChildren:function(){var n=this;var i=this.s.dt;i.rows({page:"current"}).iterator("row",function(e,t){var r=i.row(t);n._detailsDisplay(i.row(t),true)})},_resize:function(r){var n=this;var e=this.s.dt;var t=p(v).innerWidth();var i=this.c.breakpoints;var a=i[0].name;var o=this.s.columns;var s,l;var u=this.s.current.slice();for(s=i.length-1;s>=0;s--){if(t<=i[s].width){a=i[s].name;break}}var f=this._columnsVisiblity(a);this.s.current=f;var c=false;for(s=0,l=o.length;s<l;s++){if(f[s]===false&&!o[s].never&&!o[s].control&&!e.column(s).visible()===false){c=true;break}}p(e.table().node()).toggleClass("collapsed",c);var d=false;var h=0;e.columns().eq(0).each(function(e,t){if(f[t]===true){h++}if(r||f[t]!==u[t]){d=true;n._setColumnVis(e,f[t])}});if(d){this._redrawChildren();p(e.table().node()).trigger("responsive-resize.dt",[e,this.s.current]);if(e.page.info().recordsDisplay===0){p("td",e.table().body()).eq(0).attr("colspan",h)}}n._controlClass()},_resizeAuto:function(){var r=this.s.dt;var n=this.s.columns;if(!this.c.auto){return}if(p.inArray(true,p.map(n,function(e){return e.auto}))===-1){return}if(!p.isEmptyObject(g)){p.each(g,function(e){var t=e.split("-");d(r,t[0]*1,t[1]*1)})}var e=r.table().node().offsetWidth;var t=r.columns;var i=r.table().node().cloneNode(false);var a=p(r.table().header().cloneNode(false)).appendTo(i);var o=p(r.table().body()).clone(false,false).empty().appendTo(i);i.style.width="auto";var s=r.columns().header().filter(function(e){return r.column(e).visible()}).to$().clone(false).css("display","table-cell").css("width","auto").css("min-width",0);p(o).append(p(r.rows({page:"current"}).nodes()).clone(false)).find("th, td").css("display","");var l=r.table().footer();if(l){var u=p(l.cloneNode(false)).appendTo(i);var f=r.columns().footer().filter(function(e){return r.column(e).visible()}).to$().clone(false).css("display","table-cell");p("<tr/>").append(f).appendTo(u)}p("<tr/>").append(s).appendTo(a);if(this.c.details.type==="inline"){p(i).addClass("dtr-inline collapsed")}p(i).find("[name]").removeAttr("name");p(i).css("position","relative");var c=p("<div/>").css({width:1,height:1,overflow:"hidden",clear:"both"}).append(i);c.insertBefore(r.table().node());s.each(function(e){var t=r.column.index("fromVisible",e);n[t].minWidth=this.offsetWidth||0});c.remove()},_responsiveOnlyHidden:function(){var r=this.s.dt;return p.map(this.s.current,function(e,t){if(r.column(t).visible()===false){return true}return e})},_setColumnVis:function(e,t){var r=this.s.dt;var n=t?"":"none";p(r.column(e).header()).css("display",n);p(r.column(e).footer()).css("display",n);r.column(e).nodes().to$().css("display",n);if(!p.isEmptyObject(g)){r.cells(null,e).indexes().each(function(e){d(r,e.row,e.column)})}},_tabIndexes:function(){var e=this.s.dt;var t=e.cells({page:"current"}).nodes().to$();var r=e.settings()[0];var n=this.c.details.target;t.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]");if(typeof n==="number"){e.cells(null,n,{page:"current"}).nodes().to$().attr("tabIndex",r.iTabIndex).data("dtr-keyboard",1)}else{if(n==="td:first-child, th:first-child"){n=">td:first-child, >th:first-child"}p(n,e.rows({page:"current"}).nodes()).attr("tabIndex",r.iTabIndex).data("dtr-keyboard",1)}}});i.breakpoints=[{name:"desktop",width:Infinity},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}];i.display={childRow:function(e,t,r){if(t){if(p(e.node()).hasClass("parent")){e.child(r(),"child").show();return true}}else{if(!e.child.isShown()){e.child(r(),"child").show();p(e.node()).addClass("parent");return true}else{e.child(false);p(e.node()).removeClass("parent");return false}}},childRowImmediate:function(e,t,r){if(!t&&e.child.isShown()||!e.responsive.hasHidden()){e.child(false);p(e.node()).removeClass("parent");return false}else{e.child(r(),"child").show();p(e.node()).addClass("parent");return true}},modal:function(a){return function(e,t,r){if(!t){var n=function(){i.remove();p(o).off("keypress.dtr")};var i=p('<div class="dtr-modal"/>').append(p('<div class="dtr-modal-display"/>').append(p('<div class="dtr-modal-content"/>').append(r())).append(p('<div class="dtr-modal-close">&times;</div>').click(function(){n()}))).append(p('<div class="dtr-modal-background"/>').click(function(){n()})).appendTo("body");p(o).on("keyup.dtr",function(e){if(e.keyCode===27){e.stopPropagation();n()}})}else{p("div.dtr-modal-content").empty().append(r())}if(a&&a.header){p("div.dtr-modal-content").prepend("<h2>"+a.header(e)+"</h2>")}}}};var g={};function s(e,t,r){var n=t+"-"+r;if(g[n]){return g[n]}var i=[];var a=e.cell(t,r).node().childNodes;for(var o=0,s=a.length;o<s;o++){i.push(a[o])}g[n]=i;return i}function d(e,t,r){var n=t+"-"+r;if(!g[n]){return}var i=e.cell(t,r).node();var a=g[n];var o=a[0].parentNode;var s=o.childNodes;var l=[];for(var u=0,f=s.length;u<f;u++){l.push(s[u])}for(var c=0,d=l.length;c<d;c++){i.appendChild(l[c])}g[n]=h}i.renderer={listHiddenNodes:function(){return function(n,e,t){var i=p('<ul data-dtr-index="'+e+'" class="dtr-details"/>');var a=false;var r=p.each(t,function(e,t){if(t.hidden){var r=t.className?'class="'+t.className+'"':"";p("<li "+r+' data-dtr-index="'+t.columnIndex+'" data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'">'+'<span class="dtr-title">'+t.title+"</span> "+"</li>").append(p('<span class="dtr-data"/>').append(s(n,t.rowIndex,t.columnIndex))).appendTo(i);a=true}});return a?i:false}},listHidden:function(){return function(e,t,r){var n=p.map(r,function(e){var t=e.className?'class="'+e.className+'"':"";return e.hidden?"<li "+t+' data-dtr-index="'+e.columnIndex+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'">'+'<span class="dtr-title">'+e.title+"</span> "+'<span class="dtr-data">'+e.data+"</span>"+"</li>":""}).join("");return n?p('<ul data-dtr-index="'+t+'" class="dtr-details"/>').append(n):false}},tableAll:function(i){i=p.extend({tableClass:""},i);return function(e,t,r){var n=p.map(r,function(e){var t=e.className?'class="'+e.className+'"':"";return"<tr "+t+' data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'">'+"<td>"+e.title+":"+"</td> "+"<td>"+e.data+"</td>"+"</tr>"}).join("");return p('<table class="'+i.tableClass+' dtr-details" width="100%"/>').append(n)}}};i.defaults={breakpoints:i.breakpoints,auto:true,details:{display:i.display.childRow,renderer:i.renderer.listHidden(),target:0,type:"inline"},orthogonal:"display"};var e=p.fn.dataTable.Api;e.register("responsive()",function(){return this});e.register("responsive.index()",function(e){e=p(e);return{column:e.data("dtr-index"),row:e.parent().data("dtr-index")}});e.register("responsive.rebuild()",function(){return this.iterator("table",function(e){if(e._responsive){e._responsive._classLogic()}})});e.register("responsive.recalc()",function(){return this.iterator("table",function(e){if(e._responsive){e._responsive._resizeAuto();e._responsive._resize()}})});e.register("responsive.hasHidden()",function(){var e=this.context[0];return e._responsive?p.inArray(false,e._responsive._responsiveOnlyHidden())!==-1:false});e.registerPlural("columns().responsiveHidden()","column().responsiveHidden()",function(){return this.iterator("column",function(e,t){return e._responsive?e._responsive._responsiveOnlyHidden()[t]:false},1)});i.version="2.2.7";p.fn.dataTable.Responsive=i;p.fn.DataTable.Responsive=i;p(o).on("preInit.dt.dtr",function(e,t,r){if(e.namespace!=="dt"){return}if(p(t.nTable).hasClass("responsive")||p(t.nTable).hasClass("dt-responsive")||t.oInit.responsive||a.defaults.responsive){var n=t.oInit.responsive;if(n!==false){new i(t,p.isPlainObject(n)?n:{})}}});return i});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(h,e,t,v){"use strict";var p=h.fn.dataTable;var o=function(e,t){if(!p.versionCheck||!p.versionCheck("1.10.8")){throw"RowGroup requires DataTables 1.10.8 or newer"}this.c=h.extend(true,{},p.defaults.rowGroup,o.defaults,t);this.s={dt:new p.Api(e)};this.dom={};var r=this.s.dt.settings()[0];var n=r.rowGroup;if(n){return n}r.rowGroup=this;this._constructor()};h.extend(o.prototype,{dataSrc:function(e){if(e===v){return this.c.dataSrc}var t=this.s.dt;this.c.dataSrc=e;h(t.table().node()).triggerHandler("rowgroup-datasrc.dt",[t,e]);return this},disable:function(){this.c.enable=false;return this},enable:function(e){if(e===false){return this.disable()}this.c.enable=true;return this},enabled:function(){return this.c.enable},_constructor:function(){var r=this;var e=this.s.dt;var n=e.settings()[0];e.on("draw.dtrg",function(e,t){if(r.c.enable&&n===t){r._draw()}});e.on("column-visibility.dt.dtrg responsive-resize.dt.dtrg",function(){r._adjustColspan()});e.on("destroy",function(){e.off(".dtrg")})},_adjustColspan:function(){h("tr."+this.c.className,this.s.dt.table().body()).find("td:visible").attr("colspan",this._colspan())},_colspan:function(){return this.s.dt.columns().visible().reduce(function(e,t){return e+t},0)},_draw:function(){var e=this.s.dt;var t=this._group(0,e.rows({page:"current"}).indexes());this._groupDisplay(0,t)},_group:function(e,t){var r=h.isArray(this.c.dataSrc)?this.c.dataSrc:[this.c.dataSrc];var n=p.ext.oApi._fnGetObjectDataFn(r[e]);var i=this.s.dt;var a,o;var s=[];var l=this;for(var u=0,f=t.length;u<f;u++){var c=t[u];var d=i.row(c).data();var a=n(d);if(a===null||a===v){a=l.c.emptyDataGroup}if(o===v||a!==o){s.push({dataPoint:a,rows:[]});o=a}s[s.length-1].rows.push(c)}if(r[e+1]!==v){for(var u=0,f=s.length;u<f;u++){s[u].children=this._group(e+1,s[u].rows)}}return s},_groupDisplay:function(e,t){var r=this.s.dt;var n;for(var i=0,a=t.length;i<a;i++){var o=t[i];var s=o.dataPoint;var l;var u=o.rows;if(this.c.startRender){n=this.c.startRender.call(this,r.rows(u),s,e);l=this._rowWrap(n,this.c.startClassName,e);if(l){l.insertBefore(r.row(u[0]).node())}}if(this.c.endRender){n=this.c.endRender.call(this,r.rows(u),s,e);l=this._rowWrap(n,this.c.endClassName,e);if(l){l.insertAfter(r.row(u[u.length-1]).node())}}if(o.children){this._groupDisplay(e+1,o.children)}}},_rowWrap:function(e,t,r){var n;if(e===null||e===""){e=this.c.emptyDataGroup}if(e===v||e===null){return null}if(typeof e==="object"&&e.nodeName&&e.nodeName.toLowerCase()==="tr"){n=h(e)}else if(e instanceof h&&e.length&&e[0].nodeName.toLowerCase()==="tr"){n=e}else{n=h("<tr/>").append(h("<td/>").attr("colspan",this._colspan()).append(e))}return n.addClass(this.c.className).addClass(t).addClass("dtrg-level-"+r)}});o.defaults={className:"dtrg-group",dataSrc:0,emptyDataGroup:"No group",enable:true,endClassName:"dtrg-end",endRender:null,startClassName:"dtrg-start",startRender:function(e,t){return t}};o.version="1.1.2";h.fn.dataTable.RowGroup=o;h.fn.DataTable.RowGroup=o;p.Api.register("rowGroup()",function(){return this});p.Api.register("rowGroup().disable()",function(){return this.iterator("table",function(e){if(e.rowGroup){e.rowGroup.enable(false)}})});p.Api.register("rowGroup().enable()",function(t){return this.iterator("table",function(e){if(e.rowGroup){e.rowGroup.enable(t===v?true:t)}})});p.Api.register("rowGroup().enabled()",function(){var e=this.context;return e.length&&e[0].rowGroup?e[0].rowGroup.enabled():false});p.Api.register("rowGroup().dataSrc()",function(t){if(t===v){return this.context[0].rowGroup.dataSrc()}return this.iterator("table",function(e){if(e.rowGroup){e.rowGroup.dataSrc(t)}})});h(t).on("preInit.dt.dtrg",function(e,t,r){if(e.namespace!=="dt"){return}var n=t.oInit.rowGroup;var i=p.defaults.rowGroup;if(n||i){var a=h.extend({},i,n);if(n!==false){new o(t,a)}}});return o});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(m,o,n,s){"use strict";var a=m.fn.dataTable;var l=function(e,t){if(!(this instanceof l)){alert("Scroller warning: Scroller must be initialised with the 'new' keyword.");return}if(t===s){t={}}var r=m.fn.dataTable.Api(e);this.s={dt:r.settings()[0],dtApi:r,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:true,viewportRows:0,stateTO:null,stateSaveThrottle:function(){},drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null,labelFactor:1},topRowFloat:0,scrollDrawDiff:null,loaderVisible:false,forceReposition:false,baseRowTop:0,baseScrollTop:0,mousedown:false,lastScrollTop:0};this.s=m.extend(this.s,l.oDefaults,t);this.s.heights.row=this.s.rowHeight;this.dom={force:n.createElement("div"),label:m('<div class="dts_label">0</div>'),scroller:null,table:null,loader:null};if(this.s.dt.oScroller){return}this.s.dt.oScroller=this;this.construct()};m.extend(l.prototype,{measure:function(e){if(this.s.autoHeight){this._calcRowHeight()}var t=this.s.heights;if(t.row){t.viewport=this._parseHeight(m(this.dom.scroller).css("max-height"));this.s.viewportRows=parseInt(t.viewport/t.row,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer}var r=this.dom.label.outerHeight();t.labelFactor=(t.viewport-r)/t.scroll;if(e===s||e){this.s.dt.oInstance.fnDraw(false)}},pageInfo:function(){var e=this.s.dt,t=this.dom.scroller.scrollTop,r=e.fnRecordsDisplay(),n=Math.ceil(this.pixelsToRow(t+this.s.heights.viewport,false,this.s.ani));return{start:Math.floor(this.pixelsToRow(t,false,this.s.ani)),end:r<n?r-1:n-1}},pixelsToRow:function(e,t,r){var n=e-this.s.baseScrollTop;var i=r?(this._domain("physicalToVirtual",this.s.baseScrollTop)+n)/this.s.heights.row:n/this.s.heights.row+this.s.baseRowTop;return t||t===s?parseInt(i,10):i},rowToPixels:function(e,t,r){var n;var i=e-this.s.baseRowTop;if(r){n=this._domain("virtualToPhysical",this.s.baseScrollTop);n+=i*this.s.heights.row}else{n=this.s.baseScrollTop;n+=i*this.s.heights.row}return t||t===s?parseInt(n,10):n},scrollToRow:function(e,t){var r=this;var n=false;var i=this.rowToPixels(e);var a=(this.s.displayBuffer-1)/2*this.s.viewportRows;var o=e-a;if(o<0){o=0}if((i>this.s.redrawBottom||i<this.s.redrawTop)&&this.s.dt._iDisplayStart!==o){n=true;i=this._domain("virtualToPhysical",e*this.s.heights.row);if(this.s.redrawTop<i&&i<this.s.redrawBottom){this.s.forceReposition=true;t=false}}if(t===s||t){this.s.ani=n;m(this.dom.scroller).animate({scrollTop:i},function(){setTimeout(function(){r.s.ani=false},250)})}else{m(this.dom.scroller).scrollTop(i)}},construct:function(){var n=this;var e=this.s.dtApi;if(!this.s.dt.oFeatures.bPaginate){this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller");return}this.dom.force.style.position="relative";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=m("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=m(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";m(e.table().container()).addClass("dts DTS");if(this.s.loadingIndicator){this.dom.loader=m('<div class="dataTables_processing dts_loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>").css("display","none");m(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader)}this.dom.label.appendTo(this.dom.scroller);if(this.s.heights.row&&this.s.heights.row!="auto"){this.s.autoHeight=false}this.s.ingnoreScroll=true;m(this.dom.scroller).on("scroll.dt-scroller",function(e){n._scroll.call(n)});m(this.dom.scroller).on("touchstart.dt-scroller",function(){n._scroll.call(n)});m(this.dom.scroller).on("mousedown.dt-scroller",function(){n.s.mousedown=true}).on("mouseup.dt-scroller",function(){n.s.labelVisible=false;n.s.mousedown=false;n.dom.label.css("display","none")});m(o).on("resize.dt-scroller",function(){n.measure(false);n._info()});var i=true;var a=e.state.loaded();e.on("stateSaveParams.scroller",function(e,t,r){if(i&&a){r.scroller=a.scroller;i=false}else{r.scroller={topRow:n.s.topRowFloat,baseScrollTop:n.s.baseScrollTop,baseRowTop:n.s.baseRowTop,scrollTop:n.s.lastScrollTop}}});if(a&&a.scroller){this.s.topRowFloat=a.scroller.topRow;this.s.baseScrollTop=a.scroller.baseScrollTop;this.s.baseRowTop=a.scroller.baseRowTop}this.measure(false);n.s.stateSaveThrottle=n.s.dt.oApi._fnThrottle(function(){n.s.dtApi.state.save()},500);e.on("init.scroller",function(){n.measure(false);n.s.scrollType="jump";n._draw();e.on("draw.scroller",function(){n._draw()})});e.on("preDraw.dt.scroller",function(){n._scrollForce()});e.on("destroy.scroller",function(){m(o).off("resize.dt-scroller");m(n.dom.scroller).off(".dt-scroller");m(n.s.dt.nTable).off(".scroller");m(n.s.dt.nTableWrapper).removeClass("DTS");m("div.DTS_Loading",n.dom.scroller.parentNode).remove();n.dom.table.style.position="";n.dom.table.style.top="";n.dom.table.style.left=""})},_calcRowHeight:function(){var e=this.s.dt;var t=e.nTable;var r=t.cloneNode(false);var n=m("<tbody/>").appendTo(r);var i=m('<div class="'+e.oClasses.sWrapper+' DTS">'+'<div class="'+e.oClasses.sScrollWrapper+'">'+'<div class="'+e.oClasses.sScrollBody+'"></div>'+"</div>"+"</div>");m("tbody tr:lt(4)",t).clone().appendTo(n);var a=m("tr",n).length;if(a===1){n.prepend("<tr><td>&#160;</td></tr>");n.append("<tr><td>&#160;</td></tr>")}else{for(;a<3;a++){n.append("<tr><td>&#160;</td></tr>")}}m("div."+e.oClasses.sScrollBody,i).append(r);var o=this.s.dt.nHolding||t.parentNode;if(!m(o).is(":visible")){o="body"}i.find("input").removeAttr("name");i.appendTo(o);this.s.heights.row=m("tr",n).eq(1).outerHeight();i.remove()},_draw:function(){var e=this,t=this.s.heights,r=this.dom.scroller.scrollTop,n=m(this.s.dt.nTable).height(),i=this.s.dt._iDisplayStart,a=this.s.dt._iDisplayLength,o=this.s.dt.fnRecordsDisplay();this.s.skip=true;if((this.s.dt.bSorted||this.s.dt.bFiltered)&&i===0&&!this.s.dt._drawHold){this.s.topRowFloat=0}r=this.s.scrollType==="jump"?this._domain("virtualToPhysical",this.s.topRowFloat*t.row):r;this.s.baseScrollTop=r;this.s.baseRowTop=this.s.topRowFloat;var s=r-(this.s.topRowFloat-i)*t.row;if(i===0){s=0}else if(i+a>=o){s=t.scroll-n}this.dom.table.style.top=s+"px";this.s.tableTop=s;this.s.tableBottom=n+this.s.tableTop;var l=(r-this.s.tableTop)*this.s.boundaryScale;this.s.redrawTop=r-l;this.s.redrawBottom=r+l>t.scroll-t.viewport-t.row?t.scroll-t.viewport-t.row:r+l;this.s.skip=false;if(this.s.dt.oFeatures.bStateSave&&this.s.dt.oLoadedState!==null&&typeof this.s.dt.oLoadedState.scroller!="undefined"){var u=(this.s.dt.sAjaxSource||e.s.dt.ajax)&&!this.s.dt.oFeatures.bServerSide?true:false;if(u&&this.s.dt.iDraw==2||!u&&this.s.dt.iDraw==1){setTimeout(function(){m(e.dom.scroller).scrollTop(e.s.dt.oLoadedState.scroller.scrollTop);setTimeout(function(){e.s.ingnoreScroll=false},0)},0)}}else{e.s.ingnoreScroll=false}if(this.s.dt.oFeatures.bInfo){setTimeout(function(){e._info.call(e)},0)}if(this.dom.loader&&this.s.loaderVisible){this.dom.loader.css("display","none");this.s.loaderVisible=false}},_domain:function(e,t){var r=this.s.heights;var n;var i=1e4;if(r.virtual===r.scroll){return t}if(t<i){return t}else if(e==="virtualToPhysical"&&t>=r.virtual-i){n=r.virtual-t;return r.scroll-n}else if(e==="physicalToVirtual"&&t>=r.scroll-i){n=r.scroll-t;return r.virtual-n}var a=(r.virtual-i-i)/(r.scroll-i-i);var o=i-a*i;return e==="virtualToPhysical"?(t-o)/a:a*t+o},_info:function(){if(!this.s.dt.oFeatures.bInfo){return}var e=this.s.dt,t=e.oLanguage,r=this.dom.scroller.scrollTop,n=Math.floor(this.pixelsToRow(r,false,this.s.ani)+1),i=e.fnRecordsTotal(),a=e.fnRecordsDisplay(),o=Math.ceil(this.pixelsToRow(r+this.s.heights.viewport,false,this.s.ani)),s=a<o?a:o,l=e.fnFormatNumber(n),u=e.fnFormatNumber(s),f=e.fnFormatNumber(i),c=e.fnFormatNumber(a),d;if(e.fnRecordsDisplay()===0&&e.fnRecordsDisplay()==e.fnRecordsTotal()){d=t.sInfoEmpty+t.sInfoPostFix}else if(e.fnRecordsDisplay()===0){d=t.sInfoEmpty+" "+t.sInfoFiltered.replace("_MAX_",f)+t.sInfoPostFix}else if(e.fnRecordsDisplay()==e.fnRecordsTotal()){d=t.sInfo.replace("_START_",l).replace("_END_",u).replace("_MAX_",f).replace("_TOTAL_",c)+t.sInfoPostFix}else{d=t.sInfo.replace("_START_",l).replace("_END_",u).replace("_MAX_",f).replace("_TOTAL_",c)+" "+t.sInfoFiltered.replace("_MAX_",e.fnFormatNumber(e.fnRecordsTotal()))+t.sInfoPostFix}var h=t.fnInfoCallback;if(h){d=h.call(e.oInstance,e,n,s,i,a,d)}var v=e.aanFeatures.i;if(typeof v!="undefined"){for(var p=0,g=v.length;p<g;p++){m(v[p]).html(d)}}m(e.nTable).triggerHandler("info.dt")},_parseHeight:function(e){var t;var r=/^([+-]?(?:\d+(?:\.\d+)?|\.\d+))(px|em|rem|vh)$/.exec(e);if(r===null){return 0}var n=parseFloat(r[1]);var i=r[2];if(i==="px"){t=n}else if(i==="vh"){t=n/100*m(o).height()}else if(i==="rem"){t=n*parseFloat(m(":root").css("font-size"))}else if(i==="em"){t=n*parseFloat(m("body").css("font-size"))}return t?t:0},_scroll:function(){var e=this,t=this.s.heights,r=this.dom.scroller.scrollTop,n;if(this.s.skip){return}if(this.s.ingnoreScroll){return}if(r===this.s.lastScrollTop){return}if(this.s.dt.bFiltered||this.s.dt.bSorted){this.s.lastScrollTop=0;return}this._info();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){e.s.dtApi.state.save()},250);this.s.scrollType=Math.abs(r-this.s.lastScrollTop)>t.viewport?"jump":"cont";this.s.topRowFloat=this.s.scrollType==="cont"?this.pixelsToRow(r,false,false):this._domain("physicalToVirtual",r)/t.row;if(this.s.topRowFloat<0){this.s.topRowFloat=0}if(this.s.forceReposition||r<this.s.redrawTop||r>this.s.redrawBottom){var i=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows);n=parseInt(this.s.topRowFloat,10)-i;this.s.forceReposition=false;if(n<=0){n=0}else if(n+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()){n=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength;if(n<0){n=0}}else if(n%2!==0){n++}this.s.targetTop=n;if(n!=this.s.dt._iDisplayStart){this.s.tableTop=m(this.s.dt.nTable).offset().top;this.s.tableBottom=m(this.s.dt.nTable).height()+this.s.tableTop;var a=function(){e.s.dt._iDisplayStart=e.s.targetTop;e.s.dt.oApi._fnDraw(e.s.dt)};if(this.s.dt.oFeatures.bServerSide){this.s.forceReposition=true;clearTimeout(this.s.drawTO);this.s.drawTO=setTimeout(a,this.s.serverWait)}else{a()}if(this.dom.loader&&!this.s.loaderVisible){this.dom.loader.css("display","block");this.s.loaderVisible=true}}}else{this.s.topRowFloat=this.pixelsToRow(r,false,true)}this.s.lastScrollTop=r;this.s.stateSaveThrottle();if(this.s.scrollType==="jump"&&this.s.mousedown){this.s.labelVisible=true}if(this.s.labelVisible){this.dom.label.html(this.s.dt.fnFormatNumber(parseInt(this.s.topRowFloat,10)+1)).css("top",r+r*t.labelFactor).css("display","block")}},_scrollForce:function(){var e=this.s.heights;var t=1e6;e.virtual=e.row*this.s.dt.fnRecordsDisplay();e.scroll=e.virtual;if(e.scroll>t){e.scroll=t}this.dom.force.style.height=e.scroll>this.s.heights.row?e.scroll+"px":this.s.heights.row+"px"}});l.defaults={boundaryScale:.5,displayBuffer:9,loadingIndicator:false,rowHeight:"auto",serverWait:200};l.oDefaults=l.defaults;l.version="2.0.3";m(n).on("preInit.dt.dtscroller",function(e,t){if(e.namespace!=="dt"){return}var r=t.oInit.scroller;var n=a.defaults.scroller;if(r||n){var i=m.extend({},r,n);if(r!==false){new l(t,i)}}});m.fn.dataTable.Scroller=l;m.fn.DataTable.Scroller=l;var e=m.fn.dataTable.Api;e.register("scroller()",function(){return this});e.register("scroller().rowToPixels()",function(e,t,r){var n=this.context;if(n.length&&n[0].oScroller){return n[0].oScroller.rowToPixels(e,t,r)}});e.register("scroller().pixelsToRow()",function(e,t,r){var n=this.context;if(n.length&&n[0].oScroller){return n[0].oScroller.pixelsToRow(e,t,r)}});e.register(["scroller().scrollToRow()","scroller.toPosition()"],function(t,r){this.iterator("table",function(e){if(e.oScroller){e.oScroller.scrollToRow(t,r)}});return this});e.register("row().scrollTo()",function(n){var i=this;this.iterator("row",function(e,t){if(e.oScroller){var r=i.rows({order:"applied",search:"applied"}).indexes().indexOf(t);e.oScroller.scrollToRow(r,n)}});return this});e.register("scroller.measure()",function(t){this.iterator("table",function(e){if(e.oScroller){e.oScroller.measure(t)}});return this});e.register("scroller.page()",function(){var e=this.context;if(e.length&&e[0].oScroller){return e[0].oScroller.pageInfo()}});return l});(function(){"use strict";var W;var U;function i(e){W=e;U=e.fn.dataTable}var d=function(){function h(e,t,r,n,i,a){var o=this;if(a===void 0){a=null}if(!U||!U.versionCheck||!U.versionCheck("1.10.0")){throw new Error("SearchPane requires DataTables 1.10 or newer")}if(!U.select){throw new Error("SearchPane requires Select")}var s=new U.Api(e);this.classes=W.extend(true,{},h.classes);this.c=W.extend(true,{},h.defaults,t);this.customPaneSettings=a;this.s={cascadeRegen:false,clearing:false,colOpts:[],deselect:false,displayed:false,dt:s,dtPane:undefined,filteringActive:false,index:r,indexes:[],lastCascade:false,lastSelect:false,listSet:false,name:undefined,redraw:false,rowData:{arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map,totalOptions:0},scrollTop:0,searchFunction:undefined,selectPresent:false,serverSelect:[],serverSelecting:false,showFiltered:false,tableLength:null,updating:false};var l=s.columns().eq(0).toArray().length;this.colExists=this.s.index<l;this.c.layout=n;var u=parseInt(n.split("-")[1],10);this.dom={buttonGroup:W("<div/>").addClass(this.classes.buttonGroup),clear:W('<button type="button">&#215;</button>').addClass(this.classes.dull).addClass(this.classes.paneButton).addClass(this.classes.clearButton),container:W("<div/>").addClass(this.classes.container).addClass(this.classes.layout+(u<10?n:n.split("-")[0]+"-9")),countButton:W('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.countButton),dtP:W("<table><thead><tr><th>"+(this.colExists?W(s.column(this.colExists?this.s.index:0).header()).text():this.customPaneSettings.header||"Custom Pane")+"</th><th/></tr></thead></table>"),lower:W("<div/>").addClass(this.classes.subRow2).addClass(this.classes.narrowButton),nameButton:W('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.nameButton),panesContainer:i,searchBox:W("<input/>").addClass(this.classes.paneInputButton).addClass(this.classes.search),searchButton:W('<button type = "button" class="'+this.classes.searchIcon+'"></button>').addClass(this.classes.paneButton),searchCont:W("<div/>").addClass(this.classes.searchCont),searchLabelCont:W("<div/>").addClass(this.classes.searchLabelCont),topRow:W("<div/>").addClass(this.classes.topRow),upper:W("<div/>").addClass(this.classes.subRow1).addClass(this.classes.narrowSearch)};this.s.displayed=false;s=this.s.dt;this.selections=[];this.s.colOpts=this.colExists?this._getOptions():this._getBonusOptions();var f=this.s.colOpts;var c=W('<button type="button">X</button>').addClass(this.classes.paneButton);W(c).text(s.i18n("searchPanes.clearPane","X"));this.dom.container.addClass(f.className);this.dom.container.addClass(this.customPaneSettings!==null&&this.customPaneSettings.className!==undefined?this.customPaneSettings.className:"");if(this.s.colOpts.name!==undefined){this.s.name=this.s.colOpts.name}else if(this.customPaneSettings!==null&&this.customPaneSettings.name!==undefined){this.s.name=this.customPaneSettings.name}else{this.s.name=this.colExists?W(s.column(this.s.index).header()).text():this.customPaneSettings.header||"Custom Pane"}W(i).append(this.dom.container);var d=s.table(0).node();this.s.searchFunction=function(e,t,r,n){if(o.selections.length===0){return true}if(e.nTable!==d){return true}var i=null;if(o.colExists){i=t[o.s.index];if(f.orthogonal.filter!=="filter"){i=o.s.rowData.filterMap.get(r);if(i instanceof W.fn.dataTable.Api){i=i.toArray()}}}return o._search(i,r)};W.fn.dataTable.ext.search.push(this.s.searchFunction);if(this.c.clear){W(c).on("click",function(){var e=o.dom.container.find(o.classes.search);e.each(function(){W(this).val("");W(this).trigger("input")});o.clearPane()})}s.on("draw.dtsp",function(){o._adjustTopRow()});s.on("buttons-action",function(){o._adjustTopRow()});W(window).on("resize.dtsp",U.util.throttle(function(){o._adjustTopRow()}));s.on("column-reorder.dtsp",function(e,t,r){o.s.index=r.mapping[o.s.index]});return this}h.prototype.clearData=function(){this.s.rowData={arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map,totalOptions:0}};h.prototype.clearPane=function(){this.s.dtPane.rows({selected:true}).deselect();this.updateTable();return this};h.prototype.destroy=function(){W(this.s.dtPane).off(".dtsp");W(this.s.dt).off(".dtsp");W(this.dom.nameButton).off(".dtsp");W(this.dom.countButton).off(".dtsp");W(this.dom.clear).off(".dtsp");W(this.dom.searchButton).off(".dtsp");W(this.dom.container).remove();var e=W.fn.dataTable.ext.search.indexOf(this.s.searchFunction);while(e!==-1){W.fn.dataTable.ext.search.splice(e,1);e=W.fn.dataTable.ext.search.indexOf(this.s.searchFunction)}if(this.s.dtPane!==undefined){this.s.dtPane.destroy()}this.s.listSet=false};h.prototype.getPaneCount=function(){return this.s.dtPane!==undefined?this.s.dtPane.rows({selected:true}).data().toArray().length:0};h.prototype.rebuildPane=function(e,t,r,n){if(e===void 0){e=false}if(t===void 0){t=null}if(r===void 0){r=null}if(n===void 0){n=false}this.clearData();var i=[];this.s.serverSelect=[];var a=null;if(this.s.dtPane!==undefined){if(n){if(!this.s.dt.page.info().serverSide){i=this.s.dtPane.rows({selected:true}).data().toArray()}else{this.s.serverSelect=this.s.dtPane.rows({selected:true}).data().toArray()}}this.s.dtPane.clear().destroy();a=W(this.dom.container).prev();this.destroy();this.s.dtPane=undefined;W.fn.dataTable.ext.search.push(this.s.searchFunction)}this.dom.container.removeClass(this.classes.hidden);this.s.displayed=false;this._buildPane(!this.s.dt.page.info().serverSide?i:this.s.serverSelect,e,t,r,a);return this};h.prototype.removePane=function(){this.s.displayed=false;W(this.dom.container).hide()};h.prototype.setCascadeRegen=function(e){this.s.cascadeRegen=e};h.prototype.setClear=function(e){this.s.clearing=e};h.prototype.updatePane=function(e){if(e===void 0){e=false}this.s.updating=true;this._updateCommon(e);this.s.updating=false};h.prototype.updateTable=function(){var e=this.s.dtPane.rows({selected:true}).data().toArray();this.selections=e;this._searchExtras();if(this.c.cascadePanes||this.c.viewTotal){this.updatePane()}};h.prototype._setListeners=function(){var u=this;var f=this.s.rowData;var e;this.s.dtPane.on("select.dtsp",function(){clearTimeout(e);if(u.s.dt.page.info().serverSide&&!u.s.updating){if(!u.s.serverSelecting){u.s.serverSelect=u.s.dtPane.rows({selected:true}).data().toArray();u.s.scrollTop=W(u.s.dtPane.table().node()).parent()[0].scrollTop;u.s.selectPresent=true;u.s.dt.draw(false)}}else{W(u.dom.clear).removeClass(u.classes.dull);u.s.selectPresent=true;if(!u.s.updating){u._makeSelection()}u.s.selectPresent=false}});this.s.dtPane.on("deselect.dtsp",function(){e=setTimeout(function(){if(u.s.dt.page.info().serverSide&&!u.s.updating){if(!u.s.serverSelecting){u.s.serverSelect=u.s.dtPane.rows({selected:true}).data().toArray();u.s.deselect=true;u.s.dt.draw(false)}}else{u.s.deselect=true;if(u.s.dtPane.rows({selected:true}).data().toArray().length===0){W(u.dom.clear).addClass(u.classes.dull)}u._makeSelection();u.s.deselect=false;u.s.dt.state.save()}},50)});this.s.dt.on("stateSaveParams.dtsp",function(e,t,r){if(W.isEmptyObject(r)){u.s.dtPane.state.clear();return}var n=[];var i;var a;var o;var s;if(u.s.dtPane!==undefined){n=u.s.dtPane.rows({selected:true}).data().map(function(e){return e.filter.toString()}).toArray();i=W(u.dom.searchBox).val();a=u.s.dtPane.order();o=f.binsOriginal;s=f.arrayOriginal}if(r.searchPanes===undefined){r.searchPanes={}}if(r.searchPanes.panes===undefined){r.searchPanes.panes=[]}for(var l=0;l<r.searchPanes.panes.length;l++){if(r.searchPanes.panes[l].id===u.s.index){r.searchPanes.panes.splice(l,1);l--}}r.searchPanes.panes.push({arrayFilter:s,bins:o,id:u.s.index,order:a,searchTerm:i,selected:n})});this.s.dtPane.on("user-select.dtsp",function(e,t,r,n,i){i.stopPropagation()});this.s.dtPane.on("draw.dtsp",function(){u._adjustTopRow()});W(this.dom.nameButton).on("click.dtsp",function(){var e=u.s.dtPane.order()[0][1];u.s.dtPane.order([0,e==="asc"?"desc":"asc"]).draw();u.s.dt.state.save()});W(this.dom.countButton).on("click.dtsp",function(){var e=u.s.dtPane.order()[0][1];u.s.dtPane.order([1,e==="asc"?"desc":"asc"]).draw();u.s.dt.state.save()});W(this.dom.clear).on("click.dtsp",function(){var e=u.dom.container.find("."+u.classes.search);e.each(function(){W(this).val("");W(this).trigger("input")});u.clearPane()});W(this.dom.searchButton).on("click.dtsp",function(){W(u.dom.searchBox).focus()});W(this.dom.searchBox).on("input.dtsp",function(){u.s.dtPane.search(W(u.dom.searchBox).val()).draw();u.s.dt.state.save()});this.s.dt.state.save();return true};h.prototype._addOption=function(e,t,r,n,i,a){if(Array.isArray(e)||e instanceof U.Api){if(e instanceof U.Api){e=e.toArray();t=t.toArray()}if(e.length===t.length){for(var o=0;o<e.length;o++){if(!a[e[o]]){a[e[o]]=1;i.push({display:t[o],filter:e[o],sort:r[o],type:n[o]})}else{a[e[o]]++}this.s.rowData.totalOptions++}return}else{throw new Error("display and filter not the same length")}}else if(typeof this.s.colOpts.orthogonal==="string"){if(!a[e]){a[e]=1;i.push({display:t,filter:e,sort:r,type:n});this.s.rowData.totalOptions++}else{a[e]++;this.s.rowData.totalOptions++;return}}else{i.push({display:t,filter:e,sort:r,type:n})}};h.prototype._addRow=function(e,t,r,n,i,a,o){var s;for(var l=0,u=this.s.indexes;l<u.length;l++){var f=u[l];if(f.filter===t){s=f.index}}if(s===undefined){s=this.s.indexes.length;this.s.indexes.push({filter:t,index:s})}return this.s.dtPane.row.add({className:o,display:e!==""?e:this.s.colOpts.emptyMessage!==false?this.s.colOpts.emptyMessage:this.c.emptyMessage,filter:t,index:s,shown:r,sort:i!==""?i:this.s.colOpts.emptyMessage!==false?this.s.colOpts.emptyMessage:this.c.emptyMessage,total:n,type:a})};h.prototype._adjustTopRow=function(){var e=this.dom.container.find("."+this.classes.subRowsContainer);var t=this.dom.container.find(".dtsp-subRow1");var r=this.dom.container.find(".dtsp-subRow2");var n=this.dom.container.find("."+this.classes.topRow);if((W(e[0]).width()<252||W(n[0]).width()<252)&&W(e[0]).width()!==0){W(e[0]).addClass(this.classes.narrow);W(t[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowSearch);W(r[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowButton)}else{W(e[0]).removeClass(this.classes.narrow);W(t[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowSearch);W(r[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowButton)}};h.prototype._buildPane=function(e,t,r,n,i){var a=this;if(e===void 0){e=[]}if(t===void 0){t=false}if(r===void 0){r=null}if(n===void 0){n=null}if(i===void 0){i=null}this.selections=[];var o=this.s.dt;var s=o.column(this.colExists?this.s.index:0);var l=this.s.colOpts;var u=this.s.rowData;var f=o.i18n("searchPanes.count","{total}");var c=o.i18n("searchPanes.countFiltered","{shown} ({total})");var d=o.state.loaded();if(this.s.listSet){d=o.state()}if(this.colExists){var h=-1;if(d&&d.searchPanes&&d.searchPanes.panes){for(var v=0;v<d.searchPanes.panes.length;v++){if(d.searchPanes.panes[v].id===this.s.index){h=v;break}}}if((l.show===false||l.show!==undefined&&l.show!==true)&&h===-1){this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return false}else if(l.show===true||h!==-1){this.s.displayed=true}if(!this.s.dt.page.info().serverSide&&(r===null||r.searchPanes===null||r.searchPanes.options===null)){if(u.arrayFilter.length===0){this._populatePane(t);this.s.rowData.totalOptions=0;this._detailsPane();if(d&&d.searchPanes&&d.searchPanes.panes&&h===-1){this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return}u.arrayOriginal=u.arrayTotals;u.binsOriginal=u.binsTotal}var p=Object.keys(u.binsOriginal).length;var g=this._uniqueRatio(p,o.rows()[0].length);if(this.s.displayed===false&&((l.show===undefined&&l.threshold===null?g>this.c.threshold:g>l.threshold)||l.show!==true&&p<=1)){this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return}if(this.c.viewTotal&&u.arrayTotals.length===0){this.s.rowData.totalOptions=0;this._detailsPane()}else{u.binsTotal=u.bins}this.dom.container.addClass(this.classes.show);this.s.displayed=true}else if(r!==null&&r.searchPanes!==null&&r.searchPanes.options!==null){if(r.tableLength!==undefined){this.s.tableLength=r.tableLength;this.s.rowData.totalOptions=this.s.tableLength}else if(this.s.tableLength===null||o.rows()[0].length>this.s.tableLength){this.s.tableLength=o.rows()[0].length;this.s.rowData.totalOptions=this.s.tableLength}var m=o.column(this.s.index).dataSrc();if(r.searchPanes.options[m]!==undefined){for(var y=0,b=r.searchPanes.options[m];y<b.length;y++){var w=b[y];this.s.rowData.arrayFilter.push({display:w.label,filter:w.value,sort:w.label,type:w.label});this.s.rowData.bins[w.value]=this.c.viewTotal||this.c.cascadePanes?w.count:w.total;this.s.rowData.binsTotal[w.value]=w.total}}var p=Object.keys(u.binsTotal).length;var g=this._uniqueRatio(p,this.s.tableLength);if(this.s.displayed===false&&((l.show===undefined&&l.threshold===null?g>this.c.threshold:g>l.threshold)||l.show!==true&&p<=1)){this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return}this.s.rowData.arrayOriginal=this.s.rowData.arrayFilter;this.s.rowData.binsOriginal=this.s.rowData.bins;this.s.displayed=true}}else{this.s.displayed=true}this._displayPane();if(!this.s.listSet){this.dom.dtP.on("stateLoadParams.dt",function(e,t,r){if(W.isEmptyObject(o.state.loaded())){W.each(r,function(e,t){delete r[e]})}})}if(i!==null&&W(this.dom.panesContainer).has(i).length>0){W(this.dom.container).insertAfter(i)}else{W(this.dom.panesContainer).prepend(this.dom.container)}var C=W.fn.dataTable.ext.errMode;W.fn.dataTable.ext.errMode="none";var S=U.Scroller;this.s.dtPane=W(this.dom.dtP).DataTable(W.extend(true,{columnDefs:[{className:"dtsp-nameColumn",data:"display",render:function(e,t,r){if(t==="sort"){return r.sort}else if(t==="type"){return r.type}var n;(a.s.filteringActive||a.s.showFiltered)&&a.c.viewTotal?n=c.replace(/{total}/,r.total):n=f.replace(/{total}/,r.total);n=n.replace(/{shown}/,r.shown);while(n.indexOf("{total}")!==-1){n=n.replace(/{total}/,r.total)}while(n.indexOf("{shown}")!==-1){n=n.replace(/{shown}/,r.shown)}var i='<span class="'+a.classes.pill+'">'+n+"</span>";if(a.c.hideCount||l.hideCount){i=""}return'<div class="'+a.classes.nameCont+'"><span title="'+(typeof e==="string"&&e.match(/<[^>]*>/)!==null?e.replace(/<[^>]*>/g,""):e)+'" class="'+a.classes.name+'">'+e+"</span>"+i+"</div>"},targets:0,type:o.settings()[0].aoColumns[this.s.index]!==undefined?o.settings()[0].aoColumns[this.s.index]._sManualType:null},{className:"dtsp-countColumn "+this.classes.badgePill,data:"shown",orderData:[1,2],targets:1,visible:false},{data:"total",targets:2,visible:false}],deferRender:true,dom:"t",info:false,language:this.s.dt.settings()[0].oLanguage,paging:S?true:false,scrollX:false,scrollY:"200px",scroller:S?true:false,select:true,stateSave:o.settings()[0].oFeatures.bStateSave?true:false},this.c.dtOpts,l!==undefined?l.dtOpts:{},this.s.colOpts.options!==undefined||!this.colExists?{createdRow:function(e,t,r){W(e).addClass(t.className)}}:undefined,this.customPaneSettings!==null&&this.customPaneSettings.dtOpts!==undefined?this.customPaneSettings.dtOpts:{}));W(this.dom.dtP).addClass(this.classes.table);W(this.dom.searchBox).attr("placeholder",l.header!==undefined?l.header:this.colExists?o.settings()[0].aoColumns[this.s.index].sTitle:this.customPaneSettings.header||"Custom Pane");W.fn.dataTable.select.init(this.s.dtPane);W.fn.dataTable.ext.errMode=C;if(this.colExists){var E=s.search();E=E?E.substr(1,E.length-2).split("|"):[];var k=0;u.arrayFilter.forEach(function(e){if(e.filter===""){k++}});for(var v=0,T=u.arrayFilter.length;v<T;v++){var _=false;for(var x=0,D=this.s.serverSelect;x<D.length;x++){var R=D[x];if(R.filter===u.arrayFilter[v].filter){_=true}}if(this.s.dt.page.info().serverSide&&(!this.c.cascadePanes||this.c.cascadePanes&&u.bins[u.arrayFilter[v].filter]!==0||this.c.cascadePanes&&n!==null||_)){var I=this._addRow(u.arrayFilter[v].display,u.arrayFilter[v].filter,n?u.binsTotal[u.arrayFilter[v].filter]:u.bins[u.arrayFilter[v].filter],this.c.viewTotal||n?String(u.binsTotal[u.arrayFilter[v].filter]):u.bins[u.arrayFilter[v].filter],u.arrayFilter[v].sort,u.arrayFilter[v].type);for(var O=0,A=this.s.serverSelect;O<A.length;O++){var R=A[O];if(R.filter===u.arrayFilter[v].filter){this.s.serverSelecting=true;I.select();this.s.serverSelecting=false}}}else if(!this.s.dt.page.info().serverSide&&u.arrayFilter[v]&&(u.bins[u.arrayFilter[v].filter]!==undefined||!this.c.cascadePanes)){this._addRow(u.arrayFilter[v].display,u.arrayFilter[v].filter,u.bins[u.arrayFilter[v].filter],u.binsTotal[u.arrayFilter[v].filter],u.arrayFilter[v].sort,u.arrayFilter[v].type)}else if(!this.s.dt.page.info().serverSide){this._addRow("",k,k,"","","")}}}U.select.init(this.s.dtPane);if(l.options!==undefined||this.customPaneSettings!==null&&this.customPaneSettings.options!==undefined){this._getComparisonRows()}this.s.dtPane.draw();this._adjustTopRow();if(!this.s.listSet){this._setListeners();this.s.listSet=true}for(var N=0,M=e;N<M.length;N++){var L=M[N];if(L!==undefined){for(var P=0,F=this.s.dtPane.rows().indexes().toArray();P<F.length;P++){var I=F[P];if(this.s.dtPane.row(I).data()!==undefined&&L.filter===this.s.dtPane.row(I).data().filter){if(this.s.dt.page.info().serverSide){this.s.serverSelecting=true;this.s.dtPane.row(I).select();this.s.serverSelecting=false}else{this.s.dtPane.row(I).select()}}}}}if(this.s.dt.page.info().serverSide){this.s.dtPane.search(W(this.dom.searchBox).val()).draw()}if(d&&d.searchPanes&&d.searchPanes.panes&&(r===null||r.draw===1)){if(!this.c.cascadePanes){this._reloadSelect(d)}for(var B=0,H=d.searchPanes.panes;B<H.length;B++){var $=H[B];if($.id===this.s.index){W(this.dom.searchBox).val($.searchTerm);W(this.dom.searchBox).trigger("input");this.s.dtPane.order($.order).draw()}}}this.s.dt.state.save();return true};h.prototype._detailsPane=function(){var e=this.s.dt;this.s.rowData.arrayTotals=[];this.s.rowData.binsTotal={};var t=this.s.dt.settings()[0];var r=e.rows().indexes();if(!this.s.dt.page.info().serverSide){for(var n=0,i=r;n<i.length;n++){var a=i[n];this._populatePaneArray(a,this.s.rowData.arrayTotals,t,this.s.rowData.binsTotal)}}};h.prototype._displayPane=function(){var e=this.dom.container;var t=this.s.colOpts;var r=parseInt(this.c.layout.split("-")[1],10);W(this.dom.topRow).empty();W(this.dom.dtP).empty();W(this.dom.topRow).addClass(this.classes.topRow);if(r>3){W(this.dom.container).addClass(this.classes.smallGap)}W(this.dom.topRow).addClass(this.classes.subRowsContainer);W(this.dom.upper).appendTo(this.dom.topRow);W(this.dom.lower).appendTo(this.dom.topRow);W(this.dom.searchCont).appendTo(this.dom.upper);W(this.dom.buttonGroup).appendTo(this.dom.lower);if(this.c.dtOpts.searching===false||t.dtOpts!==undefined&&t.dtOpts.searching===false||(!this.c.controls||!t.controls)||this.customPaneSettings!==null&&this.customPaneSettings.dtOpts!==undefined&&this.customPaneSettings.dtOpts.searching!==undefined&&!this.customPaneSettings.dtOpts.searching){W(this.dom.searchBox).attr("disabled","disabled").removeClass(this.classes.paneInputButton).addClass(this.classes.disabledButton)}W(this.dom.searchBox).appendTo(this.dom.searchCont);this._searchContSetup();if(this.c.clear&&this.c.controls&&t.controls){W(this.dom.clear).appendTo(this.dom.buttonGroup)}if(this.c.orderable&&t.orderable&&this.c.controls&&t.controls){W(this.dom.nameButton).appendTo(this.dom.buttonGroup)}if(!this.c.hideCount&&!t.hideCount&&this.c.orderable&&t.orderable&&this.c.controls&&t.controls){W(this.dom.countButton).appendTo(this.dom.buttonGroup)}W(this.dom.topRow).prependTo(this.dom.container);W(e).append(this.dom.dtP);W(e).show()};h.prototype._getBonusOptions=function(){var e={orthogonal:{threshold:null},threshold:null};return W.extend(true,{},h.defaults,e,this.c!==undefined?this.c:{})};h.prototype._getComparisonRows=function(){var e=this.s.colOpts;var t=e.options!==undefined?e.options:this.customPaneSettings!==null&&this.customPaneSettings.options!==undefined?this.customPaneSettings.options:undefined;if(t===undefined){return}var r=this.s.dt.rows({search:"applied"}).data().toArray();var n=this.s.dt.rows({search:"applied"});var i=this.s.dt.rows().data().toArray();var a=this.s.dt.rows();var o=[];this.s.dtPane.clear();for(var s=0,l=t;s<l.length;s++){var u=l[s];var f=u.label!==""?u.label:this.c.emptyMessage;var c={className:u.className,display:f,filter:typeof u.value==="function"?u.value:[],shown:0,sort:f,total:0,type:f};if(typeof u.value==="function"){for(var d=0;d<r.length;d++){if(u.value.call(this.s.dt,r[d],n[0][d])){c.shown++}}for(var h=0;h<i.length;h++){if(u.value.call(this.s.dt,i[h],a[0][h])){c.total++}}if(typeof c.filter!=="function"){c.filter.push(u.filter)}}if(!this.c.cascadePanes||this.c.cascadePanes&&c.shown!==0){o.push(this._addRow(c.display,c.filter,c.shown,c.total,c.sort,c.type,c.className))}}return o};h.prototype._getOptions=function(){var e=this.s.dt;var t={emptyMessage:false,orthogonal:{threshold:null},threshold:null};return W.extend(true,{},h.defaults,t,e.settings()[0].aoColumns[this.s.index].searchPanes)};h.prototype._makeSelection=function(){this.updateTable();this.s.updating=true;this.s.dt.draw();this.s.updating=false};h.prototype._populatePane=function(e){if(e===void 0){e=false}var t=this.s.dt;this.s.rowData.arrayFilter=[];this.s.rowData.bins={};var r=this.s.dt.settings()[0];if(!this.s.dt.page.info().serverSide){var n=(this.c.cascadePanes||this.c.viewTotal)&&(!this.s.clearing&&!e)?t.rows({search:"applied"}).indexes():t.rows().indexes();for(var i=0,a=n.toArray();i<a.length;i++){var o=a[i];this._populatePaneArray(o,this.s.rowData.arrayFilter,r)}}};h.prototype._populatePaneArray=function(e,t,r,n){if(n===void 0){n=this.s.rowData.bins}var i=this.s.colOpts;if(typeof i.orthogonal==="string"){var a=r.oApi._fnGetCellData(r,e,this.s.index,i.orthogonal);this.s.rowData.filterMap.set(e,a);this._addOption(a,a,a,a,t,n)}else{var o=r.oApi._fnGetCellData(r,e,this.s.index,i.orthogonal.search);if(o===null){o=""}if(typeof o==="string"){o=o.replace(/<[^>]*>/g,"")}this.s.rowData.filterMap.set(e,o);if(!n[o]){n[o]=1;this._addOption(o,r.oApi._fnGetCellData(r,e,this.s.index,i.orthogonal.display),r.oApi._fnGetCellData(r,e,this.s.index,i.orthogonal.sort),r.oApi._fnGetCellData(r,e,this.s.index,i.orthogonal.type),t,n);this.s.rowData.totalOptions++}else{n[o]++;this.s.rowData.totalOptions++;return}}};h.prototype._reloadSelect=function(e){if(e===undefined){return}var t;for(var r=0;r<e.searchPanes.panes.length;r++){if(e.searchPanes.panes[r].id===this.s.index){t=r;break}}if(t!==undefined){var n=this.s.dtPane;var i=n.rows({order:"index"}).data().map(function(e){return e.filter!==null?e.filter.toString():null}).toArray();for(var a=0,o=e.searchPanes.panes[t].selected;a<o.length;a++){var s=o[a];var l=-1;if(s!==null){l=i.indexOf(s.toString())}if(l>-1){this.s.serverSelecting=true;n.row(l).select();this.s.serverSelecting=false}}}};h.prototype._search=function(e,t){var r=this.s.colOpts;var n=this.s.dt;for(var i=0,a=this.selections;i<a.length;i++){var o=a[i];if(typeof o.filter==="string"){o.filter=o.filter.replaceAll("&amp;","&")}if(Array.isArray(e)){if(e.indexOf(o.filter)!==-1){return true}}else if(typeof o.filter==="function"){if(o.filter.call(n,n.row(t).data(),t)){if(r.combiner==="or"){return true}}else if(r.combiner==="and"){return false}}else if(e===o.filter||!(typeof e==="string"&&e.length===0)&&e==o.filter||o.filter===null&&typeof e==="string"&&e===""){return true}}if(r.combiner==="and"){return true}else{return false}};h.prototype._searchContSetup=function(){if(this.c.controls&&this.s.colOpts.controls){W(this.dom.searchButton).appendTo(this.dom.searchLabelCont)}if(!(this.c.dtOpts.searching===false||this.s.colOpts.dtOpts.searching===false||this.customPaneSettings!==null&&this.customPaneSettings.dtOpts!==undefined&&this.customPaneSettings.dtOpts.searching!==undefined&&!this.customPaneSettings.dtOpts.searching)){W(this.dom.searchLabelCont).appendTo(this.dom.searchCont)}};h.prototype._searchExtras=function(){var e=this.s.updating;this.s.updating=true;var t=this.s.dtPane.rows({selected:true}).data().pluck("filter").toArray();var r=t.indexOf(this.s.colOpts.emptyMessage!==false?this.s.colOpts.emptyMessage:this.c.emptyMessage);var n=W(this.s.dtPane.table().container());if(r>-1){t[r]=""}if(t.length>0){n.addClass(this.classes.selected)}else if(t.length===0){n.removeClass(this.classes.selected)}this.s.updating=e};h.prototype._uniqueRatio=function(e,t){if(t>0&&(this.s.rowData.totalOptions>0&&!this.s.dt.page.info().serverSide||this.s.dt.page.info().serverSide&&this.s.tableLength>0)){return e/this.s.rowData.totalOptions}else{return 1}};h.prototype._updateCommon=function(e){if(e===void 0){e=false}if(!this.s.dt.page.info().serverSide&&this.s.dtPane!==undefined&&(!this.s.filteringActive||this.c.cascadePanes||e===true)&&(this.c.cascadePanes!==true||this.s.selectPresent!==true)&&(!this.s.lastSelect||!this.s.lastCascade)){var t=this.s.colOpts;var n=this.s.dtPane.rows({selected:true}).data().toArray();var r=W(this.s.dtPane.table().node()).parent()[0].scrollTop;var i=this.s.rowData;this.s.dtPane.clear();if(this.colExists){if(i.arrayFilter.length===0){this._populatePane()}else if(this.c.cascadePanes&&this.s.dt.rows().data().toArray().length===this.s.dt.rows({search:"applied"}).data().toArray().length){i.arrayFilter=i.arrayOriginal;i.bins=i.binsOriginal}else if(this.c.viewTotal||this.c.cascadePanes){this._populatePane()}if(this.c.viewTotal){this._detailsPane()}else{i.binsTotal=i.bins}if(this.c.viewTotal&&!this.c.cascadePanes){i.arrayFilter=i.arrayTotals}var a=function(t){if(t&&(i.bins[t.filter]!==undefined&&i.bins[t.filter]!==0&&o.c.cascadePanes||!o.c.cascadePanes||o.s.clearing)){var e=o._addRow(t.display,t.filter,!o.c.viewTotal?i.bins[t.filter]:i.bins[t.filter]!==undefined?i.bins[t.filter]:0,o.c.viewTotal?String(i.binsTotal[t.filter]):i.bins[t.filter],t.sort,t.type);var r=n.findIndex(function(e){return e.filter===t.filter});if(r!==-1){e.select();n.splice(r,1)}}};var o=this;for(var s=0,l=i.arrayFilter;s<l.length;s++){var u=l[s];a(u)}}if(t.searchPanes!==undefined&&t.searchPanes.options!==undefined||t.options!==undefined||this.customPaneSettings!==null&&this.customPaneSettings.options!==undefined){var f=this._getComparisonRows();var c=function(t){var e=n.findIndex(function(e){if(e.display===t.data().display){return true}});if(e!==-1){t.select();n.splice(e,1)}};for(var d=0,h=f;d<h.length;d++){var v=h[d];c(v)}}for(var p=0,g=n;p<g.length;p++){var m=g[p];var v=this._addRow(m.display,m.filter,0,this.c.viewTotal?m.total:0,m.display,m.display);this.s.updating=true;v.select();this.s.updating=false}this.s.dtPane.draw();this.s.dtPane.table().node().parentNode.scrollTop=r}};h.version="1.1.0";h.classes={buttonGroup:"dtsp-buttonGroup",buttonSub:"dtsp-buttonSub",clear:"dtsp-clear",clearAll:"dtsp-clearAll",clearButton:"clearButton",container:"dtsp-searchPane",countButton:"dtsp-countButton",disabledButton:"dtsp-disabledButton",dull:"dtsp-dull",hidden:"dtsp-hidden",hide:"dtsp-hide",layout:"dtsp-",name:"dtsp-name",nameButton:"dtsp-nameButton",nameCont:"dtsp-nameCont",narrow:"dtsp-narrow",paneButton:"dtsp-paneButton",paneInputButton:"dtsp-paneInputButton",pill:"dtsp-pill",search:"dtsp-search",searchCont:"dtsp-searchCont",searchIcon:"dtsp-searchIcon",searchLabelCont:"dtsp-searchButtonCont",selected:"dtsp-selected",smallGap:"dtsp-smallGap",subRow1:"dtsp-subRow1",subRow2:"dtsp-subRow2",subRowsContainer:"dtsp-subRowsContainer",title:"dtsp-title",topRow:"dtsp-topRow"};h.defaults={cascadePanes:false,clear:true,combiner:"or",controls:true,container:function(e){return e.table().container()},dtOpts:{},emptyMessage:"<i>No Data</i>",hideCount:false,layout:"columns-3",name:undefined,orderable:true,orthogonal:{display:"display",filter:"filter",hideCount:false,search:"filter",show:undefined,sort:"sort",threshold:.6,type:"type"},preSelect:[],threshold:.6,viewTotal:false};return h}();var k;var a;function s(e){k=e;a=e.fn.dataTable}var l=function(){function i(t,r,e){var l=this;if(e===void 0){e=false}this.regenerating=false;if(!a||!a.versionCheck||!a.versionCheck("1.10.0")){throw new Error("SearchPane requires DataTables 1.10 or newer")}if(!a.select){throw new Error("SearchPane requires Select")}var n=new a.Api(t);this.classes=k.extend(true,{},i.classes);this.c=k.extend(true,{},i.defaults,r);this.dom={clearAll:k('<button type="button">Clear All</button>').addClass(this.classes.clearAll),container:k("<div/>").addClass(this.classes.panes).text(n.i18n("searchPanes.loadMessage","Loading Search Panes...")),emptyMessage:k("<div/>").addClass(this.classes.emptyMessage),options:k("<div/>").addClass(this.classes.container),panes:k("<div/>").addClass(this.classes.container),title:k("<div/>").addClass(this.classes.title),titleRow:k("<div/>").addClass(this.classes.titleRow),wrapper:k("<div/>")};this.s={colOpts:[],dt:n,filterCount:0,filterPane:-1,page:0,panes:[],selectionList:[],serverData:{},stateRead:false,updating:false};if(n.settings()[0]._searchPanes!==undefined){return}this._getState();if(this.s.dt.page.info().serverSide){n.on("preXhr.dt",function(e,t,r){if(r.searchPanes===undefined){r.searchPanes={}}for(var n=0,i=l.s.selectionList;n<i.length;n++){var a=i[n];var o=l.s.dt.column(a.index).dataSrc();if(r.searchPanes[o]===undefined){r.searchPanes[o]={}}for(var s=0;s<a.rows.length;s++){r.searchPanes[o][s]=a.rows[s].filter}}})}n.on("xhr",function(e,t,r,n){if(r&&r.searchPanes&&r.searchPanes.options){l.s.serverData=r;l.s.serverData.tableLength=r.recordsTotal;l._serverTotals()}});n.settings()[0]._searchPanes=this;this.dom.clearAll.text(n.i18n("searchPanes.clearMessage","Clear All"));if(this.s.dt.settings()[0]._bInitComplete||e){this._paneDeclare(n,t,r)}else{n.one("preInit.dt",function(e){l._paneDeclare(n,t,r)})}return this}i.prototype.clearSelections=function(){var e=this.dom.container.find(this.classes.search);e.each(function(){k(this).val("");k(this).trigger("input")});var t=[];for(var r=0,n=this.s.panes;r<n.length;r++){var i=n[r];if(i.s.dtPane!==undefined){t.push(i.clearPane())}}this.s.dt.draw();return t};i.prototype.getNode=function(){return this.dom.container};i.prototype.rebuild=function(e,t){if(e===void 0){e=false}if(t===void 0){t=false}k(this.dom.emptyMessage).remove();var r=[];if(e===false){k(this.dom.panes).empty()}for(var n=0,i=this.s.panes;n<i.length;n++){var a=i[n];if(e!==false&&a.s.index!==e){continue}a.clearData();r.push(a.rebuildPane(this.s.selectionList[this.s.selectionList.length-1]!==undefined?a.s.index===this.s.selectionList[this.s.selectionList.length-1].index:false,this.s.dt.page.info().serverSide?this.s.serverData:undefined,null,t));k(this.dom.panes).append(a.dom.container)}if(!this.s.dt.page.info().serverSide){this.s.dt.draw()}if(this.c.cascadePanes||this.c.viewTotal){this.redrawPanes(true)}else{this._updateSelection()}this._updateFilterCount();this._attachPaneContainer();this.s.dt.draw();if(r.length===1){return r[0]}else{return r}};i.prototype.redrawPanes=function(e){if(e===void 0){e=false}var t=this.s.dt;if(!this.s.updating&&!this.s.dt.page.info().serverSide){var r=true;var n=this.s.filterPane;if(t.rows({search:"applied"}).data().toArray().length===t.rows().data().toArray().length){r=false}else if(this.c.viewTotal){for(var i=0,a=this.s.panes;i<a.length;i++){var o=a[i];if(o.s.dtPane!==undefined){var s=o.s.dtPane.rows({selected:true}).data().toArray().length;if(s===0){for(var l=0,u=this.s.selectionList;l<u.length;l++){var f=u[l];if(f.index===o.s.index&&f.rows.length!==0){s=f.rows.length}}}if(s>0&&n===-1){n=o.s.index}else if(s>0){n=null}}}}var c=void 0;var d=[];if(!this.regenerating){for(var h=0,v=this.s.panes;h<v.length;h++){var o=v[h];if(o.s.selectPresent){this.s.selectionList.push({index:o.s.index,rows:o.s.dtPane.rows({selected:true}).data().toArray(),protect:false});t.state.save();break}else if(o.s.deselect){c=o.s.index;var p=o.s.dtPane.rows({selected:true}).data().toArray();if(p.length>0){this.s.selectionList.push({index:o.s.index,rows:p,protect:true})}}}if(this.s.selectionList.length>0){var g=this.s.selectionList[this.s.selectionList.length-1].index;for(var m=0,y=this.s.panes;m<y.length;m++){var o=y[m];o.s.lastSelect=o.s.index===g}}for(var b=0;b<this.s.selectionList.length;b++){if(this.s.selectionList[b].index!==c||this.s.selectionList[b].protect===true){var w=false;for(var C=b+1;C<this.s.selectionList.length;C++){if(this.s.selectionList[C].index===this.s.selectionList[b].index){w=true}}if(!w){d.push(this.s.selectionList[b]);this.s.selectionList[b].protect=false}}}var S=-1;if(d.length===1){S=d[0].index}for(var E=0,k=this.s.panes;E<k.length;E++){var o=k[E];if(o.s.dtPane!==undefined){var T=true;o.s.filteringActive=true;if(n!==-1&&n!==null&&n===o.s.index||r===false||o.s.index===S){T=false;o.s.filteringActive=false}o.updatePane(!T?false:r)}}this._updateFilterCount();if(d.length>0&&(d.length<this.s.selectionList.length||e)){this._cascadeRegen(d);var g=d[d.length-1].index;for(var _=0,x=this.s.panes;_<x.length;_++){var o=x[_];o.s.lastSelect=o.s.index===g}}else if(d.length>0){for(var D=0,R=this.s.panes;D<R.length;D++){var I=R[D];if(I.s.dtPane!==undefined){var T=true;I.s.filteringActive=true;if(n!==-1&&n!==null&&n===I.s.index||r===false){T=false;I.s.filteringActive=false}I.updatePane(!T?T:r)}}}}else{var S=-1;if(d.length===1){S=d[0].index}for(var O=0,A=this.s.panes;O<A.length;O++){var o=A[O];if(o.s.dtPane!==undefined){var T=true;o.s.filteringActive=true;if(n!==-1&&n!==null&&n===o.s.index||r===false||o.s.index===S){T=false;o.s.filteringActive=false}o.updatePane(!T?T:r)}}this._updateFilterCount()}if(!r){this.s.selectionList=[]}}};i.prototype._attach=function(){var e=this;k(this.dom.container).removeClass(this.classes.hide);k(this.dom.titleRow).removeClass(this.classes.hide);k(this.dom.titleRow).remove();k(this.dom.title).appendTo(this.dom.titleRow);if(this.c.clear){k(this.dom.clearAll).appendTo(this.dom.titleRow);k(this.dom.clearAll).on("click.dtsps",function(){e.clearSelections()})}k(this.dom.titleRow).appendTo(this.dom.container);for(var t=0,r=this.s.panes;t<r.length;t++){var n=r[t];k(n.dom.container).appendTo(this.dom.panes)}k(this.dom.panes).appendTo(this.dom.container);if(k("div."+this.classes.container).length===0){k(this.dom.container).prependTo(this.s.dt)}return this.dom.container};i.prototype._attachExtras=function(){k(this.dom.container).removeClass(this.classes.hide);k(this.dom.titleRow).removeClass(this.classes.hide);k(this.dom.titleRow).remove();k(this.dom.title).appendTo(this.dom.titleRow);if(this.c.clear){k(this.dom.clearAll).appendTo(this.dom.titleRow)}k(this.dom.titleRow).appendTo(this.dom.container);return this.dom.container};i.prototype._attachMessage=function(){var t;try{t=this.s.dt.i18n("searchPanes.emptyPanes","No SearchPanes")}catch(e){t=null}if(t===null){k(this.dom.container).addClass(this.classes.hide);k(this.dom.titleRow).removeClass(this.classes.hide);return}else{k(this.dom.container).removeClass(this.classes.hide);k(this.dom.titleRow).addClass(this.classes.hide)}k(this.dom.emptyMessage).text(t);this.dom.emptyMessage.appendTo(this.dom.container);return this.dom.container};i.prototype._attachPaneContainer=function(){for(var e=0,t=this.s.panes;e<t.length;e++){var r=t[e];if(r.s.displayed===true){return this._attach()}}return this._attachMessage()};i.prototype._cascadeRegen=function(e){this.regenerating=true;var t=-1;if(e.length===1){t=e[0].index}for(var r=0,n=this.s.panes;r<n.length;r++){var i=n[r];i.setCascadeRegen(true);i.setClear(true);if(i.s.dtPane!==undefined&&i.s.index===t||i.s.dtPane!==undefined){i.clearPane()}i.setClear(false)}this._makeCascadeSelections(e);this.s.selectionList=e;for(var a=0,o=this.s.panes;a<o.length;a++){var i=o[a];i.setCascadeRegen(false)}this.regenerating=false};i.prototype._checkMessage=function(){for(var e=0,t=this.s.panes;e<t.length;e++){var r=t[e];if(r.s.displayed===true){return}}return this._attachMessage()};i.prototype._getState=function(){var e=this.s.dt.state.loaded();if(e&&e.searchPanes&&e.searchPanes.selectionList!==undefined){this.s.selectionList=e.searchPanes.selectionList}};i.prototype._makeCascadeSelections=function(a){for(var o=0;o<a.length;o++){var e=function(r){if(r.s.index===a[o].index&&r.s.dtPane!==undefined){if(o===a.length-1){r.s.lastCascade=true}if(r.s.dtPane.rows({selected:true}).data().toArray().length>0&&r.s.dtPane!==undefined){r.setClear(true);r.clearPane();r.setClear(false)}var e=function(t){r.s.dtPane.rows().every(function(e){if(r.s.dtPane.row(e).data()!==undefined&&t!==undefined&&r.s.dtPane.row(e).data().filter===t.filter){r.s.dtPane.row(e).select()}})};for(var t=0,n=a[o].rows;t<n.length;t++){var i=n[t];e(i)}s._updateFilterCount();r.s.lastCascade=false}};var s=this;for(var t=0,r=this.s.panes;t<r.length;t++){var n=r[t];e(n)}}this.s.dt.state.save()};i.prototype._paneDeclare=function(e,t,r){var n=this;e.columns(this.c.columns.length>0?this.c.columns:undefined).eq(0).each(function(e){n.s.panes.push(new d(t,r,e,n.c.layout,n.dom.panes))});var i=e.columns().eq(0).toArray().length;var a=this.c.panes.length;for(var o=0;o<a;o++){var s=i+o;this.s.panes.push(new d(t,r,s,this.c.layout,this.dom.panes,this.c.panes[o]))}if(this.c.order.length>0){var l=this.c.order.map(function(e,t,r){return n._findPane(e)});this.dom.panes.empty();this.s.panes=l;for(var u=0,f=this.s.panes;u<f.length;u++){var c=f[u];this.dom.panes.append(c.dom.container)}}if(this.s.dt.settings()[0]._bInitComplete){this._startup(e)}else{this.s.dt.settings()[0].aoInitComplete.push({fn:function(){n._startup(e)}})}};i.prototype._findPane=function(e){for(var t=0,r=this.s.panes;t<r.length;t++){var n=r[t];if(e===n.s.name){return n}}};i.prototype._serverTotals=function(){var e=false;var t=false;var r=this.s.dt;for(var n=0,i=this.s.panes;n<i.length;n++){var a=i[n];if(a.s.selectPresent){this.s.selectionList.push({index:a.s.index,rows:a.s.dtPane.rows({selected:true}).data().toArray(),protect:false});r.state.save();a.s.selectPresent=false;e=true;break}else if(a.s.deselect){var o=a.s.dtPane.rows({selected:true}).data().toArray();if(o.length>0){this.s.selectionList.push({index:a.s.index,rows:o,protect:true})}e=true;t=true}}if(!e){this.s.selectionList=[]}else{var s=[];for(var l=0;l<this.s.selectionList.length;l++){var u=false;for(var f=l+1;f<this.s.selectionList.length;f++){if(this.s.selectionList[f].index===this.s.selectionList[l].index){u=true}}if(!u){var c=false;for(var d=0,h=this.s.panes;d<h.length;d++){var a=h[d];if(a.s.index===this.s.selectionList[l].index&&a.s.dtPane.rows({selected:true}).data().toArray().length>0){c=true}}if(c){s.push(this.s.selectionList[l])}}}this.s.selectionList=s}var v=-1;if(t&&this.s.selectionList.length===1){for(var p=0,g=this.s.panes;p<g.length;p++){var a=g[p];a.s.lastSelect=false;a.s.deselect=false;if(a.s.dtPane!==undefined&&a.s.dtPane.rows({selected:true}).data().toArray().length>0){v=a.s.index}}}else if(this.s.selectionList.length>0){var m=this.s.selectionList[this.s.selectionList.length-1].index;for(var y=0,b=this.s.panes;y<b.length;y++){var a=b[y];a.s.lastSelect=a.s.index===m;a.s.deselect=false}}else if(this.s.selectionList.length===0){for(var w=0,C=this.s.panes;w<C.length;w++){var a=C[w];a.s.lastSelect=false;a.s.deselect=false}}k(this.dom.panes).empty();for(var S=0,E=this.s.panes;S<E.length;S++){var a=E[S];if(!a.s.lastSelect){a.rebuildPane(undefined,this.s.dt.page.info().serverSide?this.s.serverData:undefined,a.s.index===v?true:null,true)}else{a._setListeners()}k(this.dom.panes).append(a.dom.container);if(a.s.dtPane!==undefined){k(a.s.dtPane.table().node()).parent()[0].scrollTop=a.s.scrollTop;k.fn.dataTable.select.init(a.s.dtPane)}}if(!this.s.dt.page.info().serverSide){this.s.dt.draw()}};i.prototype._startup=function(n){var f=this;k(this.dom.container).text("");this._attachExtras();k(this.dom.container).append(this.dom.panes);k(this.dom.panes).empty();var e=this.s.dt.state.loaded();if(this.c.viewTotal&&!this.c.cascadePanes){if(e!==null&&e!==undefined&&e.searchPanes!==undefined&&e.searchPanes.panes!==undefined){var t=false;for(var r=0,i=e.searchPanes.panes;r<i.length;r++){var a=i[r];if(a.selected.length>0){t=true;break}}if(t){for(var o=0,s=this.s.panes;o<s.length;o++){var a=s[o];a.s.showFiltered=true}}}}for(var l=0,u=this.s.panes;l<u.length;l++){var a=u[l];a.rebuildPane(undefined,Object.keys(this.s.serverData).length>0?this.s.serverData:undefined);k(this.dom.panes).append(a.dom.container)}if(!this.s.dt.page.info().serverSide){this.s.dt.draw()}if(!this.s.stateRead&&e!==null&&e!==undefined){this.s.dt.page(e.start/this.s.dt.page.len());this.s.dt.draw("page")}this.s.stateRead=true;if(this.c.viewTotal&&!this.c.cascadePanes){for(var c=0,d=this.s.panes;c<d.length;c++){var a=d[c];a.updatePane()}}this._updateFilterCount();this._checkMessage();n.on("preDraw.dtsps",function(){f._updateFilterCount();if((f.c.cascadePanes||f.c.viewTotal)&&!f.s.dt.page.info().serverSide){f.redrawPanes()}else{f._updateSelection()}f.s.filterPane=-1});this.s.dt.on("stateSaveParams.dtsp",function(e,t,r){if(r.searchPanes===undefined){r.searchPanes={}}r.searchPanes.selectionList=f.s.selectionList});if(this.s.dt.page.info().serverSide){n.off("page");n.on("page",function(){f.s.page=f.s.dt.page()});n.off("preXhr.dt");n.on("preXhr.dt",function(e,t,r){if(r.searchPanes===undefined){r.searchPanes={}}var n=0;for(var i=0,a=f.s.panes;i<a.length;i++){var o=a[i];var s=f.s.dt.column(o.s.index).dataSrc();if(r.searchPanes[s]===undefined){r.searchPanes[s]={}}if(o.s.dtPane!==undefined){var l=o.s.dtPane.rows({selected:true}).data().toArray();for(var u=0;u<l.length;u++){r.searchPanes[s][u]=l[u].filter;n++}}}if(f.c.viewTotal){f._prepViewTotal()}if(n>0){if(n!==f.s.filterCount){r.start=0;f.s.page=0}else{r.start=f.s.page*f.s.dt.page.len()}f.s.dt.page(f.s.page);f.s.filterCount=n}})}else{n.on("preXhr.dt",function(e,t,r){for(var n=0,i=f.s.panes;n<i.length;n++){var a=i[n];a.clearData()}})}this.s.dt.on("xhr",function(e,t,r,n){var i=false;if(!f.s.dt.page.info().serverSide){f.s.dt.one("preDraw",function(){if(i){return}var e=f.s.dt.page();i=true;k(f.dom.panes).empty();for(var t=0,r=f.s.panes;t<r.length;t++){var n=r[t];n.clearData();n.rebuildPane(f.s.selectionList[f.s.selectionList.length-1]!==undefined?n.s.index===f.s.selectionList[f.s.selectionList.length-1].index:false,undefined,undefined,true);k(f.dom.panes).append(n.dom.container)}if(!f.s.dt.page.info().serverSide){f.s.dt.draw()}if(f.c.cascadePanes||f.c.viewTotal){f.redrawPanes(f.c.cascadePanes)}else{f._updateSelection()}f._checkMessage();f.s.dt.one("draw",function(){f.s.dt.page(e).draw(false)})})}});for(var h=0,v=this.s.panes;h<v.length;h++){var a=v[h];if(a!==undefined&&a.s.dtPane!==undefined&&(a.s.colOpts.preSelect!==undefined&&a.s.colOpts.preSelect.length>0||a.customPaneSettings!==null&&a.customPaneSettings.preSelect!==undefined&&a.customPaneSettings.preSelect.length>0)){var p=a.s.dtPane.rows().data().toArray().length;for(var g=0;g<p;g++){if(a.s.colOpts.preSelect.indexOf(a.s.dtPane.cell(g,0).data())!==-1||a.customPaneSettings!==null&&a.customPaneSettings.preSelect!==undefined&&a.customPaneSettings.preSelect.indexOf(a.s.dtPane.cell(g,0).data())!==-1){a.s.dtPane.row(g).select()}}a.updateTable()}}if(this.s.selectionList!==undefined&&this.s.selectionList.length>0){var m=this.s.selectionList[this.s.selectionList.length-1].index;for(var y=0,b=this.s.panes;y<b.length;y++){var a=b[y];a.s.lastSelect=a.s.index===m}}if(this.s.selectionList.length>0&&this.c.cascadePanes){this._cascadeRegen(this.s.selectionList)}this._updateFilterCount();n.on("destroy.dtsps",function(){for(var e=0,t=f.s.panes;e<t.length;e++){var r=t[e];r.destroy()}n.off(".dtsps");k(f.dom.clearAll).off(".dtsps");k(f.dom.container).remove();f.clearSelections()});if(this.c.clear){k(this.dom.clearAll).on("click.dtsps",function(){f.clearSelections()})}n.settings()[0]._searchPanes=this};i.prototype._prepViewTotal=function(){var e=this.s.filterPane;var t=false;for(var r=0,n=this.s.panes;r<n.length;r++){var i=n[r];if(i.s.dtPane!==undefined){var a=i.s.dtPane.rows({selected:true}).data().toArray().length;if(a>0&&e===-1){e=i.s.index;t=true}else if(a>0){e=null}}}for(var o=0,s=this.s.panes;o<s.length;o++){var i=s[o];if(i.s.dtPane!==undefined){i.s.filteringActive=true;if(e!==-1&&e!==null&&e===i.s.index||t===false){i.s.filteringActive=false}}}};i.prototype._updateFilterCount=function(){var e=0;for(var t=0,r=this.s.panes;t<r.length;t++){var n=r[t];if(n.s.dtPane!==undefined){e+=n.getPaneCount()}}var i=this.s.dt.i18n("searchPanes.title","Filters Active - %d",e);k(this.dom.title).text(i);if(this.c.filterChanged!==undefined&&typeof this.c.filterChanged==="function"){this.c.filterChanged.call(this.s.dt,e)}};i.prototype._updateSelection=function(){this.s.selectionList=[];for(var e=0,t=this.s.panes;e<t.length;e++){var r=t[e];if(r.s.dtPane!==undefined){this.s.selectionList.push({index:r.s.index,rows:r.s.dtPane.rows({selected:true}).data().toArray(),protect:false})}}this.s.dt.state.save()};i.version="1.2.2";i.classes={clear:"dtsp-clear",clearAll:"dtsp-clearAll",container:"dtsp-searchPanes",emptyMessage:"dtsp-emptyMessage",hide:"dtsp-hidden",panes:"dtsp-panesContainer",search:"dtsp-search",title:"dtsp-title",titleRow:"dtsp-titleRow"};i.defaults={cascadePanes:false,clear:true,container:function(e){return e.table().container()},columns:[],filterChanged:undefined,layout:"columns-3",order:[],panes:[],viewTotal:false};return i}();(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(window.jQuery,window,document)}})(function(a,e,t){i(a);s(a);var o=a.fn.dataTable;a.fn.dataTable.SearchPanes=l;a.fn.DataTable.SearchPanes=l;a.fn.dataTable.SearchPane=d;a.fn.DataTable.SearchPane=d;var r=a.fn.dataTable.Api.register;r("searchPanes()",function(){return this});r("searchPanes.clearSelections()",function(){return this.iterator("table",function(e){if(e._searchPanes){e._searchPanes.clearSelections()}})});r("searchPanes.rebuildPane()",function(t,r){return this.iterator("table",function(e){if(e._searchPanes){e._searchPanes.rebuild(t,r)}})});r("searchPanes.container()",function(){var e=this.context[0];return e._searchPanes?e._searchPanes.getNode():null});a.fn.dataTable.ext.buttons.searchPanesClear={text:"Clear Panes",action:function(e,t,r,n){t.searchPanes.clearSelections()}};a.fn.dataTable.ext.buttons.searchPanes={action:function(e,t,r,n){e.stopPropagation();this.popover(n._panes.getNode(),{align:"dt-container"});n._panes.rebuild(undefined,true)},config:{},init:function(t,r,e){var n=new a.fn.dataTable.SearchPanes(t,a.extend({filterChanged:function(e){t.button(r).text(t.i18n("searchPanes.collapse",{0:"SearchPanes",_:"SearchPanes (%d)"},e))}},e.config));var i=t.i18n("searchPanes.collapse","SearchPanes",0);t.button(r).text(i);e._panes=n},text:"Search Panes"};function n(e,t){if(t===void 0){t=false}var r=new o.Api(e);var n=r.init().searchPanes||o.defaults.searchPanes;var i=new l(r,n,t);var a=i.getNode();return a}a(t).on("preInit.dt.dtsp",function(e,t,r){if(e.namespace!=="dt"){return}if(t.oInit.searchPanes||o.defaults.searchPanes){if(!t._searchPanes){n(t,true)}}});o.ext.feature.push({cFeature:"P",fnInit:n});if(o.ext.features){o.ext.features.register("searchPanes",n)}})})();(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net-dt","datatables.net-searchpanes"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net-dt")(e,t).$}if(!t.fn.dataTable.SearchPanes){require("datatables.net-searchpanes")(e,t)}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(e,t,r){"use strict";var n=e.fn.dataTable;return n.searchPanes});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(h,c,e,v){"use strict";var p=h.fn.dataTable;p.select={};p.select.version="1.3.3";p.select.init=function(e){var t=e.settings()[0];var r=t.oInit.select;var n=p.defaults.select;var i=r===v?n:r;var a="row";var o="api";var s=false;var l=true;var u=true;var f="td, th";var c="selected";var d=false;t._select={};if(i===true){o="os";d=true}else if(typeof i==="string"){o=i;d=true}else if(h.isPlainObject(i)){if(i.blurable!==v){s=i.blurable}if(i.toggleable!==v){l=i.toggleable}if(i.info!==v){u=i.info}if(i.items!==v){a=i.items}if(i.style!==v){o=i.style;d=true}else{o="os";d=true}if(i.selector!==v){f=i.selector}if(i.className!==v){c=i.className}}e.select.selector(f);e.select.items(a);e.select.style(o);e.select.blurable(s);e.select.toggleable(l);e.select.info(u);t._select.className=c;h.fn.dataTable.ext.order["select-checkbox"]=function(t,e){return this.api().column(e,{order:"index"}).nodes().map(function(e){if(t._select.items==="row"){return h(e).parent().hasClass(t._select.className)}else if(t._select.items==="cell"){return h(e).hasClass(t._select.className)}return false})};if(!d&&h(e.table().node()).hasClass("selectable")){e.select.style("os")}};function u(a,e,t){var r;var n;var i;var o=function(t,r){if(t>r){var e=r;r=t;t=e}var n=false;return a.columns(":visible").indexes().filter(function(e){if(e===t){n=true}if(e===r){n=false;return true}return n})};var s=function(t,r){var e=a.rows({search:"applied"}).indexes();if(e.indexOf(t)>e.indexOf(r)){var n=r;r=t;t=n}var i=false;return e.filter(function(e){if(e===t){i=true}if(e===r){i=false;return true}return i})};if(!a.cells({selected:true}).any()&&!t){n=o(0,e.column);i=s(0,e.row)}else{n=o(t.column,e.column);i=s(t.row,e.row)}r=a.cells(i,n).flatten();if(!a.cells(e,{selected:true}).any()){a.cells(r).select()}else{a.cells(r).deselect()}}function n(e){var t=e.settings()[0];var r=t._select.selector;h(e.table().container()).off("mousedown.dtSelect",r).off("mouseup.dtSelect",r).off("click.dtSelect",r);h("body").off("click.dtSelect"+s(e.table().node()))}function i(u){var t=h(u.table().container());var r=u.settings()[0];var n=r._select.selector;var f;t.on("mousedown.dtSelect",n,function(e){if(e.shiftKey||e.metaKey||e.ctrlKey){t.css("-moz-user-select","none").one("selectstart.dtSelect",n,function(){return false})}if(c.getSelection){f=c.getSelection()}}).on("mouseup.dtSelect",n,function(){t.css("-moz-user-select","")}).on("click.dtSelect",n,function(e){var t=u.select.items();var r;if(f){var n=c.getSelection();if(!n.anchorNode||h(n.anchorNode).closest("table")[0]===u.table().node()){if(n!==f){return}}}var i=u.settings()[0];var a=u.settings()[0].oClasses.sWrapper.trim().replace(/ +/g,".");if(h(e.target).closest("div."+a)[0]!=u.table().container()){return}var o=u.cell(h(e.target).closest("td, th"));if(!o.any()){return}var s=h.Event("user-select.dt");d(u,s,[t,o,e]);if(s.isDefaultPrevented()){return}var l=o.index();if(t==="row"){r=l.row;g(e,u,i,"row",r)}else if(t==="column"){r=o.index().column;g(e,u,i,"column",r)}else if(t==="cell"){r=o.index();g(e,u,i,"cell",r)}i._select_lastCell=l});h("body").on("click.dtSelect"+s(u.table().node()),function(e){if(r._select.blurable){if(h(e.target).parents().filter(u.table().container()).length){return}if(h(e.target).parents("html").length===0){return}if(h(e.target).parents("div.DTE").length){return}o(r,true)}})}function d(e,t,r,n){if(n&&!e.flatten().length){return}if(typeof t==="string"){t=t+".dt"}r.unshift(e);h(e.table().node()).trigger(t,r)}function t(n){var e=n.settings()[0];if(!e._select.info||!e.aanFeatures.i){return}if(n.select.style()==="api"){return}var i=n.rows({selected:true}).flatten().length;var a=n.columns({selected:true}).flatten().length;var o=n.cells({selected:true}).flatten().length;var s=function(e,t,r){e.append(h('<span class="select-item"/>').append(n.i18n("select."+t+"s",{_:"%d "+t+"s selected",0:"",1:"1 "+t+" selected"},r)))};h.each(e.aanFeatures.i,function(e,t){t=h(t);var r=h('<span class="select-info"/>');s(r,"row",i);s(r,"column",a);s(r,"cell",o);var n=t.children("span.select-info");if(n.length){n.remove()}if(r.text()!==""){t.append(r)}})}function a(o){var i=new p.Api(o);o.aoRowCreatedCallback.push({fn:function(e,t,r){var n,i;var a=o.aoData[r];if(a._select_selected){h(e).addClass(o._select.className)}for(n=0,i=o.aoColumns.length;n<i;n++){if(o.aoColumns[n]._select_selected||a._selected_cells&&a._selected_cells[n]){h(a.anCells[n]).addClass(o._select.className)}}},sName:"select-deferRender"});i.on("preXhr.dt.dtSelect",function(e,t){if(t!==i.settings()[0]){return}var r=i.rows({selected:true}).ids(true).filter(function(e){return e!==v});var n=i.cells({selected:true}).eq(0).map(function(e){var t=i.row(e.row).id(true);return t?{row:t,column:e.column}:v}).filter(function(e){return e!==v});i.one("draw.dt.dtSelect",function(){i.rows(r).select();if(n.any()){n.each(function(e){i.cells(e.row,e.column).select()})}})});i.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt info.dt",function(){t(i)});i.on("destroy.dtSelect",function(){i.rows({selected:true}).deselect();n(i);i.off(".dtSelect")})}function f(e,t,r,n){var i=e[t+"s"]({search:"applied"}).indexes();var a=h.inArray(n,i);var o=h.inArray(r,i);if(!e[t+"s"]({selected:true}).any()&&a===-1){i.splice(h.inArray(r,i)+1,i.length)}else{if(a>o){var s=o;o=a;a=s}i.splice(o+1,i.length);i.splice(0,a)}if(!e[t](r,{selected:true}).any()){e[t+"s"](i).select()}else{i.splice(h.inArray(r,i),1);e[t+"s"](i).deselect()}}function o(e,t){if(t||e._select.style==="single"){var r=new p.Api(e);r.rows({selected:true}).deselect();r.columns({selected:true}).deselect();r.cells({selected:true}).deselect()}}function g(e,t,r,n,i){var a=t.select.style();var o=t.select.toggleable();var s=t[n](i,{selected:true}).any();if(s&&!o){return}if(a==="os"){if(e.ctrlKey||e.metaKey){t[n](i).select(!s)}else if(e.shiftKey){if(n==="cell"){u(t,i,r._select_lastCell||null)}else{f(t,n,i,r._select_lastCell?r._select_lastCell[n]:null)}}else{var l=t[n+"s"]({selected:true});if(s&&l.flatten().length===1){t[n](i).deselect()}else{l.deselect();t[n](i).select()}}}else if(a=="multi+shift"){if(e.shiftKey){if(n==="cell"){u(t,i,r._select_lastCell||null)}else{f(t,n,i,r._select_lastCell?r._select_lastCell[n]:null)}}else{t[n](i).select(!s)}}else{t[n](i).select(!s)}}function s(e){return e.id.replace(/[^a-zA-Z0-9\-\_]/g,"-")}h.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],function(e,l){p.ext.selector[l.type].push(function(e,t,r){var n=t.selected;var i;var a=[];if(n!==true&&n!==false){return r}for(var o=0,s=r.length;o<s;o++){i=e[l.prop][r[o]];if(n===true&&i._select_selected===true||n===false&&!i._select_selected){a.push(r[o])}}return a})});p.ext.selector.cell.push(function(e,t,r){var n=t.selected;var i;var a=[];if(n===v){return r}for(var o=0,s=r.length;o<s;o++){i=e.aoData[r[o].row];if(n===true&&i._selected_cells&&i._selected_cells[r[o].column]===true||n===false&&(!i._selected_cells||!i._selected_cells[r[o].column])){a.push(r[o])}}return a});var r=p.Api.register;var l=p.Api.registerPlural;r("select()",function(){return this.iterator("table",function(e){p.select.init(new p.Api(e))})});r("select.blurable()",function(t){if(t===v){return this.context[0]._select.blurable}return this.iterator("table",function(e){e._select.blurable=t})});r("select.toggleable()",function(t){if(t===v){return this.context[0]._select.toggleable}return this.iterator("table",function(e){e._select.toggleable=t})});r("select.info()",function(t){if(t===v){return this.context[0]._select.info}return this.iterator("table",function(e){e._select.info=t})});r("select.items()",function(t){if(t===v){return this.context[0]._select.items}return this.iterator("table",function(e){e._select.items=t;d(new p.Api(e),"selectItems",[t])})});r("select.style()",function(r){if(r===v){return this.context[0]._select.style}return this.iterator("table",function(e){e._select.style=r;if(!e._select_init){a(e)}var t=new p.Api(e);n(t);if(r!=="api"){i(t)}d(new p.Api(e),"selectStyle",[r])})});r("select.selector()",function(t){if(t===v){return this.context[0]._select.selector}return this.iterator("table",function(e){n(new p.Api(e));e._select.selector=t;if(e._select.style!=="api"){i(new p.Api(e))}})});l("rows().select()","row().select()",function(e){var r=this;if(e===false){return this.deselect()}this.iterator("row",function(e,t){o(e);e.aoData[t]._select_selected=true;h(e.aoData[t].nTr).addClass(e._select.className)});this.iterator("table",function(e,t){d(r,"select",["row",r[t]],true)});return this});l("columns().select()","column().select()",function(e){var r=this;if(e===false){return this.deselect()}this.iterator("column",function(e,t){o(e);e.aoColumns[t]._select_selected=true;var r=new p.Api(e).column(t);h(r.header()).addClass(e._select.className);h(r.footer()).addClass(e._select.className);r.nodes().to$().addClass(e._select.className)});this.iterator("table",function(e,t){d(r,"select",["column",r[t]],true)});return this});l("cells().select()","cell().select()",function(e){var r=this;if(e===false){return this.deselect()}this.iterator("cell",function(e,t,r){o(e);var n=e.aoData[t];if(n._selected_cells===v){n._selected_cells=[]}n._selected_cells[r]=true;if(n.anCells){h(n.anCells[r]).addClass(e._select.className)}});this.iterator("table",function(e,t){d(r,"select",["cell",r.cells(r[t]).indexes().toArray()],true)});return this});l("rows().deselect()","row().deselect()",function(){var r=this;this.iterator("row",function(e,t){e.aoData[t]._select_selected=false;e._select_lastCell=null;h(e.aoData[t].nTr).removeClass(e._select.className)});this.iterator("table",function(e,t){d(r,"deselect",["row",r[t]],true)});return this});l("columns().deselect()","column().deselect()",function(){var r=this;this.iterator("column",function(n,e){n.aoColumns[e]._select_selected=false;var t=new p.Api(n);var r=t.column(e);h(r.header()).removeClass(n._select.className);h(r.footer()).removeClass(n._select.className);t.cells(null,e).indexes().each(function(e){var t=n.aoData[e.row];var r=t._selected_cells;if(t.anCells&&(!r||!r[e.column])){h(t.anCells[e.column]).removeClass(n._select.className)}})});this.iterator("table",function(e,t){d(r,"deselect",["column",r[t]],true)});return this});l("cells().deselect()","cell().deselect()",function(){var r=this;this.iterator("cell",function(e,t,r){var n=e.aoData[t];n._selected_cells[r]=false;if(n.anCells&&!e.aoColumns[r]._select_selected){h(n.anCells[r]).removeClass(e._select.className)}});this.iterator("table",function(e,t){d(r,"deselect",["cell",r[t]],true)});return this});function m(t,r){return function(e){return e.i18n("buttons."+t,r)}}function y(e){var t=e._eventNamespace;return"draw.dt.DT"+t+" select.dt.DT"+t+" deselect.dt.DT"+t}function b(e,t){if(h.inArray("rows",t.limitTo)!==-1&&e.rows({selected:true}).any()){return true}if(h.inArray("columns",t.limitTo)!==-1&&e.columns({selected:true}).any()){return true}if(h.inArray("cells",t.limitTo)!==-1&&e.cells({selected:true}).any()){return true}return false}var w=0;h.extend(p.ext.buttons,{selected:{text:m("selected","Selected"),className:"buttons-selected",limitTo:["rows","columns","cells"],init:function(e,t,r){var n=this;r._eventNamespace=".select"+w++;e.on(y(r),function(){n.enable(b(e,r))});this.disable()},destroy:function(e,t,r){e.off(r._eventNamespace)}},selectedSingle:{text:m("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(t,e,r){var n=this;r._eventNamespace=".select"+w++;t.on(y(r),function(){var e=t.rows({selected:true}).flatten().length+t.columns({selected:true}).flatten().length+t.cells({selected:true}).flatten().length;n.enable(e===1)});this.disable()},destroy:function(e,t,r){e.off(r._eventNamespace)}},selectAll:{text:m("selectAll","Select all"),className:"buttons-select-all",action:function(){var e=this.select.items();this[e+"s"]().select()}},selectNone:{text:m("selectNone","Deselect all"),className:"buttons-select-none",action:function(){o(this.settings()[0],true)},init:function(t,e,r){var n=this;r._eventNamespace=".select"+w++;t.on(y(r),function(){var e=t.rows({selected:true}).flatten().length+t.columns({selected:true}).flatten().length+t.cells({selected:true}).flatten().length;n.enable(e>0)});this.disable()},destroy:function(e,t,r){e.off(r._eventNamespace)}}});h.each(["Row","Column","Cell"],function(e,t){var i=t.toLowerCase();p.ext.buttons["select"+t+"s"]={text:m("select"+t+"s","Select "+i+"s"),className:"buttons-select-"+i+"s",action:function(){this.select.items(i)},init:function(e){var n=this;e.on("selectItems.dt.DT",function(e,t,r){n.active(r===i)})}}});h(e).on("preInit.dt.dtSelect",function(e,t){if(e.namespace!=="dt"){return}p.select.init(new p.Api(t))});return p.select});(function(r){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(e){return r(e,window,document)})}else if(typeof exports==="object"){module.exports=function(e,t){if(!e){e=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(e,t).$}return r(t,e,e.document)}}else{r(jQuery,window,document)}})(function(p,e,h){"use strict";var v=p.fn.dataTable;var g=function(e){if(!v.versionCheck||!v.versionCheck("1.10.8")){throw"DataTables Checkboxes requires DataTables 1.10.8 or newer"}this.s={dt:new v.Api(e),columns:[],data:{},dataDisabled:{},ignoreSelect:false};this.s.ctx=this.s.dt.settings()[0];if(this.s.ctx.checkboxes){return}e.checkboxes=this;this._constructor()};g.prototype={_constructor:function(){var a=this;var e=a.s.dt;var t=a.s.ctx;var r=false;var n=false;for(var i=0;i<t.aoColumns.length;i++){if(t.aoColumns[i].checkboxes){var o=p(e.column(i).header());r=true;if(!p.isPlainObject(t.aoColumns[i].checkboxes)){t.aoColumns[i].checkboxes={}}t.aoColumns[i].checkboxes=p.extend({},g.defaults,t.aoColumns[i].checkboxes);var s={searchable:false,orderable:false};if(t.aoColumns[i].sClass===""){s["className"]="dt-checkboxes-cell"}else{s["className"]=t.aoColumns[i].sClass+" dt-checkboxes-cell"}if(t.aoColumns[i].sWidthOrig===null){s["width"]="1%"}if(t.aoColumns[i].mRender===null){s["render"]=function(){return'<input type="checkbox" class="dt-checkboxes" autocomplete="off">'}}v.ext.internal._fnColumnOptions(t,i,s);o.removeClass("sorting");o.off(".dt");if(t.sAjaxSource===null){var l=e.cells("tr",i);l.invalidate("data");p(l.nodes()).addClass(s["className"])}a.s.data[i]={};a.s.dataDisabled[i]={};a.s.columns.push(i);if(t.aoColumns[i].checkboxes.selectRow){if(t._select){n=true}else{t.aoColumns[i].checkboxes.selectRow=false}}if(t.aoColumns[i].checkboxes.selectAll){o.data("html",o.html());if(t.aoColumns[i].checkboxes.selectAllRender!==null){var u="";if(p.isFunction(t.aoColumns[i].checkboxes.selectAllRender)){u=t.aoColumns[i].checkboxes.selectAllRender()}else if(typeof t.aoColumns[i].checkboxes.selectAllRender==="string"){u=t.aoColumns[i].checkboxes.selectAllRender}o.html(u).addClass("dt-checkboxes-select-all").attr("data-col",i)}}}}if(r){a.loadState();var f=p(e.table().node());var c=p(e.table().body());var d=p(e.table().container());if(n){f.addClass("dt-checkboxes-select");f.on("user-select.dt.dtCheckboxes",function(e,t,r,n,i){a.onDataTablesUserSelect(e,t,r,n,i)});f.on("select.dt.dtCheckboxes deselect.dt.dtCheckboxes",function(e,t,r,n){a.onDataTablesSelectDeselect(e,r,n)});if(t._select.info){e.select.info(false);f.on("draw.dt.dtCheckboxes select.dt.dtCheckboxes deselect.dt.dtCheckboxes",function(){a.showInfoSelected()})}}f.on("draw.dt.dtCheckboxes",function(e){a.onDataTablesDraw(e)});c.on("click.dtCheckboxes","input.dt-checkboxes",function(e){a.onClick(e,this)});d.on("click.dtCheckboxes",'thead th.dt-checkboxes-select-all input[type="checkbox"]',function(e){a.onClickSelectAll(e,this)});d.on("click.dtCheckboxes","thead th.dt-checkboxes-select-all",function(){p('input[type="checkbox"]',this).not(":disabled").trigger("click")});if(!n){d.on("click.dtCheckboxes","tbody td.dt-checkboxes-cell",function(){p('input[type="checkbox"]',this).not(":disabled").trigger("click")})}d.on("click.dtCheckboxes","thead th.dt-checkboxes-select-all label, tbody td.dt-checkboxes-cell label",function(e){e.preventDefault()});p(h).on("click.dtCheckboxes",'.fixedHeader-floating thead th.dt-checkboxes-select-all input[type="checkbox"]',function(e){if(t._fixedHeader){if(t._fixedHeader.dom["header"].floating){a.onClickSelectAll(e,this)}}});p(h).on("click.dtCheckboxes",".fixedHeader-floating thead th.dt-checkboxes-select-all",function(){if(t._fixedHeader){if(t._fixedHeader.dom["header"].floating){p('input[type="checkbox"]',this).trigger("click")}}});f.on("init.dt.dtCheckboxes",function(){setTimeout(function(){a.onDataTablesInit()},0)});f.on("stateSaveParams.dt.dtCheckboxes",function(e,t,r){a.onDataTablesStateSave(e,t,r)});f.one("destroy.dt.dtCheckboxes",function(e,t){a.onDataTablesDestroy(e,t)})}},onDataTablesInit:function(){var i=this;var e=i.s.dt;var t=i.s.ctx;if(!t.oFeatures.bServerSide){if(t.oFeatures.bStateSave){i.updateState()}p(e.table().node()).on("xhr.dt.dtCheckboxes",function(e,t,r,n){i.onDataTablesXhr(e.settings,r,n)})}},onDataTablesUserSelect:function(e,t,r,n){var i=this;var a=n.index();var o=a.row;var s=i.getSelectRowColIndex();var l=t.cell({row:o,column:s}).data();if(!i.isCellSelectable(s,l)){e.preventDefault()}},onDataTablesSelectDeselect:function(e,t,r){var n=this;var i=n.s.dt;if(n.s.ignoreSelect){return}if(t==="row"){var a=n.getSelectRowColIndex();if(a!==null){var o=i.cells(r,a);n.updateData(o,a,e.type==="select"?true:false);n.updateCheckbox(o,a,e.type==="select"?true:false);n.updateSelectAll(a)}}},onDataTablesStateSave:function(e,t,r){var n=this;var i=n.s.ctx;p.each(n.s.columns,function(e,t){if(i.aoColumns[t].checkboxes.stateSave){if(!Object.prototype.hasOwnProperty.call(r,"checkboxes")){r.checkboxes=[]}r.checkboxes[t]=n.s.data[t]}})},onDataTablesDestroy:function(){var e=this;var t=e.s.dt;var r=p(t.table().node());var n=p(t.table().body());var i=p(t.table().container());p(h).off("click.dtCheckboxes");i.off(".dtCheckboxes");n.off(".dtCheckboxes");r.off(".dtCheckboxes");e.s.data={};e.s.dataDisabled={};p(".dt-checkboxes-select-all",r).each(function(e,t){p(t).html(p(t).data("html")).removeClass("dt-checkboxes-select-all")})},onDataTablesDraw:function(){var r=this;var e=r.s.ctx;if(e.oFeatures.bServerSide||e.oFeatures.bDeferRender){r.updateStateCheckboxes({page:"current",search:"none"})}p.each(r.s.columns,function(e,t){r.updateSelectAll(t)})},onDataTablesXhr:function(){var r=this;var e=r.s.dt;var t=r.s.ctx;var n=p(e.table().node());p.each(r.s.columns,function(e,t){r.s.data[t]={};r.s.dataDisabled[t]={}});if(t.oFeatures.bStateSave){r.loadState();n.one("draw.dt.dtCheckboxes",function(){r.updateState()})}},updateData:function(e,t,r){var n=this;var i=n.s.dt;var a=n.s.ctx;if(a.aoColumns[t].checkboxes){var o=e.data();o.each(function(e){if(r){a.checkboxes.s.data[t][e]=1}else{delete a.checkboxes.s.data[t][e]}});if(a.oFeatures.bStateSave){if(a.aoColumns[t].checkboxes.stateSave){i.state.save()}}}},updateSelect:function(e,t){var r=this;var n=r.s.dt;var i=r.s.ctx;if(i._select){r.s.ignoreSelect=true;if(t){n.rows(e).select()}else{n.rows(e).deselect()}r.s.ignoreSelect=false}},updateCheckbox:function(e,t,r){var n=this;var i=n.s.ctx;var a=e.nodes();if(a.length){p("input.dt-checkboxes",a).not(":disabled").prop("checked",r);if(p.isFunction(i.aoColumns[t].checkboxes.selectCallback)){i.aoColumns[t].checkboxes.selectCallback(a,r)}}},updateState:function(){var r=this;var e=r.s.dt;var t=r.s.ctx;r.updateStateCheckboxes({page:"all",search:"none"});if(t._oFixedColumns){setTimeout(function(){p.each(r.s.columns,function(e,t){r.updateSelectAll(t)})},0)}},updateStateCheckboxes:function(e){var i=this;var t=i.s.dt;var a=i.s.ctx;t.cells("tr",i.s.columns,e).every(function(e,t){var r=this.data();var n=i.isCellSelectable(t,r);if(Object.prototype.hasOwnProperty.call(a.checkboxes.s.data,t)&&Object.prototype.hasOwnProperty.call(a.checkboxes.s.data[t],r)){if(a.aoColumns[t].checkboxes.selectRow&&n){i.updateSelect(e,true)}i.updateCheckbox(this,t,true)}if(!n){p("input.dt-checkboxes",this.node()).prop("disabled",true)}})},onClick:function(e,r){var n=this;var t=n.s.dt;var i=n.s.ctx;var a;var o=p(r).closest("td");if(o.parents(".DTFC_Cloned").length){a=t.fixedColumns().cellIndex(o)}else{a=o}var s=t.cell(a);var l=s.index();var u=l.column;if(!i.aoColumns[u].checkboxes.selectRow){s.checkboxes.select(r.checked);e.stopPropagation()}else{setTimeout(function(){var e=s.data();var t=Object.prototype.hasOwnProperty.call(n.s.data,u)&&Object.prototype.hasOwnProperty.call(n.s.data[u],e);if(t!==r.checked){n.updateCheckbox(s,u,t);n.updateSelectAll(u)}},0)}},onClickSelectAll:function(e,t){var r=this;var n=r.s.dt;var i=r.s.ctx;var a=null;var o=p(t).closest("th");if(o.parents(".DTFC_Cloned").length){var s=n.fixedColumns().cellIndex(o);a=s.column}else{a=n.column(o).index()}p(t).data("is-changed",true);n.column(a,{page:i.aoColumns[a].checkboxes&&i.aoColumns[a].checkboxes.selectAllPages?"all":"current",search:"applied"}).checkboxes.select(t.checked);e.stopPropagation()},loadState:function(){var r=this;var e=r.s.dt;var n=r.s.ctx;if(n.oFeatures.bStateSave){var i=e.state.loaded();p.each(r.s.columns,function(e,t){if(i&&i.checkboxes&&i.checkboxes.hasOwnProperty(t)){if(n.aoColumns[t].checkboxes.stateSave){r.s.data[t]=i.checkboxes[t]}}})}},updateSelectAll:function(r){var n=this;var e=n.s.dt;var t=n.s.ctx;if(t.aoColumns[r].checkboxes&&t.aoColumns[r].checkboxes.selectAll){var i=e.cells("tr",r,{page:t.aoColumns[r].checkboxes.selectAllPages?"all":"current",search:"applied"});var a=e.table().container();var o=p('.dt-checkboxes-select-all[data-col="'+r+'"] input[type="checkbox"]',a);var s=0;var l=0;var u=i.data();p.each(u,function(e,t){if(n.isCellSelectable(r,t)){if(Object.prototype.hasOwnProperty.call(n.s.data,r)&&Object.prototype.hasOwnProperty.call(n.s.data[r],t)){s++}}else{l++}});if(t._fixedHeader){if(t._fixedHeader.dom["header"].floating){o=p('.fixedHeader-floating .dt-checkboxes-select-all[data-col="'+r+'"] input[type="checkbox"]')}}var f;var c;if(s===0){f=false;c=false}else if(s+l===u.length){f=true;c=false}else{f=true;c=true}var d=o.data("is-changed");var h=o.prop("checked");var v=o.prop("indeterminate");if(d||h!==f||v!==c){o.data("is-changed",false);o.prop({checked:c?false:f,indeterminate:c});if(p.isFunction(t.aoColumns[r].checkboxes.selectAllCallback)){t.aoColumns[r].checkboxes.selectAllCallback(o.closest("th").get(0),f,c)}}}},showInfoSelected:function(){var e=this;var n=e.s.dt;var t=e.s.ctx;if(!t.aanFeatures.i){return}var r=e.getSelectRowColIndex();if(r!==null){var a=0;for(var i in t.checkboxes.s.data[r]){if(Object.prototype.hasOwnProperty.call(t.checkboxes.s.data,r)&&Object.prototype.hasOwnProperty.call(t.checkboxes.s.data[r],i)){a++}}var o=function(e,t,r){e.append(p('<span class="select-item"/>').append(n.i18n("select."+t+"s",{_:"%d "+t+"s selected",0:"",1:"1 "+t+" selected"},r)))};p.each(t.aanFeatures.i,function(e,t){var r=p(t);var n=p('<span class="select-info"/>');o(n,"row",a);var i=r.children("span.select-info");if(i.length){i.remove()}if(n.text()!==""){r.append(n)}})}},isCellSelectable:function(e,t){var r=this;var n=r.s.ctx;if(Object.prototype.hasOwnProperty.call(n.checkboxes.s.dataDisabled,e)&&Object.prototype.hasOwnProperty.call(n.checkboxes.s.dataDisabled[e],t)){return false}else{return true}},getCellIndex:function(e){var t=this;var r=t.s.dt;var n=t.s.ctx;if(n._oFixedColumns){return r.fixedColumns().cellIndex(e)}else{return r.cell(e).index()}},getSelectRowColIndex:function(){var e=this;var t=e.s.ctx;var r=null;for(var n=0;n<t.aoColumns.length;n++){if(t.aoColumns[n].checkboxes&&t.aoColumns[n].checkboxes.selectRow){r=n;break}}return r},updateFixedColumn:function(e){var r=this;var t=r.s.dt;var n=r.s.ctx;if(n._oFixedColumns){var i=n._oFixedColumns.s.iLeftColumns;var a=n.aoColumns.length-n._oFixedColumns.s.iRightColumns-1;if(e<i||e>a){t.fixedColumns().update();setTimeout(function(){p.each(r.s.columns,function(e,t){r.updateSelectAll(t)})},0)}}}};g.defaults={stateSave:true,selectRow:false,selectAll:true,selectAllPages:true,selectCallback:null,selectAllCallback:null,selectAllRender:'<input type="checkbox" autocomplete="off">'};var t=p.fn.dataTable.Api;t.register("checkboxes()",function(){return this});t.registerPlural("columns().checkboxes.select()","column().checkboxes.select()",function(u){if(typeof u==="undefined"){u=true}return this.iterator("column-rows",function(r,n,e,t,i){if(r.aoColumns[n].checkboxes){var a=[];p.each(i,function(e,t){a.push({row:t,column:n})});var o=this.cells(a);var s=o.data();var l=[];a=[];p.each(s,function(e,t){if(r.checkboxes.isCellSelectable(n,t)){a.push({row:i[e],column:n});l.push(i[e])}});o=this.cells(a);r.checkboxes.updateData(o,n,u);if(r.aoColumns[n].checkboxes.selectRow){r.checkboxes.updateSelect(l,u)}r.checkboxes.updateCheckbox(o,n,u);r.checkboxes.updateSelectAll(n);r.checkboxes.updateFixedColumn(n)}},1)});t.registerPlural("cells().checkboxes.select()","cell().checkboxes.select()",function(a){if(typeof a==="undefined"){a=true}return this.iterator("cell",function(e,t,r){if(e.aoColumns[r].checkboxes){var n=this.cells([{row:t,column:r}]);var i=this.cell({row:t,column:r}).data();if(e.checkboxes.isCellSelectable(r,i)){e.checkboxes.updateData(n,r,a);if(e.aoColumns[r].checkboxes.selectRow){e.checkboxes.updateSelect(t,a)}e.checkboxes.updateCheckbox(n,r,a);e.checkboxes.updateSelectAll(r);e.checkboxes.updateFixedColumn(r)}}},1)});t.registerPlural("cells().checkboxes.enable()","cell().checkboxes.enable()",function(o){if(typeof o==="undefined"){o=true}return this.iterator("cell",function(e,t,r){if(e.aoColumns[r].checkboxes){var n=this.cell({row:t,column:r});var i=n.data();if(o){delete e.checkboxes.s.dataDisabled[r][i]}else{e.checkboxes.s.dataDisabled[r][i]=1}var a=n.node();if(a){p("input.dt-checkboxes",a).prop("disabled",!o)}if(e.aoColumns[r].checkboxes.selectRow){if(Object.prototype.hasOwnProperty.call(e.checkboxes.s.data,r)&&Object.prototype.hasOwnProperty.call(e.checkboxes.s.data[r],i)){e.checkboxes.updateSelect(t,o)}}}},1)});t.registerPlural("cells().checkboxes.disable()","cell().checkboxes.disable()",function(e){if(typeof e==="undefined"){e=true}return this.checkboxes.enable(!e)});t.registerPlural("columns().checkboxes.deselect()","column().checkboxes.deselect()",function(e){if(typeof e==="undefined"){e=true}return this.checkboxes.select(!e)});t.registerPlural("cells().checkboxes.deselect()","cell().checkboxes.deselect()",function(e){if(typeof e==="undefined"){e=true}return this.checkboxes.select(!e)});t.registerPlural("columns().checkboxes.deselectAll()","column().checkboxes.deselectAll()",function(){return this.iterator("column",function(e,t){if(e.aoColumns[t].checkboxes){e.checkboxes.s.data[t]={};this.column(t).checkboxes.select(false)}},1)});t.registerPlural("columns().checkboxes.selected()","column().checkboxes.selected()",function(){return this.iterator("column-rows",function(r,n,e,t,i){if(r.aoColumns[n].checkboxes){var a=[];if(r.oFeatures.bServerSide){p.each(r.checkboxes.s.data[n],function(e){if(r.checkboxes.isCellSelectable(n,e)){a.push(e)}})}else{var o=[];p.each(i,function(e,t){o.push({row:t,column:n})});var s=this.cells(o);var l=s.data();p.each(l,function(e,t){if(Object.prototype.hasOwnProperty.call(r.checkboxes.s.data,n)&&Object.prototype.hasOwnProperty.call(r.checkboxes.s.data[n],t)){if(r.checkboxes.isCellSelectable(n,t)){a.push(t)}}})}return a}else{return[]}},1)});g.version="1.2.13-dev";p.fn.DataTable.Checkboxes=g;p.fn.dataTable.Checkboxes=g;p(h).on("preInit.dt.dtCheckboxes",function(e,t){if(e.namespace!=="dt"){return}new g(t)});return g});(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define([],r);else if(typeof exports==="object")exports["ClipboardJS"]=r();else t["ClipboardJS"]=r()})(this,function(){return function(r){var n={};function i(e){if(n[e]){return n[e].exports}var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=r;i.c=n;i.d=function(e,t,r){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);i.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=0)}([function(e,t,r){"use strict";var i=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(e,t,r){if(t)n(e.prototype,t);if(r)n(e,r);return e}}();var n=r(1);var o=c(n);var s=r(3);var l=c(s);var u=r(4);var f=c(u);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){v(n,e);function n(e,t){d(this,n);var r=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));r.resolveOptions(t);r.listenClick(e);return r}a(n,[{key:"resolveOptions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=typeof t.action==="function"?t.action:this.defaultAction;this.target=typeof t.target==="function"?t.target:this.defaultTarget;this.text=typeof t.text==="function"?t.text:this.defaultText;this.container=i(t.container)==="object"?t.container:document.body}},{key:"listenClick",value:function e(t){var r=this;this.listener=(0,f.default)(t,"click",function(e){return r.onClick(e)})}},{key:"onClick",value:function e(t){var r=t.delegateTarget||t.currentTarget;if(this.clipboardAction){this.clipboardAction=null}this.clipboardAction=new o.default({action:this.action(r),target:this.target(r),text:this.text(r),container:this.container,trigger:r,emitter:this})}},{key:"defaultAction",value:function e(t){return g("action",t)}},{key:"defaultTarget",value:function e(t){var r=g("target",t);if(r){return document.querySelector(r)}}},{key:"defaultText",value:function e(t){return g("text",t)}},{key:"destroy",value:function e(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null}}}],[{key:"isSupported",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:["copy","cut"];var r=typeof t==="string"?[t]:t;var n=!!document.queryCommandSupported;r.forEach(function(e){n=n&&!!document.queryCommandSupported(e)});return n}}]);return n}(l.default);function g(e,t){var r="data-clipboard-"+e;if(!t.hasAttribute(r)){return}return t.getAttribute(r)}e.exports=p},function(e,t,r){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(e,t,r){if(t)n(e.prototype,t);if(r)n(e,r);return e}}();var a=r(2);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function t(e){l(this,t);this.resolveOptions(e);this.initSelection()}i(t,[{key:"resolveOptions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=t.action;this.container=t.container;this.emitter=t.emitter;this.target=t.target;this.text=t.text;this.trigger=t.trigger;this.selectedText=""}},{key:"initSelection",value:function e(){if(this.text){this.selectFake()}else if(this.target){this.selectTarget()}}},{key:"selectFake",value:function e(){var t=this;var r=document.documentElement.getAttribute("dir")=="rtl";this.removeFake();this.fakeHandlerCallback=function(){return t.removeFake()};this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||true;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[r?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;this.container.appendChild(this.fakeElem);this.selectedText=(0,o.default)(this.fakeElem);this.copyText()}},{key:"removeFake",value:function e(){if(this.fakeHandler){this.container.removeEventListener("click",this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null}if(this.fakeElem){this.container.removeChild(this.fakeElem);this.fakeElem=null}}},{key:"selectTarget",value:function e(){this.selectedText=(0,o.default)(this.target);this.copyText()}},{key:"copyText",value:function e(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=false}this.handleResult(t)}},{key:"handleResult",value:function e(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function e(){if(this.trigger){this.trigger.focus()}window.getSelection().removeAllRanges()}},{key:"destroy",value:function e(){this.removeFake()}},{key:"action",set:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";this._action=t;if(this._action!=="copy"&&this._action!=="cut"){throw new Error('Invalid "action" value, use either "copy" or "cut"')}},get:function e(){return this._action}},{key:"target",set:function e(t){if(t!==undefined){if(t&&(typeof t==="undefined"?"undefined":n(t))==="object"&&t.nodeType===1){if(this.action==="copy"&&t.hasAttribute("disabled")){throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute')}if(this.action==="cut"&&(t.hasAttribute("readonly")||t.hasAttribute("disabled"))){throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}this._target=t}else{throw new Error('Invalid "target" value, use a valid Element')}}},get:function e(){return this._target}}]);return t}();e.exports=u},function(e,t){function r(e){var t;if(e.nodeName==="SELECT"){e.focus();t=e.value}else if(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA"){var r=e.hasAttribute("readonly");if(!r){e.setAttribute("readonly","")}e.select();e.setSelectionRange(0,e.value.length);if(!r){e.removeAttribute("readonly")}t=e.value}else{if(e.hasAttribute("contenteditable")){e.focus()}var n=window.getSelection();var i=document.createRange();i.selectNodeContents(e);n.removeAllRanges();n.addRange(i);t=n.toString()}return t}e.exports=r},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});(n[e]||(n[e]=[])).push({fn:t,ctx:r});return this},once:function(e,t,r){var n=this;function i(){n.off(e,i);t.apply(r,arguments)}i._=t;return this.on(e,i,r)},emit:function(e){var t=[].slice.call(arguments,1);var r=((this.e||(this.e={}))[e]||[]).slice();var n=0;var i=r.length;for(n;n<i;n++){r[n].fn.apply(r[n].ctx,t)}return this},off:function(e,t){var r=this.e||(this.e={});var n=r[e];var i=[];if(n&&t){for(var a=0,o=n.length;a<o;a++){if(n[a].fn!==t&&n[a].fn._!==t)i.push(n[a])}}i.length?r[e]=i:delete r[e];return this}};e.exports=r},function(e,t,r){var n=r(5);var i=r(6);function a(e,t,r){if(!e&&!t&&!r){throw new Error("Missing required arguments")}if(!n.string(t)){throw new TypeError("Second argument must be a String")}if(!n.fn(r)){throw new TypeError("Third argument must be a Function")}if(n.node(e)){return o(e,t,r)}else if(n.nodeList(e)){return s(e,t,r)}else if(n.string(e)){return l(e,t,r)}else{throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}}function o(e,t,r){e.addEventListener(t,r);return{destroy:function(){e.removeEventListener(t,r)}}}function s(e,t,r){Array.prototype.forEach.call(e,function(e){e.addEventListener(t,r)});return{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,r)})}}}function l(e,t,r){return i(document.body,e,t,r)}e.exports=a},function(e,r){r.node=function(e){return e!==undefined&&e instanceof HTMLElement&&e.nodeType===1};r.nodeList=function(e){var t=Object.prototype.toString.call(e);return e!==undefined&&(t==="[object NodeList]"||t==="[object HTMLCollection]")&&"length"in e&&(e.length===0||r.node(e[0]))};r.string=function(e){return typeof e==="string"||e instanceof String};r.fn=function(e){var t=Object.prototype.toString.call(e);return t==="[object Function]"}},function(e,t,r){var i=r(7);function a(e,t,r,n,i){var a=o.apply(this,arguments);e.addEventListener(r,a,i);return{destroy:function(){e.removeEventListener(r,a,i)}}}function n(e,t,r,n,i){if(typeof e.addEventListener==="function"){return a.apply(null,arguments)}if(typeof r==="function"){return a.bind(null,document).apply(null,arguments)}if(typeof e==="string"){e=document.querySelectorAll(e)}return Array.prototype.map.call(e,function(e){return a(e,t,r,n,i)})}function o(t,r,e,n){return function(e){e.delegateTarget=i(e.target,r);if(e.delegateTarget){n.call(t,e)}}}e.exports=n},function(e,t){var r=9;if(typeof Element!=="undefined"&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}function i(e,t){while(e&&e.nodeType!==r){if(typeof e.matches==="function"&&e.matches(t)){return e}e=e.parentNode}}e.exports=i}])});(function(ee,te,o){var s="__instance__",l="firstChild",u=setTimeout;function p(e){return typeof e!=="undefined"}function f(e){return typeof e==="string"}function g(e){return typeof e==="object"}function m(e){return Object.keys(e).length}function re(e,t,r){if(e<t)return t;if(e>r)return r;return e}function t(e,t){return parseInt(e,t||10)}function d(e){return Math.round(e)}function ne(e){var t=+e[0],r=+e[1],n=+e[2],i,a,o,s,l,u,f,c;s=Math.floor(t*6);l=t*6-s;u=n*(1-r);f=n*(1-l*r);c=n*(1-(1-l)*r);s=s||0;f=f||0;c=c||0;switch(s%6){case 0:i=n,a=c,o=u;break;case 1:i=f,a=n,o=u;break;case 2:i=u,a=n,o=c;break;case 3:i=u,a=f,o=n;break;case 4:i=c,a=u,o=n;break;case 5:i=n,a=u,o=f;break}return[d(i*255),d(a*255),d(o*255)]}function ie(e){return r(ne(e))}function i(e){var t=+e[0],r=+e[1],n=+e[2],i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a,s,l=i===0?0:o/i,u=i/255;switch(i){case a:s=0;break;case t:s=r-n+o*(r<n?6:0);s/=6*o;break;case r:s=n-t+o*2;s/=6*o;break;case n:s=t-r+o*4;s/=6*o;break}return[s,l,u]}function r(e){var t=+e[2]|+e[1]<<8|+e[0]<<16;t="000000"+t.toString(16);return t.slice(-6)}function a(e){return i(c(e))}function c(e){if(e.length===3){e=e.replace(/./g,"$&$&")}return[t(e[0]+e[1],16),t(e[2]+e[3],16),t(e[4]+e[5],16)]}function h(e){return[+e[0]/360,+e[1]/100,+e[2]/100]}function v(e){return[d(+e[0]*360),d(+e[1]*100),d(+e[2]*100)]}function y(e){return[+e[0]/255,+e[1]/255,+e[2]/255]}function e(e){if(g(e))return e;var t=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i.exec(e),r=/\s*hsv\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/i.exec(e),n=e[0]==="#"&&e.match(/^#([\da-f]{3}|[\da-f]{6})$/i);if(n){return a(e.slice(1))}else if(r){return h([+r[1],+r[2],+r[3]])}else if(t){return i([+t[1],+t[2],+t[3]])}return[0,1,1]}(function(n){n.version="1.4.2";n[s]={};n.each=function(r,e){return u(function(){var e=n[s],t;for(t in e){r.call(e[t],t,e)}},e===0?0:e||1),n};n.parse=e;n._HSV2RGB=ne;n._HSV2HEX=ie;n._RGB2HSV=i;n._HEX2HSV=a;n._HEX2RGB=function(e){return y(c(e))};n.HSV2RGB=function(e){return ne(h(e))};n.HSV2HEX=function(e){return ie(h(e))};n.RGB2HSV=function(e){return v(i(e))};n.RGB2HEX=r;n.HEX2HSV=function(e){return v(a(e))};n.HEX2RGB=c})(ee[o]=function(y,b,w){var C=te.body,c=te.documentElement,S=this,t=ee[o],r=false,i={},E=te.createElement("div"),k="touchstart mousedown",T="touchmove mousemove",_="touchend mouseup",x="orientationchange resize";if(!(S instanceof t)){return new t(y,b)}t[s][y.id||y.name||m(t[s])]=S;if(!p(b)||b===true){b=k}function D(e,t,r){e=e.split(/\s+/);for(var n=0,i=e.length;n<i;++n){t.addEventListener(e[n],r,false)}}function R(e,t,r){e=e.split(/\s+/);for(var n=0,i=e.length;n<i;++n){t.removeEventListener(e[n],r)}}function I(e,t){var r="touches",n="clientX",i="clientY",a=!!t[r]?t[r][0][n]:t[n],o=!!t[r]?t[r][0][i]:t[i],s=d(e);return{x:a-s.l,y:o-s.t}}function d(e){var t,r,n;if(e===ee){t=ee.pageXOffset||c.scrollLeft;r=ee.pageYOffset||c.scrollTop}else{n=e.getBoundingClientRect();t=n.left;r=n.top}return{l:t,t:r}}function O(e,t){while((e=e.parentElement)&&e!==t);return e}function A(e){if(e)e.preventDefault()}function N(e){return e===ee?{w:ee.innerWidth,h:ee.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function M(e){return r||(p(e)?e:false)}function L(e){r=e}function e(e,t,r){if(!p(e))return i;if(!p(t))return i[e];if(!p(i[e]))i[e]={};if(!p(r))r=m(i[e]);return i[e][r]=t,S}function n(e,t){if(!p(e))return i={},S;if(!p(t))return i[e]={},S;return delete i[e][t],S}function P(e,t,r){if(!p(i[e]))return S;if(!p(r)){for(var n in i[e]){i[e][n].apply(S,t)}}else{if(p(i[e][r])){i[e][r].apply(S,t)}}return S}L(t.parse(y.getAttribute("data-color")||y.value||[0,1,1]));E.className="color-picker";E.innerHTML='<div class="color-picker-container"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var a=E[l].children,F=M([0,1,1]),B=a[0],H=a[1],$=B[l],W=H[l],U=0,j=0,V=0,z=0,h=0,v=0,q=0,Y=0,G=[ie(F)],X;function K(e,t){if(!e||e==="h"){P("change:h",t)}if(!e||e==="sv"){P("change:sv",t)}P("change",t)}function J(){return E.parentNode}function Q(e,t){if(!e){(w||t||C).appendChild(E),S.visible=true}q=N(E).w;Y=N(E).h;var r=N(H),n=N(W),i=N(B).h,a=r.w,o=r.h,s=N($).h,l=n.w,u=n.h;if(e){E.style.left=E.style.top="-9999px";function f(e){var t=e.target,r=t===y||O(t,y)===y;if(r){!J()&&(Q(),P("enter"))}else{S.exit()}}if(b!==false){D(b,y,f)}S.create=function(){return Q(1),P("create"),S};S.destroy=function(){if(b!==false){R(b,y,f)}S.exit(),L(false);return P("destroy"),S}}else{Z()}X=function(){F=M(F),c();$.style.top=i-s/2-i*+F[0]+"px";W.style.right=a-l/2-a*+F[1]+"px";W.style.top=o-u/2-o*+F[2]+"px"};S.exit=function(e){var t=J();if(t){t.removeChild(E);S.visible=false}R(k,B,g);R(k,H,m);R(T,te,v);R(_,te,p);R(x,ee,Z);return P("exit"),S};function c(e){var t=ne(F),r=ne([F[0],1,1]);H.style.backgroundColor="rgb("+r.join(",")+")";L(F);A(e)}X();function d(e){var t=re(I(B,e).y,0,i);F[0]=(i-t)/i;$.style.top=t-s/2+"px";c(e)}function h(e){var t=I(H,e),r=re(t.x,0,a),n=re(t.y,0,o);F[1]=1-(a-r)/a;F[2]=(o-n)/o;W.style.right=a-r-l/2+"px";W.style.top=n-u/2+"px";c(e)}function v(e){if(V){d(e),G=[ie(F)];if(!U){P("drag:h",G);P("drag",G);K("h",G)}}if(z){h(e),G=[ie(F)];if(!j){P("drag:sv",G);P("drag",G);K("sv",G)}}U=0,j=0}function p(e){var t=e.target,r=V?"h":"sv",n=[ie(F),S],i=t===y||O(t,y)===y,a=t===E||O(t,E)===E;if(!i&&!a){if(J()&&b!==false)S.exit(),K(0,n)}else{if(a){P("stop:"+r,n);P("stop",n);K(r,n)}}V=0,z=0}function g(e){U=1,V=1,v(e),A(e);P("start:h",G);P("start",G);K("h",G)}function m(e){j=1,z=1,v(e),A(e);P("start:sv",G);P("start",G);K("sv",G)}if(!e){D(k,B,g);D(k,H,m);D(T,te,v);D(_,te,p);D(x,ee,Z)}}Q(1);u(function(){var e=[ie(F)];P("create",e);K(0,e)},0);S.fit=function(e){var t=N(ee),r=N(c),n=t.w-r.w,i=t.h-c.clientHeight,a=d(ee),o=d(y);h=o.l+a.l;v=o.t+a.t+N(y).h;if(g(e)){p(e[0])&&(h=e[0]);p(e[1])&&(v=e[1])}else{var s=a.l,l=a.t,u=a.l+t.w-q-n,f=a.t+t.h-Y-i;h=re(h,s,u)>>0;v=re(v,l,f)>>0}E.style.left=h+"px";E.style.top=v+"px";return P("fit"),S};function Z(){return S.fit()}S.set=function(e){if(!p(e))return M();if(f(e)){e=t.parse(e)}return L(e),X(),S};S.get=function(e){return M(e)};S.source=y;S.self=E;S.visible=false;S.on=e;S.off=n;S.fire=P;S.hooks=i;S.enter=function(e){return Q(0,e),P("enter"),S};return S})})(window,document,"CP");(function(t,r){if(typeof define=="function"&&define.amd){define(["exports"],function(e){r(t,e)})}else if(typeof exports!=="undefined"){r(t,exports)}else{r(t,t.fd=t.fd||{})}})(this,function(t,f){f.randomID=function(e){return(e||"fd")+"_"+(Math.random()*1e4).toFixed()};f.uniqueID=function(e){do{var t=f.randomID(e)}while(f.byID(t));return t};f.byID=function(e){return f.isTag(e)?e:document.getElementById(e)};f.isTag=function(e,t){return typeof e=="object"&&e&&e.nodeType==1&&(!t||e.tagName.toUpperCase()==t.toUpperCase())};f.newXHR=function(){try{return new XMLHttpRequest}catch(e){var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];for(var r=0;r<t.length;r++){try{return new ActiveXObject(t[r])}catch(e){}}}throw"Cannot create XMLHttpRequest."};f.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"};f.toArray=function(e,t){if(e===null||typeof e=="undefined"){return[]}else if(!f.isArray(e)&&(typeof e!="object"||!("callee"in e))){e=[e]}return Array.prototype.slice.call(e,t||0)};f.addEvent=function(e,t,r){if(e&&t&&r){if(e.attachEvent){e["e"+t+r]=r;e[t+r]=function(){e["e"+t+r](window.event)};e.attachEvent("on"+t,e[t+r])}else{e.addEventListener(t,r,false)}}return e};f.stopEvent=function(e){e.cancelBubble=true;e.returnValue=false;e.stopPropagation&&e.stopPropagation();e.preventDefault&&e.preventDefault();return e};f.setClass=function(e,t,r){if((e=f.byID(e))&&t!=null){if(typeof r!="undefined"&&!r){e.className=e.className.replace(f.classRegExp(t)," ")}else if(!f.hasClass(e,t)){e.className+=" "+t}}return e};f.hasClass=function(e,t){return f.classRegExp(t).test((f.byID(e)||{}).className)};f.classRegExp=function(e){if(e==""||typeof e=="object"){return/$o_O/}else{return new RegExp("(^|\\s+)"+e+"(\\s+|$)","gi")}};f.extend=function(e,t,r){e=e||{};t=t||{};for(var n in t){if(r||typeof e[n]=="undefined"){e[n]=t[n]}}return e};f.callAll=function(e,t,r){var n;t=f.toArray(t);typeof e=="function"&&(e=[e]);if(f.isArray(e)){for(var i=0;i<e.length;i++){if(typeof e[i]=="function"){n=e[i].apply(r||this,t);if(n!=null){break}}}}else if(e){throw"FileDrop event list must be either an Array, Function, undefined or"+" null but "+typeof e+" was given."}return n};f.callAllOfObject=function(e,t,r){if(f.logging&&f.hasConsole){var n=e.events[t]?e.events[t].length||0:0;console.info("FileDrop "+t+" event ("+n+") args:");console.dir([r])}var i=[f.onObjectCall].concat(e.events.any);var a=f.callAll(i,[t].concat(f.toArray(r)),e);return a!=null?a:f.callAll(e.events[t],r,e)};f.appendEventsToObject=function(e,t){if(f.addEventsToObject(this,false,arguments)){return this}switch(arguments.length){case 0:return f.extend({},this.events);case 1:if(e===null){this.events={};return this}else if(f.isArray(e)){var r={};for(var n=0;n<e.length;n++){r[e[n]]=f.toArray(this.events[e[n]])}return r}else if(typeof e=="function"){return f.funcNS(e)}else if(typeof e=="string"){return f.toArray(this.events[e])}case 2:e=f.toArray(e);if(t===null){for(var n=0;n<e.length;n++){var i=f.splitNS(e[n]);if(!i[0]){for(var a in this.events){arguments.callee.call(this,[a+":"+i[1]],null)}}else if(!i[1]){this.events[i[0]]=[]}else if(this.events[i[0]]){for(var o=this.events[i[0]].length-1;o>=0;o--){if(f.funcNS(this.events[i[0]][o])==i[1]){this.events[i[0]].splice(o,1)}}}}return this}}throw"Bad parameters for FileDrop event()."};f.previewToObject=function(e,t){if(f.addEventsToObject(this,true,arguments)){return this}else{throw"Bad parameters for FileDrop preview()."}};f.addEventsToObject=function(e,t,r){var n=r[0];var i=r[1];switch(r.length){case 1:if(n&&typeof n=="object"&&!f.isArray(n)){for(var a in n){arguments.callee(e,t,[a,n[a]])}return true}case 2:if(typeof i=="function"||f.isArray(i)){n=f.toArray(n);i=f.toArray(i);var o=t?"unshift":"push";for(var s=0;s<n.length;s++){var l=f.splitNS(n[s]);for(var u=0;u<i.length;u++){f.funcNS(i[u],l[1])}e.events[l[0]]=e.events[l[0]]||[];e.events[l[0]][o].apply(e.events[l[0]],i)}return true}}};f.funcNS=function(e,t){if(typeof e!="function"){return e}else if(arguments.length==1){return(e[f.nsProp]||"").toString()}else{e[f.nsProp]=(t||"").toString();return e}};f.splitNS=function(e){return(e||"").match(/^([^:]*):?(.*)$/).slice(1)};f.extend(f,{logging:true,hasConsole:"console"in window&&console.log&&console.dir,onObjectCall:null,all:[],isIE6:false,isIE9:false,isChrome:(navigator.vendor||"").indexOf("Google")!=-1,nsProp:"_fdns"});f.DropHandle=function(i,e){var a=this;a.el=i=f.byID(i);if(!i){throw"Cannot locate DOM node given to new FileDrop class."}a.opt={zoneClass:"fd-zone",inputClass:"fd-file",iframe:{url:"",callbackParam:"fd-callback",fileParam:"fd-file"},input:null,recreateInput:true,fullDocDragDetect:false,multiple:false,dropEffect:"copy"};f.all.push(a);a.filedrop=null;var t=a.opt.iframe;f.extend(a.opt,e,true);f.extend(a.opt.iframe,t);f.isChrome&&(a.opt.fullDocDragDetect=true);a.events={any:[],dragEnter:[],dragLeave:[],dragOver:[],dragEnd:[],dragExit:[],upload:[],uploadElsewhere:[],inputSetup:[],iframeSetup:[],iframeDone:[]};a.on=a.events;a.zone=a.el;a.hook=function(e){if(a.opt.input!=false){a.opt.input=a.opt.input||a.prepareInput(e);a.opt.input&&f.callAllOfObject(a,"inputSetup",a.opt.input)}a.hookDragOn(e);a.hookDropOn(e)};a.hookDragOn=function(e){if(a.opt.fullDocDragDetect){a.delegate(document.body,"dragEnter");f.addEvent(document,"dragleave",function(e){if(e.clientX==0&&e.clientY==0||f.isTag(e.relatedTarget,"html")){f.stopEvent(e);f.callAllOfObject(a,"dragLeave",e)}})}else{a.delegate(e,"dragEnter");a.delegate(e,"dragLeave")}a.delegate(e,"dragOver");a.delegate(e,"dragEnd");a.delegate(e,"dragExit")};a.hookDropOn=function(e){f.isIE9||a.delegate(e,"drop","upload")};a.delegate=function(e,t,r){f.addEvent(e,t.toLowerCase(),function(e){f.stopEvent(e);f.callAllOfObject(a,r||t,e)})};a.prepareInput=function(e){var t=a.findInputRecursive(e)||a.createInputAt(e);if(t){var r=t.parentNode;while(r&&!f.isTag(r,"form")){r=r.parentNode}if(!r){throw"FileDrop file input has no parent form element."}var n=r?r.getAttribute("target"):"";if(n&&f.isTag(f.byID(n),"iframe")){return{file:t,form:r}}}return false};a.findInputRecursive=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(f.isTag(r,"input")&&r.getAttribute("type")=="file"&&f.hasClass(r,a.opt.inputClass)){return r}else if(r=arguments.callee(r)){return r}}};a.createInputAt=function(e){do{var t=f.randomID()}while(f.byID(t));var r=document.createElement("div");r.innerHTML='<iframe src="javascript:false" name="'+t+'"></iframe>'+'<form method="post" enctype="multipart/form-data">'+'<input type="hidden" name="'+a.opt.iframe.callbackParam+'" />'+'<input type="file" name="'+a.opt.iframe.fileParam+'" />'+"</form>";r.firstChild.setAttribute("id",t);r.firstChild.style.display="none";r.lastChild.setAttribute("target",t);var n=e.firstChild;while(n&&(!f.isTag(n)||f.isTag(n,"legend"))){n=n.nextSibling}if(n){e.insertBefore(r,n)}else{e.appendChild(r)}return r.lastChild.lastChild};a.abortIFrame=function(){if(a.opt.input.form){var e=f.byID(a.opt.input.form.getAttribute("target"));e&&e.setAttribute("src","javascript:false")}};a.sendViaIFrame=function(t){t=t||a.opt.iframe.url;var e=(a.opt.input||{}).form;if(t&&e){do{var r=f.randomID()}while(r in window);window[r]=function(e){if(typeof e!="object"){e={response:e,responseXML:"",responseText:(e||"").toString(),readyState:4,status:200,statusText:"OK",getAllResponseHeaders:function(){return""},getResponseHeader:function(){return""},setRequestHeader:function(){return this},statusCode:function(){return this},abort:function(){return this}}}f.extend(e,{iframe:true,url:t});f.callAllOfObject(a,"iframeDone",e)};var n=e.firstChild;while(n&&(!f.isTag(n,"input")||n.name!=a.opt.iframe.callbackParam)){n=n.nextSibling}if(n){n.value=r}else{t=t.replace(/[?&]+$/,"")+(t.indexOf("?")==-1?"?":"&")+a.opt.iframe.callbackParam+"="+r}e.setAttribute("action",t);f.callAllOfObject(a,"iframeSetup",e);e.submit();setTimeout(a.resetForm,300);return true}};a.resetForm=function(){var e=a.opt.input&&a.opt.input.file;if(e){e.value="";if(a.opt.recreateInput){var t=a.opt.input.file=e.cloneNode(true);e.parentNode.replaceChild(t,e);f.callAllOfObject(a,"inputSetup",[a.opt.input,e])}}};a.multiple=function(e){if(a.opt.input&&typeof e!="undefined"){e?a.opt.input.file.setAttribute("multiple","multiple"):a.opt.input.file.removeAttribute("multiple")}return a.opt.input&&!!a.opt.input.file.getAttribute("multiple")};a.event=function(e,t){return f.appendEventsToObject.apply(a,arguments)};a.preview=function(e,t){return f.previewToObject.apply(a,arguments)};a.onInputSetup=function(e,t){if(t){e.file.clearAttributes&&e.file.clearAttributes();e.file.mergeAttributes&&e.file.mergeAttributes(t)}else{a.multiple(a.opt.multiple)}f.setClass(e.file,a.opt.inputClass);a.delegate(e.file,"change","upload");var r=e.file.parentNode;if(r&&r.style.display.match(/^(static)?$/)){r.style.position="relative"}if(f.isTag(i,"fieldset")){var n=document.createElement("div");n.style.position="relative";n.style.overflow="hidden";i.parentNode.insertBefore(n,i);n.appendChild(i)}};a.onDragOver=function(e){f.stopEvent(e);e.dataTransfer&&(e.dataTransfer.dropEffect=a.opt.dropEffect)};a.onUpload=function(){for(var e=0;e<f.all.length;e++){if(f.all[e]!==a&&f.all[e].events){f.callAllOfObject(f.all[e],"uploadElsewhere",a)}}};a.event({inputSetup:a.onInputSetup,dragOver:a.onDragOver,upload:a.onUpload});f.setClass(i,a.opt.zoneClass);a.hook(i)};f.FileDrop=function(t,e){var l=this;t=f.byID(t);l.handle=new f.DropHandle(t,e);l.handle.filedrop=l;f.extend(l.handle.opt,{dragOverClass:"over"});f.extend(l.handle.opt.iframe,{force:false});f.extend(l.handle.events,{send:[],fileSetup:[]});l.onUpload=function(e){var t=!l.opt.iframe.force&&l.eventFiles(e,true);if(!t){if(!l.handle.sendViaIFrame()&&f.hasConsole){console.warn("FileDrop fallback upload triggered but iframe options"+" were not configured - doing nothing.")}}else if(t.length>0){f.callAllOfObject(l,"send",[t])}};l.eventFiles=function(e,t){var r=new f.FileList(e);if(e.dataTransfer&&(e.dataTransfer.length||e.dataTransfer.files)){var n=e.dataTransfer}else{var n=e.target&&e.target.files||e.srcElement&&e.srcElement.files}if(n){var i=n.items||[];n.files&&(n=n.files);var a={};for(var o=0;o<n.length;o++){var s=new f.File(n[o]);if(!a[s.name]||s.name=="image.jpg"){a[s.name]=true;s.setNativeEntry(i[o]);f.callAllOfObject(l,"fileSetup",s);if(s.size>0||s.nativeEntry){r.push(s)}}}}else if(t){r=false}return r};f.extend(l,l.handle);function r(e){return function(){f.setClass(t,l.opt.dragOverClass,e)}}l.event({upload:l.onUpload,send:l.resetForm,dragEnter:r(true),dragLeave:r(false),uploadElsewhere:r(false)});l.preview({upload:r(false)})};f.FileList=function(e){var o=this;o.dropEffect=e&&e.dropEffect||"";o.length=0;e=null;o.push=function(e){o[o.length++]=e;return o};o.pop=function(){if(o.length>0){var e=o.last();delete o[--o.length];return e}};o.first=function(){return o[0]};o.last=function(){return o[o.length-1]};o.remove=function(e){for(;e<o.length-1;e++){o[e]=o[e+1]}se.f.pop();return o};o.clear=function(){for(var e=0;e<o.length;e++){delete o[e]}o.length=0;return o};o.reverse=function(){for(var e=0;e<Math.floor(o.length/2);e++){o[e]=o[o.length-e-1]}return o};o.concat=function(e){var t=new f.FileList;for(var r=0;r<o.length;r++){t[r]=o[r]}for(var r=0;e&&r<e.length;r++){t[o.length+r+1]=e[r]}t.length=o.length+(e||[]).length;return o};o.sort=function(e,t){for(var r=0;r<o.length;r++){for(var n=0;n<o.length;n++){if(e.call(t||this,o[r],o[n],r,n)<0){var i=o[r];o[r]=o[n];o[n]=i}}}return o};o.sortBy=function(e,t){var r=[];for(var n=0;n<o.length;n++){r.push([n,e.call(t||this,o[n],n)])}r.sort(function(e,t){return e[1]>t[1]?+1:e[1]<t[1]?-1:0});for(var n=0;n<r.length;n++){o[n]=r[n][0]}return o};o.find=function(e,t){for(var r=0;r<o.length;r++){var n=e.call(t||this,o[r],r);if(n!=null){return o[r]}}};o.each=function(e,t){o.find(function(){e.apply(this,arguments)},t);return o};o.invoke=function(t,e){var r=f.toArray(arguments,1);return this.each(function(e){e[t].apply(e,r)})};o.abort=function(){return this.invoke("abort")};o.findCompare=function(t,r){var n,i=null,a;o.each(function(e){if(i==null||i<(a=t.call(r,n))){n=e}},r);return n};o.filter=function(t,e){var r=new f.FileList;o.each(function(e){t.apply(this,arguments)&&r.push(e)},e);return r};o.largest=function(){return o.findCompare(function(e){return e.size})};o.smallest=function(){return o.findCompare(function(e){return-e.size})};o.oldest=function(){return o.findCompare(function(e){return-e.modDate.getTime()})};o.newest=function(){return o.findCompare(function(e){return e.modDate})};o.ofType=function(t){t+=t.indexOf("/")==-1?"/":"$";t=new RegExp("^"+t,"i");return o.filter(function(e){return t.test(e.type)})};o.images=function(){return o.ofType("image")};o.named=function(t){if(typeof t=="string"){return o.find(function(e){return e.name==t})}else{return o.filter(function(e){return t.test(e.name)})}}};f.FileList.prototype.length=0;f.FileList.prototype.splice=Array.prototype.splice;f.File=function(t){var l=this;l.nativeFile=t;l.nativeEntry=null;l.name=t.fileName||t.name||"";l.size=t.fileSize||t.size||0;l.type=l.mime=t.fileType||t.type||"";l.modDate=t.lastModifiedDate||new Date;l.xhr=null;l.opt={extraHeaders:true,xRequestedWith:true,method:"POST"};l.events={any:[],xhrSetup:[],xhrSend:[],progress:[],done:[],error:[]};l.events.sendXHR=l.events.xhrSend;l.abort=function(){l.xhr&&l.xhr.abort&&l.xhr.abort();return l};l.sendTo=function(e,t){t=f.extend(t,l.opt);t.url=e;if(!l.size){f.hasConsole&&console.warn("Trying to send an empty FileDrop.File.")}else if(window.FileReader){var r=new FileReader;r.onload=function(e){l.sendDataReadyTo(t,e)};r.onerror=function(e){f.callAllOfObject(l,"error",[e])};r.readAsArrayBuffer(l.nativeFile)}else{l.sendDataReadyTo(t)}return l};l.sendDataReadyTo=function(e,t){l.abort();l.xhr=f.newXHR();l.hookXHR(l.xhr);l.xhr.open(e.method,e.url,true);l.xhr.overrideMimeType&&l.xhr.overrideMimeType("application/octet-stream");l.xhr.setRequestHeader("Content-Type","application/octet-stream");if(e.extraHeaders){l.xhr.setRequestHeader("X-File-Name",encodeURIComponent(l.name));l.xhr.setRequestHeader("X-File-Size",l.size);l.xhr.setRequestHeader("X-File-Type",l.type);l.xhr.setRequestHeader("X-File-Date",l.modDate.toGMTString());var r=e.xRequestedWith;if(r===true){var n=window.FileReader?"FileAPI":"Webkit";r="FileDrop-XHR-"+n}r&&l.xhr.setRequestHeader("X-Requested-With",r)}f.callAllOfObject(l,"xhrSetup",[l.xhr,e]);var i=t&&t.target&&t.target.result?t.target.result:l.nativeFile;f.callAllOfObject(l,"xhrSend",[l.xhr,i,e]);return l.xhr};l.hookXHR=function(n){var e=n.upload||n;n.onreadystatechange=function(e){if(n.readyState==4){try{var t=n.status==200?"done":"error"}catch(e){var t="error"}var r=t=="error"?[e,n]:[n,e];f.callAllOfObject(l,t,r)}};e.onprogress=function(e){var t=e.lengthComputable?e.loaded:null;f.callAllOfObject(l,"progress",[t,e.total||null,n,e])}};l.readData=function(e,t,r){return l.read({onDone:e,onError:t,func:r})};l.readDataURL=function(e,t){return l.readData(e,t||false,"uri")};l.readDataURI=l.readDataURL;l.read=function(r){function t(e,t){typeof t=="object"||(t.message=t);t.fdError=e;if(r.onError!==false){(r.onError||r.onDone).apply(this,arguments)}}f.extend(r,{onDone:new Function,onError:null,blob:l.nativeFile,func:"",start:0,end:null,mime:""});if(!window.FileReader){return t("support",e)}if(r.start>0||r.end!=null&&r.end){if(r.blob.slice){r.end==null&&(r.end=r.blob.size||r.blob.fileSize);r.blob=r.blob.slice(r.start,r.end,r.mime)}else if(f.hasConsole){console.warn("File Blob/slice() are unsupported - operating on entire File.")}}var n=new FileReader;n.onerror=function(e){t("read",e)};n.onload=function(e){if(e.target&&e.target.result){if(r.func=="readAsBinaryString"){e.target.result=String.fromCharCode.apply(null,new Uint8Array(e.target.result))}r.onDone(e.target.result)}else{n.onerror(e)}};var i=r.func;if(f.isArray(i)){var a=i[0];i[0]=r.blob;return n[a].apply(n,i)}else{if(!i||i=="bin"){i="readAsBinaryString"}else if(i=="url"||i=="uri"||i=="src"){i="readAsDataURL"}else if(i=="array"){i="readAsArrayBuffer"}else if(i=="text"){i="readAsText"}else if(i.substr(0,4)!="read"){return n.readAsText(r.blob,i)}i=="readAsBinaryString"&&(i="readAsArrayBuffer");return n[i](r.blob)}};l.listEntries=function(t,n){if(l.nativeEntry&&l.nativeEntry.isDirectory){n=n||new Function;var i=l.nativeEntry.createReader();var a=new f.FileList;var o=0;function s(e){o-=e;if(o==0&&t){t(a);t=null}}i.readEntries(function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.file){o++;r.file(function(e){var t=new f.File(e);t.setNativeEntry(r);a.push(t);s(1)},function(){a.push(f.File.fromEntry(r));s(1);n.apply(this,arguments)})}else{a.push(f.File.fromEntry(r))}}t?i.readEntries(arguments.callee,n):s(0)},n);return true}};l.setNativeEntry=function(e){l.nativeEntry=e&&e.webkitGetAsEntry&&e.webkitGetAsEntry()};l.event=function(e,t){return f.appendEventsToObject.apply(l,arguments)};l.preview=function(e,t){return f.previewToObject.apply(l,arguments)};l.onXhrSend=function(e,t){e.send(t)};l.event({xhrSend:l.onXhrSend})};f.File.fromEntry=function(e){var t=new f.File(e);t.setNativeEntry(e);t.nativeFile=null;return t};f.jQuery=function(o){o=o||jQuery||window.jQuery;if(!o){throw"No window.jQuery object to integrate FileDrop into."}o.fn.filedrop=function(e){function t(r,n){return function(e){var t=(n||[]).concat(f.toArray(arguments,1));return i.triggerHandler((r+e).toLowerCase(),t)}}var i=this;var r=this.data("filedrop");if(typeof e=="string"){if(!r){o.error("$.filedrop('comment') needs an initialized FilrDrop on this element.")}else if(typeof r[e]=="undefined"){o.error("There's no method or property FileDrop."+e+".")}else{var n=r[e];if(typeof n=="function"){return n.apply(r,f.toArray(arguments,1))}else{return n}}}else if(!e||typeof e=="object"){if(!r){var a=new FileDrop(this[0],e);a.$el=o(this);this.first().data("filedrop",a);a.event("any",t("fd"));a.on.fileSetup.push(function(e){e.event("any",t("file",[e]))})}else if(!e){return r}else{f.extend(r.opt,e,true)}}else{o.error("Invalid $.filedrop() parameter - expected nothing (creates new zone),"+" a string (property to access) or an object (custom zone options).")}return i}};t.FileDrop=f.FileDrop});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.flatpickr=t())})(this,function(){"use strict";var Ee=function(){Ee=Object.assign||function e(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a))t[a]=r[a]}return t};return Ee.apply(this,arguments)};var ke=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"];var Te={_disable:[],_enable:[],allowInput:false,altFormat:"F j, Y",altInput:false,altInputClass:"form-control input",animate:typeof window==="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",clickOpens:true,closeOnSelect:true,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:false,enable:[],enableSeconds:false,enableTime:false,errorHandler:function(e){return typeof console!=="undefined"&&console.warn(e)},getWeek:function(e){var t=new Date(e.getTime());t.setHours(0,0,0,0);t.setDate(t.getDate()+3-(t.getDay()+6)%7);var r=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-r.getTime())/864e5-3+(r.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:false,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:false,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:undefined,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:false,showMonths:1,static:false,time_24hr:false,weekNumbers:false,wrap:false};var _e={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:false};var xe=function(e){return("0"+e).slice(-2)};var De=function(e){return e===true?1:0};function Re(r,n,i){if(i===void 0){i=false}var a;return function(){var e=this,t=arguments;a!==null&&clearTimeout(a);a=window.setTimeout(function(){a=null;if(!i)r.apply(e,t)},n);if(i&&!a)r.apply(e,t)}}var Ie=function(e){return e instanceof Array?e:[e]};function Oe(e,t,r){if(r===true)return e.classList.add(t);e.classList.remove(t)}function Ae(e,t,r){var n=window.document.createElement(e);t=t||"";r=r||"";n.className=t;if(r!==undefined)n.textContent=r;return n}function Ne(e){while(e.firstChild)e.removeChild(e.firstChild)}function Me(e,t){if(t(e))return e;else if(e.parentNode)return Me(e.parentNode,t);return undefined}function Le(e,t){var r=Ae("div","numInputWrapper"),n=Ae("input","numInput "+e),i=Ae("span","arrowUp"),a=Ae("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1){n.type="number"}else{n.type="text";n.pattern="\\d*"}if(t!==undefined)for(var o in t)n.setAttribute(o,t[o]);r.appendChild(n);r.appendChild(i);r.appendChild(a);return r}function Pe(e){if(typeof e.composedPath==="function"){var t=e.composedPath();return t[0]}return e.target}var e=function(){return undefined};var Fe=function(e,t,r){return r.months[t?"shorthand":"longhand"][e]};var w={D:e,F:function(e,t,r){e.setMonth(r.months.longhand.indexOf(t))},G:function(e,t){e.setHours(parseFloat(t))},H:function(e,t){e.setHours(parseFloat(t))},J:function(e,t){e.setDate(parseFloat(t))},K:function(e,t,r){e.setHours(e.getHours()%12+12*De(new RegExp(r.amPM[1],"i").test(t)))},M:function(e,t,r){e.setMonth(r.months.shorthand.indexOf(t))},S:function(e,t){e.setSeconds(parseFloat(t))},U:function(e,t){return new Date(parseFloat(t)*1e3)},W:function(e,t,r){var n=parseInt(t);var i=new Date(e.getFullYear(),0,2+(n-1)*7,0,0,0,0);i.setDate(i.getDate()-i.getDay()+r.firstDayOfWeek);return i},Y:function(e,t){e.setFullYear(parseFloat(t))},Z:function(e,t){return new Date(t)},d:function(e,t){e.setDate(parseFloat(t))},h:function(e,t){e.setHours(parseFloat(t))},i:function(e,t){e.setMinutes(parseFloat(t))},j:function(e,t){e.setDate(parseFloat(t))},l:e,m:function(e,t){e.setMonth(parseFloat(t)-1)},n:function(e,t){e.setMonth(parseFloat(t)-1)},s:function(e,t){e.setSeconds(parseFloat(t))},u:function(e,t){return new Date(parseFloat(t))},w:e,y:function(e,t){e.setFullYear(2e3+parseFloat(t))}};var Be={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"};var s={Z:function(e){return e.toISOString()},D:function(e,t,r){return t.weekdays.shorthand[s.w(e,t,r)]},F:function(e,t,r){return Fe(s.n(e,t,r)-1,false,t)},G:function(e,t,r){return xe(s.h(e,t,r))},H:function(e){return xe(e.getHours())},J:function(e,t){return t.ordinal!==undefined?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:function(e,t){return t.amPM[De(e.getHours()>11)]},M:function(e,t){return Fe(e.getMonth(),true,t)},S:function(e){return xe(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,t,r){return r.getWeek(e)},Y:function(e){return e.getFullYear()},d:function(e){return xe(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return xe(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:function(e){return xe(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}};var He=function(e){var t=e.config,a=t===void 0?Te:t,r=e.l10n,o=r===void 0?_e:r;return function(n,e,t){var i=t||o;if(a.formatDate!==undefined){return a.formatDate(n,e,i)}return e.split("").map(function(e,t,r){return s[e]&&r[t-1]!=="\\"?s[e](n,i,a):e!=="\\"?e:""}).join("")}};var $e=function(e){var t=e.config,y=t===void 0?Te:t,r=e.l10n,b=r===void 0?_e:r;return function(e,t,r,n){if(e!==0&&!e)return undefined;var i=n||b;var a;var o=e;if(e instanceof Date)a=new Date(e.getTime());else if(typeof e!=="string"&&e.toFixed!==undefined)a=new Date(e);else if(typeof e==="string"){var s=t||(y||Te).dateFormat;var l=String(e).trim();if(l==="today"){a=new Date;r=true}else if(/Z$/.test(l)||/GMT$/.test(l))a=new Date(e);else if(y&&y.parseDate)a=y.parseDate(e,s);else{a=!y||!y.noCalendar?new Date((new Date).getFullYear(),0,1,0,0,0,0):new Date((new Date).setHours(0,0,0,0));var u=void 0,f=[];for(var c=0,d=0,h="";c<s.length;c++){var v=s[c];var p=v==="\\";var g=s[c-1]==="\\"||p;if(Be[v]&&!g){h+=Be[v];var m=new RegExp(h).exec(e);if(m&&(u=true)){f[v!=="Y"?"push":"unshift"]({fn:w[v],val:m[++d]})}}else if(!p)h+=".";f.forEach(function(e){var t=e.fn,r=e.val;return a=t(a,r,i)||a})}a=u?a:undefined}}if(!(a instanceof Date&&!isNaN(a.getTime()))){y.errorHandler(new Error("Invalid date provided: "+o));return undefined}if(r===true)a.setHours(0,0,0,0);return a}};function We(e,t,r){if(r===void 0){r=true}if(r!==false){return new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0)}return e.getTime()-t.getTime()}var Ue=function(e,t,r){return e>Math.min(t,r)&&e<Math.max(t,r)};var je={DAY:864e5};if(typeof Object.assign!=="function"){Object.assign=function(r){var e=[];for(var t=1;t<arguments.length;t++){e[t-1]=arguments[t]}if(!r){throw TypeError("Cannot convert undefined or null to object")}var n=function(t){if(t){Object.keys(t).forEach(function(e){return r[e]=t[e]})}};for(var i=0,a=e;i<a.length;i++){var o=a[i];n(o)}return r}}var Ve=300;function o(f,c){var S={config:Ee({},Te,ze.defaultConfig),l10n:_e};S.parseDate=$e({config:S.config,l10n:S.l10n});S._handlers=[];S.pluginElements=[];S.loadedPlugins=[];S._bind=u;S._setHoursFromDate=a;S._positionCalendar=te;S.changeMonth=B;S.changeYear=V;S.clear=H;S.close=$;S._createElement=Ae;S.destroy=W;S.isEnabled=z;S.jumpToDate=y;S.open=J;S.redraw=re;S.set=oe;S.setDate=le;S.toggle=he;function t(){S.utils={getDaysInMonth:function(e,t){if(e===void 0){e=S.currentMonth}if(t===void 0){t=S.currentYear}if(e===1&&(t%4===0&&t%100!==0||t%400===0))return 29;return S.l10n.daysInMonth[e]}}}function e(){S.element=S.input=f;S.isOpen=false;Z();ee();ce();fe();t();if(!S.isMobile)C();m();if(S.selectedDates.length||S.config.noCalendar){if(S.config.enableTime){a(S.config.noCalendar?S.latestSelectedDateObj||S.config.minDate:undefined)}we(false)}r();S.showTimeInput=S.selectedDates.length>0||S.config.noCalendar;var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(!S.isMobile&&e){te()}ve("onReady")}function d(e){return e.bind(S)}function r(){var t=S.config;if(t.weekNumbers===false&&t.showMonths===1)return;else if(t.noCalendar!==true){window.requestAnimationFrame(function(){if(S.calendarContainer!==undefined){S.calendarContainer.style.visibility="hidden";S.calendarContainer.style.display="block"}if(S.daysContainer!==undefined){var e=(S.days.offsetWidth+1)*t.showMonths;S.daysContainer.style.width=e+"px";S.calendarContainer.style.width=e+(S.weekWrapper!==undefined?S.weekWrapper.offsetWidth:0)+"px";S.calendarContainer.style.removeProperty("visibility");S.calendarContainer.style.removeProperty("display")}})}}function h(e){if(S.selectedDates.length===0){K()}if(e!==undefined&&e.type!=="blur"){Se(e)}var t=S._input.value;v();we();if(S._input.value!==t){S._debouncedChange()}}function s(e,t){return e%12+12*De(t===S.l10n.amPM[1])}function i(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}function v(){if(S.hourElement===undefined||S.minuteElement===undefined)return;var e=(parseInt(S.hourElement.value.slice(-2),10)||0)%24,t=(parseInt(S.minuteElement.value,10)||0)%60,r=S.secondElement!==undefined?(parseInt(S.secondElement.value,10)||0)%60:0;if(S.amPM!==undefined){e=s(e,S.amPM.textContent)}var n=S.config.minTime!==undefined||S.config.minDate&&S.minDateHasTime&&S.latestSelectedDateObj&&We(S.latestSelectedDateObj,S.config.minDate,true)===0;var i=S.config.maxTime!==undefined||S.config.maxDate&&S.maxDateHasTime&&S.latestSelectedDateObj&&We(S.latestSelectedDateObj,S.config.maxDate,true)===0;if(i){var a=S.config.maxTime!==undefined?S.config.maxTime:S.config.maxDate;e=Math.min(e,a.getHours());if(e===a.getHours())t=Math.min(t,a.getMinutes());if(t===a.getMinutes())r=Math.min(r,a.getSeconds())}if(n){var o=S.config.minTime!==undefined?S.config.minTime:S.config.minDate;e=Math.max(e,o.getHours());if(e===o.getHours())t=Math.max(t,o.getMinutes());if(t===o.getMinutes())r=Math.max(r,o.getSeconds())}l(e,t,r)}function a(e){var t=e||S.latestSelectedDateObj;if(t)l(t.getHours(),t.getMinutes(),t.getSeconds())}function n(){var e=S.config.defaultHour;var t=S.config.defaultMinute;var r=S.config.defaultSeconds;if(S.config.minDate!==undefined){var n=S.config.minDate.getHours();var i=S.config.minDate.getMinutes();e=Math.max(e,n);if(e===n)t=Math.max(i,t);if(e===n&&t===i)r=S.config.minDate.getSeconds()}if(S.config.maxDate!==undefined){var a=S.config.maxDate.getHours();var o=S.config.maxDate.getMinutes();e=Math.min(e,a);if(e===a)t=Math.min(o,t);if(e===a&&t===o)r=S.config.maxDate.getSeconds()}l(e,t,r)}function l(e,t,r){if(S.latestSelectedDateObj!==undefined){S.latestSelectedDateObj.setHours(e%24,t,r||0,0)}if(!S.hourElement||!S.minuteElement||S.isMobile)return;S.hourElement.value=xe(!S.config.time_24hr?(12+e)%12+12*De(e%12===0):e);S.minuteElement.value=xe(t);if(S.amPM!==undefined)S.amPM.textContent=S.l10n.amPM[De(e>=12)];if(S.secondElement!==undefined)S.secondElement.value=xe(r)}function o(e){var t=parseInt(e.target.value)+(e.delta||0);if(t/1e3>1||e.key==="Enter"&&!/[^\d]/.test(t.toString())){V(t)}}function u(t,r,n,i){if(r instanceof Array)return r.forEach(function(e){return u(t,e,n,i)});if(t instanceof Array)return t.forEach(function(e){return u(e,r,n,i)});t.addEventListener(r,n,i);S._handlers.push({element:t,event:r,handler:n,options:i})}function p(t){return function(e){e.which===1&&t(e)}}function g(){ve("onChange")}function m(){if(S.config.wrap){["open","close","toggle","clear"].forEach(function(t){Array.prototype.forEach.call(S.element.querySelectorAll("[data-"+t+"]"),function(e){return u(e,"click",S[t])})})}if(S.isMobile){de();return}var e=Re(X,50);S._debouncedChange=Re(g,Ve);if(S.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent))u(S.daysContainer,"mouseover",function(e){if(S.config.mode==="range")G(e.target)});u(window.document.body,"keydown",Y);if(!S.config.inline&&!S.config.static)u(window,"resize",e);if(window.ontouchstart!==undefined)u(window.document,"touchstart",j);else u(window.document,"mousedown",p(j));u(window.document,"focus",j,{capture:true});if(S.config.clickOpens===true){u(S._input,"focus",S.open);u(S._input,"mousedown",p(S.open))}if(S.daysContainer!==undefined){u(S.monthNav,"mousedown",p(Ce));u(S.monthNav,["keyup","increment"],o);u(S.daysContainer,"mousedown",p(ie))}if(S.timeContainer!==undefined&&S.minuteElement!==undefined&&S.hourElement!==undefined){var t=function(e){return e.target.select()};u(S.timeContainer,["increment"],h);u(S.timeContainer,"blur",h,{capture:true});u(S.timeContainer,"mousedown",p(b));u([S.hourElement,S.minuteElement],["focus","click"],t);if(S.secondElement!==undefined)u(S.secondElement,"focus",function(){return S.secondElement&&S.secondElement.select()});if(S.amPM!==undefined){u(S.amPM,"mousedown",p(function(e){h(e);g()}))}}}function y(e,t){var r=e!==undefined?S.parseDate(e):S.latestSelectedDateObj||(S.config.minDate&&S.config.minDate>S.now?S.config.minDate:S.config.maxDate&&S.config.maxDate<S.now?S.config.maxDate:S.now);var n=S.currentYear;var i=S.currentMonth;try{if(r!==undefined){S.currentYear=r.getFullYear();S.currentMonth=r.getMonth()}}catch(e){e.message="Invalid date supplied: "+r;S.config.errorHandler(e)}if(t&&S.currentYear!==n){ve("onYearChange");I()}if(t&&(S.currentYear!==n||S.currentMonth!==i)){ve("onMonthChange")}S.redraw()}function b(e){if(~e.target.className.indexOf("arrow"))w(e,e.target.classList.contains("arrowUp")?1:-1)}function w(e,t,r){var n=e&&e.target;var i=r||n&&n.parentNode&&n.parentNode.firstChild;var a=pe("increment");a.delta=t;i&&i.dispatchEvent(a)}function C(){var e=window.document.createDocumentFragment();S.calendarContainer=Ae("div","flatpickr-calendar");S.calendarContainer.tabIndex=-1;if(!S.config.noCalendar){e.appendChild(N());S.innerContainer=Ae("div","flatpickr-innerContainer");if(S.config.weekNumbers){var t=F(),r=t.weekWrapper,n=t.weekNumbers;S.innerContainer.appendChild(r);S.weekNumbers=n;S.weekWrapper=r}S.rContainer=Ae("div","flatpickr-rContainer");S.rContainer.appendChild(L());if(!S.daysContainer){S.daysContainer=Ae("div","flatpickr-days");S.daysContainer.tabIndex=-1}R();S.rContainer.appendChild(S.daysContainer);S.innerContainer.appendChild(S.rContainer);e.appendChild(S.innerContainer)}if(S.config.enableTime){e.appendChild(M())}Oe(S.calendarContainer,"rangeMode",S.config.mode==="range");Oe(S.calendarContainer,"animate",S.config.animate===true);Oe(S.calendarContainer,"multiMonth",S.config.showMonths>1);S.calendarContainer.appendChild(e);var i=S.config.appendTo!==undefined&&S.config.appendTo.nodeType!==undefined;if(S.config.inline||S.config.static){S.calendarContainer.classList.add(S.config.inline?"inline":"static");if(S.config.inline){if(!i&&S.element.parentNode)S.element.parentNode.insertBefore(S.calendarContainer,S._input.nextSibling);else if(S.config.appendTo!==undefined)S.config.appendTo.appendChild(S.calendarContainer)}if(S.config.static){var a=Ae("div","flatpickr-wrapper");if(S.element.parentNode)S.element.parentNode.insertBefore(a,S.element);a.appendChild(S.element);if(S.altInput)a.appendChild(S.altInput);a.appendChild(S.calendarContainer)}}if(!S.config.static&&!S.config.inline)(S.config.appendTo!==undefined?S.config.appendTo:window.document.body).appendChild(S.calendarContainer)}function E(e,t,r,n){var i=z(t,true),a=Ae("span","flatpickr-day "+e,t.getDate().toString());a.dateObj=t;a.$i=n;a.setAttribute("aria-label",S.formatDate(t,S.config.ariaDateFormat));if(e.indexOf("hidden")===-1&&We(t,S.now)===0){S.todayDateElem=a;a.classList.add("today");a.setAttribute("aria-current","date")}if(i){a.tabIndex=-1;if(ge(t)){a.classList.add("selected");S.selectedDateElem=a;if(S.config.mode==="range"){Oe(a,"startRange",S.selectedDates[0]&&We(t,S.selectedDates[0],true)===0);Oe(a,"endRange",S.selectedDates[1]&&We(t,S.selectedDates[1],true)===0);if(e==="nextMonthDay")a.classList.add("inRange")}}}else{a.classList.add("flatpickr-disabled")}if(S.config.mode==="range"){if(me(t)&&!ge(t))a.classList.add("inRange")}if(S.weekNumbers&&S.config.showMonths===1&&e!=="prevMonthDay"&&r%7===1){S.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+S.config.getWeek(t)+"</span>")}ve("onDayCreate",a);return a}function k(e){e.focus();if(S.config.mode==="range")G(e)}function T(e){var t=e>0?0:S.config.showMonths-1;var r=e>0?S.config.showMonths:-1;for(var n=t;n!=r;n+=e){var i=S.daysContainer.children[n];var a=e>0?0:i.children.length-1;var o=e>0?i.children.length:-1;for(var s=a;s!=o;s+=e){var l=i.children[s];if(l.className.indexOf("hidden")===-1&&z(l.dateObj))return l}}return undefined}function _(e,t){var r=e.className.indexOf("Month")===-1?e.dateObj.getMonth():S.currentMonth;var n=t>0?S.config.showMonths:-1;var i=t>0?1:-1;for(var a=r-S.currentMonth;a!=n;a+=i){var o=S.daysContainer.children[a];var s=r-S.currentMonth===a?e.$i+t:t<0?o.children.length-1:0;var l=o.children.length;for(var u=s;u>=0&&u<l&&u!=(t>0?l:-1);u+=i){var f=o.children[u];if(f.className.indexOf("hidden")===-1&&z(f.dateObj)&&Math.abs(e.$i-u)>=Math.abs(t))return k(f)}}S.changeMonth(i);x(T(i),0);return undefined}function x(e,t){var r=q(document.activeElement||document.body);var n=e!==undefined?e:r?document.activeElement:S.selectedDateElem!==undefined&&q(S.selectedDateElem)?S.selectedDateElem:S.todayDateElem!==undefined&&q(S.todayDateElem)?S.todayDateElem:T(t>0?1:-1);if(n===undefined)return S._input.focus();if(!r)return k(n);_(n,t)}function D(e,t){var r=(new Date(e,t,1).getDay()-S.l10n.firstDayOfWeek+7)%7;var n=S.utils.getDaysInMonth((t-1+12)%12);var i=S.utils.getDaysInMonth(t),a=window.document.createDocumentFragment(),o=S.config.showMonths>1,s=o?"prevMonthDay hidden":"prevMonthDay",l=o?"nextMonthDay hidden":"nextMonthDay";var u=n+1-r,f=0;for(;u<=n;u++,f++){a.appendChild(E(s,new Date(e,t-1,u),u,f))}for(u=1;u<=i;u++,f++){a.appendChild(E("",new Date(e,t,u),u,f))}for(var c=i+1;c<=42-r&&(S.config.showMonths===1||f%7!==0);c++,f++){a.appendChild(E(l,new Date(e,t+1,c%i),c,f))}var d=Ae("div","dayContainer");d.appendChild(a);return d}function R(){if(S.daysContainer===undefined){return}Ne(S.daysContainer);if(S.weekNumbers)Ne(S.weekNumbers);var e=document.createDocumentFragment();for(var t=0;t<S.config.showMonths;t++){var r=new Date(S.currentYear,S.currentMonth,1);r.setMonth(S.currentMonth+t);e.appendChild(D(r.getFullYear(),r.getMonth()))}S.daysContainer.appendChild(e);S.days=S.daysContainer.firstChild;if(S.config.mode==="range"&&S.selectedDates.length===1){G()}}function I(){if(S.config.showMonths>1||S.config.monthSelectorType!=="dropdown")return;var e=function(e){if(S.config.minDate!==undefined&&S.currentYear===S.config.minDate.getFullYear()&&e<S.config.minDate.getMonth()){return false}return!(S.config.maxDate!==undefined&&S.currentYear===S.config.maxDate.getFullYear()&&e>S.config.maxDate.getMonth())};S.monthsDropdownContainer.tabIndex=-1;S.monthsDropdownContainer.innerHTML="";for(var t=0;t<12;t++){if(!e(t))continue;var r=Ae("option","flatpickr-monthDropdown-month");r.value=new Date(S.currentYear,t).getMonth().toString();r.textContent=Fe(t,S.config.shorthandCurrentMonth,S.l10n);r.tabIndex=-1;if(S.currentMonth===t){r.selected=true}S.monthsDropdownContainer.appendChild(r)}}function O(){var e=Ae("div","flatpickr-month");var t=window.document.createDocumentFragment();var r;if(S.config.showMonths>1||S.config.monthSelectorType==="static"){r=Ae("span","cur-month")}else{S.monthsDropdownContainer=Ae("select","flatpickr-monthDropdown-months");u(S.monthsDropdownContainer,"change",function(e){var t=e.target;var r=parseInt(t.value,10);S.changeMonth(r-S.currentMonth);ve("onMonthChange")});I();r=S.monthsDropdownContainer}var n=Le("cur-year",{tabindex:"-1"});var i=n.getElementsByTagName("input")[0];i.setAttribute("aria-label",S.l10n.yearAriaLabel);if(S.config.minDate){i.setAttribute("min",S.config.minDate.getFullYear().toString())}if(S.config.maxDate){i.setAttribute("max",S.config.maxDate.getFullYear().toString());i.disabled=!!S.config.minDate&&S.config.minDate.getFullYear()===S.config.maxDate.getFullYear()}var a=Ae("div","flatpickr-current-month");a.appendChild(r);a.appendChild(n);t.appendChild(a);e.appendChild(t);return{container:e,yearElement:i,monthElement:r}}function A(){Ne(S.monthNav);S.monthNav.appendChild(S.prevMonthNav);if(S.config.showMonths){S.yearElements=[];S.monthElements=[]}for(var e=S.config.showMonths;e--;){var t=O();S.yearElements.push(t.yearElement);S.monthElements.push(t.monthElement);S.monthNav.appendChild(t.container)}S.monthNav.appendChild(S.nextMonthNav)}function N(){S.monthNav=Ae("div","flatpickr-months");S.yearElements=[];S.monthElements=[];S.prevMonthNav=Ae("span","flatpickr-prev-month");S.prevMonthNav.innerHTML=S.config.prevArrow;S.nextMonthNav=Ae("span","flatpickr-next-month");S.nextMonthNav.innerHTML=S.config.nextArrow;A();Object.defineProperty(S,"_hidePrevMonthArrow",{get:function(){return S.__hidePrevMonthArrow},set:function(e){if(S.__hidePrevMonthArrow!==e){Oe(S.prevMonthNav,"flatpickr-disabled",e);S.__hidePrevMonthArrow=e}}});Object.defineProperty(S,"_hideNextMonthArrow",{get:function(){return S.__hideNextMonthArrow},set:function(e){if(S.__hideNextMonthArrow!==e){Oe(S.nextMonthNav,"flatpickr-disabled",e);S.__hideNextMonthArrow=e}}});S.currentYearElement=S.yearElements[0];ye();return S.monthNav}function M(){S.calendarContainer.classList.add("hasTime");if(S.config.noCalendar)S.calendarContainer.classList.add("noCalendar");S.timeContainer=Ae("div","flatpickr-time");S.timeContainer.tabIndex=-1;var e=Ae("span","flatpickr-time-separator",":");var t=Le("flatpickr-hour",{"aria-label":S.l10n.hourAriaLabel});S.hourElement=t.getElementsByTagName("input")[0];var r=Le("flatpickr-minute",{"aria-label":S.l10n.minuteAriaLabel});S.minuteElement=r.getElementsByTagName("input")[0];S.hourElement.tabIndex=S.minuteElement.tabIndex=-1;S.hourElement.value=xe(S.latestSelectedDateObj?S.latestSelectedDateObj.getHours():S.config.time_24hr?S.config.defaultHour:i(S.config.defaultHour));S.minuteElement.value=xe(S.latestSelectedDateObj?S.latestSelectedDateObj.getMinutes():S.config.defaultMinute);S.hourElement.setAttribute("step",S.config.hourIncrement.toString());S.minuteElement.setAttribute("step",S.config.minuteIncrement.toString());S.hourElement.setAttribute("min",S.config.time_24hr?"0":"1");S.hourElement.setAttribute("max",S.config.time_24hr?"23":"12");S.minuteElement.setAttribute("min","0");S.minuteElement.setAttribute("max","59");S.timeContainer.appendChild(t);S.timeContainer.appendChild(e);S.timeContainer.appendChild(r);if(S.config.time_24hr)S.timeContainer.classList.add("time24hr");if(S.config.enableSeconds){S.timeContainer.classList.add("hasSeconds");var n=Le("flatpickr-second");S.secondElement=n.getElementsByTagName("input")[0];S.secondElement.value=xe(S.latestSelectedDateObj?S.latestSelectedDateObj.getSeconds():S.config.defaultSeconds);S.secondElement.setAttribute("step",S.minuteElement.getAttribute("step"));S.secondElement.setAttribute("min","0");S.secondElement.setAttribute("max","59");S.timeContainer.appendChild(Ae("span","flatpickr-time-separator",":"));S.timeContainer.appendChild(n)}if(!S.config.time_24hr){S.amPM=Ae("span","flatpickr-am-pm",S.l10n.amPM[De((S.latestSelectedDateObj?S.hourElement.value:S.config.defaultHour)>11)]);S.amPM.title=S.l10n.toggleTitle;S.amPM.tabIndex=-1;S.timeContainer.appendChild(S.amPM)}return S.timeContainer}function L(){if(!S.weekdayContainer)S.weekdayContainer=Ae("div","flatpickr-weekdays");else Ne(S.weekdayContainer);for(var e=S.config.showMonths;e--;){var t=Ae("div","flatpickr-weekdaycontainer");S.weekdayContainer.appendChild(t)}P();return S.weekdayContainer}function P(){if(!S.weekdayContainer){return}var e=S.l10n.firstDayOfWeek;var t=S.l10n.weekdays.shorthand.slice();if(e>0&&e<t.length){t=t.splice(e,t.length).concat(t.splice(0,e))}for(var r=S.config.showMonths;r--;){S.weekdayContainer.children[r].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+t.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function F(){S.calendarContainer.classList.add("hasWeeks");var e=Ae("div","flatpickr-weekwrapper");e.appendChild(Ae("span","flatpickr-weekday",S.l10n.weekAbbreviation));var t=Ae("div","flatpickr-weeks");e.appendChild(t);return{weekWrapper:e,weekNumbers:t}}function B(e,t){if(t===void 0){t=true}var r=t?e:e-S.currentMonth;if(r<0&&S._hidePrevMonthArrow===true||r>0&&S._hideNextMonthArrow===true)return;S.currentMonth+=r;if(S.currentMonth<0||S.currentMonth>11){S.currentYear+=S.currentMonth>11?1:-1;S.currentMonth=(S.currentMonth+12)%12;ve("onYearChange");I()}R();ve("onMonthChange");ye()}function H(e,t){if(e===void 0){e=true}if(t===void 0){t=true}S.input.value="";if(S.altInput!==undefined)S.altInput.value="";if(S.mobileInput!==undefined)S.mobileInput.value="";S.selectedDates=[];S.latestSelectedDateObj=undefined;if(t===true){S.currentYear=S._initialDate.getFullYear();S.currentMonth=S._initialDate.getMonth()}S.showTimeInput=false;if(S.config.enableTime===true){n()}S.redraw();if(e)ve("onChange")}function $(){S.isOpen=false;if(!S.isMobile){if(S.calendarContainer!==undefined){S.calendarContainer.classList.remove("open")}if(S._input!==undefined){S._input.classList.remove("active")}}ve("onClose")}function W(){if(S.config!==undefined)ve("onDestroy");for(var e=S._handlers.length;e--;){var t=S._handlers[e];t.element.removeEventListener(t.event,t.handler,t.options)}S._handlers=[];if(S.mobileInput){if(S.mobileInput.parentNode)S.mobileInput.parentNode.removeChild(S.mobileInput);S.mobileInput=undefined}else if(S.calendarContainer&&S.calendarContainer.parentNode){if(S.config.static&&S.calendarContainer.parentNode){var r=S.calendarContainer.parentNode;r.lastChild&&r.removeChild(r.lastChild);if(r.parentNode){while(r.firstChild)r.parentNode.insertBefore(r.firstChild,r);r.parentNode.removeChild(r)}}else S.calendarContainer.parentNode.removeChild(S.calendarContainer)}if(S.altInput){S.input.type="text";if(S.altInput.parentNode)S.altInput.parentNode.removeChild(S.altInput);delete S.altInput}if(S.input){S.input.type=S.input._type;S.input.classList.remove("flatpickr-input");S.input.removeAttribute("readonly");S.input.value=""}["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(e){try{delete S[e]}catch(e){}})}function U(e){if(S.config.appendTo&&S.config.appendTo.contains(e))return true;return S.calendarContainer.contains(e)}function j(e){if(S.isOpen&&!S.config.inline){var t=Pe(e);var r=U(t);var n=t===S.input||t===S.altInput||S.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(S.input)||~e.path.indexOf(S.altInput));var i=e.type==="blur"?n&&e.relatedTarget&&!U(e.relatedTarget):!n&&!r&&!U(e.relatedTarget);var a=!S.config.ignoredFocusElements.some(function(e){return e.contains(t)});if(i&&a){if(S.timeContainer!==undefined&&S.minuteElement!==undefined&&S.hourElement!==undefined){h()}S.close();if(S.config.mode==="range"&&S.selectedDates.length===1){S.clear(false);S.redraw()}}}}function V(e){if(!e||S.config.minDate&&e<S.config.minDate.getFullYear()||S.config.maxDate&&e>S.config.maxDate.getFullYear())return;var t=e,r=S.currentYear!==t;S.currentYear=t||S.currentYear;if(S.config.maxDate&&S.currentYear===S.config.maxDate.getFullYear()){S.currentMonth=Math.min(S.config.maxDate.getMonth(),S.currentMonth)}else if(S.config.minDate&&S.currentYear===S.config.minDate.getFullYear()){S.currentMonth=Math.max(S.config.minDate.getMonth(),S.currentMonth)}if(r){S.redraw();ve("onYearChange");I()}}function z(e,t){if(t===void 0){t=true}var r=S.parseDate(e,undefined,t);if(S.config.minDate&&r&&We(r,S.config.minDate,t!==undefined?t:!S.minDateHasTime)<0||S.config.maxDate&&r&&We(r,S.config.maxDate,t!==undefined?t:!S.maxDateHasTime)>0)return false;if(S.config.enable.length===0&&S.config.disable.length===0)return true;if(r===undefined)return false;var n=S.config.enable.length>0,i=n?S.config.enable:S.config.disable;for(var a=0,o=void 0;a<i.length;a++){o=i[a];if(typeof o==="function"&&o(r))return n;else if(o instanceof Date&&r!==undefined&&o.getTime()===r.getTime())return n;else if(typeof o==="string"&&r!==undefined){var s=S.parseDate(o,undefined,true);return s&&s.getTime()===r.getTime()?n:!n}else if(typeof o==="object"&&r!==undefined&&o.from&&o.to&&r.getTime()>=o.from.getTime()&&r.getTime()<=o.to.getTime())return n}return!n}function q(e){if(S.daysContainer!==undefined)return e.className.indexOf("hidden")===-1&&S.daysContainer.contains(e);return false}function Y(e){var t=e.target===S._input;var r=S.config.allowInput;var n=S.isOpen&&(!r||!t);var i=S.config.inline&&t&&!r;if(e.keyCode===13&&t){if(r){S.setDate(S._input.value,true,e.target===S.altInput?S.config.altFormat:S.config.dateFormat);return e.target.blur()}else{S.open()}}else if(U(e.target)||n||i){var a=!!S.timeContainer&&S.timeContainer.contains(e.target);switch(e.keyCode){case 13:if(a){e.preventDefault();h();ne()}else ie(e);break;case 27:e.preventDefault();ne();break;case 8:case 46:if(t&&!S.config.allowInput){e.preventDefault();S.clear()}break;case 37:case 39:if(!a&&!t){e.preventDefault();if(S.daysContainer!==undefined&&(r===false||document.activeElement&&q(document.activeElement))){var o=e.keyCode===39?1:-1;if(!e.ctrlKey)x(undefined,o);else{e.stopPropagation();B(o);x(T(1),0)}}}else if(S.hourElement)S.hourElement.focus();break;case 38:case 40:e.preventDefault();var s=e.keyCode===40?1:-1;if(S.daysContainer&&e.target.$i!==undefined||e.target===S.input||e.target===S.altInput){if(e.ctrlKey){e.stopPropagation();V(S.currentYear-s);x(T(1),0)}else if(!a)x(undefined,s*7)}else if(e.target===S.currentYearElement){V(S.currentYear-s)}else if(S.config.enableTime){if(!a&&S.hourElement)S.hourElement.focus();h(e);S._debouncedChange()}break;case 9:if(a){var l=[S.hourElement,S.minuteElement,S.secondElement,S.amPM].concat(S.pluginElements).filter(function(e){return e});var u=l.indexOf(e.target);if(u!==-1){var f=l[u+(e.shiftKey?-1:1)];e.preventDefault();(f||S._input).focus()}}else if(!S.config.noCalendar&&S.daysContainer&&S.daysContainer.contains(e.target)&&e.shiftKey){e.preventDefault();S._input.focus()}break;default:break}}if(S.amPM!==undefined&&e.target===S.amPM){switch(e.key){case S.l10n.amPM[0].charAt(0):case S.l10n.amPM[0].charAt(0).toLowerCase():S.amPM.textContent=S.l10n.amPM[0];v();we();break;case S.l10n.amPM[1].charAt(0):case S.l10n.amPM[1].charAt(0).toLowerCase():S.amPM.textContent=S.l10n.amPM[1];v();we();break}}if(t||U(e.target)){ve("onKeyDown",e)}}function G(o){if(S.selectedDates.length!==1||o&&(!o.classList.contains("flatpickr-day")||o.classList.contains("flatpickr-disabled")))return;var s=o?o.dateObj.getTime():S.days.firstElementChild.dateObj.getTime(),l=S.parseDate(S.selectedDates[0],undefined,true).getTime(),e=Math.min(s,S.selectedDates[0].getTime()),t=Math.max(s,S.selectedDates[0].getTime());var u=false;var f=0,c=0;for(var r=e;r<t;r+=je.DAY){if(!z(new Date(r),true)){u=u||r>e&&r<t;if(r<l&&(!f||r>f))f=r;else if(r>l&&(!c||r<c))c=r}}for(var n=0;n<S.config.showMonths;n++){var d=S.daysContainer.children[n];var i=function(e,t){var r=d.children[e],n=r.dateObj;var i=n.getTime();var a=f>0&&i<f||c>0&&i>c;if(a){r.classList.add("notAllowed");["inRange","startRange","endRange"].forEach(function(e){r.classList.remove(e)});return"continue"}else if(u&&!a)return"continue";["startRange","inRange","endRange","notAllowed"].forEach(function(e){r.classList.remove(e)});if(o!==undefined){o.classList.add(s<=S.selectedDates[0].getTime()?"startRange":"endRange");if(l<s&&i===l)r.classList.add("startRange");else if(l>s&&i===l)r.classList.add("endRange");if(i>=f&&(c===0||i<=c)&&Ue(i,l,s))r.classList.add("inRange")}};for(var a=0,h=d.children.length;a<h;a++){i(a,h)}}}function X(){if(S.isOpen&&!S.config.static&&!S.config.inline)te()}function K(){S.setDate(S.config.minDate!==undefined?new Date(S.config.minDate.getTime()):new Date,true);n();we()}function J(e,t){if(t===void 0){t=S._positionElement}if(S.isMobile===true){if(e){e.preventDefault();e.target&&e.target.blur()}if(S.mobileInput!==undefined){S.mobileInput.focus();S.mobileInput.click()}ve("onOpen");return}if(S._input.disabled||S.config.inline)return;var r=S.isOpen;S.isOpen=true;if(!r){S.calendarContainer.classList.add("open");S._input.classList.add("active");ve("onOpen");te(t)}if(S.config.enableTime===true&&S.config.noCalendar===true){if(S.selectedDates.length===0){K()}if(S.config.allowInput===false&&(e===undefined||!S.timeContainer.contains(e.relatedTarget))){setTimeout(function(){return S.hourElement.select()},50)}}}function Q(n){return function(e){var t=S.config["_"+n+"Date"]=S.parseDate(e,S.config.dateFormat);var r=S.config["_"+(n==="min"?"max":"min")+"Date"];if(t!==undefined){S[n==="min"?"minDateHasTime":"maxDateHasTime"]=t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0}if(S.selectedDates){S.selectedDates=S.selectedDates.filter(function(e){return z(e)});if(!S.selectedDates.length&&n==="min")a(t);we()}if(S.daysContainer){re();if(t!==undefined)S.currentYearElement[n]=t.getFullYear().toString();else S.currentYearElement.removeAttribute(n);S.currentYearElement.disabled=!!r&&t!==undefined&&r.getFullYear()===t.getFullYear()}}}function Z(){var e=["wrap","weekNumbers","allowInput","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"];var t=Ee({},c,JSON.parse(JSON.stringify(f.dataset||{})));var r={};S.config.parseDate=t.parseDate;S.config.formatDate=t.formatDate;Object.defineProperty(S.config,"enable",{get:function(){return S.config._enable},set:function(e){S.config._enable=ue(e)}});Object.defineProperty(S.config,"disable",{get:function(){return S.config._disable},set:function(e){S.config._disable=ue(e)}});var n=t.mode==="time";if(!t.dateFormat&&(t.enableTime||n)){var i=ze.defaultConfig.dateFormat||Te.dateFormat;r.dateFormat=t.noCalendar||n?"H:i"+(t.enableSeconds?":S":""):i+" H:i"+(t.enableSeconds?":S":"")}if(t.altInput&&(t.enableTime||n)&&!t.altFormat){var a=ze.defaultConfig.altFormat||Te.altFormat;r.altFormat=t.noCalendar||n?"h:i"+(t.enableSeconds?":S K":" K"):a+(" h:i"+(t.enableSeconds?":S":"")+" K")}if(!t.altInputClass){S.config.altInputClass=S.input.className+" "+S.config.altInputClass}Object.defineProperty(S.config,"minDate",{get:function(){return S.config._minDate},set:Q("min")});Object.defineProperty(S.config,"maxDate",{get:function(){return S.config._maxDate},set:Q("max")});var o=function(t){return function(e){S.config[t==="min"?"_minTime":"_maxTime"]=S.parseDate(e,"H:i:S")}};Object.defineProperty(S.config,"minTime",{get:function(){return S.config._minTime},set:o("min")});Object.defineProperty(S.config,"maxTime",{get:function(){return S.config._maxTime},set:o("max")});if(t.mode==="time"){S.config.noCalendar=true;S.config.enableTime=true}Object.assign(S.config,r,t);for(var s=0;s<e.length;s++)S.config[e[s]]=S.config[e[s]]===true||S.config[e[s]]==="true";ke.filter(function(e){return S.config[e]!==undefined}).forEach(function(e){S.config[e]=Ie(S.config[e]||[]).map(d)});S.isMobile=!S.config.disableMobile&&!S.config.inline&&S.config.mode==="single"&&!S.config.disable.length&&!S.config.enable.length&&!S.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var s=0;s<S.config.plugins.length;s++){var l=S.config.plugins[s](S)||{};for(var u in l){if(ke.indexOf(u)>-1){S.config[u]=Ie(l[u]).map(d).concat(S.config[u])}else if(typeof t[u]==="undefined")S.config[u]=l[u]}}ve("onParseConfig")}function ee(){if(typeof S.config.locale!=="object"&&typeof ze.l10ns[S.config.locale]==="undefined")S.config.errorHandler(new Error("flatpickr: invalid locale "+S.config.locale));S.l10n=Ee({},ze.l10ns["default"],typeof S.config.locale==="object"?S.config.locale:S.config.locale!=="default"?ze.l10ns[S.config.locale]:undefined);Be.K="("+S.l10n.amPM[0]+"|"+S.l10n.amPM[1]+"|"+S.l10n.amPM[0].toLowerCase()+"|"+S.l10n.amPM[1].toLowerCase()+")";var e=Ee({},c,JSON.parse(JSON.stringify(f.dataset||{})));if(e.time_24hr===undefined&&ze.defaultConfig.time_24hr===undefined){S.config.time_24hr=S.l10n.time_24hr}S.formatDate=He(S);S.parseDate=$e({config:S.config,l10n:S.l10n})}function te(e){if(S.calendarContainer===undefined)return;ve("onPreCalendarPosition");var t=e||S._positionElement;var r=Array.prototype.reduce.call(S.calendarContainer.children,function(e,t){return e+t.offsetHeight},0),n=S.calendarContainer.offsetWidth,i=S.config.position.split(" "),a=i[0],o=i.length>1?i[1]:null,s=t.getBoundingClientRect(),l=window.innerHeight-s.bottom,u=a==="above"||a!=="below"&&l<r&&s.top>r;var f=window.pageYOffset+s.top+(!u?t.offsetHeight+2:-r-2);Oe(S.calendarContainer,"arrowTop",!u);Oe(S.calendarContainer,"arrowBottom",u);if(S.config.inline)return;var c=window.pageXOffset+s.left-(o!=null&&o==="center"?(n-s.width)/2:0);var d=window.document.body.offsetWidth-(window.pageXOffset+s.right);var h=c+n>window.document.body.offsetWidth;var v=d+n>window.document.body.offsetWidth;Oe(S.calendarContainer,"rightMost",h);if(S.config.static)return;S.calendarContainer.style.top=f+"px";if(!h){S.calendarContainer.style.left=c+"px";S.calendarContainer.style.right="auto"}else if(!v){S.calendarContainer.style.left="auto";S.calendarContainer.style.right=d+"px"}else{var p=document.styleSheets[0];if(p===undefined)return;var g=window.document.body.offsetWidth;var m=Math.max(0,g/2-n/2);var y=".flatpickr-calendar.centerMost:before";var b=".flatpickr-calendar.centerMost:after";var w=p.cssRules.length;var C="{left:"+s.left+"px;right:auto;}";Oe(S.calendarContainer,"rightMost",false);Oe(S.calendarContainer,"centerMost",true);p.insertRule(y+","+b+C,w);S.calendarContainer.style.left=m+"px";S.calendarContainer.style.right="auto"}}function re(){if(S.config.noCalendar||S.isMobile)return;ye();R()}function ne(){S._input.focus();if(window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==undefined){setTimeout(S.close,0)}else{S.close()}}function ie(e){e.preventDefault();e.stopPropagation();var t=function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")};var r=Me(e.target,t);if(r===undefined)return;var n=r;var i=S.latestSelectedDateObj=new Date(n.dateObj.getTime());var a=(i.getMonth()<S.currentMonth||i.getMonth()>S.currentMonth+S.config.showMonths-1)&&S.config.mode!=="range";S.selectedDateElem=n;if(S.config.mode==="single")S.selectedDates=[i];else if(S.config.mode==="multiple"){var o=ge(i);if(o)S.selectedDates.splice(parseInt(o),1);else S.selectedDates.push(i)}else if(S.config.mode==="range"){if(S.selectedDates.length===2){S.clear(false,false)}S.latestSelectedDateObj=i;S.selectedDates.push(i);if(We(i,S.selectedDates[0],true)!==0)S.selectedDates.sort(function(e,t){return e.getTime()-t.getTime()})}v();if(a){var s=S.currentYear!==i.getFullYear();S.currentYear=i.getFullYear();S.currentMonth=i.getMonth();if(s){ve("onYearChange");I()}ve("onMonthChange")}ye();R();we();if(S.config.enableTime)setTimeout(function(){return S.showTimeInput=true},50);if(!a&&S.config.mode!=="range"&&S.config.showMonths===1)k(n);else if(S.selectedDateElem!==undefined&&S.hourElement===undefined){S.selectedDateElem&&S.selectedDateElem.focus()}if(S.hourElement!==undefined)S.hourElement!==undefined&&S.hourElement.focus();if(S.config.closeOnSelect){var l=S.config.mode==="single"&&!S.config.enableTime;var u=S.config.mode==="range"&&S.selectedDates.length===2&&!S.config.enableTime;if(l||u){ne()}}g()}var ae={locale:[ee,P],showMonths:[A,r,L],minDate:[y],maxDate:[y]};function oe(e,t){if(e!==null&&typeof e==="object"){Object.assign(S.config,e);for(var r in e){if(ae[r]!==undefined)ae[r].forEach(function(e){return e()})}}else{S.config[e]=t;if(ae[e]!==undefined)ae[e].forEach(function(e){return e()});else if(ke.indexOf(e)>-1)S.config[e]=Ie(t)}S.redraw();we(false)}function se(e,t){var r=[];if(e instanceof Array)r=e.map(function(e){return S.parseDate(e,t)});else if(e instanceof Date||typeof e==="number")r=[S.parseDate(e,t)];else if(typeof e==="string"){switch(S.config.mode){case"single":case"time":r=[S.parseDate(e,t)];break;case"multiple":r=e.split(S.config.conjunction).map(function(e){return S.parseDate(e,t)});break;case"range":r=e.split(S.l10n.rangeSeparator).map(function(e){return S.parseDate(e,t)});break;default:break}}else S.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));S.selectedDates=r.filter(function(e){return e instanceof Date&&z(e,false)});if(S.config.mode==="range")S.selectedDates.sort(function(e,t){return e.getTime()-t.getTime()})}function le(e,t,r){if(t===void 0){t=false}if(r===void 0){r=S.config.dateFormat}if(e!==0&&!e||e instanceof Array&&e.length===0)return S.clear(t);se(e,r);S.showTimeInput=S.selectedDates.length>0;S.latestSelectedDateObj=S.selectedDates[S.selectedDates.length-1];S.redraw();y();a();if(S.selectedDates.length===0){S.clear(false)}we(t);if(t)ve("onChange")}function ue(e){return e.slice().map(function(e){if(typeof e==="string"||typeof e==="number"||e instanceof Date){return S.parseDate(e,undefined,true)}else if(e&&typeof e==="object"&&e.from&&e.to)return{from:S.parseDate(e.from,undefined),to:S.parseDate(e.to,undefined)};return e}).filter(function(e){return e})}function fe(){S.selectedDates=[];S.now=S.parseDate(S.config.now)||new Date;var e=S.config.defaultDate||((S.input.nodeName==="INPUT"||S.input.nodeName==="TEXTAREA")&&S.input.placeholder&&S.input.value===S.input.placeholder?null:S.input.value);if(e)se(e,S.config.dateFormat);S._initialDate=S.selectedDates.length>0?S.selectedDates[0]:S.config.minDate&&S.config.minDate.getTime()>S.now.getTime()?S.config.minDate:S.config.maxDate&&S.config.maxDate.getTime()<S.now.getTime()?S.config.maxDate:S.now;S.currentYear=S._initialDate.getFullYear();S.currentMonth=S._initialDate.getMonth();if(S.selectedDates.length>0)S.latestSelectedDateObj=S.selectedDates[0];if(S.config.minTime!==undefined)S.config.minTime=S.parseDate(S.config.minTime,"H:i");if(S.config.maxTime!==undefined)S.config.maxTime=S.parseDate(S.config.maxTime,"H:i");S.minDateHasTime=!!S.config.minDate&&(S.config.minDate.getHours()>0||S.config.minDate.getMinutes()>0||S.config.minDate.getSeconds()>0);S.maxDateHasTime=!!S.config.maxDate&&(S.config.maxDate.getHours()>0||S.config.maxDate.getMinutes()>0||S.config.maxDate.getSeconds()>0);Object.defineProperty(S,"showTimeInput",{get:function(){return S._showTimeInput},set:function(e){S._showTimeInput=e;if(S.calendarContainer)Oe(S.calendarContainer,"showTimeInput",e);S.isOpen&&te()}})}function ce(){S.input=S.config.wrap?f.querySelector("[data-input]"):f;if(!S.input){S.config.errorHandler(new Error("Invalid input element specified"));return}S.input._type=S.input.type;S.input.type="text";S.input.classList.add("flatpickr-input");S._input=S.input;if(S.config.altInput){S.altInput=Ae(S.input.nodeName,S.config.altInputClass);S._input=S.altInput;S.altInput.placeholder=S.input.placeholder;S.altInput.disabled=S.input.disabled;S.altInput.required=S.input.required;S.altInput.tabIndex=S.input.tabIndex;S.altInput.type="text";S.input.setAttribute("type","hidden");if(!S.config.static&&S.input.parentNode)S.input.parentNode.insertBefore(S.altInput,S.input.nextSibling)}if(!S.config.allowInput)S._input.setAttribute("readonly","readonly");S._positionElement=S.config.positionElement||S._input}function de(){var e=S.config.enableTime?S.config.noCalendar?"time":"datetime-local":"date";S.mobileInput=Ae("input",S.input.className+" flatpickr-mobile");S.mobileInput.step=S.input.getAttribute("step")||"any";S.mobileInput.tabIndex=1;S.mobileInput.type=e;S.mobileInput.disabled=S.input.disabled;S.mobileInput.required=S.input.required;S.mobileInput.placeholder=S.input.placeholder;S.mobileFormatStr=e==="datetime-local"?"Y-m-d\\TH:i:S":e==="date"?"Y-m-d":"H:i:S";if(S.selectedDates.length>0){S.mobileInput.defaultValue=S.mobileInput.value=S.formatDate(S.selectedDates[0],S.mobileFormatStr)}if(S.config.minDate)S.mobileInput.min=S.formatDate(S.config.minDate,"Y-m-d");if(S.config.maxDate)S.mobileInput.max=S.formatDate(S.config.maxDate,"Y-m-d");S.input.type="hidden";if(S.altInput!==undefined)S.altInput.type="hidden";try{if(S.input.parentNode)S.input.parentNode.insertBefore(S.mobileInput,S.input.nextSibling)}catch(e){}u(S.mobileInput,"change",function(e){S.setDate(e.target.value,false,S.mobileFormatStr);ve("onChange");ve("onClose")})}function he(e){if(S.isOpen===true)return S.close();S.open(e)}function ve(e,t){if(S.config===undefined)return;var r=S.config[e];if(r!==undefined&&r.length>0){for(var n=0;r[n]&&n<r.length;n++)r[n](S.selectedDates,S.input.value,S,t)}if(e==="onChange"){S.input.dispatchEvent(pe("change"));S.input.dispatchEvent(pe("input"))}}function pe(e){var t=document.createEvent("Event");t.initEvent(e,true,true);return t}function ge(e){for(var t=0;t<S.selectedDates.length;t++){if(We(S.selectedDates[t],e)===0)return""+t}return false}function me(e){if(S.config.mode!=="range"||S.selectedDates.length<2)return false;return We(e,S.selectedDates[0])>=0&&We(e,S.selectedDates[1])<=0}function ye(){if(S.config.noCalendar||S.isMobile||!S.monthNav)return;S.yearElements.forEach(function(e,t){var r=new Date(S.currentYear,S.currentMonth,1);r.setMonth(S.currentMonth+t);if(S.config.showMonths>1||S.config.monthSelectorType==="static"){S.monthElements[t].textContent=Fe(r.getMonth(),S.config.shorthandCurrentMonth,S.l10n)+" "}else{S.monthsDropdownContainer.value=r.getMonth().toString()}e.value=r.getFullYear().toString()});S._hidePrevMonthArrow=S.config.minDate!==undefined&&(S.currentYear===S.config.minDate.getFullYear()?S.currentMonth<=S.config.minDate.getMonth():S.currentYear<S.config.minDate.getFullYear());S._hideNextMonthArrow=S.config.maxDate!==undefined&&(S.currentYear===S.config.maxDate.getFullYear()?S.currentMonth+1>S.config.maxDate.getMonth():S.currentYear>S.config.maxDate.getFullYear())}function be(t){return S.selectedDates.map(function(e){return S.formatDate(e,t)}).filter(function(e,t,r){return S.config.mode!=="range"||S.config.enableTime||r.indexOf(e)===t}).join(S.config.mode!=="range"?S.config.conjunction:S.l10n.rangeSeparator)}function we(e){if(e===void 0){e=true}if(S.mobileInput!==undefined&&S.mobileFormatStr){S.mobileInput.value=S.latestSelectedDateObj!==undefined?S.formatDate(S.latestSelectedDateObj,S.mobileFormatStr):""}S.input.value=be(S.config.dateFormat);if(S.altInput!==undefined){S.altInput.value=be(S.config.altFormat)}if(e!==false)ve("onValueUpdate")}function Ce(e){var t=S.prevMonthNav.contains(e.target);var r=S.nextMonthNav.contains(e.target);if(t||r){B(t?-1:1)}else if(S.yearElements.indexOf(e.target)>=0){e.target.select()}else if(e.target.classList.contains("arrowUp")){S.changeYear(S.currentYear+1)}else if(e.target.classList.contains("arrowDown")){S.changeYear(S.currentYear-1)}}function Se(e){e.preventDefault();var t=e.type==="keydown",r=e.target;if(S.amPM!==undefined&&e.target===S.amPM){S.amPM.textContent=S.l10n.amPM[De(S.amPM.textContent===S.l10n.amPM[0])]}var n=parseFloat(r.getAttribute("min")),i=parseFloat(r.getAttribute("max")),a=parseFloat(r.getAttribute("step")),o=parseInt(r.value,10),s=e.delta||(t?e.which===38?1:-1:0);var l=o+a*s;if(typeof r.value!=="undefined"&&r.value.length===2){var u=r===S.hourElement,f=r===S.minuteElement;if(l<n){l=i+l+De(!u)+(De(u)&&De(!S.amPM));if(f)w(undefined,-1,S.hourElement)}else if(l>i){l=r===S.hourElement?l-i-De(!S.amPM):n;if(f)w(undefined,1,S.hourElement)}if(S.amPM&&u&&(a===1?l+o===23:Math.abs(l-o)>a)){S.amPM.textContent=S.l10n.amPM[De(S.amPM.textContent===S.l10n.amPM[0])]}r.value=xe(l)}}e();return S}function r(e,t){var r=Array.prototype.slice.call(e).filter(function(e){return e instanceof HTMLElement});var n=[];for(var i=0;i<r.length;i++){var a=r[i];try{if(a.getAttribute("data-fp-omit")!==null)continue;if(a._flatpickr!==undefined){a._flatpickr.destroy();a._flatpickr=undefined}a._flatpickr=o(a,t||{});n.push(a._flatpickr)}catch(e){console.error(e)}}return n.length===1?n[0]:n}if(typeof HTMLElement!=="undefined"&&typeof HTMLCollection!=="undefined"&&typeof NodeList!=="undefined"){HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return r(this,e)};HTMLElement.prototype.flatpickr=function(e){return r([this],e)}}var ze=function(e,t){if(typeof e==="string"){return r(window.document.querySelectorAll(e),t)}else if(e instanceof Node){return r([e],t)}else{return r(e,t)}};ze.defaultConfig={};ze.l10ns={en:Ee({},_e),default:Ee({},_e)};ze.localize=function(e){ze.l10ns["default"]=Ee({},ze.l10ns["default"],e)};ze.setDefaults=function(e){ze.defaultConfig=Ee({},ze.defaultConfig,e)};ze.parseDate=$e({});ze.formatDate=He({});ze.compareDates=We;if(typeof jQuery!=="undefined"&&typeof jQuery.fn!=="undefined"){jQuery.fn.flatpickr=function(e){return r(this,e)}}Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof e==="string"?parseInt(e,10):e))};if(typeof window!=="undefined"){window.flatpickr=ze}return ze});(function(m){if(typeof window==="undefined")return;var y=0,b=false,a=false,e="message",D=e.length,R="[iFrameSizer]",I=R.length,O=null,n=window.requestAnimationFrame,w={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},A={},r=null,C={autoResize:true,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:true,inPageLinks:false,enablePublicMethods:true,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:false,maxHeight:Infinity,maxWidth:Infinity,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:false,sizeHeight:true,sizeWidth:false,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return true},onClosed:function(){},onInit:function(){},onMessage:function(){F("onMessage function not defined")},onResized:function(){},onScroll:function(){return true}};function S(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function N(e,t,r){e.addEventListener(t,r,false)}function M(e,t,r){e.removeEventListener(t,r,false)}function t(){var e=["moz","webkit","o","ms"];var t;for(t=0;t<e.length&&!n;t+=1){n=window[e[t]+"RequestAnimationFrame"]}if(!n){L("setup","RequestAnimationFrame not supported")}}function i(e){var t="Host page: "+e;if(window.top!==window.self){if(window.parentIFrame&&window.parentIFrame.getId){t=window.parentIFrame.getId()+": "+e}else{t="Nested host page: "+e}}return t}function o(e){return R+"["+i(e)+"]"}function s(e){return A[e]?A[e].log:b}function L(e,t){l("log",e,t,s(e))}function P(e,t){l("info",e,t,s(e))}function F(e,t){l("warn",e,t,true)}function l(e,t,r,n){if(true===n&&"object"===typeof window.console){console[e](o(t),r)}}function u(t){function e(){function e(){V(_);W(x);w("onResized",_)}n("Height");n("Width");z(e,_,"init")}function r(){var e=T.substr(I).split(":");var t=e[1]?parseInt(e[1],10):0;var r=A[e[0]]&&A[e[0]].iframe;var n=getComputedStyle(r);return{iframe:r,id:e[0],height:t+i(n)+a(n),width:e[2],type:e[3]}}function i(e){if(e.boxSizing!=="border-box"){return 0}var t=e.paddingTop?parseInt(e.paddingTop,10):0;var r=e.paddingBottom?parseInt(e.paddingBottom,10):0;return t+r}function a(e){if(e.boxSizing!=="border-box"){return 0}var t=e.borderTopWidth?parseInt(e.borderTopWidth,10):0;var r=e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0;return t+r}function n(e){var t=Number(A[x]["max"+e]),r=Number(A[x]["min"+e]),n=e.toLowerCase(),i=Number(_[n]);L(x,"Checking "+n+" is in range "+r+"-"+t);if(i<r){i=r;L(x,"Set "+n+" to min value")}if(i>t){i=t;L(x,"Set "+n+" to max value")}_[n]=""+i}function o(){function e(){function e(){var e=0,t=false;L(x,"Checking connection is from allowed list of origins: "+n);for(;e<n.length;e++){if(n[e]===r){t=true;break}}return t}function t(){var e=A[x]&&A[x].remoteHost;L(x,"Checking connection is from: "+e);return r===e}return n.constructor===Array?e():t()}var r=t.origin,n=A[x]&&A[x].checkOrigin;if(n&&""+r!=="null"&&!e()){throw new Error("Unexpected message received from: "+r+" for "+_.iframe.id+". Message was: "+t.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.")}return true}function s(){return R===(""+T).substr(0,I)&&T.substr(I).split(":")[0]in A}function l(){var e=_.type in{true:1,false:1,undefined:1};if(e){L(x,"Ignoring init message from meta parent page")}return e}function u(e){return T.substr(T.indexOf(":")+D+e)}function f(e){L(x,"onMessage passed: {iframe: "+_.iframe.id+", message: "+e+"}");w("onMessage",{iframe:_.iframe,message:JSON.parse(e)});L(x,"--")}function c(){var e=document.body.getBoundingClientRect(),t=_.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(t.top-e.top,10),offsetLeft:parseInt(t.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})}function d(e,t){function r(){q("Send Page Info","pageInfo:"+c(),e,t)}G(r,32,t)}function h(){function e(t,r){function n(){if(A[a]){d(A[a].iframe,a)}else{i()}}["scroll","resize"].forEach(function(e){L(a,t+e+" listener for sendPageInfo");r(window,e,n)})}function i(){e("Remove ",M)}function t(){e("Add ",N)}var a=x;t();if(A[a]){A[a].stopPageInfo=i}}function v(){if(A[x]&&A[x].stopPageInfo){A[x].stopPageInfo();delete A[x].stopPageInfo}}function p(){var e=true;if(null===_.iframe){F(x,"IFrame ("+_.id+") not found");e=false}return e}function g(e){var t=e.getBoundingClientRect();$(x);return{x:Math.floor(Number(t.left)+Number(O.x)),y:Math.floor(Number(t.top)+Number(O.y))}}function m(e){function t(){O=a;y();L(x,"--")}function r(){return{x:Number(_.width)+i.x,y:Number(_.height)+i.y}}function n(){if(window.parentIFrame){window.parentIFrame["scrollTo"+(e?"Offset":"")](a.x,a.y)}else{F(x,"Unable to scroll to requested position, window.parentIFrame not found")}}var i=e?g(_.iframe):{x:0,y:0},a=r();L(x,"Reposition requested from iFrame (offset x:"+i.x+" y:"+i.y+")");if(window.top!==window.self){n()}else{t()}}function y(){if(false!==w("onScroll",O)){W(x)}else{U()}}function b(e){function t(){var e=g(a);L(x,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y);O={x:e.x,y:e.y};y();L(x,"--")}function r(){if(window.parentIFrame){window.parentIFrame.moveToAnchor(n)}else{L(x,"In page link #"+n+" not found and window.parentIFrame not found")}}var n=e.split("#")[1]||"",i=decodeURIComponent(n),a=document.getElementById(i)||document.getElementsByName(i)[0];if(a){t()}else if(window.top!==window.self){r()}else{L(x,"In page link #"+n+" not found")}}function w(e,t){return B(x,e,t)}function C(){if(A[x]&&A[x].firstRun)k();switch(_.type){case"close":H(_.iframe);break;case"message":f(u(6));break;case"autoResize":A[x].autoResize=JSON.parse(u(9));break;case"scrollTo":m(false);break;case"scrollToOffset":m(true);break;case"pageInfo":d(A[x]&&A[x].iframe,x);h();break;case"pageInfoStop":v();break;case"inPageLink":b(u(9));break;case"reset":j(_);break;case"init":e();w("onInit",_.iframe);break;default:e()}}function S(e){var t=true;if(!A[e]){t=false;F(_.type+" No settings for "+e+". Message was: "+T)}return t}function E(){for(var e in A){q("iFrame requested init",Y(e),A[e].iframe,e)}}function k(){if(A[x]){A[x].firstRun=false}}var T=t.data,_={},x=null;if("[iFrameResizerChild]Ready"===T){E()}else if(s()){_=r();x=_.id;if(A[x]){A[x].loaded=true}if(!l()&&S(x)){L(x,"Received: "+T);if(p()&&o()){C()}}}else{P(x,"Ignored: "+T)}}function B(e,t,r){var n=null,i=null;if(A[e]){n=A[e][t];if("function"===typeof n){i=n(r)}else{throw new TypeError(t+" on iFrame["+e+"] is not a function")}}return i}function E(e){var t=e.id;delete A[t]}function H(e){var t=e.id;if(B(t,"onClose",t)===false){L(t,"Close iframe cancelled by onClose event");return}L(t,"Removing iFrame: "+t);try{if(e.parentNode){e.parentNode.removeChild(e)}}catch(e){F(e)}B(t,"onClosed",t);L(t,"--");E(e)}function $(e){if(null===O){O={x:window.pageXOffset!==m?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==m?window.pageYOffset:document.documentElement.scrollTop};L(e,"Get page position: "+O.x+","+O.y)}}function W(e){if(null!==O){window.scrollTo(O.x,O.y);L(e,"Set page position: "+O.x+","+O.y);U()}}function U(){O=null}function j(e){function t(){V(e);q("reset","reset",e.iframe,e.id)}L(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame"));$(e.id);z(t,e,"reset")}function V(t){function r(e){if(!t.id){L("undefined","messageData id not set");return}t.iframe.style[e]=t[e]+"px";L(t.id,"IFrame ("+i+") "+e+" set to "+t[e]+"px")}function n(e){if(!a&&"0"===t[e]){a=true;L(i,"Hidden iFrame detected, creating visibility listener");h()}}function e(e){r(e);n(e)}var i=t.iframe.id;if(A[i]){if(A[i].sizeHeight){e("height")}if(A[i].sizeWidth){e("width")}}}function z(e,t,r){if(r!==t.type&&n&&!window.jasmine){L(t.id,"Requesting animation frame");n(e)}else{e()}}function q(t,r,n,i,a){function e(){var e=A[i]&&A[i].targetOrigin;L(i,"["+t+"] Sending msg to iframe["+i+"] ("+r+") targetOrigin: "+e);n.contentWindow.postMessage(R+r,e)}function o(){F(i,"["+t+"] IFrame("+i+") not found")}function s(){if(n&&"contentWindow"in n&&null!==n.contentWindow){e()}else{o()}}function l(){function e(){if(A[i]&&!A[i].loaded&&!u){u=true;F(i,"IFrame has not responded within "+A[i].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning.")}}if(!!a&&A[i]&&!!A[i].warningTimeout){A[i].msgTimeout=setTimeout(e,A[i].warningTimeout)}}var u=false;i=i||n.id;if(A[i]){s();l()}}function Y(e){return e+":"+A[e].bodyMarginV1+":"+A[e].sizeWidth+":"+A[e].log+":"+A[e].interval+":"+A[e].enablePublicMethods+":"+A[e].autoResize+":"+A[e].bodyMargin+":"+A[e].heightCalculationMethod+":"+A[e].bodyBackground+":"+A[e].bodyPadding+":"+A[e].tolerance+":"+A[e].inPageLinks+":"+A[e].resizeFrom+":"+A[e].widthCalculationMethod}function f(i,t){function e(){function e(e){if(Infinity!==A[g][e]&&0!==A[g][e]){i.style[e]=A[g][e]+"px";L(g,"Set "+e+" = "+A[g][e]+"px")}}function t(e){if(A[g]["min"+e]>A[g]["max"+e]){throw new Error("Value for min"+e+" can not be greater than max"+e)}}t("Height");t("Width");e("maxHeight");e("minHeight");e("maxWidth");e("minWidth")}function r(){var e=t&&t.id||C.id+y++;if(null!==document.getElementById(e)){e+=y++}return e}function n(e){if(""===e){i.id=e=r();b=(t||{}).log;L(e,"Added missing iframe ID: "+e+" ("+i.src+")")}return e}function a(){L(g,"IFrame scrolling "+(A[g]&&A[g].scrolling?"enabled":"disabled")+" for "+g);i.style.overflow=false===(A[g]&&A[g].scrolling)?"hidden":"auto";switch(A[g]&&A[g].scrolling){case"omit":break;case true:i.scrolling="yes";break;case false:i.scrolling="no";break;default:i.scrolling=A[g]?A[g].scrolling:"no"}}function o(){if("number"===typeof(A[g]&&A[g].bodyMargin)||"0"===(A[g]&&A[g].bodyMargin)){A[g].bodyMarginV1=A[g].bodyMargin;A[g].bodyMargin=""+A[g].bodyMargin+"px"}}function s(){var e=A[g]&&A[g].firstRun,t=A[g]&&A[g].heightCalculationMethod in w;if(!e&&t){j({iframe:i,height:0,width:0,type:"init"})}}function l(){if(A[g]){A[g].iframe.iFrameResizer={close:H.bind(null,A[g].iframe),removeListeners:E.bind(null,A[g].iframe),resize:q.bind(null,"Window resize","resize",A[g].iframe),moveToAnchor:function(e){q("Move to anchor","moveToAnchor:"+e,A[g].iframe,g)},sendMessage:function(e){e=JSON.stringify(e);q("Send Message","message:"+e,A[g].iframe,g)}}}}function u(e){function t(){q("iFrame.onload",e,i,m,true);s()}function r(e){if(!i.parentNode){return}var t=new e(function(e){e.forEach(function(e){var t=Array.prototype.slice.call(e.removedNodes);t.forEach(function(e){if(e===i){H(i)}})})});t.observe(i.parentNode,{childList:true})}var n=S();if(n){r(n)}N(i,"load",t);q("init",e,i,m,true)}function f(e){if("object"!==typeof e){throw new TypeError("Options is not an object")}}function c(e){for(var t in C){if(Object.prototype.hasOwnProperty.call(C,t)){A[g][t]=Object.prototype.hasOwnProperty.call(e,t)?e[t]:C[t]}}}function d(e){return""===e||"file://"===e?"*":e}function h(e){var t=e.split("Callback");if(t.length===2){var r="on"+t[0].charAt(0).toUpperCase()+t[0].slice(1);this[r]=this[e];delete this[e];F(g,"Deprecated: '"+e+"' has been renamed '"+r+"'. The old method will be removed in the next major version.")}}function v(e){e=e||{};A[g]={firstRun:true,iframe:i,remoteHost:i.src&&i.src.split("/").slice(0,3).join("/")};f(e);Object.keys(e).forEach(h,e);c(e);if(A[g]){A[g].targetOrigin=true===A[g].checkOrigin?d(A[g].remoteHost):"*"}}function p(){return g in A&&"iFrameResizer"in i}var g=n(i.id);if(!p()){v(t);a();e();o();u(Y(g));l()}else{F(g,"Ignored iFrame, already setup.")}}function c(e,t){if(null===r){r=setTimeout(function(){r=null;e()},t)}}var d={};function G(e,t,r){if(!d[r]){d[r]=setTimeout(function(){d[r]=null;e()},t)}}function h(){function t(){function t(t){function e(e){return"0px"===(A[t]&&A[t].iframe.style[e])}function r(e){return null!==e.offsetParent}if(A[t]&&r(A[t].iframe)&&(e("height")||e("width"))){q("Visibility change","resize",A[t].iframe,t)}}Object.keys(A).forEach(function(e){t(e)})}function n(e){L("window","Mutation observed: "+e[0].target+" "+e[0].type);c(t,16)}function e(){var e=document.querySelector("body"),t={attributes:true,attributeOldValue:false,characterData:true,characterDataOldValue:false,childList:true,subtree:true},r=new i(n);r.observe(e,t)}var i=S();if(i){e()}}function v(e){function t(){g("Window "+e,"resize")}L("window","Trigger event: "+e);c(t,16)}function p(){function e(){g("Tab Visable","resize")}if("hidden"!==document.visibilityState){L("document","Trigger event: Visiblity change");c(e,16)}}function g(t,r){function n(e){return A[e]&&"parent"===A[e].resizeFrom&&A[e].autoResize&&!A[e].firstRun}Object.keys(A).forEach(function(e){if(n(e)){q(t,r,A[e].iframe,e)}})}function k(){N(window,"message",u);N(window,"resize",function(){v("resize")});N(document,"visibilitychange",p);N(document,"-webkit-visibilitychange",p)}function T(){function n(e,t){function r(){if(!t.tagName){throw new TypeError("Object is not a valid DOM element")}else if("IFRAME"!==t.tagName.toUpperCase()){throw new TypeError("Expected <IFRAME> tag, found <"+t.tagName+">")}}if(t){r();f(t,e);a.push(t)}}function i(e){if(e&&e.enablePublicMethods){F("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}}var a;t();k();return function e(t,r){a=[];i(t);switch(typeof r){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(r||"iframe"),n.bind(m,t));break;case"object":n(t,r);break;default:throw new TypeError("Unexpected data type ("+typeof r+")")}return a}}function _(e){if(!e.fn){P("","Unable to bind to jQuery, it is not fully loaded.")}else if(!e.fn.iFrameResize){e.fn.iFrameResize=function e(r){function t(e,t){f(t,r)}return this.filter("iframe").each(t).end()}}}if(window.jQuery){_(window.jQuery)}if(typeof define==="function"&&define.amd){define([],T)}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=T()}window.iFrameResize=window.iFrameResize||T()})();(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.ISpin=t()})(this,function(){"use strict";function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function e(e,t,r){if(t)n(e.prototype,t);if(r)n(e,r);return e}function i(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function a(){a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};return a.apply(this,arguments)}function o(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};var n=Object.keys(r);if(typeof Object.getOwnPropertySymbols==="function"){n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))}n.forEach(function(e){i(t,e,r[e])})}return t}function t(e){return s(e)||l(e)||u()}function s(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function l(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var f=function(){function n(e,t){r(this,n);this.el=e;this.options={};this._onKeyDown=this._onKeyDown.bind(this);this._onMouseDown=this._onMouseDown.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onMouseLeave=this._onMouseLeave.bind(this);this._onWheel=this._onWheel.bind(this);this.build();this.update(t)}e(n,[{key:"build",value:function e(){var r=this;this._wrapper=document.createElement("div");if(this.el.parentNode)this.el.parentNode.replaceChild(this._wrapper,this.el);this._wrapper.appendChild(this.el);this._buttons={inc:document.createElement("button"),dec:document.createElement("button")};Object.keys(this._buttons).forEach(function(e){var t=r._buttons[e];r._wrapper.appendChild(t);t.setAttribute("type","button");t.addEventListener("mousedown",r._onMouseDown);t.addEventListener("mouseup",r._onMouseUp);t.addEventListener("mouseleave",r._onMouseLeave)});this.el.addEventListener("keydown",this._onKeyDown);this.el.addEventListener("wheel",this._onWheel)}},{key:"update",value:function e(t){var r=this;t=o({},n.DEFAULTS,this.options,t);if(t.wrapperClass!==this.options.wrapperClass){if(this.options.wrapperClass)this._wrapper.classList.remove(this.options.wrapperClass);if(t.wrapperClass)this._wrapper.classList.add(t.wrapperClass)}if(t.buttonsClass!==this.options.buttonsClass){if(this.options.buttonsClass){Object.keys(this._buttons).forEach(function(e){r._buttons[e].classList.remove(r.options.buttonsClass);r._buttons[e].classList.remove(r.options.buttonsClass+"-"+e)})}if(t.buttonsClass){Object.keys(this._buttons).forEach(function(e){r._buttons[e].classList.add(t.buttonsClass);r._buttons[e].classList.add(t.buttonsClass+"-"+e)})}}this.disabled=t.disabled;a(this.options,t)}},{key:"destroy",value:function e(){if(this._wrapper.parentNode)this._wrapper.parentNode.replaceChild(this.el,this._wrapper);delete this.el;delete this._wrapper;delete this._buttons}},{key:"_onKeyDown",value:function e(t){switch(t.keyCode){case 38:t.preventDefault();return this.spin(this.options.step);case 40:t.preventDefault();return this.spin(-this.options.step);case 33:t.preventDefault();return this.spin(this.options.pageStep);case 34:t.preventDefault();return this.spin(-this.options.pageStep)}}},{key:"_onMouseDown",value:function e(t){t.preventDefault();var r=t.currentTarget===this._buttons.inc?1:-1;this.spin(r*this.options.step);this.el.focus();this._startSpinning(r)}},{key:"_onMouseUp",value:function e(t){this._stopSpinning()}},{key:"_onMouseLeave",value:function e(t){this._stopSpinning()}},{key:"_startSpinning",value:function e(t){var r=this;this._stopSpinning();this._spinTimer=setInterval(function(){return r.spin(t*r.options.step)},this.options.repeatInterval)}},{key:"_stopSpinning",value:function e(){clearInterval(this._spinTimer)}},{key:"_onWheel",value:function e(t){if(document.activeElement!==this.el)return;t.preventDefault();var r=t.deltaY>0?-1:1;this.spin(r*this.options.step)}},{key:"adjustValue",value:function e(t){t=Number(t.toFixed(this.precision));if(this.options.max!=null&&t>this.options.max)t=this.options.max;if(this.options.min!=null&&t<this.options.min)t=this.options.min;return t}},{key:"wrapValue",value:function e(t){if(this.options.wrapOverflow&&this.options.max!=null&&this.options.min!=null){if(t<this.options.min)t=this.options.max;else if(t>this.options.max)t=this.options.min}return t}},{key:"spin",value:function e(t){this.value=this.adjustValue(this.wrapValue(this.value+t))}},{key:"value",get:function e(){return this.options.parse(this.el.value)||0},set:function e(t){var r=this.options.format(this.options.parse(String(t)));this.el.value=r;if(this.options.onChange)this.options.onChange(r)}},{key:"disabled",get:function e(){return this._buttons.inc.disabled},set:function e(t){if(this.disabled===t)return;this._buttons.inc.disabled=this._buttons.dec.disabled=t}},{key:"precision",get:function e(){return Math.max.apply(Math,t([this.options.step,this.options.min].filter(function(e){return e!=null}).map(c)))}}]);return n}();f.DEFAULTS={wrapperClass:"ispin-wrapper",buttonsClass:"ispin-button",step:1,pageStep:10,disabled:false,repeatInterval:200,wrapOverflow:false,parse:Number,format:String};function c(e){return(String(e).split(".")[1]||"").length}return f});(function(e,r){"use strict";var n;if(typeof exports==="object"){try{n=require("moment")}catch(e){}module.exports=r(n)}else if(typeof define==="function"&&define.amd){define(function(e){var t="moment";try{n=e(t)}catch(e){}return r(n)})}else{e.Pikaday=r(e.moment)}})(this,function(a){"use strict";var o=typeof a==="function",s=!!window.addEventListener,d=window.document,u=window.setTimeout,l=function(e,t,r,n){if(s){e.addEventListener(t,r,!!n)}else{e.attachEvent("on"+t,r)}},t=function(e,t,r,n){if(s){e.removeEventListener(t,r,!!n)}else{e.detachEvent("on"+t,r)}},r=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},f=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},h=function(e,t){if(!f(e,t)){e.className=e.className===""?t:e.className+" "+t}},v=function(e,t){e.className=r((" "+e.className+" ").replace(" "+t+" "," "))},m=function(e){return/Array/.test(Object.prototype.toString.call(e))},A=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},N=function(e){var t=e.getDay();return t===0||t===6},n=function(e){return e%4===0&&e%100!==0||e%400===0},M=function(e,t){return[31,n(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},L=function(e){if(A(e))e.setHours(0,0,0,0)},P=function(e,t){return e.getTime()===t.getTime()},c=function(e,t,r){var n,i;for(n in t){i=e[n]!==undefined;if(i&&typeof t[n]==="object"&&t[n]!==null&&t[n].nodeName===undefined){if(A(t[n])){if(r){e[n]=new Date(t[n].getTime())}}else if(m(t[n])){if(r){e[n]=t[n].slice(0)}}else{e[n]=c({},t[n],r)}}else if(r||!i){e[n]=t[n]}}return e},i=function(e,t,r){var n;if(d.createEvent){n=d.createEvent("HTMLEvents");n.initEvent(t,true,false);n=c(n,r);e.dispatchEvent(n)}else if(d.createEventObject){n=d.createEventObject();n=c(n,r);e.fireEvent("on"+t,n)}},p=function(e){if(e.month<0){e.year-=Math.ceil(Math.abs(e.month)/12);e.month+=12}if(e.month>11){e.year+=Math.floor(Math.abs(e.month)/12);e.month-=12}return e},g={field:null,bound:undefined,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:true,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:false,firstDay:0,formatStrict:false,minDate:null,maxDate:null,yearRange:10,showWeekNumber:false,pickWholeWeek:false,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:false,yearSuffix:"",showMonthAfterYear:false,showDaysInNextAndPreviousMonths:false,enableSelectionDaysInNextAndPreviousMonths:false,numberOfMonths:1,mainCalendar:"left",container:undefined,blurFieldOnSelect:true,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:true},y=function(e,t,r){t+=e.firstDay;while(t>=7){t-=7}return r?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},F=function(e){var t=[];var r="false";if(e.isEmpty){if(e.showDaysInNextAndPreviousMonths){t.push("is-outside-current-month");if(!e.enableSelectionDaysInNextAndPreviousMonths){t.push("is-selection-disabled")}}else{return'<td class="is-empty"></td>'}}if(e.isDisabled){t.push("is-disabled")}if(e.isToday){t.push("is-today")}if(e.isSelected){t.push("is-selected");r="true"}if(e.hasEvent){t.push("has-event")}if(e.isInRange){t.push("is-inrange")}if(e.isStartRange){t.push("is-startrange")}if(e.isEndRange){t.push("is-endrange")}return'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'">'+'<button class="pika-button pika-day" type="button" '+'data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button>"+"</td>"},b=function(e){e.setHours(0,0,0,0);var t=e.getDate(),r=e.getDay(),n=4,i=n-1,a=7,o=function(e){return(e+a-1)%a};e.setDate(t+i-o(r));var s=new Date(e.getFullYear(),0,n),l=24*60*60*1e3,u=(e.getTime()-s.getTime())/l,f=1+Math.round((u-i+o(s.getDay()))/a);return f},B=function(e,t,r){var n=new Date(r,t,e),i=o?a(n).isoWeek():b(n);return'<td class="pika-week">'+i+"</td>"},H=function(e,t,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},w=function(e){return"<tbody>"+e.join("")+"</tbody>"},C=function(e){var t,r=[];if(e.showWeekNumber){r.push("<th></th>")}for(t=0;t<7;t++){r.push('<th scope="col"><abbr title="'+y(e,t)+'">'+y(e,t,true)+"</abbr></th>")}return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"},S=function(e,t,r,n,i,a){var o,s,l,u=e._o,f=r===u.minYear,c=r===u.maxYear,d='<div id="'+a+'" class="pika-title" role="heading" aria-live="assertive">',h,v,p=true,g=true;for(l=[],o=0;o<12;o++){l.push('<option value="'+(r===i?o-t:12+o-t)+'"'+(o===n?' selected="selected"':"")+(f&&o<u.minMonth||c&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>")}h='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>";if(m(u.yearRange)){o=u.yearRange[0];s=u.yearRange[1]+1}else{o=r-u.yearRange;s=1+r+u.yearRange}for(l=[];o<s&&o<=u.maxYear;o++){if(o>=u.minYear){l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>")}}v='<div class="pika-label">'+r+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>";if(u.showMonthAfterYear){d+=v+h}else{d+=h+v}if(f&&(n===0||u.minMonth>=n)){p=false}if(c&&(n===11||u.maxMonth<=n)){g=false}if(t===0){d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"}if(t===e._o.numberOfMonths-1){d+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"}return d+="</div>"},$=function(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+C(e)+w(t)+"</table>"},e=function(e){var n=this,i=n.config(e);n._onMouseDown=function(e){if(!n._v){return}e=e||window.event;var t=e.target||e.srcElement;if(!t){return}if(!f(t,"is-disabled")){if(f(t,"pika-button")&&!f(t,"is-empty")&&!f(t.parentNode,"is-disabled")){n.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day")));if(i.bound){u(function(){n.hide();if(i.blurFieldOnSelect&&i.field){i.field.blur()}},100)}}else if(f(t,"pika-prev")){n.prevMonth()}else if(f(t,"pika-next")){n.nextMonth()}}if(!f(t,"pika-select")){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false;return false}}else{n._c=true}};n._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;if(!t){return}if(f(t,"pika-select-month")){n.gotoMonth(t.value)}else if(f(t,"pika-select-year")){n.gotoYear(t.value)}};n._onKeyChange=function(e){e=e||window.event;if(n.isVisible()){switch(e.keyCode){case 13:case 27:if(i.field){i.field.blur()}break;case 37:n.adjustDate("subtract",1);break;case 38:n.adjustDate("subtract",7);break;case 39:n.adjustDate("add",1);break;case 40:n.adjustDate("add",7);break;case 8:case 46:n.setDate(null);break}}};n._parseFieldValue=function(){if(i.parse){return i.parse(i.field.value,i.format)}else if(o){var e=a(i.field.value,i.format,i.formatStrict);return e&&e.isValid()?e.toDate():null}else{return new Date(Date.parse(i.field.value))}};n._onInputChange=function(e){var t;if(e.firedBy===n){return}t=n._parseFieldValue();if(A(t)){n.setDate(t)}if(!n._v){n.show()}};n._onInputFocus=function(){n.show()};n._onInputClick=function(){n.show()};n._onInputBlur=function(){var e=d.activeElement;do{if(f(e,"pika-single")){return}}while(e=e.parentNode);if(!n._c){n._b=u(function(){n.hide()},50)}n._c=false};n._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,r=t;if(!t){return}if(!s&&f(t,"pika-select")){if(!t.onchange){t.setAttribute("onchange","return;");l(t,"change",n._onChange)}}do{if(f(r,"pika-single")||r===i.trigger){return}}while(r=r.parentNode);if(n._v&&t!==i.trigger&&r!==i.trigger){n.hide()}};n.el=d.createElement("div");n.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:"");l(n.el,"mousedown",n._onMouseDown,true);l(n.el,"touchend",n._onMouseDown,true);l(n.el,"change",n._onChange);if(i.keyboardInput){l(d,"keydown",n._onKeyChange)}if(i.field){if(i.container){i.container.appendChild(n.el)}else if(i.bound){d.body.appendChild(n.el)}else{i.field.parentNode.insertBefore(n.el,i.field.nextSibling)}l(i.field,"change",n._onInputChange);if(!i.defaultDate){i.defaultDate=n._parseFieldValue();i.setDefaultDate=true}}var t=i.defaultDate;if(A(t)){if(i.setDefaultDate){n.setDate(t,true)}else{n.gotoDate(t)}}else{n.gotoDate(new Date)}if(i.bound){this.hide();n.el.className+=" is-bound";l(i.trigger,"click",n._onInputClick);l(i.trigger,"focus",n._onInputFocus);l(i.trigger,"blur",n._onInputBlur)}else{this.show()}};e.prototype={config:function(e){if(!this._o){this._o=c({},g,true)}var t=c(this._o,e,true);t.isRTL=!!t.isRTL;t.field=t.field&&t.field.nodeName?t.field:null;t.theme=typeof t.theme==="string"&&t.theme?t.theme:null;t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field);t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field;t.disableWeekends=!!t.disableWeekends;t.disableDayFn=typeof t.disableDayFn==="function"?t.disableDayFn:null;var r=parseInt(t.numberOfMonths,10)||1;t.numberOfMonths=r>4?4:r;if(!A(t.minDate)){t.minDate=false}if(!A(t.maxDate)){t.maxDate=false}if(t.minDate&&t.maxDate&&t.maxDate<t.minDate){t.maxDate=t.minDate=false}if(t.minDate){this.setMinDate(t.minDate)}if(t.maxDate){this.setMaxDate(t.maxDate)}if(m(t.yearRange)){var n=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||n;t.yearRange[1]=parseInt(t.yearRange[1],10)||n}else{t.yearRange=Math.abs(parseInt(t.yearRange,10))||g.yearRange;if(t.yearRange>100){t.yearRange=100}}return t},toString:function(e){e=e||this._o.format;if(!A(this._d)){return""}if(this._o.toString){return this._o.toString(this._d,e)}if(o){return a(this._d).format(e)}return this._d.toDateString()},getMoment:function(){return o?a(this._d):null},setMoment:function(e,t){if(o&&a.isMoment(e)){this.setDate(e.toDate(),t)}},getDate:function(){return A(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e){this._d=null;if(this._o.field){this._o.field.value="";i(this._o.field,"change",{firedBy:this})}return this.draw()}if(typeof e==="string"){e=new Date(Date.parse(e))}if(!A(e)){return}var r=this._o.minDate,n=this._o.maxDate;if(A(r)&&e<r){e=r}else if(A(n)&&e>n){e=n}this._d=new Date(e.getTime());L(this._d);this.gotoDate(this._d);if(this._o.field){this._o.field.value=this.toString();i(this._o.field,"change",{firedBy:this})}if(!t&&typeof this._o.onSelect==="function"){this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(e){var t=true;if(!A(e)){return}if(this.calendars){var r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();n.setMonth(n.getMonth()+1);n.setDate(n.getDate()-1);t=i<r.getTime()||n.getTime()<i}if(t){this.calendars=[{month:e.getMonth(),year:e.getFullYear()}];if(this._o.mainCalendar==="right"){this.calendars[0].month+=1-this._o.numberOfMonths}}this.adjustCalendars()},adjustDate:function(e,t){var r=this.getDate()||new Date;var n=parseInt(t)*24*60*60*1e3;var i;if(e==="add"){i=new Date(r.valueOf()+n)}else if(e==="subtract"){i=new Date(r.valueOf()-n)}this.setDate(i)},adjustCalendars:function(){this.calendars[0]=p(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++){this.calendars[e]=p({month:this.calendars[0].month+e,year:this.calendars[0].year})}this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){if(!isNaN(e)){this.calendars[0].month=parseInt(e,10);this.adjustCalendars()}},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(e){if(!isNaN(e)){this.calendars[0].year=parseInt(e,10);this.adjustCalendars()}},setMinDate:function(e){if(e instanceof Date){L(e);this._o.minDate=e;this._o.minYear=e.getFullYear();this._o.minMonth=e.getMonth()}else{this._o.minDate=g.minDate;this._o.minYear=g.minYear;this._o.minMonth=g.minMonth;this._o.startRange=g.startRange}this.draw()},setMaxDate:function(e){if(e instanceof Date){L(e);this._o.maxDate=e;this._o.maxYear=e.getFullYear();this._o.maxMonth=e.getMonth()}else{this._o.maxDate=g.maxDate;this._o.maxYear=g.maxYear;this._o.maxMonth=g.maxMonth;this._o.endRange=g.endRange}this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e){return}var t=this._o,r=t.minYear,n=t.maxYear,i=t.minMonth,a=t.maxMonth,o="",s;if(this._y<=r){this._y=r;if(!isNaN(i)&&this._m<i){this._m=i}}if(this._y>=n){this._y=n;if(!isNaN(a)&&this._m>a){this._m=a}}for(var l=0;l<t.numberOfMonths;l++){s="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);o+='<div class="pika-lendar">'+S(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,s)+this.render(this.calendars[l].year,this.calendars[l].month,s)+"</div>"}this.el.innerHTML=o;if(t.bound){if(t.field.type!=="hidden"){u(function(){t.trigger.focus()},1)}}if(typeof this._o.onDraw==="function"){this._o.onDraw(this)}if(t.bound){t.field.setAttribute("aria-label",t.ariaLabel)}},adjustPosition:function(){var e,t,r,n,i,a,o,s,l,u,f,c;if(this._o.container)return;this.el.style.position="absolute";e=this._o.trigger;t=e;r=this.el.offsetWidth;n=this.el.offsetHeight;i=window.innerWidth||d.documentElement.clientWidth;a=window.innerHeight||d.documentElement.clientHeight;o=window.pageYOffset||d.body.scrollTop||d.documentElement.scrollTop;f=true;c=true;if(typeof e.getBoundingClientRect==="function"){u=e.getBoundingClientRect();s=u.left+window.pageXOffset;l=u.bottom+window.pageYOffset}else{s=t.offsetLeft;l=t.offsetTop+t.offsetHeight;while(t=t.offsetParent){s+=t.offsetLeft;l+=t.offsetTop}}if(this._o.reposition&&s+r>i||this._o.position.indexOf("right")>-1&&s-r+e.offsetWidth>0){s=s-r+e.offsetWidth;f=false}if(this._o.reposition&&l+n>a+o||this._o.position.indexOf("top")>-1&&l-n-e.offsetHeight>0){l=l-n-e.offsetHeight;c=false}this.el.style.left=s+"px";this.el.style.top=l+"px";h(this.el,f?"left-aligned":"right-aligned");h(this.el,c?"bottom-aligned":"top-aligned");v(this.el,!f?"left-aligned":"right-aligned");v(this.el,!c?"bottom-aligned":"top-aligned")},render:function(e,t,r){var n=this._o,i=new Date,a=M(e,t),o=new Date(e,t,1).getDay(),s=[],l=[];L(i);if(n.firstDay>0){o-=n.firstDay;if(o<0){o+=7}}var u=t===0?11:t-1,f=t===11?0:t+1,c=t===0?e-1:e,d=t===11?e+1:e,h=M(c,u);var v=a+o,p=v;while(p>7){p-=7}v+=7-p;var g=false;for(var m=0,y=0;m<v;m++){var b=new Date(e,t,1+(m-o)),w=A(this._d)?P(b,this._d):false,C=P(b,i),S=n.events.indexOf(b.toDateString())!==-1?true:false,E=m<o||m>=a+o,k=1+(m-o),T=t,_=e,x=n.startRange&&P(n.startRange,b),D=n.endRange&&P(n.endRange,b),R=n.startRange&&n.endRange&&n.startRange<b&&b<n.endRange,I=n.minDate&&b<n.minDate||n.maxDate&&b>n.maxDate||n.disableWeekends&&N(b)||n.disableDayFn&&n.disableDayFn(b);if(E){if(m<o){k=h+k;T=u;_=c}else{k=k-a;T=f;_=d}}var O={day:k,month:T,year:_,hasEvent:S,isSelected:w,isToday:C,isDisabled:I,isEmpty:E,isStartRange:x,isEndRange:D,isInRange:R,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};if(n.pickWholeWeek&&w){g=true}l.push(F(O));if(++y===7){if(n.showWeekNumber){l.unshift(B(m-o,t,e))}s.push(H(l,n.isRTL,n.pickWholeWeek,g));l=[];y=0;g=false}}return $(n,s,r)},isVisible:function(){return this._v},show:function(){if(!this.isVisible()){this._v=true;this.draw();v(this.el,"is-hidden");if(this._o.bound){l(d,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function"){this._o.onOpen.call(this)}}},hide:function(){var e=this._v;if(e!==false){if(this._o.bound){t(d,"click",this._onClick)}this.el.style.position="static";this.el.style.left="auto";this.el.style.top="auto";h(this.el,"is-hidden");this._v=false;if(e!==undefined&&typeof this._o.onClose==="function"){this._o.onClose.call(this)}}},destroy:function(){var e=this._o;this.hide();t(this.el,"mousedown",this._onMouseDown,true);t(this.el,"touchend",this._onMouseDown,true);t(this.el,"change",this._onChange);if(e.keyboardInput){t(d,"keydown",this._onKeyChange)}if(e.field){t(e.field,"change",this._onInputChange);if(e.bound){t(e.trigger,"click",this._onInputClick);t(e.trigger,"focus",this._onInputFocus);t(e.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode){this.el.parentNode.removeChild(this.el)}}};return e});(function(){var e=document.createElement("input");var r="placeholder"in e;function o(e,t){var r={};for(var n in e){r[n]=t[n]===undefined?e[n]:t[n]}return r}var s=Object.freeze({START:"start",STOP:"stop",NOTHING:false});var l={letterDelay:100,sentenceDelay:1e3,loop:false,startOnFocus:true,shuffle:false,showCursor:true,cursor:"|",autoStart:false,onFocusAction:s.START,onBlurAction:s.STOP};function n(e,t,r){this.el=e;this.texts=t;r=r||{};this.options=o(l,r);if(!this.options.startOnFocus){console.warn("Superplaceholder.js: `startOnFocus` option has been deprecated. Please use `onFocusAction`, `onBlurAction` and `autoStart`");this.options.autoStart=true;this.options.onFocusAction=s.NOTHING;this.options.onBlurAction=s.NOTHING}this.timeouts=[];this.isPlaying=false;var n,i;if(this.options.shuffle){for(var a=this.texts.length;a--;){i=~~(Math.random()*a);n=this.texts[i];this.texts[i]=this.texts[a];this.texts[a]=n}}this.begin()}n.prototype.begin=function(){var e=this;e.originalPlaceholder=e.el.getAttribute("placeholder");if(e.options.onFocusAction||e.options.onBlurAction){e.listeners={focus:e.onFocus.bind(e),blur:e.onBlur.bind(e)};e.el.addEventListener("focus",e.listeners.focus);e.el.addEventListener("blur",e.listeners.blur)}if(e.options.autoStart){e.processText(0)}};n.prototype.onFocus=function(){if(this.options.onFocusAction===s.START){if(this.isInProgress()){return}this.processText(0)}else if(this.options.onFocusAction===s.STOP){this.cleanUp()}};n.prototype.onBlur=function(){if(this.options.onBlurAction===s.STOP){this.cleanUp()}else if(this.options.onBlurAction===s.START){if(this.isInProgress()){return}this.processText(0)}};n.prototype.cleanUp=function(){for(var e=this.timeouts.length;e--;){clearTimeout(this.timeouts[e])}if(this.originalPlaceholder===null){this.el.removeAttribute("placeholder")}else{this.el.setAttribute("placeholder",this.originalPlaceholder)}this.timeouts.length=0;this.isPlaying=false};n.prototype.isInProgress=function(){return this.isPlaying};n.prototype.typeString=function(t,r){var n=this,e;if(!t){return false}function i(e){n.el.setAttribute("placeholder",t.substr(0,e+1)+(e===t.length-1||!n.options.showCursor?"":n.options.cursor));if(e===t.length-1){r()}}for(var a=0;a<t.length;a++){e=setTimeout(i,a*n.options.letterDelay,a);n.timeouts.push(e)}};n.prototype.processText=function(e){var t=this,r;this.isPlaying=true;t.typeString(t.texts[e],function(){t.timeouts.length=0;if(!t.options.loop&&!t.texts[e+1]){t.isPlaying=false}r=setTimeout(function(){t.processText(t.options.loop?(e+1)%t.texts.length:e+1)},t.options.sentenceDelay);t.timeouts.push(r)})};var t=function(e){if(!r){return}var t=new n(e.el,e.sentences,e.options);return{start:function(){if(t.isInProgress()){return}t.processText(0)},stop:function(){t.cleanUp()},destroy:function(){t.cleanUp();for(var e in t.listeners){t.el.removeEventListener(e,t.listeners[e])}}}};t.Actions=s;if(typeof exports==="object"){module.exports=t}else if(typeof define==="function"&&define.amd){define(function(){return t})}else{window.superplaceholder=t}})();(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.tingle=t()}})(this,function(){var t=false;function e(e){var t={onClose:null,onOpen:null,beforeOpen:null,beforeClose:null,stickyFooter:false,footer:false,cssClass:[],closeLabel:"Close",closeMethods:["overlay","button","escape"]};this.opts=c({},t,e);this.init()}e.prototype.init=function(){if(this.modal){return}i.call(this);o.call(this);document.body.insertBefore(this.modal,document.body.firstChild);if(this.opts.footer){this.addFooter()}return this};e.prototype._busy=function(e){t=e};e.prototype._isBusy=function(){return t};e.prototype.destroy=function(){if(this.modal===null){return}if(this.isOpen()){this.close(true)}f.call(this);this.modal.parentNode.removeChild(this.modal);this.modal=null};e.prototype.isOpen=function(){return!!this.modal.classList.contains("tingle-modal--visible")};e.prototype.open=function(){if(this._isBusy())return;this._busy(true);var e=this;if(typeof e.opts.beforeOpen==="function"){e.opts.beforeOpen()}if(this.modal.style.removeProperty){this.modal.style.removeProperty("display")}else{this.modal.style.removeAttribute("display")}this._scrollPosition=window.pageYOffset;document.body.classList.add("tingle-enabled");document.body.style.top=-this._scrollPosition+"px";this.setStickyFooter(this.opts.stickyFooter);this.modal.classList.add("tingle-modal--visible");if(typeof e.opts.onOpen==="function"){e.opts.onOpen.call(e)}e._busy(false);this.checkOverflow();return this};e.prototype.close=function(e){if(this._isBusy())return;this._busy(true);e=e||false;if(typeof this.opts.beforeClose==="function"){var t=this.opts.beforeClose.call(this);if(!t){this._busy(false);return}}document.body.classList.remove("tingle-enabled");window.scrollTo({top:this._scrollPosition,behavior:"instant"});document.body.style.top=null;this.modal.classList.remove("tingle-modal--visible");var r=this;r.modal.style.display="none";if(typeof r.opts.onClose==="function"){r.opts.onClose.call(this)}r._busy(false)};e.prototype.setContent=function(e){if(typeof e==="string"){this.modalBoxContent.innerHTML=e}else{this.modalBoxContent.innerHTML="";this.modalBoxContent.appendChild(e)}if(this.isOpen()){this.checkOverflow()}return this};e.prototype.getContent=function(){return this.modalBoxContent};e.prototype.addFooter=function(){a.call(this);return this};e.prototype.setFooterContent=function(e){this.modalBoxFooter.innerHTML=e;return this};e.prototype.getFooterContent=function(){return this.modalBoxFooter};e.prototype.setStickyFooter=function(e){if(!this.isOverflow()){e=false}if(e){if(this.modalBox.contains(this.modalBoxFooter)){this.modalBox.removeChild(this.modalBoxFooter);this.modal.appendChild(this.modalBoxFooter);this.modalBoxFooter.classList.add("tingle-modal-box__footer--sticky");n.call(this);this.modalBoxContent.style["padding-bottom"]=this.modalBoxFooter.clientHeight+20+"px"}}else if(this.modalBoxFooter){if(!this.modalBox.contains(this.modalBoxFooter)){this.modal.removeChild(this.modalBoxFooter);this.modalBox.appendChild(this.modalBoxFooter);this.modalBoxFooter.style.width="auto";this.modalBoxFooter.style.left="";this.modalBoxContent.style["padding-bottom"]="";this.modalBoxFooter.classList.remove("tingle-modal-box__footer--sticky")}}return this};e.prototype.addFooterBtn=function(e,t,r){var n=document.createElement("button");n.innerHTML=e;n.addEventListener("click",r);if(typeof t==="string"&&t.length){t.split(" ").forEach(function(e){n.classList.add(e)})}this.modalBoxFooter.appendChild(n);return n};e.prototype.resize=function(){console.warn("Resize is deprecated and will be removed in version 1.0")};e.prototype.isOverflow=function(){var e=window.innerHeight;var t=this.modalBox.clientHeight;return t>=e};e.prototype.checkOverflow=function(){if(this.modal.classList.contains("tingle-modal--visible")){if(this.isOverflow()){this.modal.classList.add("tingle-modal--overflow")}else{this.modal.classList.remove("tingle-modal--overflow")}if(!this.isOverflow()&&this.opts.stickyFooter){this.setStickyFooter(false)}else if(this.isOverflow()&&this.opts.stickyFooter){n.call(this);this.setStickyFooter(true)}}};function r(){return'<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.3 9.7c.2.2.4.3.7.3.3 0 .5-.1.7-.3L5 6.4l3.3 3.3c.2.2.5.3.7.3.2 0 .5-.1.7-.3.4-.4.4-1 0-1.4L6.4 5l3.3-3.3c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0L5 3.6 1.7.3C1.3-.1.7-.1.3.3c-.4.4-.4 1 0 1.4L3.6 5 .3 8.3c-.4.4-.4 1 0 1.4z" fill="#000" fill-rule="nonzero"/></svg>'}function n(){if(!this.modalBoxFooter){return}this.modalBoxFooter.style.width=this.modalBox.clientWidth+"px";this.modalBoxFooter.style.left=this.modalBox.offsetLeft+"px"}function i(){this.modal=document.createElement("div");this.modal.classList.add("tingle-modal");if(this.opts.closeMethods.length===0||this.opts.closeMethods.indexOf("overlay")===-1){this.modal.classList.add("tingle-modal--noOverlayClose")}this.modal.style.display="none";this.opts.cssClass.forEach(function(e){if(typeof e==="string"){this.modal.classList.add(e)}},this);if(this.opts.closeMethods.indexOf("button")!==-1){this.modalCloseBtn=document.createElement("button");this.modalCloseBtn.type="button";this.modalCloseBtn.classList.add("tingle-modal__close");this.modalCloseBtnIcon=document.createElement("span");this.modalCloseBtnIcon.classList.add("tingle-modal__closeIcon");this.modalCloseBtnIcon.innerHTML=r();this.modalCloseBtnLabel=document.createElement("span");this.modalCloseBtnLabel.classList.add("tingle-modal__closeLabel");this.modalCloseBtnLabel.innerHTML=this.opts.closeLabel;this.modalCloseBtn.appendChild(this.modalCloseBtnIcon);this.modalCloseBtn.appendChild(this.modalCloseBtnLabel)}this.modalBox=document.createElement("div");this.modalBox.classList.add("tingle-modal-box");this.modalBoxContent=document.createElement("div");this.modalBoxContent.classList.add("tingle-modal-box__content");this.modalBox.appendChild(this.modalBoxContent);if(this.opts.closeMethods.indexOf("button")!==-1){this.modal.appendChild(this.modalCloseBtn)}this.modal.appendChild(this.modalBox)}function a(){this.modalBoxFooter=document.createElement("div");this.modalBoxFooter.classList.add("tingle-modal-box__footer");this.modalBox.appendChild(this.modalBoxFooter)}function o(){this._events={clickCloseBtn:this.close.bind(this),clickOverlay:l.bind(this),resize:this.checkOverflow.bind(this),keyboardNav:s.bind(this)};if(this.opts.closeMethods.indexOf("button")!==-1){this.modalCloseBtn.addEventListener("click",this._events.clickCloseBtn)}this.modal.addEventListener("mousedown",this._events.clickOverlay);window.addEventListener("resize",this._events.resize);document.addEventListener("keydown",this._events.keyboardNav)}function s(e){if(this.opts.closeMethods.indexOf("escape")!==-1&&e.which===27&&this.isOpen()){this.close()}}function l(e){if(this.opts.closeMethods.indexOf("overlay")!==-1&&!u(e.target,"tingle-modal")&&e.clientX<this.modal.clientWidth){this.close()}}function u(e,t){while((e=e.parentElement)&&!e.classList.contains(t));return e}function f(){if(this.opts.closeMethods.indexOf("button")!==-1){this.modalCloseBtn.removeEventListener("click",this._events.clickCloseBtn)}this.modal.removeEventListener("mousedown",this._events.clickOverlay);window.removeEventListener("resize",this._events.resize);document.removeEventListener("keydown",this._events.keyboardNav)}function c(){for(var e=1;e<arguments.length;e++){for(var t in arguments[e]){if(arguments[e].hasOwnProperty(t)){arguments[0][t]=arguments[e][t]}}}return arguments[0]}return{modal:e}});(function(e,t){if(typeof define==="function"&&define.amd){define(function(){return t(e)})}else if(typeof module==="object"&&module.exports){module.exports=t(e)}else{if(typeof e.tail==="undefined"){e.tail={}}e.tail.select=t(e);if(typeof jQuery!=="undefined"){jQuery.fn.tailselect=function(e){var t=[],r;this.each(function(){if((r=tail.select(this,e))!==false){t.push(r)}});return t.length===1?t[0]:t.length===0?false:t}}if(typeof MooTools!=="undefined"){Element.implement({tailselect:function(e){return new tail.select(this,e)}})}}})(window,function(e){"use strict";var s=e,f=e.document;function g(e,t){return e&&"classList"in e?e.classList.contains(t):false}function c(e,t){return e&&"classList"in e?e.classList.add(t):undefined}function d(e,t){return e&&"classList"in e?e.classList.remove(t):undefined}function i(e,t,r){if(CustomEvent&&CustomEvent.name){var n=new CustomEvent(t,r)}else{var n=f.createEvent("CustomEvent");n.initCustomEvent(t,!!r.bubbles,!!r.cancelable,r.detail)}return e.dispatchEvent(n)}function u(e,t){if(typeof Object.assign==="function"){return Object.assign({},e,t||{})}var r=Object.constructor();for(var n in e){r[n]=n in t?t[n]:e[n]}return r}function m(e,t){var r=f.createElement(e);r.className=t&&t.join?t.join(" "):t||"";return r}var h=function(e,t){e=typeof e==="string"?f.querySelectorAll(e):e;if(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array){for(var r=[],n=e.length,i=0;i<n;i++){r.push(new h(e[i],u(t,{})))}return r.length===1?r[0]:r.length===0?false:r}if(!(e instanceof Element)||!(this instanceof h)){return!(e instanceof Element)?false:new h(e,t)}if(h.inst[e.getAttribute("data-tail-select")]){return h.inst[e.getAttribute("data-tail-select")]}if(e.getAttribute("data-select")){var a=JSON.parse(e.getAttribute("data-select").replace(/\'/g,'"'));if(a instanceof Object){t=u(t,a)}}var o=e.getAttribute("placeholder")||e.getAttribute("data-placeholder"),s="bindSourceSelect",l="sourceHide";t=t instanceof Object?t:{};t.multiple="multiple"in t?t.multiple:e.multiple;t.disabled="disabled"in t?t.disabled:e.disabled;t.placeholder=o||t.placeholder||null;t.width=t.width==="auto"?e.offsetWidth+50:t.width;t.sourceBind=s in t?t[s]:t.sourceBind||false;t.sourceHide=l in t?t[l]:t.sourceHide||true;t.multiLimit=t.multiLimit>=0?t.multiLimit:Infinity;this.e=e;this.id=++h.count;this.con=u(h.defaults,t);this.events={};h.inst["tail-"+this.id]=this;return this.init().bind()},l;h.version="0.5.16";h.status="beta";h.count=0;h.inst={};h.defaults={animate:true,classNames:null,csvOutput:false,csvSeparator:",",descriptions:false,deselect:false,disabled:false,height:350,hideDisabled:false,hideSelected:false,items:{},locale:"en",linguisticRules:{"Ðµ":"Ñ",a:"Ã¤",o:"Ã¶",u:"Ã¼",ss:"Ã"},multiple:false,multiLimit:Infinity,multiPinSelected:false,multiContainer:false,multiShowCount:true,multiShowLimit:false,multiSelectAll:false,multiSelectGroup:true,openAbove:null,placeholder:null,search:false,searchConfig:["text","value"],searchFocus:true,searchMarked:true,searchMinLength:1,searchDisabled:true,sortItems:false,sortGroups:false,sourceBind:false,sourceHide:true,startOpen:false,stayOpen:false,width:null,cbComplete:undefined,cbEmpty:undefined,cbLoopItem:undefined,cbLoopGroup:undefined};h.strings={en:{all:"ì ì²´",none:"ìì",empty:"í­ëª© ìì",emptySearch:"í­ëª© ìì",limit:"ë ë§ì í­ëª©ì ì íí  ì ììµëë¤",placeholder:"í­ëª© ì í...",placeholderMulti:"í­ëª© ì í...",search:"ê²ì í­ëª©ì ìë ¥...",disabled:"í­ëª© (ì¬ì© ìí¨)"},modify:function(e,t,r){if(!(e in this)){return false}if(t instanceof Object){for(var n in t){this.modify(e,n,t[n])}}else{this[e][t]=typeof r==="string"?r:this[e][t]}return true},register:function(e,t){if(typeof e!=="string"||!(t instanceof Object)){return false}this[e]=t;return true}};h.prototype={_e:function(e,t,r){if(!(e in this.__)){return!r?e:r}var e=this.__[e];if(typeof e==="function"){e=e.call(this,t)}if(typeof t==="object"){for(var n in t){e=e.replace(n,t[n])}}return e},init:function(){var t=this,e=["tail-select"],r=this.con,n=/^[0-9.]+(?:cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|\%)$/i;var i=r.classNames===true?this.e.className:r.classNames;e.push(i&&i.push?i.join(" "):i&&i.split?i:"no-classes");if(r.hideSelected){e.push("hide-selected")}if(r.hideDisabled){e.push("hide-disabled")}if(r.multiLimit==0){e.push("disabled")}if(r.multiple){e.push("multiple")}if(r.deselect){e.push("deselect")}if(r.disabled){e.push("disabled")}this.__=u(h.strings.en,h.strings[r.locale]||{});this._init=true;this._query=false;this.select=m("DIV",e);this.label=m("DIV","select-label");this.dropdown=m("DIV","select-dropdown");this.search=m("DIV","dropdown-search");this.csvInput=m("INPUT","select-search");if(this.e.getAttribute("tabindex")!==null){this.select.setAttribute("tabindex",this.e.getAttribute("tabindex"))}else{this.select.setAttribute("tabindex",0)}if(r.width&&n.test(r.width)){this.select.style.width=r.width}else if(r.width&&!isNaN(parseFloat(r.width,10))){this.select.style.width=r.width+"px"}this.label.addEventListener("click",function(e){t.toggle.call(t,t.con.animate)});this.select.appendChild(this.label);if(!isNaN(parseInt(r.height,10))){this.dropdown.style.maxHeight=parseInt(r.height,10)+"px"}if(r.search){this.search.innerHTML='<input type="text" class="search-input" />';this.search.children[0].placeholder=this._e("search");this.search.children[0].addEventListener("input",function(e){t.query.call(t,this.value.length>r.searchMinLength?this.value:undefined)});this.dropdown.appendChild(this.search)}this.select.appendChild(this.dropdown);this.csvInput.type="hidden";if(r.csvOutput){this.csvInput.name=this.e.name;this.e.removeAttribute("name");this.select.appendChild(this.csvInput)}if(r.multiple&&r.multiContainer){if(f.querySelector(r.multiContainer)){this.container=f.querySelector(r.multiContainer);this.container.className+=" tail-select-container"}else if(r.multiContainer===true){this.container=this.label;this.container.className+=" tail-select-container"}}this.options=new l(this.e,this);for(var a=this.e.options.length,o=0;o<a;o++){this.options.set(this.e.options[o],false)}for(var s in r.items){if(typeof r.items[s]==="string"){r.items[s]={value:r.items[s]}}this.options.add(r.items[s].key||s,r.items[s].value,r.items[s].group,r.items[s].selected,r.items[s].disabled,r.items[s].description)}this.query();if(this.e.nextElementSibling){this.e.parentElement.insertBefore(this.select,this.e.nextElementSibling)}else{this.e.parentElement.appendChild(this.select)}if(r.sourceHide){if(this.e.style.display=="none"){this.select.style.display="none";this.e.setAttribute("data-select-hidden","display")}else if(this.e.style.visibility=="hidden"){this.select.style.visibiltiy="hidden";this.e.setAttribute("data-select-hidden","visibility")}else{this.e.style.display="none";this.e.setAttribute("data-select-hidden","0")}}this.e.setAttribute("data-tail-select","tail-"+this.id);if(t.con.startOpen){this.open(r.animate)}(r.cbComplete||function(){}).call(this,this.select);return(this._init=false)?this:this},bind:function(){var u=this;f.addEventListener("keydown",function(e){var t=e.keyCode||e.which,r,n,i,a,o;var s=t==32&&u.select===document.activeElement;if(!s&&(!g(u.select,"active")||[13,27,38,40].indexOf(t)<0)){return false}e.preventDefault();e.stopPropagation();if(t===32){return u.open(u.con.animate)}if(t==13){if(r=u.dropdown.querySelector(".dropdown-option.hover:not(.disabled)")){u.options.select.call(u.options,r)}}if(t==27||t==13){return u.close(u.con.animate)}if(r=u.dropdown.querySelector(".dropdown-option.hover:not(.disabled)")){d(r,"hover");i=[(t==40?"next":"previous")+"ElementSibling"];do{if((a=r[i])!==null&&r.tagName=="LI"){r=a}else if((a=r.parentElement[i])!==null&&a.children.length>0&&a.tagName=="UL"){r=a.children[t==40?0:a.children.length-1]}else{r=false}if(r&&(!g(r,"dropdown-option")||g(r,"disabled"))){continue}break}while(true)}if(!r&&t==40){r=u.dropdown.querySelector(".dropdown-option:not(.disabled)")}else if(!r&&t==38){o=u.dropdown.querySelectorAll(".dropdown-option:not(.disabled)");r=o[o.length-1]}if(r&&(n=u.dropdown.querySelector(".dropdown-inner"))){var l=function(e){var t={top:e.offsetTop,height:e.offsetHeight};while((e=e.parentElement)!=n){t.top+=e.offsetTop}return t}(r);c(r,"hover");n.scrollTop=Math.max(0,l.top-l.height*2)}return true});f.addEventListener("click",function(e){if(!g(u.select,"active")||g(u.select,"idle")){return false}if(u.con.stayOpen===true){return false}var t=[u.e,u.select,u.container];for(var r=t.length,n=0;n<r;n++){if(t[n]&&(t[n].contains(e.target)||t[n]==e.target)){return false}if(!e.target.parentElement){return false}}return u.close.call(u,u.con.animate)});if(!this.con.sourceBind){return true}this.e.addEventListener("change",function(e){if(e.detail!=undefined){return false}e.preventDefault();e.stopPropagation();if(!this.multiple&&this.selectedIndex){u.options.select.call(u.options,this.options[this.selectedIndex])}else{var t=[].concat(u.options.selected);var r=[].filter.call(this.querySelectorAll("option:checked"),function(e){if(t.indexOf(e)>=0){t.splice(t.indexOf(e),1);return false}return true});u.options.walk.call(u.options,"unselect",t);u.options.walk.call(u.options,"select",r)}});return true},callback:function(e,t,r){var n=e.key.replace(/('|\\)/g,"\\$1"),i=e.group.replace(/('|\\)/g,"\\$1"),a="[data-key='"+n+"'][data-group='"+i+"']";if(t=="rebuild"){return this.query()}var o=this.dropdown.querySelector(a);if(o&&["select","disable"].indexOf(t)>=0){c(o,t=="select"?"selected":"disabled")}else if(o&&["unselect","enable"].indexOf(t)>=0){d(o,t=="unselect"?"selected":"disabled")}this.update(e);return r===true?true:this.trigger("change",e,t)},trigger:function(e){if(this._init){return false}var t={bubbles:false,cancelable:true,detail:{args:arguments,self:this}};if(e=="change"&&arguments[2]&&arguments[2].indexOf("select")>=0){i(this.e,"input",t);i(this.e,"change",t)}i(this.select,"tail::"+e,t);var r=[],n;Array.prototype.map.call(arguments,function(e,t){if(t>0){r.push(e)}});(this.events[e]||[]).forEach(function(e){n=[].concat(r);n.push(e.args||null);(e.cb||function(){}).apply(t.detail.self,n)});return true},calc:function(){var e=this.dropdown.cloneNode(true),t=this.con.height,r=0,n=this.dropdown.querySelector(".dropdown-inner");e=this.dropdown.cloneNode(true);e.style.cssText="height:auto;min-height:auto;max-height:none;opacity:0;display:block;visibility:hidden;";e.style.maxHeight=this.con.height+"px";e.className+=" cloned";this.dropdown.parentElement.appendChild(e);t=t>e.clientHeight?e.clientHeight:t;if(this.con.search){r=e.querySelector(".dropdown-search").clientHeight}this.dropdown.parentElement.removeChild(e);var i=this.select.getBoundingClientRect(),a=s.innerHeight-(i.top+i.height),o=t+r>a?i.top>a:false;if(this.con.openAbove===true||this.con.openAbove!==false&&o){o=true,t=Math.min(t,i.top-10);c(this.select,"open-top")}else{o=false,t=Math.min(t,a-10);d(this.select,"open-top")}if(n){this.dropdown.style.maxHeight=t+"px";n.style.maxHeight=t-r+"px"}return this},query:function(e,t){var r,n,i,a,o,s;var l=this,u=this.con,f="getAttribute";var c=m("DIV","dropdown-inner"),d=!e?"walker":"finder",h=!e?[u.sortItems,u.sortGroups]:[e,t];this._query=typeof e==="string"?e:false;while(r=this.options[d].apply(this.options,h)){if(!i||i&&i[f]("data-group")!==r.group){n=(u.cbLoopGroup||this.cbGroup).call(this,r.group,e,c);if(n instanceof Element){i=n;i.setAttribute("data-group",r.group);c.appendChild(i)}else{break}}if((a=(u.cbLoopItem||this.cbItem).call(this,r,i,e,c))===null){continue}if(a===false){break}a.setAttribute("data-key",r.key);a.setAttribute("data-group",r.group);a.addEventListener("click",function(e){if(!this.hasAttribute("data-key")){return false}var t=this[f]("data-key"),r=this[f]("data-group")||"#";if(l.options.toggle.call(l.options,t,r)){if(l.con.stayOpen===false&&!l.con.multiple){l.close.call(l,l.con.animate)}}});i.appendChild(a)}var v=c.querySelectorAll("*[data-key]").length;if(v==0){(this.con.cbEmpty||function(e){var t=m("SPAN","dropdown-empty");t.innerText=this._e("empty");e.appendChild(t)}).call(this,c,e)}if(v>0&&u.multiple&&u.multiLimit==Infinity&&u.multiSelectAll){o=m("BUTTON","tail-all"),s=m("BUTTON","tail-none");o.innerText=this._e("all");o.addEventListener("click",function(e){e.preventDefault();var t=l.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");l.options.walk.call(l.options,"select",t)});s.innerText=this._e("none");s.addEventListener("click",function(e){e.preventDefault();var t=l.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");l.options.walk.call(l.options,"unselect",t)});a=m("SPAN","dropdown-action");a.appendChild(o);a.appendChild(s);c.insertBefore(a,c.children[0])}var p=this.dropdown.querySelector(".dropdown-inner");this.dropdown[(p?"replace":"append")+"Child"](c,p);if(g(this.select,"active")){this.calc()}return this.updateCSV().updateLabel()},cbGroup:function(e,t){var r=m("UL","dropdown-optgroup"),n=this,i,a;if(e=="#"){return r}r.innerHTML='<li class="optgroup-title"><b>'+e+"</b></li>";if(this.con.multiple&&this.con.multiLimit==Infinity&&this.con.multiSelectAll){i=m("BUTTON","tail-none"),a=m("BUTTON","tail-all");i.innerText=this._e("none");i.addEventListener("click",function(e){e.preventDefault();var t=this.parentElement.parentElement.getAttribute("data-group");n.options.all.call(n.options,"unselect",t)});a.innerText=this._e("all");a.addEventListener("click",function(e){e.preventDefault();var t=this.parentElement.parentElement.getAttribute("data-group");n.options.all.call(n.options,"select",t)});r.children[0].appendChild(i);r.children[0].appendChild(a)}return r},cbItem:function(e,t,r){var n=m("LI","dropdown-option"+(e.selected?" selected":"")+(e.disabled?" disabled":""));if(r&&r.length>0&&this.con.searchMarked){r=this.options.applyLinguisticRules(r);n.innerHTML=e.value.replace(new RegExp("("+r+")","i"),"<mark>$1</mark>")}else{n.innerText=e.value}if(this.con.descriptions&&e.description){n.innerHTML+='<span class="option-description">'+e.description+"</span>"}return n},update:function(e){return this.updateLabel().updateContainer(e).updatePin(e).updateCSV(e)},updateLabel:function(e){if(this.container==this.label&&this.options.selected.length>0){if(this.label.querySelector(".label-inner")){this.label.removeChild(this.label.querySelector(".label-inner"))}if(this.label.querySelector(".label-count")){this.label.removeChild(this.label.querySelector(".label-count"))}return this}var t=this.con,r=this.options.selected.length,n;if(typeof e!=="string"){if(t.disabled){e="disabled"}else if(this.dropdown.querySelectorAll("*[data-key]").length==0){e="empty"+(g(this.select,"in-search")?"Search":"")}else if(t.multiLimit<=r){e="limit"}else if(!t.multiple&&this.options.selected.length>0){e=this.options.selected[0].innerText}else if(typeof t.placeholder==="string"){e=t.placeholder}else{e="placeholder"+(t.multiple&&t.multiLimit<Infinity?"Multi":"")}}e=this._e(e,{":limit":t.multiLimit},e);e='<span class="label-inner">'+e+"</span>",n=t.multiShowLimit&&t.multiLimit<Infinity;if(t.multiple&&t.multiShowCount){e='<span class="label-count">:c</span>'+e;e=e.replace(":c",r+(n?" / "+t.multiLimit:""))}this.label.innerHTML=e;return this},updateContainer:function(e){if(!this.container||!this.con.multiContainer){return this}var t="[data-group='"+e.group+"'][data-key='"+e.key+"']";if(this.container.querySelector(t)){if(!e.selected){this.container.removeChild(this.container.querySelector(t))}return this}if(e.selected){var n=this,r=m("DIV","select-handle");r.innerText=e.value;r.setAttribute("data-key",e.key);r.setAttribute("data-group",e.group);r.addEventListener("click",function(e){e.preventDefault();e.stopPropagation();var t=this.getAttribute("data-key"),r=this.getAttribute("data-group");n.options.unselect.call(n.options,t,r)});this.container.appendChild(r)}return this},updatePin:function(e){var t=this.dropdown.querySelector(".dropdown-inner ul"),r="li[data-key='"+e.key+"'][data-group='"+e.group+"']";if(!this.con.multiPinSelected||!t||this._query!==false){return this}r=this.dropdown.querySelector(r);if(e.selected){t.insertBefore(r,t.children[0])}else{var n=this.dropdown.querySelector("ul[data-group='"+e.group+"']"),i=this.options[e.index-1],a=false;while(i&&i.group==e.group){if(a=n.querySelector("li[data-key='"+i.key+"']")){break}i=this.options[i.index-1]}if(a&&a.nextElementSibling){n.insertBefore(r,a.nextElementSibling)}else{n.appendChild(r)}}return this},updateCSV:function(e){if(!this.csvInput||!this.con.csvOutput){return this}for(var t=[],r=this.options.selected.length,n=0;n<r;n++){t.push(this.options.selected[n].value)}this.csvInput.value=t.join(this.con.csvSeparator||",");return this},open:function(e){if(g(this.select,"active")||g(this.select,"idle")||this.con.disabled){return false}this.calc();var n=function(){c(i.select,"active");d(i.select,"idle");this.dropdown.style.height="auto";this.dropdown.style.overflow="visible";this.label.removeAttribute("style");if(this.con.search&&this.con.searchFocus){this.dropdown.querySelector("input").focus()}this.trigger.call(this,"open")},i=this,a=this.dropdown.style;if(e!==false){this.label.style.zIndex=25;this.dropdown.style.cssText+="height:0;display:block;overflow:hidden;";c(i.select,"idle");(function e(){var t=parseInt(a.height,10),r=parseInt(a.maxHeight,10);if(t>=r){return n.call(i)}a.height=(t+50>r?r:t+50)+"px";setTimeout(e,20)})()}else{a.cssText="height:"+a.maxHeight+";display:block;overflow:hidden;";n.call(this)}return this},close:function(e){if(!g(this.select,"active")||g(this.select,"idle")){return false}var t=function(){d(this.select,"active");d(this.select,"idle");this.dropdown.removeAttribute("style");this.dropdown.querySelector(".dropdown-inner").removeAttribute("style");this.trigger.call(this,"close")},r=this,n=this.dropdown;if(e!==false){c(this.select,"idle");this.dropdown.style.overflow="hidden";(function e(){if(parseInt(n.offsetHeight,10)-50<=0){return t.call(r)}n.style.height=parseInt(n.offsetHeight,10)-50+"px";setTimeout(e,20)})()}else{t.call(this)}return this},toggle:function(e){if(g(this.select,"active")){return this.close(e)}return!g(this.select,"idle")?this.open(e):this},remove:function(){this.e.removeAttribute("data-tail-select");if(this.e.hasAttribute("data-select-hidden")){if(this.e.getAttribute("data-select-hidden")=="0"){this.e.style.removeProperty("display")}this.e.removeAttribute("data-select-hidden")}Array.prototype.map.call(this.e.querySelectorAll("[data-select-option='add']"),function(e){e.parentElement.removeChild(e)});Array.prototype.map.call(this.e.querySelectorAll("[data-select-optgroup='add']"),function(e){e.parentElement.removeChild(e)});this.e.name=this.csvInput.hasAttribute("name")?this.csvInput.name:this.e.name;if(this.select.parentElement){this.select.parentElement.removeChild(this.select)}if(this.container){var e=this.container.querySelectorAll(".select-handle");for(var t=e.length,r=0;r<t;r++){this.container.removeChild(e[r])}}return this},reload:function(){return this.remove().init()},config:function(e,t,r){if(e instanceof Object){for(var n in e){this.config(n,e[n],false)}return this.reload()?this.con:this.con}if(e===void 0){return this.con}else if(!(e in this.con)){return false}if(t===void 0){return this.con[e]}this.con[e]=t;if(r!==false){this.reload()}return this},enable:function(e){d(this.select,"disabled");this.e.disabled=false;this.con.disabled=false;return e===false?this:this.reload()},disable:function(e){c(this.select,"disabled");this.e.disabled=true;this.con.disabled=true;return e===false?this:this.reload()},on:function(e,t,r){if(["open","close","change"].indexOf(e)<0||typeof t!=="function"){return false}if(!(e in this.events)){this.events[e]=[]}this.events[e].push({cb:t,args:r instanceof Array?r:[]});return this},value:function(){if(this.options.selected.length==0){return null}if(this.con.multiple){return this.options.selected.map(function(e){return e.value})}return this.options.selected[0].value}};l=h.options=function(e,t){if(!(this instanceof l)){return new l(e,t)}this.self=t;this.element=e;this.length=0;this.selected=[];this.disabled=[];this.items={"#":{}};this.groups={};return this};l.prototype={_r:function(e){return e.replace("disabled","disable").replace("enabled","enable").replace("selected","select").replace("unselected","unselect")},get:function(e,t){var r="getAttribute";if(typeof e==="object"&&e.key&&e.group){t=e.group||t;e=e.key}else if(e instanceof Element){if(e.tagName=="OPTION"){t=e.parentElement.label||"#";e=e.value||e.innerText}else if(e.hasAttribute("data-key")){t=e[r]("data-group")||e.parentElement[r]("data-group")||"#";e=e[r]("data-key")}}else if(typeof e!=="string"){return false}e=/^[0-9]+$/.test(e)?"_"+e:e;return t in this.items?this.items[t][e]:false},set:function(e,t){var r=e.value||e.innerText,n=e.parentElement.label||"#";if(!(n in this.items)){this.items[n]={};this.groups[n]=e.parentElement}if(r in this.items[n]){return false}var i=/^[0-9]+$/.test(r)?"_"+r:r;var a=this.self.con;if(a.multiple&&this.selected.length>=a.multiLimit){e.selected=false}if(e.selected&&a.deselect&&(!e.hasAttribute("selected")||a.multiLimit==0)){e.selected=false;e.parentElement.selectedIndex=-1}if(e.hasAttribute("data-description")){var o=m("SPAN");o.innerHTML=e.getAttribute("data-description");e.setAttribute("data-description",o.innerHTML)}this.items[n][i]={key:r,value:e.text,description:e.getAttribute("data-description")||null,group:n,option:e,optgroup:n!="#"?this.groups[n]:undefined,selected:e.selected,disabled:e.disabled,hidden:e.hidden||false};this.length++;if(e.selected){this.select(this.items[n][i])}if(e.disabled){this.disable(this.items[n][i])}return t?this.self.callback(this.items[n][r],"rebuild"):true},add:function(e,t,r,n,i,a,o){if(e instanceof Object){for(var s in e){this.add(e[s].key||s,e[s].value,e[s].group,e[s].selected,e[s].disabled,e[s].description,false)}return this.self.query()}if(this.get(e,r)){return false}r=typeof r==="string"?r:"#";if(r!=="#"&&!(r in this.groups)){var l=m("OPTGROUP");l.label=r;l.setAttribute("data-select-optgroup","add");this.element.appendChild(l);this.items[r]={};this.groups[r]=l}if(this.self.con.multiple&&this.selected.length>=this.self.con.multiLimit){n=false}i=!!i;var u=f.createElement("OPTION");u.value=e;u.selected=n;u.disabled=i;u.innerText=t;u.setAttribute("data-select-option","add");if(a&&a.length>0){u.setAttribute("data-description",a)}(r=="#"?this.element:this.groups[r]).appendChild(u);return this.set(u,o)},move:function(e,t,r,n){if(!(e=this.get(e,t))){return false}if(r!=="#"&&!(r in this.groups)){var i=m("OPTGROUP");i.label=r;this.element.appendChild(i);this.items[r]={};this.groups[r]=i;this.groups[r].appendChild(e.option)}delete this.items[e.group][e.key];e.group=r;e.optgroup=this.groups[r]||undefined;this.items[r][e.key]=e;return n?this.self.query():true},remove:function(e,t,r){if(!(e=this.get(e,t))){return false}if(e.selected){this.unselect(e)}if(e.disabled){this.enable(e)}e.option.parentElement.removeChild(e.option);var n=/^[0-9]+$/.test(e.key)?"_"+e.key:e.key;delete this.items[e.group][n];this.length--;if(Object.keys(this.items[e.group]).length===0){delete this.items[e.group];delete this.groups[e.group]}return r?this.self.query():true},is:function(e,t,r){var e=this._r(e),n=this.get(t,r);if(!n||["select","unselect","disable","enable"].indexOf(e)<0){return null}if(e=="disable"||e=="enable"){return e=="disable"?n.disabled:!n.disabled}else if(e=="select"||e=="unselect"){return e=="select"?n.selected:!n.selected}return false},handle:function(e,t,r,n){var i=this.get(t,r),e=this._r(e);if(!i||["select","unselect","disable","enable"].indexOf(e)<0){return null}if(e=="disable"||e=="enable"){if(!(i.option in this.disabled)&&e=="disable"){this.disabled.push(i.option)}else if(i.option in this.disabled&&e=="enable"){this.disabled.splice(this.disabled.indexOf(i.option),1)}i.disabled=e=="disable";i.option.disabled=e=="disable";return this.self.callback.call(this.self,i,e)}var a=g(this.self.select,"disabled")||i.disabled||i.option.disabled,o=this.self.con.multiple&&this.self.con.multiLimit<=this.selected.length,s=!this.self.con.multiple&&this.selected.indexOf(i.option)>0,l=this.self.con.multiLimit==0&&this.self.con.deselect==true,u=!this.self.con.multiple&&!this.self.con.deselect&&n!==true;if(e=="select"){if(a||o||l||s){return false}if(!this.self.con.multiple){for(var f in this.selected){this.unselect(this.selected[f],undefined,true)}}if(this.selected.indexOf(i.option)<0){this.selected.push(i.option)}}else if(e=="unselect"){if(a||u){return false}this.selected.splice(this.selected.indexOf(i.option),1)}i.selected=e=="select";i.option.selected=e=="select";i.option[(e.length>6?"remove":"set")+"Attribute"]("selected","selected");return this.self.callback.call(this.self,i,e,n)},enable:function(e,t){return this.handle("enable",e,t,false)},disable:function(e,t){return this.handle("disable",e,t,false)},select:function(e,t){return this.handle("select",e,t,false)},unselect:function(e,t,r){return this.handle("unselect",e,t,r)},toggle:function(e,t){if(!(e=this.get(e,t))){return false}return this.handle(e.selected?"unselect":"select",e,t,false)},invert:function(t){t=this._r(t);if(["enable","disable"].indexOf(t)>=0){var r=this.disabled,n=t=="enable"?"disable":"enable"}else if(["select","unselect"].indexOf(t)>=0){var r=this.selected,n=t=="select"?"unselect":"select"}var e=Array.prototype.filter.call(this,function(e){return!(e in r)}),i=this;[].concat(r).forEach(function(e){i.handle.call(i,n,e)});[].concat(e).forEach(function(e){i.handle.call(i,t,e)});return true},all:function(t,r){var n=this,e=this;if(r in this.items){e=Object.keys(this.items[r])}else if(["unselect","enable"].indexOf(t)>=0){e=[].concat(t=="unselect"?this.selected:this.disabled)}Array.prototype.forEach.call(e,function(e){n.handle.call(n,t,e,r,false)});return true},walk:function(t,e,r){if(e instanceof Array||e.length){for(var n=e.length,i=0;i<n;i++){this.handle.apply(this,[t,e[i],null].concat(r))}}else if(e instanceof Object){var a=this;if(e.forEach){e.forEach(function(e){a.handle.apply(a,[t,e,null].concat(r))})}else{for(var o in e){if(typeof e[o]!=="string"&&typeof e[o]!=="number"&&!(e[o]instanceof Element)){continue}this.handle.apply(this,[t,e[o],o in this.items?o:null]).concat(r)}}}return this},applyLinguisticRules:function(e,t){var r=this.self.con.linguisticRules,n=[];Object.keys(r).forEach(function(e){n.push("("+e+"|["+r[e]+"])")});if(t){n=n.concat(n.map(function(e){return e.toUpperCase()}))}return e.replace(new RegExp(n.join("|"),t?"g":"ig"),function(e){return n[[].indexOf.call(arguments,e,1)-1]})},find:function(e,t){var r=this,n,i={};if(!t){t=this.self.con.searchConfig}if(typeof t==="function"){n=t.bind(this,e)}else{t=t instanceof Array?t:[t];t.forEach(function(e){if(typeof e==="string"){i[e]=true}});i.any=!i.any?i.attributes&&i.value:i.any;if(!i.regex||i.text){e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}if(!i.exactglyphes){e=this.self.options.applyLinguisticRules(e,i.case)}if(i.word){e="\\b"+e+"\\b"}var a=new RegExp(e,!i.case?"mi":"m"),o=function(e){return a.test(e.text||e.value)};if(i.any){n=function(e){return o(e)||[].some.call(e.attributes,o)}}else if(i.attributes){n=function(e){return[].some.call(e.attributes,o)}}else{n=o}if(!this.self.con.searchDisabled){var s=n;n=function(e){return!e.disabled&&s(e)}}}return[].filter.call(this.self.e.options,n).map(function(e){return e.hidden?false:r.get(e)})},finder:function(e,t){if(this._finderLoop===undefined){this._finderLoop=this.find(e,t)}var r;while((r=this._finderLoop.shift())!==undefined){return r}delete this._finderLoop;return false},walker:function(e,t){if(typeof this._inLoop!=="undefined"&&this._inLoop){if(this._inItems.length>0){do{var r=this.items[this._inGroup][this._inItems.shift()]}while(r.hidden===true);return r}if(this._inGroups.length>0){while(this._inGroups.length>0){var n=this._inGroups.shift();if(!(n in this.items)){return false}var i=Object.keys(this.items[n]);if(i.length>0){break}}if(e=="ASC"){i.sort()}else if(e=="DESC"){i.sort().reverse()}else if(typeof e==="function"){i=e.call(this,i)}this._inItems=i;this._inGroup=n;return this.walker(null,null)}delete this._inLoop;delete this._inItems;delete this._inGroup;delete this._inGroups;return false}var a=Object.keys(this.groups)||[];if(t=="ASC"){a.sort()}else if(t=="DESC"){a.sort().reverse()}else if(typeof t==="function"){a=t.call(this,a)}a.unshift("#");this._inLoop=true;this._inItems=[];this._inGroups=a;return this.walker(e,null)}};return h});(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.VMasker=t()}})(this,function(){var c="9",d="A",h="S",n=[9,16,17,18,36,37,38,39,40,91,92,93],a=function(e){for(var t=0,r=n.length;t<r;t++){if(e==n[t]){return false}}return true},S=function(e){e=e||{};e={delimiter:e.delimiter||".",lastOutput:e.lastOutput,precision:e.hasOwnProperty("precision")?e.precision:2,separator:e.separator||",",showSignal:e.showSignal,suffixUnit:e.suffixUnit&&" "+e.suffixUnit.replace(/[\s]/g,"")||"",unit:e.unit&&e.unit.replace(/[\s]/g,"")+" "||"",zeroCents:e.zeroCents};e.moneyPrecision=e.zeroCents?0:e.precision;return e},v=function(e,t,r){for(;t<e.length;t++){if(e[t]===c||e[t]===d||e[t]===h){e[t]=r}}return e};var r=function(e){this.elements=e};r.prototype.unbindElementToMask=function(){for(var e=0,t=this.elements.length;e<t;e++){this.elements[e].lastOutput="";this.elements[e].onkeyup=false;this.elements[e].onkeydown=false;if(this.elements[e].value.length){this.elements[e].value=this.elements[e].value.replace(/\D/g,"")}}};r.prototype.bindElementToMask=function(r){var n=this,e=function(e){e=e||window.event;var t=e.target||e.srcElement;if(a(e.keyCode)){setTimeout(function(){n.opts.lastOutput=t.lastOutput;t.value=o[r](t.value,n.opts);t.lastOutput=t.value;if(t.setSelectionRange&&n.opts.suffixUnit){t.setSelectionRange(t.value.length,t.value.length-n.opts.suffixUnit.length)}},0)}};for(var t=0,i=this.elements.length;t<i;t++){this.elements[t].lastOutput="";this.elements[t].onkeyup=e;if(this.elements[t].value.length){this.elements[t].value=o[r](this.elements[t].value,this.opts)}}};r.prototype.maskMoney=function(e){this.opts=S(e);this.bindElementToMask("toMoney")};r.prototype.maskNumber=function(){this.opts={};this.bindElementToMask("toNumber")};r.prototype.maskAlphaNum=function(){this.opts={};this.bindElementToMask("toAlphaNumeric")};r.prototype.maskPattern=function(e){this.opts={pattern:e};this.bindElementToMask("toPattern")};r.prototype.unMask=function(){this.unbindElementToMask()};var o=function(e){if(!e){throw new Error("VanillaMasker: There is no element to bind.")}var t="length"in e?e.length?e:[]:[e];return new r(t)};o.toMoney=function(e,t){t=S(t);if(t.zeroCents){t.lastOutput=t.lastOutput||"";var r="("+t.separator+"[0]{0,"+t.precision+"})",n=new RegExp(r,"g"),i=e.toString().replace(/[\D]/g,"").length||0,a=t.lastOutput.toString().replace(/[\D]/g,"").length||0;e=e.toString().replace(n,"");if(i<a){e=e.slice(0,e.length-1)}}var o=e.toString();var s=o.indexOf(t.separator),l=t.precision-(o.length-s-1);if(s!==-1&&l>0){o=o+"0"*l}o=o.replace(/[\D]/g,"");var u=new RegExp("^(0|\\"+t.delimiter+")"),f=new RegExp("(\\"+t.separator+")$"),c=o.substr(0,o.length-t.moneyPrecision),d=c.substr(0,c.length%3),h=new Array(t.precision+1).join("0");c=c.substr(c.length%3,c.length);for(var v=0,p=c.length;v<p;v++){if(v%3===0){d+=t.delimiter}d+=c[v]}d=d.replace(u,"");d=d.length?d:"0";var g="";if(t.showSignal===true){g=e<0||e.startsWith&&e.startsWith("-")?"-":""}if(!t.zeroCents){var m=Math.max(0,o.length-t.precision),y=o.substr(m,t.precision),b=y.length,w=t.precision>b?t.precision:b;h=(h+y).slice(-w)}var C=t.unit+g+d+t.separator+h;return C.replace(f,"")+t.suffixUnit};o.toPattern=function(e,t){var r=typeof t==="object"?t.pattern:t,n=r.replace(/\W/g,""),i=r.split(""),a=e.toString().replace(/\W/g,""),o=a.replace(/\W/g,""),s=0,l,u=i.length,f=typeof t==="object"?t.placeholder:undefined;for(l=0;l<u;l++){if(s>=a.length){if(n.length==o.length){return i.join("")}else if(f!==undefined&&n.length>o.length){return v(i,l,f).join("")}else{break}}else{if(i[l]===c&&a[s].match(/[0-9]/)||i[l]===d&&a[s].match(/[a-zA-Z]/)||i[l]===h&&a[s].match(/[0-9a-zA-Z]/)){i[l]=a[s++]}else if(i[l]===c||i[l]===d||i[l]===h){if(f!==undefined){return v(i,l,f).join("")}else{return i.slice(0,l).join("")}}else if(i[l]===a[s]){s++}}}return i.join("").substr(0,l)};o.toNumber=function(e){return e.toString().replace(/(?!^-)[^0-9]/g,"")};o.toAlphaNumeric=function(e){return e.toString().replace(/[^a-z0-9 ]+/i,"")};return o});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.CodeMirror=t())})(this,function(){"use strict";var e=navigator.userAgent;var t=navigator.platform;var p=/gecko\/\d/i.test(e);var r=/MSIE \d/.test(e);var n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e);var i=/Edge\/(\d+)/.exec(e);var C=r||n||i;var S=C&&(r?document.documentMode||6:+(i||n)[1]);var g=!i&&/WebKit\//.test(e);var a=g&&/Qt\/\d+\.\d+/.test(e);var o=!i&&/Chrome\//.test(e);var m=/Opera\//.test(e);var s=/Apple Computer/.test(navigator.vendor);var l=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e);var u=/PhantomJS/.test(e);var f=!i&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e);var c=/Android/.test(e);var d=f||c||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e);var y=f||/Mac/.test(t);var h=/\bCrOS\b/.test(e);var v=/win/i.test(t);var b=m&&e.match(/Version\/(\d*\.\d*)/);if(b){b=Number(b[1])}if(b&&b>=15){m=false;g=true}var w=y&&(a||m&&(b==null||b<12.11));var E=p||C&&S>=9;function k(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var T=function(e,t){var r=e.className;var n=k(t).exec(r);if(n){var i=r.slice(n.index+n[0].length);e.className=r.slice(0,n.index)+(i?n[1]+i:"")}};function _(e){for(var t=e.childNodes.length;t>0;--t){e.removeChild(e.firstChild)}return e}function x(e,t){return _(e).appendChild(t)}function O(e,t,r,n){var i=document.createElement(e);if(r){i.className=r}if(n){i.style.cssText=n}if(typeof t=="string"){i.appendChild(document.createTextNode(t))}else if(t){for(var a=0;a<t.length;++a){i.appendChild(t[a])}}return i}function D(e,t,r,n){var i=O(e,t,r,n);i.setAttribute("role","presentation");return i}var R;if(document.createRange){R=function(e,t,r,n){var i=document.createRange();i.setEnd(n||e,r);i.setStart(e,t);return i}}else{R=function(e,t,r){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(e){return n}n.collapse(true);n.moveEnd("character",r);n.moveStart("character",t);return n}}function I(e,t){if(t.nodeType==3){t=t.parentNode}if(e.contains){return e.contains(t)}do{if(t.nodeType==11){t=t.host}if(t==e){return true}}while(t=t.parentNode)}function A(){var t;try{t=document.activeElement}catch(e){t=document.body||null}while(t&&t.shadowRoot&&t.shadowRoot.activeElement){t=t.shadowRoot.activeElement}return t}function N(e,t){var r=e.className;if(!k(t).test(r)){e.className+=(r?" ":"")+t}}function M(e,t){var r=e.split(" ");for(var n=0;n<r.length;n++){if(r[n]&&!k(r[n]).test(t)){t+=" "+r[n]}}return t}var L=function(e){e.select()};if(f){L=function(e){e.selectionStart=0;e.selectionEnd=e.value.length}}else if(C){L=function(e){try{e.select()}catch(e){}}}function P(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function F(e,t,r){if(!t){t={}}for(var n in e){if(e.hasOwnProperty(n)&&(r!==false||!t.hasOwnProperty(n))){t[n]=e[n]}}return t}function B(e,t,r,n,i){if(t==null){t=e.search(/[^\s\u00a0]/);if(t==-1){t=e.length}}for(var a=n||0,o=i||0;;){var s=e.indexOf("\t",a);if(s<0||s>=t){return o+(t-a)}o+=s-a;o+=r-o%r;a=s+1}}var H=function(){this.id=null;this.f=null;this.time=0;this.handler=P(this.onTimeout,this)};H.prototype.onTimeout=function(e){e.id=0;if(e.time<=+new Date){e.f()}else{setTimeout(e.handler,e.time-+new Date)}};H.prototype.set=function(e,t){this.f=t;var r=+new Date+e;if(!this.id||r<this.time){clearTimeout(this.id);this.id=setTimeout(this.handler,e);this.time=r}};function $(e,t){for(var r=0;r<e.length;++r){if(e[r]==t){return r}}return-1}var W=30;var U={toString:function(){return"CodeMirror.Pass"}};var j={scroll:false},V={origin:"*mouse"},z={origin:"+move"};function q(e,t,r){for(var n=0,i=0;;){var a=e.indexOf("\t",n);if(a==-1){a=e.length}var o=a-n;if(a==e.length||i+o>=t){return n+Math.min(o,t-i)}i+=a-n;i+=r-i%r;n=a+1;if(i>=t){return n}}}var Y=[""];function G(e){while(Y.length<=e){Y.push(X(Y)+" ")}return Y[e]}function X(e){return e[e.length-1]}function K(e,t){var r=[];for(var n=0;n<e.length;n++){r[n]=t(e[n],n)}return r}function J(e,t,r){var n=0,i=r(t);while(n<e.length&&r(e[n])<=i){n++}e.splice(n,0,t)}function Q(){}function Z(e,t){var r;if(Object.create){r=Object.create(e)}else{Q.prototype=e;r=new Q}if(t){F(t,r)}return r}var ee=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function te(e){return/\w/.test(e)||e>"Â"&&(e.toUpperCase()!=e.toLowerCase()||ee.test(e))}function re(e,t){if(!t){return te(e)}if(t.source.indexOf("\\w")>-1&&te(e)){return true}return t.test(e)}function ne(e){for(var t in e){if(e.hasOwnProperty(t)&&e[t]){return false}}return true}var ie=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ae(e){return e.charCodeAt(0)>=768&&ie.test(e)}function oe(e,t,r){while((r<0?t>0:t<e.length)&&ae(e.charAt(t))){t+=r}return t}function se(e,t,r){var n=t>r?-1:1;for(;;){if(t==r){return t}var i=(t+r)/2,a=n<0?Math.ceil(i):Math.floor(i);if(a==t){return e(a)?t:r}if(e(a)){r=a}else{t=a+n}}}function le(e,t,r,n){if(!e){return n(t,r,"ltr",0)}var i=false;for(var a=0;a<e.length;++a){var o=e[a];if(o.from<r&&o.to>t||t==r&&o.to==t){n(Math.max(o.from,t),Math.min(o.to,r),o.level==1?"rtl":"ltr",a);i=true}}if(!i){n(t,r,"ltr")}}var ue=null;function fe(e,t,r){var n;ue=null;for(var i=0;i<e.length;++i){var a=e[i];if(a.from<t&&a.to>t){return i}if(a.to==t){if(a.from!=a.to&&r=="before"){n=i}else{ue=i}}if(a.from==t){if(a.from!=a.to&&r!="before"){n=i}else{ue=i}}}return n!=null?n:ue}var ce=function(){var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var r="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function F(e){if(e<=247){return t.charAt(e)}else if(1424<=e&&e<=1524){return"R"}else if(1536<=e&&e<=1785){return r.charAt(e-1536)}else if(1774<=e&&e<=2220){return"r"}else if(8192<=e&&e<=8203){return"w"}else if(e==8204){return"b"}else{return"L"}}var B=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var H=/[stwN]/,$=/[LRr]/,W=/[Lb1n]/,U=/[1n]/;function j(e,t,r){this.level=e;this.from=t;this.to=r}return function(e,t){var r=t=="ltr"?"L":"R";if(e.length==0||t=="ltr"&&!B.test(e)){return false}var n=e.length,i=[];for(var a=0;a<n;++a){i.push(F(e.charCodeAt(a)))}for(var o=0,s=r;o<n;++o){var l=i[o];if(l=="m"){i[o]=s}else{s=l}}for(var u=0,f=r;u<n;++u){var c=i[u];if(c=="1"&&f=="r"){i[u]="n"}else if($.test(c)){f=c;if(c=="r"){i[u]="R"}}}for(var d=1,h=i[0];d<n-1;++d){var v=i[d];if(v=="+"&&h=="1"&&i[d+1]=="1"){i[d]="1"}else if(v==","&&h==i[d+1]&&(h=="1"||h=="n")){i[d]=h}h=v}for(var p=0;p<n;++p){var g=i[p];if(g==","){i[p]="N"}else if(g=="%"){var m=void 0;for(m=p+1;m<n&&i[m]=="%";++m){}var y=p&&i[p-1]=="!"||m<n&&i[m]=="1"?"1":"N";for(var b=p;b<m;++b){i[b]=y}p=m-1}}for(var w=0,C=r;w<n;++w){var S=i[w];if(C=="L"&&S=="1"){i[w]="L"}else if($.test(S)){C=S}}for(var E=0;E<n;++E){if(H.test(i[E])){var k=void 0;for(k=E+1;k<n&&H.test(i[k]);++k){}var T=(E?i[E-1]:r)=="L";var _=(k<n?i[k]:r)=="L";var x=T==_?T?"L":"R":r;for(var D=E;D<k;++D){i[D]=x}E=k-1}}var R=[],I;for(var O=0;O<n;){if(W.test(i[O])){var A=O;for(++O;O<n&&W.test(i[O]);++O){}R.push(new j(0,A,O))}else{var N=O,M=R.length;for(++O;O<n&&i[O]!="L";++O){}for(var L=N;L<O;){if(U.test(i[L])){if(N<L){R.splice(M,0,new j(1,N,L))}var P=L;for(++L;L<O&&U.test(i[L]);++L){}R.splice(M,0,new j(2,P,L));N=L}else{++L}}if(N<O){R.splice(M,0,new j(1,N,O))}}}if(t=="ltr"){if(R[0].level==1&&(I=e.match(/^\s+/))){R[0].from=I[0].length;R.unshift(new j(0,0,I[0].length))}if(X(R).level==1&&(I=e.match(/\s+$/))){X(R).to-=I[0].length;R.push(new j(0,n-I[0].length,n))}}return t=="rtl"?R.reverse():R}}();function de(e,t){var r=e.order;if(r==null){r=e.order=ce(e.text,t)}return r}var he=[];var ve=function(e,t,r){if(e.addEventListener){e.addEventListener(t,r,false)}else if(e.attachEvent){e.attachEvent("on"+t,r)}else{var n=e._handlers||(e._handlers={});n[t]=(n[t]||he).concat(r)}};function pe(e,t){return e._handlers&&e._handlers[t]||he}function ge(e,t,r){if(e.removeEventListener){e.removeEventListener(t,r,false)}else if(e.detachEvent){e.detachEvent("on"+t,r)}else{var n=e._handlers,i=n&&n[t];if(i){var a=$(i,r);if(a>-1){n[t]=i.slice(0,a).concat(i.slice(a+1))}}}}function me(e,t){var r=pe(e,t);if(!r.length){return}var n=Array.prototype.slice.call(arguments,2);for(var i=0;i<r.length;++i){r[i].apply(null,n)}}function ye(e,t,r){if(typeof t=="string"){t={type:t,preventDefault:function(){this.defaultPrevented=true}}}me(e,r||t.type,e,t);return ke(t)||t.codemirrorIgnore}function be(e){var t=e._handlers&&e._handlers.cursorActivity;if(!t){return}var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]);for(var n=0;n<t.length;++n){if($(r,t[n])==-1){r.push(t[n])}}}function we(e,t){return pe(e,t).length>0}function Ce(e){e.prototype.on=function(e,t){ve(this,e,t)};e.prototype.off=function(e,t){ge(this,e,t)}}function Se(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}function Ee(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}}function ke(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==false}function Te(e){Se(e);Ee(e)}function _e(e){return e.target||e.srcElement}function xe(e){var t=e.which;if(t==null){if(e.button&1){t=1}else if(e.button&2){t=3}else if(e.button&4){t=2}}if(y&&e.ctrlKey&&t==1){t=3}return t}var De=function(){if(C&&S<9){return false}var e=O("div");return"draggable"in e||"dragDrop"in e}();var Re;function Ie(e){if(Re==null){var t=O("span","â");x(e,O("span",[t,document.createTextNode("x")]));if(e.firstChild.offsetHeight!=0){Re=t.offsetWidth<=1&&t.offsetHeight>2&&!(C&&S<8)}}var r=Re?O("span","â"):O("span","Â ",null,"display: inline-block; width: 1px; margin-right: -1px");r.setAttribute("cm-text","");return r}var Oe;function Ae(e){if(Oe!=null){return Oe}var t=x(e,document.createTextNode("AØ®A"));var r=R(t,0,1).getBoundingClientRect();var n=R(t,1,2).getBoundingClientRect();_(e);if(!r||r.left==r.right){return false}return Oe=n.right-r.right<3}var Ne="\n\nb".split(/\n/).length!=3?function(e){var t=0,r=[],n=e.length;while(t<=n){var i=e.indexOf("\n",t);if(i==-1){i=e.length}var a=e.slice(t,e.charAt(i-1)=="\r"?i-1:i);var o=a.indexOf("\r");if(o!=-1){r.push(a.slice(0,o));t+=o+1}else{r.push(a);t=i+1}}return r}:function(e){return e.split(/\r\n?|\n/)};var Me=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return false}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}if(!t||t.parentElement()!=e){return false}return t.compareEndPoints("StartToEnd",t)!=0};var Le=function(){var e=O("div");if("oncopy"in e){return true}e.setAttribute("oncopy","return;");return typeof e.oncopy=="function"}();var Pe=null;function Fe(e){if(Pe!=null){return Pe}var t=x(e,O("span","x"));var r=t.getBoundingClientRect();var n=R(t,0,1).getBoundingClientRect();return Pe=Math.abs(r.left-n.left)>1}var Be={},He={};function $e(e,t){if(arguments.length>2){t.dependencies=Array.prototype.slice.call(arguments,2)}Be[e]=t}function We(e,t){He[e]=t}function Ue(e){if(typeof e=="string"&&He.hasOwnProperty(e)){e=He[e]}else if(e&&typeof e.name=="string"&&He.hasOwnProperty(e.name)){var t=He[e.name];if(typeof t=="string"){t={name:t}}e=Z(t,e);e.name=t.name}else if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e)){return Ue("application/xml")}else if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e)){return Ue("application/json")}if(typeof e=="string"){return{name:e}}else{return e||{name:"null"}}}function je(e,t){t=Ue(t);var r=Be[t.name];if(!r){return je(e,"text/plain")}var n=r(e,t);if(Ve.hasOwnProperty(t.name)){var i=Ve[t.name];for(var a in i){if(!i.hasOwnProperty(a)){continue}if(n.hasOwnProperty(a)){n["_"+a]=n[a]}n[a]=i[a]}}n.name=t.name;if(t.helperType){n.helperType=t.helperType}if(t.modeProps){for(var o in t.modeProps){n[o]=t.modeProps[o]}}return n}var Ve={};function ze(e,t){var r=Ve.hasOwnProperty(e)?Ve[e]:Ve[e]={};F(t,r)}function qe(e,t){if(t===true){return t}if(e.copyState){return e.copyState(t)}var r={};for(var n in t){var i=t[n];if(i instanceof Array){i=i.concat([])}r[n]=i}return r}function Ye(e,t){var r;while(e.innerMode){r=e.innerMode(t);if(!r||r.mode==e){break}t=r.state;e=r.mode}return r||{mode:e,state:t}}function Ge(e,t,r){return e.startState?e.startState(t,r):true}var Xe=function(e,t,r){this.pos=this.start=0;this.string=e;this.tabSize=t||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;this.lineOracle=r};Xe.prototype.eol=function(){return this.pos>=this.string.length};Xe.prototype.sol=function(){return this.pos==this.lineStart};Xe.prototype.peek=function(){return this.string.charAt(this.pos)||undefined};Xe.prototype.next=function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}};Xe.prototype.eat=function(e){var t=this.string.charAt(this.pos);var r;if(typeof e=="string"){r=t==e}else{r=t&&(e.test?e.test(t):e(t))}if(r){++this.pos;return t}};Xe.prototype.eatWhile=function(e){var t=this.pos;while(this.eat(e)){}return this.pos>t};Xe.prototype.eatSpace=function(){var e=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>e};Xe.prototype.skipToEnd=function(){this.pos=this.string.length};Xe.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1){this.pos=t;return true}};Xe.prototype.backUp=function(e){this.pos-=e};Xe.prototype.column=function(){if(this.lastColumnPos<this.start){this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)};Xe.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)};Xe.prototype.match=function(e,t,r){if(typeof e=="string"){var n=function(e){return r?e.toLowerCase():e};var i=this.string.substr(this.pos,e.length);if(n(i)==n(e)){if(t!==false){this.pos+=e.length}return true}}else{var a=this.string.slice(this.pos).match(e);if(a&&a.index>0){return null}if(a&&t!==false){this.pos+=a[0].length}return a}};Xe.prototype.current=function(){return this.string.slice(this.start,this.pos)};Xe.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}};Xe.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)};Xe.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function Ke(e,t){t-=e.first;if(t<0||t>=e.size){throw new Error("There is no line "+(t+e.first)+" in the document.")}var r=e;while(!r.lines){for(var n=0;;++n){var i=r.children[n],a=i.chunkSize();if(t<a){r=i;break}t-=a}}return r.lines[t]}function Je(e,r,n){var i=[],a=r.line;e.iter(r.line,n.line+1,function(e){var t=e.text;if(a==n.line){t=t.slice(0,n.ch)}if(a==r.line){t=t.slice(r.ch)}i.push(t);++a});return i}function Qe(e,t,r){var n=[];e.iter(t,r,function(e){n.push(e.text)});return n}function Ze(e,t){var r=t-e.height;if(r){for(var n=e;n;n=n.parent){n.height+=r}}}function et(e){if(e.parent==null){return null}var t=e.parent,r=$(t.lines,e);for(var n=t.parent;n;t=n,n=n.parent){for(var i=0;;++i){if(n.children[i]==t){break}r+=n.children[i].chunkSize()}}return r+t.first}function tt(e,t){var r=e.first;e:do{for(var n=0;n<e.children.length;++n){var i=e.children[n],a=i.height;if(t<a){e=i;continue e}t-=a;r+=i.chunkSize()}return r}while(!e.lines);var o=0;for(;o<e.lines.length;++o){var s=e.lines[o],l=s.height;if(t<l){break}t-=l}return r+o}function rt(e,t){return t>=e.first&&t<e.first+e.size}function nt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function it(e,t,r){if(r===void 0)r=null;if(!(this instanceof it)){return new it(e,t,r)}this.line=e;this.ch=t;this.sticky=r}function at(e,t){return e.line-t.line||e.ch-t.ch}function ot(e,t){return e.sticky==t.sticky&&at(e,t)==0}function st(e){return it(e.line,e.ch)}function lt(e,t){return at(e,t)<0?t:e}function ut(e,t){return at(e,t)<0?e:t}function ft(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function ct(e,t){if(t.line<e.first){return it(e.first,0)}var r=e.first+e.size-1;if(t.line>r){return it(r,Ke(e,r).text.length)}return dt(t,Ke(e,t.line).text.length)}function dt(e,t){var r=e.ch;if(r==null||r>t){return it(e.line,t)}else if(r<0){return it(e.line,0)}else{return e}}function ht(e,t){var r=[];for(var n=0;n<t.length;n++){r[n]=ct(e,t[n])}return r}var vt=function(e,t){this.state=e;this.lookAhead=t};var pt=function(e,t,r,n){this.state=t;this.doc=e;this.line=r;this.maxLookAhead=n||0;this.baseTokens=null;this.baseTokenPos=1};pt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);if(t!=null&&e>this.maxLookAhead){this.maxLookAhead=e}return t};pt.prototype.baseToken=function(e){if(!this.baseTokens){return null}while(this.baseTokens[this.baseTokenPos]<=e){this.baseTokenPos+=2}var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}};pt.prototype.nextLine=function(){this.line++;if(this.maxLookAhead>0){this.maxLookAhead--}};pt.fromSaved=function(e,t,r){if(t instanceof vt){return new pt(e,qe(e.mode,t.state),r,t.lookAhead)}else{return new pt(e,qe(e.mode,t),r)}};pt.prototype.save=function(e){var t=e!==false?qe(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new vt(t,this.maxLookAhead):t};function gt(t,r,n,e){var l=[t.state.modeGen],i={};Tt(t,r.text,t.doc.mode,n,function(e,t){return l.push(e,t)},i,e);var u=n.state;var a=function(e){n.baseTokens=l;var a=t.state.overlays[e],o=1,s=0;n.state=true;Tt(t,r.text,a.mode,n,function(e,t){var r=o;while(s<e){var n=l[o];if(n>e){l.splice(o,1,e,l[o+1],n)}o+=2;s=Math.min(e,n)}if(!t){return}if(a.opaque){l.splice(r,o-r,e,"overlay "+t);o=r+2}else{for(;r<o;r+=2){var i=l[r+1];l[r+1]=(i?i+" ":"")+"overlay "+t}}},i);n.state=u;n.baseTokens=null;n.baseTokenPos=1};for(var o=0;o<t.state.overlays.length;++o)a(o);return{styles:l,classes:i.bgClass||i.textClass?i:null}}function mt(e,t,r){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=yt(e,et(t));var i=t.text.length>e.options.maxHighlightLength&&qe(e.doc.mode,n.state);var a=gt(e,t,n);if(i){n.state=i}t.stateAfter=n.save(!i);t.styles=a.styles;if(a.classes){t.styleClasses=a.classes}else if(t.styleClasses){t.styleClasses=null}if(r===e.doc.highlightFrontier){e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier)}}return t.styles}function yt(r,n,e){var t=r.doc,i=r.display;if(!t.mode.startState){return new pt(t,true,n)}var a=_t(r,n,e);var o=a>t.first&&Ke(t,a-1).stateAfter;var s=o?pt.fromSaved(t,o,a):new pt(t,Ge(t.mode),a);t.iter(a,n,function(e){bt(r,e.text,s);var t=s.line;e.stateAfter=t==n-1||t%5==0||t>=i.viewFrom&&t<i.viewTo?s.save():null;s.nextLine()});if(e){t.modeFrontier=s.line}return s}function bt(e,t,r,n){var i=e.doc.mode;var a=new Xe(t,e.options.tabSize,r);a.start=a.pos=n||0;if(t==""){wt(i,r.state)}while(!a.eol()){Ct(i,a,r.state);a.start=a.pos}}function wt(e,t){if(e.blankLine){return e.blankLine(t)}if(!e.innerMode){return}var r=Ye(e,t);if(r.mode.blankLine){return r.mode.blankLine(r.state)}}function Ct(e,t,r,n){for(var i=0;i<10;i++){if(n){n[0]=Ye(e,r).mode}var a=e.token(t,r);if(t.pos>t.start){return a}}throw new Error("Mode "+e.name+" failed to advance stream.")}var St=function(e,t,r){this.start=e.start;this.end=e.pos;this.string=e.current();this.type=t||null;this.state=r};function Et(e,t,r,n){var i=e.doc,a=i.mode,o;t=ct(i,t);var s=Ke(i,t.line),l=yt(e,t.line,r);var u=new Xe(s.text,e.options.tabSize,l),f;if(n){f=[]}while((n||u.pos<t.ch)&&!u.eol()){u.start=u.pos;o=Ct(a,u,l.state);if(n){f.push(new St(u,o,qe(i.mode,l.state)))}}return n?f:new St(u,o,l.state)}function kt(e,t){if(e){for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r){break}e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var n=r[1]?"bgClass":"textClass";if(t[n]==null){t[n]=r[2]}else if(!new RegExp("(?:^|s)"+r[2]+"(?:$|s)").test(t[n])){t[n]+=" "+r[2]}}}return e}function Tt(e,t,r,n,i,a,o){var s=r.flattenSpans;if(s==null){s=e.options.flattenSpans}var l=0,u=null;var f=new Xe(t,e.options.tabSize,n),c;var d=e.options.addModeClass&&[null];if(t==""){kt(wt(r,n.state),a)}while(!f.eol()){if(f.pos>e.options.maxHighlightLength){s=false;if(o){bt(e,t,n,f.pos)}f.pos=t.length;c=null}else{c=kt(Ct(r,f,n.state,d),a)}if(d){var h=d[0].name;if(h){c="m-"+(c?h+" "+c:h)}}if(!s||u!=c){while(l<f.start){l=Math.min(f.start,l+5e3);i(l,u)}u=c}f.start=f.pos}while(l<f.pos){var v=Math.min(f.pos,l+5e3);i(v,u);l=v}}function _t(e,t,r){var n,i,a=e.doc;var o=r?-1:t-(e.doc.mode.innerMode?1e3:100);for(var s=t;s>o;--s){if(s<=a.first){return a.first}var l=Ke(a,s-1),u=l.stateAfter;if(u&&(!r||s+(u instanceof vt?u.lookAhead:0)<=a.modeFrontier)){return s}var f=B(l.text,null,e.options.tabSize);if(i==null||n>f){i=s-1;n=f}}return i}function xt(e,t){e.modeFrontier=Math.min(e.modeFrontier,t);if(e.highlightFrontier<t-10){return}var r=e.first;for(var n=t-1;n>r;n--){var i=Ke(e,n).stateAfter;if(i&&(!(i instanceof vt)||n+i.lookAhead<t)){r=n+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,r)}var Dt=false,Rt=false;function It(){Dt=true}function Ot(){Rt=true}function At(e,t,r){this.marker=e;this.from=t;this.to=r}function Nt(e,t){if(e){for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t){return n}}}}function Mt(e,t){var r;for(var n=0;n<e.length;++n){if(e[n]!=t){(r||(r=[])).push(e[n])}}return r}function Lt(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t];t.marker.attachLine(e)}function Pt(e,t,r){var n;if(e){for(var i=0;i<e.length;++i){var a=e[i],o=a.marker;var s=a.from==null||(o.inclusiveLeft?a.from<=t:a.from<t);if(s||a.from==t&&o.type=="bookmark"&&(!r||!a.marker.insertLeft)){var l=a.to==null||(o.inclusiveRight?a.to>=t:a.to>t);(n||(n=[])).push(new At(o,a.from,l?null:a.to))}}}return n}function Ft(e,t,r){var n;if(e){for(var i=0;i<e.length;++i){var a=e[i],o=a.marker;var s=a.to==null||(o.inclusiveRight?a.to>=t:a.to>t);if(s||a.from==t&&o.type=="bookmark"&&(!r||a.marker.insertLeft)){var l=a.from==null||(o.inclusiveLeft?a.from<=t:a.from<t);(n||(n=[])).push(new At(o,l?null:a.from-t,a.to==null?null:a.to-t))}}}return n}function Bt(e,t){if(t.full){return null}var r=rt(e,t.from.line)&&Ke(e,t.from.line).markedSpans;var n=rt(e,t.to.line)&&Ke(e,t.to.line).markedSpans;if(!r&&!n){return null}var i=t.from.ch,a=t.to.ch,o=at(t.from,t.to)==0;var s=Pt(r,i,o);var l=Ft(n,a,o);var u=t.text.length==1,f=X(t.text).length+(u?i:0);if(s){for(var c=0;c<s.length;++c){var d=s[c];if(d.to==null){var h=Nt(l,d.marker);if(!h){d.to=i}else if(u){d.to=h.to==null?null:h.to+f}}}}if(l){for(var v=0;v<l.length;++v){var p=l[v];if(p.to!=null){p.to+=f}if(p.from==null){var g=Nt(s,p.marker);if(!g){p.from=f;if(u){(s||(s=[])).push(p)}}}else{p.from+=f;if(u){(s||(s=[])).push(p)}}}}if(s){s=Ht(s)}if(l&&l!=s){l=Ht(l)}var m=[s];if(!u){var y=t.text.length-2,b;if(y>0&&s){for(var w=0;w<s.length;++w){if(s[w].to==null){(b||(b=[])).push(new At(s[w].marker,null,null))}}}for(var C=0;C<y;++C){m.push(b)}m.push(l)}return m}function Ht(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.from!=null&&r.from==r.to&&r.marker.clearWhenEmpty!==false){e.splice(t--,1)}}if(!e.length){return null}return e}function $t(e,t,r){var n=null;e.iter(t.line,r.line+1,function(e){if(e.markedSpans){for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;if(r.readOnly&&(!n||$(n,r)==-1)){(n||(n=[])).push(r)}}}});if(!n){return null}var i=[{from:t,to:r}];for(var a=0;a<n.length;++a){var o=n[a],s=o.find(0);for(var l=0;l<i.length;++l){var u=i[l];if(at(u.to,s.from)<0||at(u.from,s.to)>0){continue}var f=[l,1],c=at(u.from,s.from),d=at(u.to,s.to);if(c<0||!o.inclusiveLeft&&!c){f.push({from:u.from,to:s.from})}if(d>0||!o.inclusiveRight&&!d){f.push({from:s.to,to:u.to})}i.splice.apply(i,f);l+=f.length-3}}return i}function Wt(e){var t=e.markedSpans;if(!t){return}for(var r=0;r<t.length;++r){t[r].marker.detachLine(e)}e.markedSpans=null}function Ut(e,t){if(!t){return}for(var r=0;r<t.length;++r){t[r].marker.attachLine(e)}e.markedSpans=t}function jt(e){return e.inclusiveLeft?-1:0}function Vt(e){return e.inclusiveRight?1:0}function zt(e,t){var r=e.lines.length-t.lines.length;if(r!=0){return r}var n=e.find(),i=t.find();var a=at(n.from,i.from)||jt(e)-jt(t);if(a){return-a}var o=at(n.to,i.to)||Vt(e)-Vt(t);if(o){return o}return t.id-e.id}function qt(e,t){var r=Rt&&e.markedSpans,n;if(r){for(var i=void 0,a=0;a<r.length;++a){i=r[a];if(i.marker.collapsed&&(t?i.from:i.to)==null&&(!n||zt(n,i.marker)<0)){n=i.marker}}}return n}function Yt(e){return qt(e,true)}function Gt(e){return qt(e,false)}function Xt(e,t){var r=Rt&&e.markedSpans,n;if(r){for(var i=0;i<r.length;++i){var a=r[i];if(a.marker.collapsed&&(a.from==null||a.from<t)&&(a.to==null||a.to>t)&&(!n||zt(n,a.marker)<0)){n=a.marker}}}return n}function Kt(e,t,r,n,i){var a=Ke(e,t);var o=Rt&&a.markedSpans;if(o){for(var s=0;s<o.length;++s){var l=o[s];if(!l.marker.collapsed){continue}var u=l.marker.find(0);var f=at(u.from,r)||jt(l.marker)-jt(i);var c=at(u.to,n)||Vt(l.marker)-Vt(i);if(f>=0&&c<=0||f<=0&&c>=0){continue}if(f<=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?at(u.to,r)>=0:at(u.to,r)>0)||f>=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?at(u.from,n)<=0:at(u.from,n)<0)){return true}}}}function Jt(e){var t;while(t=Yt(e)){e=t.find(-1,true).line}return e}function Qt(e){var t;while(t=Gt(e)){e=t.find(1,true).line}return e}function Zt(e){var t,r;while(t=Gt(e)){e=t.find(1,true).line;(r||(r=[])).push(e)}return r}function er(e,t){var r=Ke(e,t),n=Jt(r);if(r==n){return t}return et(n)}function tr(e,t){if(t>e.lastLine()){return t}var r=Ke(e,t),n;if(!rr(e,r)){return t}while(n=Gt(r)){r=n.find(1,true).line}return et(r)+1}function rr(e,t){var r=Rt&&t.markedSpans;if(r){for(var n=void 0,i=0;i<r.length;++i){n=r[i];if(!n.marker.collapsed){continue}if(n.from==null){return true}if(n.marker.widgetNode){continue}if(n.from==0&&n.marker.inclusiveLeft&&nr(e,t,n)){return true}}}}function nr(e,t,r){if(r.to==null){var n=r.marker.find(1,true);return nr(e,n.line,Nt(n.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==t.text.length){return true}for(var i=void 0,a=0;a<t.markedSpans.length;++a){i=t.markedSpans[a];if(i.marker.collapsed&&!i.marker.widgetNode&&i.from==r.to&&(i.to==null||i.to!=r.from)&&(i.marker.inclusiveLeft||r.marker.inclusiveRight)&&nr(e,t,i)){return true}}}function ir(e){e=Jt(e);var t=0,r=e.parent;for(var n=0;n<r.lines.length;++n){var i=r.lines[n];if(i==e){break}else{t+=i.height}}for(var a=r.parent;a;r=a,a=r.parent){for(var o=0;o<a.children.length;++o){var s=a.children[o];if(s==r){break}else{t+=s.height}}}return t}function ar(e){if(e.height==0){return 0}var t=e.text.length,r,n=e;while(r=Yt(n)){var i=r.find(0,true);n=i.from.line;t+=i.from.ch-i.to.ch}n=e;while(r=Gt(n)){var a=r.find(0,true);t-=n.text.length-a.from.ch;n=a.to.line;t+=n.text.length-a.to.ch}return t}function or(e){var r=e.display,t=e.doc;r.maxLine=Ke(t,t.first);r.maxLineLength=ar(r.maxLine);r.maxLineChanged=true;t.iter(function(e){var t=ar(e);if(t>r.maxLineLength){r.maxLineLength=t;r.maxLine=e}})}var sr=function(e,t,r){this.text=e;Ut(this,t);this.height=r?r(this):1};sr.prototype.lineNo=function(){return et(this)};Ce(sr);function lr(e,t,r,n){e.text=t;if(e.stateAfter){e.stateAfter=null}if(e.styles){e.styles=null}if(e.order!=null){e.order=null}Wt(e);Ut(e,r);var i=n?n(e):1;if(i!=e.height){Ze(e,i)}}function ur(e){e.parent=null;Wt(e)}var fr={},cr={};function dr(e,t){if(!e||/^\s*$/.test(e)){return null}var r=t.addModeClass?cr:fr;return r[e]||(r[e]=e.replace(/\S+/g,"cm-$&"))}function hr(e,t){var r=D("span",null,null,g?"padding-right: .1px":null);var n={pre:D("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,trailingSpace:false,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var a=i?t.rest[i-1]:t.line,o=void 0;n.pos=0;n.addToken=pr;if(Ae(e.display.measure)&&(o=de(a,e.doc.direction))){n.addToken=mr(n.addToken,o)}n.map=[];var s=t!=e.display.externalMeasured&&et(a);br(a,n,mt(e,a,s));if(a.styleClasses){if(a.styleClasses.bgClass){n.bgClass=M(a.styleClasses.bgClass,n.bgClass||"")}if(a.styleClasses.textClass){n.textClass=M(a.styleClasses.textClass,n.textClass||"")}}if(n.map.length==0){n.map.push(0,0,n.content.appendChild(Ie(e.display.measure)))}if(i==0){t.measure.map=n.map;t.measure.cache={}}else{(t.measure.maps||(t.measure.maps=[])).push(n.map);(t.measure.caches||(t.measure.caches=[])).push({})}}if(g){var l=n.content.lastChild;if(/\bcm-tab\b/.test(l.className)||l.querySelector&&l.querySelector(".cm-tab")){n.content.className="cm-tab-wrap-hack"}}me(e,"renderLine",e,t.line,n.pre);if(n.pre.className){n.textClass=M(n.pre.className,n.textClass||"")}return n}function vr(e){var t=O("span","â¢","cm-invalidchar");t.title="\\u"+e.charCodeAt(0).toString(16);t.setAttribute("aria-label",t.title);return t}function pr(e,t,r,n,i,a,o){if(!t){return}var s=e.splitSpaces?gr(t,e.trailingSpace):t;var l=e.cm.state.specialChars,u=false;var f;if(!l.test(t)){e.col+=t.length;f=document.createTextNode(s);e.map.push(e.pos,e.pos+t.length,f);if(C&&S<9){u=true}e.pos+=t.length}else{f=document.createDocumentFragment();var c=0;while(true){l.lastIndex=c;var d=l.exec(t);var h=d?d.index-c:t.length-c;if(h){var v=document.createTextNode(s.slice(c,c+h));if(C&&S<9){f.appendChild(O("span",[v]))}else{f.appendChild(v)}e.map.push(e.pos,e.pos+h,v);e.col+=h;e.pos+=h}if(!d){break}c+=h+1;var p=void 0;if(d[0]=="\t"){var g=e.cm.options.tabSize,m=g-e.col%g;p=f.appendChild(O("span",G(m),"cm-tab"));p.setAttribute("role","presentation");p.setAttribute("cm-text","\t");e.col+=m}else if(d[0]=="\r"||d[0]=="\n"){p=f.appendChild(O("span",d[0]=="\r"?"â":"â¤","cm-invalidchar"));p.setAttribute("cm-text",d[0]);e.col+=1}else{p=e.cm.options.specialCharPlaceholder(d[0]);p.setAttribute("cm-text",d[0]);if(C&&S<9){f.appendChild(O("span",[p]))}else{f.appendChild(p)}e.col+=1}e.map.push(e.pos,e.pos+1,p);e.pos++}}e.trailingSpace=s.charCodeAt(t.length-1)==32;if(r||n||i||u||a){var y=r||"";if(n){y+=n}if(i){y+=i}var b=O("span",[f],y,a);if(o){for(var w in o){if(o.hasOwnProperty(w)&&w!="style"&&w!="class"){b.setAttribute(w,o[w])}}}return e.content.appendChild(b)}e.content.appendChild(f)}function gr(e,t){if(e.length>1&&!/  /.test(e)){return e}var r=t,n="";for(var i=0;i<e.length;i++){var a=e.charAt(i);if(a==" "&&r&&(i==e.length-1||e.charCodeAt(i+1)==32)){a="Â "}n+=a;r=a==" "}return n}function mr(c,d){return function(e,t,r,n,i,a,o){r=r?r+" cm-force-border":"cm-force-border";var s=e.pos,l=s+t.length;for(;;){var u=void 0;for(var f=0;f<d.length;f++){u=d[f];if(u.to>s&&u.from<=s){break}}if(u.to>=l){return c(e,t,r,n,i,a,o)}c(e,t.slice(0,u.to-s),r,n,null,a,o);n=null;t=t.slice(u.to-s);s=u.to}}}function yr(e,t,r,n){var i=!n&&r.widgetNode;if(i){e.map.push(e.pos,e.pos+t,i)}if(!n&&e.cm.display.input.needsContentAttribute){if(!i){i=e.content.appendChild(document.createElement("span"))}i.setAttribute("cm-marker",r.id)}if(i){e.cm.display.input.setUneditable(i);e.content.appendChild(i)}e.pos+=t;e.trailingSpace=false}function br(e,t,r){var n=e.markedSpans,i=e.text,a=0;if(!n){for(var o=1;o<r.length;o+=2){t.addToken(t,i.slice(a,a=r[o]),dr(r[o+1],t.cm.options))}return}var s=i.length,l=0,u=1,f="",c,d;var h=0,v,p,g,m,y;for(;;){if(h==l){v=p=g=d="";y=null;m=null;h=Infinity;var b=[],w=void 0;for(var C=0;C<n.length;++C){var S=n[C],E=S.marker;if(E.type=="bookmark"&&S.from==l&&E.widgetNode){b.push(E)}else if(S.from<=l&&(S.to==null||S.to>l||E.collapsed&&S.to==l&&S.from==l)){if(S.to!=null&&S.to!=l&&h>S.to){h=S.to;p=""}if(E.className){v+=" "+E.className}if(E.css){d=(d?d+";":"")+E.css}if(E.startStyle&&S.from==l){g+=" "+E.startStyle}if(E.endStyle&&S.to==h){(w||(w=[])).push(E.endStyle,S.to)}if(E.title){(y||(y={})).title=E.title}if(E.attributes){for(var k in E.attributes){(y||(y={}))[k]=E.attributes[k]}}if(E.collapsed&&(!m||zt(m.marker,E)<0)){m=S}}else if(S.from>l&&h>S.from){h=S.from}}if(w){for(var T=0;T<w.length;T+=2){if(w[T+1]==h){p+=" "+w[T]}}}if(!m||m.from==l){for(var _=0;_<b.length;++_){yr(t,0,b[_])}}if(m&&(m.from||0)==l){yr(t,(m.to==null?s+1:m.to)-l,m.marker,m.from==null);if(m.to==null){return}if(m.to==l){m=false}}}if(l>=s){break}var x=Math.min(s,h);while(true){if(f){var D=l+f.length;if(!m){var R=D>x?f.slice(0,x-l):f;t.addToken(t,R,c?c+v:v,g,l+R.length==h?p:"",d,y)}if(D>=x){f=f.slice(x-l);l=x;break}l=D;g=""}f=i.slice(a,a=r[u++]);c=dr(r[u++],t.cm.options)}}}function wr(e,t,r){this.line=t;this.rest=Zt(t);this.size=this.rest?et(X(this.rest))-r+1:1;this.node=this.text=null;this.hidden=rr(e,t)}function Cr(e,t,r){var n=[],i;for(var a=t;a<r;a=i){var o=new wr(e.doc,Ke(e.doc,a),a);i=a+o.size;n.push(o)}return n}var Sr=null;function Er(e){if(Sr){Sr.ops.push(e)}else{e.ownsGroup=Sr={ops:[e],delayedCallbacks:[]}}}function kr(e){var t=e.delayedCallbacks,r=0;do{for(;r<t.length;r++){t[r].call(null)}for(var n=0;n<e.ops.length;n++){var i=e.ops[n];if(i.cursorActivityHandlers){while(i.cursorActivityCalled<i.cursorActivityHandlers.length){i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}}}while(r<t.length)}function Tr(e,t){var r=e.ownsGroup;if(!r){return}try{kr(r)}finally{Sr=null;t(r)}}var _r=null;function xr(e,t){var r=pe(e,t);if(!r.length){return}var n=Array.prototype.slice.call(arguments,2),i;if(Sr){i=Sr.delayedCallbacks}else if(_r){i=_r}else{i=_r=[];setTimeout(Dr,0)}var a=function(e){i.push(function(){return r[e].apply(null,n)})};for(var o=0;o<r.length;++o)a(o)}function Dr(){var e=_r;_r=null;for(var t=0;t<e.length;++t){e[t]()}}function Rr(e,t,r,n){for(var i=0;i<t.changes.length;i++){var a=t.changes[i];if(a=="text"){Nr(e,t)}else if(a=="gutter"){Lr(e,t,r,n)}else if(a=="class"){Mr(e,t)}else if(a=="widget"){Pr(e,t,n)}}t.changes=null}function Ir(e){if(e.node==e.text){e.node=O("div",null,null,"position: relative");if(e.text.parentNode){e.text.parentNode.replaceChild(e.node,e.text)}e.node.appendChild(e.text);if(C&&S<8){e.node.style.zIndex=2}}return e.node}function Or(e,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(r){r+=" CodeMirror-linebackground"}if(t.background){if(r){t.background.className=r}else{t.background.parentNode.removeChild(t.background);t.background=null}}else if(r){var n=Ir(t);t.background=n.insertBefore(O("div",null,r),n.firstChild);e.display.input.setUneditable(t.background)}}function Ar(e,t){var r=e.display.externalMeasured;if(r&&r.line==t.line){e.display.externalMeasured=null;t.measure=r.measure;return r.built}return hr(e,t)}function Nr(e,t){var r=t.text.className;var n=Ar(e,t);if(t.text==t.node){t.node=n.pre}t.text.parentNode.replaceChild(n.pre,t.text);t.text=n.pre;if(n.bgClass!=t.bgClass||n.textClass!=t.textClass){t.bgClass=n.bgClass;t.textClass=n.textClass;Mr(e,t)}else if(r){t.text.className=r}}function Mr(e,t){Or(e,t);if(t.line.wrapClass){Ir(t).className=t.line.wrapClass}else if(t.node!=t.text){t.node.className=""}var r=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=r||""}function Lr(e,t,r,n){if(t.gutter){t.node.removeChild(t.gutter);t.gutter=null}if(t.gutterBackground){t.node.removeChild(t.gutterBackground);t.gutterBackground=null}if(t.line.gutterClass){var i=Ir(t);t.gutterBackground=O("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px");e.display.input.setUneditable(t.gutterBackground);i.insertBefore(t.gutterBackground,t.text)}var a=t.line.gutterMarkers;if(e.options.lineNumbers||a){var o=Ir(t);var s=t.gutter=O("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");e.display.input.setUneditable(s);o.insertBefore(s,t.text);if(t.line.gutterClass){s.className+=" "+t.line.gutterClass}if(e.options.lineNumbers&&(!a||!a["CodeMirror-linenumbers"])){t.lineNumber=s.appendChild(O("div",nt(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))}if(a){for(var l=0;l<e.display.gutterSpecs.length;++l){var u=e.display.gutterSpecs[l].className,f=a.hasOwnProperty(u)&&a[u];if(f){s.appendChild(O("div",[f],"CodeMirror-gutter-elt","left: "+n.gutterLeft[u]+"px; width: "+n.gutterWidth[u]+"px"))}}}}}function Pr(e,t,r){if(t.alignable){t.alignable=null}var n=k("CodeMirror-linewidget");for(var i=t.node.firstChild,a=void 0;i;i=a){a=i.nextSibling;if(n.test(i.className)){t.node.removeChild(i)}}Br(e,t,r)}function Fr(e,t,r,n){var i=Ar(e,t);t.text=t.node=i.pre;if(i.bgClass){t.bgClass=i.bgClass}if(i.textClass){t.textClass=i.textClass}Mr(e,t);Lr(e,t,r,n);Br(e,t,n);return t.node}function Br(e,t,r){Hr(e,t.line,t,r,true);if(t.rest){for(var n=0;n<t.rest.length;n++){Hr(e,t.rest[n],t,r,false)}}}function Hr(e,t,r,n,i){if(!t.widgets){return}var a=Ir(r);for(var o=0,s=t.widgets;o<s.length;++o){var l=s[o],u=O("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:""));if(!l.handleMouseEvents){u.setAttribute("cm-ignore-events","true")}$r(l,u,r,n);e.display.input.setUneditable(u);if(i&&l.above){a.insertBefore(u,r.gutter||r.text)}else{a.appendChild(u)}xr(l,"redraw")}}function $r(e,t,r,n){if(e.noHScroll){(r.alignable||(r.alignable=[])).push(t);var i=n.wrapperWidth;t.style.left=n.fixedPos+"px";if(!e.coverGutter){i-=n.gutterTotalWidth;t.style.paddingLeft=n.gutterTotalWidth+"px"}t.style.width=i+"px"}if(e.coverGutter){t.style.zIndex=5;t.style.position="relative";if(!e.noHScroll){t.style.marginLeft=-n.gutterTotalWidth+"px"}}}function Wr(e){if(e.height!=null){return e.height}var t=e.doc.cm;if(!t){return 0}if(!I(document.body,e.node)){var r="position: relative;";if(e.coverGutter){r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"}if(e.noHScroll){r+="width: "+t.display.wrapper.clientWidth+"px;"}x(t.display.measure,O("div",[e.node],null,r))}return e.height=e.node.parentNode.offsetHeight}function Ur(e,t){for(var r=_e(t);r!=e.wrapper;r=r.parentNode){if(!r||r.nodeType==1&&r.getAttribute("cm-ignore-events")=="true"||r.parentNode==e.sizer&&r!=e.mover){return true}}}function jr(e){return e.lineSpace.offsetTop}function Vr(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function zr(e){if(e.cachedPaddingH){return e.cachedPaddingH}var t=x(e.measure,O("pre","x","CodeMirror-line-like"));var r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle;var n={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};if(!isNaN(n.left)&&!isNaN(n.right)){e.cachedPaddingH=n}return n}function qr(e){return W-e.display.nativeBarWidth}function Yr(e){return e.display.scroller.clientWidth-qr(e)-e.display.barWidth}function Gr(e){return e.display.scroller.clientHeight-qr(e)-e.display.barHeight}function Xr(e,t,r){var n=e.options.lineWrapping;var i=n&&Yr(e);if(!t.measure.heights||n&&t.measure.width!=i){var a=t.measure.heights=[];if(n){t.measure.width=i;var o=t.text.firstChild.getClientRects();for(var s=0;s<o.length-1;s++){var l=o[s],u=o[s+1];if(Math.abs(l.bottom-u.bottom)>2){a.push((l.bottom+u.top)/2-r.top)}}}a.push(r.bottom-r.top)}}function Kr(e,t,r){if(e.line==t){return{map:e.measure.map,cache:e.measure.cache}}for(var n=0;n<e.rest.length;n++){if(e.rest[n]==t){return{map:e.measure.maps[n],cache:e.measure.caches[n]}}}for(var i=0;i<e.rest.length;i++){if(et(e.rest[i])>r){return{map:e.measure.maps[i],cache:e.measure.caches[i],before:true}}}}function Jr(e,t){t=Jt(t);var r=et(t);var n=e.display.externalMeasured=new wr(e.doc,t,r);n.lineN=r;var i=n.built=hr(e,n);n.text=i.pre;x(e.display.lineMeasure,i.pre);return n}function Qr(e,t,r,n){return tn(e,en(e,t),r,n)}function Zr(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo){return e.display.view[Ln(e,t)]}var r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size){return r}}function en(e,t){var r=et(t);var n=Zr(e,r);if(n&&!n.text){n=null}else if(n&&n.changes){Rr(e,n,r,In(e));e.curOp.forceUpdate=true}if(!n){n=Jr(e,t)}var i=Kr(n,t,r);return{line:t,view:n,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:false}}function tn(e,t,r,n,i){if(t.before){r=-1}var a=r+(n||""),o;if(t.cache.hasOwnProperty(a)){o=t.cache[a]}else{if(!t.rect){t.rect=t.view.text.getBoundingClientRect()}if(!t.hasHeights){Xr(e,t.view,t.rect);t.hasHeights=true}o=on(e,t,r,n);if(!o.bogus){t.cache[a]=o}}return{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var rn={left:0,right:0,top:0,bottom:0};function nn(e,t,r){var n,i,a,o,s,l;for(var u=0;u<e.length;u+=3){s=e[u];l=e[u+1];if(t<s){i=0;a=1;o="left"}else if(t<l){i=t-s;a=i+1}else if(u==e.length-3||t==l&&e[u+3]>t){a=l-s;i=a-1;if(t>=l){o="right"}}if(i!=null){n=e[u+2];if(s==l&&r==(n.insertLeft?"left":"right")){o=r}if(r=="left"&&i==0){while(u&&e[u-2]==e[u-3]&&e[u-1].insertLeft){n=e[(u-=3)+2];o="left"}}if(r=="right"&&i==l-s){while(u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft){n=e[(u+=3)+2];o="right"}}break}}return{node:n,start:i,end:a,collapse:o,coverStart:s,coverEnd:l}}function an(e,t){var r=rn;if(t=="left"){for(var n=0;n<e.length;n++){if((r=e[n]).left!=r.right){break}}}else{for(var i=e.length-1;i>=0;i--){if((r=e[i]).left!=r.right){break}}}return r}function on(e,t,r,n){var i=nn(t.map,r,n);var a=i.node,o=i.start,s=i.end,l=i.collapse;var u;if(a.nodeType==3){for(var f=0;f<4;f++){while(o&&ae(t.line.text.charAt(i.coverStart+o))){--o}while(i.coverStart+s<i.coverEnd&&ae(t.line.text.charAt(i.coverStart+s))){++s}if(C&&S<9&&o==0&&s==i.coverEnd-i.coverStart){u=a.parentNode.getBoundingClientRect()}else{u=an(R(a,o,s).getClientRects(),n)}if(u.left||u.right||o==0){break}s=o;o=o-1;l="right"}if(C&&S<11){u=sn(e.display.measure,u)}}else{if(o>0){l=n="right"}var c;if(e.options.lineWrapping&&(c=a.getClientRects()).length>1){u=c[n=="right"?c.length-1:0]}else{u=a.getBoundingClientRect()}}if(C&&S<9&&!o&&(!u||!u.left&&!u.right)){var d=a.parentNode.getClientRects()[0];if(d){u={left:d.left,right:d.left+Rn(e.display),top:d.top,bottom:d.bottom}}else{u=rn}}var h=u.top-t.rect.top,v=u.bottom-t.rect.top;var p=(h+v)/2;var g=t.view.measure.heights;var m=0;for(;m<g.length-1;m++){if(p<g[m]){break}}var y=m?g[m-1]:0,b=g[m];var w={left:(l=="right"?u.right:u.left)-t.rect.left,right:(l=="left"?u.left:u.right)-t.rect.left,top:y,bottom:b};if(!u.left&&!u.right){w.bogus=true}if(!e.options.singleCursorHeightPerLine){w.rtop=h;w.rbottom=v}return w}function sn(e,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Fe(e)){return t}var r=screen.logicalXDPI/screen.deviceXDPI;var n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*r,right:t.right*r,top:t.top*n,bottom:t.bottom*n}}function ln(e){if(e.measure){e.measure.cache={};e.measure.heights=null;if(e.rest){for(var t=0;t<e.rest.length;t++){e.measure.caches[t]={}}}}}function un(e){e.display.externalMeasure=null;_(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++){ln(e.display.view[t])}}function fn(e){un(e);e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null;if(!e.options.lineWrapping){e.display.maxLineChanged=true}e.display.lineNumChars=null}function cn(){if(o&&c){return-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft))}return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function dn(){if(o&&c){return-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop))}return window.pageYOffset||(document.documentElement||document.body).scrollTop}function hn(e){var t=0;if(e.widgets){for(var r=0;r<e.widgets.length;++r){if(e.widgets[r].above){t+=Wr(e.widgets[r])}}}return t}function vn(e,t,r,n,i){if(!i){var a=hn(t);r.top+=a;r.bottom+=a}if(n=="line"){return r}if(!n){n="local"}var o=ir(t);if(n=="local"){o+=jr(e.display)}else{o-=e.display.viewOffset}if(n=="page"||n=="window"){var s=e.display.lineSpace.getBoundingClientRect();o+=s.top+(n=="window"?0:dn());var l=s.left+(n=="window"?0:cn());r.left+=l;r.right+=l}r.top+=o;r.bottom+=o;return r}function pn(e,t,r){if(r=="div"){return t}var n=t.left,i=t.top;if(r=="page"){n-=cn();i-=dn()}else if(r=="local"||!r){var a=e.display.sizer.getBoundingClientRect();n+=a.left;i+=a.top}var o=e.display.lineSpace.getBoundingClientRect();return{left:n-o.left,top:i-o.top}}function gn(e,t,r,n,i){if(!n){n=Ke(e.doc,t.line)}return vn(e,n,Qr(e,n,t.ch,i),r)}function mn(n,e,i,a,o,s){a=a||Ke(n.doc,e.line);if(!o){o=en(n,a)}function l(e,t){var r=tn(n,o,e,t?"right":"left",s);if(t){r.left=r.right}else{r.right=r.left}return vn(n,a,r,i)}var u=de(a,n.doc.direction),t=e.ch,r=e.sticky;if(t>=a.text.length){t=a.text.length;r="before"}else if(t<=0){t=0;r="after"}if(!u){return l(r=="before"?t-1:t,r=="before")}function f(e,t,r){var n=u[t],i=n.level==1;return l(r?e-1:e,i!=r)}var c=fe(u,t,r);var d=ue;var h=f(t,c,r=="before");if(d!=null){h.other=f(t,d,r!="before")}return h}function yn(e,t){var r=0;t=ct(e.doc,t);if(!e.options.lineWrapping){r=Rn(e.display)*t.ch}var n=Ke(e.doc,t.line);var i=ir(n)+jr(e.display);return{left:r,right:r,top:i,bottom:i+n.height}}function bn(e,t,r,n,i){var a=it(e,t,r);a.xRel=i;if(n){a.outside=n}return a}function wn(e,t,r){var n=e.doc;r+=e.display.viewOffset;if(r<0){return bn(n.first,0,null,-1,-1)}var i=tt(n,r),a=n.first+n.size-1;if(i>a){return bn(n.first+n.size-1,Ke(n,a).text.length,null,1,1)}if(t<0){t=0}var o=Ke(n,i);for(;;){var s=kn(e,o,i,t,r);var l=Xt(o,s.ch+(s.xRel>0||s.outside>0?1:0));if(!l){return s}var u=l.find(1);if(u.line==i){return u}o=Ke(n,i=u.line)}}function Cn(t,e,r,n){n-=hn(e);var i=e.text.length;var a=se(function(e){return tn(t,r,e-1).bottom<=n},i,0);i=se(function(e){return tn(t,r,e).top>n},a,i);return{begin:a,end:i}}function Sn(e,t,r,n){if(!r){r=en(e,t)}var i=vn(e,t,tn(e,r,n),"line").top;return Cn(e,t,r,i)}function En(e,t,r,n){return e.bottom<=r?false:e.top>r?true:(n?e.left:e.right)>t}function kn(r,e,t,n,i){i-=ir(e);var a=en(r,e);var o=hn(e);var s=0,l=e.text.length,u=true;var f=de(e,r.doc.direction);if(f){var c=(r.options.lineWrapping?_n:Tn)(r,e,t,a,f,n,i);u=c.level!=1;s=u?c.from:c.to-1;l=u?c.to:c.from-1}var d=null,h=null;var v=se(function(e){var t=tn(r,a,e);t.top+=o;t.bottom+=o;if(!En(t,n,i,false)){return false}if(t.top<=i&&t.left<=n){d=e;h=t}return true},s,l);var p,g,m=false;if(h){var y=n-h.left<h.right-n,b=y==u;v=d+(b?0:1);g=b?"after":"before";p=y?h.left:h.right}else{if(!u&&(v==l||v==s)){v++}g=v==0?"after":v==e.text.length?"before":tn(r,a,v-(u?1:0)).bottom+o<=i==u?"after":"before";var w=mn(r,it(t,v,g),"line",e,a);p=w.left;m=i<w.top?-1:i>=w.bottom?1:0}v=oe(e.text,v,1);return bn(t,v,g,m,n-p)}function Tn(n,i,a,o,s,l,u){var e=se(function(e){var t=s[e],r=t.level!=1;return En(mn(n,it(a,r?t.to:t.from,r?"before":"after"),"line",i,o),l,u,true)},0,s.length-1);var t=s[e];if(e>0){var r=t.level!=1;var f=mn(n,it(a,r?t.from:t.to,r?"after":"before"),"line",i,o);if(En(f,l,u,true)&&f.top>u){t=s[e-1]}}return t}function _n(e,t,r,n,i,a,o){var s=Cn(e,t,n,o);var l=s.begin;var u=s.end;if(/\s/.test(t.text.charAt(u-1))){u--}var f=null,c=null;for(var d=0;d<i.length;d++){var h=i[d];if(h.from>=u||h.to<=l){continue}var v=h.level!=1;var p=tn(e,n,v?Math.min(u,h.to)-1:Math.max(l,h.from)).right;var g=p<a?a-p+1e9:p-a;if(!f||c>g){f=h;c=g}}if(!f){f=i[i.length-1]}if(f.from<l){f={from:l,to:f.to,level:f.level}}if(f.to>u){f={from:f.from,to:u,level:f.level}}return f}var xn;function Dn(e){if(e.cachedTextHeight!=null){return e.cachedTextHeight}if(xn==null){xn=O("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t){xn.appendChild(document.createTextNode("x"));xn.appendChild(O("br"))}xn.appendChild(document.createTextNode("x"))}x(e.measure,xn);var r=xn.offsetHeight/50;if(r>3){e.cachedTextHeight=r}_(e.measure);return r||1}function Rn(e){if(e.cachedCharWidth!=null){return e.cachedCharWidth}var t=O("span","xxxxxxxxxx");var r=O("pre",[t],"CodeMirror-line-like");x(e.measure,r);var n=t.getBoundingClientRect(),i=(n.right-n.left)/10;if(i>2){e.cachedCharWidth=i}return i||10}function In(e){var t=e.display,r={},n={};var i=t.gutters.clientLeft;for(var a=t.gutters.firstChild,o=0;a;a=a.nextSibling,++o){var s=e.display.gutterSpecs[o].className;r[s]=a.offsetLeft+a.clientLeft+i;n[s]=a.clientWidth}return{fixedPos:On(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function On(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function An(n){var i=Dn(n.display),a=n.options.lineWrapping;var o=a&&Math.max(5,n.display.scroller.clientWidth/Rn(n.display)-3);return function(e){if(rr(n.doc,e)){return 0}var t=0;if(e.widgets){for(var r=0;r<e.widgets.length;r++){if(e.widgets[r].height){t+=e.widgets[r].height}}}if(a){return t+(Math.ceil(e.text.length/o)||1)*i}else{return t+i}}}function Nn(e){var t=e.doc,r=An(e);t.iter(function(e){var t=r(e);if(t!=e.height){Ze(e,t)}})}function Mn(e,t,r,n){var i=e.display;if(!r&&_e(t).getAttribute("cm-not-content")=="true"){return null}var a,o,s=i.lineSpace.getBoundingClientRect();try{a=t.clientX-s.left;o=t.clientY-s.top}catch(t){return null}var l=wn(e,a,o),u;if(n&&l.xRel>0&&(u=Ke(e.doc,l.line).text).length==l.ch){var f=B(u,u.length,e.options.tabSize)-u.length;l=it(l.line,Math.max(0,Math.round((a-zr(e.display).left)/Rn(e.display))-f))}return l}function Ln(e,t){if(t>=e.display.viewTo){return null}t-=e.display.viewFrom;if(t<0){return null}var r=e.display.view;for(var n=0;n<r.length;n++){t-=r[n].size;if(t<0){return n}}}function Pn(e,t,r,n){if(t==null){t=e.doc.first}if(r==null){r=e.doc.first+e.doc.size}if(!n){n=0}var i=e.display;if(n&&r<i.viewTo&&(i.updateLineNumbers==null||i.updateLineNumbers>t)){i.updateLineNumbers=t}e.curOp.viewChanged=true;if(t>=i.viewTo){if(Rt&&er(e.doc,t)<i.viewTo){Bn(e)}}else if(r<=i.viewFrom){if(Rt&&tr(e.doc,r+n)>i.viewFrom){Bn(e)}else{i.viewFrom+=n;i.viewTo+=n}}else if(t<=i.viewFrom&&r>=i.viewTo){Bn(e)}else if(t<=i.viewFrom){var a=Hn(e,r,r+n,1);if(a){i.view=i.view.slice(a.index);i.viewFrom=a.lineN;i.viewTo+=n}else{Bn(e)}}else if(r>=i.viewTo){var o=Hn(e,t,t,-1);if(o){i.view=i.view.slice(0,o.index);i.viewTo=o.lineN}else{Bn(e)}}else{var s=Hn(e,t,t,-1);var l=Hn(e,r,r+n,1);if(s&&l){i.view=i.view.slice(0,s.index).concat(Cr(e,s.lineN,l.lineN)).concat(i.view.slice(l.index));i.viewTo+=n}else{Bn(e)}}var u=i.externalMeasured;if(u){if(r<u.lineN){u.lineN+=n}else if(t<u.lineN+u.size){i.externalMeasured=null}}}function Fn(e,t,r){e.curOp.viewChanged=true;var n=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size){n.externalMeasured=null}if(t<n.viewFrom||t>=n.viewTo){return}var a=n.view[Ln(e,t)];if(a.node==null){return}var o=a.changes||(a.changes=[]);if($(o,r)==-1){o.push(r)}}function Bn(e){e.display.viewFrom=e.display.viewTo=e.doc.first;e.display.view=[];e.display.viewOffset=0}function Hn(e,t,r,n){var i=Ln(e,t),a,o=e.display.view;if(!Rt||r==e.doc.first+e.doc.size){return{index:i,lineN:r}}var s=e.display.viewFrom;for(var l=0;l<i;l++){s+=o[l].size}if(s!=t){if(n>0){if(i==o.length-1){return null}a=s+o[i].size-t;i++}else{a=s-t}t+=a;r+=a}while(er(e.doc,r)!=r){if(i==(n<0?0:o.length-1)){return null}r+=n*o[i-(n<0?1:0)].size;i+=n}return{index:i,lineN:r}}function $n(e,t,r){var n=e.display,i=n.view;if(i.length==0||t>=n.viewTo||r<=n.viewFrom){n.view=Cr(e,t,r);n.viewFrom=t}else{if(n.viewFrom>t){n.view=Cr(e,t,n.viewFrom).concat(n.view)}else if(n.viewFrom<t){n.view=n.view.slice(Ln(e,t))}n.viewFrom=t;if(n.viewTo<r){n.view=n.view.concat(Cr(e,n.viewTo,r))}else if(n.viewTo>r){n.view=n.view.slice(0,Ln(e,r))}}n.viewTo=r}function Wn(e){var t=e.display.view,r=0;for(var n=0;n<t.length;n++){var i=t[n];if(!i.hidden&&(!i.node||i.changes)){++r}}return r}function Un(e){e.display.input.showSelection(e.display.input.prepareSelection())}function jn(e,t){if(t===void 0)t=true;var r=e.doc,n={};var i=n.cursors=document.createDocumentFragment();var a=n.selection=document.createDocumentFragment();for(var o=0;o<r.sel.ranges.length;o++){if(!t&&o==r.sel.primIndex){continue}var s=r.sel.ranges[o];if(s.from().line>=e.display.viewTo||s.to().line<e.display.viewFrom){continue}var l=s.empty();if(l||e.options.showCursorWhenSelecting){Vn(e,s.head,i)}if(!l){qn(e,s,a)}}return n}function Vn(e,t,r){var n=mn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine);var i=r.appendChild(O("div","Â ","CodeMirror-cursor"));i.style.left=n.left+"px";i.style.top=n.top+"px";i.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px";if(n.other){var a=r.appendChild(O("div","Â ","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="";a.style.left=n.other.left+"px";a.style.top=n.other.top+"px";a.style.height=(n.other.bottom-n.other.top)*.85+"px"}}function zn(e,t){return e.top-t.top||e.left-t.left}function qn(s,e,t){var r=s.display,n=s.doc;var i=document.createDocumentFragment();var a=zr(s.display),x=a.left;var D=Math.max(r.sizerWidth,Yr(s)-r.sizer.offsetLeft)-a.right;var R=n.direction=="ltr";function I(e,t,r,n){if(t<0){t=0}t=Math.round(t);n=Math.round(n);i.appendChild(O("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(r==null?D-e:r)+"px;\n                             height: "+(n-t)+"px"))}function o(r,b,w){var o=Ke(n,r);var C=o.text.length;var S,E;function k(e,t){return gn(s,it(r,e),"div",o,t)}function T(e,t,r){var n=Sn(s,o,null,e);var i=t=="ltr"==(r=="after")?"left":"right";var a=r=="after"?n.begin:n.end-(/\s/.test(o.text.charAt(n.end-1))?2:1);return k(a,i)[i]}var _=de(o,n.direction);le(_,b||0,w==null?C:w,function(e,t,r,n){var i=r=="ltr";var a=k(e,i?"left":"right");var o=k(t-1,i?"right":"left");var s=b==null&&e==0,l=w==null&&t==C;var u=n==0,f=!_||n==_.length-1;if(o.top-a.top<=3){var c=(R?s:l)&&u;var d=(R?l:s)&&f;var h=c?x:(i?a:o).left;var v=d?D:(i?o:a).right;I(h,a.top,v-h,a.bottom)}else{var p,g,m,y;if(i){p=R&&s&&u?x:a.left;g=R?D:T(e,r,"before");m=R?x:T(t,r,"after");y=R&&l&&f?D:o.right}else{p=!R?x:T(e,r,"before");g=!R&&s&&u?D:a.right;m=!R&&l&&f?x:o.left;y=!R?D:T(t,r,"after")}I(p,a.top,g-p,a.bottom);if(a.bottom<o.top){I(x,a.bottom,null,o.top)}I(m,o.top,y-m,o.bottom)}if(!S||zn(a,S)<0){S=a}if(zn(o,S)<0){S=o}if(!E||zn(a,E)<0){E=a}if(zn(o,E)<0){E=o}});return{start:S,end:E}}var l=e.from(),u=e.to();if(l.line==u.line){o(l.line,l.ch,u.ch)}else{var f=Ke(n,l.line),c=Ke(n,u.line);var d=Jt(f)==Jt(c);var h=o(l.line,l.ch,d?f.text.length+1:null).end;var v=o(u.line,d?0:null,u.ch).start;if(d){if(h.top<v.top-2){I(h.right,h.top,null,h.bottom);I(x,v.top,v.left,v.bottom)}else{I(h.right,h.top,v.left-h.right,h.bottom)}}if(h.bottom<v.top){I(x,h.bottom,null,v.top)}}t.appendChild(i)}function Yn(e){if(!e.state.focused){return}var t=e.display;clearInterval(t.blinker);var r=true;t.cursorDiv.style.visibility="";if(e.options.cursorBlinkRate>0){t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(r=!r)?"":"hidden"},e.options.cursorBlinkRate)}else if(e.options.cursorBlinkRate<0){t.cursorDiv.style.visibility="hidden"}}function Gn(e){if(!e.state.focused){e.display.input.focus();Kn(e)}}function Xn(e){e.state.delayingBlurEvent=true;setTimeout(function(){if(e.state.delayingBlurEvent){e.state.delayingBlurEvent=false;Jn(e)}},100)}function Kn(e,t){if(e.state.delayingBlurEvent){e.state.delayingBlurEvent=false}if(e.options.readOnly=="nocursor"){return}if(!e.state.focused){me(e,"focus",e,t);e.state.focused=true;N(e.display.wrapper,"CodeMirror-focused");if(!e.curOp&&e.display.selForContextMenu!=e.doc.sel){e.display.input.reset();if(g){setTimeout(function(){return e.display.input.reset(true)},20)}}e.display.input.receivedFocus()}Yn(e)}function Jn(e,t){if(e.state.delayingBlurEvent){return}if(e.state.focused){me(e,"blur",e,t);e.state.focused=false;T(e.display.wrapper,"CodeMirror-focused")}clearInterval(e.display.blinker);setTimeout(function(){if(!e.state.focused){e.display.shift=false}},150)}function Qn(e){var t=e.display;var r=t.lineDiv.offsetTop;for(var n=0;n<t.view.length;n++){var i=t.view[n],a=e.options.lineWrapping;var o=void 0,s=0;if(i.hidden){continue}if(C&&S<8){var l=i.node.offsetTop+i.node.offsetHeight;o=l-r;r=l}else{var u=i.node.getBoundingClientRect();o=u.bottom-u.top;if(!a&&i.text.firstChild){s=i.text.firstChild.getBoundingClientRect().right-u.left-1}}var f=i.line.height-o;if(f>.005||f<-.005){Ze(i.line,o);Zn(i.line);if(i.rest){for(var c=0;c<i.rest.length;c++){Zn(i.rest[c])}}}if(s>e.display.sizerWidth){var d=Math.ceil(s/Rn(e.display));if(d>e.display.maxLineLength){e.display.maxLineLength=d;e.display.maxLine=i.line;e.display.maxLineChanged=true}}}}function Zn(e){if(e.widgets){for(var t=0;t<e.widgets.length;++t){var r=e.widgets[t],n=r.node.parentNode;if(n){r.height=n.offsetHeight}}}}function ei(e,t,r){var n=r&&r.top!=null?Math.max(0,r.top):e.scroller.scrollTop;n=Math.floor(n-jr(e));var i=r&&r.bottom!=null?r.bottom:n+e.wrapper.clientHeight;var a=tt(t,n),o=tt(t,i);if(r&&r.ensure){var s=r.ensure.from.line,l=r.ensure.to.line;if(s<a){a=s;o=tt(t,ir(Ke(t,s))+e.wrapper.clientHeight)}else if(Math.min(l,t.lastLine())>=o){a=tt(t,ir(Ke(t,l))-e.wrapper.clientHeight);o=l}}return{from:a,to:Math.max(o,a+1)}}function ti(e,t){if(ye(e,"scrollCursorIntoView")){return}var r=e.display,n=r.sizer.getBoundingClientRect(),i=null;if(t.top+n.top<0){i=true}else if(t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)){i=false}if(i!=null&&!u){var a=O("div","â",null,"position: absolute;\n                         top: "+(t.top-r.viewOffset-jr(e.display))+"px;\n                         height: "+(t.bottom-t.top+qr(e)+r.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(a);a.scrollIntoView(i);e.display.lineSpace.removeChild(a)}}function ri(e,t,r,n){if(n==null){n=0}var i;if(!e.options.lineWrapping&&t==r){t=t.ch?it(t.line,t.sticky=="before"?t.ch-1:t.ch,"after"):t;r=t.sticky=="before"?it(t.line,t.ch+1,"before"):t}for(var a=0;a<5;a++){var o=false;var s=mn(e,t);var l=!r||r==t?s:mn(e,r);i={left:Math.min(s.left,l.left),top:Math.min(s.top,l.top)-n,right:Math.max(s.left,l.left),bottom:Math.max(s.bottom,l.bottom)+n};var u=ii(e,i);var f=e.doc.scrollTop,c=e.doc.scrollLeft;if(u.scrollTop!=null){ci(e,u.scrollTop);if(Math.abs(e.doc.scrollTop-f)>1){o=true}}if(u.scrollLeft!=null){hi(e,u.scrollLeft);if(Math.abs(e.doc.scrollLeft-c)>1){o=true}}if(!o){break}}return i}function ni(e,t){var r=ii(e,t);if(r.scrollTop!=null){ci(e,r.scrollTop)}if(r.scrollLeft!=null){hi(e,r.scrollLeft)}}function ii(e,t){var r=e.display,n=Dn(e.display);if(t.top<0){t.top=0}var i=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:r.scroller.scrollTop;var a=Gr(e),o={};if(t.bottom-t.top>a){t.bottom=t.top+a}var s=e.doc.height+Vr(r);var l=t.top<n,u=t.bottom>s-n;if(t.top<i){o.scrollTop=l?0:t.top}else if(t.bottom>i+a){var f=Math.min(t.top,(u?s:t.bottom)-a);if(f!=i){o.scrollTop=f}}var c=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:r.scroller.scrollLeft;var d=Yr(e)-(e.options.fixedGutter?r.gutters.offsetWidth:0);var h=t.right-t.left>d;if(h){t.right=t.left+d}if(t.left<10){o.scrollLeft=0}else if(t.left<c){o.scrollLeft=Math.max(0,t.left-(h?0:10))}else if(t.right>d+c-3){o.scrollLeft=t.right+(h?0:10)-d}return o}function ai(e,t){if(t==null){return}ui(e);e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+t}function oi(e){ui(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function si(e,t,r){if(t!=null||r!=null){ui(e)}if(t!=null){e.curOp.scrollLeft=t}if(r!=null){e.curOp.scrollTop=r}}function li(e,t){ui(e);e.curOp.scrollToPos=t}function ui(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var r=yn(e,t.from),n=yn(e,t.to);fi(e,r,n,t.margin)}}function fi(e,t,r,n){var i=ii(e,{left:Math.min(t.left,r.left),top:Math.min(t.top,r.top)-n,right:Math.max(t.right,r.right),bottom:Math.max(t.bottom,r.bottom)+n});si(e,i.scrollLeft,i.scrollTop)}function ci(e,t){if(Math.abs(e.doc.scrollTop-t)<2){return}if(!p){Ui(e,{top:t})}di(e,t,true);if(p){Ui(e)}Mi(e,100)}function di(e,t,r){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t);if(e.display.scroller.scrollTop==t&&!r){return}e.doc.scrollTop=t;e.display.scrollbars.setScrollTop(t);if(e.display.scroller.scrollTop!=t){e.display.scroller.scrollTop=t}}function hi(e,t,r,n){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth);if((r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!n){return}e.doc.scrollLeft=t;qi(e);if(e.display.scroller.scrollLeft!=t){e.display.scroller.scrollLeft=t}e.display.scrollbars.setScrollLeft(t)}function vi(e){var t=e.display,r=t.gutters.offsetWidth;var n=Math.round(e.doc.height+Vr(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:n,scrollHeight:n+qr(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}var pi=function(e,t,r){this.cm=r;var n=this.vert=O("div",[O("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var i=this.horiz=O("div",[O("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n.tabIndex=i.tabIndex=-1;e(n);e(i);ve(n,"scroll",function(){if(n.clientHeight){t(n.scrollTop,"vertical")}});ve(i,"scroll",function(){if(i.clientWidth){t(i.scrollLeft,"horizontal")}});this.checkedZeroWidth=false;if(C&&S<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}};pi.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1;var r=e.scrollHeight>e.clientHeight+1;var n=e.nativeBarWidth;if(r){this.vert.style.display="block";this.vert.style.bottom=t?n+"px":"0";var i=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(t){this.horiz.style.display="block";this.horiz.style.right=r?n+"px":"0";this.horiz.style.left=e.barLeft+"px";var a=e.viewWidth-e.barLeft-(r?n:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+a)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&e.clientHeight>0){if(n==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:r?n:0,bottom:t?n:0}};pi.prototype.setScrollLeft=function(e){if(this.horiz.scrollLeft!=e){this.horiz.scrollLeft=e}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")}};pi.prototype.setScrollTop=function(e){if(this.vert.scrollTop!=e){this.vert.scrollTop=e}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert,"vert")}};pi.prototype.zeroWidthHack=function(){var e=y&&!l?"12px":"18px";this.horiz.style.height=this.vert.style.width=e;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new H;this.disableVert=new H};pi.prototype.enableZeroWidthBar=function(r,n,i){r.style.pointerEvents="auto";function a(){var e=r.getBoundingClientRect();var t=i=="vert"?document.elementFromPoint(e.right-1,(e.top+e.bottom)/2):document.elementFromPoint((e.right+e.left)/2,e.bottom-1);if(t!=r){r.style.pointerEvents="none"}else{n.set(1e3,a)}}n.set(1e3,a)};pi.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz);e.removeChild(this.vert)};var gi=function(){};gi.prototype.update=function(){return{bottom:0,right:0}};gi.prototype.setScrollLeft=function(){};gi.prototype.setScrollTop=function(){};gi.prototype.clear=function(){};function mi(e,t){if(!t){t=vi(e)}var r=e.display.barWidth,n=e.display.barHeight;yi(e,t);for(var i=0;i<4&&r!=e.display.barWidth||n!=e.display.barHeight;i++){if(r!=e.display.barWidth&&e.options.lineWrapping){Qn(e)}yi(e,vi(e));r=e.display.barWidth;n=e.display.barHeight}}function yi(e,t){var r=e.display;var n=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=n.right)+"px";r.sizer.style.paddingBottom=(r.barHeight=n.bottom)+"px";r.heightForcer.style.borderBottom=n.bottom+"px solid transparent";if(n.right&&n.bottom){r.scrollbarFiller.style.display="block";r.scrollbarFiller.style.height=n.bottom+"px";r.scrollbarFiller.style.width=n.right+"px"}else{r.scrollbarFiller.style.display=""}if(n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter){r.gutterFiller.style.display="block";r.gutterFiller.style.height=n.bottom+"px";r.gutterFiller.style.width=t.gutterWidth+"px"}else{r.gutterFiller.style.display=""}}var bi={native:pi,null:gi};function wi(r){if(r.display.scrollbars){r.display.scrollbars.clear();if(r.display.scrollbars.addClass){T(r.display.wrapper,r.display.scrollbars.addClass)}}r.display.scrollbars=new bi[r.options.scrollbarStyle](function(e){r.display.wrapper.insertBefore(e,r.display.scrollbarFiller);ve(e,"mousedown",function(){if(r.state.focused){setTimeout(function(){return r.display.input.focus()},0)}});e.setAttribute("cm-not-content","true")},function(e,t){if(t=="horizontal"){hi(r,e)}else{ci(r,e)}},r);if(r.display.scrollbars.addClass){N(r.display.wrapper,r.display.scrollbars.addClass)}}var Ci=0;function Si(e){e.curOp={cm:e,viewChanged:false,startHeight:e.doc.height,forceUpdate:false,updateInput:0,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++Ci};Er(e.curOp)}function Ei(e){var t=e.curOp;if(t){Tr(t,function(e){for(var t=0;t<e.ops.length;t++){e.ops[t].cm.curOp=null}ki(e)})}}function ki(e){var t=e.ops;for(var r=0;r<t.length;r++){Ti(t[r])}for(var n=0;n<t.length;n++){_i(t[n])}for(var i=0;i<t.length;i++){xi(t[i])}for(var a=0;a<t.length;a++){Di(t[a])}for(var o=0;o<t.length;o++){Ri(t[o])}}function Ti(e){var t=e.cm,r=t.display;Fi(t);if(e.updateMaxLine){or(t)}e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<r.viewFrom||e.scrollToPos.to.line>=r.viewTo)||r.maxLineChanged&&t.options.lineWrapping;e.update=e.mustUpdate&&new Pi(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function _i(e){e.updatedDisplay=e.mustUpdate&&$i(e.cm,e.update)}function xi(e){var t=e.cm,r=t.display;if(e.updatedDisplay){Qn(t)}e.barMeasure=vi(t);if(r.maxLineChanged&&!t.options.lineWrapping){e.adjustWidthTo=Qr(t,r.maxLine,r.maxLine.text.length).left+3;t.display.sizerWidth=e.adjustWidthTo;e.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+e.adjustWidthTo+qr(t)+t.display.barWidth);e.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+e.adjustWidthTo-Yr(t))}if(e.updatedDisplay||e.selectionChanged){e.preparedSelection=r.input.prepareSelection()}}function Di(e){var t=e.cm;if(e.adjustWidthTo!=null){t.display.sizer.style.minWidth=e.adjustWidthTo+"px";if(e.maxScrollLeft<t.doc.scrollLeft){hi(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),true)}t.display.maxLineChanged=false}var r=e.focus&&e.focus==A();if(e.preparedSelection){t.display.input.showSelection(e.preparedSelection,r)}if(e.updatedDisplay||e.startHeight!=t.doc.height){mi(t,e.barMeasure)}if(e.updatedDisplay){zi(t,e.barMeasure)}if(e.selectionChanged){Yn(t)}if(t.state.focused&&e.updateInput){t.display.input.reset(e.typing)}if(r){Gn(e.cm)}}function Ri(e){var t=e.cm,r=t.display,n=t.doc;if(e.updatedDisplay){Wi(t,e.update)}if(r.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)){r.wheelStartX=r.wheelStartY=null}if(e.scrollTop!=null){di(t,e.scrollTop,e.forceScroll)}if(e.scrollLeft!=null){hi(t,e.scrollLeft,true,true)}if(e.scrollToPos){var i=ri(t,ct(n,e.scrollToPos.from),ct(n,e.scrollToPos.to),e.scrollToPos.margin);ti(t,i)}var a=e.maybeHiddenMarkers,o=e.maybeUnhiddenMarkers;if(a){for(var s=0;s<a.length;++s){if(!a[s].lines.length){me(a[s],"hide")}}}if(o){for(var l=0;l<o.length;++l){if(o[l].lines.length){me(o[l],"unhide")}}}if(r.wrapper.offsetHeight){n.scrollTop=t.display.scroller.scrollTop}if(e.changeObjs){me(t,"changes",t,e.changeObjs)}if(e.update){e.update.finish()}}function Ii(e,t){if(e.curOp){return t()}Si(e);try{return t()}finally{Ei(e)}}function Oi(e,t){return function(){if(e.curOp){return t.apply(e,arguments)}Si(e);try{return t.apply(e,arguments)}finally{Ei(e)}}}function Ai(e){return function(){if(this.curOp){return e.apply(this,arguments)}Si(this);try{return e.apply(this,arguments)}finally{Ei(this)}}}function Ni(t){return function(){var e=this.cm;if(!e||e.curOp){return t.apply(this,arguments)}Si(e);try{return t.apply(this,arguments)}finally{Ei(e)}}}function Mi(e,t){if(e.doc.highlightFrontier<e.display.viewTo){e.state.highlight.set(t,P(Li,e))}}function Li(l){var u=l.doc;if(u.highlightFrontier>=l.display.viewTo){return}var f=+new Date+l.options.workTime;var c=yt(l,u.highlightFrontier);var d=[];u.iter(c.line,Math.min(u.first+u.size,l.display.viewTo+500),function(e){if(c.line>=l.display.viewFrom){var t=e.styles;var r=e.text.length>l.options.maxHighlightLength?qe(u.mode,c.state):null;var n=gt(l,e,c,true);if(r){c.state=r}e.styles=n.styles;var i=e.styleClasses,a=n.classes;if(a){e.styleClasses=a}else if(i){e.styleClasses=null}var o=!t||t.length!=e.styles.length||i!=a&&(!i||!a||i.bgClass!=a.bgClass||i.textClass!=a.textClass);for(var s=0;!o&&s<t.length;++s){o=t[s]!=e.styles[s]}if(o){d.push(c.line)}e.stateAfter=c.save();c.nextLine()}else{if(e.text.length<=l.options.maxHighlightLength){bt(l,e.text,c)}e.stateAfter=c.line%5==0?c.save():null;c.nextLine()}if(+new Date>f){Mi(l,l.options.workDelay);return true}});u.highlightFrontier=c.line;u.modeFrontier=Math.max(u.modeFrontier,c.line);if(d.length){Ii(l,function(){for(var e=0;e<d.length;e++){Fn(l,d[e],"text")}})}}var Pi=function(e,t,r){var n=e.display;this.viewport=t;this.visible=ei(n,e.doc,t);this.editorIsHidden=!n.wrapper.offsetWidth;this.wrapperHeight=n.wrapper.clientHeight;this.wrapperWidth=n.wrapper.clientWidth;this.oldDisplayWidth=Yr(e);this.force=r;this.dims=In(e);this.events=[]};Pi.prototype.signal=function(e,t){if(we(e,t)){this.events.push(arguments)}};Pi.prototype.finish=function(){for(var e=0;e<this.events.length;e++){me.apply(null,this.events[e])}};function Fi(e){var t=e.display;if(!t.scrollbarsClipped&&t.scroller.offsetWidth){t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth;t.heightForcer.style.height=qr(e)+"px";t.sizer.style.marginBottom=-t.nativeBarWidth+"px";t.sizer.style.borderRightWidth=qr(e)+"px";t.scrollbarsClipped=true}}function Bi(e){if(e.hasFocus()){return null}var t=A();if(!t||!I(e.display.lineDiv,t)){return null}var r={activeElt:t};if(window.getSelection){var n=window.getSelection();if(n.anchorNode&&n.extend&&I(e.display.lineDiv,n.anchorNode)){r.anchorNode=n.anchorNode;r.anchorOffset=n.anchorOffset;r.focusNode=n.focusNode;r.focusOffset=n.focusOffset}}return r}function Hi(e){if(!e||!e.activeElt||e.activeElt==A()){return}e.activeElt.focus();if(e.anchorNode&&I(document.body,e.anchorNode)&&I(document.body,e.focusNode)){var t=window.getSelection(),r=document.createRange();r.setEnd(e.anchorNode,e.anchorOffset);r.collapse(false);t.removeAllRanges();t.addRange(r);t.extend(e.focusNode,e.focusOffset)}}function $i(e,t){var r=e.display,n=e.doc;if(t.editorIsHidden){Bn(e);return false}if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(r.updateLineNumbers==null||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&Wn(e)==0){return false}if(Yi(e)){Bn(e);t.dims=In(e)}var i=n.first+n.size;var a=Math.max(t.visible.from-e.options.viewportMargin,n.first);var o=Math.min(i,t.visible.to+e.options.viewportMargin);if(r.viewFrom<a&&a-r.viewFrom<20){a=Math.max(n.first,r.viewFrom)}if(r.viewTo>o&&r.viewTo-o<20){o=Math.min(i,r.viewTo)}if(Rt){a=er(e.doc,a);o=tr(e.doc,o)}var s=a!=r.viewFrom||o!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth;$n(e,a,o);r.viewOffset=ir(Ke(e.doc,r.viewFrom));e.display.mover.style.top=r.viewOffset+"px";var l=Wn(e);if(!s&&l==0&&!t.force&&r.renderedView==r.view&&(r.updateLineNumbers==null||r.updateLineNumbers>=r.viewTo)){return false}var u=Bi(e);if(l>4){r.lineDiv.style.display="none"}ji(e,r.updateLineNumbers,t.dims);if(l>4){r.lineDiv.style.display=""}r.renderedView=r.view;Hi(u);_(r.cursorDiv);_(r.selectionDiv);r.gutters.style.height=r.sizer.style.minHeight=0;if(s){r.lastWrapHeight=t.wrapperHeight;r.lastWrapWidth=t.wrapperWidth;Mi(e,400)}r.updateLineNumbers=null;return true}function Wi(e,t){var r=t.viewport;for(var n=true;;n=false){if(!n||!e.options.lineWrapping||t.oldDisplayWidth==Yr(e)){if(r&&r.top!=null){r={top:Math.min(e.doc.height+Vr(e.display)-Gr(e),r.top)}}t.visible=ei(e.display,e.doc,r);if(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo){break}}if(!$i(e,t)){break}Qn(e);var i=vi(e);Un(e);mi(e,i);zi(e,i);t.force=false}t.signal(e,"update",e);if(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo){t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo);e.display.reportedViewFrom=e.display.viewFrom;e.display.reportedViewTo=e.display.viewTo}}function Ui(e,t){var r=new Pi(e,t);if($i(e,r)){Qn(e);Wi(e,r);var n=vi(e);Un(e);mi(e,n);zi(e,n);r.finish()}}function ji(r,e,t){var n=r.display,i=r.options.lineNumbers;var a=n.lineDiv,o=a.firstChild;function s(e){var t=e.nextSibling;if(g&&y&&r.display.currentWheelTarget==e){e.style.display="none"}else{e.parentNode.removeChild(e)}return t}var l=n.view,u=n.viewFrom;for(var f=0;f<l.length;f++){var c=l[f];if(c.hidden);else if(!c.node||c.node.parentNode!=a){var d=Fr(r,c,u,t);a.insertBefore(d,o)}else{while(o!=c.node){o=s(o)}var h=i&&e!=null&&e<=u&&c.lineNumber;if(c.changes){if($(c.changes,"gutter")>-1){h=false}Rr(r,c,u,t)}if(h){_(c.lineNumber);c.lineNumber.appendChild(document.createTextNode(nt(r.options,u)))}o=c.node.nextSibling}u+=c.size}while(o){o=s(o)}}function Vi(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function zi(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";e.display.heightForcer.style.top=t.docHeight+"px";e.display.gutters.style.height=t.docHeight+e.display.barHeight+qr(e)+"px"}function qi(e){var t=e.display,r=t.view;if(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter)){return}var n=On(t)-t.scroller.scrollLeft+e.doc.scrollLeft;var i=t.gutters.offsetWidth,a=n+"px";for(var o=0;o<r.length;o++){if(!r[o].hidden){if(e.options.fixedGutter){if(r[o].gutter){r[o].gutter.style.left=a}if(r[o].gutterBackground){r[o].gutterBackground.style.left=a}}var s=r[o].alignable;if(s){for(var l=0;l<s.length;l++){s[l].style.left=a}}}}if(e.options.fixedGutter){t.gutters.style.left=n+i+"px"}}function Yi(e){if(!e.options.lineNumbers){return false}var t=e.doc,r=nt(e.options,t.first+t.size-1),n=e.display;if(r.length!=n.lineNumChars){var i=n.measure.appendChild(O("div",[O("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var a=i.firstChild.offsetWidth,o=i.offsetWidth-a;n.lineGutter.style.width="";n.lineNumInnerWidth=Math.max(a,n.lineGutter.offsetWidth-o)+1;n.lineNumWidth=n.lineNumInnerWidth+o;n.lineNumChars=n.lineNumInnerWidth?r.length:-1;n.lineGutter.style.width=n.lineNumWidth+"px";Vi(e.display);return true}return false}function Gi(e,t){var r=[],n=false;for(var i=0;i<e.length;i++){var a=e[i],o=null;if(typeof a!="string"){o=a.style;a=a.className}if(a=="CodeMirror-linenumbers"){if(!t){continue}else{n=true}}r.push({className:a,style:o})}if(t&&!n){r.push({className:"CodeMirror-linenumbers",style:null})}return r}function Xi(e){var t=e.gutters,r=e.gutterSpecs;_(t);e.lineGutter=null;for(var n=0;n<r.length;++n){var i=r[n];var a=i.className;var o=i.style;var s=t.appendChild(O("div",null,"CodeMirror-gutter "+a));if(o){s.style.cssText=o}if(a=="CodeMirror-linenumbers"){e.lineGutter=s;s.style.width=(e.lineNumWidth||1)+"px"}}t.style.display=r.length?"":"none";Vi(e)}function Ki(e){Xi(e.display);Pn(e);qi(e)}function Ji(e,t,r,n){var i=this;this.input=r;i.scrollbarFiller=O("div",null,"CodeMirror-scrollbar-filler");i.scrollbarFiller.setAttribute("cm-not-content","true");i.gutterFiller=O("div",null,"CodeMirror-gutter-filler");i.gutterFiller.setAttribute("cm-not-content","true");i.lineDiv=D("div",null,"CodeMirror-code");i.selectionDiv=O("div",null,null,"position: relative; z-index: 1");i.cursorDiv=O("div",null,"CodeMirror-cursors");i.measure=O("div",null,"CodeMirror-measure");i.lineMeasure=O("div",null,"CodeMirror-measure");i.lineSpace=D("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none");var a=D("div",[i.lineSpace],"CodeMirror-lines");i.mover=O("div",[a],null,"position: relative");i.sizer=O("div",[i.mover],"CodeMirror-sizer");i.sizerWidth=null;i.heightForcer=O("div",null,null,"position: absolute; height: "+W+"px; width: 1px;");i.gutters=O("div",null,"CodeMirror-gutters");i.lineGutter=null;i.scroller=O("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll");i.scroller.setAttribute("tabIndex","-1");i.wrapper=O("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror");if(C&&S<8){i.gutters.style.zIndex=-1;i.scroller.style.paddingRight=0}if(!g&&!(p&&d)){i.scroller.draggable=true}if(e){if(e.appendChild){e.appendChild(i.wrapper)}else{e(i.wrapper)}}i.viewFrom=i.viewTo=t.first;i.reportedViewFrom=i.reportedViewTo=t.first;i.view=[];i.renderedView=null;i.externalMeasured=null;i.viewOffset=0;i.lastWrapHeight=i.lastWrapWidth=0;i.updateLineNumbers=null;i.nativeBarWidth=i.barHeight=i.barWidth=0;i.scrollbarsClipped=false;i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null;i.alignWidgets=false;i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null;i.maxLine=null;i.maxLineLength=0;i.maxLineChanged=false;i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null;i.shift=false;i.selForContextMenu=null;i.activeTouch=null;i.gutterSpecs=Gi(n.gutters,n.lineNumbers);Xi(i);r.init(i)}var Qi=0,Zi=null;if(C){Zi=-.53}else if(p){Zi=15}else if(o){Zi=-.7}else if(s){Zi=-1/3}function ea(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;if(t==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS){t=e.detail}if(r==null&&e.detail&&e.axis==e.VERTICAL_AXIS){r=e.detail}else if(r==null){r=e.wheelDelta}return{x:t,y:r}}function ta(e){var t=ea(e);t.x*=Zi;t.y*=Zi;return t}function ra(e,t){var r=ea(t),n=r.x,i=r.y;var a=e.display,o=a.scroller;var s=o.scrollWidth>o.clientWidth;var l=o.scrollHeight>o.clientHeight;if(!(n&&s||i&&l)){return}if(i&&y&&g){e:for(var u=t.target,f=a.view;u!=o;u=u.parentNode){for(var c=0;c<f.length;c++){if(f[c].node==u){e.display.currentWheelTarget=u;break e}}}}if(n&&!p&&!m&&Zi!=null){if(i&&l){ci(e,Math.max(0,o.scrollTop+i*Zi))}hi(e,Math.max(0,o.scrollLeft+n*Zi));if(!i||i&&l){Se(t)}a.wheelStartX=null;return}if(i&&Zi!=null){var d=i*Zi;var h=e.doc.scrollTop,v=h+a.wrapper.clientHeight;if(d<0){h=Math.max(0,h+d-50)}else{v=Math.min(e.doc.height,v+d+50)}Ui(e,{top:h,bottom:v})}if(Qi<20){if(a.wheelStartX==null){a.wheelStartX=o.scrollLeft;a.wheelStartY=o.scrollTop;a.wheelDX=n;a.wheelDY=i;setTimeout(function(){if(a.wheelStartX==null){return}var e=o.scrollLeft-a.wheelStartX;var t=o.scrollTop-a.wheelStartY;var r=t&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX;a.wheelStartX=a.wheelStartY=null;if(!r){return}Zi=(Zi*Qi+r)/(Qi+1);++Qi},200)}else{a.wheelDX+=n;a.wheelDY+=i}}}var na=function(e,t){this.ranges=e;this.primIndex=t};na.prototype.primary=function(){return this.ranges[this.primIndex]};na.prototype.equals=function(e){if(e==this){return true}if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length){return false}for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],n=e.ranges[t];if(!ot(r.anchor,n.anchor)||!ot(r.head,n.head)){return false}}return true};na.prototype.deepCopy=function(){var e=[];for(var t=0;t<this.ranges.length;t++){e[t]=new ia(st(this.ranges[t].anchor),st(this.ranges[t].head))}return new na(e,this.primIndex)};na.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++){if(!this.ranges[e].empty()){return true}}return false};na.prototype.contains=function(e,t){if(!t){t=e}for(var r=0;r<this.ranges.length;r++){var n=this.ranges[r];if(at(t,n.from())>=0&&at(e,n.to())<=0){return r}}return-1};var ia=function(e,t){this.anchor=e;this.head=t};ia.prototype.from=function(){return ut(this.anchor,this.head)};ia.prototype.to=function(){return lt(this.anchor,this.head)};ia.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function aa(e,t,r){var n=e&&e.options.selectionsMayTouch;var i=t[r];t.sort(function(e,t){return at(e.from(),t.from())});r=$(t,i);for(var a=1;a<t.length;a++){var o=t[a],s=t[a-1];var l=at(s.to(),o.from());if(n&&!o.empty()?l>0:l>=0){var u=ut(s.from(),o.from()),f=lt(s.to(),o.to());var c=s.empty()?o.from()==o.head:s.from()==s.head;if(a<=r){--r}t.splice(--a,2,new ia(c?f:u,c?u:f))}}return new na(t,r)}function oa(e,t){return new na([new ia(e,t||e)],0)}function sa(e){if(!e.text){return e.to}return it(e.from.line+e.text.length-1,X(e.text).length+(e.text.length==1?e.from.ch:0))}function la(e,t){if(at(e,t.from)<0){return e}if(at(e,t.to)<=0){return sa(t)}var r=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;if(e.line==t.to.line){n+=sa(t).ch-t.to.ch}return it(r,n)}function ua(e,t){var r=[];for(var n=0;n<e.sel.ranges.length;n++){var i=e.sel.ranges[n];r.push(new ia(la(i.anchor,t),la(i.head,t)))}return aa(e.cm,r,e.sel.primIndex)}function fa(e,t,r){if(e.line==t.line){return it(r.line,e.ch-t.ch+r.ch)}else{return it(r.line+(e.line-t.line),e.ch)}}function ca(e,t,r){var n=[];var i=it(e.first,0),a=i;for(var o=0;o<t.length;o++){var s=t[o];var l=fa(s.from,i,a);var u=fa(sa(s),i,a);i=s.to;a=u;if(r=="around"){var f=e.sel.ranges[o],c=at(f.head,f.anchor)<0;n[o]=new ia(c?u:l,c?l:u)}else{n[o]=new ia(l,l)}}return new na(n,e.sel.primIndex)}function da(e){e.doc.mode=je(e.options,e.doc.modeOption);ha(e)}function ha(e){e.doc.iter(function(e){if(e.stateAfter){e.stateAfter=null}if(e.styles){e.styles=null}});e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first;Mi(e,100);e.state.modeGen++;if(e.curOp){Pn(e)}}function va(e,t){return t.from.ch==0&&t.to.ch==0&&X(t.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function pa(e,n,t,i){function a(e){return t?t[e]:null}function r(e,t,r){lr(e,t,r,i);xr(e,"change",e,n)}function o(e,t){var r=[];for(var n=e;n<t;++n){r.push(new sr(u[n],a(n),i))}return r}var s=n.from,l=n.to,u=n.text;var f=Ke(e,s.line),c=Ke(e,l.line);var d=X(u),h=a(u.length-1),v=l.line-s.line;if(n.full){e.insert(0,o(0,u.length));e.remove(u.length,e.size-u.length)}else if(va(e,n)){var p=o(0,u.length-1);r(c,c.text,h);if(v){e.remove(s.line,v)}if(p.length){e.insert(s.line,p)}}else if(f==c){if(u.length==1){r(f,f.text.slice(0,s.ch)+d+f.text.slice(l.ch),h)}else{var g=o(1,u.length-1);g.push(new sr(d+f.text.slice(l.ch),h,i));r(f,f.text.slice(0,s.ch)+u[0],a(0));e.insert(s.line+1,g)}}else if(u.length==1){r(f,f.text.slice(0,s.ch)+u[0]+c.text.slice(l.ch),a(0));e.remove(s.line+1,v)}else{r(f,f.text.slice(0,s.ch)+u[0],a(0));r(c,d+c.text.slice(l.ch),h);var m=o(1,u.length-1);if(v>1){e.remove(s.line+1,v-1)}e.insert(s.line+1,m)}xr(e,"change",e,n)}function ga(e,o,s){function l(e,t,r){if(e.linked){for(var n=0;n<e.linked.length;++n){var i=e.linked[n];if(i.doc==t){continue}var a=r&&i.sharedHist;if(s&&!a){continue}o(i.doc,a);l(i.doc,e,a)}}}l(e,null,true)}function ma(e,t){if(t.cm){throw new Error("This document is already in use.")}e.doc=t;t.cm=e;Nn(e);da(e);ya(e);if(!e.options.lineWrapping){or(e)}e.options.mode=t.modeOption;Pn(e)}function ya(e){(e.doc.direction=="rtl"?N:T)(e.display.lineDiv,"CodeMirror-rtl")}function ba(e){Ii(e,function(){ya(e);Pn(e)})}function wa(e){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=e||1}function Ca(e,t){var r={from:st(t.from),to:sa(t),text:Je(e,t.from,t.to)};Da(e,r,t.from.line,t.to.line+1);ga(e,function(e){return Da(e,r,t.from.line,t.to.line+1)},true);return r}function Sa(e){while(e.length){var t=X(e);if(t.ranges){e.pop()}else{break}}}function Ea(e,t){if(t){Sa(e.done);return X(e.done)}else if(e.done.length&&!X(e.done).ranges){return X(e.done)}else if(e.done.length>1&&!e.done[e.done.length-2].ranges){e.done.pop();return X(e.done)}}function ka(e,t,r,n){var i=e.history;i.undone.length=0;var a=+new Date,o;var s;if((i.lastOp==n||i.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&i.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||t.origin.charAt(0)=="*"))&&(o=Ea(i,i.lastOp==n))){s=X(o.changes);if(at(t.from,t.to)==0&&at(t.from,s.to)==0){s.to=sa(t)}else{o.changes.push(Ca(e,t))}}else{var l=X(i.done);if(!l||!l.ranges){xa(e.sel,i.done)}o={changes:[Ca(e,t)],generation:i.generation};i.done.push(o);while(i.done.length>i.undoDepth){i.done.shift();if(!i.done[0].ranges){i.done.shift()}}}i.done.push(r);i.generation=++i.maxGeneration;i.lastModTime=i.lastSelTime=a;i.lastOp=i.lastSelOp=n;i.lastOrigin=i.lastSelOrigin=t.origin;if(!s){me(e,"historyAdded")}}function Ta(e,t,r,n){var i=t.charAt(0);return i=="*"||i=="+"&&r.ranges.length==n.ranges.length&&r.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function _a(e,t,r,n){var i=e.history,a=n&&n.origin;if(r==i.lastSelOp||a&&i.lastSelOrigin==a&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==a||Ta(e,a,X(i.done),t))){i.done[i.done.length-1]=t}else{xa(t,i.done)}i.lastSelTime=+new Date;i.lastSelOrigin=a;i.lastSelOp=r;if(n&&n.clearRedo!==false){Sa(i.undone)}}function xa(e,t){var r=X(t);if(!(r&&r.ranges&&r.equals(e))){t.push(e)}}function Da(t,r,e,n){var i=r["spans_"+t.id],a=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,n),function(e){if(e.markedSpans){(i||(i=r["spans_"+t.id]={}))[a]=e.markedSpans}++a})}function Ra(e){if(!e){return null}var t;for(var r=0;r<e.length;++r){if(e[r].marker.explicitlyCleared){if(!t){t=e.slice(0,r)}}else if(t){t.push(e[r])}}return!t?e:t.length?t:null}function Ia(e,t){var r=t["spans_"+e.id];if(!r){return null}var n=[];for(var i=0;i<t.text.length;++i){n.push(Ra(r[i]))}return n}function Oa(e,t){var r=Ia(e,t);var n=Bt(e,t);if(!r){return n}if(!n){return r}for(var i=0;i<r.length;++i){var a=r[i],o=n[i];if(a&&o){e:for(var s=0;s<o.length;++s){var l=o[s];for(var u=0;u<a.length;++u){if(a[u].marker==l.marker){continue e}}a.push(l)}}else if(o){r[i]=o}}return r}function Aa(e,t,r){var n=[];for(var i=0;i<e.length;++i){var a=e[i];if(a.ranges){n.push(r?na.prototype.deepCopy.call(a):a);continue}var o=a.changes,s=[];n.push({changes:s});for(var l=0;l<o.length;++l){var u=o[l],f=void 0;s.push({from:u.from,to:u.to,text:u.text});if(t){for(var c in u){if(f=c.match(/^spans_(\d+)$/)){if($(t,Number(f[1]))>-1){X(s)[c]=u[c];delete u[c]}}}}}}return n}function Na(e,t,r,n){if(n){var i=e.anchor;if(r){var a=at(t,i)<0;if(a!=at(r,i)<0){i=t;t=r}else if(a!=at(t,r)<0){t=r}}return new ia(i,t)}else{return new ia(r||t,t)}}function Ma(e,t,r,n,i){if(i==null){i=e.cm&&(e.cm.display.shift||e.extend)}$a(e,new na([Na(e.sel.primary(),t,r,i)],0),n)}function La(e,t,r){var n=[];var i=e.cm&&(e.cm.display.shift||e.extend);for(var a=0;a<e.sel.ranges.length;a++){n[a]=Na(e.sel.ranges[a],t[a],null,i)}var o=aa(e.cm,n,e.sel.primIndex);$a(e,o,r)}function Pa(e,t,r,n){var i=e.sel.ranges.slice(0);i[t]=r;$a(e,aa(e.cm,i,e.sel.primIndex),n)}function Fa(e,t,r,n){$a(e,oa(t,r),n)}function Ba(r,e,t){var n={ranges:e.ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++){this.ranges[t]=new ia(ct(r,e[t].anchor),ct(r,e[t].head))}},origin:t&&t.origin};me(r,"beforeSelectionChange",r,n);if(r.cm){me(r.cm,"beforeSelectionChange",r.cm,n)}if(n.ranges!=e.ranges){return aa(r.cm,n.ranges,n.ranges.length-1)}else{return e}}function Ha(e,t,r){var n=e.history.done,i=X(n);if(i&&i.ranges){n[n.length-1]=t;Wa(e,t,r)}else{$a(e,t,r)}}function $a(e,t,r){Wa(e,t,r);_a(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function Wa(e,t,r){if(we(e,"beforeSelectionChange")||e.cm&&we(e.cm,"beforeSelectionChange")){t=Ba(e,t,r)}var n=r&&r.bias||(at(t.primary().head,e.sel.primary().head)<0?-1:1);Ua(e,Va(e,t,n,true));if(!(r&&r.scroll===false)&&e.cm){oi(e.cm)}}function Ua(e,t){if(t.equals(e.sel)){return}e.sel=t;if(e.cm){e.cm.curOp.updateInput=1;e.cm.curOp.selectionChanged=true;be(e.cm)}xr(e,"cursorActivity",e)}function ja(e){Ua(e,Va(e,e.sel,null,false))}function Va(e,t,r,n){var i;for(var a=0;a<t.ranges.length;a++){var o=t.ranges[a];var s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[a];var l=qa(e,o.anchor,s&&s.anchor,r,n);var u=qa(e,o.head,s&&s.head,r,n);if(i||l!=o.anchor||u!=o.head){if(!i){i=t.ranges.slice(0,a)}i[a]=new ia(l,u)}}return i?aa(e.cm,i,t.primIndex):t}function za(e,t,r,n,i){var a=Ke(e,t.line);if(a.markedSpans){for(var o=0;o<a.markedSpans.length;++o){var s=a.markedSpans[o],l=s.marker;var u="selectLeft"in l?!l.selectLeft:l.inclusiveLeft;var f="selectRight"in l?!l.selectRight:l.inclusiveRight;if((s.from==null||(u?s.from<=t.ch:s.from<t.ch))&&(s.to==null||(f?s.to>=t.ch:s.to>t.ch))){if(i){me(l,"beforeCursorEnter");if(l.explicitlyCleared){if(!a.markedSpans){break}else{--o;continue}}}if(!l.atomic){continue}if(r){var c=l.find(n<0?1:-1),d=void 0;if(n<0?f:u){c=Ya(e,c,-n,c&&c.line==t.line?a:null)}if(c&&c.line==t.line&&(d=at(c,r))&&(n<0?d<0:d>0)){return za(e,c,t,n,i)}}var h=l.find(n<0?-1:1);if(n<0?u:f){h=Ya(e,h,n,h.line==t.line?a:null)}return h?za(e,h,t,n,i):null}}}return t}function qa(e,t,r,n,i){var a=n||1;var o=za(e,t,r,a,i)||!i&&za(e,t,r,a,true)||za(e,t,r,-a,i)||!i&&za(e,t,r,-a,true);if(!o){e.cantEdit=true;return it(e.first,0)}return o}function Ya(e,t,r,n){if(r<0&&t.ch==0){if(t.line>e.first){return ct(e,it(t.line-1))}else{return null}}else if(r>0&&t.ch==(n||Ke(e,t.line)).text.length){if(t.line<e.first+e.size-1){return it(t.line+1,0)}else{return null}}else{return new it(t.line,t.ch+r)}}function Ga(e){e.setSelection(it(e.firstLine(),0),it(e.lastLine()),j)}function Xa(i,e,t){var a={canceled:false,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return a.canceled=true}};if(t){a.update=function(e,t,r,n){if(e){a.from=ct(i,e)}if(t){a.to=ct(i,t)}if(r){a.text=r}if(n!==undefined){a.origin=n}}}me(i,"beforeChange",i,a);if(i.cm){me(i.cm,"beforeChange",i.cm,a)}if(a.canceled){if(i.cm){i.cm.curOp.updateInput=2}return null}return{from:a.from,to:a.to,text:a.text,origin:a.origin}}function Ka(e,t,r){if(e.cm){if(!e.cm.curOp){return Oi(e.cm,Ka)(e,t,r)}if(e.cm.state.suppressEdits){return}}if(we(e,"beforeChange")||e.cm&&we(e.cm,"beforeChange")){t=Xa(e,t,true);if(!t){return}}var n=Dt&&!r&&$t(e,t.from,t.to);if(n){for(var i=n.length-1;i>=0;--i){Ja(e,{from:n[i].from,to:n[i].to,text:i?[""]:t.text,origin:t.origin})}}else{Ja(e,t)}}function Ja(e,r){if(r.text.length==1&&r.text[0]==""&&at(r.from,r.to)==0){return}var t=ua(e,r);ka(e,r,t,e.cm?e.cm.curOp.id:NaN);eo(e,r,t,Bt(e,r));var n=[];ga(e,function(e,t){if(!t&&$(n,e.history)==-1){ao(e.history,r);n.push(e.history)}eo(e,r,null,Bt(e,r))})}function Qa(i,a,e){var t=i.cm&&i.cm.state.suppressEdits;if(t&&!e){return}var r=i.history,o,n=i.sel;var s=a=="undo"?r.done:r.undone,l=a=="undo"?r.undone:r.done;var u=0;for(;u<s.length;u++){o=s[u];if(e?o.ranges&&!o.equals(i.sel):!o.ranges){break}}if(u==s.length){return}r.lastOrigin=r.lastSelOrigin=null;for(;;){o=s.pop();if(o.ranges){xa(o,l);if(e&&!o.equals(i.sel)){$a(i,o,{clearRedo:false});return}n=o}else if(t){s.push(o);return}else{break}}var f=[];xa(n,l);l.push({changes:f,generation:r.generation});r.generation=o.generation||++r.maxGeneration;var c=we(i,"beforeChange")||i.cm&&we(i.cm,"beforeChange");var d=function(e){var r=o.changes[e];r.origin=a;if(c&&!Xa(i,r,false)){s.length=0;return{}}f.push(Ca(i,r));var t=e?ua(i,r):X(s);eo(i,r,t,Oa(i,r));if(!e&&i.cm){i.cm.scrollIntoView({from:r.from,to:sa(r)})}var n=[];ga(i,function(e,t){if(!t&&$(n,e.history)==-1){ao(e.history,r);n.push(e.history)}eo(e,r,null,Oa(e,r))})};for(var h=o.changes.length-1;h>=0;--h){var v=d(h);if(v)return v.v}}function Za(e,t){if(t==0){return}e.first+=t;e.sel=new na(K(e.sel.ranges,function(e){return new ia(it(e.anchor.line+t,e.anchor.ch),it(e.head.line+t,e.head.ch))}),e.sel.primIndex);if(e.cm){Pn(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,n=r.viewFrom;n<r.viewTo;n++){Fn(e.cm,n,"gutter")}}}function eo(e,t,r,n){if(e.cm&&!e.cm.curOp){return Oi(e.cm,eo)(e,t,r,n)}if(t.to.line<e.first){Za(e,t.text.length-1-(t.to.line-t.from.line));return}if(t.from.line>e.lastLine()){return}if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);Za(e,i);t={from:it(e.first,0),to:it(t.to.line+i,t.to.ch),text:[X(t.text)],origin:t.origin}}var a=e.lastLine();if(t.to.line>a){t={from:t.from,to:it(a,Ke(e,a).text.length),text:[t.text[0]],origin:t.origin}}t.removed=Je(e,t.from,t.to);if(!r){r=ua(e,t)}if(e.cm){to(e.cm,t,n)}else{pa(e,t,n)}Wa(e,r,j);if(e.cantEdit&&qa(e,it(e.firstLine(),0))){e.cantEdit=false}}function to(e,t,r){var n=e.doc,i=e.display,a=t.from,o=t.to;var s=false,l=a.line;if(!e.options.lineWrapping){l=et(Jt(Ke(n,a.line)));n.iter(l,o.line+1,function(e){if(e==i.maxLine){s=true;return true}})}if(n.sel.contains(t.from,t.to)>-1){be(e)}pa(n,t,r,An(e));if(!e.options.lineWrapping){n.iter(l,a.line+t.text.length,function(e){var t=ar(e);if(t>i.maxLineLength){i.maxLine=e;i.maxLineLength=t;i.maxLineChanged=true;s=false}});if(s){e.curOp.updateMaxLine=true}}xt(n,a.line);Mi(e,400);var u=t.text.length-(o.line-a.line)-1;if(t.full){Pn(e)}else if(a.line==o.line&&t.text.length==1&&!va(e.doc,t)){Fn(e,a.line,"text")}else{Pn(e,a.line,o.line+1,u)}var f=we(e,"changes"),c=we(e,"change");if(c||f){var d={from:a,to:o,text:t.text,removed:t.removed,origin:t.origin};if(c){xr(e,"change",e,d)}if(f){(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(d)}}e.display.selForContextMenu=null}function ro(e,t,r,n,i){var a;if(!n){n=r}if(at(n,r)<0){a=[n,r],r=a[0],n=a[1]}if(typeof t=="string"){t=e.splitLines(t)}Ka(e,{from:r,to:n,text:t,origin:i})}function no(e,t,r,n){if(r<e.line){e.line+=n}else if(t<e.line){e.line=t;e.ch=0}}function io(e,t,r,n){for(var i=0;i<e.length;++i){var a=e[i],o=true;if(a.ranges){if(!a.copied){a=e[i]=a.deepCopy();a.copied=true}for(var s=0;s<a.ranges.length;s++){no(a.ranges[s].anchor,t,r,n);no(a.ranges[s].head,t,r,n)}continue}for(var l=0;l<a.changes.length;++l){var u=a.changes[l];if(r<u.from.line){u.from=it(u.from.line+n,u.from.ch);u.to=it(u.to.line+n,u.to.ch)}else if(t<=u.to.line){o=false;break}}if(!o){e.splice(0,i+1);i=0}}}function ao(e,t){var r=t.from.line,n=t.to.line,i=t.text.length-(n-r)-1;io(e.done,r,n,i);io(e.undone,r,n,i)}function oo(e,t,r,n){var i=t,a=t;if(typeof t=="number"){a=Ke(e,ft(e,t))}else{i=et(t)}if(i==null){return null}if(n(a,i)&&e.cm){Fn(e.cm,i,r)}return a}function so(e){this.lines=e;this.parent=null;var t=0;for(var r=0;r<e.length;++r){e[r].parent=this;t+=e[r].height}this.height=t}so.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r=e,n=e+t;r<n;++r){var i=this.lines[r];this.height-=i.height;ur(i);xr(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r;this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n){t[n].parent=this}},iterN:function(e,t,r){for(var n=e+t;e<n;++e){if(r(this.lines[e])){return true}}}};function lo(e){this.children=e;var t=0,r=0;for(var n=0;n<e.length;++n){var i=e[n];t+=i.chunkSize();r+=i.height;i.parent=this}this.size=t;this.height=r;this.parent=null}lo.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r=0;r<this.children.length;++r){var n=this.children[r],i=n.chunkSize();if(e<i){var a=Math.min(t,i-e),o=n.height;n.removeInner(e,a);this.height-=o-n.height;if(i==a){this.children.splice(r--,1);n.parent=null}if((t-=a)==0){break}e=0}else{e-=i}}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof so))){var s=[];this.collapse(s);this.children=[new so(s)];this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t){this.children[t].collapse(e)}},insertInner:function(e,t,r){this.size+=t.length;this.height+=r;for(var n=0;n<this.children.length;++n){var i=this.children[n],a=i.chunkSize();if(e<=a){i.insertInner(e,t,r);if(i.lines&&i.lines.length>50){var o=i.lines.length%25+25;for(var s=o;s<i.lines.length;){var l=new so(i.lines.slice(s,s+=25));i.height-=l.height;this.children.splice(++n,0,l);l.parent=this}i.lines=i.lines.slice(0,o);this.maybeSpill()}break}e-=a}},maybeSpill:function(){if(this.children.length<=10){return}var e=this;do{var t=e.children.splice(e.children.length-5,5);var r=new lo(t);if(!e.parent){var n=new lo(e.children);n.parent=e;e.children=[n,r];e=n}else{e.size-=r.size;e.height-=r.height;var i=$(e.parent.children,e);e.parent.children.splice(i+1,0,r)}r.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()},iterN:function(e,t,r){for(var n=0;n<this.children.length;++n){var i=this.children[n],a=i.chunkSize();if(e<a){var o=Math.min(t,a-e);if(i.iterN(e,o,r)){return true}if((t-=o)==0){break}e=0}else{e-=a}}}};var uo=function(e,t,r){if(r){for(var n in r){if(r.hasOwnProperty(n)){this[n]=r[n]}}}this.doc=e;this.node=t};uo.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,n=et(r);if(n==null||!t){return}for(var i=0;i<t.length;++i){if(t[i]==this){t.splice(i--,1)}}if(!t.length){r.widgets=null}var a=Wr(this);Ze(r,Math.max(0,r.height-a));if(e){Ii(e,function(){fo(e,r,-a);Fn(e,n,"widget")});xr(e,"lineWidgetCleared",e,this,n)}};uo.prototype.changed=function(){var e=this;var t=this.height,r=this.doc.cm,n=this.line;this.height=null;var i=Wr(this)-t;if(!i){return}if(!rr(this.doc,n)){Ze(n,n.height+i)}if(r){Ii(r,function(){r.curOp.forceUpdate=true;fo(r,n,i);xr(r,"lineWidgetChanged",r,e,et(n))})}};Ce(uo);function fo(e,t,r){if(ir(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)){ai(e,r)}}function co(n,e,t,r){var i=new uo(n,t,r);var a=n.cm;if(a&&i.noHScroll){a.display.alignWidgets=true}oo(n,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);if(i.insertAt==null){t.push(i)}else{t.splice(Math.min(t.length-1,Math.max(0,i.insertAt)),0,i)}i.line=e;if(a&&!rr(n,e)){var r=ir(e)<n.scrollTop;Ze(e,e.height+Wr(i));if(r){ai(a,i.height)}a.curOp.forceUpdate=true}return true});if(a){xr(a,"lineWidgetAdded",a,i,typeof e=="number"?e:et(e))}return i}var ho=0;var vo=function(e,t){this.lines=[];this.type=t;this.doc=e;this.id=++ho};vo.prototype.clear=function(){if(this.explicitlyCleared){return}var e=this.doc.cm,t=e&&!e.curOp;if(t){Si(e)}if(we(this,"clear")){var r=this.find();if(r){xr(this,"clear",r.from,r.to)}}var n=null,i=null;for(var a=0;a<this.lines.length;++a){var o=this.lines[a];var s=Nt(o.markedSpans,this);if(e&&!this.collapsed){Fn(e,et(o),"text")}else if(e){if(s.to!=null){i=et(o)}if(s.from!=null){n=et(o)}}o.markedSpans=Mt(o.markedSpans,s);if(s.from==null&&this.collapsed&&!rr(this.doc,o)&&e){Ze(o,Dn(e.display))}}if(e&&this.collapsed&&!e.options.lineWrapping){for(var l=0;l<this.lines.length;++l){var u=Jt(this.lines[l]),f=ar(u);if(f>e.display.maxLineLength){e.display.maxLine=u;e.display.maxLineLength=f;e.display.maxLineChanged=true}}}if(n!=null&&e&&this.collapsed){Pn(e,n,i+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(e){ja(e.doc)}}if(e){xr(e,"markerCleared",e,this,n,i)}if(t){Ei(e)}if(this.parent){this.parent.clear()}};vo.prototype.find=function(e,t){if(e==null&&this.type=="bookmark"){e=1}var r,n;for(var i=0;i<this.lines.length;++i){var a=this.lines[i];var o=Nt(a.markedSpans,this);if(o.from!=null){r=it(t?a:et(a),o.from);if(e==-1){return r}}if(o.to!=null){n=it(t?a:et(a),o.to);if(e==1){return n}}}return r&&{from:r,to:n}};vo.prototype.changed=function(){var a=this;var o=this.find(-1,true),s=this,l=this.doc.cm;if(!o||!l){return}Ii(l,function(){var e=o.line,t=et(o.line);var r=Zr(l,t);if(r){ln(r);l.curOp.selectionChanged=l.curOp.forceUpdate=true}l.curOp.updateMaxLine=true;if(!rr(s.doc,e)&&s.height!=null){var n=s.height;s.height=null;var i=Wr(s)-n;if(i){Ze(e,e.height+i)}}xr(l,"markerChanged",l,a)})};vo.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;if(!t.maybeHiddenMarkers||$(t.maybeHiddenMarkers,this)==-1){(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(e)};vo.prototype.detachLine=function(e){this.lines.splice($(this.lines,e),1);if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};Ce(vo);function po(t,r,n,e,i){if(e&&e.shared){return mo(t,r,n,e,i)}if(t.cm&&!t.cm.curOp){return Oi(t.cm,po)(t,r,n,e,i)}var a=new vo(t,i),o=at(r,n);if(e){F(e,a,false)}if(o>0||o==0&&a.clearWhenEmpty!==false){return a}if(a.replacedWith){a.collapsed=true;a.widgetNode=D("span",[a.replacedWith],"CodeMirror-widget");if(!e.handleMouseEvents){a.widgetNode.setAttribute("cm-ignore-events","true")}if(e.insertLeft){a.widgetNode.insertLeft=true}}if(a.collapsed){if(Kt(t,r.line,r,n,a)||r.line!=n.line&&Kt(t,n.line,r,n,a)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}Ot()}if(a.addToHistory){ka(t,{from:r,to:n,origin:"markText"},t.sel,NaN)}var s=r.line,l=t.cm,u;t.iter(s,n.line+1,function(e){if(l&&a.collapsed&&!l.options.lineWrapping&&Jt(e)==l.display.maxLine){u=true}if(a.collapsed&&s!=r.line){Ze(e,0)}Lt(e,new At(a,s==r.line?r.ch:null,s==n.line?n.ch:null));++s});if(a.collapsed){t.iter(r.line,n.line+1,function(e){if(rr(t,e)){Ze(e,0)}})}if(a.clearOnEnter){ve(a,"beforeCursorEnter",function(){return a.clear()})}if(a.readOnly){It();if(t.history.done.length||t.history.undone.length){t.clearHistory()}}if(a.collapsed){a.id=++ho;a.atomic=true}if(l){if(u){l.curOp.updateMaxLine=true}if(a.collapsed){Pn(l,r.line,n.line+1)}else if(a.className||a.startStyle||a.endStyle||a.css||a.attributes||a.title){for(var f=r.line;f<=n.line;f++){Fn(l,f,"text")}}if(a.atomic){ja(l.doc)}xr(l,"markerAdded",l,a)}return a}var go=function(e,t){this.markers=e;this.primary=t;for(var r=0;r<e.length;++r){e[r].parent=this}};go.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var e=0;e<this.markers.length;++e){this.markers[e].clear()}xr(this,"clear")};go.prototype.find=function(e,t){return this.primary.find(e,t)};Ce(go);function mo(e,r,n,i,a){i=F(i);i.shared=false;var o=[po(e,r,n,i,a)],s=o[0];var l=i.widgetNode;ga(e,function(e){if(l){i.widgetNode=l.cloneNode(true)}o.push(po(e,ct(e,r),ct(e,n),i,a));for(var t=0;t<e.linked.length;++t){if(e.linked[t].isParent){return}}s=X(o)});return new go(o,s)}function yo(e){return e.findMarks(it(e.first,0),e.clipPos(it(e.lastLine())),function(e){return e.parent})}function bo(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.find();var a=e.clipPos(i.from),o=e.clipPos(i.to);if(at(a,o)){var s=po(e,a,o,n.primary,n.primary.type);n.markers.push(s);s.parent=n}}}function wo(a){var e=function(e){var t=a[e],r=[t.primary.doc];ga(t.primary.doc,function(e){return r.push(e)});for(var n=0;n<t.markers.length;n++){var i=t.markers[n];if($(r,i.doc)==-1){i.parent=null;t.markers.splice(n--,1)}}};for(var t=0;t<a.length;t++)e(t)}var Co=0;var So=function(e,t,r,n,i){if(!(this instanceof So)){return new So(e,t,r,n,i)}if(r==null){r=0}lo.call(this,[new so([new sr("",null)])]);this.first=r;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=r;var a=it(r,0);this.sel=oa(a);this.history=new wa(null);this.id=++Co;this.modeOption=t;this.lineSep=n;this.direction=i=="rtl"?"rtl":"ltr";this.extend=false;if(typeof e=="string"){e=this.splitLines(e)}pa(this,{from:a,to:a,text:e});$a(this,oa(a),j)};So.prototype=Z(lo.prototype,{constructor:So,iter:function(e,t,r){if(r){this.iterN(e-this.first,t-e,r)}else{this.iterN(this.first,this.first+this.size,e)}},insert:function(e,t){var r=0;for(var n=0;n<t.length;++n){r+=t[n].height}this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Qe(this,this.first,this.first+this.size);if(e===false){return t}return t.join(e||this.lineSeparator())},setValue:Ni(function(e){var t=it(this.first,0),r=this.first+this.size-1;Ka(this,{from:t,to:it(r,Ke(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:true},true);if(this.cm){si(this.cm,0,0)}$a(this,oa(t),j)}),replaceRange:function(e,t,r,n){t=ct(this,t);r=r?ct(this,r):t;ro(this,e,t,r,n)},getRange:function(e,t,r){var n=Je(this,ct(this,e),ct(this,t));if(r===false){return n}return n.join(r||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(rt(this,e)){return Ke(this,e)}},getLineNumber:function(e){return et(e)},getLineHandleVisualStart:function(e){if(typeof e=="number"){e=Ke(this,e)}return Jt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return ct(this,e)},getCursor:function(e){var t=this.sel.primary(),r;if(e==null||e=="head"){r=t.head}else if(e=="anchor"){r=t.anchor}else if(e=="end"||e=="to"||e===false){r=t.to()}else{r=t.from()}return r},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ni(function(e,t,r){Fa(this,ct(this,typeof e=="number"?it(e,t||0):e),null,r)}),setSelection:Ni(function(e,t,r){Fa(this,ct(this,e),ct(this,t||e),r)}),extendSelection:Ni(function(e,t,r){Ma(this,ct(this,e),t&&ct(this,t),r)}),extendSelections:Ni(function(e,t){La(this,ht(this,e),t)}),extendSelectionsBy:Ni(function(e,t){var r=K(this.sel.ranges,e);La(this,ht(this,r),t)}),setSelections:Ni(function(e,t,r){if(!e.length){return}var n=[];for(var i=0;i<e.length;i++){n[i]=new ia(ct(this,e[i].anchor),ct(this,e[i].head))}if(t==null){t=Math.min(e.length-1,this.sel.primIndex)}$a(this,aa(this.cm,n,t),r)}),addSelection:Ni(function(e,t,r){var n=this.sel.ranges.slice(0);n.push(new ia(ct(this,e),ct(this,t||e)));$a(this,aa(this.cm,n,n.length-1),r)}),getSelection:function(e){var t=this.sel.ranges,r;for(var n=0;n<t.length;n++){var i=Je(this,t[n].from(),t[n].to());r=r?r.concat(i):i}if(e===false){return r}else{return r.join(e||this.lineSeparator())}},getSelections:function(e){var t=[],r=this.sel.ranges;for(var n=0;n<r.length;n++){var i=Je(this,r[n].from(),r[n].to());if(e!==false){i=i.join(e||this.lineSeparator())}t[n]=i}return t},replaceSelection:function(e,t,r){var n=[];for(var i=0;i<this.sel.ranges.length;i++){n[i]=e}this.replaceSelections(n,t,r||"+input")},replaceSelections:Ni(function(e,t,r){var n=[],i=this.sel;for(var a=0;a<i.ranges.length;a++){var o=i.ranges[a];n[a]={from:o.from(),to:o.to(),text:this.splitLines(e[a]),origin:r}}var s=t&&t!="end"&&ca(this,n,t);for(var l=n.length-1;l>=0;l--){Ka(this,n[l])}if(s){Ha(this,s)}else if(this.cm){oi(this.cm)}}),undo:Ni(function(){Qa(this,"undo")}),redo:Ni(function(){Qa(this,"redo")}),undoSelection:Ni(function(){Qa(this,"undo",true)}),redoSelection:Ni(function(){Qa(this,"redo",true)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){var e=this.history,t=0,r=0;for(var n=0;n<e.done.length;n++){if(!e.done[n].ranges){++t}}for(var i=0;i<e.undone.length;i++){if(!e.undone[i].ranges){++r}}return{undo:t,redo:r}},clearHistory:function(){this.history=new wa(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(e){if(e){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Aa(this.history.done),undone:Aa(this.history.undone)}},setHistory:function(e){var t=this.history=new wa(this.history.maxGeneration);t.done=Aa(e.done.slice(0),null,true);t.undone=Aa(e.undone.slice(0),null,true)},setGutterMarker:Ni(function(e,r,n){return oo(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});t[r]=n;if(!n&&ne(t)){e.gutterMarkers=null}return true})}),clearGutter:Ni(function(t){var r=this;this.iter(function(e){if(e.gutterMarkers&&e.gutterMarkers[t]){oo(r,e,"gutter",function(){e.gutterMarkers[t]=null;if(ne(e.gutterMarkers)){e.gutterMarkers=null}return true})}})}),lineInfo:function(e){var t;if(typeof e=="number"){if(!rt(this,e)){return null}t=e;e=Ke(this,e);if(!e){return null}}else{t=et(e);if(t==null){return null}}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Ni(function(e,r,n){return oo(this,e,r=="gutter"?"gutter":"class",function(e){var t=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass";if(!e[t]){e[t]=n}else if(k(n).test(e[t])){return false}else{e[t]+=" "+n}return true})}),removeLineClass:Ni(function(e,a,o){return oo(this,e,a=="gutter"?"gutter":"class",function(e){var t=a=="text"?"textClass":a=="background"?"bgClass":a=="gutter"?"gutterClass":"wrapClass";var r=e[t];if(!r){return false}else if(o==null){e[t]=null}else{var n=r.match(k(o));if(!n){return false}var i=n.index+n[0].length;e[t]=r.slice(0,n.index)+(!n.index||i==r.length?"":" ")+r.slice(i)||null}return true})}),addLineWidget:Ni(function(e,t,r){return co(this,e,t,r)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return po(this,ct(this,e),ct(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){var r={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:false,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};e=ct(this,e);return po(this,e,e,r,"bookmark")},findMarksAt:function(e){e=ct(this,e);var t=[],r=Ke(this,e.line).markedSpans;if(r){for(var n=0;n<r.length;++n){var i=r[n];if((i.from==null||i.from<=e.ch)&&(i.to==null||i.to>=e.ch)){t.push(i.marker.parent||i.marker)}}}return t},findMarks:function(i,a,o){i=ct(this,i);a=ct(this,a);var s=[],l=i.line;this.iter(i.line,a.line+1,function(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;r++){var n=t[r];if(!(n.to!=null&&l==i.line&&i.ch>=n.to||n.from==null&&l!=i.line||n.from!=null&&l==a.line&&n.from>=a.ch)&&(!o||o(n.marker))){s.push(n.marker.parent||n.marker)}}}++l});return s},getAllMarks:function(){var n=[];this.iter(function(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r){if(t[r].from!=null){n.push(t[r].marker)}}}});return n},posFromIndex:function(r){var n,i=this.first,a=this.lineSeparator().length;this.iter(function(e){var t=e.text.length+a;if(t>r){n=r;return true}r-=t;++i});return ct(this,it(i,n))},indexFromPos:function(e){e=ct(this,e);var t=e.ch;if(e.line<this.first||e.ch<0){return 0}var r=this.lineSeparator().length;this.iter(this.first,e.line,function(e){t+=e.text.length+r});return t},copy:function(e){var t=new So(Qe(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);t.scrollTop=this.scrollTop;t.scrollLeft=this.scrollLeft;t.sel=this.sel;t.extend=false;if(e){t.history.undoDepth=this.history.undoDepth;t.setHistory(this.getHistory())}return t},linkedDoc:function(e){if(!e){e={}}var t=this.first,r=this.first+this.size;if(e.from!=null&&e.from>t){t=e.from}if(e.to!=null&&e.to<r){r=e.to}var n=new So(Qe(this,t,r),e.mode||this.modeOption,t,this.lineSep,this.direction);if(e.sharedHist){n.history=this.history}(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist});n.linked=[{doc:this,isParent:true,sharedHist:e.sharedHist}];bo(n,yo(this));return n},unlinkDoc:function(e){if(e instanceof Ps){e=e.doc}if(this.linked){for(var t=0;t<this.linked.length;++t){var r=this.linked[t];if(r.doc!=e){continue}this.linked.splice(t,1);e.unlinkDoc(this);wo(yo(this));break}}if(e.history==this.history){var n=[e.id];ga(e,function(e){return n.push(e.id)},true);e.history=new wa(null);e.history.done=Aa(this.history.done,n);e.history.undone=Aa(this.history.undone,n)}},iterLinkedDocs:function(e){ga(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){if(this.lineSep){return e.split(this.lineSep)}return Ne(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Ni(function(e){if(e!="rtl"){e="ltr"}if(e==this.direction){return}this.direction=e;this.iter(function(e){return e.order=null});if(this.cm){ba(this.cm)}})});So.prototype.eachLine=So.prototype.iter;var Eo=0;function ko(e){var i=this;xo(i);if(ye(i,e)||Ur(i.display,e)){return}Se(e);if(C){Eo=+new Date}var a=Mn(i,e,true),t=e.dataTransfer.files;if(!a||i.isReadOnly()){return}if(t&&t.length&&window.FileReader&&window.File){var o=t.length,s=Array(o),l=0;var r=function(e,r){if(i.options.allowDropFileTypes&&$(i.options.allowDropFileTypes,e.type)==-1){return}var n=new FileReader;n.onload=Oi(i,function(){var e=n.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)){e=""}s[r]=e;if(++l==o){a=ct(i.doc,a);var t={from:a,to:a,text:i.doc.splitLines(s.join(i.doc.lineSeparator())),origin:"paste"};Ka(i.doc,t);Ha(i.doc,oa(a,sa(t)))}});n.readAsText(e)};for(var n=0;n<o;++n){r(t[n],n)}}else{if(i.state.draggingText&&i.doc.sel.contains(a)>-1){i.state.draggingText(e);setTimeout(function(){return i.display.input.focus()},20);return}try{var u=e.dataTransfer.getData("Text");if(u){var f;if(i.state.draggingText&&!i.state.draggingText.copy){f=i.listSelections()}Wa(i.doc,oa(a,a));if(f){for(var c=0;c<f.length;++c){ro(i.doc,"",f[c].anchor,f[c].head,"drag")}}i.replaceSelection(u,"around","paste");i.display.input.focus()}}catch(e){}}}function To(e,t){if(C&&(!e.state.draggingText||+new Date-Eo<100)){Te(t);return}if(ye(e,t)||Ur(e.display,t)){return}t.dataTransfer.setData("Text",e.getSelection());t.dataTransfer.effectAllowed="copyMove";if(t.dataTransfer.setDragImage&&!s){var r=O("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(m){r.width=r.height=1;e.display.wrapper.appendChild(r);r._top=r.offsetTop}t.dataTransfer.setDragImage(r,0,0);if(m){r.parentNode.removeChild(r)}}}function _o(e,t){var r=Mn(e,t);if(!r){return}var n=document.createDocumentFragment();Vn(e,r,n);if(!e.display.dragCursor){e.display.dragCursor=O("div",null,"CodeMirror-cursors CodeMirror-dragcursors");e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)}x(e.display.dragCursor,n)}function xo(e){if(e.display.dragCursor){e.display.lineSpace.removeChild(e.display.dragCursor);e.display.dragCursor=null}}function Do(t){if(!document.getElementsByClassName){return}var e=document.getElementsByClassName("CodeMirror"),r=[];for(var n=0;n<e.length;n++){var i=e[n].CodeMirror;if(i){r.push(i)}}if(r.length){r[0].operation(function(){for(var e=0;e<r.length;e++){t(r[e])}})}}var Ro=false;function Io(){if(Ro){return}Oo();Ro=true}function Oo(){var e;ve(window,"resize",function(){if(e==null){e=setTimeout(function(){e=null;Do(Ao)},100)}});ve(window,"blur",function(){return Do(Jn)})}function Ao(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null;t.scrollbarsClipped=false;e.setSize()}var No={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};for(var Mo=0;Mo<10;Mo++){No[Mo+48]=No[Mo+96]=String(Mo)}for(var Lo=65;Lo<=90;Lo++){No[Lo]=String.fromCharCode(Lo)}for(var Po=1;Po<=12;Po++){No[Po+111]=No[Po+63235]="F"+Po}var Fo={};Fo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};Fo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};Fo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};Fo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};Fo["default"]=y?Fo.macDefault:Fo.pcDefault;function Bo(e){var t=e.split(/-(?!$)/);e=t[t.length-1];var r,n,i,a;for(var o=0;o<t.length-1;o++){var s=t[o];if(/^(cmd|meta|m)$/i.test(s)){a=true}else if(/^a(lt)?$/i.test(s)){r=true}else if(/^(c|ctrl|control)$/i.test(s)){n=true}else if(/^s(hift)?$/i.test(s)){i=true}else{throw new Error("Unrecognized modifier name: "+s)}}if(r){e="Alt-"+e}if(n){e="Ctrl-"+e}if(a){e="Cmd-"+e}if(i){e="Shift-"+e}return e}function Ho(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){var n=e[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r)){continue}if(n=="..."){delete e[r];continue}var i=K(r.split(" "),Bo);for(var a=0;a<i.length;a++){var o=void 0,s=void 0;if(a==i.length-1){s=i.join(" ");o=n}else{s=i.slice(0,a+1).join(" ");o="..."}var l=t[s];if(!l){t[s]=o}else if(l!=o){throw new Error("Inconsistent bindings for "+s)}}delete e[r]}}for(var u in t){e[u]=t[u]}return e}function $o(e,t,r,n){t=Vo(t);var i=t.call?t.call(e,n):t[e];if(i===false){return"nothing"}if(i==="..."){return"multi"}if(i!=null&&r(i)){return"handled"}if(t.fallthrough){if(Object.prototype.toString.call(t.fallthrough)!="[object Array]"){return $o(e,t.fallthrough,r,n)}for(var a=0;a<t.fallthrough.length;a++){var o=$o(e,t.fallthrough[a],r,n);if(o){return o}}}}function Wo(e){var t=typeof e=="string"?e:No[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"}function Uo(e,t,r){var n=e;if(t.altKey&&n!="Alt"){e="Alt-"+e}if((w?t.metaKey:t.ctrlKey)&&n!="Ctrl"){e="Ctrl-"+e}if((w?t.ctrlKey:t.metaKey)&&n!="Cmd"){e="Cmd-"+e}if(!r&&t.shiftKey&&n!="Shift"){e="Shift-"+e}return e}function jo(e,t){if(m&&e.keyCode==34&&e["char"]){return false}var r=No[e.keyCode];if(r==null||e.altGraphKey){return false}if(e.keyCode==3&&e.code){r=e.code}return Uo(r,e,t)}function Vo(e){return typeof e=="string"?Fo[e]:e}function zo(t,e){var r=t.doc.sel.ranges,n=[];for(var i=0;i<r.length;i++){var a=e(r[i]);while(n.length&&at(a.from,X(n).to)<=0){var o=n.pop();if(at(o.from,a.from)<0){a.from=o.from;break}}n.push(a)}Ii(t,function(){for(var e=n.length-1;e>=0;e--){ro(t.doc,"",n[e].from,n[e].to,"+delete")}oi(t)})}function qo(e,t,r){var n=oe(e.text,t+r,r);return n<0||n>e.text.length?null:n}function Yo(e,t,r){var n=qo(e,t.ch,r);return n==null?null:new it(t.line,n,r<0?"after":"before")}function Go(e,t,r,n,i){if(e){var a=de(r,t.doc.direction);if(a){var o=i<0?X(a):a[0];var s=i<0==(o.level==1);var l=s?"after":"before";var u;if(o.level>0||t.doc.direction=="rtl"){var f=en(t,r);u=i<0?r.text.length-1:0;var c=tn(t,f,u).top;u=se(function(e){return tn(t,f,e).top==c},i<0==(o.level==1)?o.from:o.to-1,u);if(l=="before"){u=qo(r,u,1)}}else{u=i<0?o.to:o.from}return new it(n,u,l)}}return new it(n,i<0?r.text.length:0,i<0?"before":"after")}function Xo(t,r,s,e){var l=de(r,t.doc.direction);if(!l){return Yo(r,s,e)}if(s.ch>=r.text.length){s.ch=r.text.length;s.sticky="before"}else if(s.ch<=0){s.ch=0;s.sticky="after"}var n=fe(l,s.ch,s.sticky),i=l[n];if(t.doc.direction=="ltr"&&i.level%2==0&&(e>0?i.to>s.ch:i.from<s.ch)){return Yo(r,s,e)}var u=function(e,t){return qo(r,e instanceof it?e.ch:e,t)};var a;var o=function(e){if(!t.options.lineWrapping){return{begin:0,end:r.text.length}}a=a||en(t,r);return Sn(t,r,a,e)};var f=o(s.sticky=="before"?u(s,-1):s.ch);if(t.doc.direction=="rtl"||i.level==1){var c=i.level==1==e<0;var d=u(s,c?1:-1);if(d!=null&&(!c?d>=i.from&&d>=f.begin:d<=i.to&&d<=f.end)){var h=c?"before":"after";return new it(s.line,d,h)}}var v=function(e,t,r){var n=function(e,t){return t?new it(s.line,u(e,1),"before"):new it(s.line,e,"after")};for(;e>=0&&e<l.length;e+=t){var i=l[e];var a=t>0==(i.level!=1);var o=a?r.begin:u(r.end,-1);if(i.from<=o&&o<i.to){return n(o,a)}o=a?i.from:u(i.to,-1);if(r.begin<=o&&o<r.end){return n(o,a)}}};var p=v(n+e,e,f);if(p){return p}var g=e>0?f.end:u(f.begin,-1);if(g!=null&&!(e>0&&g==r.text.length)){p=v(e>0?0:l.length-1,e,o(g));if(p){return p}}return null}var Ko={selectAll:Ga,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),j)},killLine:function(r){return zo(r,function(e){if(e.empty()){var t=Ke(r.doc,e.head.line).text.length;if(e.head.ch==t&&e.head.line<r.lastLine()){return{from:e.head,to:it(e.head.line+1,0)}}else{return{from:e.head,to:it(e.head.line,t)}}}else{return{from:e.from(),to:e.to()}}})},deleteLine:function(t){return zo(t,function(e){return{from:it(e.from().line,0),to:ct(t.doc,it(e.to().line+1,0))}})},delLineLeft:function(e){return zo(e,function(e){return{from:it(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(n){return zo(n,function(e){var t=n.charCoords(e.head,"div").top+5;var r=n.coordsChar({left:0,top:t},"div");return{from:r,to:e.from()}})},delWrappedLineRight:function(n){return zo(n,function(e){var t=n.charCoords(e.head,"div").top+5;var r=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:r}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(it(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(it(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Jo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return Zo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return Qo(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(r){return r.extendSelectionsBy(function(e){var t=r.cursorCoords(e.head,"div").top+5;return r.coordsChar({left:r.display.lineDiv.offsetWidth+100,top:t},"div")},z)},goLineLeft:function(r){return r.extendSelectionsBy(function(e){var t=r.cursorCoords(e.head,"div").top+5;return r.coordsChar({left:0,top:t},"div")},z)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(e){var t=n.cursorCoords(e.head,"div").top+5;var r=n.coordsChar({left:0,top:t},"div");if(r.ch<n.getLine(r.line).search(/\S/)){return Zo(n,e.head)}return r},z)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){var t=[],r=e.listSelections(),n=e.options.tabSize;for(var i=0;i<r.length;i++){var a=r[i].from();var o=B(e.getLine(a.line),a.ch,n);t.push(G(n-o%n))}e.replaceSelections(t)},defaultTab:function(e){if(e.somethingSelected()){e.indentSelection("add")}else{e.execCommand("insertTab")}},transposeChars:function(o){return Ii(o,function(){var e=o.listSelections(),t=[];for(var r=0;r<e.length;r++){if(!e[r].empty()){continue}var n=e[r].head,i=Ke(o.doc,n.line).text;if(i){if(n.ch==i.length){n=new it(n.line,n.ch-1)}if(n.ch>0){n=new it(n.line,n.ch+1);o.replaceRange(i.charAt(n.ch-1)+i.charAt(n.ch-2),it(n.line,n.ch-2),n,"+transpose")}else if(n.line>o.doc.first){var a=Ke(o.doc,n.line-1).text;if(a){n=new it(n.line,1);o.replaceRange(i.charAt(0)+o.doc.lineSeparator()+a.charAt(a.length-1),it(n.line-1,a.length-1),n,"+transpose")}}}t.push(new ia(n,n))}o.setSelections(t)})},newlineAndIndent:function(n){return Ii(n,function(){var e=n.listSelections();for(var t=e.length-1;t>=0;t--){n.replaceRange(n.doc.lineSeparator(),e[t].anchor,e[t].head,"+input")}e=n.listSelections();for(var r=0;r<e.length;r++){n.indentLine(e[r].from().line,null,true)}oi(n)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Jo(e,t){var r=Ke(e.doc,t);var n=Jt(r);if(n!=r){t=et(n)}return Go(true,e,n,t,1)}function Qo(e,t){var r=Ke(e.doc,t);var n=Qt(r);if(n!=r){t=et(n)}return Go(true,e,r,t,-1)}function Zo(e,t){var r=Jo(e,t.line);var n=Ke(e.doc,r.line);var i=de(n,e.doc.direction);if(!i||i[0].level==0){var a=Math.max(0,n.text.search(/\S/));var o=t.line==r.line&&t.ch<=a&&t.ch;return it(r.line,o?0:a,r.sticky)}return r}function es(e,t,r){if(typeof t=="string"){t=Ko[t];if(!t){return false}}e.display.input.ensurePolled();var n=e.display.shift,i=false;try{if(e.isReadOnly()){e.state.suppressEdits=true}if(r){e.display.shift=false}i=t(e)!=U}finally{e.display.shift=n;e.state.suppressEdits=false}return i}function ts(e,t,r){for(var n=0;n<e.state.keyMaps.length;n++){var i=$o(t,e.state.keyMaps[n],r,e);if(i){return i}}return e.options.extraKeys&&$o(t,e.options.extraKeys,r,e)||$o(t,e.options.keyMap,r,e)}var rs=new H;function ns(e,t,r,n){var i=e.state.keySeq;if(i){if(Wo(t)){return"handled"}if(/\'$/.test(t)){e.state.keySeq=null}else{rs.set(50,function(){if(e.state.keySeq==i){e.state.keySeq=null;e.display.input.reset()}})}if(is(e,i+" "+t,r,n)){return true}}return is(e,t,r,n)}function is(e,t,r,n){var i=ts(e,t,n);if(i=="multi"){e.state.keySeq=t}if(i=="handled"){xr(e,"keyHandled",e,t,r)}if(i=="handled"||i=="multi"){Se(r);Yn(e)}return!!i}function as(t,e){var r=jo(e,true);if(!r){return false}if(e.shiftKey&&!t.state.keySeq){return ns(t,"Shift-"+r,e,function(e){return es(t,e,true)})||ns(t,r,e,function(e){if(typeof e=="string"?/^go[A-Z]/.test(e):e.motion){return es(t,e)}})}else{return ns(t,r,e,function(e){return es(t,e)})}}function os(t,e,r){return ns(t,"'"+r+"'",e,function(e){return es(t,e,true)})}var ss=null;function ls(e){var t=this;t.curOp.focus=A();if(ye(t,e)){return}if(C&&S<11&&e.keyCode==27){e.returnValue=false}var r=e.keyCode;t.display.shift=r==16||e.shiftKey;var n=as(t,e);if(m){ss=n?r:null;if(!n&&r==88&&!Le&&(y?e.metaKey:e.ctrlKey)){t.replaceSelection("",null,"cut")}}if(p&&!y&&!n&&r==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand){document.execCommand("cut")}if(r==18&&!/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)){us(t)}}function us(e){var t=e.display.lineDiv;N(t,"CodeMirror-crosshair");function r(e){if(e.keyCode==18||!e.altKey){T(t,"CodeMirror-crosshair");ge(document,"keyup",r);ge(document,"mouseover",r)}}ve(document,"keyup",r);ve(document,"mouseover",r)}function fs(e){if(e.keyCode==16){this.doc.sel.shift=false}ye(this,e)}function cs(e){var t=this;if(Ur(t.display,e)||ye(t,e)||e.ctrlKey&&!e.altKey||y&&e.metaKey){return}var r=e.keyCode,n=e.charCode;if(m&&r==ss){ss=null;Se(e);return}if(m&&(!e.which||e.which<10)&&as(t,e)){return}var i=String.fromCharCode(n==null?r:n);if(i=="\b"){return}if(os(t,e,i)){return}t.display.input.onKeyPress(e)}var ds=400;var hs=function(e,t,r){this.time=e;this.pos=t;this.button=r};hs.prototype.compare=function(e,t,r){return this.time+ds>e&&at(t,this.pos)==0&&r==this.button};var vs,ps;function gs(e,t){var r=+new Date;if(ps&&ps.compare(r,e,t)){vs=ps=null;return"triple"}else if(vs&&vs.compare(r,e,t)){ps=new hs(r,e,t);vs=null;return"double"}else{vs=new hs(r,e,t);ps=null;return"single"}}function ms(e){var t=this,r=t.display;if(ye(t,e)||r.activeTouch&&r.input.supportsTouch()){return}r.input.ensurePolled();r.shift=e.shiftKey;if(Ur(r,e)){if(!g){r.scroller.draggable=false;setTimeout(function(){return r.scroller.draggable=true},100)}return}if(_s(t,e)){return}var n=Mn(t,e),i=xe(e),a=n?gs(n,i):"single";window.focus();if(i==1&&t.state.selectingText){t.state.selectingText(e)}if(n&&ys(t,i,n,a,e)){return}if(i==1){if(n){ws(t,n,a,e)}else if(_e(e)==r.scroller){Se(e)}}else if(i==2){if(n){Ma(t.doc,n)}setTimeout(function(){return r.input.focus()},20)}else if(i==3){if(E){t.display.input.onContextMenu(e)}else{Xn(t)}}}function ys(r,e,n,t,i){var a="Click";if(t=="double"){a="Double"+a}else if(t=="triple"){a="Triple"+a}a=(e==1?"Left":e==2?"Middle":"Right")+a;return ns(r,Uo(a,i),i,function(e){if(typeof e=="string"){e=Ko[e]}if(!e){return false}var t=false;try{if(r.isReadOnly()){r.state.suppressEdits=true}t=e(r,n)!=U}finally{r.state.suppressEdits=false}return t})}function bs(e,t,r){var n=e.getOption("configureMouse");var i=n?n(e,t,r):{};if(i.unit==null){var a=h?r.shiftKey&&r.metaKey:r.altKey;i.unit=a?"rectangle":t=="single"?"char":t=="double"?"word":"line"}if(i.extend==null||e.doc.extend){i.extend=e.doc.extend||r.shiftKey}if(i.addNew==null){i.addNew=y?r.metaKey:r.ctrlKey}if(i.moveOnDrag==null){i.moveOnDrag=!(y?r.altKey:r.ctrlKey)}return i}function ws(e,t,r,n){if(C){setTimeout(P(Gn,e),0)}else{e.curOp.focus=A()}var i=bs(e,r,n);var a=e.doc.sel,o;if(e.options.dragDrop&&De&&!e.isReadOnly()&&r=="single"&&(o=a.contains(t))>-1&&(at((o=a.ranges[o]).from(),t)<0||t.xRel>0)&&(at(o.to(),t)>0||t.xRel<0)){Cs(e,n,t,i)}else{Es(e,n,t,i)}}function Cs(t,r,n,i){var a=t.display,o=false;var s=Oi(t,function(e){if(g){a.scroller.draggable=false}t.state.draggingText=false;ge(a.wrapper.ownerDocument,"mouseup",s);ge(a.wrapper.ownerDocument,"mousemove",l);ge(a.scroller,"dragstart",u);ge(a.scroller,"drop",s);if(!o){Se(e);if(!i.addNew){Ma(t.doc,n,null,null,i.extend)}if(g||C&&S==9){setTimeout(function(){a.wrapper.ownerDocument.body.focus();a.input.focus()},20)}else{a.input.focus()}}});var l=function(e){o=o||Math.abs(r.clientX-e.clientX)+Math.abs(r.clientY-e.clientY)>=10};var u=function(){return o=true};if(g){a.scroller.draggable=true}t.state.draggingText=s;s.copy=!i.moveOnDrag;if(a.scroller.dragDrop){a.scroller.dragDrop()}ve(a.wrapper.ownerDocument,"mouseup",s);ve(a.wrapper.ownerDocument,"mousemove",l);ve(a.scroller,"dragstart",u);ve(a.scroller,"drop",s);Xn(t);setTimeout(function(){return a.input.focus()},20)}function Ss(e,t,r){if(r=="char"){return new ia(t,t)}if(r=="word"){return e.findWordAt(t)}if(r=="line"){return new ia(it(t.line,0),ct(e.doc,it(t.line+1,0)))}var n=r(e,t);return new ia(n.from,n.to)}function Es(g,e,m,y){var a=g.display,b=g.doc;Se(e);var w,C,S=b.sel,t=S.ranges;if(y.addNew&&!y.extend){C=b.sel.contains(m);if(C>-1){w=t[C]}else{w=new ia(m,m)}}else{w=b.sel.primary();C=b.sel.primIndex}if(y.unit=="rectangle"){if(!y.addNew){w=new ia(m,m)}m=Mn(g,e,true,true);C=-1}else{var r=Ss(g,m,y.unit);if(y.extend){w=Na(w,r.anchor,r.head,y.extend)}else{w=r}}if(!y.addNew){C=0;$a(b,new na([w],0),V);S=b.sel}else if(C==-1){C=t.length;$a(b,aa(g,t.concat([w]),C),{scroll:false,origin:"*mouse"})}else if(t.length>1&&t[C].empty()&&y.unit=="char"&&!y.extend){$a(b,aa(g,t.slice(0,C).concat(t.slice(C+1)),0),{scroll:false,origin:"*mouse"});S=b.sel}else{Pa(b,C,w,V)}var E=m;function o(e){if(at(E,e)==0){return}E=e;if(y.unit=="rectangle"){var t=[],r=g.options.tabSize;var n=B(Ke(b,m.line).text,m.ch,r);var i=B(Ke(b,e.line).text,e.ch,r);var a=Math.min(n,i),o=Math.max(n,i);for(var s=Math.min(m.line,e.line),l=Math.min(g.lastLine(),Math.max(m.line,e.line));s<=l;s++){var u=Ke(b,s).text,f=q(u,a,r);if(a==o){t.push(new ia(it(s,f),it(s,f)))}else if(u.length>f){t.push(new ia(it(s,f),it(s,q(u,o,r))))}}if(!t.length){t.push(new ia(m,m))}$a(b,aa(g,S.ranges.slice(0,C).concat(t),C),{origin:"*mouse",scroll:false});g.scrollIntoView(e)}else{var c=w;var d=Ss(g,e,y.unit);var h=c.anchor,v;if(at(d.anchor,h)>0){v=d.head;h=ut(c.from(),d.anchor)}else{v=d.anchor;h=lt(c.to(),d.head)}var p=S.ranges.slice(0);p[C]=ks(g,new ia(ct(b,h),v));$a(b,aa(g,p,C),V)}}var s=a.wrapper.getBoundingClientRect();var l=0;function u(e){var t=++l;var r=Mn(g,e,true,y.unit=="rectangle");if(!r){return}if(at(r,E)!=0){g.curOp.focus=A();o(r);var n=ei(a,b);if(r.line>=n.to||r.line<n.from){setTimeout(Oi(g,function(){if(l==t){u(e)}}),150)}}else{var i=e.clientY<s.top?-20:e.clientY>s.bottom?20:0;if(i){setTimeout(Oi(g,function(){if(l!=t){return}a.scroller.scrollTop+=i;u(e)}),50)}}}function n(e){g.state.selectingText=false;l=Infinity;if(e){Se(e);a.input.focus()}ge(a.wrapper.ownerDocument,"mousemove",i);ge(a.wrapper.ownerDocument,"mouseup",f);b.history.lastSelOrigin=null}var i=Oi(g,function(e){if(e.buttons===0||!xe(e)){n(e)}else{u(e)}});var f=Oi(g,n);g.state.selectingText=f;ve(a.wrapper.ownerDocument,"mousemove",i);ve(a.wrapper.ownerDocument,"mouseup",f)}function ks(e,t){var r=t.anchor;var n=t.head;var i=Ke(e.doc,r.line);if(at(r,n)==0&&r.sticky==n.sticky){return t}var a=de(i);if(!a){return t}var o=fe(a,r.ch,r.sticky),s=a[o];if(s.from!=r.ch&&s.to!=r.ch){return t}var l=o+(s.from==r.ch==(s.level!=1)?0:1);if(l==0||l==a.length){return t}var u;if(n.line!=r.line){u=(n.line-r.line)*(e.doc.direction=="ltr"?1:-1)>0}else{var f=fe(a,n.ch,n.sticky);var c=f-o||(n.ch-r.ch)*(s.level==1?-1:1);if(f==l-1||f==l){u=c<0}else{u=c>0}}var d=a[l+(u?-1:0)];var h=u==(d.level==1);var v=h?d.from:d.to,p=h?"after":"before";return r.ch==v&&r.sticky==p?t:new ia(new it(r.line,v,p),n)}function Ts(e,t,r,n){var i,a;if(t.touches){i=t.touches[0].clientX;a=t.touches[0].clientY}else{try{i=t.clientX;a=t.clientY}catch(t){return false}}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right)){return false}if(n){Se(t)}var o=e.display;var s=o.lineDiv.getBoundingClientRect();if(a>s.bottom||!we(e,r)){return ke(t)}a-=s.top-o.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var u=o.gutters.childNodes[l];if(u&&u.getBoundingClientRect().right>=i){var f=tt(e.doc,a);var c=e.display.gutterSpecs[l];me(e,r,e,f,c.className,t);return ke(t)}}}function _s(e,t){return Ts(e,t,"gutterClick",true)}function xs(e,t){if(Ur(e.display,t)||Ds(e,t)){return}if(ye(e,t,"contextmenu")){return}if(!E){e.display.input.onContextMenu(t)}}function Ds(e,t){if(!we(e,"gutterContextMenu")){return false}return Ts(e,t,"gutterContextMenu",false)}function Rs(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-");fn(e)}var Is={toString:function(){return"CodeMirror.Init"}};var Os={};var As={};function Ns(i){var a=i.optionHandlers;function e(e,t,n,r){i.defaults[e]=t;if(n){a[e]=r?function(e,t,r){if(r!=Is){n(e,t,r)}}:n}}i.defineOption=e;i.Init=Is;e("value","",function(e,t){return e.setValue(t)},true);e("mode",null,function(e,t){e.doc.modeOption=t;da(e)},true);e("indentUnit",2,da,true);e("indentWithTabs",false);e("smartIndent",true);e("tabSize",4,function(e){ha(e);fn(e);Pn(e)},true);e("lineSeparator",null,function(e,n){e.doc.lineSep=n;if(!n){return}var i=[],a=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var r=e.text.indexOf(n,t);if(r==-1){break}t=r+n.length;i.push(it(a,r))}a++});for(var t=i.length-1;t>=0;t--){ro(e.doc,n,i[t],it(i[t].line,i[t].ch+n.length))}});e("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(e,t,r){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g");if(r!=Is){e.refresh()}});e("specialCharPlaceholder",vr,function(e){return e.refresh()},true);e("electricChars",true);e("inputStyle",d?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);e("spellcheck",false,function(e,t){return e.getInputField().spellcheck=t},true);e("autocorrect",false,function(e,t){return e.getInputField().autocorrect=t},true);e("autocapitalize",false,function(e,t){return e.getInputField().autocapitalize=t},true);e("rtlMoveVisually",!v);e("wholeLineUpdateBefore",true);e("theme","default",function(e){Rs(e);Ki(e)},true);e("keyMap","default",function(e,t,r){var n=Vo(t);var i=r!=Is&&Vo(r);if(i&&i.detach){i.detach(e,n)}if(n.attach){n.attach(e,i||null)}});e("extraKeys",null);e("configureMouse",null);e("lineWrapping",false,Ls,true);e("gutters",[],function(e,t){e.display.gutterSpecs=Gi(t,e.options.lineNumbers);Ki(e)},true);e("fixedGutter",true,function(e,t){e.display.gutters.style.left=t?On(e.display)+"px":"0";e.refresh()},true);e("coverGutterNextToScrollbar",false,function(e){return mi(e)},true);e("scrollbarStyle","native",function(e){wi(e);mi(e);e.display.scrollbars.setScrollTop(e.doc.scrollTop);e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},true);e("lineNumbers",false,function(e,t){e.display.gutterSpecs=Gi(e.options.gutters,t);Ki(e)},true);e("firstLineNumber",1,Ki,true);e("lineNumberFormatter",function(e){return e},Ki,true);e("showCursorWhenSelecting",false,Un,true);e("resetSelectionOnContextMenu",true);e("lineWiseCopyCut",true);e("pasteLinesPerSelection",true);e("selectionsMayTouch",false);e("readOnly",false,function(e,t){if(t=="nocursor"){Jn(e);e.display.input.blur()}e.display.input.readOnlyChanged(t)});e("disableInput",false,function(e,t){if(!t){e.display.input.reset()}},true);e("dragDrop",true,Ms);e("allowDropFileTypes",null);e("cursorBlinkRate",530);e("cursorScrollMargin",0);e("cursorHeight",1,Un,true);e("singleCursorHeightPerLine",true,Un,true);e("workTime",100);e("workDelay",100);e("flattenSpans",true,ha,true);e("addModeClass",false,ha,true);e("pollInterval",100);e("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t});e("historyEventDelay",1250);e("viewportMargin",10,function(e){return e.refresh()},true);e("maxHighlightLength",1e4,ha,true);e("moveInputWithCursor",true,function(e,t){if(!t){e.display.input.resetPosition()}});e("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""});e("autofocus",null);e("direction","ltr",function(e,t){return e.doc.setDirection(t)},true);e("phrases",null)}function Ms(e,t,r){var n=r&&r!=Is;if(!t!=!n){var i=e.display.dragFunctions;var a=t?ve:ge;a(e.display.scroller,"dragstart",i.start);a(e.display.scroller,"dragenter",i.enter);a(e.display.scroller,"dragover",i.over);a(e.display.scroller,"dragleave",i.leave);a(e.display.scroller,"drop",i.drop)}}function Ls(e){if(e.options.lineWrapping){N(e.display.wrapper,"CodeMirror-wrap");e.display.sizer.style.minWidth="";e.display.sizerWidth=null}else{T(e.display.wrapper,"CodeMirror-wrap");or(e)}Nn(e);Pn(e);fn(e);setTimeout(function(){return mi(e)},100)}function Ps(e,t){var r=this;if(!(this instanceof Ps)){return new Ps(e,t)}this.options=t=t?F(t):{};F(Os,t,false);var n=t.value;if(typeof n=="string"){n=new So(n,t.mode,null,t.lineSeparator,t.direction)}else if(t.mode){n.modeOption=t.mode}this.doc=n;var i=new Ps.inputStyles[t.inputStyle](this);var a=this.display=new Ji(e,n,i,t);a.wrapper.CodeMirror=this;Rs(this);if(t.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}wi(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:-1,cutIncoming:-1,selectingText:false,draggingText:false,highlight:new H,keySeq:null,specialChars:null};if(t.autofocus&&!d){a.input.focus()}if(C&&S<11){setTimeout(function(){return r.display.input.reset(true)},20)}Fs(this);Io();Si(this);this.curOp.forceUpdate=true;ma(this,n);if(t.autofocus&&!d||this.hasFocus()){setTimeout(P(Kn,this),20)}else{Jn(this)}for(var o in As){if(As.hasOwnProperty(o)){As[o](this,t[o],Is)}}Yi(this);if(t.finishInit){t.finishInit(this)}for(var s=0;s<Bs.length;++s){Bs[s](this)}Ei(this);if(g&&t.lineWrapping&&getComputedStyle(a.lineDiv).textRendering=="optimizelegibility"){a.lineDiv.style.textRendering="auto"}}Ps.defaults=Os;Ps.optionHandlers=As;function Fs(i){var a=i.display;ve(a.scroller,"mousedown",Oi(i,ms));if(C&&S<11){ve(a.scroller,"dblclick",Oi(i,function(e){if(ye(i,e)){return}var t=Mn(i,e);if(!t||_s(i,e)||Ur(i.display,e)){return}Se(e);var r=i.findWordAt(t);Ma(i.doc,r.anchor,r.head)}))}else{ve(a.scroller,"dblclick",function(e){return ye(i,e)||Se(e)})}ve(a.scroller,"contextmenu",function(e){return xs(i,e)});var r,n={end:0};function o(){if(a.activeTouch){r=setTimeout(function(){return a.activeTouch=null},1e3);n=a.activeTouch;n.end=+new Date}}function s(e){if(e.touches.length!=1){return false}var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function l(e,t){if(t.left==null){return true}var r=t.left-e.left,n=t.top-e.top;return r*r+n*n>20*20}ve(a.scroller,"touchstart",function(e){if(!ye(i,e)&&!s(e)&&!_s(i,e)){a.input.ensurePolled();clearTimeout(r);var t=+new Date;a.activeTouch={start:t,moved:false,prev:t-n.end<=300?n:null};if(e.touches.length==1){a.activeTouch.left=e.touches[0].pageX;a.activeTouch.top=e.touches[0].pageY}}});ve(a.scroller,"touchmove",function(){if(a.activeTouch){a.activeTouch.moved=true}});ve(a.scroller,"touchend",function(e){var t=a.activeTouch;if(t&&!Ur(a,e)&&t.left!=null&&!t.moved&&new Date-t.start<300){var r=i.coordsChar(a.activeTouch,"page"),n;if(!t.prev||l(t,t.prev)){n=new ia(r,r)}else if(!t.prev.prev||l(t,t.prev.prev)){n=i.findWordAt(r)}else{n=new ia(it(r.line,0),ct(i.doc,it(r.line+1,0)))}i.setSelection(n.anchor,n.head);i.focus();Se(e)}o()});ve(a.scroller,"touchcancel",o);ve(a.scroller,"scroll",function(){if(a.scroller.clientHeight){ci(i,a.scroller.scrollTop);hi(i,a.scroller.scrollLeft,true);me(i,"scroll",i)}});ve(a.scroller,"mousewheel",function(e){return ra(i,e)});ve(a.scroller,"DOMMouseScroll",function(e){return ra(i,e)});ve(a.wrapper,"scroll",function(){return a.wrapper.scrollTop=a.wrapper.scrollLeft=0});a.dragFunctions={enter:function(e){if(!ye(i,e)){Te(e)}},over:function(e){if(!ye(i,e)){_o(i,e);Te(e)}},start:function(e){return To(i,e)},drop:Oi(i,ko),leave:function(e){if(!ye(i,e)){xo(i)}}};var e=a.input.getField();ve(e,"keyup",function(e){return fs.call(i,e)});ve(e,"keydown",Oi(i,ls));ve(e,"keypress",Oi(i,cs));ve(e,"focus",function(e){return Kn(i,e)});ve(e,"blur",function(e){return Jn(i,e)})}var Bs=[];Ps.defineInitHook=function(e){return Bs.push(e)};function Hs(e,t,r,n){var i=e.doc,a;if(r==null){r="add"}if(r=="smart"){if(!i.mode.indent){r="prev"}else{a=yt(e,t).state}}var o=e.options.tabSize;var s=Ke(i,t),l=B(s.text,null,o);if(s.stateAfter){s.stateAfter=null}var u=s.text.match(/^\s*/)[0],f;if(!n&&!/\S/.test(s.text)){f=0;r="not"}else if(r=="smart"){f=i.mode.indent(a,s.text.slice(u.length),s.text);if(f==U||f>150){if(!n){return}r="prev"}}if(r=="prev"){if(t>i.first){f=B(Ke(i,t-1).text,null,o)}else{f=0}}else if(r=="add"){f=l+e.options.indentUnit}else if(r=="subtract"){f=l-e.options.indentUnit}else if(typeof r=="number"){f=l+r}f=Math.max(0,f);var c="",d=0;if(e.options.indentWithTabs){for(var h=Math.floor(f/o);h;--h){d+=o;c+="\t"}}if(d<f){c+=G(f-d)}if(c!=u){ro(i,c,it(t,0),it(t,u.length),"+input");s.stateAfter=null;return true}else{for(var v=0;v<i.sel.ranges.length;v++){var p=i.sel.ranges[v];if(p.head.line==t&&p.head.ch<u.length){var g=it(t,u.length);Pa(i,v,new ia(g,g));break}}}}var $s=null;function Ws(e){$s=e}function Us(e,t,r,n,i){var a=e.doc;e.display.shift=false;if(!n){n=a.sel}var o=+new Date-200;var s=i=="paste"||e.state.pasteIncoming>o;var l=Ne(t),u=null;if(s&&n.ranges.length>1){if($s&&$s.text.join("\n")==t){if(n.ranges.length%$s.text.length==0){u=[];for(var f=0;f<$s.text.length;f++){u.push(a.splitLines($s.text[f]))}}}else if(l.length==n.ranges.length&&e.options.pasteLinesPerSelection){u=K(l,function(e){return[e]})}}var c=e.curOp.updateInput;for(var d=n.ranges.length-1;d>=0;d--){var h=n.ranges[d];var v=h.from(),p=h.to();if(h.empty()){if(r&&r>0){v=it(v.line,v.ch-r)}else if(e.state.overwrite&&!s){p=it(p.line,Math.min(Ke(a,p.line).text.length,p.ch+X(l).length))}else if(s&&$s&&$s.lineWise&&$s.text.join("\n")==t){v=p=it(v.line,0)}}var g={from:v,to:p,text:u?u[d%u.length]:l,origin:i||(s?"paste":e.state.cutIncoming>o?"cut":"+input")};Ka(e.doc,g);xr(e,"inputRead",e,g)}if(t&&!s){Vs(e,t)}oi(e);if(e.curOp.updateInput<2){e.curOp.updateInput=c}e.curOp.typing=true;e.state.pasteIncoming=e.state.cutIncoming=-1}function js(e,t){var r=e.clipboardData&&e.clipboardData.getData("Text");if(r){e.preventDefault();if(!t.isReadOnly()&&!t.options.disableInput){Ii(t,function(){return Us(t,r,0,null,"paste")})}return true}}function Vs(e,t){if(!e.options.electricChars||!e.options.smartIndent){return}var r=e.doc.sel;for(var n=r.ranges.length-1;n>=0;n--){var i=r.ranges[n];if(i.head.ch>100||n&&r.ranges[n-1].head.line==i.head.line){continue}var a=e.getModeAt(i.head);var o=false;if(a.electricChars){for(var s=0;s<a.electricChars.length;s++){if(t.indexOf(a.electricChars.charAt(s))>-1){o=Hs(e,i.head.line,"smart");break}}}else if(a.electricInput){if(a.electricInput.test(Ke(e.doc,i.head.line).text.slice(0,i.head.ch))){o=Hs(e,i.head.line,"smart")}}if(o){xr(e,"electricInput",e,i.head.line)}}}function zs(e){var t=[],r=[];for(var n=0;n<e.doc.sel.ranges.length;n++){var i=e.doc.sel.ranges[n].head.line;var a={anchor:it(i,0),head:it(i+1,0)};r.push(a);t.push(e.getRange(a.anchor,a.head))}return{text:t,ranges:r}}function qs(e,t,r,n){e.setAttribute("autocorrect",r?"":"off");e.setAttribute("autocapitalize",n?"":"off");e.setAttribute("spellcheck",!!t)}function Ys(){var e=O("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none");var t=O("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(g){e.style.width="1000px"}else{e.setAttribute("wrap","off")}if(f){e.style.border="1px solid black"}qs(e);return t}function Gs(i){var a=i.optionHandlers;var u=i.helpers={};i.prototype={constructor:i,focus:function(){window.focus();this.display.input.focus()},setOption:function(e,t){var r=this.options,n=r[e];if(r[e]==t&&e!="mode"){return}r[e]=t;if(a.hasOwnProperty(e)){Oi(this,a[e])(this,t,n)}me(this,"optionChange",this,e)},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Vo(e))},removeKeyMap:function(e){var t=this.state.keyMaps;for(var r=0;r<t.length;++r){if(t[r]==e||t[r].name==e){t.splice(r,1);return true}}},addOverlay:Ai(function(e,t){var r=e.token?e:i.getMode(this.options,e);if(r.startState){throw new Error("Overlays may not be stateful.")}J(this.state.overlays,{mode:r,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},function(e){return e.priority});this.state.modeGen++;Pn(this)}),removeOverlay:Ai(function(e){var t=this.state.overlays;for(var r=0;r<t.length;++r){var n=t[r].modeSpec;if(n==e||typeof e=="string"&&n.name==e){t.splice(r,1);this.state.modeGen++;Pn(this);return}}}),indentLine:Ai(function(e,t,r){if(typeof t!="string"&&typeof t!="number"){if(t==null){t=this.options.smartIndent?"smart":"prev"}else{t=t?"add":"subtract"}}if(rt(this.doc,e)){Hs(this,e,t,r)}}),indentSelection:Ai(function(e){var t=this.doc.sel.ranges,r=-1;for(var n=0;n<t.length;n++){var i=t[n];if(!i.empty()){var a=i.from(),o=i.to();var s=Math.max(r,a.line);r=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var l=s;l<r;++l){Hs(this,l,e)}var u=this.doc.sel.ranges;if(a.ch==0&&t.length==u.length&&u[n].from().ch>0){Pa(this.doc,n,new ia(a,u[n].to()),j)}}else if(i.head.line>r){Hs(this,i.head.line,e,true);r=i.head.line;if(n==this.doc.sel.primIndex){oi(this)}}}}),getTokenAt:function(e,t){return Et(this,e,t)},getLineTokens:function(e,t){return Et(this,it(e),t,true)},getTokenTypeAt:function(e){e=ct(this.doc,e);var t=mt(this,Ke(this.doc,e.line));var r=0,n=(t.length-1)/2,i=e.ch;var a;if(i==0){a=t[2]}else{for(;;){var o=r+n>>1;if((o?t[o*2-1]:0)>=i){n=o}else if(t[o*2+1]<i){r=o+1}else{a=t[o*2+2];break}}}var s=a?a.indexOf("overlay "):-1;return s<0?a:s==0?null:a.slice(0,s-1)},getModeAt:function(e){var t=this.doc.mode;if(!t.innerMode){return t}return i.innerMode(t,this.getTokenAt(e).state).mode},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var r=[];if(!u.hasOwnProperty(t)){return r}var n=u[t],i=this.getModeAt(e);if(typeof i[t]=="string"){if(n[i[t]]){r.push(n[i[t]])}}else if(i[t]){for(var a=0;a<i[t].length;a++){var o=n[i[t][a]];if(o){r.push(o)}}}else if(i.helperType&&n[i.helperType]){r.push(n[i.helperType])}else if(n[i.name]){r.push(n[i.name])}for(var s=0;s<n._global.length;s++){var l=n._global[s];if(l.pred(i,this)&&$(r,l.val)==-1){r.push(l.val)}}return r},getStateAfter:function(e,t){var r=this.doc;e=ft(r,e==null?r.first+r.size-1:e);return yt(this,e+1,t).state},cursorCoords:function(e,t){var r,n=this.doc.sel.primary();if(e==null){r=n.head}else if(typeof e=="object"){r=ct(this.doc,e)}else{r=e?n.from():n.to()}return mn(this,r,t||"page")},charCoords:function(e,t){return gn(this,ct(this.doc,e),t||"page")},coordsChar:function(e,t){e=pn(this,e,t||"page");return wn(this,e.left,e.top)},lineAtHeight:function(e,t){e=pn(this,{top:e,left:0},t||"page").top;return tt(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,r){var n=false,i;if(typeof e=="number"){var a=this.doc.first+this.doc.size-1;if(e<this.doc.first){e=this.doc.first}else if(e>a){e=a;n=true}i=Ke(this.doc,e)}else{i=e}return vn(this,i,{top:0,left:0},t||"page",r||n).top+(n?this.doc.height-ir(i):0)},defaultTextHeight:function(){return Dn(this.display)},defaultCharWidth:function(){return Rn(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,r,n,i){var a=this.display;e=mn(this,ct(this.doc,e));var o=e.bottom,s=e.left;t.style.position="absolute";t.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(t);a.sizer.appendChild(t);if(n=="over"){o=e.top}else if(n=="above"||n=="near"){var l=Math.max(a.wrapper.clientHeight,this.doc.height),u=Math.max(a.sizer.clientWidth,a.lineSpace.clientWidth);if((n=="above"||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight){o=e.top-t.offsetHeight}else if(e.bottom+t.offsetHeight<=l){o=e.bottom}if(s+t.offsetWidth>u){s=u-t.offsetWidth}}t.style.top=o+"px";t.style.left=t.style.right="";if(i=="right"){s=a.sizer.clientWidth-t.offsetWidth;t.style.right="0px"}else{if(i=="left"){s=0}else if(i=="middle"){s=(a.sizer.clientWidth-t.offsetWidth)/2}t.style.left=s+"px"}if(r){ni(this,{left:s,top:o,right:s+t.offsetWidth,bottom:o+t.offsetHeight})}},triggerOnKeyDown:Ai(ls),triggerOnKeyPress:Ai(cs),triggerOnKeyUp:fs,triggerOnMouseDown:Ai(ms),execCommand:function(e){if(Ko.hasOwnProperty(e)){return Ko[e].call(null,this)}},triggerElectric:Ai(function(e){Vs(this,e)}),findPosH:function(e,t,r,n){var i=1;if(t<0){i=-1;t=-t}var a=ct(this.doc,e);for(var o=0;o<t;++o){a=Xs(this.doc,a,i,r,n);if(a.hitSide){break}}return a},moveH:Ai(function(t,r){var n=this;this.extendSelectionsBy(function(e){if(n.display.shift||n.doc.extend||e.empty()){return Xs(n.doc,e.head,t,r,n.options.rtlMoveVisually)}else{return t<0?e.from():e.to()}},z)}),deleteH:Ai(function(r,n){var e=this.doc.sel,i=this.doc;if(e.somethingSelected()){i.replaceSelection("",null,"+delete")}else{zo(this,function(e){var t=Xs(i,e.head,r,n,false);return r<0?{from:t,to:e.head}:{from:e.head,to:t}})}}),findPosV:function(e,t,r,n){var i=1,a=n;if(t<0){i=-1;t=-t}var o=ct(this.doc,e);for(var s=0;s<t;++s){var l=mn(this,o,"div");if(a==null){a=l.left}else{l.left=a}o=Ks(this,l,i,r);if(o.hitSide){break}}return o},moveV:Ai(function(n,i){var a=this;var o=this.doc,s=[];var l=!this.display.shift&&!o.extend&&o.sel.somethingSelected();o.extendSelectionsBy(function(e){if(l){return n<0?e.from():e.to()}var t=mn(a,e.head,"div");if(e.goalColumn!=null){t.left=e.goalColumn}s.push(t.left);var r=Ks(a,t,n,i);if(i=="page"&&e==o.sel.primary()){ai(a,gn(a,r,"div").top-t.top)}return r},z);if(s.length){for(var e=0;e<o.sel.ranges.length;e++){o.sel.ranges[e].goalColumn=s[e]}}}),findWordAt:function(e){var t=this.doc,r=Ke(t,e.line).text;var n=e.ch,i=e.ch;if(r){var a=this.getHelper(e,"wordChars");if((e.sticky=="before"||i==r.length)&&n){--n}else{++i}var o=r.charAt(n);var s=re(o,a)?function(e){return re(e,a)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!re(e)};while(n>0&&s(r.charAt(n-1))){--n}while(i<r.length&&s(r.charAt(i))){++i}}return new ia(it(e.line,n),it(e.line,i))},toggleOverwrite:function(e){if(e!=null&&e==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){N(this.display.cursorDiv,"CodeMirror-overwrite")}else{T(this.display.cursorDiv,"CodeMirror-overwrite")}me(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==A()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:Ai(function(e,t){si(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-qr(this)-this.display.barHeight,width:e.scrollWidth-qr(this)-this.display.barWidth,clientHeight:Gr(this),clientWidth:Yr(this)}},scrollIntoView:Ai(function(e,t){if(e==null){e={from:this.doc.sel.primary().head,to:null};if(t==null){t=this.options.cursorScrollMargin}}else if(typeof e=="number"){e={from:it(e,0),to:null}}else if(e.from==null){e={from:e,to:null}}if(!e.to){e.to=e.from}e.margin=t||0;if(e.from.line!=null){li(this,e)}else{fi(this,e.from,e.to,e.margin)}}),setSize:Ai(function(e,t){var r=this;var n=function(e){return typeof e=="number"||/^\d+$/.test(String(e))?e+"px":e};if(e!=null){this.display.wrapper.style.width=n(e)}if(t!=null){this.display.wrapper.style.height=n(t)}if(this.options.lineWrapping){un(this)}var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,function(e){if(e.widgets){for(var t=0;t<e.widgets.length;t++){if(e.widgets[t].noHScroll){Fn(r,i,"widget");break}}}++i});this.curOp.forceUpdate=true;me(this,"refresh",this)}),operation:function(e){return Ii(this,e)},startOperation:function(){return Si(this)},endOperation:function(){return Ei(this)},refresh:Ai(function(){var e=this.display.cachedTextHeight;Pn(this);this.curOp.forceUpdate=true;fn(this);si(this,this.doc.scrollLeft,this.doc.scrollTop);Vi(this.display);if(e==null||Math.abs(e-Dn(this.display))>.5){Nn(this)}me(this,"refresh",this)}),swapDoc:Ai(function(e){var t=this.doc;t.cm=null;if(this.state.selectingText){this.state.selectingText()}ma(this,e);fn(this);this.display.input.reset();si(this,e.scrollLeft,e.scrollTop);this.curOp.forceScroll=true;xr(this,"swapDoc",this,t);return t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};Ce(i);i.registerHelper=function(e,t,r){if(!u.hasOwnProperty(e)){u[e]=i[e]={_global:[]}}u[e][t]=r};i.registerGlobalHelper=function(e,t,r,n){i.registerHelper(e,t,n);u[e]._global.push({pred:r,val:n})}}function Xs(r,n,i,e,a){var t=n;var o=i;var s=Ke(r,n.line);function l(){var e=n.line+i;if(e<r.first||e>=r.first+r.size){return false}n=new it(e,n.ch,n.sticky);return s=Ke(r,e)}function u(e){var t;if(a){t=Xo(r.cm,s,n,i)}else{t=Yo(s,n,i)}if(t==null){if(!e&&l()){n=Go(a,r.cm,s,n.line,i)}else{return false}}else{n=t}return true}if(e=="char"){u()}else if(e=="column"){u(true)}else if(e=="word"||e=="group"){var f=null,c=e=="group";var d=r.cm&&r.cm.getHelper(n,"wordChars");for(var h=true;;h=false){if(i<0&&!u(!h)){break}var v=s.text.charAt(n.ch)||"\n";var p=re(v,d)?"w":c&&v=="\n"?"n":!c||/\s/.test(v)?null:"p";if(c&&!h&&!p){p="s"}if(f&&f!=p){if(i<0){i=1;u();n.sticky="after"}break}if(p){f=p}if(i>0&&!u(!h)){break}}}var g=qa(r,n,t,o,true);if(ot(t,g)){g.hitSide=true}return g}function Ks(e,t,r,n){var i=e.doc,a=t.left,o;if(n=="page"){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);var l=Math.max(s-.5*Dn(e.display),3);o=(r>0?t.bottom:t.top)+r*l}else if(n=="line"){o=r>0?t.bottom+3:t.top-3}var u;for(;;){u=wn(e,a,o);if(!u.outside){break}if(r<0?o<=0:o>=i.height){u.hitSide=true;break}o+=r*5}return u}var Js=function(e){this.cm=e;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new H;this.composing=null;this.gracePeriod=false;this.readDOMTimeout=null};Js.prototype.init=function(e){var t=this;var o=this,s=o.cm;var l=o.div=e.lineDiv;qs(l,s.options.spellcheck,s.options.autocorrect,s.options.autocapitalize);ve(l,"paste",function(e){if(ye(s,e)||js(e,s)){return}if(S<=11){setTimeout(Oi(s,function(){return t.updateFromDOM()}),20)}});ve(l,"compositionstart",function(e){t.composing={data:e.data,done:false}});ve(l,"compositionupdate",function(e){if(!t.composing){t.composing={data:e.data,done:false}}});ve(l,"compositionend",function(e){if(t.composing){if(e.data!=t.composing.data){t.readFromDOMSoon()}t.composing.done=true}});ve(l,"touchstart",function(){return o.forceCompositionEnd()});ve(l,"input",function(){if(!t.composing){t.readFromDOMSoon()}});function r(e){if(ye(s,e)){return}if(s.somethingSelected()){Ws({lineWise:false,text:s.getSelections()});if(e.type=="cut"){s.replaceSelection("",null,"cut")}}else if(!s.options.lineWiseCopyCut){return}else{var t=zs(s);Ws({lineWise:true,text:t.text});if(e.type=="cut"){s.operation(function(){s.setSelections(t.ranges,0,j);s.replaceSelection("",null,"cut")})}}if(e.clipboardData){e.clipboardData.clearData();var r=$s.text.join("\n");e.clipboardData.setData("Text",r);if(e.clipboardData.getData("Text")==r){e.preventDefault();return}}var n=Ys(),i=n.firstChild;s.display.lineSpace.insertBefore(n,s.display.lineSpace.firstChild);i.value=$s.text.join("\n");var a=document.activeElement;L(i);setTimeout(function(){s.display.lineSpace.removeChild(n);a.focus();if(a==l){o.showPrimarySelection()}},50)}ve(l,"copy",r);ve(l,"cut",r)};Js.prototype.prepareSelection=function(){var e=jn(this.cm,false);e.focus=this.cm.state.focused;return e};Js.prototype.showSelection=function(e,t){if(!e||!this.cm.display.view.length){return}if(e.focus||t){this.showPrimarySelection()}this.showMultipleSelections(e)};Js.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()};Js.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,r=t.doc.sel.primary();var n=r.from(),i=r.to();if(t.display.viewTo==t.display.viewFrom||n.line>=t.display.viewTo||i.line<t.display.viewFrom){e.removeAllRanges();return}var a=rl(t,e.anchorNode,e.anchorOffset);var o=rl(t,e.focusNode,e.focusOffset);if(a&&!a.bad&&o&&!o.bad&&at(ut(a,o),n)==0&&at(lt(a,o),i)==0){return}var s=t.display.view;var l=n.line>=t.display.viewFrom&&Qs(t,n)||{node:s[0].measure.map[2],offset:0};var u=i.line<t.display.viewTo&&Qs(t,i);if(!u){var f=s[s.length-1].measure;var c=f.maps?f.maps[f.maps.length-1]:f.map;u={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}if(!l||!u){e.removeAllRanges();return}var d=e.rangeCount&&e.getRangeAt(0),h;try{h=R(l.node,l.offset,u.offset,u.node)}catch(e){}if(h){if(!p&&t.state.focused){e.collapse(l.node,l.offset);if(!h.collapsed){e.removeAllRanges();e.addRange(h)}}else{e.removeAllRanges();e.addRange(h)}if(d&&e.anchorNode==null){e.addRange(d)}else if(p){this.startGracePeriod()}}this.rememberSelection()};Js.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){e.gracePeriod=false;if(e.selectionChanged()){e.cm.operation(function(){return e.cm.curOp.selectionChanged=true})}},20)};Js.prototype.showMultipleSelections=function(e){x(this.cm.display.cursorDiv,e.cursors);x(this.cm.display.selectionDiv,e.selection)};Js.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode;this.lastAnchorOffset=e.anchorOffset;this.lastFocusNode=e.focusNode;this.lastFocusOffset=e.focusOffset};Js.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount){return false}var t=e.getRangeAt(0).commonAncestorContainer;return I(this.div,t)};Js.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"){if(!this.selectionInEditor()){this.showSelection(this.prepareSelection(),true)}this.div.focus()}};Js.prototype.blur=function(){this.div.blur()};Js.prototype.getField=function(){return this.div};Js.prototype.supportsTouch=function(){return true};Js.prototype.receivedFocus=function(){var e=this;if(this.selectionInEditor()){this.pollSelection()}else{Ii(this.cm,function(){return e.cm.curOp.selectionChanged=true})}function t(){if(e.cm.state.focused){e.pollSelection();e.polling.set(e.cm.options.pollInterval,t)}}this.polling.set(this.cm.options.pollInterval,t)};Js.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset};Js.prototype.pollSelection=function(){if(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged()){return}var e=this.getSelection(),t=this.cm;if(c&&o&&this.cm.display.gutterSpecs.length&&Zs(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs});this.blur();this.focus();return}if(this.composing){return}this.rememberSelection();var r=rl(t,e.anchorNode,e.anchorOffset);var n=rl(t,e.focusNode,e.focusOffset);if(r&&n){Ii(t,function(){$a(t.doc,oa(r,n),j);if(r.bad||n.bad){t.curOp.selectionChanged=true}})}};Js.prototype.pollContent=function(){if(this.readDOMTimeout!=null){clearTimeout(this.readDOMTimeout);this.readDOMTimeout=null}var e=this.cm,t=e.display,r=e.doc.sel.primary();var n=r.from(),i=r.to();if(n.ch==0&&n.line>e.firstLine()){n=it(n.line-1,Ke(e.doc,n.line-1).length)}if(i.ch==Ke(e.doc,i.line).text.length&&i.line<e.lastLine()){i=it(i.line+1,0)}if(n.line<t.viewFrom||i.line>t.viewTo-1){return false}var a,o,s;if(n.line==t.viewFrom||(a=Ln(e,n.line))==0){o=et(t.view[0].line);s=t.view[0].node}else{o=et(t.view[a].line);s=t.view[a-1].node.nextSibling}var l=Ln(e,i.line);var u,f;if(l==t.view.length-1){u=t.viewTo-1;f=t.lineDiv.lastChild}else{u=et(t.view[l+1].line)-1;f=t.view[l+1].node.previousSibling}if(!s){return false}var c=e.doc.splitLines(tl(e,s,f,o,u));var d=Je(e.doc,it(o,0),it(u,Ke(e.doc,u).text.length));while(c.length>1&&d.length>1){if(X(c)==X(d)){c.pop();d.pop();u--}else if(c[0]==d[0]){c.shift();d.shift();o++}else{break}}var h=0,v=0;var p=c[0],g=d[0],m=Math.min(p.length,g.length);while(h<m&&p.charCodeAt(h)==g.charCodeAt(h)){++h}var y=X(c),b=X(d);var w=Math.min(y.length-(c.length==1?h:0),b.length-(d.length==1?h:0));while(v<w&&y.charCodeAt(y.length-v-1)==b.charCodeAt(b.length-v-1)){++v}if(c.length==1&&d.length==1&&o==n.line){while(h&&h>n.ch&&y.charCodeAt(y.length-v-1)==b.charCodeAt(b.length-v-1)){h--;v++}}c[c.length-1]=y.slice(0,y.length-v).replace(/^\u200b+/,"");c[0]=c[0].slice(h).replace(/\u200b+$/,"");var C=it(o,h);var S=it(u,d.length?X(d).length-v:0);if(c.length>1||c[0]||at(C,S)){ro(e.doc,c,C,S,"+input");return true}};Js.prototype.ensurePolled=function(){this.forceCompositionEnd()};Js.prototype.reset=function(){this.forceCompositionEnd()};Js.prototype.forceCompositionEnd=function(){if(!this.composing){return}clearTimeout(this.readDOMTimeout);this.composing=null;this.updateFromDOM();this.div.blur();this.div.focus()};Js.prototype.readFromDOMSoon=function(){var e=this;if(this.readDOMTimeout!=null){return}this.readDOMTimeout=setTimeout(function(){e.readDOMTimeout=null;if(e.composing){if(e.composing.done){e.composing=null}else{return}}e.updateFromDOM()},80)};Js.prototype.updateFromDOM=function(){var e=this;if(this.cm.isReadOnly()||!this.pollContent()){Ii(this.cm,function(){return Pn(e.cm)})}};Js.prototype.setUneditable=function(e){e.contentEditable="false"};Js.prototype.onKeyPress=function(e){if(e.charCode==0||this.composing){return}e.preventDefault();if(!this.cm.isReadOnly()){Oi(this.cm,Us)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0)}};Js.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")};Js.prototype.onContextMenu=function(){};Js.prototype.resetPosition=function(){};Js.prototype.needsContentAttribute=true;function Qs(e,t){var r=Zr(e,t.line);if(!r||r.hidden){return null}var n=Ke(e.doc,t.line);var i=Kr(r,n,t.line);var a=de(n,e.doc.direction),o="left";if(a){var s=fe(a,t.ch);o=s%2?"right":"left"}var l=nn(i.map,t.ch,o);l.offset=l.collapse=="right"?l.end:l.start;return l}function Zs(e){for(var t=e;t;t=t.parentNode){if(/CodeMirror-gutter-wrapper/.test(t.className)){return true}}return false}function el(e,t){if(t){e.bad=true}return e}function tl(s,e,t,l,u){var r="",f=false,c=s.doc.lineSeparator(),d=false;function h(t){return function(e){return e.id==t}}function v(){if(f){r+=c;if(d){r+=c}f=d=false}}function p(e){if(e){v();r+=e}}function g(e){if(e.nodeType==1){var t=e.getAttribute("cm-text");if(t){p(t);return}var r=e.getAttribute("cm-marker"),n;if(r){var i=s.findMarks(it(l,0),it(u+1,0),h(+r));if(i.length&&(n=i[0].find(0))){p(Je(s.doc,n.from,n.to).join(c))}return}if(e.getAttribute("contenteditable")=="false"){return}var a=/^(pre|div|p|li|table|br)$/i.test(e.nodeName);if(!/^br$/i.test(e.nodeName)&&e.textContent.length==0){return}if(a){v()}for(var o=0;o<e.childNodes.length;o++){g(e.childNodes[o])}if(/^(pre|p)$/i.test(e.nodeName)){d=true}if(a){f=true}}else if(e.nodeType==3){p(e.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}}for(;;){g(e);if(e==t){break}e=e.nextSibling;d=false}return r}function rl(e,t,r){var n;if(t==e.display.lineDiv){n=e.display.lineDiv.childNodes[r];if(!n){return el(e.clipPos(it(e.display.viewTo-1)),true)}t=null;r=0}else{for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv){return null}if(n.parentNode&&n.parentNode==e.display.lineDiv){break}}}for(var i=0;i<e.display.view.length;i++){var a=e.display.view[i];if(a.node==n){return nl(a,t,r)}}}function nl(u,e,t){var r=u.text.firstChild,n=false;if(!e||!I(r,e)){return el(it(et(u.line),0),true)}if(e==r){n=true;e=r.childNodes[t];t=0;if(!e){var i=u.rest?X(u.rest):u.line;return el(it(et(i),i.text.length),n)}}var a=e.nodeType==3?e:null,o=e;if(!a&&e.childNodes.length==1&&e.firstChild.nodeType==3){a=e.firstChild;if(t){t=a.nodeValue.length}}while(o.parentNode!=r){o=o.parentNode}var f=u.measure,c=f.maps;function s(e,t,r){for(var n=-1;n<(c?c.length:0);n++){var i=n<0?f.map:c[n];for(var a=0;a<i.length;a+=3){var o=i[a+2];if(o==e||o==t){var s=et(n<0?u.line:u.rest[n]);var l=i[a]+r;if(r<0||o!=e){l=i[a+(r?1:0)]}return it(s,l)}}}}var l=s(a,o,t);if(l){return el(l,n)}for(var d=o.nextSibling,h=a?a.nodeValue.length-t:0;d;d=d.nextSibling){l=s(d,d.firstChild,0);if(l){return el(it(l.line,l.ch-h),n)}else{h+=d.textContent.length}}for(var v=o.previousSibling,p=t;v;v=v.previousSibling){l=s(v,v.firstChild,-1);if(l){return el(it(l.line,l.ch+p),n)}else{p+=v.textContent.length}}}var il=function(e){this.cm=e;this.prevInput="";this.pollingFast=false;this.polling=new H;this.hasSelection=false;this.composing=null};il.prototype.init=function(r){var e=this;var n=this,i=this.cm;this.createField(r);var a=this.textarea;r.wrapper.insertBefore(this.wrapper,r.wrapper.firstChild);if(f){a.style.width="0px"}ve(a,"input",function(){if(C&&S>=9&&e.hasSelection){e.hasSelection=null}n.poll()});ve(a,"paste",function(e){if(ye(i,e)||js(e,i)){return}i.state.pasteIncoming=+new Date;n.fastPoll()});function t(e){if(ye(i,e)){return}if(i.somethingSelected()){Ws({lineWise:false,text:i.getSelections()})}else if(!i.options.lineWiseCopyCut){return}else{var t=zs(i);Ws({lineWise:true,text:t.text});if(e.type=="cut"){i.setSelections(t.ranges,null,j)}else{n.prevInput="";a.value=t.text.join("\n");L(a)}}if(e.type=="cut"){i.state.cutIncoming=+new Date}}ve(a,"cut",t);ve(a,"copy",t);ve(r.scroller,"paste",function(e){if(Ur(r,e)||ye(i,e)){return}if(!a.dispatchEvent){i.state.pasteIncoming=+new Date;n.focus();return}var t=new Event("paste");t.clipboardData=e.clipboardData;a.dispatchEvent(t)});ve(r.lineSpace,"selectstart",function(e){if(!Ur(r,e)){Se(e)}});ve(a,"compositionstart",function(){var e=i.getCursor("from");if(n.composing){n.composing.range.clear()}n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}});ve(a,"compositionend",function(){if(n.composing){n.poll();n.composing.range.clear();n.composing=null}})};il.prototype.createField=function(e){this.wrapper=Ys();this.textarea=this.wrapper.firstChild};il.prototype.prepareSelection=function(){var e=this.cm,t=e.display,r=e.doc;var n=jn(e);if(e.options.moveInputWithCursor){var i=mn(e,r.sel.primary().head,"div");var a=t.wrapper.getBoundingClientRect(),o=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+o.top-a.top));n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+o.left-a.left))}return n};il.prototype.showSelection=function(e){var t=this.cm,r=t.display;x(r.cursorDiv,e.cursors);x(r.selectionDiv,e.selection);if(e.teTop!=null){this.wrapper.style.top=e.teTop+"px";this.wrapper.style.left=e.teLeft+"px"}};il.prototype.reset=function(e){if(this.contextMenuPending||this.composing){return}var t=this.cm;if(t.somethingSelected()){this.prevInput="";var r=t.getSelection();this.textarea.value=r;if(t.state.focused){L(this.textarea)}if(C&&S>=9){this.hasSelection=r}}else if(!e){this.prevInput=this.textarea.value="";if(C&&S>=9){this.hasSelection=null}}};il.prototype.getField=function(){return this.textarea};il.prototype.supportsTouch=function(){return false};il.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!d||A()!=this.textarea)){try{this.textarea.focus()}catch(e){}}};il.prototype.blur=function(){this.textarea.blur()};il.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};il.prototype.receivedFocus=function(){this.slowPoll()};il.prototype.slowPoll=function(){var e=this;if(this.pollingFast){return}this.polling.set(this.cm.options.pollInterval,function(){e.poll();if(e.cm.state.focused){e.slowPoll()}})};il.prototype.fastPoll=function(){var t=false,r=this;r.pollingFast=true;function n(){var e=r.poll();if(!e&&!t){t=true;r.polling.set(60,n)}else{r.pollingFast=false;r.slowPoll()}}r.polling.set(20,n)};il.prototype.poll=function(){var e=this;var t=this.cm,r=this.textarea,n=this.prevInput;if(this.contextMenuPending||!t.state.focused||Me(r)&&!n&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq){return false}var i=r.value;if(i==n&&!t.somethingSelected()){return false}if(C&&S>=9&&this.hasSelection===i||y&&/[\uf700-\uf7ff]/.test(i)){t.display.input.reset();return false}if(t.doc.sel==t.display.selForContextMenu){var a=i.charCodeAt(0);if(a==8203&&!n){n="â"}if(a==8666){this.reset();return this.cm.execCommand("undo")}}var o=0,s=Math.min(n.length,i.length);while(o<s&&n.charCodeAt(o)==i.charCodeAt(o)){++o}Ii(t,function(){Us(t,i.slice(o),n.length-o,null,e.composing?"*compose":null);if(i.length>1e3||i.indexOf("\n")>-1){r.value=e.prevInput=""}else{e.prevInput=i}if(e.composing){e.composing.range.clear();e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"})}});return true};il.prototype.ensurePolled=function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}};il.prototype.onKeyPress=function(){if(C&&S>=9){this.hasSelection=null}this.fastPoll()};il.prototype.onContextMenu=function(e){var r=this,n=r.cm,i=n.display,a=r.textarea;if(r.contextMenuPending){r.contextMenuPending()}var t=Mn(n,e),o=i.scroller.scrollTop;if(!t||m){return}var s=n.options.resetSelectionOnContextMenu;if(s&&n.doc.sel.contains(t)==-1){Oi(n,$a)(n.doc,oa(t),j)}var l=a.style.cssText,u=r.wrapper.style.cssText;var f=r.wrapper.offsetParent.getBoundingClientRect();r.wrapper.style.cssText="position: static";a.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-f.top-5)+"px; left: "+(e.clientX-f.left-5)+"px;\n      z-index: 1000; background: "+(C?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var c;if(g){c=window.scrollY}i.input.focus();if(g){window.scrollTo(null,c)}i.input.reset();if(!n.somethingSelected()){a.value=r.prevInput=" "}r.contextMenuPending=h;i.selForContextMenu=n.doc.sel;clearTimeout(i.detectingSelectAll);function d(){if(a.selectionStart!=null){var e=n.somethingSelected();var t="â"+(e?a.value:"");a.value="â";a.value=t;r.prevInput=e?"":"â";a.selectionStart=1;a.selectionEnd=t.length;i.selForContextMenu=n.doc.sel}}function h(){if(r.contextMenuPending!=h){return}r.contextMenuPending=false;r.wrapper.style.cssText=u;a.style.cssText=l;if(C&&S<9){i.scrollbars.setScrollTop(i.scroller.scrollTop=o)}if(a.selectionStart!=null){if(!C||C&&S<9){d()}var e=0,t=function(){if(i.selForContextMenu==n.doc.sel&&a.selectionStart==0&&a.selectionEnd>0&&r.prevInput=="â"){Oi(n,Ga)(n)}else if(e++<10){i.detectingSelectAll=setTimeout(t,500)}else{i.selForContextMenu=null;i.input.reset()}};i.detectingSelectAll=setTimeout(t,200)}}if(C&&S>=9){d()}if(E){Te(e);var v=function(){ge(window,"mouseup",v);setTimeout(h,20)};ve(window,"mouseup",v)}else{setTimeout(h,50)}};il.prototype.readOnlyChanged=function(e){if(!e){this.reset()}this.textarea.disabled=e=="nocursor"};il.prototype.setUneditable=function(){};il.prototype.needsContentAttribute=false;function al(t,r){r=r?F(r):{};r.value=t.value;if(!r.tabindex&&t.tabIndex){r.tabindex=t.tabIndex}if(!r.placeholder&&t.placeholder){r.placeholder=t.placeholder}if(r.autofocus==null){var e=A();r.autofocus=e==t||t.getAttribute("autofocus")!=null&&e==document.body}function n(){t.value=s.getValue()}var i;if(t.form){ve(t.form,"submit",n);if(!r.leaveSubmitMethodAlone){var a=t.form;i=a.submit;try{var o=a.submit=function(){n();a.submit=i;a.submit();a.submit=o}}catch(e){}}}r.finishInit=function(e){e.save=n;e.getTextArea=function(){return t};e.toTextArea=function(){e.toTextArea=isNaN;n();t.parentNode.removeChild(e.getWrapperElement());t.style.display="";if(t.form){ge(t.form,"submit",n);if(!r.leaveSubmitMethodAlone&&typeof t.form.submit=="function"){t.form.submit=i}}}};t.style.display="none";var s=Ps(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},r);return s}function ol(e){e.off=ge;e.on=ve;e.wheelEventPixels=ta;e.Doc=So;e.splitLines=Ne;e.countColumn=B;e.findColumn=q;e.isWordChar=te;e.Pass=U;e.signal=me;e.Line=sr;e.changeEnd=sa;e.scrollbarModel=bi;e.Pos=it;e.cmpPos=at;e.modes=Be;e.mimeModes=He;e.resolveMode=Ue;e.getMode=je;e.modeExtensions=Ve;e.extendMode=ze;e.copyState=qe;e.startState=Ge;e.innerMode=Ye;e.commands=Ko;e.keyMap=Fo;e.keyName=jo;e.isModifierKey=Wo;e.lookupKey=$o;e.normalizeKeyMap=Ho;e.StringStream=Xe;e.SharedTextMarker=go;e.TextMarker=vo;e.LineWidget=uo;e.e_preventDefault=Se;e.e_stopPropagation=Ee;e.e_stop=Te;e.addClass=N;e.contains=I;e.rmClass=T;e.keyNames=No}Ns(Ps);Gs(Ps);var sl="iter insert remove copy getEditor constructor".split(" ");for(var ll in So.prototype){if(So.prototype.hasOwnProperty(ll)&&$(sl,ll)<0){Ps.prototype[ll]=function(e){return function(){return e.apply(this.doc,arguments)}}(So.prototype[ll])}}Ce(So);Ps.inputStyles={textarea:il,contenteditable:Js};Ps.defineMode=function(e){if(!Ps.defaults.mode&&e!="null"){Ps.defaults.mode=e}$e.apply(this,arguments)};Ps.defineMIME=We;Ps.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}});Ps.defineMIME("text/plain","null");Ps.defineExtension=function(e,t){Ps.prototype[e]=t};Ps.defineDocExtension=function(e,t){So.prototype[e]=t};Ps.fromTextArea=al;ol(Ps);Ps.version="5.50.2";return Ps});(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof exports==="object"){module.exports=t()}else{e.download=t()}})(this,function(){return function t(e,r,n){var i=window,a="application/octet-stream",o=n||a,s=e,l=!r&&!n&&s,u=document.createElement("a"),f=function(e){return String(e)},c=i.Blob||i.MozBlob||i.WebKitBlob||f,d=r||"download",h,v;c=c.call?c.bind(i):Blob;if(String(this)==="true"){s=[s,o];o=s[0];s=s[1]}if(l&&l.length<2048){d=l.split("/").pop().split("?")[0];u.href=l;if(u.href.indexOf(l)!==-1){var p=new XMLHttpRequest;p.open("GET",l,true);p.responseType="blob";p.onload=function(e){t(e.target.response,d,a)};setTimeout(function(){p.send()},0);return p}}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(s)){if(s.length>1024*1024*1.999&&c!==f){s=b(s);o=s.type||a}else{return navigator.msSaveBlob?navigator.msSaveBlob(b(s),d):w(s)}}else{if(/([\x80-\xff])/.test(s)){var g=0,m=new Uint8Array(s.length),y=m.length;for(g;g<y;++g)m[g]=s.charCodeAt(g);s=new c([m],{type:o})}}h=s instanceof c?s:new c([s],{type:o});function b(e){var t=e.split(/[:;,]/),r=t[1],n=e.indexOf("charset")>0?3:2,i=t[n]=="base64"?atob:decodeURIComponent,a=i(t.pop()),o=a.length,s=0,l=new Uint8Array(o);for(s;s<o;++s)l[s]=a.charCodeAt(s);return new c([l],{type:r})}function w(e,t){if("download"in u){u.href=e;u.setAttribute("download",d);u.className="download-js-link";u.innerHTML="downloading...";u.style.display="none";u.addEventListener("click",function(e){e.stopPropagation();this.removeEventListener("click",arguments.callee)});document.body.appendChild(u);setTimeout(function(){u.click();document.body.removeChild(u);if(t===true){setTimeout(function(){i.URL.revokeObjectURL(u.href)},250)}},66);return true}if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)){if(/^data:/.test(e))e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a);if(!window.open(e)){if(confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")){location.href=e}}return true}var r=document.createElement("iframe");document.body.appendChild(r);if(!t&&/^data:/.test(e)){e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)}r.src=e;setTimeout(function(){document.body.removeChild(r)},333)}if(navigator.msSaveBlob){return navigator.msSaveBlob(h,d)}if(i.URL){w(i.URL.createObjectURL(h),true)}else{if(typeof h==="string"||h.constructor===f){try{return w("data:"+o+";base64,"+i.btoa(h))}catch(e){return w("data:"+o+","+encodeURIComponent(h))}}v=new FileReader;v.onload=function(e){w(this.result)};v.readAsDataURL(h)}return true}});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.Chart=t())})(this,function(){"use strict";var t=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function $a(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function r(e){return e&&e["default"]||e}var f={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var u=e(function(e){var s={};for(var t in f){if(f.hasOwnProperty(t)){s[f[t]]=t}}var l=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var r in l){if(l.hasOwnProperty(r)){if(!("channels"in l[r])){throw new Error("missing channels property: "+r)}if(!("labels"in l[r])){throw new Error("missing channel labels property: "+r)}if(l[r].labels.length!==l[r].channels){throw new Error("channel and label counts mismatch: "+r)}var n=l[r].channels;var i=l[r].labels;delete l[r].channels;delete l[r].labels;Object.defineProperty(l[r],"channels",{value:n});Object.defineProperty(l[r],"labels",{value:i})}}l.rgb.hsl=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;var i=Math.min(t,r,n);var a=Math.max(t,r,n);var o=a-i;var s;var l;var u;if(a===i){s=0}else if(t===a){s=(r-n)/o}else if(r===a){s=2+(n-t)/o}else if(n===a){s=4+(t-r)/o}s=Math.min(s*60,360);if(s<0){s+=360}u=(i+a)/2;if(a===i){l=0}else if(u<=.5){l=o/(a+i)}else{l=o/(2-a-i)}return[s,l*100,u*100]};l.rgb.hsv=function(e){var t;var r;var n;var i;var a;var o=e[0]/255;var s=e[1]/255;var l=e[2]/255;var u=Math.max(o,s,l);var f=u-Math.min(o,s,l);var c=function(e){return(u-e)/6/f+1/2};if(f===0){i=a=0}else{a=f/u;t=c(o);r=c(s);n=c(l);if(o===u){i=n-r}else if(s===u){i=1/3+t-n}else if(l===u){i=2/3+r-t}if(i<0){i+=1}else if(i>1){i-=1}}return[i*360,a*100,u*100]};l.rgb.hwb=function(e){var t=e[0];var r=e[1];var n=e[2];var i=l.rgb.hsl(e)[0];var a=1/255*Math.min(t,Math.min(r,n));n=1-1/255*Math.max(t,Math.max(r,n));return[i,a*100,n*100]};l.rgb.cmyk=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;var i;var a;var o;var s;s=Math.min(1-t,1-r,1-n);i=(1-t-s)/(1-s)||0;a=(1-r-s)/(1-s)||0;o=(1-n-s)/(1-s)||0;return[i*100,a*100,o*100,s*100]};function u(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)}l.rgb.keyword=function(e){var t=s[e];if(t){return t}var r=Infinity;var n;for(var i in f){if(f.hasOwnProperty(i)){var a=f[i];var o=u(e,a);if(o<r){r=o;n=i}}}return n};l.keyword.rgb=function(e){return f[e]};l.rgb.xyz=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var i=t*.4124+r*.3576+n*.1805;var a=t*.2126+r*.7152+n*.0722;var o=t*.0193+r*.1192+n*.9505;return[i*100,a*100,o*100]};l.rgb.lab=function(e){var t=l.rgb.xyz(e);var r=t[0];var n=t[1];var i=t[2];var a;var o;var s;r/=95.047;n/=100;i/=108.883;r=r>.008856?Math.pow(r,1/3):7.787*r+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;a=116*n-16;o=500*(r-n);s=200*(n-i);return[a,o,s]};l.hsl.rgb=function(e){var t=e[0]/360;var r=e[1]/100;var n=e[2]/100;var i;var a;var o;var s;var l;if(r===0){l=n*255;return[l,l,l]}if(n<.5){a=n*(1+r)}else{a=n+r-n*r}i=2*n-a;s=[0,0,0];for(var u=0;u<3;u++){o=t+1/3*-(u-1);if(o<0){o++}if(o>1){o--}if(6*o<1){l=i+(a-i)*6*o}else if(2*o<1){l=a}else if(3*o<2){l=i+(a-i)*(2/3-o)*6}else{l=i}s[u]=l*255}return s};l.hsl.hsv=function(e){var t=e[0];var r=e[1]/100;var n=e[2]/100;var i=r;var a=Math.max(n,.01);var o;var s;n*=2;r*=n<=1?n:2-n;i*=a<=1?a:2-a;s=(n+r)/2;o=n===0?2*i/(a+i):2*r/(n+r);return[t,o*100,s*100]};l.hsv.rgb=function(e){var t=e[0]/60;var r=e[1]/100;var n=e[2]/100;var i=Math.floor(t)%6;var a=t-Math.floor(t);var o=255*n*(1-r);var s=255*n*(1-r*a);var l=255*n*(1-r*(1-a));n*=255;switch(i){case 0:return[n,l,o];case 1:return[s,n,o];case 2:return[o,n,l];case 3:return[o,s,n];case 4:return[l,o,n];case 5:return[n,o,s]}};l.hsv.hsl=function(e){var t=e[0];var r=e[1]/100;var n=e[2]/100;var i=Math.max(n,.01);var a;var o;var s;s=(2-r)*n;a=(2-r)*i;o=r*i;o/=a<=1?a:2-a;o=o||0;s/=2;return[t,o*100,s*100]};l.hwb.rgb=function(e){var t=e[0]/360;var r=e[1]/100;var n=e[2]/100;var i=r+n;var a;var o;var s;var l;if(i>1){r/=i;n/=i}a=Math.floor(6*t);o=1-n;s=6*t-a;if((a&1)!==0){s=1-s}l=r+s*(o-r);var u;var f;var c;switch(a){default:case 6:case 0:u=o;f=l;c=r;break;case 1:u=l;f=o;c=r;break;case 2:u=r;f=o;c=l;break;case 3:u=r;f=l;c=o;break;case 4:u=l;f=r;c=o;break;case 5:u=o;f=r;c=l;break}return[u*255,f*255,c*255]};l.cmyk.rgb=function(e){var t=e[0]/100;var r=e[1]/100;var n=e[2]/100;var i=e[3]/100;var a;var o;var s;a=1-Math.min(1,t*(1-i)+i);o=1-Math.min(1,r*(1-i)+i);s=1-Math.min(1,n*(1-i)+i);return[a*255,o*255,s*255]};l.xyz.rgb=function(e){var t=e[0]/100;var r=e[1]/100;var n=e[2]/100;var i;var a;var o;i=t*3.2406+r*-1.5372+n*-.4986;a=t*-.9689+r*1.8758+n*.0415;o=t*.0557+r*-.204+n*1.057;i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*12.92;a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*12.92;o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*12.92;i=Math.min(Math.max(0,i),1);a=Math.min(Math.max(0,a),1);o=Math.min(Math.max(0,o),1);return[i*255,a*255,o*255]};l.xyz.lab=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var a;var o;t/=95.047;r/=100;n/=108.883;t=t>.008856?Math.pow(t,1/3):7.787*t+16/116;r=r>.008856?Math.pow(r,1/3):7.787*r+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;i=116*r-16;a=500*(t-r);o=200*(r-n);return[i,a,o]};l.lab.xyz=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var a;var o;a=(t+16)/116;i=r/500+a;o=a-n/200;var s=Math.pow(a,3);var l=Math.pow(i,3);var u=Math.pow(o,3);a=s>.008856?s:(a-16/116)/7.787;i=l>.008856?l:(i-16/116)/7.787;o=u>.008856?u:(o-16/116)/7.787;i*=95.047;a*=100;o*=108.883;return[i,a,o]};l.lab.lch=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var a;var o;i=Math.atan2(n,r);a=i*360/2/Math.PI;if(a<0){a+=360}o=Math.sqrt(r*r+n*n);return[t,o,a]};l.lch.lab=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var a;var o;o=n/360*2*Math.PI;i=r*Math.cos(o);a=r*Math.sin(o);return[t,i,a]};l.rgb.ansi16=function(e){var t=e[0];var r=e[1];var n=e[2];var i=1 in arguments?arguments[1]:l.rgb.hsv(e)[2];i=Math.round(i/50);if(i===0){return 30}var a=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));if(i===2){a+=60}return a};l.hsv.ansi16=function(e){return l.rgb.ansi16(l.hsv.rgb(e),e[2])};l.rgb.ansi256=function(e){var t=e[0];var r=e[1];var n=e[2];if(t===r&&r===n){if(t<8){return 16}if(t>248){return 231}return Math.round((t-8)/247*24)+232}var i=16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5);return i};l.ansi16.rgb=function(e){var t=e%10;if(t===0||t===7){if(e>50){t+=3.5}t=t/10.5*255;return[t,t,t]}var r=(~~(e>50)+1)*.5;var n=(t&1)*r*255;var i=(t>>1&1)*r*255;var a=(t>>2&1)*r*255;return[n,i,a]};l.ansi256.rgb=function(e){if(e>=232){var t=(e-232)*10+8;return[t,t,t]}e-=16;var r;var n=Math.floor(e/36)/5*255;var i=Math.floor((r=e%36)/6)/5*255;var a=r%6/5*255;return[n,i,a]};l.rgb.hex=function(e){var t=((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255);var r=t.toString(16).toUpperCase();return"000000".substring(r.length)+r};l.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t){return[0,0,0]}var r=t[0];if(t[0].length===3){r=r.split("").map(function(e){return e+e}).join("")}var n=parseInt(r,16);var i=n>>16&255;var a=n>>8&255;var o=n&255;return[i,a,o]};l.rgb.hcg=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;var i=Math.max(Math.max(t,r),n);var a=Math.min(Math.min(t,r),n);var o=i-a;var s;var l;if(o<1){s=a/(1-o)}else{s=0}if(o<=0){l=0}else if(i===t){l=(r-n)/o%6}else if(i===r){l=2+(n-t)/o}else{l=4+(t-r)/o+4}l/=6;l%=1;return[l*360,o*100,s*100]};l.hsl.hcg=function(e){var t=e[1]/100;var r=e[2]/100;var n=1;var i=0;if(r<.5){n=2*t*r}else{n=2*t*(1-r)}if(n<1){i=(r-.5*n)/(1-n)}return[e[0],n*100,i*100]};l.hsv.hcg=function(e){var t=e[1]/100;var r=e[2]/100;var n=t*r;var i=0;if(n<1){i=(r-n)/(1-n)}return[e[0],n*100,i*100]};l.hcg.rgb=function(e){var t=e[0]/360;var r=e[1]/100;var n=e[2]/100;if(r===0){return[n*255,n*255,n*255]}var i=[0,0,0];var a=t%1*6;var o=a%1;var s=1-o;var l=0;switch(Math.floor(a)){case 0:i[0]=1;i[1]=o;i[2]=0;break;case 1:i[0]=s;i[1]=1;i[2]=0;break;case 2:i[0]=0;i[1]=1;i[2]=o;break;case 3:i[0]=0;i[1]=s;i[2]=1;break;case 4:i[0]=o;i[1]=0;i[2]=1;break;default:i[0]=1;i[1]=0;i[2]=s}l=(1-r)*n;return[(r*i[0]+l)*255,(r*i[1]+l)*255,(r*i[2]+l)*255]};l.hcg.hsv=function(e){var t=e[1]/100;var r=e[2]/100;var n=t+r*(1-t);var i=0;if(n>0){i=t/n}return[e[0],i*100,n*100]};l.hcg.hsl=function(e){var t=e[1]/100;var r=e[2]/100;var n=r*(1-t)+.5*t;var i=0;if(n>0&&n<.5){i=t/(2*n)}else if(n>=.5&&n<1){i=t/(2*(1-n))}return[e[0],i*100,n*100]};l.hcg.hwb=function(e){var t=e[1]/100;var r=e[2]/100;var n=t+r*(1-t);return[e[0],(n-t)*100,(1-n)*100]};l.hwb.hcg=function(e){var t=e[1]/100;var r=e[2]/100;var n=1-r;var i=n-t;var a=0;if(i<1){a=(n-i)/(1-i)}return[e[0],i*100,a*100]};l.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};l.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};l.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};l.gray.hsl=l.gray.hsv=function(e){return[0,0,e[0]]};l.gray.hwb=function(e){return[0,100,e[0]]};l.gray.cmyk=function(e){return[0,0,0,e[0]]};l.gray.lab=function(e){return[e[0],0,0]};l.gray.hex=function(e){var t=Math.round(e[0]/100*255)&255;var r=(t<<16)+(t<<8)+t;var n=r.toString(16).toUpperCase();return"000000".substring(n.length)+n};l.rgb.gray=function(e){var t=(e[0]+e[1]+e[2])/3;return[t/255*100]}});var n=u.rgb;var i=u.hsl;var a=u.hsv;var o=u.hwb;var s=u.cmyk;var l=u.xyz;var c=u.lab;var d=u.lch;var h=u.hex;var v=u.keyword;var p=u.ansi16;var g=u.ansi256;var m=u.hcg;var y=u.apple;var b=u.gray;function w(){var e={};var t=Object.keys(u);for(var r=t.length,n=0;n<r;n++){e[t[n]]={distance:-1,parent:null}}return e}function C(e){var t=w();var r=[e];t[e].distance=0;while(r.length){var n=r.pop();var i=Object.keys(u[n]);for(var a=i.length,o=0;o<a;o++){var s=i[o];var l=t[s];if(l.distance===-1){l.distance=t[n].distance+1;l.parent=n;r.unshift(s)}}}return t}function S(t,r){return function(e){return r(t(e))}}function E(e,t){var r=[t[e].parent,e];var n=u[t[e].parent][e];var i=t[e].parent;while(t[i].parent){r.unshift(t[i].parent);n=S(u[t[i].parent][i],n);i=t[i].parent}n.conversion=r;return n}var k=function(e){var t=C(e);var r={};var n=Object.keys(t);for(var i=n.length,a=0;a<i;a++){var o=n[a];var s=t[o];if(s.parent===null){continue}r[o]=E(o,t)}return r};var T={};var _=Object.keys(u);function x(t){var e=function(e){if(e===undefined||e===null){return e}if(arguments.length>1){e=Array.prototype.slice.call(arguments)}return t(e)};if("conversion"in t){e.conversion=t.conversion}return e}function D(i){var e=function(e){if(e===undefined||e===null){return e}if(arguments.length>1){e=Array.prototype.slice.call(arguments)}var t=i(e);if(typeof t==="object"){for(var r=t.length,n=0;n<r;n++){t[n]=Math.round(t[n])}}return t};if("conversion"in i){e.conversion=i.conversion}return e}_.forEach(function(r){T[r]={};Object.defineProperty(T[r],"channels",{value:u[r].channels});Object.defineProperty(T[r],"labels",{value:u[r].labels});var n=k(r);var e=Object.keys(n);e.forEach(function(e){var t=n[e];T[r][e]=D(t);T[r][e].raw=x(t)})});var R=T;var I={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var O={getRgba:A,getHsla:N,getRgb:L,getHsl:P,getHwb:M,getAlpha:F,hexString:B,rgbString:H,rgbaString:$,percentString:W,percentaString:U,hslString:j,hslaString:V,hwbString:z,keyword:q};function A(e){if(!e){return}var t=/^#([a-fA-F0-9]{3,4})$/i,r=/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i,n=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,i=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,a=/(\w+)/;var o=[0,0,0],s=1,l=e.match(t),u="";if(l){l=l[1];u=l[3];for(var f=0;f<o.length;f++){o[f]=parseInt(l[f]+l[f],16)}if(u){s=Math.round(parseInt(u+u,16)/255*100)/100}}else if(l=e.match(r)){u=l[2];l=l[1];for(var f=0;f<o.length;f++){o[f]=parseInt(l.slice(f*2,f*2+2),16)}if(u){s=Math.round(parseInt(u,16)/255*100)/100}}else if(l=e.match(n)){for(var f=0;f<o.length;f++){o[f]=parseInt(l[f+1])}s=parseFloat(l[4])}else if(l=e.match(i)){for(var f=0;f<o.length;f++){o[f]=Math.round(parseFloat(l[f+1])*2.55)}s=parseFloat(l[4])}else if(l=e.match(a)){if(l[1]=="transparent"){return[0,0,0,0]}o=I[l[1]];if(!o){return}}for(var f=0;f<o.length;f++){o[f]=Y(o[f],0,255)}if(!s&&s!=0){s=1}else{s=Y(s,0,1)}o[3]=s;return o}function N(e){if(!e){return}var t=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var r=e.match(t);if(r){var n=parseFloat(r[4]);var i=Y(parseInt(r[1]),0,360),a=Y(parseFloat(r[2]),0,100),o=Y(parseFloat(r[3]),0,100),s=Y(isNaN(n)?1:n,0,1);return[i,a,o,s]}}function M(e){if(!e){return}var t=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var r=e.match(t);if(r){var n=parseFloat(r[4]);var i=Y(parseInt(r[1]),0,360),a=Y(parseFloat(r[2]),0,100),o=Y(parseFloat(r[3]),0,100),s=Y(isNaN(n)?1:n,0,1);return[i,a,o,s]}}function L(e){var t=A(e);return t&&t.slice(0,3)}function P(e){var t=N(e);return t&&t.slice(0,3)}function F(e){var t=A(e);if(t){return t[3]}else if(t=N(e)){return t[3]}else if(t=M(e)){return t[3]}}function B(e,t){var t=t!==undefined&&e.length===3?t:e[3];return"#"+G(e[0])+G(e[1])+G(e[2])+(t>=0&&t<1?G(Math.round(t*255)):"")}function H(e,t){if(t<1||e[3]&&e[3]<1){return $(e,t)}return"rgb("+e[0]+", "+e[1]+", "+e[2]+")"}function $(e,t){if(t===undefined){t=e[3]!==undefined?e[3]:1}return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function W(e,t){if(t<1||e[3]&&e[3]<1){return U(e,t)}var r=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return"rgb("+r+"%, "+n+"%, "+i+"%)"}function U(e,t){var r=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return"rgba("+r+"%, "+n+"%, "+i+"%, "+(t||e[3]||1)+")"}function j(e,t){if(t<1||e[3]&&e[3]<1){return V(e,t)}return"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"}function V(e,t){if(t===undefined){t=e[3]!==undefined?e[3]:1}return"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function z(e,t){if(t===undefined){t=e[3]!==undefined?e[3]:1}return"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(t!==undefined&&t!==1?", "+t:"")+")"}function q(e){return X[e.slice(0,3)]}function Y(e,t,r){return Math.min(Math.max(t,e),r)}function G(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var X={};for(var K in I){X[I[K]]=K}var J=function(e){if(e instanceof J){return e}if(!(this instanceof J)){return new J(e)}this.valid=false;this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var t;if(typeof e==="string"){t=O.getRgba(e);if(t){this.setValues("rgb",t)}else if(t=O.getHsla(e)){this.setValues("hsl",t)}else if(t=O.getHwb(e)){this.setValues("hwb",t)}}else if(typeof e==="object"){t=e;if(t.r!==undefined||t.red!==undefined){this.setValues("rgb",t)}else if(t.l!==undefined||t.lightness!==undefined){this.setValues("hsl",t)}else if(t.v!==undefined||t.value!==undefined){this.setValues("hsv",t)}else if(t.w!==undefined||t.whiteness!==undefined){this.setValues("hwb",t)}else if(t.c!==undefined||t.cyan!==undefined){this.setValues("cmyk",t)}}};J.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var e=this.values;if(e.alpha!==1){return e.hwb.concat([e.alpha])}return e.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function(e){if(e===undefined){return this.values.alpha}this.setValues("alpha",e);return this},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){if(e){e%=360;e=e<0?360+e:e}return this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return O.hexString(this.values.rgb)},rgbString:function(){return O.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return O.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return O.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return O.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return O.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return O.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return O.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function(){var e=this.values.rgb;var t=[];for(var r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity();var r=e.luminosity();if(t>r){return(t+.05)/(r+.05)}return(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);if(t>=7.1){return"AAA"}return t>=4.5?"AA":""},dark:function(){var e=this.values.rgb;var t=(e[0]*299+e[1]*587+e[2]*114)/1e3;return t<128},light:function(){return!this.dark()},negate:function(){var e=[];for(var t=0;t<3;t++){e[t]=255-this.values.rgb[t]}this.setValues("rgb",e);return this},lighten:function(e){var t=this.values.hsl;t[2]+=t[2]*e;this.setValues("hsl",t);return this},darken:function(e){var t=this.values.hsl;t[2]-=t[2]*e;this.setValues("hsl",t);return this},saturate:function(e){var t=this.values.hsl;t[1]+=t[1]*e;this.setValues("hsl",t);return this},desaturate:function(e){var t=this.values.hsl;t[1]-=t[1]*e;this.setValues("hsl",t);return this},whiten:function(e){var t=this.values.hwb;t[1]+=t[1]*e;this.setValues("hwb",t);return this},blacken:function(e){var t=this.values.hwb;t[2]+=t[2]*e;this.setValues("hwb",t);return this},greyscale:function(){var e=this.values.rgb;var t=e[0]*.3+e[1]*.59+e[2]*.11;this.setValues("rgb",[t,t,t]);return this},clearer:function(e){var t=this.values.alpha;this.setValues("alpha",t-t*e);return this},opaquer:function(e){var t=this.values.alpha;this.setValues("alpha",t+t*e);return this},rotate:function(e){var t=this.values.hsl;var r=(t[0]+e)%360;t[0]=r<0?360+r:r;this.setValues("hsl",t);return this},mix:function(e,t){var r=this;var n=e;var i=t===undefined?.5:t;var a=2*i-1;var o=r.alpha()-n.alpha();var s=((a*o===-1?a:(a+o)/(1+a*o))+1)/2;var l=1-s;return this.rgb(s*r.red()+l*n.red(),s*r.green()+l*n.green(),s*r.blue()+l*n.blue()).alpha(r.alpha()*i+n.alpha()*(1-i))},toJson:function(){return this.rgb()},clone:function(){var e=new J;var t=this.values;var r=e.values;var n,i;for(var a in t){if(t.hasOwnProperty(a)){n=t[a];i={}.toString.call(n);if(i==="[object Array]"){r[a]=n.slice(0)}else if(i==="[object Number]"){r[a]=n}else{console.error("unexpected color value:",n)}}}return e}};J.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]};J.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]};J.prototype.getValues=function(e){var t=this.values;var r={};for(var n=0;n<e.length;n++){r[e.charAt(n)]=t[e][n]}if(t.alpha!==1){r.a=t.alpha}return r};J.prototype.setValues=function(e,t){var r=this.values;var n=this.spaces;var i=this.maxes;var a=1;var o;this.valid=true;if(e==="alpha"){a=t}else if(t.length){r[e]=t.slice(0,e.length);a=t[e.length]}else if(t[e.charAt(0)]!==undefined){for(o=0;o<e.length;o++){r[e][o]=t[e.charAt(o)]}a=t.a}else if(t[n[e][0]]!==undefined){var s=n[e];for(o=0;o<e.length;o++){r[e][o]=t[s[o]]}a=t.alpha}r.alpha=Math.max(0,Math.min(1,a===undefined?r.alpha:a));if(e==="alpha"){return false}var l;for(o=0;o<e.length;o++){l=Math.max(0,Math.min(i[e][o],r[e][o]));r[e][o]=Math.round(l)}for(var u in n){if(u!==e){r[u]=R[e][u](r[e])}}return true};J.prototype.setSpace=function(e,t){var r=t[0];if(r===undefined){return this.getValues(e)}if(typeof r==="number"){r=Array.prototype.slice.call(t)}this.setValues(e,r);return this};J.prototype.setChannel=function(e,t,r){var n=this.values[e];if(r===undefined){return n[t]}else if(r===n[t]){return this}n[t]=r;this.setValues(e,n);return this};if(typeof window!=="undefined"){window.Color=J}var Q=J;var Z={noop:function(){},uid:function(){var e=0;return function(){return e++}}(),isNullOrUndef:function(e){return e===null||typeof e==="undefined"},isArray:function(e){if(Array.isArray&&Array.isArray(e)){return true}var t=Object.prototype.toString.call(e);if(t.substr(0,7)==="[object"&&t.substr(-6)==="Array]"){return true}return false},isObject:function(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"},isFinite:function(e){return(typeof e==="number"||e instanceof Number)&&isFinite(e)},valueOrDefault:function(e,t){return typeof e==="undefined"?t:e},valueAtIndexOrDefault:function(e,t,r){return Z.valueOrDefault(Z.isArray(e)?e[t]:e,r)},callback:function(e,t,r){if(e&&typeof e.call==="function"){return e.apply(r,t)}},each:function(e,t,r,n){var i,a,o;if(Z.isArray(e)){a=e.length;if(n){for(i=a-1;i>=0;i--){t.call(r,e[i],i)}}else{for(i=0;i<a;i++){t.call(r,e[i],i)}}}else if(Z.isObject(e)){o=Object.keys(e);a=o.length;for(i=0;i<a;i++){t.call(r,e[o[i]],o[i])}}},arrayEquals:function(e,t){var r,n,i,a;if(!e||!t||e.length!==t.length){return false}for(r=0,n=e.length;r<n;++r){i=e[r];a=t[r];if(i instanceof Array&&a instanceof Array){if(!Z.arrayEquals(i,a)){return false}}else if(i!==a){return false}}return true},clone:function(e){if(Z.isArray(e)){return e.map(Z.clone)}if(Z.isObject(e)){var t={};var r=Object.keys(e);var n=r.length;var i=0;for(;i<n;++i){t[r[i]]=Z.clone(e[r[i]])}return t}return e},_merger:function(e,t,r,n){var i=t[e];var a=r[e];if(Z.isObject(i)&&Z.isObject(a)){Z.merge(i,a,n)}else{t[e]=Z.clone(a)}},_mergerIf:function(e,t,r){var n=t[e];var i=r[e];if(Z.isObject(n)&&Z.isObject(i)){Z.mergeIf(n,i)}else if(!t.hasOwnProperty(e)){t[e]=Z.clone(i)}},merge:function(e,t,r){var n=Z.isArray(t)?t:[t];var i=n.length;var a,o,s,l,u;if(!Z.isObject(e)){return e}r=r||{};a=r.merger||Z._merger;for(o=0;o<i;++o){t=n[o];if(!Z.isObject(t)){continue}s=Object.keys(t);for(u=0,l=s.length;u<l;++u){a(s[u],e,t,r)}}return e},mergeIf:function(e,t){return Z.merge(e,t,{merger:Z._mergerIf})},extend:Object.assign||function(e){return Z.merge(e,[].slice.call(arguments,1),{merger:function(e,t,r){t[e]=r[e]}})},inherits:function(e){var t=this;var r=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)};var n=function(){this.constructor=r};n.prototype=t.prototype;r.prototype=new n;r.extend=Z.inherits;if(e){Z.extend(r.prototype,e)}r.__super__=t.prototype;return r},_deprecated:function(e,t,r,n){if(t!==undefined){console.warn(e+': "'+r+'" is deprecated. Please use "'+n+'" instead')}}};var ee=Z;Z.callCallback=Z.callback;Z.indexOf=function(e,t,r){return Array.prototype.indexOf.call(e,t,r)};Z.getValueOrDefault=Z.valueOrDefault;Z.getValueAtIndexOrDefault=Z.valueAtIndexOrDefault;var te={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){if((e/=.5)<1){return.5*e*e}return-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e=e-1)*e*e+1},easeInOutCubic:function(e){if((e/=.5)<1){return.5*e*e*e}return.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e=e-1)*e*e*e-1)},easeInOutQuart:function(e){if((e/=.5)<1){return.5*e*e*e*e}return-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e=e-1)*e*e*e*e+1},easeInOutQuint:function(e){if((e/=.5)<1){return.5*e*e*e*e*e}return.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return-Math.cos(e*(Math.PI/2))+1},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return e===0?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return e===1?1:-Math.pow(2,-10*e)+1},easeInOutExpo:function(e){if(e===0){return 0}if(e===1){return 1}if((e/=.5)<1){return.5*Math.pow(2,10*(e-1))}return.5*(-Math.pow(2,-10*--e)+2)},easeInCirc:function(e){if(e>=1){return e}return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e=e-1)*e)},easeInOutCirc:function(e){if((e/=.5)<1){return-.5*(Math.sqrt(1-e*e)-1)}return.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158;var r=0;var n=1;if(e===0){return 0}if(e===1){return 1}if(!r){r=.3}if(n<1){n=1;t=r/4}else{t=r/(2*Math.PI)*Math.asin(1/n)}return-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r))},easeOutElastic:function(e){var t=1.70158;var r=0;var n=1;if(e===0){return 0}if(e===1){return 1}if(!r){r=.3}if(n<1){n=1;t=r/4}else{t=r/(2*Math.PI)*Math.asin(1/n)}return n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/r)+1},easeInOutElastic:function(e){var t=1.70158;var r=0;var n=1;if(e===0){return 0}if((e/=.5)===2){return 1}if(!r){r=.45}if(n<1){n=1;t=r/4}else{t=r/(2*Math.PI)*Math.asin(1/n)}if(e<1){return-.5*(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r))}return n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*.5+1},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e=e-1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;if((e/=.5)<1){return.5*(e*e*(((t*=1.525)+1)*e-t))}return.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:function(e){return 1-te.easeOutBounce(1-e)},easeOutBounce:function(e){if(e<1/2.75){return 7.5625*e*e}if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}return 7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function(e){if(e<.5){return te.easeInBounce(e*2)*.5}return te.easeOutBounce(e*2-1)*.5+.5}};var re={effects:te};ee.easingEffects=te;var ne=Math.PI;var ie=ne/180;var ae=ne*2;var oe=ne/2;var se=ne/4;var le=ne*2/3;var ue={clear:function(e){e.ctx.clearRect(0,0,e.width,e.height)},roundedRect:function(e,t,r,n,i,a){if(a){var o=Math.min(a,i/2,n/2);var s=t+o;var l=r+o;var u=t+n-o;var f=r+i-o;e.moveTo(t,l);if(s<u&&l<f){e.arc(s,l,o,-ne,-oe);e.arc(u,l,o,-oe,0);e.arc(u,f,o,0,oe);e.arc(s,f,o,oe,ne)}else if(s<u){e.moveTo(s,r);e.arc(u,l,o,-oe,oe);e.arc(s,l,o,oe,ne+oe)}else if(l<f){e.arc(s,l,o,-ne,0);e.arc(s,f,o,0,ne)}else{e.arc(s,l,o,-ne,ne)}e.closePath();e.moveTo(t,r)}else{e.rect(t,r,n,i)}},drawPoint:function(e,t,r,n,i,a){var o,s,l,u,f;var c=(a||0)*ie;if(t&&typeof t==="object"){o=t.toString();if(o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]"){e.save();e.translate(n,i);e.rotate(c);e.drawImage(t,-t.width/2,-t.height/2,t.width,t.height);e.restore();return}}if(isNaN(r)||r<=0){return}e.beginPath();switch(t){default:e.arc(n,i,r,0,ae);e.closePath();break;case"triangle":e.moveTo(n+Math.sin(c)*r,i-Math.cos(c)*r);c+=le;e.lineTo(n+Math.sin(c)*r,i-Math.cos(c)*r);c+=le;e.lineTo(n+Math.sin(c)*r,i-Math.cos(c)*r);e.closePath();break;case"rectRounded":f=r*.516;u=r-f;s=Math.cos(c+se)*u;l=Math.sin(c+se)*u;e.arc(n-s,i-l,f,c-ne,c-oe);e.arc(n+l,i-s,f,c-oe,c);e.arc(n+s,i+l,f,c,c+oe);e.arc(n-l,i+s,f,c+oe,c+ne);e.closePath();break;case"rect":if(!a){u=Math.SQRT1_2*r;e.rect(n-u,i-u,2*u,2*u);break}c+=se;case"rectRot":s=Math.cos(c)*r;l=Math.sin(c)*r;e.moveTo(n-s,i-l);e.lineTo(n+l,i-s);e.lineTo(n+s,i+l);e.lineTo(n-l,i+s);e.closePath();break;case"crossRot":c+=se;case"cross":s=Math.cos(c)*r;l=Math.sin(c)*r;e.moveTo(n-s,i-l);e.lineTo(n+s,i+l);e.moveTo(n+l,i-s);e.lineTo(n-l,i+s);break;case"star":s=Math.cos(c)*r;l=Math.sin(c)*r;e.moveTo(n-s,i-l);e.lineTo(n+s,i+l);e.moveTo(n+l,i-s);e.lineTo(n-l,i+s);c+=se;s=Math.cos(c)*r;l=Math.sin(c)*r;e.moveTo(n-s,i-l);e.lineTo(n+s,i+l);e.moveTo(n+l,i-s);e.lineTo(n-l,i+s);break;case"line":s=Math.cos(c)*r;l=Math.sin(c)*r;e.moveTo(n-s,i-l);e.lineTo(n+s,i+l);break;case"dash":e.moveTo(n,i);e.lineTo(n+Math.cos(c)*r,i+Math.sin(c)*r);break}e.fill();e.stroke()},_isPointInArea:function(e,t){var r=1e-6;return e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r},clipArea:function(e,t){e.save();e.beginPath();e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top);e.clip()},unclipArea:function(e){e.restore()},lineTo:function(e,t,r,n){var i=r.steppedLine;if(i){if(i==="middle"){var a=(t.x+r.x)/2;e.lineTo(a,n?r.y:t.y);e.lineTo(a,n?t.y:r.y)}else if(i==="after"&&!n||i!=="after"&&n){e.lineTo(t.x,r.y)}else{e.lineTo(r.x,t.y)}e.lineTo(r.x,r.y);return}if(!r.tension){e.lineTo(r.x,r.y);return}e.bezierCurveTo(n?t.controlPointPreviousX:t.controlPointNextX,n?t.controlPointPreviousY:t.controlPointNextY,n?r.controlPointNextX:r.controlPointPreviousX,n?r.controlPointNextY:r.controlPointPreviousY,r.x,r.y)}};var fe=ue;ee.clear=ue.clear;ee.drawRoundedRectangle=function(e){e.beginPath();ue.roundedRect.apply(ue,arguments)};var ce={_set:function(e,t){return ee.merge(this[e]||(this[e]={}),t)}};ce._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:true});var de=ce;var he=ee.valueOrDefault;function ve(e){if(!e||ee.isNullOrUndef(e.size)||ee.isNullOrUndef(e.family)){return null}return(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}var pe={toLineHeight:function(e,t){var r=(""+e).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!r||r[1]==="normal"){return t*1.2}e=+r[2];switch(r[3]){case"px":return e;case"%":e/=100;break}return t*e},toPadding:function(e){var t,r,n,i;if(ee.isObject(e)){t=+e.top||0;r=+e.right||0;n=+e.bottom||0;i=+e.left||0}else{t=r=n=i=+e||0}return{top:t,right:r,bottom:n,left:i,height:t+n,width:i+r}},_parseFont:function(e){var t=de.global;var r=he(e.fontSize,t.defaultFontSize);var n={family:he(e.fontFamily,t.defaultFontFamily),lineHeight:ee.options.toLineHeight(he(e.lineHeight,t.defaultLineHeight),r),size:r,style:he(e.fontStyle,t.defaultFontStyle),weight:null,string:""};n.string=ve(n);return n},resolve:function(e,t,r,n){var i=true;var a,o,s;for(a=0,o=e.length;a<o;++a){s=e[a];if(s===undefined){continue}if(t!==undefined&&typeof s==="function"){s=s(t);i=false}if(r!==undefined&&ee.isArray(s)){s=s[r];i=false}if(s!==undefined){if(n&&!i){n.cacheable=false}return s}}}};var ge={_factorize:function(e){var t=[];var r=Math.sqrt(e);var n;for(n=1;n<r;n++){if(e%n===0){t.push(n);t.push(e/n)}}if(r===(r|0)){t.push(r)}t.sort(function(e,t){return e-t}).pop();return t},log10:Math.log10||function(e){var t=Math.log(e)*Math.LOG10E;var r=Math.round(t);var n=e===Math.pow(10,r);return n?r:t}};var me=ge;ee.log10=ge.log10;var ye=function(t,r){return{x:function(e){return t+t+r-e},setWidth:function(e){r=e},textAlign:function(e){if(e==="center"){return e}return e==="right"?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}};var be=function(){return{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}};var we=function(e,t,r){return e?ye(t,r):be()};var Ce=function(e,t){var r,n;if(t==="ltr"||t==="rtl"){r=e.canvas.style;n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")];r.setProperty("direction",t,"important");e.prevTextDirection=n}};var Se=function(e){var t=e.prevTextDirection;if(t!==undefined){delete e.prevTextDirection;e.canvas.style.setProperty("direction",t[0],t[1])}};var Ee={getRtlAdapter:we,overrideTextDirection:Ce,restoreTextDirection:Se};var ke=ee;var Te=re;var _e=fe;var xe=pe;var De=me;var Re=Ee;ke.easing=Te;ke.canvas=_e;ke.options=xe;ke.math=De;ke.rtl=Re;function Ie(e,t,r,n){var i=Object.keys(r);var a,o,s,l,u,f,c,d,h;for(a=0,o=i.length;a<o;++a){s=i[a];f=r[s];if(!t.hasOwnProperty(s)){t[s]=f}l=t[s];if(l===f||s[0]==="_"){continue}if(!e.hasOwnProperty(s)){e[s]=l}u=e[s];c=typeof f;if(c===typeof u){if(c==="string"){d=Q(u);if(d.valid){h=Q(f);if(h.valid){t[s]=h.mix(d,n).rgbString();continue}}}else if(ke.isFinite(u)&&ke.isFinite(f)){t[s]=u+(f-u)*n;continue}}t[s]=f}}var Oe=function(e){ke.extend(this,e);this.initialize.apply(this,arguments)};ke.extend(Oe.prototype,{_type:undefined,initialize:function(){this.hidden=false},pivot:function(){var e=this;if(!e._view){e._view=ke.extend({},e._model)}e._start={};return e},transition:function(e){var t=this;var r=t._model;var n=t._start;var i=t._view;if(!r||e===1){t._view=ke.extend({},r);t._start=null;return t}if(!i){i=t._view={}}if(!n){n=t._start={}}Ie(n,i,r,e);return t},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return ke.isNumber(this._model.x)&&ke.isNumber(this._model.y)}});Oe.extend=ke.inherits;var Ae=Oe;var Ne=Ae.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null});var Me=Ne;Object.defineProperty(Ne.prototype,"animationObject",{get:function(){return this}});Object.defineProperty(Ne.prototype,"chartInstance",{get:function(){return this.chart},set:function(e){this.chart=e}});de._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:ke.noop,onComplete:ke.noop}});var Le={animations:[],request:null,addAnimation:function(e,t,r,n){var i=this.animations;var a,o;t.chart=e;t.startTime=Date.now();t.duration=r;if(!n){e.animating=true}for(a=0,o=i.length;a<o;++a){if(i[a].chart===e){i[a]=t;return}}i.push(t);if(i.length===1){this.requestAnimationFrame()}},cancelAnimation:function(t){var e=ke.findIndex(this.animations,function(e){return e.chart===t});if(e!==-1){this.animations.splice(e,1);t.animating=false}},requestAnimationFrame:function(){var e=this;if(e.request===null){e.request=ke.requestAnimFrame.call(window,function(){e.request=null;e.startDigest()})}},startDigest:function(){var e=this;e.advance();if(e.animations.length>0){e.requestAnimationFrame()}},advance:function(){var e=this.animations;var t,r,n,i;var a=0;while(a<e.length){t=e[a];r=t.chart;n=t.numSteps;i=Math.floor((Date.now()-t.startTime)/t.duration*n)+1;t.currentStep=Math.min(i,n);ke.callback(t.render,[r,t],r);ke.callback(t.onAnimationProgress,[t],r);if(t.currentStep>=n){ke.callback(t.onAnimationComplete,[t],r);r.animating=false;e.splice(a,1)}else{++a}}}};var Pe=ke.options.resolve;var Fe=["push","pop","shift","splice","unshift"];function Be(i,e){if(i._chartjs){i._chartjs.listeners.push(e);return}Object.defineProperty(i,"_chartjs",{configurable:true,enumerable:false,value:{listeners:[e]}});Fe.forEach(function(e){var r="onData"+e.charAt(0).toUpperCase()+e.slice(1);var n=i[e];Object.defineProperty(i,e,{configurable:true,enumerable:false,value:function(){var t=Array.prototype.slice.call(arguments);var e=n.apply(this,t);ke.each(i._chartjs.listeners,function(e){if(typeof e[r]==="function"){e[r].apply(e,t)}});return e}})})}function He(t,e){var r=t._chartjs;if(!r){return}var n=r.listeners;var i=n.indexOf(e);if(i!==-1){n.splice(i,1)}if(n.length>0){return}Fe.forEach(function(e){delete t[e]});delete t._chartjs}var $e=function(e,t){this.initialize(e,t)};ke.extend(syn.$e.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(e,t){var r=this;r.chart=e;r.index=t;r.linkScales();r.addElements();r._type=r.getMeta().type},updateIndex:function(e){this.index=e},linkScales:function(){var e=this;var t=e.getMeta();var r=e.chart;var n=r.scales;var i=e.getDataset();var a=r.options.scales;if(t.xAxisID===null||!(t.xAxisID in n)||i.xAxisID){t.xAxisID=i.xAxisID||a.xAxes[0].id}if(t.yAxisID===null||!(t.yAxisID in n)||i.yAxisID){t.yAxisID=i.yAxisID||a.yAxes[0].id}},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(e){return this.chart.scales[e]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(true)},destroy:function(){if(this._data){He(this._data,this)}},createMetaDataset:function(){var e=this;var t=e.datasetElementType;return t&&new t({_chart:e.chart,_datasetIndex:e.index})},createMetaData:function(e){var t=this;var r=t.dataElementType;return r&&new r({_chart:t.chart,_datasetIndex:t.index,_index:e})},addElements:function(){var e=this;var t=e.getMeta();var r=e.getDataset().data||[];var n=t.data;var i,a;for(i=0,a=r.length;i<a;++i){n[i]=n[i]||e.createMetaData(i)}t.dataset=t.dataset||e.createMetaDataset()},addElementAndReset:function(e){var t=this.createMetaData(e);this.getMeta().data.splice(e,0,t);this.updateElement(t,e,true)},buildOrUpdateElements:function(){var e=this;var t=e.getDataset();var r=t.data||(t.data=[]);if(e._data!==r){if(e._data){He(e._data,e)}if(r&&Object.isExtensible(r)){Be(r,e)}e._data=r}e.resyncElements()},_configure:function(){var e=this;e._config=ke.merge({},[e.chart.options.datasets[e._type],e.getDataset()],{merger:function(e,t,r){if(e!=="_meta"&&e!=="data"){ke._merger(e,t,r)}}})},_update:function(e){var t=this;t._configure();t._cachedDataOpts=null;t.update(e)},update:ke.noop,transition:function(e){var t=this.getMeta();var r=t.data||[];var n=r.length;var i=0;for(;i<n;++i){r[i].transition(e)}if(t.dataset){t.dataset.transition(e)}},draw:function(){var e=this.getMeta();var t=e.data||[];var r=t.length;var n=0;if(e.dataset){e.dataset.draw()}for(;n<r;++n){t[n].draw()}},getStyle:function(e){var t=this;var r=t.getMeta();var n=r.dataset;var i;t._configure();if(n&&e===undefined){i=t._resolveDatasetElementOptions(n||{})}else{e=e||0;i=t._resolveDataElementOptions(r.data[e]||{},e)}if(i.fill===false||i.fill===null){i.backgroundColor=i.borderColor}return i},_resolveDatasetElementOptions:function(e,t){var r=this;var n=r.chart;var i=r._config;var a=e.custom||{};var o=n.options.elements[r.datasetElementType.prototype._type]||{};var s=r._datasetElementOptions;var l={};var u,f,c,d;var h={chart:n,dataset:r.getDataset(),datasetIndex:r.index,hover:t};for(u=0,f=s.length;u<f;++u){c=s[u];d=t?"hover"+c.charAt(0).toUpperCase()+c.slice(1):c;l[c]=Pe([a[d],i[d],o[d]],h)}return l},_resolveDataElementOptions:function(e,t){var r=this;var n=e&&e.custom;var i=r._cachedDataOpts;if(i&&!n){return i}var a=r.chart;var o=r._config;var s=a.options.elements[r.dataElementType.prototype._type]||{};var l=r._dataElementOptions;var u={};var f={chart:a,dataIndex:t,dataset:r.getDataset(),datasetIndex:r.index};var c={cacheable:!n};var d,h,v,p;n=n||{};if(ke.isArray(l)){for(h=0,v=l.length;h<v;++h){p=l[h];u[p]=Pe([n[p],o[p],s[p]],f,t,c)}}else{d=Object.keys(l);for(h=0,v=d.length;h<v;++h){p=d[h];u[p]=Pe([n[p],o[l[p]],o[p],s[p]],f,t,c)}}if(c.cacheable){r._cachedDataOpts=Object.freeze(u)}return u},removeHoverStyle:function(e){ke.merge(e._model,e.$previousStyle||{});delete e.$previousStyle},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex];var r=e._index;var n=e.custom||{};var i=e._model;var a=ke.getHoverColor;e.$previousStyle={backgroundColor:i.backgroundColor,borderColor:i.borderColor,borderWidth:i.borderWidth};i.backgroundColor=Pe([n.hoverBackgroundColor,t.hoverBackgroundColor,a(i.backgroundColor)],undefined,r);i.borderColor=Pe([n.hoverBorderColor,t.hoverBorderColor,a(i.borderColor)],undefined,r);i.borderWidth=Pe([n.hoverBorderWidth,t.hoverBorderWidth,i.borderWidth],undefined,r)},_removeDatasetHoverStyle:function(){var e=this.getMeta().dataset;if(e){this.removeHoverStyle(e)}},_setDatasetHoverStyle:function(){var e=this.getMeta().dataset;var t={};var r,n,i,a,o,s;if(!e){return}s=e._model;o=this._resolveDatasetElementOptions(e,true);a=Object.keys(o);for(r=0,n=a.length;r<n;++r){i=a[r];t[i]=s[i];s[i]=o[i]}e.$previousStyle=t},resyncElements:function(){var e=this;var t=e.getMeta();var r=e.getDataset().data;var n=t.data.length;var i=r.length;if(i<n){t.data.splice(i,n-i)}else if(i>n){e.insertElements(n,i-n)}},insertElements:function(e,t){for(var r=0;r<t;++r){this.addElementAndReset(e+r)}},onDataPush:function(){var e=arguments.length;this.insertElements(this.getDataset().data.length-e,e)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(e,t){this.getMeta().data.splice(e,t);this.insertElements(e,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}});$e.extend=ke.inherits;var We=$e;var Ue=Math.PI*2;de._set("global",{elements:{arc:{backgroundColor:de.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});function je(e,t){var r=t.startAngle;var n=t.endAngle;var i=t.pixelMargin;var a=i/t.outerRadius;var o=t.x;var s=t.y;e.beginPath();e.arc(o,s,t.outerRadius,r-a,n+a);if(t.innerRadius>i){a=i/t.innerRadius;e.arc(o,s,t.innerRadius-i,n+a,r-a,true)}else{e.arc(o,s,i,n+Math.PI/2,r-Math.PI/2)}e.closePath();e.clip()}function Ve(e,t,r,n){var i=r.endAngle;var a;if(n){r.endAngle=r.startAngle+Ue;je(e,r);r.endAngle=i;if(r.endAngle===r.startAngle&&r.fullCircles){r.endAngle+=Ue;r.fullCircles--}}e.beginPath();e.arc(r.x,r.y,r.innerRadius,r.startAngle+Ue,r.startAngle,true);for(a=0;a<r.fullCircles;++a){e.stroke()}e.beginPath();e.arc(r.x,r.y,t.outerRadius,r.startAngle,r.startAngle+Ue);for(a=0;a<r.fullCircles;++a){e.stroke()}}function ze(e,t,r){var n=t.borderAlign==="inner";if(n){e.lineWidth=t.borderWidth*2;e.lineJoin="round"}else{e.lineWidth=t.borderWidth;e.lineJoin="bevel"}if(r.fullCircles){Ve(e,t,r,n)}if(n){je(e,r)}e.beginPath();e.arc(r.x,r.y,t.outerRadius,r.startAngle,r.endAngle);e.arc(r.x,r.y,r.innerRadius,r.endAngle,r.startAngle,true);e.closePath();e.stroke()}var qe=Ae.extend({_type:"arc",inLabelRange:function(e){var t=this._view;if(t){return Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2)}return false},inRange:function(e,t){var r=this._view;if(r){var n=ke.getAngleFromPoint(r,{x:e,y:t});var i=n.angle;var a=n.distance;var o=r.startAngle;var s=r.endAngle;while(s<o){s+=Ue}while(i>s){i-=Ue}while(i<o){i+=Ue}var l=i>=o&&i<=s;var u=a>=r.innerRadius&&a<=r.outerRadius;return l&&u}return false},getCenterPoint:function(){var e=this._view;var t=(e.startAngle+e.endAngle)/2;var r=(e.innerRadius+e.outerRadius)/2;return{x:e.x+Math.cos(t)*r,y:e.y+Math.sin(t)*r}},getArea:function(){var e=this._view;return Math.PI*((e.endAngle-e.startAngle)/(2*Math.PI))*(Math.pow(e.outerRadius,2)-Math.pow(e.innerRadius,2))},tooltipPosition:function(){var e=this._view;var t=e.startAngle+(e.endAngle-e.startAngle)/2;var r=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*r,y:e.y+Math.sin(t)*r}},draw:function(){var e=this._chart.ctx;var t=this._view;var r=t.borderAlign==="inner"?.33:0;var n={x:t.x,y:t.y,innerRadius:t.innerRadius,outerRadius:Math.max(t.outerRadius-r,0),pixelMargin:r,startAngle:t.startAngle,endAngle:t.endAngle,fullCircles:Math.floor(t.circumference/Ue)};var i;e.save();e.fillStyle=t.backgroundColor;e.strokeStyle=t.borderColor;if(n.fullCircles){n.endAngle=n.startAngle+Ue;e.beginPath();e.arc(n.x,n.y,n.outerRadius,n.startAngle,n.endAngle);e.arc(n.x,n.y,n.innerRadius,n.endAngle,n.startAngle,true);e.closePath();for(i=0;i<n.fullCircles;++i){e.fill()}n.endAngle=n.startAngle+t.circumference%Ue}e.beginPath();e.arc(n.x,n.y,n.outerRadius,n.startAngle,n.endAngle);e.arc(n.x,n.y,n.innerRadius,n.endAngle,n.startAngle,true);e.closePath();e.fill();if(t.borderWidth){ze(e,t,n)}e.restore()}});var Ye=ke.valueOrDefault;var Ge=de.global.defaultColor;de._set("global",{elements:{line:{tension:.4,backgroundColor:Ge,borderWidth:3,borderColor:Ge,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:true,fill:true}}});var Xe=Ae.extend({_type:"line",draw:function(){var e=this;var t=e._view;var r=e._chart.ctx;var n=t.spanGaps;var i=e._children.slice();var a=de.global;var o=a.elements.line;var s=-1;var l=e._loop;var u,f,c;if(!i.length){return}if(e._loop){for(u=0;u<i.length;++u){f=ke.previousItem(i,u);if(!i[u]._view.skip&&f._view.skip){i=i.slice(u).concat(i.slice(0,u));l=n;break}}if(l){i.push(i[0])}}r.save();r.lineCap=t.borderCapStyle||o.borderCapStyle;if(r.setLineDash){r.setLineDash(t.borderDash||o.borderDash)}r.lineDashOffset=Ye(t.borderDashOffset,o.borderDashOffset);r.lineJoin=t.borderJoinStyle||o.borderJoinStyle;r.lineWidth=Ye(t.borderWidth,o.borderWidth);r.strokeStyle=t.borderColor||a.defaultColor;r.beginPath();c=i[0]._view;if(!c.skip){r.moveTo(c.x,c.y);s=0}for(u=1;u<i.length;++u){c=i[u]._view;f=s===-1?ke.previousItem(i,u):i[s];if(!c.skip){if(s!==u-1&&!n||s===-1){r.moveTo(c.x,c.y)}else{ke.canvas.lineTo(r,f._view,c)}s=u}}if(l){r.closePath()}r.stroke();r.restore()}});var Ke=ke.valueOrDefault;var Je=de.global.defaultColor;de._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:Je,borderColor:Je,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});function Qe(e){var t=this._view;return t?Math.abs(e-t.x)<t.radius+t.hitRadius:false}function Ze(e){var t=this._view;return t?Math.abs(e-t.y)<t.radius+t.hitRadius:false}var et=Ae.extend({_type:"point",inRange:function(e,t){var r=this._view;return r?Math.pow(e-r.x,2)+Math.pow(t-r.y,2)<Math.pow(r.hitRadius+r.radius,2):false},inLabelRange:Qe,inXRange:Qe,inYRange:Ze,getCenterPoint:function(){var e=this._view;return{x:e.x,y:e.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function(e){var t=this._view;var r=this._chart.ctx;var n=t.pointStyle;var i=t.rotation;var a=t.radius;var o=t.x;var s=t.y;var l=de.global;var u=l.defaultColor;if(t.skip){return}if(e===undefined||ke.canvas._isPointInArea(t,e)){r.strokeStyle=t.borderColor||u;r.lineWidth=Ke(t.borderWidth,l.elements.point.borderWidth);r.fillStyle=t.backgroundColor||u;ke.canvas.drawPoint(r,n,a,o,s,i)}}});var tt=de.global.defaultColor;de._set("global",{elements:{rectangle:{backgroundColor:tt,borderColor:tt,borderSkipped:"bottom",borderWidth:0}}});function rt(e){return e&&e.width!==undefined}function nt(e){var t,r,n,i,a;if(rt(e)){a=e.width/2;t=e.x-a;r=e.x+a;n=Math.min(e.y,e.base);i=Math.max(e.y,e.base)}else{a=e.height/2;t=Math.min(e.x,e.base);r=Math.max(e.x,e.base);n=e.y-a;i=e.y+a}return{left:t,top:n,right:r,bottom:i}}function it(e,t,r){return e===t?r:e===r?t:e}function at(e){var t=e.borderSkipped;var r={};if(!t){return r}if(e.horizontal){if(e.base>e.x){t=it(t,"left","right")}}else if(e.base<e.y){t=it(t,"bottom","top")}r[t]=true;return r}function ot(e,t,r){var n=e.borderWidth;var i=at(e);var a,o,s,l;if(ke.isObject(n)){a=+n.top||0;o=+n.right||0;s=+n.bottom||0;l=+n.left||0}else{a=o=s=l=+n||0}return{t:i.top||a<0?0:a>r?r:a,r:i.right||o<0?0:o>t?t:o,b:i.bottom||s<0?0:s>r?r:s,l:i.left||l<0?0:l>t?t:l}}function st(e){var t=nt(e);var r=t.right-t.left;var n=t.bottom-t.top;var i=ot(e,r/2,n/2);return{outer:{x:t.left,y:t.top,w:r,h:n},inner:{x:t.left+i.l,y:t.top+i.t,w:r-i.l-i.r,h:n-i.t-i.b}}}function lt(e,t,r){var n=t===null;var i=r===null;var a=!e||n&&i?false:nt(e);return a&&(n||t>=a.left&&t<=a.right)&&(i||r>=a.top&&r<=a.bottom)}var ut=Ae.extend({_type:"rectangle",draw:function(){var e=this._chart.ctx;var t=this._view;var r=st(t);var n=r.outer;var i=r.inner;e.fillStyle=t.backgroundColor;e.fillRect(n.x,n.y,n.w,n.h);if(n.w===i.w&&n.h===i.h){return}e.save();e.beginPath();e.rect(n.x,n.y,n.w,n.h);e.clip();e.fillStyle=t.borderColor;e.rect(i.x,i.y,i.w,i.h);e.fill("evenodd");e.restore()},height:function(){var e=this._view;return e.base-e.y},inRange:function(e,t){return lt(this._view,e,t)},inLabelRange:function(e,t){var r=this._view;return rt(r)?lt(r,e,null):lt(r,null,t)},inXRange:function(e){return lt(this._view,e,null)},inYRange:function(e){return lt(this._view,null,e)},getCenterPoint:function(){var e=this._view;var t,r;if(rt(e)){t=e.x;r=(e.y+e.base)/2}else{t=(e.x+e.base)/2;r=e.y}return{x:t,y:r}},getArea:function(){var e=this._view;return rt(e)?e.width*Math.abs(e.y-e.base):e.height*Math.abs(e.x-e.base)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y}}});var ft={};var ct=qe;var dt=Xe;var ht=et;var vt=ut;ft.Arc=ct;ft.Line=dt;ft.Point=ht;ft.Rectangle=vt;var pt=ke._deprecated;var gt=ke.valueOrDefault;de._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:true,gridLines:{offsetGridLines:true}}],yAxes:[{type:"linear"}]}});de._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});function mt(e,t){var r=e._length;var n,i,a,o;for(a=1,o=t.length;a<o;++a){r=Math.min(r,Math.abs(t[a]-t[a-1]))}for(a=0,o=e.getTicks().length;a<o;++a){i=e.getPixelForTick(a);r=a>0?Math.min(r,Math.abs(i-n)):r;n=i}return r}function yt(e,t,r){var n=r.barThickness;var i=t.stackCount;var a=t.pixels[e];var o=ke.isNullOrUndef(n)?mt(t.scale,t.pixels):-1;var s,l;if(ke.isNullOrUndef(n)){s=o*r.categoryPercentage;l=r.barPercentage}else{s=n*i;l=1}return{chunk:s/i,ratio:l,start:a-s/2}}function bt(e,t,r){var n=t.pixels;var i=n[e];var a=e>0?n[e-1]:null;var o=e<n.length-1?n[e+1]:null;var s=r.categoryPercentage;var l,u;if(a===null){a=i-(o===null?t.end-t.start:o-i)}if(o===null){o=i+i-a}l=i-(i-Math.min(a,o))/2*s;u=Math.abs(o-a)/2*s;return{chunk:u/t.stackCount,ratio:r.barPercentage,start:l}}var wt=We.extend({dataElementType:ft.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var e=this;var t,r;We.prototype.initialize.apply(e,arguments);t=e.getMeta();t.stack=e.getDataset().stack;t.bar=true;r=e._getIndexScale().options;pt("bar chart",r.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage");pt("bar chart",r.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness");pt("bar chart",r.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage");pt("bar chart",e._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength");pt("bar chart",r.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(e){var t=this;var r=t.getMeta().data;var n,i;t._ruler=t.getRuler();for(n=0,i=r.length;n<i;++n){t.updateElement(r[n],n,e)}},updateElement:function(e,t,r){var n=this;var i=n.getMeta();var a=n.getDataset();var o=n._resolveDataElementOptions(e,t);e._xScale=n.getScaleForId(i.xAxisID);e._yScale=n.getScaleForId(i.yAxisID);e._datasetIndex=n.index;e._index=t;e._model={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth,datasetLabel:a.label,label:n.chart.data.labels[t]};if(ke.isArray(a.data[t])){e._model.borderSkipped=null}n._updateElementGeometry(e,t,r,o);e.pivot()},_updateElementGeometry:function(e,t,r,n){var i=this;var a=e._model;var o=i._getValueScale();var s=o.getBasePixel();var l=o.isHorizontal();var u=i._ruler||i.getRuler();var f=i.calculateBarValuePixels(i.index,t,n);var c=i.calculateBarIndexPixels(i.index,t,u,n);a.horizontal=l;a.base=r?s:f.base;a.x=l?r?s:f.head:c.center;a.y=l?c.center:r?s:f.head;a.height=l?c.size:undefined;a.width=l?undefined:c.size},_getStacks:function(e){var t=this;var r=t._getIndexScale();var n=r._getMatchingVisibleMetas(t._type);var i=r.options.stacked;var a=n.length;var o=[];var s,l;for(s=0;s<a;++s){l=n[s];if(i===false||o.indexOf(l.stack)===-1||i===undefined&&l.stack===undefined){o.push(l.stack)}if(l.index===e){break}}return o},getStackCount:function(){return this._getStacks().length},getStackIndex:function(e,t){var r=this._getStacks(e);var n=t!==undefined?r.indexOf(t):-1;return n===-1?r.length-1:n},getRuler:function(){var e=this;var t=e._getIndexScale();var r=[];var n,i;for(n=0,i=e.getMeta().data.length;n<i;++n){r.push(t.getPixelForValue(null,n,e.index))}return{pixels:r,start:t._startPixel,end:t._endPixel,stackCount:e.getStackCount(),scale:t}},calculateBarValuePixels:function(e,t,r){var n=this;var i=n.chart;var a=n._getValueScale();var o=a.isHorizontal();var s=i.data.datasets;var l=a._getMatchingVisibleMetas(n._type);var u=a._parseValue(s[e].data[t]);var f=r.minBarLength;var c=a.options.stacked;var d=n.getMeta().stack;var h=u.start===undefined?0:u.max>=0&&u.min>=0?u.min:u.max;var v=u.start===undefined?u.end:u.max>=0&&u.min>=0?u.max-u.min:u.min-u.max;var p=l.length;var g,m,y,b,w,C,S;if(c||c===undefined&&d!==undefined){for(g=0;g<p;++g){m=l[g];if(m.index===e){break}if(m.stack===d){S=a._parseValue(s[m.index].data[t]);y=S.start===undefined?S.end:S.min>=0&&S.max>=0?S.max:S.min;if(u.min<0&&y<0||u.max>=0&&y>0){h+=y}}}}b=a.getPixelForValue(h);w=a.getPixelForValue(h+v);C=w-b;if(f!==undefined&&Math.abs(C)<f){C=f;if(v>=0&&!o||v<0&&o){w=b-f}else{w=b+f}}return{size:C,base:b,head:w,center:w+C/2}},calculateBarIndexPixels:function(e,t,r,n){var i=this;var a=n.barThickness==="flex"?bt(t,r,n):yt(t,r,n);var o=i.getStackIndex(e,i.getMeta().stack);var s=a.start+a.chunk*o+a.chunk/2;var l=Math.min(gt(n.maxBarThickness,Infinity),a.chunk*a.ratio);return{base:s-l/2,head:s+l/2,center:s,size:l}},draw:function(){var e=this;var t=e.chart;var r=e._getValueScale();var n=e.getMeta().data;var i=e.getDataset();var a=n.length;var o=0;ke.canvas.clipArea(t.ctx,t.chartArea);for(;o<a;++o){var s=r._parseValue(i.data[o]);if(!isNaN(s.min)&&!isNaN(s.max)){n[o].draw()}}ke.canvas.unclipArea(t.ctx)},_resolveDataElementOptions:function(){var e=this;var t=ke.extend({},We.prototype._resolveDataElementOptions.apply(e,arguments));var r=e._getIndexScale().options;var n=e._getValueScale().options;t.barPercentage=gt(r.barPercentage,t.barPercentage);t.barThickness=gt(r.barThickness,t.barThickness);t.categoryPercentage=gt(r.categoryPercentage,t.categoryPercentage);t.maxBarThickness=gt(r.maxBarThickness,t.maxBarThickness);t.minBarLength=gt(n.minBarLength,t.minBarLength);return t}});var Ct=ke.valueOrDefault;var St=ke.options.resolve;de._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(e,t){var r=t.datasets[e.datasetIndex].label||"";var n=t.datasets[e.datasetIndex].data[e.index];return r+": ("+e.xLabel+", "+e.yLabel+", "+n.r+")"}}}});var Et=We.extend({dataElementType:ft.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(r){var n=this;var e=n.getMeta();var t=e.data;ke.each(t,function(e,t){n.updateElement(e,t,r)})},updateElement:function(e,t,r){var n=this;var i=n.getMeta();var a=e.custom||{};var o=n.getScaleForId(i.xAxisID);var s=n.getScaleForId(i.yAxisID);var l=n._resolveDataElementOptions(e,t);var u=n.getDataset().data[t];var f=n.index;var c=r?o.getPixelForDecimal(.5):o.getPixelForValue(typeof u==="object"?u:NaN,t,f);var d=r?s.getBasePixel():s.getPixelForValue(u,t,f);e._xScale=o;e._yScale=s;e._options=l;e._datasetIndex=f;e._index=t;e._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:r?0:l.radius,skip:a.skip||isNaN(c)||isNaN(d),x:c,y:d};e.pivot()},setHoverStyle:function(e){var t=e._model;var r=e._options;var n=ke.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius};t.backgroundColor=Ct(r.hoverBackgroundColor,n(r.backgroundColor));t.borderColor=Ct(r.hoverBorderColor,n(r.borderColor));t.borderWidth=Ct(r.hoverBorderWidth,r.borderWidth);t.radius=r.radius+r.hoverRadius},_resolveDataElementOptions:function(e,t){var r=this;var n=r.chart;var i=r.getDataset();var a=e.custom||{};var o=i.data[t]||{};var s=We.prototype._resolveDataElementOptions.apply(r,arguments);var l={chart:n,dataIndex:t,dataset:i,datasetIndex:r.index};if(r._cachedDataOpts===s){s=ke.extend({},s)}s.radius=St([a.radius,o.r,r._config.radius,n.options.elements.point.radius],l,t);return s}});var kt=ke.valueOrDefault;var Tt=Math.PI;var _t=Tt*2;var xt=Tt/2;de._set("doughnut",{animation:{animateRotate:true,animateScale:false},hover:{mode:"single"},legendCallback:function(e){var t=document.createElement("ul");var r=e.data;var n=r.datasets;var i=r.labels;var a,o,s,l;t.setAttribute("class",e.id+"-legend");if(n.length){for(a=0,o=n[0].data.length;a<o;++a){s=t.appendChild(document.createElement("li"));l=s.appendChild(document.createElement("span"));l.style.backgroundColor=n[0].backgroundColor[a];if(i[a]){s.appendChild(document.createTextNode(i[a]))}}}return t.outerHTML},legend:{labels:{generateLabels:function(i){var a=i.data;if(a.labels.length&&a.datasets.length){return a.labels.map(function(e,t){var r=i.getDatasetMeta(0);var n=r.controller.getStyle(t);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,hidden:isNaN(a.datasets[0].data[t])||r.data[t].hidden,index:t}})}return[]}},onClick:function(e,t){var r=t.index;var n=this.chart;var i,a,o;for(i=0,a=(n.data.datasets||[]).length;i<a;++i){o=n.getDatasetMeta(i);if(o.data[r]){o.data[r].hidden=!o.data[r].hidden}}n.update()}},cutoutPercentage:50,rotation:-xt,circumference:_t,tooltips:{callbacks:{title:function(){return""},label:function(e,t){var r=t.labels[e.index];var n=": "+t.datasets[e.datasetIndex].data[e.index];if(ke.isArray(r)){r=r.slice();r[0]+=n}else{r+=n}return r}}}});var Dt=We.extend({dataElementType:ft.Arc,linkScales:ke.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(e){var t=0;for(var r=0;r<e;++r){if(this.chart.isDatasetVisible(r)){++t}}return t},update:function(e){var t=this;var r=t.chart;var n=r.chartArea;var i=r.options;var a=1;var o=1;var s=0;var l=0;var u=t.getMeta();var f=u.data;var c=i.cutoutPercentage/100||0;var d=i.circumference;var h=t._getRingWeight(t.index);var v,p,g,m;if(d<_t){var y=i.rotation%_t;y+=y>=Tt?-_t:y<-Tt?_t:0;var b=y+d;var w=Math.cos(y);var C=Math.sin(y);var S=Math.cos(b);var E=Math.sin(b);var k=y<=0&&b>=0||b>=_t;var T=y<=xt&&b>=xt||b>=_t+xt;var _=y===-Tt||b>=Tt;var x=y<=-xt&&b>=-xt||b>=Tt+xt;var D=_?-1:Math.min(w,w*c,S,S*c);var R=x?-1:Math.min(C,C*c,E,E*c);var I=k?1:Math.max(w,w*c,S,S*c);var O=T?1:Math.max(C,C*c,E,E*c);a=(I-D)/2;o=(O-R)/2;s=-(I+D)/2;l=-(O+R)/2}for(g=0,m=f.length;g<m;++g){f[g]._options=t._resolveDataElementOptions(f[g],g)}r.borderWidth=t.getMaxBorderWidth();v=(n.right-n.left-r.borderWidth)/a;p=(n.bottom-n.top-r.borderWidth)/o;r.outerRadius=Math.max(Math.min(v,p)/2,0);r.innerRadius=Math.max(r.outerRadius*c,0);r.radiusLength=(r.outerRadius-r.innerRadius)/(t._getVisibleDatasetWeightTotal()||1);r.offsetX=s*r.outerRadius;r.offsetY=l*r.outerRadius;u.total=t.calculateTotal();t.outerRadius=r.outerRadius-r.radiusLength*t._getRingWeightOffset(t.index);t.innerRadius=Math.max(t.outerRadius-r.radiusLength*h,0);for(g=0,m=f.length;g<m;++g){t.updateElement(f[g],g,e)}},updateElement:function(e,t,r){var n=this;var i=n.chart;var a=i.chartArea;var o=i.options;var s=o.animation;var l=(a.left+a.right)/2;var u=(a.top+a.bottom)/2;var f=o.rotation;var c=o.rotation;var d=n.getDataset();var h=r&&s.animateRotate?0:e.hidden?0:n.calculateCircumference(d.data[t])*(o.circumference/_t);var v=r&&s.animateScale?0:n.innerRadius;var p=r&&s.animateScale?0:n.outerRadius;var g=e._options||{};ke.extend(e,{_datasetIndex:n.index,_index:t,_model:{backgroundColor:g.backgroundColor,borderColor:g.borderColor,borderWidth:g.borderWidth,borderAlign:g.borderAlign,x:l+i.offsetX,y:u+i.offsetY,startAngle:f,endAngle:c,circumference:h,outerRadius:p,innerRadius:v,label:ke.valueAtIndexOrDefault(d.label,t,i.data.labels[t])}});var m=e._model;if(!r||!s.animateRotate){if(t===0){m.startAngle=o.rotation}else{m.startAngle=n.getMeta().data[t-1]._model.endAngle}m.endAngle=m.startAngle+m.circumference}e.pivot()},calculateTotal:function(){var r=this.getDataset();var e=this.getMeta();var n=0;var i;ke.each(e.data,function(e,t){i=r.data[t];if(!isNaN(i)&&!e.hidden){n+=Math.abs(i)}});return n},calculateCircumference:function(e){var t=this.getMeta().total;if(t>0&&!isNaN(e)){return _t*(Math.abs(e)/t)}return 0},getMaxBorderWidth:function(e){var t=this;var r=0;var n=t.chart;var i,a,o,s,l,u,f,c;if(!e){for(i=0,a=n.data.datasets.length;i<a;++i){if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i);e=o.data;if(i!==t.index){l=o.controller}break}}}if(!e){return 0}for(i=0,a=e.length;i<a;++i){s=e[i];if(l){l._configure();u=l._resolveDataElementOptions(s,i)}else{u=s._options}if(u.borderAlign!=="inner"){f=u.borderWidth;c=u.hoverBorderWidth;r=f>r?f:r;r=c>r?c:r}}return r},setHoverStyle:function(e){var t=e._model;var r=e._options;var n=ke.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth};t.backgroundColor=kt(r.hoverBackgroundColor,n(r.backgroundColor));t.borderColor=kt(r.hoverBorderColor,n(r.borderColor));t.borderWidth=kt(r.hoverBorderWidth,r.borderWidth)},_getRingWeightOffset:function(e){var t=0;for(var r=0;r<e;++r){if(this.chart.isDatasetVisible(r)){t+=this._getRingWeight(r)}}return t},_getRingWeight:function(e){return Math.max(kt(this.chart.data.datasets[e].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});de._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:true,gridLines:{offsetGridLines:true}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}});de._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var Rt=wt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}});var It=ke.valueOrDefault;var Ot=ke.options.resolve;var At=ke.canvas._isPointInArea;de._set("line",{showLines:true,spanGaps:false,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});function Nt(e,t){var r=e&&e.options.ticks||{};var n=r.reverse;var i=r.min===undefined?t:0;var a=r.max===undefined?t:0;return{start:n?a:i,end:n?i:a}}function Mt(e,t,r){var n=r/2;var i=Nt(e,n);var a=Nt(t,n);return{top:a.end,right:i.end,bottom:a.start,left:i.start}}function Lt(e){var t,r,n,i;if(ke.isObject(e)){t=e.top;r=e.right;n=e.bottom;i=e.left}else{t=r=n=i=e}return{top:t,right:r,bottom:n,left:i}}var Pt=We.extend({datasetElementType:ft.Line,dataElementType:ft.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(e){var t=this;var r=t.getMeta();var n=r.dataset;var i=r.data||[];var a=t.chart.options;var o=t._config;var s=t._showLine=It(o.showLine,a.showLines);var l,u;t._xScale=t.getScaleForId(r.xAxisID);t._yScale=t.getScaleForId(r.yAxisID);if(s){if(o.tension!==undefined&&o.lineTension===undefined){o.lineTension=o.tension}n._scale=t._yScale;n._datasetIndex=t.index;n._children=i;n._model=t._resolveDatasetElementOptions(n);n.pivot()}for(l=0,u=i.length;l<u;++l){t.updateElement(i[l],l,e)}if(s&&n._model.tension!==0){t.updateBezierControlPoints()}for(l=0,u=i.length;l<u;++l){i[l].pivot()}},updateElement:function(e,t,r){var n=this;var i=n.getMeta();var a=e.custom||{};var o=n.getDataset();var s=n.index;var l=o.data[t];var u=n._xScale;var f=n._yScale;var c=i.dataset._model;var d,h;var v=n._resolveDataElementOptions(e,t);d=u.getPixelForValue(typeof l==="object"?l:NaN,t,s);h=r?f.getBasePixel():n.calculatePointY(l,t,s);e._xScale=u;e._yScale=f;e._options=v;e._datasetIndex=s;e._index=t;e._model={x:d,y:h,skip:a.skip||isNaN(d)||isNaN(h),radius:v.radius,pointStyle:v.pointStyle,rotation:v.rotation,backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,tension:It(a.tension,c?c.tension:0),steppedLine:c?c.steppedLine:false,hitRadius:v.hitRadius}},_resolveDatasetElementOptions:function(e){var t=this;var r=t._config;var n=e.custom||{};var i=t.chart.options;var a=i.elements.line;var o=We.prototype._resolveDatasetElementOptions.apply(t,arguments);o.spanGaps=It(r.spanGaps,i.spanGaps);o.tension=It(r.lineTension,a.tension);o.steppedLine=Ot([n.steppedLine,r.steppedLine,a.stepped]);o.clip=Lt(It(r.clip,Mt(t._xScale,t._yScale,o.borderWidth)));return o},calculatePointY:function(e,t,r){var n=this;var i=n.chart;var a=n._yScale;var o=0;var s=0;var l,u,f,c,d,h,v;if(a.options.stacked){d=+a.getRightValue(e);h=i._getSortedVisibleDatasetMetas();v=h.length;for(l=0;l<v;++l){f=h[l];if(f.index===r){break}u=i.data.datasets[f.index];if(f.type==="line"&&f.yAxisID===a.id){c=+a.getRightValue(u.data[t]);if(c<0){s+=c||0}else{o+=c||0}}}if(d<0){return a.getPixelForValue(s+d)}return a.getPixelForValue(o+d)}return a.getPixelForValue(e)},updateBezierControlPoints:function(){var e=this;var t=e.chart;var r=e.getMeta();var n=r.dataset._model;var i=t.chartArea;var a=r.data||[];var o,s,l,u;if(n.spanGaps){a=a.filter(function(e){return!e._model.skip})}function f(e,t,r){return Math.max(Math.min(e,r),t)}if(n.cubicInterpolationMode==="monotone"){ke.splineCurveMonotone(a)}else{for(o=0,s=a.length;o<s;++o){l=a[o]._model;u=ke.splineCurve(ke.previousItem(a,o)._model,l,ke.nextItem(a,o)._model,n.tension);l.controlPointPreviousX=u.previous.x;l.controlPointPreviousY=u.previous.y;l.controlPointNextX=u.next.x;l.controlPointNextY=u.next.y}}if(t.options.elements.line.capBezierPoints){for(o=0,s=a.length;o<s;++o){l=a[o]._model;if(At(l,i)){if(o>0&&At(a[o-1]._model,i)){l.controlPointPreviousX=f(l.controlPointPreviousX,i.left,i.right);l.controlPointPreviousY=f(l.controlPointPreviousY,i.top,i.bottom)}if(o<a.length-1&&At(a[o+1]._model,i)){l.controlPointNextX=f(l.controlPointNextX,i.left,i.right);l.controlPointNextY=f(l.controlPointNextY,i.top,i.bottom)}}}}},draw:function(){var e=this;var t=e.chart;var r=e.getMeta();var n=r.data||[];var i=t.chartArea;var a=t.canvas;var o=0;var s=n.length;var l;if(e._showLine){l=r.dataset._model.clip;ke.canvas.clipArea(t.ctx,{left:l.left===false?0:i.left-l.left,right:l.right===false?a.width:i.right+l.right,top:l.top===false?0:i.top-l.top,bottom:l.bottom===false?a.height:i.bottom+l.bottom});r.dataset.draw();ke.canvas.unclipArea(t.ctx)}for(;o<s;++o){n[o].draw(i)}},setHoverStyle:function(e){var t=e._model;var r=e._options;var n=ke.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius};t.backgroundColor=It(r.hoverBackgroundColor,n(r.backgroundColor));t.borderColor=It(r.hoverBorderColor,n(r.borderColor));t.borderWidth=It(r.hoverBorderWidth,r.borderWidth);t.radius=It(r.hoverRadius,r.radius)}});var Ft=ke.options.resolve;de._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:false},gridLines:{circular:true},pointLabels:{display:false},ticks:{beginAtZero:true}},animation:{animateRotate:true,animateScale:true},startAngle:-.5*Math.PI,legendCallback:function(e){var t=document.createElement("ul");var r=e.data;var n=r.datasets;var i=r.labels;var a,o,s,l;t.setAttribute("class",e.id+"-legend");if(n.length){for(a=0,o=n[0].data.length;a<o;++a){s=t.appendChild(document.createElement("li"));l=s.appendChild(document.createElement("span"));l.style.backgroundColor=n[0].backgroundColor[a];if(i[a]){s.appendChild(document.createTextNode(i[a]))}}}return t.outerHTML},legend:{labels:{generateLabels:function(i){var a=i.data;if(a.labels.length&&a.datasets.length){return a.labels.map(function(e,t){var r=i.getDatasetMeta(0);var n=r.controller.getStyle(t);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,hidden:isNaN(a.datasets[0].data[t])||r.data[t].hidden,index:t}})}return[]}},onClick:function(e,t){var r=t.index;var n=this.chart;var i,a,o;for(i=0,a=(n.data.datasets||[]).length;i<a;++i){o=n.getDatasetMeta(i);o.data[r].hidden=!o.data[r].hidden}n.update()}},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+e.yLabel}}}});var Bt=We.extend({dataElementType:ft.Arc,linkScales:ke.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t=this;var r=t.getDataset();var n=t.getMeta();var i=t.chart.options.startAngle||0;var a=t._starts=[];var o=t._angles=[];var s=n.data;var l,u,f;t._updateRadius();n.count=t.countVisibleElements();for(l=0,u=r.data.length;l<u;l++){a[l]=i;f=t._computeAngle(l);o[l]=f;i+=f}for(l=0,u=s.length;l<u;++l){s[l]._options=t._resolveDataElementOptions(s[l],l);t.updateElement(s[l],l,e)}},_updateRadius:function(){var e=this;var t=e.chart;var r=t.chartArea;var n=t.options;var i=Math.min(r.right-r.left,r.bottom-r.top);t.outerRadius=Math.max(i/2,0);t.innerRadius=Math.max(n.cutoutPercentage?t.outerRadius/100*n.cutoutPercentage:1,0);t.radiusLength=(t.outerRadius-t.innerRadius)/t.getVisibleDatasetCount();e.outerRadius=t.outerRadius-t.radiusLength*e.index;e.innerRadius=e.outerRadius-t.radiusLength},updateElement:function(e,t,r){var n=this;var i=n.chart;var a=n.getDataset();var o=i.options;var s=o.animation;var l=i.scale;var u=i.data.labels;var f=l.xCenter;var c=l.yCenter;var d=o.startAngle;var h=e.hidden?0:l.getDistanceFromCenterForValue(a.data[t]);var v=n._starts[t];var p=v+(e.hidden?0:n._angles[t]);var g=s.animateScale?0:l.getDistanceFromCenterForValue(a.data[t]);var m=e._options||{};ke.extend(e,{_datasetIndex:n.index,_index:t,_scale:l,_model:{backgroundColor:m.backgroundColor,borderColor:m.borderColor,borderWidth:m.borderWidth,borderAlign:m.borderAlign,x:f,y:c,innerRadius:0,outerRadius:r?g:h,startAngle:r&&s.animateRotate?d:v,endAngle:r&&s.animateRotate?d:p,label:ke.valueAtIndexOrDefault(u,t,u[t])}});e.pivot()},countVisibleElements:function(){var r=this.getDataset();var e=this.getMeta();var n=0;ke.each(e.data,function(e,t){if(!isNaN(r.data[t])&&!e.hidden){n++}});return n},setHoverStyle:function(e){var t=e._model;var r=e._options;var n=ke.getHoverColor;var i=ke.valueOrDefault;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth};t.backgroundColor=i(r.hoverBackgroundColor,n(r.backgroundColor));t.borderColor=i(r.hoverBorderColor,n(r.borderColor));t.borderWidth=i(r.hoverBorderWidth,r.borderWidth)},_computeAngle:function(e){var t=this;var r=this.getMeta().count;var n=t.getDataset();var i=t.getMeta();if(isNaN(n.data[e])||i.data[e].hidden){return 0}var a={chart:t.chart,dataIndex:e,dataset:n,datasetIndex:t.index};return Ft([t.chart.options.elements.arc.angle,2*Math.PI/r],a,e)}});de._set("pie",ke.clone(de.doughnut));de._set("pie",{cutoutPercentage:0});var Ht=Dt;var $t=ke.valueOrDefault;de._set("radar",{spanGaps:false,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var Wt=We.extend({datasetElementType:ft.Line,dataElementType:ft.Point,linkScales:ke.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t=this;var r=t.getMeta();var n=r.dataset;var i=r.data||[];var a=t.chart.scale;var o=t._config;var s,l;if(o.tension!==undefined&&o.lineTension===undefined){o.lineTension=o.tension}n._scale=a;n._datasetIndex=t.index;n._children=i;n._loop=true;n._model=t._resolveDatasetElementOptions(n);n.pivot();for(s=0,l=i.length;s<l;++s){t.updateElement(i[s],s,e)}t.updateBezierControlPoints();for(s=0,l=i.length;s<l;++s){i[s].pivot()}},updateElement:function(e,t,r){var n=this;var i=e.custom||{};var a=n.getDataset();var o=n.chart.scale;var s=o.getPointPositionForValue(t,a.data[t]);var l=n._resolveDataElementOptions(e,t);var u=n.getMeta().dataset._model;var f=r?o.xCenter:s.x;var c=r?o.yCenter:s.y;e._scale=o;e._options=l;e._datasetIndex=n.index;e._index=t;e._model={x:f,y:c,skip:i.skip||isNaN(f)||isNaN(c),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:$t(i.tension,u?u.tension:0),hitRadius:l.hitRadius}},_resolveDatasetElementOptions:function(){var e=this;var t=e._config;var r=e.chart.options;var n=We.prototype._resolveDatasetElementOptions.apply(e,arguments);n.spanGaps=$t(t.spanGaps,r.spanGaps);n.tension=$t(t.lineTension,r.elements.line.tension);return n},updateBezierControlPoints:function(){var e=this;var t=e.getMeta();var r=e.chart.chartArea;var n=t.data||[];var i,a,o,s;if(t.dataset._model.spanGaps){n=n.filter(function(e){return!e._model.skip})}function l(e,t,r){return Math.max(Math.min(e,r),t)}for(i=0,a=n.length;i<a;++i){o=n[i]._model;s=ke.splineCurve(ke.previousItem(n,i,true)._model,o,ke.nextItem(n,i,true)._model,o.tension);o.controlPointPreviousX=l(s.previous.x,r.left,r.right);o.controlPointPreviousY=l(s.previous.y,r.top,r.bottom);o.controlPointNextX=l(s.next.x,r.left,r.right);o.controlPointNextY=l(s.next.y,r.top,r.bottom)}},setHoverStyle:function(e){var t=e._model;var r=e._options;var n=ke.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius};t.backgroundColor=$t(r.hoverBackgroundColor,n(r.backgroundColor));t.borderColor=$t(r.hoverBorderColor,n(r.borderColor));t.borderWidth=$t(r.hoverBorderWidth,r.borderWidth);t.radius=$t(r.hoverRadius,r.radius)}});de._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(e){return"("+e.xLabel+", "+e.yLabel+")"}}}});de._set("global",{datasets:{scatter:{showLine:false}}});var Ut=Pt;var jt={bar:wt,bubble:Et,doughnut:Dt,horizontalBar:Rt,line:Pt,polarArea:Bt,pie:Ht,radar:Wt,scatter:Ut};function Vt(e,t){if(e.native){return{x:e.x,y:e.y}}return ke.getRelativePosition(e,t)}function zt(e,t){var r=e._getSortedVisibleDatasetMetas();var n,i,a,o,s,l;for(i=0,o=r.length;i<o;++i){n=r[i].data;for(a=0,s=n.length;a<s;++a){l=n[a];if(!l._view.skip){t(l)}}}}function qt(e,t){var r=[];zt(e,function(e){if(e.inRange(t.x,t.y)){r.push(e)}});return r}function Yt(e,n,i,a){var o=Number.POSITIVE_INFINITY;var s=[];zt(e,function(e){if(i&&!e.inRange(n.x,n.y)){return}var t=e.getCenterPoint();var r=a(n,t);if(r<o){s=[e];o=r}else if(r===o){s.push(e)}});return s}function Gt(e){var i=e.indexOf("x")!==-1;var a=e.indexOf("y")!==-1;return function(e,t){var r=i?Math.abs(e.x-t.x):0;var n=a?Math.abs(e.y-t.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(n,2))}}function Xt(e,t,r){var n=Vt(t,e);r.axis=r.axis||"x";var i=Gt(r.axis);var a=r.intersect?qt(e,n):Yt(e,n,false,i);var o=[];if(!a.length){return[]}e._getSortedVisibleDatasetMetas().forEach(function(e){var t=e.data[a[0]._index];if(t&&!t._view.skip){o.push(t)}});return o}var Kt={modes:{single:function(e,t){var r=Vt(t,e);var n=[];zt(e,function(e){if(e.inRange(r.x,r.y)){n.push(e);return n}});return n.slice(0,1)},label:Xt,index:Xt,dataset:function(e,t,r){var n=Vt(t,e);r.axis=r.axis||"xy";var i=Gt(r.axis);var a=r.intersect?qt(e,n):Yt(e,n,false,i);if(a.length>0){a=e.getDatasetMeta(a[0]._datasetIndex).data}return a},"x-axis":function(e,t){return Xt(e,t,{intersect:false})},point:function(e,t){var r=Vt(t,e);return qt(e,r)},nearest:function(e,t,r){var n=Vt(t,e);r.axis=r.axis||"xy";var i=Gt(r.axis);return Yt(e,n,r.intersect,i)},x:function(e,t,r){var n=Vt(t,e);var i=[];var a=false;zt(e,function(e){if(e.inXRange(n.x)){i.push(e)}if(e.inRange(n.x,n.y)){a=true}});if(r.intersect&&!a){i=[]}return i},y:function(e,t,r){var n=Vt(t,e);var i=[];var a=false;zt(e,function(e){if(e.inYRange(n.y)){i.push(e)}if(e.inRange(n.x,n.y)){a=true}});if(r.intersect&&!a){i=[]}return i}}};var Jt=ke.extend;function Qt(e,t){return ke.where(e,function(e){return e.pos===t})}function Zt(e,i){return e.sort(function(e,t){var r=i?t:e;var n=i?e:t;return r.weight===n.weight?r.index-n.index:r.weight-n.weight})}function er(e){var t=[];var r,n,i;for(r=0,n=(e||[]).length;r<n;++r){i=e[r];t.push({index:r,box:i,pos:i.position,horizontal:i.isHorizontal(),weight:i.weight})}return t}function tr(e,t){var r,n,i;for(r=0,n=e.length;r<n;++r){i=e[r];i.width=i.horizontal?i.box.fullWidth&&t.availableWidth:t.vBoxMaxWidth;i.height=i.horizontal&&t.hBoxMaxHeight}}function rr(e){var t=er(e);var r=Zt(Qt(t,"left"),true);var n=Zt(Qt(t,"right"));var i=Zt(Qt(t,"top"),true);var a=Zt(Qt(t,"bottom"));return{leftAndTop:r.concat(i),rightAndBottom:n.concat(a),chartArea:Qt(t,"chartArea"),vertical:r.concat(n),horizontal:i.concat(a)}}function nr(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function ir(e,t,r){var n=r.box;var i=e.maxPadding;var a,o;if(r.size){e[r.pos]-=r.size}r.size=r.horizontal?n.height:n.width;e[r.pos]+=r.size;if(n.getPadding){var s=n.getPadding();i.top=Math.max(i.top,s.top);i.left=Math.max(i.left,s.left);i.bottom=Math.max(i.bottom,s.bottom);i.right=Math.max(i.right,s.right)}a=t.outerWidth-nr(i,e,"left","right");o=t.outerHeight-nr(i,e,"top","bottom");if(a!==e.w||o!==e.h){e.w=a;e.h=o;return r.horizontal?a!==e.w:o!==e.h}}function ar(r){var n=r.maxPadding;function e(e){var t=Math.max(n[e]-r[e],0);r[e]+=t;return t}r.y+=e("top");r.x+=e("left");e("right");e("bottom")}function or(e,r){var n=r.maxPadding;function t(e){var t={left:0,top:0,right:0,bottom:0};e.forEach(function(e){t[e]=Math.max(r[e],n[e])});return t}return e?t(["left","right"]):t(["top","bottom"])}function sr(e,t,r){var n=[];var i,a,o,s,l,u;for(i=0,a=e.length;i<a;++i){o=e[i];s=o.box;s.update(o.width||t.w,o.height||t.h,or(o.horizontal,t));if(ir(t,r,o)){u=true;if(n.length){l=true}}if(!s.fullWidth){n.push(o)}}return l?sr(n,t,r)||u:u}function lr(e,t,r){var n=r.padding;var i=t.x;var a=t.y;var o,s,l,u;for(o=0,s=e.length;o<s;++o){l=e[o];u=l.box;if(l.horizontal){u.left=u.fullWidth?n.left:t.left;u.right=u.fullWidth?r.outerWidth-n.right:t.left+t.w;u.top=a;u.bottom=a+u.height;u.width=u.right-u.left;a=u.bottom}else{u.left=i;u.right=i+u.width;u.top=t.top;u.bottom=t.top+t.h;u.height=u.bottom-u.top;i=u.right}}t.x=i;t.y=a}de._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var ur={defaults:{},addBox:function(e,t){if(!e.boxes){e.boxes=[]}t.fullWidth=t.fullWidth||false;t.position=t.position||"top";t.weight=t.weight||0;t._layers=t._layers||function(){return[{z:0,draw:function(){t.draw.apply(t,arguments)}}]};e.boxes.push(t)},removeBox:function(e,t){var r=e.boxes?e.boxes.indexOf(t):-1;if(r!==-1){e.boxes.splice(r,1)}},configure:function(e,t,r){var n=["fullWidth","position","weight"];var i=n.length;var a=0;var o;for(;a<i;++a){o=n[a];if(r.hasOwnProperty(o)){t[o]=r[o]}}},update:function(r,e,t){if(!r){return}var n=r.options.layout||{};var i=ke.options.toPadding(n.padding);var a=e-i.width;var o=t-i.height;var s=rr(r.boxes);var l=s.vertical;var u=s.horizontal;var f=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:a,vBoxMaxWidth:a/2/l.length,hBoxMaxHeight:o/2});var c=Jt({maxPadding:Jt({},i),w:a,h:o,x:i.left,y:i.top},i);tr(l.concat(u),f);sr(l,c,f);if(sr(u,c,f)){sr(l,c,f)}ar(c);lr(s.leftAndTop,c,f);c.x+=c.w;c.y+=c.h;lr(s.rightAndBottom,c,f);r.chartArea={left:c.left,top:c.top,right:c.left+c.w,bottom:c.top+c.h};ke.each(s.chartArea,function(e){var t=e.box;Jt(t,r.chartArea);t.update(c.w,c.h)})}};var fr={acquireContext:function(e){if(e&&e.canvas){e=e.canvas}return e&&e.getContext("2d")||null}};var cr="/*\n * DOM element rendering detection\n * https://davidwalsh.name/detect-node-insertion\n */\n@keyframes chartjs-render-animation {\n\tfrom { opacity: 0.99; }\n\tto { opacity: 1; }\n}\n\n.chartjs-render-monitor {\n\tanimation: chartjs-render-animation 0.001s;\n}\n\n/*\n * DOM element resizing detection\n * https://github.com/marcj/css-element-queries\n */\n.chartjs-size-monitor,\n.chartjs-size-monitor-expand,\n.chartjs-size-monitor-shrink {\n\tposition: absolute;\n\tdirection: ltr;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\tpointer-events: none;\n\tvisibility: hidden;\n\tz-index: -1;\n}\n\n.chartjs-size-monitor-expand > div {\n\tposition: absolute;\n\twidth: 1000000px;\n\theight: 1000000px;\n\tleft: 0;\n\ttop: 0;\n}\n\n.chartjs-size-monitor-shrink > div {\n\tposition: absolute;\n\twidth: 200%;\n\theight: 200%;\n\tleft: 0;\n\ttop: 0;\n}\n";var dr=Object.freeze({__proto__:null,default:cr});var hr=r(dr);var vr="$chartjs";var pr="chartjs-";var gr=pr+"size-monitor";var mr=pr+"render-monitor";var yr=pr+"render-animation";var br=["animationstart","webkitAnimationStart"];var wr={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function Cr(e,t){var r=ke.getStyle(e,t);var n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):undefined}function Sr(e,t){var r=e.style;var n=e.getAttribute("height");var i=e.getAttribute("width");e[vr]={initial:{height:n,width:i,style:{display:r.display,height:r.height,width:r.width}}};r.display=r.display||"block";if(i===null||i===""){var a=Cr(e,"width");if(a!==undefined){e.width=a}}if(n===null||n===""){if(e.style.height===""){e.height=e.width/(t.options.aspectRatio||2)}else{var o=Cr(e,"height");if(a!==undefined){e.height=o}}}return e}var Er=function(){var e=false;try{var t=Object.defineProperty({},"passive",{get:function(){e=true}});window.addEventListener("e",null,t)}catch(e){}return e}();var kr=Er?{passive:true}:false;function Tr(e,t,r){e.addEventListener(t,r,kr)}function _r(e,t,r){e.removeEventListener(t,r,kr)}function xr(e,t,r,n,i){return{type:e,chart:t,native:i||null,x:r!==undefined?r:null,y:n!==undefined?n:null}}function Dr(e,t){var r=wr[e.type]||e.type;var n=ke.getRelativePosition(e,t);return xr(r,t,n.x,n.y,e)}function Rr(e,t){var r=false;var n=[];return function(){n=Array.prototype.slice.call(arguments);t=t||this;if(!r){r=true;ke.requestAnimFrame.call(window,function(){r=false;e.apply(t,n)})}}}function Ir(e){var t=document.createElement("div");t.className=e||"";return t}function Or(e){var t=1e6;var r=Ir(gr);var n=Ir(gr+"-expand");var i=Ir(gr+"-shrink");n.appendChild(Ir());i.appendChild(Ir());r.appendChild(n);r.appendChild(i);r._reset=function(){n.scrollLeft=t;n.scrollTop=t;i.scrollLeft=t;i.scrollTop=t};var a=function(){r._reset();e()};Tr(n,"scroll",a.bind(n,"expand"));Tr(i,"scroll",a.bind(i,"shrink"));return r}function Ar(t,r){var e=t[vr]||(t[vr]={});var n=e.renderProxy=function(e){if(e.animationName===yr){r()}};ke.each(br,function(e){Tr(t,e,n)});e.reflow=!!t.offsetParent;t.classList.add(mr)}function Nr(t){var e=t[vr]||{};var r=e.renderProxy;if(r){ke.each(br,function(e){_r(t,e,r)});delete e.renderProxy}t.classList.remove(mr)}function Mr(r,n,i){var a=r[vr]||(r[vr]={});var t=a.resizer=Or(Rr(function(){if(a.resizer){var e=i.options.maintainAspectRatio&&r.parentNode;var t=e?e.clientWidth:0;n(xr("resize",i));if(e&&e.clientWidth<t&&i.canvas){n(xr("resize",i))}}}));Ar(r,function(){if(a.resizer){var e=r.parentNode;if(e&&e!==t.parentNode){e.insertBefore(t,e.firstChild)}t._reset()}})}function Lr(e){var t=e[vr]||{};var r=t.resizer;delete t.resizer;Nr(e);if(r&&r.parentNode){r.parentNode.removeChild(r)}}function Pr(e,t){var r=e[vr]||(e[vr]={});if(!r.containsStyles){r.containsStyles=true;t="/* Chart.js */\n"+t;var n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(t));e.appendChild(n)}}var Fr={disableCSSInjection:false,_enabled:typeof window!=="undefined"&&typeof document!=="undefined",_ensureLoaded:function(e){if(!this.disableCSSInjection){var t=e.getRootNode?e.getRootNode():document;var r=t.host?t:document.head;Pr(r,hr)}},acquireContext:function(e,t){if(typeof e==="string"){e=document.getElementById(e)}else if(e.length){e=e[0]}if(e&&e.canvas){e=e.canvas}var r=e&&e.getContext&&e.getContext("2d");if(r&&r.canvas===e){this._ensureLoaded(e);Sr(e,t);return r}return null},releaseContext:function(e){var r=e.canvas;if(!r[vr]){return}var n=r[vr].initial;["height","width"].forEach(function(e){var t=n[e];if(ke.isNullOrUndef(t)){r.removeAttribute(e)}else{r.setAttribute(e,t)}});ke.each(n.style||{},function(e,t){r.style[t]=e});r.width=r.width;delete r[vr]},addEventListener:function(t,e,r){var n=t.canvas;if(e==="resize"){Mr(n,r,t);return}var i=r[vr]||(r[vr]={});var a=i.proxies||(i.proxies={});var o=a[t.id+"_"+e]=function(e){r(Dr(e,t))};Tr(n,e,o)},removeEventListener:function(e,t,r){var n=e.canvas;if(t==="resize"){Lr(n);return}var i=r[vr]||{};var a=i.proxies||{};var o=a[e.id+"_"+t];if(!o){return}_r(n,t,o)}};ke.addEvent=Tr;ke.removeEvent=_r;var Br=Fr._enabled?Fr:fr;var Hr=ke.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},Br);de._set("global",{plugins:{}});var $r={_plugins:[],_cacheId:0,register:function(e){var t=this._plugins;[].concat(e).forEach(function(e){if(t.indexOf(e)===-1){t.push(e)}});this._cacheId++},unregister:function(e){var r=this._plugins;[].concat(e).forEach(function(e){var t=r.indexOf(e);if(t!==-1){r.splice(t,1)}});this._cacheId++},clear:function(){this._plugins=[];this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(e,t,r){var n=this.descriptors(e);var i=n.length;var a,o,s,l,u;for(a=0;a<i;++a){o=n[a];s=o.plugin;u=s[t];if(typeof u==="function"){l=[e].concat(r||[]);l.push(o.options);if(u.apply(s,l)===false){return false}}}return true},descriptors:function(e){var t=e.$plugins||(e.$plugins={});if(t.id===this._cacheId){return t.descriptors}var i=[];var a=[];var r=e&&e.config||{};var o=r.options&&r.options.plugins||{};this._plugins.concat(r.plugins||[]).forEach(function(e){var t=i.indexOf(e);if(t!==-1){return}var r=e.id;var n=o[r];if(n===false){return}if(n===true){n=ke.clone(de.global.plugins[r])}i.push(e);a.push({plugin:e,options:n||{}})});t.descriptors=a;t.id=this._cacheId;return a},_invalidate:function(e){delete e.$plugins}};var Wr={constructors:{},defaults:{},registerScaleType:function(e,t,r){this.constructors[e]=t;this.defaults[e]=ke.clone(r)},getScaleConstructor:function(e){return this.constructors.hasOwnProperty(e)?this.constructors[e]:undefined},getScaleDefaults:function(e){return this.defaults.hasOwnProperty(e)?ke.merge({},[de.scale,this.defaults[e]]):{}},updateScaleDefaults:function(e,t){var r=this;if(r.defaults.hasOwnProperty(e)){r.defaults[e]=ke.extend(r.defaults[e],t)}},addScalesToLayout:function(t){ke.each(t.scales,function(e){e.fullWidth=e.options.fullWidth;e.position=e.options.position;e.weight=e.options.weight;ur.addBox(t,e)})}};var Ur=ke.valueOrDefault;var jr=ke.rtl.getRtlAdapter;de._set("global",{tooltips:{enabled:true,custom:null,mode:"nearest",position:"average",intersect:true,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:true,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:ke.noop,title:function(e,t){var r="";var n=t.labels;var i=n?n.length:0;if(e.length>0){var a=e[0];if(a.label){r=a.label}else if(a.xLabel){r=a.xLabel}else if(i>0&&a.index<i){r=n[a.index]}}return r},afterTitle:ke.noop,beforeBody:ke.noop,beforeLabel:ke.noop,label:function(e,t){var r=t.datasets[e.datasetIndex].label||"";if(r){r+=": "}if(!ke.isNullOrUndef(e.value)){r+=e.value}else{r+=e.yLabel}return r},labelColor:function(e,t){var r=t.getDatasetMeta(e.datasetIndex);var n=r.data[e.index];var i=n._view;return{borderColor:i.borderColor,backgroundColor:i.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:ke.noop,afterBody:ke.noop,beforeFooter:ke.noop,footer:ke.noop,afterFooter:ke.noop}}});var Vr={average:function(e){if(!e.length){return false}var t,r;var n=0;var i=0;var a=0;for(t=0,r=e.length;t<r;++t){var o=e[t];if(o&&o.hasValue()){var s=o.tooltipPosition();n+=s.x;i+=s.y;++a}}return{x:n/a,y:i/a}},nearest:function(e,t){var r=t.x;var n=t.y;var i=Number.POSITIVE_INFINITY;var a,o,s;for(a=0,o=e.length;a<o;++a){var l=e[a];if(l&&l.hasValue()){var u=l.getCenterPoint();var f=ke.distanceBetweenPoints(t,u);if(f<i){i=f;s=l}}}if(s){var c=s.tooltipPosition();r=c.x;n=c.y}return{x:r,y:n}}};function zr(e,t){if(t){if(ke.isArray(t)){Array.prototype.push.apply(e,t)}else{e.push(t)}}return e}function qr(e){if((typeof e==="string"||e instanceof String)&&e.indexOf("\n")>-1){return e.split("\n")}return e}function Yr(e){var t=e._xScale;var r=e._yScale||e._scale;var n=e._index;var i=e._datasetIndex;var a=e._chart.getDatasetMeta(i).controller;var o=a._getIndexScale();var s=a._getValueScale();return{xLabel:t?t.getLabelForIndex(n,i):"",yLabel:r?r.getLabelForIndex(n,i):"",label:o?""+o.getLabelForIndex(n,i):"",value:s?""+s.getLabelForIndex(n,i):"",index:n,datasetIndex:i,x:e._model.x,y:e._model.y}}function Gr(e){var t=de.global;return{xPadding:e.xPadding,yPadding:e.yPadding,xAlign:e.xAlign,yAlign:e.yAlign,rtl:e.rtl,textDirection:e.textDirection,bodyFontColor:e.bodyFontColor,_bodyFontFamily:Ur(e.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:Ur(e.bodyFontStyle,t.defaultFontStyle),_bodyAlign:e.bodyAlign,bodyFontSize:Ur(e.bodyFontSize,t.defaultFontSize),bodySpacing:e.bodySpacing,titleFontColor:e.titleFontColor,_titleFontFamily:Ur(e.titleFontFamily,t.defaultFontFamily),_titleFontStyle:Ur(e.titleFontStyle,t.defaultFontStyle),titleFontSize:Ur(e.titleFontSize,t.defaultFontSize),_titleAlign:e.titleAlign,titleSpacing:e.titleSpacing,titleMarginBottom:e.titleMarginBottom,footerFontColor:e.footerFontColor,_footerFontFamily:Ur(e.footerFontFamily,t.defaultFontFamily),_footerFontStyle:Ur(e.footerFontStyle,t.defaultFontStyle),footerFontSize:Ur(e.footerFontSize,t.defaultFontSize),_footerAlign:e.footerAlign,footerSpacing:e.footerSpacing,footerMarginTop:e.footerMarginTop,caretSize:e.caretSize,cornerRadius:e.cornerRadius,backgroundColor:e.backgroundColor,opacity:0,legendColorBackground:e.multiKeyBackground,displayColors:e.displayColors,borderColor:e.borderColor,borderWidth:e.borderWidth}}function Xr(e,t){var r=e._chart.ctx;var n=t.yPadding*2;var i=0;var a=t.body;var o=a.reduce(function(e,t){return e+t.before.length+t.lines.length+t.after.length},0);o+=t.beforeBody.length+t.afterBody.length;var s=t.title.length;var l=t.footer.length;var u=t.titleFontSize;var f=t.bodyFontSize;var c=t.footerFontSize;n+=s*u;n+=s?(s-1)*t.titleSpacing:0;n+=s?t.titleMarginBottom:0;n+=o*f;n+=o?(o-1)*t.bodySpacing:0;n+=l?t.footerMarginTop:0;n+=l*c;n+=l?(l-1)*t.footerSpacing:0;var d=0;var h=function(e){i=Math.max(i,r.measureText(e).width+d)};r.font=ke.fontString(u,t._titleFontStyle,t._titleFontFamily);ke.each(t.title,h);r.font=ke.fontString(f,t._bodyFontStyle,t._bodyFontFamily);ke.each(t.beforeBody.concat(t.afterBody),h);d=t.displayColors?f+2:0;ke.each(a,function(e){ke.each(e.before,h);ke.each(e.lines,h);ke.each(e.after,h)});d=0;r.font=ke.fontString(c,t._footerFontStyle,t._footerFontFamily);ke.each(t.footer,h);i+=2*t.xPadding;return{width:i,height:n}}function Kr(e,t){var r=e._model;var n=e._chart;var i=e._chart.chartArea;var a="center";var o="center";if(r.y<t.height){o="top"}else if(r.y>n.height-t.height){o="bottom"}var s,l;var u,f;var c;var d=(i.left+i.right)/2;var h=(i.top+i.bottom)/2;if(o==="center"){s=function(e){return e<=d};l=function(e){return e>d}}else{s=function(e){return e<=t.width/2};l=function(e){return e>=n.width-t.width/2}}u=function(e){return e+t.width+r.caretSize+r.caretPadding>n.width};f=function(e){return e-t.width-r.caretSize-r.caretPadding<0};c=function(e){return e<=h?"top":"bottom"};if(s(r.x)){a="left";if(u(r.x)){a="center";o=c(r.y)}}else if(l(r.x)){a="right";if(f(r.x)){a="center";o=c(r.y)}}var v=e._options;return{xAlign:v.xAlign?v.xAlign:a,yAlign:v.yAlign?v.yAlign:o}}function Jr(e,t,r,n){var i=e.x;var a=e.y;var o=e.caretSize;var s=e.caretPadding;var l=e.cornerRadius;var u=r.xAlign;var f=r.yAlign;var c=o+s;var d=l+s;if(u==="right"){i-=t.width}else if(u==="center"){i-=t.width/2;if(i+t.width>n.width){i=n.width-t.width}if(i<0){i=0}}if(f==="top"){a+=c}else if(f==="bottom"){a-=t.height+c}else{a-=t.height/2}if(f==="center"){if(u==="left"){i+=c}else if(u==="right"){i-=c}}else if(u==="left"){i-=d}else if(u==="right"){i+=d}return{x:i,y:a}}function Qr(e,t){return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-e.xPadding:e.x+e.xPadding}function Zr(e){return zr([],qr(e))}var en=Ae.extend({initialize:function(){this._model=Gr(this._options);this._lastActive=[]},getTitle:function(){var e=this;var t=e._options;var r=t.callbacks;var n=r.beforeTitle.apply(e,arguments);var i=r.title.apply(e,arguments);var a=r.afterTitle.apply(e,arguments);var o=[];o=zr(o,qr(n));o=zr(o,qr(i));o=zr(o,qr(a));return o},getBeforeBody:function(){return Zr(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(e,r){var n=this;var i=n._options.callbacks;var a=[];ke.each(e,function(e){var t={before:[],lines:[],after:[]};zr(t.before,qr(i.beforeLabel.call(n,e,r)));zr(t.lines,i.label.call(n,e,r));zr(t.after,qr(i.afterLabel.call(n,e,r)));a.push(t)});return a},getAfterBody:function(){return Zr(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var e=this;var t=e._options.callbacks;var r=t.beforeFooter.apply(e,arguments);var n=t.footer.apply(e,arguments);var i=t.afterFooter.apply(e,arguments);var a=[];a=zr(a,qr(r));a=zr(a,qr(n));a=zr(a,qr(i));return a},update:function(e){var t=this;var r=t._options;var n=t._model;var i=t._model=Gr(r);var a=t._active;var o=t._data;var s={xAlign:n.xAlign,yAlign:n.yAlign};var l={x:n.x,y:n.y};var u={width:n.width,height:n.height};var f={x:n.caretX,y:n.caretY};var c,d;if(a.length){i.opacity=1;var h=[];var v=[];f=Vr[r.position].call(t,a,t._eventPosition);var p=[];for(c=0,d=a.length;c<d;++c){p.push(Yr(a[c]))}if(r.filter){p=p.filter(function(e){return r.filter(e,o)})}if(r.itemSort){p=p.sort(function(e,t){return r.itemSort(e,t,o)})}ke.each(p,function(e){h.push(r.callbacks.labelColor.call(t,e,t._chart));v.push(r.callbacks.labelTextColor.call(t,e,t._chart))});i.title=t.getTitle(p,o);i.beforeBody=t.getBeforeBody(p,o);i.body=t.getBody(p,o);i.afterBody=t.getAfterBody(p,o);i.footer=t.getFooter(p,o);i.x=f.x;i.y=f.y;i.caretPadding=r.caretPadding;i.labelColors=h;i.labelTextColors=v;i.dataPoints=p;u=Xr(this,i);s=Kr(this,u);l=Jr(i,u,s,t._chart)}else{i.opacity=0}i.xAlign=s.xAlign;i.yAlign=s.yAlign;i.x=l.x;i.y=l.y;i.width=u.width;i.height=u.height;i.caretX=f.x;i.caretY=f.y;t._model=i;if(e&&r.custom){r.custom.call(t,i)}return t},drawCaret:function(e,t){var r=this._chart.ctx;var n=this._view;var i=this.getCaretPosition(e,t,n);r.lineTo(i.x1,i.y1);r.lineTo(i.x2,i.y2);r.lineTo(i.x3,i.y3)},getCaretPosition:function(e,t,r){var n,i,a,o,s,l;var u=r.caretSize;var f=r.cornerRadius;var c=r.xAlign;var d=r.yAlign;var h=e.x;var v=e.y;var p=t.width;var g=t.height;if(d==="center"){s=v+g/2;if(c==="left"){n=h;i=n-u;a=n;o=s+u;l=s-u}else{n=h+p;i=n+u;a=n;o=s-u;l=s+u}}else{if(c==="left"){i=h+f+u;n=i-u;a=i+u}else if(c==="right"){i=h+p-f-u;n=i-u;a=i+u}else{i=r.caretX;n=i-u;a=i+u}if(d==="top"){o=v;s=o-u;l=o}else{o=v+g;s=o+u;l=o;var m=a;a=n;n=m}}return{x1:n,x2:i,x3:a,y1:o,y2:s,y3:l}},drawTitle:function(e,t,r){var n=t.title;var i=n.length;var a,o,s;if(i){var l=jr(t.rtl,t.x,t.width);e.x=Qr(t,t._titleAlign);r.textAlign=l.textAlign(t._titleAlign);r.textBaseline="middle";a=t.titleFontSize;o=t.titleSpacing;r.fillStyle=t.titleFontColor;r.font=ke.fontString(a,t._titleFontStyle,t._titleFontFamily);for(s=0;s<i;++s){r.fillText(n[s],l.x(e.x),e.y+a/2);e.y+=a+o;if(s+1===i){e.y+=t.titleMarginBottom-o}}}},drawBody:function(t,e,r){var n=e.bodyFontSize;var i=e.bodySpacing;var a=e._bodyAlign;var o=e.body;var s=e.displayColors;var l=0;var u=s?Qr(e,"left"):0;var f=jr(e.rtl,e.x,e.width);var c=function(e){r.fillText(e,f.x(t.x+l),t.y+n/2);t.y+=n+i};var d,h,v,p,g,m,y,b;var w=f.textAlign(a);r.textAlign=a;r.textBaseline="middle";r.font=ke.fontString(n,e._bodyFontStyle,e._bodyFontFamily);t.x=Qr(e,w);r.fillStyle=e.bodyFontColor;ke.each(e.beforeBody,c);l=s&&w!=="right"?a==="center"?n/2+1:n+2:0;for(g=0,y=o.length;g<y;++g){d=o[g];h=e.labelTextColors[g];v=e.labelColors[g];r.fillStyle=h;ke.each(d.before,c);p=d.lines;for(m=0,b=p.length;m<b;++m){if(s){var C=f.x(u);r.fillStyle=e.legendColorBackground;r.fillRect(f.leftForLtr(C,n),t.y,n,n);r.lineWidth=1;r.strokeStyle=v.borderColor;r.strokeRect(f.leftForLtr(C,n),t.y,n,n);r.fillStyle=v.backgroundColor;r.fillRect(f.leftForLtr(f.xPlus(C,1),n-2),t.y+1,n-2,n-2);r.fillStyle=h}c(p[m])}ke.each(d.after,c)}l=0;ke.each(e.afterBody,c);t.y-=i},drawFooter:function(e,t,r){var n=t.footer;var i=n.length;var a,o;if(i){var s=jr(t.rtl,t.x,t.width);e.x=Qr(t,t._footerAlign);e.y+=t.footerMarginTop;r.textAlign=s.textAlign(t._footerAlign);r.textBaseline="middle";a=t.footerFontSize;r.fillStyle=t.footerFontColor;r.font=ke.fontString(a,t._footerFontStyle,t._footerFontFamily);for(o=0;o<i;++o){r.fillText(n[o],s.x(e.x),e.y+a/2);e.y+=a+t.footerSpacing}}},drawBackground:function(e,t,r,n){r.fillStyle=t.backgroundColor;r.strokeStyle=t.borderColor;r.lineWidth=t.borderWidth;var i=t.xAlign;var a=t.yAlign;var o=e.x;var s=e.y;var l=n.width;var u=n.height;var f=t.cornerRadius;r.beginPath();r.moveTo(o+f,s);if(a==="top"){this.drawCaret(e,n)}r.lineTo(o+l-f,s);r.quadraticCurveTo(o+l,s,o+l,s+f);if(a==="center"&&i==="right"){this.drawCaret(e,n)}r.lineTo(o+l,s+u-f);r.quadraticCurveTo(o+l,s+u,o+l-f,s+u);if(a==="bottom"){this.drawCaret(e,n)}r.lineTo(o+f,s+u);r.quadraticCurveTo(o,s+u,o,s+u-f);if(a==="center"&&i==="left"){this.drawCaret(e,n)}r.lineTo(o,s+f);r.quadraticCurveTo(o,s,o+f,s);r.closePath();r.fill();if(t.borderWidth>0){r.stroke()}},draw:function(){var e=this._chart.ctx;var t=this._view;if(t.opacity===0){return}var r={width:t.width,height:t.height};var n={x:t.x,y:t.y};var i=Math.abs(t.opacity<.001)?0:t.opacity;var a=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;if(this._options.enabled&&a){e.save();e.globalAlpha=i;this.drawBackground(n,t,e,r);n.y+=t.yPadding;ke.rtl.overrideTextDirection(e,t.textDirection);this.drawTitle(n,t,e);this.drawBody(n,t,e);this.drawFooter(n,t,e);ke.rtl.restoreTextDirection(e,t.textDirection);e.restore()}},handleEvent:function(e){var t=this;var r=t._options;var n=false;t._lastActive=t._lastActive||[];if(e.type==="mouseout"){t._active=[]}else{t._active=t._chart.getElementsAtEventForMode(e,r.mode,r);if(r.reverse){t._active.reverse()}}n=!ke.arrayEquals(t._active,t._lastActive);if(n){t._lastActive=t._active;if(r.enabled||r.custom){t._eventPosition={x:e.x,y:e.y};t.update(true);t.pivot()}}return n}});var tn=Vr;var rn=en;rn.positioners=tn;var nn=ke.valueOrDefault;de._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:true,animationDuration:400},onClick:null,maintainAspectRatio:true,responsive:true,responsiveAnimationDuration:0});function an(){return ke.merge({},[].slice.call(arguments),{merger:function(e,t,r,n){if(e==="xAxes"||e==="yAxes"){var i=r[e].length;var a,o,s;if(!t[e]){t[e]=[]}for(a=0;a<i;++a){s=r[e][a];o=nn(s.type,e==="xAxes"?"category":"linear");if(a>=t[e].length){t[e].push({})}if(!t[e][a].type||s.type&&s.type!==t[e][a].type){ke.merge(t[e][a],[Wr.getScaleDefaults(o),s])}else{ke.merge(t[e][a],s)}}}else{ke._merger(e,t,r,n)}}})}function on(){return ke.merge({},[].slice.call(arguments),{merger:function(e,t,r,n){var i=t[e]||{};var a=r[e];if(e==="scales"){t[e]=an(i,a)}else if(e==="scale"){t[e]=ke.merge(i,[Wr.getScaleDefaults(a.type),a])}else{ke._merger(e,t,r,n)}}})}function sn(e){e=e||{};var t=e.data=e.data||{};t.datasets=t.datasets||[];t.labels=t.labels||[];e.options=on(de.global,de[e.type],e.options||{});return e}function ln(t){var e=t.options;ke.each(t.scales,function(e){ur.removeBox(t,e)});e=on(de.global,de[t.config.type],e);t.options=t.config.options=e;t.ensureScalesHaveIDs();t.buildOrUpdateScales();t.tooltip._options=e.tooltips;t.tooltip.initialize()}function un(e,t,r){var n;var i=function(e){return e.id===n};do{n=t+r++}while(ke.findIndex(e,i)>=0);return n}function fn(e){return e==="top"||e==="bottom"}function cn(r,n){return function(e,t){return e[r]===t[r]?e[n]-t[n]:e[r]-t[r]}}var dn=function(e,t){this.construct(e,t);return this};ke.extend(dn.prototype,{construct:function(e,t){var r=this;t=sn(t);var n=Hr.acquireContext(e,t);var i=n&&n.canvas;var a=i&&i.height;var o=i&&i.width;r.id=ke.uid();r.ctx=n;r.canvas=i;r.config=t;r.width=o;r.height=a;r.aspectRatio=a?o/a:null;r.options=t.options;r._bufferedRender=false;r._layers=[];r.chart=r;r.controller=r;dn.instances[r.id]=r;Object.defineProperty(r,"data",{get:function(){return r.config.data},set:function(e){r.config.data=e}});if(!n||!i){console.error("Failed to create chart: can't acquire context from the given item");return}r.initialize();r.update()},initialize:function(){var e=this;$r.notify(e,"beforeInit");ke.retinaScale(e,e.options.devicePixelRatio);e.bindEvents();if(e.options.responsive){e.resize(true)}e.initToolTip();$r.notify(e,"afterInit");return e},clear:function(){ke.canvas.clear(this);return this},stop:function(){Le.cancelAnimation(this);return this},resize:function(e){var t=this;var r=t.options;var n=t.canvas;var i=r.maintainAspectRatio&&t.aspectRatio||null;var a=Math.max(0,Math.floor(ke.getMaximumWidth(n)));var o=Math.max(0,Math.floor(i?a/i:ke.getMaximumHeight(n)));if(t.width===a&&t.height===o){return}n.width=t.width=a;n.height=t.height=o;n.style.width=a+"px";n.style.height=o+"px";ke.retinaScale(t,r.devicePixelRatio);if(!e){var s={width:a,height:o};$r.notify(t,"resize",[s]);if(r.onResize){r.onResize(t,s)}t.stop();t.update({duration:r.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var e=this.options;var r=e.scales||{};var t=e.scale;ke.each(r.xAxes,function(e,t){if(!e.id){e.id=un(r.xAxes,"x-axis-",t)}});ke.each(r.yAxes,function(e,t){if(!e.id){e.id=un(r.yAxes,"y-axis-",t)}});if(t){t.id=t.id||"scale"}},buildOrUpdateScales:function(){var o=this;var e=o.options;var s=o.scales||{};var t=[];var l=Object.keys(s).reduce(function(e,t){e[t]=false;return e},{});if(e.scales){t=t.concat((e.scales.xAxes||[]).map(function(e){return{options:e,dtype:"category",dposition:"bottom"}}),(e.scales.yAxes||[]).map(function(e){return{options:e,dtype:"linear",dposition:"left"}}))}if(e.scale){t.push({options:e.scale,dtype:"radialLinear",isDefault:true,dposition:"chartArea"})}ke.each(t,function(e){var t=e.options;var r=t.id;var n=nn(t.type,e.dtype);if(fn(t.position)!==fn(e.dposition)){t.position=e.dposition}l[r]=true;var i=null;if(r in s&&s[r].type===n){i=s[r];i.options=t;i.ctx=o.ctx;i.chart=o}else{var a=Wr.getScaleConstructor(n);if(!a){return}i=new a({id:r,type:n,options:t,ctx:o.ctx,chart:o});s[i.id]=i}i.mergeTicksOptions();if(e.isDefault){o.scale=i}});ke.each(l,function(e,t){if(!e){delete s[t]}});o.scales=s;Wr.addScalesToLayout(this)},buildOrUpdateControllers:function(){var e=this;var t=[];var r=e.data.datasets;var n,i;for(n=0,i=r.length;n<i;n++){var a=r[n];var o=e.getDatasetMeta(n);var s=a.type||e.config.type;if(o.type&&o.type!==s){e.destroyDatasetMeta(n);o=e.getDatasetMeta(n)}o.type=s;o.order=a.order||0;o.index=n;if(o.controller){o.controller.updateIndex(n);o.controller.linkScales()}else{var l=jt[o.type];if(l===undefined){throw new Error('"'+o.type+'" is not a chart type.')}o.controller=new l(e,n);t.push(o.controller)}}return t},resetElements:function(){var r=this;ke.each(r.data.datasets,function(e,t){r.getDatasetMeta(t).controller.reset()},r)},reset:function(){this.resetElements();this.tooltip.initialize()},update:function(e){var t=this;var r,n;if(!e||typeof e!=="object"){e={duration:e,lazy:arguments[1]}}ln(t);$r._invalidate(t);if(syn.$r.notify(t,"beforeUpdate")===false){return}t.tooltip._data=t.data;var i=t.buildOrUpdateControllers();for(r=0,n=t.data.datasets.length;r<n;r++){t.getDatasetMeta(r).controller.buildOrUpdateElements()}t.updateLayout();if(t.options.animation&&t.options.animation.duration){ke.each(i,function(e){e.reset()})}t.updateDatasets();t.tooltip.initialize();t.lastActive=[];$r.notify(t,"afterUpdate");t._layers.sort(cn("z","_idx"));if(t._bufferedRender){t._bufferedRequest={duration:e.duration,easing:e.easing,lazy:e.lazy}}else{t.render(e)}},updateLayout:function(){var t=this;if(syn.$r.notify(t,"beforeLayout")===false){return}ur.update(this,this.width,this.height);t._layers=[];ke.each(t.boxes,function(e){if(e._configure){e._configure()}t._layers.push.apply(t._layers,e._layers())},t);t._layers.forEach(function(e,t){e._idx=t});$r.notify(t,"afterScaleUpdate");$r.notify(t,"afterLayout")},updateDatasets:function(){var e=this;if(syn.$r.notify(e,"beforeDatasetsUpdate")===false){return}for(var t=0,r=e.data.datasets.length;t<r;++t){e.updateDataset(t)}$r.notify(e,"afterDatasetsUpdate")},updateDataset:function(e){var t=this;var r=t.getDatasetMeta(e);var n={meta:r,index:e};if(syn.$r.notify(t,"beforeDatasetUpdate",[n])===false){return}r.controller._update();$r.notify(t,"afterDatasetUpdate",[n])},render:function(e){var t=this;if(!e||typeof e!=="object"){e={duration:e,lazy:arguments[1]}}var r=t.options.animation;var n=nn(e.duration,r&&r.duration);var i=e.lazy;if(syn.$r.notify(t,"beforeRender")===false){return}var a=function(e){$r.notify(t,"afterRender");ke.callback(r&&r.onComplete,[e],t)};if(r&&n){var o=new Me({numSteps:n/16.66,easing:e.easing||r.easing,render:function(e,t){var r=ke.easing.effects[t.easing];var n=t.currentStep;var i=n/t.numSteps;e.draw(r(i),i,n)},onAnimationProgress:r.onProgress,onAnimationComplete:a});Le.addAnimation(t,o,n,i)}else{t.draw();a(new Me({numSteps:0,chart:t}))}return t},draw:function(e){var t=this;var r,n;t.clear();if(ke.isNullOrUndef(e)){e=1}t.transition(e);if(t.width<=0||t.height<=0){return}if(syn.$r.notify(t,"beforeDraw",[e])===false){return}n=t._layers;for(r=0;r<n.length&&n[r].z<=0;++r){n[r].draw(t.chartArea)}t.drawDatasets(e);for(;r<n.length;++r){n[r].draw(t.chartArea)}t._drawTooltip(e);$r.notify(t,"afterDraw",[e])},transition:function(e){var t=this;for(var r=0,n=(t.data.datasets||[]).length;r<n;++r){if(t.isDatasetVisible(r)){t.getDatasetMeta(r).controller.transition(e)}}t.tooltip.transition(e)},_getSortedDatasetMetas:function(e){var t=this;var r=t.data.datasets||[];var n=[];var i,a;for(i=0,a=r.length;i<a;++i){if(!e||t.isDatasetVisible(i)){n.push(t.getDatasetMeta(i))}}n.sort(cn("order","index"));return n},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(true)},drawDatasets:function(e){var t=this;var r,n;if(syn.$r.notify(t,"beforeDatasetsDraw",[e])===false){return}r=t._getSortedVisibleDatasetMetas();for(n=r.length-1;n>=0;--n){t.drawDataset(r[n],e)}$r.notify(t,"afterDatasetsDraw",[e])},drawDataset:function(e,t){var r=this;var n={meta:e,index:e.index,easingValue:t};if(syn.$r.notify(r,"beforeDatasetDraw",[n])===false){return}e.controller.draw(t);$r.notify(r,"afterDatasetDraw",[n])},_drawTooltip:function(e){var t=this;var r=t.tooltip;var n={tooltip:r,easingValue:e};if(syn.$r.notify(t,"beforeTooltipDraw",[n])===false){return}r.draw();$r.notify(t,"afterTooltipDraw",[n])},getElementAtEvent:function(e){return Kt.modes.single(this,e)},getElementsAtEvent:function(e){return Kt.modes.label(this,e,{intersect:true})},getElementsAtXAxis:function(e){return Kt.modes["x-axis"](this,e,{intersect:true})},getElementsAtEventForMode:function(e,t,r){var n=Kt.modes[t];if(typeof n==="function"){return n(this,e,r)}return[]},getDatasetAtEvent:function(e){return Kt.modes.dataset(this,e,{intersect:true})},getDatasetMeta:function(e){var t=this;var r=t.data.datasets[e];if(!r._meta){r._meta={}}var n=r._meta[t.id];if(!n){n=r._meta[t.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r.order||0,index:e}}return n},getVisibleDatasetCount:function(){var e=0;for(var t=0,r=this.data.datasets.length;t<r;++t){if(this.isDatasetVisible(t)){e++}}return e},isDatasetVisible:function(e){var t=this.getDatasetMeta(e);return typeof t.hidden==="boolean"?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(e){var t=this.id;var r=this.data.datasets[e];var n=r._meta&&r._meta[t];if(n){n.controller.destroy();delete r._meta[t]}},destroy:function(){var e=this;var t=e.canvas;var r,n;e.stop();for(r=0,n=e.data.datasets.length;r<n;++r){e.destroyDatasetMeta(r)}if(t){e.unbindEvents();ke.canvas.clear(e);Hr.releaseContext(e.ctx);e.canvas=null;e.ctx=null}$r.notify(e,"destroy");delete dn.instances[e.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var e=this;e.tooltip=new rn({_chart:e,_chartInstance:e,_data:e.data,_options:e.options.tooltips},e)},bindEvents:function(){var t=this;var r=t._listeners={};var n=function(){t.eventHandler.apply(t,arguments)};ke.each(t.options.events,function(e){Hr.addEventListener(t,e,n);r[e]=n});if(t.options.responsive){n=function(){t.resize()};Hr.addEventListener(t,"resize",n);r.resize=n}},unbindEvents:function(){var r=this;var e=r._listeners;if(!e){return}delete r._listeners;ke.each(e,function(e,t){Hr.removeEventListener(r,t,e)})},updateHoverStyle:function(e,t,r){var n=r?"set":"remove";var i,a,o;for(a=0,o=e.length;a<o;++a){i=e[a];if(i){this.getDatasetMeta(i._datasetIndex).controller[n+"HoverStyle"](i)}}if(t==="dataset"){this.getDatasetMeta(e[0]._datasetIndex).controller["_"+n+"DatasetHoverStyle"]()}},eventHandler:function(e){var t=this;var r=t.tooltip;if(syn.$r.notify(t,"beforeEvent",[e])===false){return}t._bufferedRender=true;t._bufferedRequest=null;var n=t.handleEvent(e);if(r){n=r._start?r.handleEvent(e):n|r.handleEvent(e)}$r.notify(t,"afterEvent",[e]);var i=t._bufferedRequest;if(i){t.render(i)}else if(n&&!t.animating){t.stop();t.render({duration:t.options.hover.animationDuration,lazy:true})}t._bufferedRender=false;t._bufferedRequest=null;return t},handleEvent:function(e){var t=this;var r=t.options||{};var n=r.hover;var i=false;t.lastActive=t.lastActive||[];if(e.type==="mouseout"){t.active=[]}else{t.active=t.getElementsAtEventForMode(e,n.mode,n)}ke.callback(r.onHover||r.hover.onHover,[e.native,t.active],t);if(e.type==="mouseup"||e.type==="click"){if(r.onClick){r.onClick.call(t,e.native,t.active)}}if(t.lastActive.length){t.updateHoverStyle(t.lastActive,n.mode,false)}if(t.active.length&&n.mode){t.updateHoverStyle(t.active,n.mode,true)}i=!ke.arrayEquals(t.active,t.lastActive);t.lastActive=t.active;return i}});dn.instances={};var hn=dn;dn.Controller=dn;dn.types={};ke.configMerge=on;ke.scaleMerge=an;var vn=function(){ke.where=function(e,t){if(ke.isArray(e)&&Array.prototype.filter){return e.filter(t)}var r=[];ke.each(e,function(e){if(t(e)){r.push(e)}});return r};ke.findIndex=Array.prototype.findIndex?function(e,t,r){return e.findIndex(t,r)}:function(e,t,r){r=r===undefined?e:r;for(var n=0,i=e.length;n<i;++n){if(t.call(r,e[n],n,e)){return n}}return-1};ke.findNextWhere=function(e,t,r){if(ke.isNullOrUndef(r)){r=-1}for(var n=r+1;n<e.length;n++){var i=e[n];if(t(i)){return i}}};ke.findPreviousWhere=function(e,t,r){if(ke.isNullOrUndef(r)){r=e.length}for(var n=r-1;n>=0;n--){var i=e[n];if(t(i)){return i}}};ke.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};ke.almostEquals=function(e,t,r){return Math.abs(e-t)<r};ke.almostWhole=function(e,t){var r=Math.round(e);return r-t<=e&&r+t>=e};ke.max=function(e){return e.reduce(function(e,t){if(!isNaN(t)){return Math.max(e,t)}return e},Number.NEGATIVE_INFINITY)};ke.min=function(e){return e.reduce(function(e,t){if(!isNaN(t)){return Math.min(e,t)}return e},Number.POSITIVE_INFINITY)};ke.sign=Math.sign?function(e){return Math.sign(e)}:function(e){e=+e;if(e===0||isNaN(e)){return e}return e>0?1:-1};ke.toRadians=function(e){return e*(Math.PI/180)};ke.toDegrees=function(e){return e*(180/Math.PI)};ke._decimalPlaces=function(e){if(!ke.isFinite(e)){return}var t=1;var r=0;while(Math.round(e*t)/t!==e){t*=10;r++}return r};ke.getAngleFromPoint=function(e,t){var r=t.x-e.x;var n=t.y-e.y;var i=Math.sqrt(r*r+n*n);var a=Math.atan2(n,r);if(a<-.5*Math.PI){a+=2*Math.PI}return{angle:a,distance:i}};ke.distanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))};ke.aliasPixel=function(e){return e%2===0?0:.5};ke._alignPixel=function(e,t,r){var n=e.currentDevicePixelRatio;var i=r/2;return Math.round((t-i)*n)/n+i};ke.splineCurve=function(e,t,r,n){var i=e.skip?t:e;var a=t;var o=r.skip?t:r;var s=Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2));var l=Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2));var u=s/(s+l);var f=l/(s+l);u=isNaN(u)?0:u;f=isNaN(f)?0:f;var c=n*u;var d=n*f;return{previous:{x:a.x-c*(o.x-i.x),y:a.y-c*(o.y-i.y)},next:{x:a.x+d*(o.x-i.x),y:a.y+d*(o.y-i.y)}}};ke.EPSILON=Number.EPSILON||1e-14;ke.splineCurveMonotone=function(e){var t=(e||[]).map(function(e){return{model:e._model,deltaK:0,mK:0}});var r=t.length;var n,i,a,o;for(n=0;n<r;++n){a=t[n];if(a.model.skip){continue}i=n>0?t[n-1]:null;o=n<r-1?t[n+1]:null;if(o&&!o.model.skip){var s=o.model.x-a.model.x;a.deltaK=s!==0?(o.model.y-a.model.y)/s:0}if(!i||i.model.skip){a.mK=a.deltaK}else if(!o||o.model.skip){a.mK=i.deltaK}else if(this.sign(i.deltaK)!==this.sign(a.deltaK)){a.mK=0}else{a.mK=(i.deltaK+a.deltaK)/2}}var l,u,f,c;for(n=0;n<r-1;++n){a=t[n];o=t[n+1];if(a.model.skip||o.model.skip){continue}if(ke.almostEquals(a.deltaK,0,this.EPSILON)){a.mK=o.mK=0;continue}l=a.mK/a.deltaK;u=o.mK/a.deltaK;c=Math.pow(l,2)+Math.pow(u,2);if(c<=9){continue}f=3/Math.sqrt(c);a.mK=l*f*a.deltaK;o.mK=u*f*a.deltaK}var d;for(n=0;n<r;++n){a=t[n];if(a.model.skip){continue}i=n>0?t[n-1]:null;o=n<r-1?t[n+1]:null;if(i&&!i.model.skip){d=(a.model.x-i.model.x)/3;a.model.controlPointPreviousX=a.model.x-d;a.model.controlPointPreviousY=a.model.y-d*a.mK}if(o&&!o.model.skip){d=(o.model.x-a.model.x)/3;a.model.controlPointNextX=a.model.x+d;a.model.controlPointNextY=a.model.y+d*a.mK}}};ke.nextItem=function(e,t,r){if(r){return t>=e.length-1?e[0]:e[t+1]}return t>=e.length-1?e[e.length-1]:e[t+1]};ke.previousItem=function(e,t,r){if(r){return t<=0?e[e.length-1]:e[t-1]}return t<=0?e[0]:e[t-1]};ke.niceNum=function(e,t){var r=Math.floor(ke.log10(e));var n=e/Math.pow(10,r);var i;if(t){if(n<1.5){i=1}else if(n<3){i=2}else if(n<7){i=5}else{i=10}}else if(n<=1){i=1}else if(n<=2){i=2}else if(n<=5){i=5}else{i=10}return i*Math.pow(10,r)};ke.requestAnimFrame=function(){if(typeof window==="undefined"){return function(e){e()}}return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}();ke.getRelativePosition=function(e,t){var r,n;var i=e.originalEvent||e;var a=e.target||e.srcElement;var o=a.getBoundingClientRect();var s=i.touches;if(s&&s.length>0){r=s[0].clientX;n=s[0].clientY}else{r=i.clientX;n=i.clientY}var l=parseFloat(ke.getStyle(a,"padding-left"));var u=parseFloat(ke.getStyle(a,"padding-top"));var f=parseFloat(ke.getStyle(a,"padding-right"));var c=parseFloat(ke.getStyle(a,"padding-bottom"));var d=o.right-o.left-l-f;var h=o.bottom-o.top-u-c;r=Math.round((r-o.left-l)/d*a.width/t.currentDevicePixelRatio);n=Math.round((n-o.top-u)/h*a.height/t.currentDevicePixelRatio);return{x:r,y:n}};function f(e,t,r){var n;if(typeof e==="string"){n=parseInt(e,10);if(e.indexOf("%")!==-1){n=n/100*t.parentNode[r]}}else{n=e}return n}function c(e){return e!==undefined&&e!==null&&e!=="none"}function t(e,t,r){var n=document.defaultView;var i=ke._getParentNode(e);var a=n.getComputedStyle(e)[t];var o=n.getComputedStyle(i)[t];var s=c(a);var l=c(o);var u=Number.POSITIVE_INFINITY;if(s||l){return Math.min(s?f(a,e,r):u,l?f(o,i,r):u)}return"none"}ke.getConstraintWidth=function(e){return t(e,"max-width","clientWidth")};ke.getConstraintHeight=function(e){return t(e,"max-height","clientHeight")};ke._calculatePadding=function(e,t,r){t=ke.getStyle(e,t);return t.indexOf("%")>-1?r*parseInt(t,10)/100:parseInt(t,10)};ke._getParentNode=function(e){var t=e.parentNode;if(t&&t.toString()==="[object ShadowRoot]"){t=t.host}return t};ke.getMaximumWidth=function(e){var t=ke._getParentNode(e);if(!t){return e.clientWidth}var r=t.clientWidth;var n=ke._calculatePadding(t,"padding-left",r);var i=ke._calculatePadding(t,"padding-right",r);var a=r-n-i;var o=ke.getConstraintWidth(e);return isNaN(o)?a:Math.min(a,o)};ke.getMaximumHeight=function(e){var t=ke._getParentNode(e);if(!t){return e.clientHeight}var r=t.clientHeight;var n=ke._calculatePadding(t,"padding-top",r);var i=ke._calculatePadding(t,"padding-bottom",r);var a=r-n-i;var o=ke.getConstraintHeight(e);return isNaN(o)?a:Math.min(a,o)};ke.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)};ke.retinaScale=function(e,t){var r=e.currentDevicePixelRatio=t||typeof window!=="undefined"&&window.devicePixelRatio||1;if(r===1){return}var n=e.canvas;var i=e.height;var a=e.width;n.height=i*r;n.width=a*r;e.ctx.scale(r,r);if(!n.style.height&&!n.style.width){n.style.height=i+"px";n.style.width=a+"px"}};ke.fontString=function(e,t,r){return t+" "+e+"px "+r};ke.longestText=function(e,t,r,n){n=n||{};var i=n.data=n.data||{};var a=n.garbageCollect=n.garbageCollect||[];if(n.font!==t){i=n.data={};a=n.garbageCollect=[];n.font=t}e.font=t;var o=0;var s=r.length;var l,u,f,c,d;for(l=0;l<s;l++){c=r[l];if(c!==undefined&&c!==null&&ke.isArray(c)!==true){o=ke.measureText(e,i,a,o,c)}else if(ke.isArray(c)){for(u=0,f=c.length;u<f;u++){d=c[u];if(d!==undefined&&d!==null&&!ke.isArray(d)){o=ke.measureText(e,i,a,o,d)}}}}var h=a.length/2;if(h>r.length){for(l=0;l<h;l++){delete i[a[l]]}a.splice(0,h)}return o};ke.measureText=function(e,t,r,n,i){var a=t[i];if(!a){a=t[i]=e.measureText(i).width;r.push(i)}if(a>n){n=a}return n};ke.numberOfLabelLines=function(e){var t=1;ke.each(e,function(e){if(ke.isArray(e)){if(e.length>t){t=e.length}}});return t};ke.color=!Q?function(e){console.error("Color.js not found!");return e}:function(e){if(e instanceof CanvasGradient){e=de.global.defaultColor}return Q(e)};ke.getHoverColor=function(e){return e instanceof CanvasPattern||e instanceof CanvasGradient?e:ke.color(e).saturate(.5).darken(.1).rgbString()}};function pn(){throw new Error("This method is not implemented: either no adapter can "+"be found or an incomplete integration was provided.")}function gn(e){this.options=e||{}}ke.extend(gn.prototype,{formats:pn,parse:pn,format:pn,add:pn,diff:pn,startOf:pn,endOf:pn,_create:function(e){return e}});gn.override=function(e){ke.extend(gn.prototype,e)};var mn=gn;var yn={_date:mn};var bn={formatters:{values:function(e){return ke.isArray(e)?e:""+e},linear:function(e,t,r){var n=r.length>3?r[2]-r[1]:r[1]-r[0];if(Math.abs(n)>1){if(e!==Math.floor(e)){n=e-Math.floor(e)}}var i=ke.log10(Math.abs(n));var a="";if(e!==0){var o=Math.max(Math.abs(r[0]),Math.abs(r[r.length-1]));if(o<1e-4){var s=ke.log10(Math.abs(e));var l=Math.floor(s)-Math.floor(i);l=Math.max(Math.min(l,20),0);a=e.toExponential(l)}else{var u=-1*Math.floor(i);u=Math.max(Math.min(u,20),0);a=e.toFixed(u)}}else{a="0"}return a},logarithmic:function(e,t,r){var n=e/Math.pow(10,Math.floor(ke.log10(e)));if(e===0){return"0"}else if(n===1||n===2||n===5||t===0||t===r.length-1){return e.toExponential()}return""}}};var wn=ke.isArray;var Cn=ke.isNullOrUndef;var Sn=ke.valueOrDefault;var En=ke.valueAtIndexOrDefault;de._set("scale",{display:true,position:"left",offset:false,gridLines:{display:true,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:true,drawOnChartArea:true,drawTicks:true,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:false,borderDash:[],borderDashOffset:0},scaleLabel:{display:false,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:false,minRotation:0,maxRotation:50,mirror:false,padding:0,reverse:false,display:true,autoSkip:true,autoSkipPadding:0,labelOffset:0,callback:bn.formatters.values,minor:{},major:{}}});function kn(e,t){var r=[];var n=e.length/t;var i=0;var a=e.length;for(;i<a;i+=n){r.push(e[Math.floor(i)])}return r}function Tn(e,t,r){var n=e.getTicks().length;var i=Math.min(t,n-1);var a=e.getPixelForTick(i);var o=e._startPixel;var s=e._endPixel;var l=1e-6;var u;if(r){if(n===1){u=Math.max(a-o,s-a)}else if(t===0){u=(e.getPixelForTick(1)-a)/2}else{u=(a-e.getPixelForTick(i-1))/2}a+=i<t?u:-u;if(a<o-l||a>s+l){return}}return a}function _n(e,i){ke.each(e,function(e){var t=e.gc;var r=t.length/2;var n;if(r>i){for(n=0;n<r;++n){delete e.data[t[n]]}t.splice(0,r)}})}function xn(e,t,r,n){var i=r.length;var a=[];var o=[];var s=[];var l,u,f,c,d,h,v,p,g,m,y,b,w;for(l=0;l<i;++l){c=r[l].label;d=r[l].major?t.major:t.minor;e.font=h=d.string;v=n[h]=n[h]||{data:{},gc:[]};p=d.lineHeight;g=m=0;if(!Cn(c)&&!wn(c)){g=ke.measureText(e,v.data,v.gc,g,c);m=p}else if(wn(c)){for(u=0,f=c.length;u<f;++u){y=c[u];if(!Cn(y)&&!wn(y)){g=ke.measureText(e,v.data,v.gc,g,y);m+=p}}}a.push(g);o.push(m);s.push(p/2)}_n(n,i);b=a.indexOf(Math.max.apply(null,a));w=o.indexOf(Math.max.apply(null,o));function C(e){return{width:a[e]||0,height:o[e]||0,offset:s[e]||0}}return{first:C(0),last:C(i-1),widest:C(b),highest:C(w)}}function Dn(e){return e.drawTicks?e.tickMarkLength:0}function Rn(e){var t,r;if(!e.display){return 0}t=ke.options._parseFont(e);r=ke.options.toPadding(e.padding);return t.lineHeight+r.height}function In(e,t){return ke.extend(ke.options._parseFont({fontFamily:Sn(t.fontFamily,e.fontFamily),fontSize:Sn(t.fontSize,e.fontSize),fontStyle:Sn(t.fontStyle,e.fontStyle),lineHeight:Sn(t.lineHeight,e.lineHeight)}),{color:ke.options.resolve([t.fontColor,e.fontColor,de.global.defaultFontColor])})}function On(e){var t=In(e,e.minor);var r=e.major.enabled?In(e,e.major):t;return{minor:t,major:r}}function An(e){var t=[];var r,n,i;for(n=0,i=e.length;n<i;++n){r=e[n];if(typeof r._index!=="undefined"){t.push(r)}}return t}function Nn(e){var t=e.length;var r,n;if(t<2){return false}for(n=e[0],r=1;r<t;++r){if(e[r]-e[r-1]!==n){return false}}return n}function Mn(e,t,r,n){var i=Nn(e);var a=(t.length-1)/n;var o,s,l,u;if(!i){return Math.max(a,1)}o=ke.math._factorize(i);for(l=0,u=o.length-1;l<u;l++){s=o[l];if(s>a){return s}}return Math.max(a,1)}function Ln(e){var t=[];var r,n;for(r=0,n=e.length;r<n;r++){if(e[r].major){t.push(r)}}return t}function Pn(e,t,r){var n=0;var i=t[0];var a,o;r=Math.ceil(r);for(a=0;a<e.length;a++){o=e[a];if(a===i){o._index=a;n++;i=t[n*r]}else{delete o.label}}}function Fn(e,t,r,n){var i=Sn(r,0);var a=Math.min(Sn(n,e.length),e.length);var o=0;var s,l,u,f;t=Math.ceil(t);if(n){s=n-r;t=s/Math.floor(s/t)}f=i;while(f<0){o++;f=Math.round(i+o*t)}for(l=Math.max(i,0);l<a;l++){u=e[l];if(l===f){u._index=l;o++;f=Math.round(i+o*t)}else{delete u.label}}}var Bn=Ae.extend({zeroLineIndex:0,getPadding:function(){var e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){ke.callback(this.options.beforeUpdate,[this])},update:function(e,t,r){var n=this;var i=n.options.ticks;var a=i.sampleSize;var o,s,l,u,f;n.beforeUpdate();n.maxWidth=e;n.maxHeight=t;n.margins=ke.extend({left:0,right:0,top:0,bottom:0},r);n._ticks=null;n.ticks=null;n._labelSizes=null;n._maxLabelLines=0;n.longestLabelWidth=0;n.longestTextCache=n.longestTextCache||{};n._gridLineItems=null;n._labelItems=null;n.beforeSetDimensions();n.setDimensions();n.afterSetDimensions();n.beforeDataLimits();n.determineDataLimits();n.afterDataLimits();n.beforeBuildTicks();u=n.buildTicks()||[];u=n.afterBuildTicks(u)||u;if((!u||!u.length)&&n.ticks){u=[];for(o=0,s=n.ticks.length;o<s;++o){u.push({value:n.ticks[o],major:false})}}n._ticks=u;f=a<u.length;l=n._convertTicksToLabels(f?kn(u,a):u);n._configure();n.beforeCalculateTickRotation();n.calculateTickRotation();n.afterCalculateTickRotation();n.beforeFit();n.fit();n.afterFit();n._ticksToDraw=i.display&&(i.autoSkip||i.source==="auto")?n._autoSkip(u):u;if(f){l=n._convertTicksToLabels(n._ticksToDraw)}n.ticks=l;n.afterUpdate();return n.minSize},_configure:function(){var e=this;var t=e.options.ticks.reverse;var r,n;if(e.isHorizontal()){r=e.left;n=e.right}else{r=e.top;n=e.bottom;t=!t}e._startPixel=r;e._endPixel=n;e._reversePixels=t;e._length=n-r},afterUpdate:function(){ke.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){ke.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var e=this;if(e.isHorizontal()){e.width=e.maxWidth;e.left=0;e.right=e.width}else{e.height=e.maxHeight;e.top=0;e.bottom=e.height}e.paddingLeft=0;e.paddingTop=0;e.paddingRight=0;e.paddingBottom=0},afterSetDimensions:function(){ke.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){ke.callback(this.options.beforeDataLimits,[this])},determineDataLimits:ke.noop,afterDataLimits:function(){ke.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){ke.callback(this.options.beforeBuildTicks,[this])},buildTicks:ke.noop,afterBuildTicks:function(e){var t=this;if(wn(e)&&e.length){return ke.callback(t.options.afterBuildTicks,[t,e])}t.ticks=ke.callback(t.options.afterBuildTicks,[t,t.ticks])||t.ticks;return e},beforeTickToLabelConversion:function(){ke.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var e=this;var t=e.options.ticks;e.ticks=e.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){ke.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){ke.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var e=this;var t=e.options;var r=t.ticks;var n=e.getTicks().length;var i=r.minRotation||0;var a=r.maxRotation;var o=i;var s,l,u,f,c,d,h;if(!e._isVisible()||!r.display||i>=a||n<=1||!e.isHorizontal()){e.labelRotation=i;return}s=e._getLabelSizes();l=s.widest.width;u=s.highest.height-s.highest.offset;f=Math.min(e.maxWidth,e.chart.width-l);c=t.offset?e.maxWidth/n:f/(n-1);if(l+6>c){c=f/(n-(t.offset?.5:1));d=e.maxHeight-Dn(t.gridLines)-r.padding-Rn(t.scaleLabel);h=Math.sqrt(l*l+u*u);o=ke.toDegrees(Math.min(Math.asin(Math.min((s.highest.height+6)/c,1)),Math.asin(Math.min(d/h,1))-Math.asin(u/h)));o=Math.max(i,Math.min(a,o))}e.labelRotation=o},afterCalculateTickRotation:function(){ke.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){ke.callback(this.options.beforeFit,[this])},fit:function(){var e=this;var t=e.minSize={width:0,height:0};var r=e.chart;var n=e.options;var i=n.ticks;var a=n.scaleLabel;var o=n.gridLines;var s=e._isVisible();var l=n.position==="bottom";var u=e.isHorizontal();if(u){t.width=e.maxWidth}else if(s){t.width=Dn(o)+Rn(a)}if(!u){t.height=e.maxHeight}else if(s){t.height=Dn(o)+Rn(a)}if(i.display&&s){var f=On(i);var c=e._getLabelSizes();var d=c.first;var h=c.last;var v=c.widest;var p=c.highest;var g=f.minor.lineHeight*.4;var m=i.padding;if(u){var y=e.labelRotation!==0;var b=ke.toRadians(e.labelRotation);var w=Math.cos(b);var C=Math.sin(b);var S=C*v.width+w*(p.height-(y?p.offset:0))+(y?0:g);t.height=Math.min(e.maxHeight,t.height+S+m);var E=e.getPixelForTick(0)-e.left;var k=e.right-e.getPixelForTick(e.getTicks().length-1);var T,_;if(y){T=l?w*d.width+C*d.offset:C*(d.height-d.offset);_=l?C*(h.height-h.offset):w*h.width+C*h.offset}else{T=d.width/2;_=h.width/2}e.paddingLeft=Math.max((T-E)*e.width/(e.width-E),0)+3;e.paddingRight=Math.max((_-k)*e.width/(e.width-k),0)+3}else{var x=i.mirror?0:v.width+m+g;t.width=Math.min(e.maxWidth,t.width+x);e.paddingTop=d.height/2;e.paddingBottom=h.height/2}}e.handleMargins();if(u){e.width=e._length=r.width-e.margins.left-e.margins.right;e.height=t.height}else{e.width=t.width;e.height=e._length=r.height-e.margins.top-e.margins.bottom}},handleMargins:function(){var e=this;if(e.margins){e.margins.left=Math.max(e.paddingLeft,e.margins.left);e.margins.top=Math.max(e.paddingTop,e.margins.top);e.margins.right=Math.max(e.paddingRight,e.margins.right);e.margins.bottom=Math.max(e.paddingBottom,e.margins.bottom)}},afterFit:function(){ke.callback(this.options.afterFit,[this])},isHorizontal:function(){var e=this.options.position;return e==="top"||e==="bottom"},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(e){if(Cn(e)){return NaN}if((typeof e==="number"||e instanceof Number)&&!isFinite(e)){return NaN}if(e){if(this.isHorizontal()){if(e.x!==undefined){return this.getRightValue(e.x)}}else if(e.y!==undefined){return this.getRightValue(e.y)}}return e},_convertTicksToLabels:function(e){var t=this;var r,n,i;t.ticks=e.map(function(e){return e.value});t.beforeTickToLabelConversion();r=t.convertTicksToLabels(e)||t.ticks;t.afterTickToLabelConversion();for(n=0,i=e.length;n<i;++n){e[n].label=r[n]}return r},_getLabelSizes:function(){var e=this;var t=e._labelSizes;if(!t){e._labelSizes=t=xn(e.ctx,On(e.options.ticks),e.getTicks(),e.longestTextCache);e.longestLabelWidth=t.widest.width}return t},_parseValue:function(e){var t,r,n,i;if(wn(e)){t=+this.getRightValue(e[0]);r=+this.getRightValue(e[1]);n=Math.min(t,r);i=Math.max(t,r)}else{e=+this.getRightValue(e);t=undefined;r=e;n=e;i=e}return{min:n,max:i,start:t,end:r}},_getScaleLabel:function(e){var t=this._parseValue(e);if(t.start!==undefined){return"["+t.start+", "+t.end+"]"}return+this.getRightValue(e)},getLabelForIndex:ke.noop,getPixelForValue:ke.noop,getValueForPixel:ke.noop,getPixelForTick:function(e){var t=this;var r=t.options.offset;var n=t._ticks.length;var i=1/Math.max(n-(r?0:1),1);return e<0||e>n-1?null:t.getPixelForDecimal(e*i+(r?i/2:0))},getPixelForDecimal:function(e){var t=this;if(t._reversePixels){e=1-e}return t._startPixel+e*t._length},getDecimalForPixel:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var e=this;var t=e.min;var r=e.max;return e.beginAtZero?0:t<0&&r<0?r:t>0&&r>0?t:0},_autoSkip:function(e){var t=this;var r=t.options.ticks;var n=t._length;var i=r.maxTicksLimit||n/t._tickSize()+1;var a=r.major.enabled?Ln(e):[];var o=a.length;var s=a[0];var l=a[o-1];var u,f,c,d;if(o>i){Pn(e,a,o/i);return An(e)}c=Mn(a,e,n,i);if(o>0){for(u=0,f=o-1;u<f;u++){Fn(e,c,a[u],a[u+1])}d=o>1?(l-s)/(o-1):null;Fn(e,c,ke.isNullOrUndef(d)?0:s-d,s);Fn(e,c,l,ke.isNullOrUndef(d)?e.length:l+d);return An(e)}Fn(e,c);return An(e)},_tickSize:function(){var e=this;var t=e.options.ticks;var r=ke.toRadians(e.labelRotation);var n=Math.abs(Math.cos(r));var i=Math.abs(Math.sin(r));var a=e._getLabelSizes();var o=t.autoSkipPadding||0;var s=a?a.widest.width+o:0;var l=a?a.highest.height+o:0;return e.isHorizontal()?l*n>s*i?s/n:l/i:l*i<s*n?l/n:s/i},_isVisible:function(){var e=this;var t=e.chart;var r=e.options.display;var n,i,a;if(r!=="auto"){return!!r}for(n=0,i=t.data.datasets.length;n<i;++n){if(t.isDatasetVisible(n)){a=t.getDatasetMeta(n);if(a.xAxisID===e.id||a.yAxisID===e.id){return true}}}return false},_computeGridLineItems:function(e){var t=this;var r=t.chart;var n=t.options;var i=n.gridLines;var a=n.position;var o=i.offsetGridLines;var s=t.isHorizontal();var l=t._ticksToDraw;var u=l.length+(o?1:0);var f=Dn(i);var c=[];var d=i.drawBorder?En(i.lineWidth,0,0):0;var h=d/2;var v=ke._alignPixel;var p=function(e){return v(r,e,d)};var g,m,y,b,w;var C,S,E,k,T,_,x,D,R,I,O,A;if(a==="top"){g=p(t.bottom);S=t.bottom-f;k=g-h;_=p(e.top)+h;D=e.bottom}else if(a==="bottom"){g=p(t.top);_=e.top;D=p(e.bottom)-h;S=g+h;k=t.top+f}else if(a==="left"){g=p(t.right);C=t.right-f;E=g-h;T=p(e.left)+h;x=e.right}else{g=p(t.left);T=e.left;x=p(e.right)-h;C=g+h;E=t.left+f}for(m=0;m<u;++m){y=l[m]||{};if(Cn(y.label)&&m<l.length){continue}if(m===t.zeroLineIndex&&n.offset===o){R=i.zeroLineWidth;I=i.zeroLineColor;O=i.zeroLineBorderDash||[];A=i.zeroLineBorderDashOffset||0}else{R=En(i.lineWidth,m,1);I=En(i.color,m,"rgba(0,0,0,0.1)");O=i.borderDash||[];A=i.borderDashOffset||0}b=Tn(t,y._index||m,o);if(b===undefined){continue}w=v(r,b,R);if(s){C=E=T=x=w}else{S=k=_=D=w}c.push({tx1:C,ty1:S,tx2:E,ty2:k,x1:T,y1:_,x2:x,y2:D,width:R,color:I,borderDash:O,borderDashOffset:A})}c.ticksLength=u;c.borderValue=g;return c},_computeLabelItems:function(){var e=this;var t=e.options;var r=t.ticks;var n=t.position;var i=r.mirror;var a=e.isHorizontal();var o=e._ticksToDraw;var s=On(r);var l=r.padding;var u=Dn(t.gridLines);var f=-ke.toRadians(e.labelRotation);var c=[];var d,h,v,p,g,m,y,b,w,C,S,E;if(n==="top"){m=e.bottom-u-l;y=!f?"center":"left"}else if(n==="bottom"){m=e.top+u+l;y=!f?"center":"right"}else if(n==="left"){g=e.right-(i?0:u)-l;y=i?"left":"right"}else{g=e.left+(i?0:u)+l;y=i?"right":"left"}for(d=0,h=o.length;d<h;++d){v=o[d];p=v.label;if(Cn(p)){continue}b=e.getPixelForTick(v._index||d)+r.labelOffset;w=v.major?s.major:s.minor;C=w.lineHeight;S=wn(p)?p.length:1;if(a){g=b;E=n==="top"?((!f?.5:1)-S)*C:(!f?.5:0)*C}else{m=b;E=(1-S)*C/2}c.push({x:g,y:m,rotation:f,label:p,font:w,textOffset:E,textAlign:y})}return c},_drawGrid:function(e){var t=this;var r=t.options.gridLines;if(!r.display){return}var n=t.ctx;var i=t.chart;var a=ke._alignPixel;var o=r.drawBorder?En(r.lineWidth,0,0):0;var s=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));var l,u,f,c,d;for(f=0,c=s.length;f<c;++f){d=s[f];l=d.width;u=d.color;if(l&&u){n.save();n.lineWidth=l;n.strokeStyle=u;if(n.setLineDash){n.setLineDash(d.borderDash);n.lineDashOffset=d.borderDashOffset}n.beginPath();if(r.drawTicks){n.moveTo(d.tx1,d.ty1);n.lineTo(d.tx2,d.ty2)}if(r.drawOnChartArea){n.moveTo(d.x1,d.y1);n.lineTo(d.x2,d.y2)}n.stroke();n.restore()}}if(o){var h=o;var v=En(r.lineWidth,s.ticksLength-1,1);var p=s.borderValue;var g,m,y,b;if(t.isHorizontal()){g=a(i,t.left,h)-h/2;m=a(i,t.right,v)+v/2;y=b=p}else{y=a(i,t.top,h)-h/2;b=a(i,t.bottom,v)+v/2;g=m=p}n.lineWidth=o;n.strokeStyle=En(r.color,0);n.beginPath();n.moveTo(g,y);n.lineTo(m,b);n.stroke()}},_drawLabels:function(){var e=this;var t=e.options.ticks;if(!t.display){return}var r=e.ctx;var n=e._labelItems||(e._labelItems=e._computeLabelItems());var i,a,o,s,l,u,f,c;for(i=0,o=n.length;i<o;++i){l=n[i];u=l.font;r.save();r.translate(l.x,l.y);r.rotate(l.rotation);r.font=u.string;r.fillStyle=u.color;r.textBaseline="middle";r.textAlign=l.textAlign;f=l.label;c=l.textOffset;if(wn(f)){for(a=0,s=f.length;a<s;++a){r.fillText(""+f[a],0,c);c+=u.lineHeight}}else{r.fillText(f,0,c)}r.restore()}},_drawTitle:function(){var e=this;var t=e.ctx;var r=e.options;var n=r.scaleLabel;if(!n.display){return}var i=Sn(n.fontColor,de.global.defaultFontColor);var a=ke.options._parseFont(n);var o=ke.options.toPadding(n.padding);var s=a.lineHeight/2;var l=r.position;var u=0;var f,c;if(e.isHorizontal()){f=e.left+e.width/2;c=l==="bottom"?e.bottom-s-o.bottom:e.top+s+o.top}else{var d=l==="left";f=d?e.left+s+o.top:e.right-s-o.top;c=e.top+e.height/2;u=d?-.5*Math.PI:.5*Math.PI}t.save();t.translate(f,c);t.rotate(u);t.textAlign="center";t.textBaseline="middle";t.fillStyle=i;t.font=a.string;t.fillText(n.labelString,0,0);t.restore()},draw:function(e){var t=this;if(!t._isVisible()){return}t._drawGrid(e);t._drawTitle();t._drawLabels()},_layers:function(){var e=this;var t=e.options;var r=t.ticks&&t.ticks.z||0;var n=t.gridLines&&t.gridLines.z||0;if(!e._isVisible()||r===n||e.draw!==e._draw){return[{z:r,draw:function(){e.draw.apply(e,arguments)}}]}return[{z:n,draw:function(){e._drawGrid.apply(e,arguments);e._drawTitle.apply(e,arguments)}},{z:r,draw:function(){e._drawLabels.apply(e,arguments)}}]},_getMatchingVisibleMetas:function(t){var r=this;var n=r.isHorizontal();return r.chart._getSortedVisibleDatasetMetas().filter(function(e){return(!t||e.type===t)&&(n?e.xAxisID===r.id:e.yAxisID===r.id)})}});Bn.prototype._draw=Bn.prototype.draw;var Hn=Bn;var $n=ke.isNullOrUndef;var Wn={position:"bottom"};var Un=Hn.extend({determineDataLimits:function(){var e=this;var t=e._getLabels();var r=e.options.ticks;var n=r.min;var i=r.max;var a=0;var o=t.length-1;var s;if(n!==undefined){s=t.indexOf(n);if(s>=0){a=s}}if(i!==undefined){s=t.indexOf(i);if(s>=0){o=s}}e.minIndex=a;e.maxIndex=o;e.min=t[a];e.max=t[o]},buildTicks:function(){var e=this;var t=e._getLabels();var r=e.minIndex;var n=e.maxIndex;e.ticks=r===0&&n===t.length-1?t:t.slice(r,n+1)},getLabelForIndex:function(e,t){var r=this;var n=r.chart;if(n.getDatasetMeta(t).controller._getValueScaleId()===r.id){return r.getRightValue(n.data.datasets[t].data[e])}return r._getLabels()[e]},_configure:function(){var e=this;var t=e.options.offset;var r=e.ticks;Hn.prototype._configure.call(e);if(!e.isHorizontal()){e._reversePixels=!e._reversePixels}if(!r){return}e._startValue=e.minIndex-(t?.5:0);e._valueRange=Math.max(r.length-(t?0:1),1)},getPixelForValue:function(e,t,r){var n=this;var i,a,o;if(!$n(t)&&!$n(r)){e=n.chart.data.datasets[r].data[t]}if(!$n(e)){i=n.isHorizontal()?e.x:e.y}if(i!==undefined||e!==undefined&&isNaN(t)){a=n._getLabels();e=ke.valueOrDefault(i,e);o=a.indexOf(e);t=o!==-1?o:t;if(isNaN(t)){t=e}}return n.getPixelForDecimal((t-n._startValue)/n._valueRange)},getPixelForTick:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e],e+this.minIndex)},getValueForPixel:function(e){var t=this;var r=Math.round(t._startValue+t.getDecimalForPixel(e)*t._valueRange);return Math.min(Math.max(r,0),t.ticks.length-1)},getBasePixel:function(){return this.bottom}});var jn=Wn;Un._defaults=jn;var Vn=ke.noop;var zn=ke.isNullOrUndef;function qn(e,t){var r=[];var n=1e-14;var i=e.stepSize;var a=i||1;var o=e.maxTicks-1;var s=e.min;var l=e.max;var u=e.precision;var f=t.min;var c=t.max;var d=ke.niceNum((c-f)/o/a)*a;var h,v,p,g;if(d<n&&zn(s)&&zn(l)){return[f,c]}g=Math.ceil(c/d)-Math.floor(f/d);if(g>o){d=ke.niceNum(g*d/o/a)*a}if(i||zn(u)){h=Math.pow(10,ke._decimalPlaces(d))}else{h=Math.pow(10,u);d=Math.ceil(d*h)/h}v=Math.floor(f/d)*d;p=Math.ceil(c/d)*d;if(i){if(!zn(s)&&ke.almostWhole(s/d,d/1e3)){v=s}if(!zn(l)&&ke.almostWhole(l/d,d/1e3)){p=l}}g=(p-v)/d;if(ke.almostEquals(g,Math.round(g),d/1e3)){g=Math.round(g)}else{g=Math.ceil(g)}v=Math.round(v*h)/h;p=Math.round(p*h)/h;r.push(zn(s)?v:s);for(var m=1;m<g;++m){r.push(Math.round((v+m*d)*h)/h)}r.push(zn(l)?p:l);return r}var Yn=Hn.extend({getRightValue:function(e){if(typeof e==="string"){return+e}return Hn.prototype.getRightValue.call(this,e)},handleTickRangeOptions:function(){var e=this;var t=e.options;var r=t.ticks;if(r.beginAtZero){var n=ke.sign(e.min);var i=ke.sign(e.max);if(n<0&&i<0){e.max=0}else if(n>0&&i>0){e.min=0}}var a=r.min!==undefined||r.suggestedMin!==undefined;var o=r.max!==undefined||r.suggestedMax!==undefined;if(r.min!==undefined){e.min=r.min}else if(r.suggestedMin!==undefined){if(e.min===null){e.min=r.suggestedMin}else{e.min=Math.min(e.min,r.suggestedMin)}}if(r.max!==undefined){e.max=r.max}else if(r.suggestedMax!==undefined){if(e.max===null){e.max=r.suggestedMax}else{e.max=Math.max(e.max,r.suggestedMax)}}if(a!==o){if(e.min>=e.max){if(a){e.max=e.min+1}else{e.min=e.max-1}}}if(e.min===e.max){e.max++;if(!r.beginAtZero){e.min--}}},getTickLimit:function(){var e=this;var t=e.options.ticks;var r=t.stepSize;var n=t.maxTicksLimit;var i;if(r){i=Math.ceil(e.max/r)-Math.floor(e.min/r)+1}else{i=e._computeTickLimit();n=n||11}if(n){i=Math.min(n,i)}return i},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:Vn,buildTicks:function(){var e=this;var t=e.options;var r=t.ticks;var n=e.getTickLimit();n=Math.max(2,n);var i={maxTicks:n,min:r.min,max:r.max,precision:r.precision,stepSize:ke.valueOrDefault(r.fixedStepSize,r.stepSize)};var a=e.ticks=qn(i,e);e.handleDirectionalChanges();e.max=ke.max(a);e.min=ke.min(a);if(r.reverse){a.reverse();e.start=e.max;e.end=e.min}else{e.start=e.min;e.end=e.max}},convertTicksToLabels:function(){var e=this;e.ticksAsNumbers=e.ticks.slice();e.zeroLineIndex=e.ticks.indexOf(0);Hn.prototype.convertTicksToLabels.call(e)},_configure:function(){var e=this;var t=e.getTicks();var r=e.min;var n=e.max;var i;Hn.prototype._configure.call(e);if(e.options.offset&&t.length){i=(n-r)/Math.max(t.length-1,1)/2;r-=i;n+=i}e._startValue=r;e._endValue=n;e._valueRange=n-r}});var Gn={position:"left",ticks:{callback:bn.formatters.linear}};var Xn=0;var Kn=1;function Jn(e,t,r){var n=[r.type,t===undefined&&r.stack===undefined?r.index:"",r.stack].join(".");if(e[n]===undefined){e[n]={pos:[],neg:[]}}return e[n]}function Qn(e,t,r,n){var i=e.options;var a=i.stacked;var o=Jn(t,a,r);var s=o.pos;var l=o.neg;var u=n.length;var f,c;for(f=0;f<u;++f){c=e._parseValue(n[f]);if(isNaN(c.min)||isNaN(c.max)||r.data[f].hidden){continue}s[f]=s[f]||0;l[f]=l[f]||0;if(i.relativePoints){s[f]=100}else if(c.min<0||c.max<0){l[f]+=c.min}else{s[f]+=c.max}}}function Zn(e,t,r){var n=r.length;var i,a;for(i=0;i<n;++i){a=e._parseValue(r[i]);if(isNaN(a.min)||isNaN(a.max)||t.data[i].hidden){continue}e.min=Math.min(e.min,a.min);e.max=Math.max(e.max,a.max)}}var ei=Yn.extend({determineDataLimits:function(){var t=this;var e=t.options;var r=t.chart;var n=r.data.datasets;var i=t._getMatchingVisibleMetas();var a=e.stacked;var o={};var s=i.length;var l,u,f,c;t.min=Number.POSITIVE_INFINITY;t.max=Number.NEGATIVE_INFINITY;if(a===undefined){for(l=0;!a&&l<s;++l){u=i[l];a=u.stack!==undefined}}for(l=0;l<s;++l){u=i[l];f=n[u.index].data;if(a){Qn(t,o,u,f)}else{Zn(t,u,f)}}ke.each(o,function(e){c=e.pos.concat(e.neg);t.min=Math.min(t.min,ke.min(c));t.max=Math.max(t.max,ke.max(c))});t.min=ke.isFinite(t.min)&&!isNaN(t.min)?t.min:Xn;t.max=ke.isFinite(t.max)&&!isNaN(t.max)?t.max:Kn;t.handleTickRangeOptions()},_computeTickLimit:function(){var e=this;var t;if(e.isHorizontal()){return Math.ceil(e.width/40)}t=ke.options._parseFont(e.options.ticks);return Math.ceil(e.height/t.lineHeight)},handleDirectionalChanges:function(){if(!this.isHorizontal()){this.ticks.reverse()}},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForValue:function(e){var t=this;return t.getPixelForDecimal((+t.getRightValue(e)-t._startValue)/t._valueRange)},getValueForPixel:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange},getPixelForTick:function(e){var t=this.ticksAsNumbers;if(e<0||e>t.length-1){return null}return this.getPixelForValue(t[e])}});var ti=Gn;ei._defaults=ti;var ri=ke.valueOrDefault;var ni=ke.math.log10;function ii(e,t){var r=[];var n=ri(e.min,Math.pow(10,Math.floor(ni(t.min))));var i=Math.floor(ni(t.max));var a=Math.ceil(t.max/Math.pow(10,i));var o,s;if(n===0){o=Math.floor(ni(t.minNotZero));s=Math.floor(t.minNotZero/Math.pow(10,o));r.push(n);n=s*Math.pow(10,o)}else{o=Math.floor(ni(n));s=Math.floor(n/Math.pow(10,o))}var l=o<0?Math.pow(10,Math.abs(o)):1;do{r.push(n);++s;if(s===10){s=1;++o;l=o>=0?1:l}n=Math.round(s*Math.pow(10,o)*l)/l}while(o<i||o===i&&s<a);var u=ri(e.max,n);r.push(u);return r}var ai={position:"left",ticks:{callback:bn.formatters.logarithmic}};function oi(e,t){return ke.isFinite(e)&&e>=0?e:t}var si=Hn.extend({determineDataLimits:function(){var n=this;var e=n.options;var t=n.chart;var r=t.data.datasets;var i=n.isHorizontal();function a(e){return i?e.xAxisID===n.id:e.yAxisID===n.id}var o,s,l,u,f,c;n.min=Number.POSITIVE_INFINITY;n.max=Number.NEGATIVE_INFINITY;n.minNotZero=Number.POSITIVE_INFINITY;var d=e.stacked;if(d===undefined){for(o=0;o<r.length;o++){s=t.getDatasetMeta(o);if(t.isDatasetVisible(o)&&a(s)&&s.stack!==undefined){d=true;break}}}if(e.stacked||d){var h={};for(o=0;o<r.length;o++){s=t.getDatasetMeta(o);var v=[s.type,e.stacked===undefined&&s.stack===undefined?o:"",s.stack].join(".");if(t.isDatasetVisible(o)&&a(s)){if(h[v]===undefined){h[v]=[]}u=r[o].data;for(f=0,c=u.length;f<c;f++){var p=h[v];l=n._parseValue(u[f]);if(isNaN(l.min)||isNaN(l.max)||s.data[f].hidden||l.min<0||l.max<0){continue}p[f]=p[f]||0;p[f]+=l.max}}}ke.each(h,function(e){if(e.length>0){var t=ke.min(e);var r=ke.max(e);n.min=Math.min(n.min,t);n.max=Math.max(n.max,r)}})}else{for(o=0;o<r.length;o++){s=t.getDatasetMeta(o);if(t.isDatasetVisible(o)&&a(s)){u=r[o].data;for(f=0,c=u.length;f<c;f++){l=n._parseValue(u[f]);if(isNaN(l.min)||isNaN(l.max)||s.data[f].hidden||l.min<0||l.max<0){continue}n.min=Math.min(l.min,n.min);n.max=Math.max(l.max,n.max);if(l.min!==0){n.minNotZero=Math.min(l.min,n.minNotZero)}}}}}n.min=ke.isFinite(n.min)?n.min:null;n.max=ke.isFinite(n.max)?n.max:null;n.minNotZero=ke.isFinite(n.minNotZero)?n.minNotZero:null;this.handleTickRangeOptions()},handleTickRangeOptions:function(){var e=this;var t=e.options.ticks;var r=1;var n=10;e.min=oi(t.min,e.min);e.max=oi(t.max,e.max);if(e.min===e.max){if(e.min!==0&&e.min!==null){e.min=Math.pow(10,Math.floor(ni(e.min))-1);e.max=Math.pow(10,Math.floor(ni(e.max))+1)}else{e.min=r;e.max=n}}if(e.min===null){e.min=Math.pow(10,Math.floor(ni(e.max))-1)}if(e.max===null){e.max=e.min!==0?Math.pow(10,Math.floor(ni(e.min))+1):n}if(e.minNotZero===null){if(e.min>0){e.minNotZero=e.min}else if(e.max<1){e.minNotZero=Math.pow(10,Math.floor(ni(e.max)))}else{e.minNotZero=r}}},buildTicks:function(){var e=this;var t=e.options.ticks;var r=!e.isHorizontal();var n={min:oi(t.min),max:oi(t.max)};var i=e.ticks=ii(n,e);e.max=ke.max(i);e.min=ke.min(i);if(t.reverse){r=!r;e.start=e.max;e.end=e.min}else{e.start=e.min;e.end=e.max}if(r){i.reverse()}},convertTicksToLabels:function(){this.tickValues=this.ticks.slice();Hn.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForTick:function(e){var t=this.tickValues;if(e<0||e>t.length-1){return null}return this.getPixelForValue(t[e])},_getFirstTickValue:function(e){var t=Math.floor(ni(e));var r=Math.floor(e/Math.pow(10,t));return r*Math.pow(10,t)},_configure:function(){var e=this;var t=e.min;var r=0;Hn.prototype._configure.call(e);if(t===0){t=e._getFirstTickValue(e.minNotZero);r=ri(e.options.ticks.fontSize,de.global.defaultFontSize)/e._length}e._startValue=ni(t);e._valueOffset=r;e._valueRange=(ni(e.max)-ni(t))/(1-r)},getPixelForValue:function(e){var t=this;var r=0;e=+t.getRightValue(e);if(e>t.min&&e>0){r=(ni(e)-t._startValue)/t._valueRange+t._valueOffset}return t.getPixelForDecimal(r)},getValueForPixel:function(e){var t=this;var r=t.getDecimalForPixel(e);return r===0&&t.min===0?0:Math.pow(10,t._startValue+(r-t._valueOffset)*t._valueRange)}});var li=ai;si._defaults=li;var ui=ke.valueOrDefault;var fi=ke.valueAtIndexOrDefault;var ci=ke.options.resolve;var di={display:true,animate:true,position:"chartArea",angleLines:{display:true,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:false},ticks:{showLabelBackdrop:true,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:bn.formatters.linear},pointLabels:{display:true,fontSize:10,callback:function(e){return e}}};function hi(e){var t=e.ticks;if(t.display&&e.display){return ui(t.fontSize,de.global.defaultFontSize)+t.backdropPaddingY*2}return 0}function vi(e,t,r){if(ke.isArray(r)){return{w:ke.longestText(e,e.font,r),h:r.length*t}}return{w:e.measureText(r).width,h:t}}function pi(e,t,r,n,i){if(e===n||e===i){return{start:t-r/2,end:t+r/2}}else if(e<n||e>i){return{start:t-r,end:t}}return{start:t,end:t+r}}function gi(e){var t=ke.options._parseFont(e.options.pointLabels);var r={l:0,r:e.width,t:0,b:e.height-e.paddingTop};var n={};var i,a,o;e.ctx.font=t.string;e._pointLabelSizes=[];var s=e.chart.data.labels.length;for(i=0;i<s;i++){o=e.getPointPosition(i,e.drawingArea+5);a=vi(e.ctx,t.lineHeight,e.pointLabels[i]);e._pointLabelSizes[i]=a;var l=e.getIndexAngle(i);var u=ke.toDegrees(l)%360;var f=pi(u,o.x,a.w,0,180);var c=pi(u,o.y,a.h,90,270);if(f.start<r.l){r.l=f.start;n.l=l}if(f.end>r.r){r.r=f.end;n.r=l}if(c.start<r.t){r.t=c.start;n.t=l}if(c.end>r.b){r.b=c.end;n.b=l}}e.setReductions(e.drawingArea,r,n)}function mi(e){if(e===0||e===180){return"center"}else if(e<180){return"left"}return"right"}function yi(e,t,r,n){var i=r.y+n/2;var a,o;if(ke.isArray(t)){for(a=0,o=t.length;a<o;++a){e.fillText(t[a],r.x,i);i+=n}}else{e.fillText(t,r.x,i)}}function bi(e,t,r){if(e===90||e===270){r.y-=t.h/2}else if(e>270||e<90){r.y-=t.h}}function wi(e){var t=e.ctx;var r=e.options;var n=r.pointLabels;var i=hi(r);var a=e.getDistanceFromCenterForValue(r.ticks.reverse?e.min:e.max);var o=ke.options._parseFont(n);t.save();t.font=o.string;t.textBaseline="middle";for(var s=e.chart.data.labels.length-1;s>=0;s--){var l=s===0?i/2:0;var u=e.getPointPosition(s,a+l+5);var f=fi(n.fontColor,s,de.global.defaultFontColor);t.fillStyle=f;var c=e.getIndexAngle(s);var d=ke.toDegrees(c);t.textAlign=mi(d);bi(d,e._pointLabelSizes[s],u);yi(t,e.pointLabels[s],u,o.lineHeight)}t.restore()}function Ci(e,t,r,n){var i=e.ctx;var a=t.circular;var o=e.chart.data.labels.length;var s=fi(t.color,n-1);var l=fi(t.lineWidth,n-1);var u;if(!a&&!o||!s||!l){return}i.save();i.strokeStyle=s;i.lineWidth=l;if(i.setLineDash){i.setLineDash(t.borderDash||[]);i.lineDashOffset=t.borderDashOffset||0}i.beginPath();if(a){i.arc(e.xCenter,e.yCenter,r,0,Math.PI*2)}else{u=e.getPointPosition(0,r);i.moveTo(u.x,u.y);for(var f=1;f<o;f++){u=e.getPointPosition(f,r);i.lineTo(u.x,u.y)}}i.closePath();i.stroke();i.restore()}function Si(e){return ke.isNumber(e)?e:0}var Ei=Yn.extend({setDimensions:function(){var e=this;e.width=e.maxWidth;e.height=e.maxHeight;e.paddingTop=hi(e.options)/2;e.xCenter=Math.floor(e.width/2);e.yCenter=Math.floor((e.height-e.paddingTop)/2);e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2},determineDataLimits:function(){var i=this;var r=i.chart;var a=Number.POSITIVE_INFINITY;var o=Number.NEGATIVE_INFINITY;ke.each(r.data.datasets,function(e,t){if(r.isDatasetVisible(t)){var n=r.getDatasetMeta(t);ke.each(e.data,function(e,t){var r=+i.getRightValue(e);if(isNaN(r)||n.data[t].hidden){return}a=Math.min(r,a);o=Math.max(r,o)})}});i.min=a===Number.POSITIVE_INFINITY?0:a;i.max=o===Number.NEGATIVE_INFINITY?0:o;i.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/hi(this.options))},convertTicksToLabels:function(){var t=this;Yn.prototype.convertTicksToLabels.call(t);t.pointLabels=t.chart.data.labels.map(function(){var e=ke.callback(t.options.pointLabels.callback,arguments,t);return e||e===0?e:""})},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function(){var e=this;var t=e.options;if(t.display&&t.pointLabels.display){gi(e)}else{e.setCenterPoint(0,0,0,0)}},setReductions:function(e,t,r){var n=this;var i=t.l/Math.sin(r.l);var a=Math.max(t.r-n.width,0)/Math.sin(r.r);var o=-t.t/Math.cos(r.t);var s=-Math.max(t.b-(n.height-n.paddingTop),0)/Math.cos(r.b);i=Si(i);a=Si(a);o=Si(o);s=Si(s);n.drawingArea=Math.min(Math.floor(e-(i+a)/2),Math.floor(e-(o+s)/2));n.setCenterPoint(i,a,o,s)},setCenterPoint:function(e,t,r,n){var i=this;var a=i.width-t-i.drawingArea;var o=e+i.drawingArea;var s=r+i.drawingArea;var l=i.height-i.paddingTop-n-i.drawingArea;i.xCenter=Math.floor((o+a)/2+i.left);i.yCenter=Math.floor((s+l)/2+i.top+i.paddingTop)},getIndexAngle:function(e){var t=this.chart;var r=360/t.data.labels.length;var n=t.options||{};var i=n.startAngle||0;var a=(e*r+i)%360;return(a<0?a+360:a)*Math.PI*2/360},getDistanceFromCenterForValue:function(e){var t=this;if(ke.isNullOrUndef(e)){return NaN}var r=t.drawingArea/(t.max-t.min);if(t.options.ticks.reverse){return(t.max-e)*r}return(e-t.min)*r},getPointPosition:function(e,t){var r=this;var n=r.getIndexAngle(e)-Math.PI/2;return{x:Math.cos(n)*t+r.xCenter,y:Math.sin(n)*t+r.yCenter}},getPointPositionForValue:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function(e){var t=this;var r=t.min;var n=t.max;return t.getPointPositionForValue(e||0,t.beginAtZero?0:r<0&&n<0?n:r>0&&n>0?r:0)},_drawGrid:function(){var r=this;var e=r.ctx;var t=r.options;var n=t.gridLines;var i=t.angleLines;var a=ui(i.lineWidth,n.lineWidth);var o=ui(i.color,n.color);var s,l,u;if(t.pointLabels.display){wi(r)}if(n.display){ke.each(r.ticks,function(e,t){if(t!==0){l=r.getDistanceFromCenterForValue(r.ticksAsNumbers[t]);Ci(r,n,l,t)}})}if(i.display&&a&&o){e.save();e.lineWidth=a;e.strokeStyle=o;if(e.setLineDash){e.setLineDash(ci([i.borderDash,n.borderDash,[]]));e.lineDashOffset=ci([i.borderDashOffset,n.borderDashOffset,0])}for(s=r.chart.data.labels.length-1;s>=0;s--){l=r.getDistanceFromCenterForValue(t.ticks.reverse?r.min:r.max);u=r.getPointPosition(s,l);e.beginPath();e.moveTo(r.xCenter,r.yCenter);e.lineTo(u.x,u.y);e.stroke()}e.restore()}},_drawLabels:function(){var r=this;var n=r.ctx;var e=r.options;var i=e.ticks;if(!i.display){return}var t=r.getIndexAngle(0);var a=ke.options._parseFont(i);var o=ui(i.fontColor,de.global.defaultFontColor);var s,l;n.save();n.font=a.string;n.translate(r.xCenter,r.yCenter);n.rotate(t);n.textAlign="center";n.textBaseline="middle";ke.each(r.ticks,function(e,t){if(t===0&&!i.reverse){return}s=r.getDistanceFromCenterForValue(r.ticksAsNumbers[t]);if(i.showLabelBackdrop){l=n.measureText(e).width;n.fillStyle=i.backdropColor;n.fillRect(-l/2-i.backdropPaddingX,-s-a.size/2-i.backdropPaddingY,l+i.backdropPaddingX*2,a.size+i.backdropPaddingY*2)}n.fillStyle=o;n.fillText(e,0,-s)});n.restore()},_drawTitle:ke.noop});var ki=di;Ei._defaults=ki;var Ti=ke._deprecated;var _i=ke.options.resolve;var xi=ke.valueOrDefault;var Di=Number.MIN_SAFE_INTEGER||-9007199254740991;var Ri=Number.MAX_SAFE_INTEGER||9007199254740991;var Ii={millisecond:{common:true,size:1,steps:1e3},second:{common:true,size:1e3,steps:60},minute:{common:true,size:6e4,steps:60},hour:{common:true,size:36e5,steps:24},day:{common:true,size:864e5,steps:30},week:{common:false,size:6048e5,steps:4},month:{common:true,size:2628e6,steps:12},quarter:{common:false,size:7884e6,steps:4},year:{common:true,size:3154e7}};var Oi=Object.keys(Ii);function Ai(e,t){return e-t}function Ni(e){var t={};var r=[];var n,i,a;for(n=0,i=e.length;n<i;++n){a=e[n];if(!t[a]){t[a]=true;r.push(a)}}return r}function Mi(e){return ke.valueOrDefault(e.time.min,e.ticks.min)}function Li(e){return ke.valueOrDefault(e.time.max,e.ticks.max)}function Pi(e,t,r,n){if(n==="linear"||!e.length){return[{time:t,pos:0},{time:r,pos:1}]}var i=[];var a=[t];var o,s,l,u,f;for(o=0,s=e.length;o<s;++o){u=e[o];if(u>t&&u<r){a.push(u)}}a.push(r);for(o=0,s=a.length;o<s;++o){f=a[o+1];l=a[o-1];u=a[o];if(l===undefined||f===undefined||Math.round((f+l)/2)!==u){i.push({time:u,pos:o/(s-1)})}}return i}function Fi(e,t,r){var n=0;var i=e.length-1;var a,o,s;while(n>=0&&n<=i){a=n+i>>1;o=e[a-1]||null;s=e[a];if(!o){return{lo:null,hi:s}}else if(s[t]<r){n=a+1}else if(o[t]>r){i=a-1}else{return{lo:o,hi:s}}}return{lo:s,hi:null}}function Bi(e,t,r,n){var i=Fi(e,t,r);var a=!i.lo?e[0]:!i.hi?e[e.length-2]:i.lo;var o=!i.lo?e[1]:!i.hi?e[e.length-1]:i.hi;var s=o[t]-a[t];var l=s?(r-a[t])/s:0;var u=(o[n]-a[n])*l;return a[n]+u}function Hi(e,t){var r=e._adapter;var n=e.options.time;var i=n.parser;var a=i||n.format;var o=t;if(typeof i==="function"){o=i(o)}if(!ke.isFinite(o)){o=typeof a==="string"?r.parse(o,a):r.parse(o)}if(o!==null){return+o}if(!i&&typeof a==="function"){o=a(t);if(!ke.isFinite(o)){o=r.parse(o)}}return o}function $i(e,t){if(ke.isNullOrUndef(t)){return null}var r=e.options.time;var n=Hi(e,e.getRightValue(t));if(n===null){return n}if(r.round){n=+e._adapter.startOf(n,r.round)}return n}function Wi(e,t,r,n){var i=Oi.length;var a,o,s;for(a=Oi.indexOf(e);a<i-1;++a){o=Ii[Oi[a]];s=o.steps?o.steps:Ri;if(o.common&&Math.ceil((r-t)/(s*o.size))<=n){return Oi[a]}}return Oi[i-1]}function Ui(e,t,r,n,i){var a,o;for(a=Oi.length-1;a>=Oi.indexOf(r);a--){o=Oi[a];if(Ii[o].common&&e._adapter.diff(i,n,o)>=t-1){return o}}return Oi[r?Oi.indexOf(r):0]}function ji(e){for(var t=Oi.indexOf(e)+1,r=Oi.length;t<r;++t){if(Ii[Oi[t]].common){return Oi[t]}}}function Vi(e,t,r,n){var i=e._adapter;var a=e.options;var o=a.time;var s=o.unit||Wi(o.minUnit,t,r,n);var l=_i([o.stepSize,o.unitStepSize,1]);var u=s==="week"?o.isoWeekday:false;var f=t;var c=[];var d;if(u){f=+i.startOf(f,"isoWeek",u)}f=+i.startOf(f,u?"day":s);if(i.diff(r,t,s)>1e5*l){throw t+" and "+r+" are too far apart with stepSize of "+l+" "+s}for(d=f;d<r;d=+i.add(d,l,s)){c.push(d)}if(d===r||a.bounds==="ticks"){c.push(d)}return c}function zi(e,t,r,n,i){var a=0;var o=0;var s,l;if(i.offset&&t.length){s=Bi(e,"time",t[0],"pos");if(t.length===1){a=1-s}else{a=(Bi(e,"time",t[1],"pos")-s)/2}l=Bi(e,"time",t[t.length-1],"pos");if(t.length===1){o=l}else{o=(l-Bi(e,"time",t[t.length-2],"pos"))/2}}return{start:a,end:o,factor:1/(a+1+o)}}function qi(e,t,r,n){var i=e._adapter;var a=+i.startOf(t[0].value,n);var o=t[t.length-1].value;var s,l;for(s=a;s<=o;s=+i.add(s,1,n)){l=r[s];if(l>=0){t[l].major=true}}return t}function Yi(e,t,r){var n=[];var i={};var a=t.length;var o,s;for(o=0;o<a;++o){s=t[o];i[s]=o;n.push({value:s,major:false})}return a===0||!r?n:qi(e,n,i,r)}var Gi={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:false,unit:false,round:false,displayFormat:false,isoWeekday:false,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:false,source:"auto",major:{enabled:false}}};var Xi=Hn.extend({initialize:function(){this.mergeTicksOptions();Hn.prototype.initialize.call(this)},update:function(){var e=this;var t=e.options;var r=t.time||(t.time={});var n=e._adapter=new yn._date(t.adapters.date);Ti("time scale",r.format,"time.format","time.parser");Ti("time scale",r.min,"time.min","ticks.min");Ti("time scale",r.max,"time.max","ticks.max");ke.mergeIf(r.displayFormats,n.formats());return Hn.prototype.update.apply(e,arguments)},getRightValue:function(e){if(e&&e.t!==undefined){e=e.t}return Hn.prototype.getRightValue.call(this,e)},determineDataLimits:function(){var e=this;var t=e.chart;var r=e._adapter;var n=e.options;var i=n.time.unit||"day";var a=Ri;var o=Di;var s=[];var l=[];var u=[];var f,c,d,h,v,p,g;var m=e._getLabels();for(f=0,d=m.length;f<d;++f){u.push($i(e,m[f]))}for(f=0,d=(t.data.datasets||[]).length;f<d;++f){if(t.isDatasetVisible(f)){v=t.data.datasets[f].data;if(ke.isObject(v[0])){l[f]=[];for(c=0,h=v.length;c<h;++c){p=$i(e,v[c]);s.push(p);l[f][c]=p}}else{l[f]=u.slice(0);if(!g){s=s.concat(u);g=true}}}else{l[f]=[]}}if(u.length){a=Math.min(a,u[0]);o=Math.max(o,u[u.length-1])}if(s.length){s=d>1?Ni(s).sort(Ai):s.sort(Ai);a=Math.min(a,s[0]);o=Math.max(o,s[s.length-1])}a=$i(e,Mi(n))||a;o=$i(e,Li(n))||o;a=a===Ri?+r.startOf(Date.now(),i):a;o=o===Di?+r.endOf(Date.now(),i)+1:o;e.min=Math.min(a,o);e.max=Math.max(a+1,o);e._table=[];e._timestamps={data:s,datasets:l,labels:u}},buildTicks:function(){var e=this;var t=e.min;var r=e.max;var n=e.options;var i=n.ticks;var a=n.time;var o=e._timestamps;var s=[];var l=e.getLabelCapacity(t);var u=i.source;var f=n.distribution;var c,d,h;if(u==="data"||u==="auto"&&f==="series"){o=o.data}else if(u==="labels"){o=o.labels}else{o=Vi(e,t,r,l)}if(n.bounds==="ticks"&&o.length){t=o[0];r=o[o.length-1]}t=$i(e,Mi(n))||t;r=$i(e,Li(n))||r;for(c=0,d=o.length;c<d;++c){h=o[c];if(h>=t&&h<=r){s.push(h)}}e.min=t;e.max=r;e._unit=a.unit||(i.autoSkip?Wi(a.minUnit,e.min,e.max,l):Ui(e,s.length,a.minUnit,e.min,e.max));e._majorUnit=!i.major.enabled||e._unit==="year"?undefined:ji(e._unit);e._table=Pi(e._timestamps.data,t,r,f);e._offsets=zi(e._table,s,t,r,n);if(i.reverse){s.reverse()}return Yi(e,s,e._majorUnit)},getLabelForIndex:function(e,t){var r=this;var n=r._adapter;var i=r.chart.data;var a=r.options.time;var o=i.labels&&e<i.labels.length?i.labels[e]:"";var s=i.datasets[t].data[e];if(ke.isObject(s)){o=r.getRightValue(s)}if(a.tooltipFormat){return n.format(Hi(r,o),a.tooltipFormat)}if(typeof o==="string"){return o}return n.format(Hi(r,o),a.displayFormats.datetime)},tickFormatFunction:function(e,t,r,n){var i=this;var a=i._adapter;var o=i.options;var s=o.time.displayFormats;var l=s[i._unit];var u=i._majorUnit;var f=s[u];var c=r[t];var d=o.ticks;var h=u&&f&&c&&c.major;var v=a.format(e,n?n:h?f:l);var p=h?d.major:d.minor;var g=_i([p.callback,p.userCallback,d.callback,d.userCallback]);return g?g(v,t,r):v},convertTicksToLabels:function(e){var t=[];var r,n;for(r=0,n=e.length;r<n;++r){t.push(this.tickFormatFunction(e[r].value,r,e))}return t},getPixelForOffset:function(e){var t=this;var r=t._offsets;var n=Bi(t._table,"time",e,"pos");return t.getPixelForDecimal((r.start+n)*r.factor)},getPixelForValue:function(e,t,r){var n=this;var i=null;if(t!==undefined&&r!==undefined){i=n._timestamps.datasets[r][t]}if(i===null){i=$i(n,e)}if(i!==null){return n.getPixelForOffset(i)}},getPixelForTick:function(e){var t=this.getTicks();return e>=0&&e<t.length?this.getPixelForOffset(t[e].value):null},getValueForPixel:function(e){var t=this;var r=t._offsets;var n=t.getDecimalForPixel(e)/r.factor-r.end;var i=Bi(t._table,"pos",n,"time");return t._adapter._create(i)},_getLabelSize:function(e){var t=this;var r=t.options.ticks;var n=t.ctx.measureText(e).width;var i=ke.toRadians(t.isHorizontal()?r.maxRotation:r.minRotation);var a=Math.cos(i);var o=Math.sin(i);var s=xi(r.fontSize,de.global.defaultFontSize);return{w:n*a+s*o,h:n*o+s*a}},getLabelWidth:function(e){return this._getLabelSize(e).w},getLabelCapacity:function(e){var t=this;var r=t.options.time;var n=r.displayFormats;var i=n[r.unit]||n.millisecond;var a=t.tickFormatFunction(e,0,Yi(t,[e],t._majorUnit),i);var o=t._getLabelSize(a);var s=Math.floor(t.isHorizontal()?t.width/o.w:t.height/o.h);if(t.options.offset){s--}return s>0?s:1}});var Ki=Gi;Xi._defaults=Ki;var Ji={category:Un,linear:ei,logarithmic:si,radialLinear:Ei,time:Xi};var Qi=e(function(Ha,e){(function(e,t){Ha.exports=t()})(t,function(){var t;function u(){return t.apply(null,arguments)}function e(e){t=e}function o(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function s(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function l(e){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(e).length===0}else{var t;for(t in e){if(e.hasOwnProperty(t)){return false}}return true}}function a(e){return e===void 0}function f(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function i(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function r(e,t){var r=[],n;for(n=0;n<e.length;++n){r.push(t(e[n],n))}return r}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var r in t){if(c(t,r)){e[r]=t[r]}}if(c(t,"toString")){e.toString=t.toString}if(c(t,"valueOf")){e.valueOf=t.valueOf}return e}function h(e,t,r,n){return zr(e,t,r,n,true).utc()}function n(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function v(e){if(e._pf==null){e._pf=n()}return e._pf}var p;if(Array.prototype.some){p=Array.prototype.some}else{p=function(e){var t=Object(this);var r=t.length>>>0;for(var n=0;n<r;n++){if(n in t&&e.call(this,t[n],n,t)){return true}}return false}}function g(e){if(e._isValid==null){var t=v(e);var r=p.call(t.parsedDateParts,function(e){return e!=null});var n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict){n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(e)){e._isValid=n}else{return n}}return e._isValid}function m(e){var t=h(NaN);if(e!=null){d(v(t),e)}else{v(t).userInvalidated=true}return t}var y=u.momentProperties=[];function b(e,t){var r,n,i;if(!a(t._isAMomentObject)){e._isAMomentObject=t._isAMomentObject}if(!a(t._i)){e._i=t._i}if(!a(t._f)){e._f=t._f}if(!a(t._l)){e._l=t._l}if(!a(t._strict)){e._strict=t._strict}if(!a(t._tzm)){e._tzm=t._tzm}if(!a(t._isUTC)){e._isUTC=t._isUTC}if(!a(t._offset)){e._offset=t._offset}if(!a(t._pf)){e._pf=v(t)}if(!a(t._locale)){e._locale=t._locale}if(y.length>0){for(r=0;r<y.length;r++){n=y[r];i=t[n];if(!a(i)){e[n]=i}}}return e}var w=false;function C(e){b(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(w===false){w=true;u.updateOffset(this);w=false}}function S(e){return e instanceof C||e!=null&&e._isAMomentObject!=null}function E(e){if(e<0){return Math.ceil(e)||0}else{return Math.floor(e)}}function k(e){var t=+e,r=0;if(t!==0&&isFinite(t)){r=E(t)}return r}function T(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++){if(r&&e[o]!==t[o]||!r&&k(e[o])!==k(t[o])){a++}}return a+i}function _(e){if(u.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function x(i,a){var o=true;return d(function(){if(u.deprecationHandler!=null){u.deprecationHandler(null,i)}if(o){var e=[];var t;for(var r=0;r<arguments.length;r++){t="";if(typeof arguments[r]==="object"){t+="\n["+r+"] ";for(var n in arguments[0]){t+=n+": "+arguments[0][n]+", "}t=t.slice(0,-2)}else{t=arguments[r]}e.push(t)}_(i+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);o=false}return a.apply(this,arguments)},a)}var D={};function R(e,t){if(u.deprecationHandler!=null){u.deprecationHandler(e,t)}if(!D[e]){_(t);D[e]=true}}u.suppressDeprecationWarnings=false;u.deprecationHandler=null;function I(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function O(e){var t,r;for(r in e){t=e[r];if(I(t)){this[r]=t}else{this["_"+r]=t}}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function A(e,t){var r=d({},e),n;for(n in t){if(c(t,n)){if(s(e[n])&&s(t[n])){r[n]={};d(r[n],e[n]);d(r[n],t[n])}else if(t[n]!=null){r[n]=t[n]}else{delete r[n]}}}for(n in e){if(c(e,n)&&!c(t,n)&&s(e[n])){r[n]=d({},r[n])}}return r}function N(e){if(e!=null){this.set(e)}}var M;if(Object.keys){M=Object.keys}else{M=function(e){var t,r=[];for(t in e){if(c(e,t)){r.push(t)}}return r}}var L={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function P(e,t,r){var n=this._calendar[e]||this._calendar["sameElse"];return I(n)?n.call(t,r):n}var F={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function B(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];if(t||!r){return t}this._longDateFormat[e]=r.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)});return this._longDateFormat[e]}var H="Invalid date";function $(){return this._invalidDate}var W="%d";var U=/\d{1,2}/;function j(e){return this._ordinal.replace("%d",e)}var V={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function z(e,t,r,n){var i=this._relativeTime[r];return I(i)?i(e,t,r,n):i.replace(/%d/i,e)}function q(e,t){var r=this._relativeTime[e>0?"future":"past"];return I(r)?r(t):r.replace(/%s/i,t)}var Y={};function G(e,t){var r=e.toLowerCase();Y[r]=Y[r+"s"]=Y[t]=e}function X(e){return typeof e==="string"?Y[e]||Y[e.toLowerCase()]:undefined}function K(e){var t={},r,n;for(n in e){if(c(e,n)){r=X(n);if(r){t[r]=e[n]}}}return t}var J={};function Q(e,t){J[e]=t}function Z(e){var t=[];for(var r in e){t.push({unit:r,priority:J[r]})}t.sort(function(e,t){return e.priority-t.priority});return t}function ee(e,t,r){var n=""+Math.abs(e),i=t-n.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var te=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var re=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var ne={};var ie={};function ae(e,t,r,n){var i=n;if(typeof n==="string"){i=function(){return this[n]()}}if(e){ie[e]=i}if(t){ie[t[0]]=function(){return ee(i.apply(this,arguments),t[1],t[2])}}if(r){ie[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)}}}function oe(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function se(n){var i=n.match(te),e,a;for(e=0,a=i.length;e<a;e++){if(ie[i[e]]){i[e]=ie[i[e]]}else{i[e]=oe(i[e])}}return function(e){var t="",r;for(r=0;r<a;r++){t+=I(i[r])?i[r].call(e,n):i[r]}return t}}function le(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=ue(t,e.localeData());ne[t]=ne[t]||se(t);return ne[t](e)}function ue(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}re.lastIndex=0;while(r>=0&&re.test(e)){e=e.replace(re,n);re.lastIndex=0;r-=1}return e}var fe=/\d/;var ce=/\d\d/;var de=/\d{3}/;var he=/\d{4}/;var ve=/[+-]?\d{6}/;var pe=/\d\d?/;var ge=/\d\d\d\d?/;var me=/\d\d\d\d\d\d?/;var ye=/\d{1,3}/;var be=/\d{1,4}/;var we=/[+-]?\d{1,6}/;var Ce=/\d+/;var Se=/[+-]?\d+/;var Ee=/Z|[+-]\d\d:?\d\d/gi;var ke=/Z|[+-]\d\d(?::?\d\d)?/gi;var Te=/[+-]?\d+(\.\d{1,3})?/;var _e=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;var xe={};function De(e,r,n){xe[e]=I(r)?r:function(e,t){return e&&n?n:r}}function Re(e,t){if(!c(xe,e)){return new RegExp(Ie(e))}return xe[e](t._strict,t._locale)}function Ie(e){return Oe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,n,i){return t||r||n||i}))}function Oe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ae={};function Ne(e,r){var t,n=r;if(typeof e==="string"){e=[e]}if(f(r)){n=function(e,t){t[r]=k(e)}}for(t=0;t<e.length;t++){Ae[e[t]]=n}}function Me(e,i){Ne(e,function(e,t,r,n){r._w=r._w||{};i(e,r._w,r,n)})}function Le(e,t,r){if(t!=null&&c(Ae,e)){Ae[e](t,r._a,r,e)}}var Pe=0;var Fe=1;var Be=2;var He=3;var $e=4;var We=5;var Ue=6;var je=7;var Ve=8;ae("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e});ae(0,["YY",2],0,function(){return this.year()%100});ae(0,["YYYY",4],0,"year");ae(0,["YYYYY",5],0,"year");ae(0,["YYYYYY",6,true],0,"year");G("year","y");Q("year",1);De("Y",Se);De("YY",pe,ce);De("YYYY",be,he);De("YYYYY",we,ve);De("YYYYYY",we,ve);Ne(["YYYYY","YYYYYY"],Pe);Ne("YYYY",function(e,t){t[Pe]=e.length===2?u.parseTwoDigitYear(e):k(e)});Ne("YY",function(e,t){t[Pe]=u.parseTwoDigitYear(e)});Ne("Y",function(e,t){t[Pe]=parseInt(e,10)});function ze(e){return qe(e)?366:365}function qe(e){return e%4===0&&e%100!==0||e%400===0}u.parseTwoDigitYear=function(e){return k(e)+(k(e)>68?1900:2e3)};var Ye=Xe("FullYear",true);function Ge(){return qe(this.year())}function Xe(t,r){return function(e){if(e!=null){Je(this,t,e);u.updateOffset(this,r);return this}else{return Ke(this,t)}}}function Ke(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Je(e,t,r){if(e.isValid()&&!isNaN(r)){if(t==="FullYear"&&qe(e.year())&&e.month()===1&&e.date()===29){e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),rt(r,e.month()))}else{e._d["set"+(e._isUTC?"UTC":"")+t](r)}}}function Qe(e){e=X(e);if(I(this[e])){return this[e]()}return this}function Ze(e,t){if(typeof e==="object"){e=K(e);var r=Z(e);for(var n=0;n<r.length;n++){this[r[n].unit](e[r[n].unit])}}else{e=X(e);if(I(this[e])){return this[e](t)}}return this}function et(e,t){return(e%t+t)%t}var tt;if(Array.prototype.indexOf){tt=Array.prototype.indexOf}else{tt=function(e){var t;for(t=0;t<this.length;++t){if(this[t]===e){return t}}return-1}}function rt(e,t){if(isNaN(e)||isNaN(t)){return NaN}var r=et(t,12);e+=(t-r)/12;return r===1?qe(e)?29:28:31-r%7%2}ae("M",["MM",2],"Mo",function(){return this.month()+1});ae("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});ae("MMMM",0,0,function(e){return this.localeData().months(this,e)});G("month","M");Q("month",8);De("M",pe);De("MM",pe,ce);De("MMM",function(e,t){return t.monthsShortRegex(e)});De("MMMM",function(e,t){return t.monthsRegex(e)});Ne(["M","MM"],function(e,t){t[Fe]=k(e)-1});Ne(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);if(i!=null){t[Fe]=i}else{v(r).invalidMonth=e}});var nt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var it="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function at(e,t){if(!e){return o(this._months)?this._months:this._months["standalone"]}return o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nt).test(t)?"format":"standalone"][e.month()]}var ot="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function st(e,t){if(!e){return o(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nt.test(t)?"format":"standalone"][e.month()]}function lt(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(n=0;n<12;++n){a=h([2e3,n]);this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase();this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase()}}if(r){if(t==="MMM"){i=tt.call(this._shortMonthsParse,o);return i!==-1?i:null}else{i=tt.call(this._longMonthsParse,o);return i!==-1?i:null}}else{if(t==="MMM"){i=tt.call(this._shortMonthsParse,o);if(i!==-1){return i}i=tt.call(this._longMonthsParse,o);return i!==-1?i:null}else{i=tt.call(this._longMonthsParse,o);if(i!==-1){return i}i=tt.call(this._shortMonthsParse,o);return i!==-1?i:null}}}function ut(e,t,r){var n,i,a;if(this._monthsParseExact){return lt.call(this,e,t,r)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(n=0;n<12;n++){i=h([2e3,n]);if(r&&!this._longMonthsParse[n]){this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i");this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")}if(!r&&!this._monthsParse[n]){a="^"+this.months(i,"")+"|^"+this.monthsShort(i,"");this._monthsParse[n]=new RegExp(a.replace(".",""),"i")}if(r&&t==="MMMM"&&this._longMonthsParse[n].test(e)){return n}else if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e)){return n}else if(!r&&this._monthsParse[n].test(e)){return n}}}function ft(e,t){var r;if(!e.isValid()){return e}if(typeof t==="string"){if(/^\d+$/.test(t)){t=k(t)}else{t=e.localeData().monthsParse(t);if(!f(t)){return e}}}r=Math.min(e.date(),rt(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r);return e}function ct(e){if(e!=null){ft(this,e);u.updateOffset(this,true);return this}else{return Ke(this,"Month")}}function dt(){return rt(this.year(),this.month())}var ht=_e;function vt(e){if(this._monthsParseExact){if(!c(this,"_monthsRegex")){mt.call(this)}if(e){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!c(this,"_monthsShortRegex")){this._monthsShortRegex=ht}return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}var pt=_e;function gt(e){if(this._monthsParseExact){if(!c(this,"_monthsRegex")){mt.call(this)}if(e){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!c(this,"_monthsRegex")){this._monthsRegex=pt}return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function mt(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],i,a;for(i=0;i<12;i++){a=h([2e3,i]);t.push(this.monthsShort(a,""));r.push(this.months(a,""));n.push(this.months(a,""));n.push(this.monthsShort(a,""))}t.sort(e);r.sort(e);n.sort(e);for(i=0;i<12;i++){t[i]=Oe(t[i]);r[i]=Oe(r[i])}for(i=0;i<24;i++){n[i]=Oe(n[i])}this._monthsRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function yt(e,t,r,n,i,a,o){var s;if(e<100&&e>=0){s=new Date(e+400,t,r,n,i,a,o);if(isFinite(s.getFullYear())){s.setFullYear(e)}}else{s=new Date(e,t,r,n,i,a,o)}return s}function bt(e){var t;if(e<100&&e>=0){var r=Array.prototype.slice.call(arguments);r[0]=e+400;t=new Date(Date.UTC.apply(null,r));if(isFinite(t.getUTCFullYear())){t.setUTCFullYear(e)}}else{t=new Date(Date.UTC.apply(null,arguments))}return t}function wt(e,t,r){var n=7+t-r,i=(7+bt(e,0,n).getUTCDay()-t)%7;return-i+n-1}function Ct(e,t,r,n,i){var a=(7+r-n)%7,o=wt(e,n,i),s=1+7*(t-1)+a+o,l,u;if(s<=0){l=e-1;u=ze(l)+s}else if(s>ze(e)){l=e+1;u=s-ze(e)}else{l=e;u=s}return{year:l,dayOfYear:u}}function St(e,t,r){var n=wt(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;if(i<1){o=e.year()-1;a=i+Et(o,t,r)}else if(i>Et(e.year(),t,r)){a=i-Et(e.year(),t,r);o=e.year()+1}else{o=e.year();a=i}return{week:a,year:o}}function Et(e,t,r){var n=wt(e,t,r),i=wt(e+1,t,r);return(ze(e)-n+i)/7}ae("w",["ww",2],"wo","week");ae("W",["WW",2],"Wo","isoWeek");G("week","w");G("isoWeek","W");Q("week",5);Q("isoWeek",5);De("w",pe);De("ww",pe,ce);De("W",pe);De("WW",pe,ce);Me(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=k(e)});function kt(e){return St(e,this._week.dow,this._week.doy).week}var Tt={dow:0,doy:6};function _t(){return this._week.dow}function xt(){return this._week.doy}function Dt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Rt(e){var t=St(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}ae("d",0,"do","day");ae("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});ae("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});ae("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});ae("e",0,0,"weekday");ae("E",0,0,"isoWeekday");G("day","d");G("weekday","e");G("isoWeekday","E");Q("day",11);Q("weekday",11);Q("isoWeekday",11);De("d",pe);De("e",pe);De("E",pe);De("dd",function(e,t){return t.weekdaysMinRegex(e)});De("ddd",function(e,t){return t.weekdaysShortRegex(e)});De("dddd",function(e,t){return t.weekdaysRegex(e)});Me(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);if(i!=null){t.d=i}else{v(r).invalidWeekday=e}});Me(["d","e","E"],function(e,t,r,n){t[n]=k(e)});function It(e,t){if(typeof e!=="string"){return e}if(!isNaN(e)){return parseInt(e,10)}e=t.weekdaysParse(e);if(typeof e==="number"){return e}return null}function Ot(e,t){if(typeof e==="string"){return t.weekdaysParse(e)%7||7}return isNaN(e)?null:e}function At(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Nt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Mt(e,t){var r=o(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?At(r,this._week.dow):e?r[e.day()]:r}var Lt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Pt(e){return e===true?At(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}var Ft="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Bt(e){return e===true?At(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ht(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(n=0;n<7;++n){a=h([2e3,1]).day(n);this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase();this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase();this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase()}}if(r){if(t==="dddd"){i=tt.call(this._weekdaysParse,o);return i!==-1?i:null}else if(t==="ddd"){i=tt.call(this._shortWeekdaysParse,o);return i!==-1?i:null}else{i=tt.call(this._minWeekdaysParse,o);return i!==-1?i:null}}else{if(t==="dddd"){i=tt.call(this._weekdaysParse,o);if(i!==-1){return i}i=tt.call(this._shortWeekdaysParse,o);if(i!==-1){return i}i=tt.call(this._minWeekdaysParse,o);return i!==-1?i:null}else if(t==="ddd"){i=tt.call(this._shortWeekdaysParse,o);if(i!==-1){return i}i=tt.call(this._weekdaysParse,o);if(i!==-1){return i}i=tt.call(this._minWeekdaysParse,o);return i!==-1?i:null}else{i=tt.call(this._minWeekdaysParse,o);if(i!==-1){return i}i=tt.call(this._weekdaysParse,o);if(i!==-1){return i}i=tt.call(this._shortWeekdaysParse,o);return i!==-1?i:null}}}function $t(e,t,r){var n,i,a;if(this._weekdaysParseExact){return Ht.call(this,e,t,r)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(n=0;n<7;n++){i=h([2e3,1]).day(n);if(r&&!this._fullWeekdaysParse[n]){this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[n]){a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,"");this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")}if(r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e)){return n}else if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e)){return n}else if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e)){return n}else if(!r&&this._weekdaysParse[n].test(e)){return n}}}function Wt(e){if(!this.isValid()){return e!=null?this:NaN}var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=It(e,this.localeData());return this.add(e-t,"d")}else{return t}}function Ut(e){if(!this.isValid()){return e!=null?this:NaN}var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function jt(e){if(!this.isValid()){return e!=null?this:NaN}if(e!=null){var t=Ot(e,this.localeData());return this.day(this.day()%7?t:t-7)}else{return this.day()||7}}var Vt=_e;function zt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!c(this,"_weekdaysRegex")){this._weekdaysRegex=Vt}return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}var qt=_e;function Yt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!c(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=qt}return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var Gt=_e;function Xt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!c(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=Gt}return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function Kt(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++){o=h([2e3,1]).day(a);s=this.weekdaysMin(o,"");l=this.weekdaysShort(o,"");u=this.weekdays(o,"");t.push(s);r.push(l);n.push(u);i.push(s);i.push(l);i.push(u)}t.sort(e);r.sort(e);n.sort(e);i.sort(e);for(a=0;a<7;a++){r[a]=Oe(r[a]);n[a]=Oe(n[a]);i[a]=Oe(i[a])}this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Jt(){return this.hours()%12||12}function Qt(){return this.hours()||24}ae("H",["HH",2],0,"hour");ae("h",["hh",2],0,Jt);ae("k",["kk",2],0,Qt);ae("hmm",0,0,function(){return""+Jt.apply(this)+ee(this.minutes(),2)});ae("hmmss",0,0,function(){return""+Jt.apply(this)+ee(this.minutes(),2)+ee(this.seconds(),2)});ae("Hmm",0,0,function(){return""+this.hours()+ee(this.minutes(),2)});ae("Hmmss",0,0,function(){return""+this.hours()+ee(this.minutes(),2)+ee(this.seconds(),2)});function Zt(e,t){ae(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}Zt("a",true);Zt("A",false);G("hour","h");Q("hour",13);function er(e,t){return t._meridiemParse}De("a",er);De("A",er);De("H",pe);De("h",pe);De("k",pe);De("HH",pe,ce);De("hh",pe,ce);De("kk",pe,ce);De("hmm",ge);De("hmmss",me);De("Hmm",ge);De("Hmmss",me);Ne(["H","HH"],He);Ne(["k","kk"],function(e,t,r){var n=k(e);t[He]=n===24?0:n});Ne(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e);r._meridiem=e});Ne(["h","hh"],function(e,t,r){t[He]=k(e);v(r).bigHour=true});Ne("hmm",function(e,t,r){var n=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n));v(r).bigHour=true});Ne("hmmss",function(e,t,r){var n=e.length-4;var i=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n,2));t[We]=k(e.substr(i));v(r).bigHour=true});Ne("Hmm",function(e,t,r){var n=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n))});Ne("Hmmss",function(e,t,r){var n=e.length-4;var i=e.length-2;t[He]=k(e.substr(0,n));t[$e]=k(e.substr(n,2));t[We]=k(e.substr(i))});function tr(e){return(e+"").toLowerCase().charAt(0)==="p"}var rr=/[ap]\.?m?\.?/i;function nr(e,t,r){if(e>11){return r?"pm":"PM"}else{return r?"am":"AM"}}var ir=Xe("Hours",true);var ar={calendar:L,longDateFormat:F,invalidDate:H,ordinal:W,dayOfMonthOrdinalParse:U,relativeTime:V,months:it,monthsShort:ot,week:Tt,weekdays:Nt,weekdaysMin:Ft,weekdaysShort:Lt,meridiemParse:rr};var or={};var sr={};var lr;function ur(e){return e?e.toLowerCase().replace("_","-"):e}function fr(e){var t=0,r,n,i,a;while(t<e.length){a=ur(e[t]).split("-");r=a.length;n=ur(e[t+1]);n=n?n.split("-"):null;while(r>0){i=cr(a.slice(0,r).join("-"));if(i){return i}if(n&&n.length>=r&&T(a,n,true)>=r-1){break}r--}t++}return lr}function cr(e){var t=null;if(!or[e]&&"object"!=="undefined"&&Ha&&Ha.exports){try{t=lr._abbr;var r=$a;r("./locale/"+e);dr(t)}catch(e){}}return or[e]}function dr(e,t){var r;if(e){if(a(t)){r=pr(e)}else{r=hr(e,t)}if(r){lr=r}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+e+" not found. Did you forget to load it?")}}}return lr._abbr}function hr(e,t){if(t!==null){var r,n=ar;t.abbr=e;if(or[e]!=null){R("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");n=or[e]._config}else if(t.parentLocale!=null){if(or[t.parentLocale]!=null){n=or[t.parentLocale]._config}else{r=cr(t.parentLocale);if(r!=null){n=r._config}else{if(!sr[t.parentLocale]){sr[t.parentLocale]=[]}sr[t.parentLocale].push({name:e,config:t});return null}}}or[e]=new N(A(n,t));if(sr[e]){sr[e].forEach(function(e){hr(e.name,e.config)})}dr(e);return or[e]}else{delete or[e];return null}}function vr(e,t){if(t!=null){var r,n,i=ar;n=cr(e);if(n!=null){i=n._config}t=A(i,t);r=new N(t);r.parentLocale=or[e];or[e]=r;dr(e)}else{if(or[e]!=null){if(or[e].parentLocale!=null){or[e]=or[e].parentLocale}else if(or[e]!=null){delete or[e]}}}return or[e]}function pr(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return lr}if(!o(e)){t=cr(e);if(t){return t}e=[e]}return fr(e)}function gr(){return M(or)}function mr(e){var t;var r=e._a;if(r&&v(e).overflow===-2){t=r[Fe]<0||r[Fe]>11?Fe:r[Be]<1||r[Be]>rt(r[Pe],r[Fe])?Be:r[He]<0||r[He]>24||r[He]===24&&(r[$e]!==0||r[We]!==0||r[Ue]!==0)?He:r[$e]<0||r[$e]>59?$e:r[We]<0||r[We]>59?We:r[Ue]<0||r[Ue]>999?Ue:-1;if(v(e)._overflowDayOfYear&&(t<Pe||t>Be)){t=Be}if(v(e)._overflowWeeks&&t===-1){t=je}if(v(e)._overflowWeekday&&t===-1){t=Ve}v(e).overflow=t}return e}function yr(e,t,r){if(e!=null){return e}if(t!=null){return t}return r}function br(e){var t=new Date(u.now());if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}return[t.getFullYear(),t.getMonth(),t.getDate()]}function wr(e){var t,r,n=[],i,a,o;if(e._d){return}i=br(e);if(e._w&&e._a[Be]==null&&e._a[Fe]==null){Cr(e)}if(e._dayOfYear!=null){o=yr(e._a[Pe],i[Pe]);if(e._dayOfYear>ze(o)||e._dayOfYear===0){v(e)._overflowDayOfYear=true}r=bt(o,0,e._dayOfYear);e._a[Fe]=r.getUTCMonth();e._a[Be]=r.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=n[t]=i[t]}for(;t<7;t++){e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[He]===24&&e._a[$e]===0&&e._a[We]===0&&e._a[Ue]===0){e._nextDay=true;e._a[He]=0}e._d=(e._useUTC?bt:yt).apply(null,n);a=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[He]=24}if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==a){v(e).weekdayMismatch=true}}function Cr(e){var t,r,n,i,a,o,s,l;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){a=1;o=4;r=yr(t.GG,e._a[Pe],St(qr(),1,4).year);n=yr(t.W,1);i=yr(t.E,1);if(i<1||i>7){l=true}}else{a=e._locale._week.dow;o=e._locale._week.doy;var u=St(qr(),a,o);r=yr(t.gg,e._a[Pe],u.year);n=yr(t.w,u.week);if(t.d!=null){i=t.d;if(i<0||i>6){l=true}}else if(t.e!=null){i=t.e+a;if(t.e<0||t.e>6){l=true}}else{i=a}}if(n<1||n>Et(r,a,o)){v(e)._overflowWeeks=true}else if(l!=null){v(e)._overflowWeekday=true}else{s=Ct(r,n,i,a,o);e._a[Pe]=s.year;e._dayOfYear=s.dayOfYear}}var Sr=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var Er=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var kr=/Z|[+-]\d\d(?::?\d\d)?/;var Tr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]];var _r=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]];var xr=/^\/?Date\((\-?\d+)/i;function Dr(e){var t,r,n=e._i,i=Sr.exec(n)||Er.exec(n),a,o,s,l;if(i){v(e).iso=true;for(t=0,r=Tr.length;t<r;t++){if(Tr[t][1].exec(i[1])){o=Tr[t][0];a=Tr[t][2]!==false;break}}if(o==null){e._isValid=false;return}if(i[3]){for(t=0,r=_r.length;t<r;t++){if(_r[t][1].exec(i[3])){s=(i[2]||" ")+_r[t][0];break}}if(s==null){e._isValid=false;return}}if(!a&&s!=null){e._isValid=false;return}if(i[4]){if(kr.exec(i[4])){l="Z"}else{e._isValid=false;return}}e._f=o+(s||"")+(l||"");Br(e)}else{e._isValid=false}}var Rr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Ir(e,t,r,n,i,a){var o=[Or(e),ot.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];if(a){o.push(parseInt(a,10))}return o}function Or(e){var t=parseInt(e,10);if(t<=49){return 2e3+t}else if(t<=999){return 1900+t}return t}function Ar(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Nr(e,t,r){if(e){var n=Lt.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i){v(r).weekdayMismatch=true;r._isValid=false;return false}}return true}var Mr={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Lr(e,t,r){if(e){return Mr[e]}else if(t){return 0}else{var n=parseInt(r,10);var i=n%100,a=(n-i)/100;return a*60+i}}function Pr(e){var t=Rr.exec(Ar(e._i));if(t){var r=Ir(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Nr(t[1],r,e)){return}e._a=r;e._tzm=Lr(t[8],t[9],t[10]);e._d=bt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);v(e).rfc2822=true}else{e._isValid=false}}function Fr(e){var t=xr.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}Dr(e);if(e._isValid===false){delete e._isValid}else{return}Pr(e);if(e._isValid===false){delete e._isValid}else{return}u.createFromInputFallback(e)}u.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});u.ISO_8601=function(){};u.RFC_2822=function(){};function Br(e){if(e._f===u.ISO_8601){Dr(e);return}if(e._f===u.RFC_2822){Pr(e);return}e._a=[];v(e).empty=true;var t=""+e._i,r,n,i,a,o,s=t.length,l=0;i=ue(e._f,e._locale).match(te)||[];for(r=0;r<i.length;r++){a=i[r];n=(t.match(Re(a,e))||[])[0];if(n){o=t.substr(0,t.indexOf(n));if(o.length>0){v(e).unusedInput.push(o)}t=t.slice(t.indexOf(n)+n.length);l+=n.length}if(ie[a]){if(n){v(e).empty=false}else{v(e).unusedTokens.push(a)}Le(a,n,e)}else if(e._strict&&!n){v(e).unusedTokens.push(a)}}v(e).charsLeftOver=s-l;if(t.length>0){v(e).unusedInput.push(t)}if(e._a[He]<=12&&v(e).bigHour===true&&e._a[He]>0){v(e).bigHour=undefined}v(e).parsedDateParts=e._a.slice(0);v(e).meridiem=e._meridiem;e._a[He]=Hr(e._locale,e._a[He],e._meridiem);wr(e);mr(e)}function Hr(e,t,r){var n;if(r==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,r)}else if(e.isPM!=null){n=e.isPM(r);if(n&&t<12){t+=12}if(!n&&t===12){t=0}return t}else{return t}}function $r(e){var t,r,n,i,a;if(e._f.length===0){v(e).invalidFormat=true;e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){a=0;t=b({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._f=e._f[i];Br(t);if(!g(t)){continue}a+=v(t).charsLeftOver;a+=v(t).unusedTokens.length*10;v(t).score=a;if(n==null||a<n){n=a;r=t}}d(e,r||t)}function Wr(e){if(e._d){return}var t=K(e._i);e._a=r([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});wr(e)}function Ur(e){var t=new C(mr(jr(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function jr(e){var t=e._i,r=e._f;e._locale=e._locale||pr(e._l);if(t===null||r===undefined&&t===""){return m({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(S(t)){return new C(mr(t))}else if(i(t)){e._d=t}else if(o(r)){$r(e)}else if(r){Br(e)}else{Vr(e)}if(!g(e)){e._d=null}return e}function Vr(e){var t=e._i;if(a(t)){e._d=new Date(u.now())}else if(i(t)){e._d=new Date(t.valueOf())}else if(typeof t==="string"){Fr(e)}else if(o(t)){e._a=r(t.slice(0),function(e){return parseInt(e,10)});wr(e)}else if(s(t)){Wr(e)}else if(f(t)){e._d=new Date(t)}else{u.createFromInputFallback(e)}}function zr(e,t,r,n,i){var a={};if(r===true||r===false){n=r;r=undefined}if(s(e)&&l(e)||o(e)&&e.length===0){e=undefined}a._isAMomentObject=true;a._useUTC=a._isUTC=i;a._l=r;a._i=e;a._f=t;a._strict=n;return Ur(a)}function qr(e,t,r,n){return zr(e,t,r,n,false)}var Yr=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qr.apply(null,arguments);if(this.isValid()&&e.isValid()){return e<this?this:e}else{return m()}});var Gr=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qr.apply(null,arguments);if(this.isValid()&&e.isValid()){return e>this?this:e}else{return m()}});function Xr(e,t){var r,n;if(t.length===1&&o(t[0])){t=t[0]}if(!t.length){return qr()}r=t[0];for(n=1;n<t.length;++n){if(!t[n].isValid()||t[n][e](r)){r=t[n]}}return r}function Kr(){var e=[].slice.call(arguments,0);return Xr("isBefore",e)}function Jr(){var e=[].slice.call(arguments,0);return Xr("isAfter",e)}var Qr=function(){return Date.now?Date.now():+new Date};var Zr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function en(e){for(var t in e){if(!(tt.call(Zr,t)!==-1&&(e[t]==null||!isNaN(e[t])))){return false}}var r=false;for(var n=0;n<Zr.length;++n){if(e[Zr[n]]){if(r){return false}if(parseFloat(e[Zr[n]])!==k(e[Zr[n]])){r=true}}}return true}function tn(){return this._isValid}function rn(){return Tn(NaN)}function nn(e){var t=K(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=en(t);this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60;this._days=+o+a*7;this._months=+i+n*3+r*12;this._data={};this._locale=pr();this._bubble()}function an(e){return e instanceof nn}function on(e){if(e<0){return Math.round(-1*e)*-1}else{return Math.round(e)}}function sn(e,r){ae(e,0,0,function(){var e=this.utcOffset();var t="+";if(e<0){e=-e;t="-"}return t+ee(~~(e/60),2)+r+ee(~~e%60,2)})}sn("Z",":");sn("ZZ","");De("Z",ke);De("ZZ",ke);Ne(["Z","ZZ"],function(e,t,r){r._useUTC=true;r._tzm=un(ke,e)});var ln=/([\+\-]|\d\d)/gi;function un(e,t){var r=(t||"").match(e);if(r===null){return null}var n=r[r.length-1]||[];var i=(n+"").match(ln)||["-",0,0];var a=+(i[1]*60)+k(i[2]);return a===0?0:i[0]==="+"?a:-a}function fn(e,t){var r,n;if(t._isUTC){r=t.clone();n=(S(e)||i(e)?e.valueOf():qr(e).valueOf())-r.valueOf();r._d.setTime(r._d.valueOf()+n);u.updateOffset(r,false);return r}else{return qr(e).local()}}function cn(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}u.updateOffset=function(){};function dn(e,t,r){var n=this._offset||0,i;if(!this.isValid()){return e!=null?this:NaN}if(e!=null){if(typeof e==="string"){e=un(ke,e);if(e===null){return this}}else if(Math.abs(e)<16&&!r){e=e*60}if(!this._isUTC&&t){i=cn(this)}this._offset=e;this._isUTC=true;if(i!=null){this.add(i,"m")}if(n!==e){if(!t||this._changeInProgress){In(this,Tn(e-n,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;u.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?n:cn(this)}}function hn(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}function vn(e){return this.utcOffset(0,e)}function pn(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(cn(this),"m")}}return this}function gn(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var e=un(Ee,this._i);if(e!=null){this.utcOffset(e)}else{this.utcOffset(0,true)}}return this}function mn(e){if(!this.isValid()){return false}e=e?qr(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function yn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bn(){if(!a(this._isDSTShifted)){return this._isDSTShifted}var e={};b(e,this);e=jr(e);if(e._a){var t=e._isUTC?h(e._a):qr(e._a);this._isDSTShifted=this.isValid()&&T(e._a,t.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function wn(){return this.isValid()?!this._isUTC:false}function Cn(){return this.isValid()?this._isUTC:false}function Sn(){return this.isValid()?this._isUTC&&this._offset===0:false}var En=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var kn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Tn(e,t){var r=e,n=null,i,a,o;if(an(e)){r={ms:e._milliseconds,d:e._days,M:e._months}}else if(f(e)){r={};if(t){r[t]=e}else{r.milliseconds=e}}else if(!!(n=En.exec(e))){i=n[1]==="-"?-1:1;r={y:0,d:k(n[Be])*i,h:k(n[He])*i,m:k(n[$e])*i,s:k(n[We])*i,ms:k(on(n[Ue]*1e3))*i}}else if(!!(n=kn.exec(e))){i=n[1]==="-"?-1:1;r={y:_n(n[2],i),M:_n(n[3],i),w:_n(n[4],i),d:_n(n[5],i),h:_n(n[6],i),m:_n(n[7],i),s:_n(n[8],i)}}else if(r==null){r={}}else if(typeof r==="object"&&("from"in r||"to"in r)){o=Dn(qr(r.from),qr(r.to));r={};r.ms=o.milliseconds;r.M=o.months}a=new nn(r);if(an(e)&&c(e,"_locale")){a._locale=e._locale}return a}Tn.fn=nn.prototype;Tn.invalid=rn;function _n(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function xn(e,t){var r={};r.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(r.months,"M").isAfter(t)){--r.months}r.milliseconds=+t-+e.clone().add(r.months,"M");return r}function Dn(e,t){var r;if(!(e.isValid()&&t.isValid())){return{milliseconds:0,months:0}}t=fn(t,e);if(e.isBefore(t)){r=xn(e,t)}else{r=xn(t,e);r.milliseconds=-r.milliseconds;r.months=-r.months}return r}function Rn(i,a){return function(e,t){var r,n;if(t!==null&&!isNaN(+t)){R(a,"moment()."+a+"(period, number) is deprecated. Please use moment()."+a+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");n=e;e=t;t=n}e=typeof e==="string"?+e:e;r=Tn(e,t);In(this,r,i);return this}}function In(e,t,r,n){var i=t._milliseconds,a=on(t._days),o=on(t._months);if(!e.isValid()){return}n=n==null?true:n;if(o){ft(e,Ke(e,"Month")+o*r)}if(a){Je(e,"Date",Ke(e,"Date")+a*r)}if(i){e._d.setTime(e._d.valueOf()+i*r)}if(n){u.updateOffset(e,a||o)}}var On=Rn(1,"add");var An=Rn(-1,"subtract");function Nn(e,t){var r=e.diff(t,"days",true);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Mn(e,t){var r=e||qr(),n=fn(r,this).startOf("day"),i=u.calendarFormat(this,n)||"sameElse";var a=t&&(I(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,qr(r)))}function Ln(){return new C(this)}function Pn(e,t){var r=S(e)?e:qr(e);if(!(this.isValid()&&r.isValid())){return false}t=X(t)||"millisecond";if(t==="millisecond"){return this.valueOf()>r.valueOf()}else{return r.valueOf()<this.clone().startOf(t).valueOf()}}function Fn(e,t){var r=S(e)?e:qr(e);if(!(this.isValid()&&r.isValid())){return false}t=X(t)||"millisecond";if(t==="millisecond"){return this.valueOf()<r.valueOf()}else{return this.clone().endOf(t).valueOf()<r.valueOf()}}function Bn(e,t,r,n){var i=S(e)?e:qr(e),a=S(t)?t:qr(t);if(!(this.isValid()&&i.isValid()&&a.isValid())){return false}n=n||"()";return(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))}function Hn(e,t){var r=S(e)?e:qr(e),n;if(!(this.isValid()&&r.isValid())){return false}t=X(t)||"millisecond";if(t==="millisecond"){return this.valueOf()===r.valueOf()}else{n=r.valueOf();return this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()}}function $n(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Wn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Un(e,t,r){var n,i,a;if(!this.isValid()){return NaN}n=fn(e,this);if(!n.isValid()){return NaN}i=(n.utcOffset()-this.utcOffset())*6e4;t=X(t);switch(t){case"year":a=jn(this,n)/12;break;case"month":a=jn(this,n);break;case"quarter":a=jn(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:E(a)}function jn(e,t){var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,a;if(t-n<0){i=e.clone().add(r-1,"months");a=(t-n)/(n-i)}else{i=e.clone().add(r+1,"months");a=(t-n)/(i-n)}return-(r+a)||0}u.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";u.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Vn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function zn(e){if(!this.isValid()){return null}var t=e!==true;var r=t?this.clone().utc():this;if(r.year()<0||r.year()>9999){return le(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(I(Date.prototype.toISOString)){if(t){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",le(r,"Z"))}}return le(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function qn(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var e="moment";var t="";if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}var r="["+e+'("]';var n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var i="-MM-DD[T]HH:mm:ss.SSS";var a=t+'[")]';return this.format(r+n+i+a)}function Yn(e){if(!e){e=this.isUtc()?u.defaultFormatUtc:u.defaultFormat}var t=le(this,e);return this.localeData().postformat(t)}function Gn(e,t){if(this.isValid()&&(S(e)&&e.isValid()||qr(e).isValid())){return Tn({to:this,from:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function Xn(e){return this.from(qr(),e)}function Kn(e,t){if(this.isValid()&&(S(e)&&e.isValid()||qr(e).isValid())){return Tn({from:this,to:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function Jn(e){return this.to(qr(),e)}function Qn(e){var t;if(e===undefined){return this._locale._abbr}else{t=pr(e);if(t!=null){this._locale=t}return this}}var Zn=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined){return this.localeData()}else{return this.locale(e)}});function ei(){return this._locale}var ti=1e3;var ri=60*ti;var ni=60*ri;var ii=(365*400+97)*24*ni;function ai(e,t){return(e%t+t)%t}function oi(e,t,r){if(e<100&&e>=0){return new Date(e+400,t,r)-ii}else{return new Date(e,t,r).valueOf()}}function si(e,t,r){if(e<100&&e>=0){return Date.UTC(e+400,t,r)-ii}else{return Date.UTC(e,t,r)}}function li(e){var t;e=X(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}var r=this._isUTC?si:oi;switch(e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=ai(t+(this._isUTC?0:this.utcOffset()*ri),ni);break;case"minute":t=this._d.valueOf();t-=ai(t,ri);break;case"second":t=this._d.valueOf();t-=ai(t,ti);break}this._d.setTime(t);u.updateOffset(this,true);return this}function ui(e){var t;e=X(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}var r=this._isUTC?si:oi;switch(e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=ni-ai(t+(this._isUTC?0:this.utcOffset()*ri),ni)-1;break;case"minute":t=this._d.valueOf();t+=ri-ai(t,ri)-1;break;case"second":t=this._d.valueOf();t+=ti-ai(t,ti)-1;break}this._d.setTime(t);u.updateOffset(this,true);return this}function fi(){return this._d.valueOf()-(this._offset||0)*6e4}function ci(){return Math.floor(this.valueOf()/1e3)}function di(){return new Date(this.valueOf())}function hi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function vi(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function pi(){return this.isValid()?this.toISOString():null}function gi(){return g(this)}function mi(){return d({},v(this))}function yi(){return v(this).overflow}function bi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ae(0,["gg",2],0,function(){return this.weekYear()%100});ae(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wi(e,t){ae(0,[e,e.length],0,t)}wi("gggg","weekYear");wi("ggggg","weekYear");wi("GGGG","isoWeekYear");wi("GGGGG","isoWeekYear");G("weekYear","gg");G("isoWeekYear","GG");Q("weekYear",1);Q("isoWeekYear",1);De("G",Se);De("g",Se);De("GG",pe,ce);De("gg",pe,ce);De("GGGG",be,he);De("gggg",be,he);De("GGGGG",we,ve);De("ggggg",we,ve);Me(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=k(e)});Me(["gg","GG"],function(e,t,r,n){t[n]=u.parseTwoDigitYear(e)});function Ci(e){return Ti.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Si(e){return Ti.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ei(){return Et(this.year(),1,4)}function ki(){var e=this.localeData()._week;return Et(this.year(),e.dow,e.doy)}function Ti(e,t,r,n,i){var a;if(e==null){return St(this,n,i).year}else{a=Et(e,n,i);if(t>a){t=a}return _i.call(this,e,t,r,n,i)}}function _i(e,t,r,n,i){var a=Ct(e,t,r,n,i),o=bt(a.year,0,a.dayOfYear);this.year(o.getUTCFullYear());this.month(o.getUTCMonth());this.date(o.getUTCDate());return this}ae("Q",0,"Qo","quarter");G("quarter","Q");Q("quarter",7);De("Q",fe);Ne("Q",function(e,t){t[Fe]=(k(e)-1)*3});function xi(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}ae("D",["DD",2],"Do","date");G("date","D");Q("date",9);De("D",pe);De("DD",pe,ce);De("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Ne(["D","DD"],Be);Ne("Do",function(e,t){t[Be]=k(e.match(pe)[0])});var Di=Xe("Date",true);ae("DDD",["DDDD",3],"DDDo","dayOfYear");G("dayOfYear","DDD");Q("dayOfYear",4);De("DDD",ye);De("DDDD",de);Ne(["DDD","DDDD"],function(e,t,r){r._dayOfYear=k(e)});function Ri(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}ae("m",["mm",2],0,"minute");G("minute","m");Q("minute",14);De("m",pe);De("mm",pe,ce);Ne(["m","mm"],$e);var Ii=Xe("Minutes",false);ae("s",["ss",2],0,"second");G("second","s");Q("second",15);De("s",pe);De("ss",pe,ce);Ne(["s","ss"],We);var Oi=Xe("Seconds",false);ae("S",0,0,function(){return~~(this.millisecond()/100)});ae(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ae(0,["SSS",3],0,"millisecond");ae(0,["SSSS",4],0,function(){return this.millisecond()*10});ae(0,["SSSSS",5],0,function(){return this.millisecond()*100});ae(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ae(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ae(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ae(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});G("millisecond","ms");Q("millisecond",16);De("S",ye,fe);De("SS",ye,ce);De("SSS",ye,de);var Ai;for(Ai="SSSS";Ai.length<=9;Ai+="S"){De(Ai,Ce)}function Ni(e,t){t[Ue]=k(("0."+e)*1e3)}for(Ai="S";Ai.length<=9;Ai+="S"){Ne(Ai,Ni)}var Mi=Xe("Milliseconds",false);ae("z",0,0,"zoneAbbr");ae("zz",0,0,"zoneName");function Li(){return this._isUTC?"UTC":""}function Pi(){return this._isUTC?"Coordinated Universal Time":""}var Fi=C.prototype;Fi.add=On;Fi.calendar=Mn;Fi.clone=Ln;Fi.diff=Un;Fi.endOf=ui;Fi.format=Yn;Fi.from=Gn;Fi.fromNow=Xn;Fi.to=Kn;Fi.toNow=Jn;Fi.get=Qe;Fi.invalidAt=yi;Fi.isAfter=Pn;Fi.isBefore=Fn;Fi.isBetween=Bn;Fi.isSame=Hn;Fi.isSameOrAfter=$n;Fi.isSameOrBefore=Wn;Fi.isValid=gi;Fi.lang=Zn;Fi.locale=Qn;Fi.localeData=ei;Fi.max=Gr;Fi.min=Yr;Fi.parsingFlags=mi;Fi.set=Ze;Fi.startOf=li;Fi.subtract=An;Fi.toArray=hi;Fi.toObject=vi;Fi.toDate=di;Fi.toISOString=zn;Fi.inspect=qn;Fi.toJson=pi;Fi.toString=Vn;Fi.unix=ci;Fi.valueOf=fi;Fi.creationData=bi;Fi.year=Ye;Fi.isLeapYear=Ge;Fi.weekYear=Ci;Fi.isoWeekYear=Si;Fi.quarter=Fi.quarters=xi;Fi.month=ct;Fi.daysInMonth=dt;Fi.week=Fi.weeks=Dt;Fi.isoWeek=Fi.isoWeeks=Rt;Fi.weeksInYear=ki;Fi.isoWeeksInYear=Ei;Fi.date=Di;Fi.day=Fi.days=Wt;Fi.weekday=Ut;Fi.isoWeekday=jt;Fi.dayOfYear=Ri;Fi.hour=Fi.hours=ir;Fi.minute=Fi.minutes=Ii;Fi.second=Fi.seconds=Oi;Fi.millisecond=Fi.milliseconds=Mi;Fi.utcOffset=dn;Fi.utc=vn;Fi.local=pn;Fi.parseZone=gn;Fi.hasAlignedHourOffset=mn;Fi.isDST=yn;Fi.isLocal=wn;Fi.isUtcOffset=Cn;Fi.isUtc=Sn;Fi.isUTC=Sn;Fi.zoneAbbr=Li;Fi.zoneName=Pi;Fi.dates=x("dates accessor is deprecated. Use date instead.",Di);Fi.months=x("months accessor is deprecated. Use month instead",ct);Fi.years=x("years accessor is deprecated. Use year instead",Ye);Fi.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hn);Fi.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bn);function Bi(e){return qr(e*1e3)}function Hi(){return qr.apply(null,arguments).parseZone()}function $i(e){return e}var Wi=N.prototype;Wi.calendar=P;Wi.longDateFormat=B;Wi.invalidDate=$;Wi.ordinal=j;Wi.preparse=$i;Wi.postformat=$i;Wi.relativeTime=z;Wi.pastFuture=q;Wi.set=O;Wi.months=at;Wi.monthsShort=st;Wi.monthsParse=ut;Wi.monthsRegex=gt;Wi.monthsShortRegex=vt;Wi.week=kt;Wi.firstDayOfYear=xt;Wi.firstDayOfWeek=_t;Wi.weekdays=Mt;Wi.weekdaysMin=Bt;Wi.weekdaysShort=Pt;Wi.weekdaysParse=$t;Wi.weekdaysRegex=zt;Wi.weekdaysShortRegex=Yt;Wi.weekdaysMinRegex=Xt;Wi.isPM=tr;Wi.meridiem=nr;function Ui(e,t,r,n){var i=pr();var a=h().set(n,t);return i[r](a,e)}function ji(e,t,r){if(f(e)){t=e;e=undefined}e=e||"";if(t!=null){return Ui(e,t,r,"month")}var n;var i=[];for(n=0;n<12;n++){i[n]=Ui(e,n,r,"month")}return i}function Vi(e,t,r,n){if(typeof e==="boolean"){if(f(t)){r=t;t=undefined}t=t||""}else{t=e;r=t;e=false;if(f(t)){r=t;t=undefined}t=t||""}var i=pr(),a=e?i._week.dow:0;if(r!=null){return Ui(t,(r+a)%7,n,"day")}var o;var s=[];for(o=0;o<7;o++){s[o]=Ui(t,(o+a)%7,n,"day")}return s}function zi(e,t){return ji(e,t,"months")}function qi(e,t){return ji(e,t,"monthsShort")}function Yi(e,t,r){return Vi(e,t,r,"weekdays")}function Gi(e,t,r){return Vi(e,t,r,"weekdaysShort")}function Xi(e,t,r){return Vi(e,t,r,"weekdaysMin")}dr("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=k(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});u.lang=x("moment.lang is deprecated. Use moment.locale instead.",dr);u.langData=x("moment.langData is deprecated. Use moment.localeData instead.",pr);var Ki=Math.abs;function Ji(){var e=this._data;this._milliseconds=Ki(this._milliseconds);this._days=Ki(this._days);this._months=Ki(this._months);e.milliseconds=Ki(e.milliseconds);e.seconds=Ki(e.seconds);e.minutes=Ki(e.minutes);e.hours=Ki(e.hours);e.months=Ki(e.months);e.years=Ki(e.years);return this}function Qi(e,t,r,n){var i=Tn(t,r);e._milliseconds+=n*i._milliseconds;e._days+=n*i._days;e._months+=n*i._months;return e._bubble()}function Zi(e,t){return Qi(this,e,t,1)}function ea(e,t){return Qi(this,e,t,-1)}function ta(e){if(e<0){return Math.floor(e)}else{return Math.ceil(e)}}function ra(){var e=this._milliseconds;var t=this._days;var r=this._months;var n=this._data;var i,a,o,s,l;if(!(e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0)){e+=ta(ia(r)+t)*864e5;t=0;r=0}n.milliseconds=e%1e3;i=E(e/1e3);n.seconds=i%60;a=E(i/60);n.minutes=a%60;o=E(a/60);n.hours=o%24;t+=E(o/24);l=E(na(t));r+=l;t-=ta(ia(l));s=E(r/12);r%=12;n.days=t;n.months=r;n.years=s;return this}function na(e){return e*4800/146097}function ia(e){return e*146097/4800}function aa(e){if(!this.isValid()){return NaN}var t;var r;var n=this._milliseconds;e=X(e);if(e==="month"||e==="quarter"||e==="year"){t=this._days+n/864e5;r=this._months+na(t);switch(e){case"month":return r;case"quarter":return r/3;case"year":return r/12}}else{t=this._days+Math.round(ia(this._months));switch(e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}}function oa(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+k(this._months/12)*31536e6}function sa(e){return function(){return this.as(e)}}var la=sa("ms");var ua=sa("s");var fa=sa("m");var ca=sa("h");var da=sa("d");var ha=sa("w");var va=sa("M");var pa=sa("Q");var ga=sa("y");function ma(){return Tn(this)}function ya(e){e=X(e);return this.isValid()?this[e+"s"]():NaN}function ba(e){return function(){return this.isValid()?this._data[e]:NaN}}var wa=ba("milliseconds");var Ca=ba("seconds");var Sa=ba("minutes");var Ea=ba("hours");var ka=ba("days");var Ta=ba("months");var _a=ba("years");function xa(){return E(this.days()/7)}var Da=Math.round;var Ra={ss:44,s:45,m:45,h:22,d:26,M:11};function Ia(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function Oa(e,t,r){var n=Tn(e).abs();var i=Da(n.as("s"));var a=Da(n.as("m"));var o=Da(n.as("h"));var s=Da(n.as("d"));var l=Da(n.as("M"));var u=Da(n.as("y"));var f=i<=Ra.ss&&["s",i]||i<Ra.s&&["ss",i]||a<=1&&["m"]||a<Ra.m&&["mm",a]||o<=1&&["h"]||o<Ra.h&&["hh",o]||s<=1&&["d"]||s<Ra.d&&["dd",s]||l<=1&&["M"]||l<Ra.M&&["MM",l]||u<=1&&["y"]||["yy",u];f[2]=t;f[3]=+e>0;f[4]=r;return Ia.apply(null,f)}function Aa(e){if(e===undefined){return Da}if(typeof e==="function"){Da=e;return true}return false}function Na(e,t){if(Ra[e]===undefined){return false}if(t===undefined){return Ra[e]}Ra[e]=t;if(e==="s"){Ra.ss=t-1}return true}function Ma(e){if(!this.isValid()){return this.localeData().invalidDate()}var t=this.localeData();var r=Oa(this,!e,t);if(e){r=t.pastFuture(+this,r)}return t.postformat(r)}var La=Math.abs;function Pa(e){return(e>0)-(e<0)||+e}function Fa(){if(!this.isValid()){return this.localeData().invalidDate()}var e=La(this._milliseconds)/1e3;var t=La(this._days);var r=La(this._months);var n,i,a;n=E(e/60);i=E(n/60);e%=60;n%=60;a=E(r/12);r%=12;var o=a;var s=r;var l=t;var u=i;var f=n;var c=e?e.toFixed(3).replace(/\.?0+$/,""):"";var d=this.asSeconds();if(!d){return"P0D"}var h=d<0?"-":"";var v=Pa(this._months)!==Pa(d)?"-":"";var p=Pa(this._days)!==Pa(d)?"-":"";var g=Pa(this._milliseconds)!==Pa(d)?"-":"";return h+"P"+(o?v+o+"Y":"")+(s?v+s+"M":"")+(l?p+l+"D":"")+(u||f||c?"T":"")+(u?g+u+"H":"")+(f?g+f+"M":"")+(c?g+c+"S":"")}var Ba=nn.prototype;Ba.isValid=tn;Ba.abs=Ji;Ba.add=Zi;Ba.subtract=ea;Ba.as=aa;Ba.asMilliseconds=la;Ba.asSeconds=ua;Ba.asMinutes=fa;Ba.asHours=ca;Ba.asDays=da;Ba.asWeeks=ha;Ba.asMonths=va;Ba.asQuarters=pa;Ba.asYears=ga;Ba.valueOf=oa;Ba._bubble=ra;Ba.clone=ma;Ba.get=ya;Ba.milliseconds=wa;Ba.seconds=Ca;Ba.minutes=Sa;Ba.hours=Ea;Ba.days=ka;Ba.weeks=xa;Ba.months=Ta;Ba.years=_a;Ba.humanize=Ma;Ba.toISOString=Fa;Ba.toString=Fa;Ba.toJson=Fa;Ba.locale=Qn;Ba.localeData=ei;Ba.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Fa);Ba.lang=Zn;ae("X",0,0,"unix");ae("x",0,0,"valueOf");De("x",Se);De("X",Te);Ne("X",function(e,t,r){r._d=new Date(parseFloat(e,10)*1e3)});Ne("x",function(e,t,r){r._d=new Date(k(e))});u.version="2.24.0";e(qr);u.fn=Fi;u.min=Kr;u.max=Jr;u.now=Qr;u.utc=h;u.unix=Bi;u.months=zi;u.isDate=i;u.locale=dr;u.invalid=m;u.duration=Tn;u.isMoment=S;u.weekdays=Yi;u.parseZone=Hi;u.localeData=pr;u.isDuration=an;u.monthsShort=qi;u.weekdaysMin=Xi;u.defineLocale=hr;u.updateLocale=vr;u.locales=gr;u.weekdaysShort=Gi;u.normalizeUnits=X;u.relativeTimeRounding=Aa;u.relativeTimeThreshold=Na;u.calendarFormat=Nn;u.prototype=Fi;u.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return u})});var Zi={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};yn._date.override(typeof Qi==="function"?{_id:"moment",formats:function(){return Zi},parse:function(e,t){if(typeof e==="string"&&typeof t==="string"){e=Qi(e,t)}else if(!(e instanceof Qi)){e=Qi(e)}return e.isValid()?e.valueOf():null},format:function(e,t){return Qi(e).format(t)},add:function(e,t,r){return Qi(e).add(t,r).valueOf()},diff:function(e,t,r){return Qi(e).diff(Qi(t),r)},startOf:function(e,t,r){e=Qi(e);if(t==="isoWeek"){return e.isoWeekday(r).valueOf()}return e.startOf(t).valueOf()},endOf:function(e,t){return Qi(e).endOf(t).valueOf()},_create:function(e){return Qi(e)}}:{});de._set("global",{plugins:{filler:{propagate:true}}});var ea={dataset:function(e){var t=e.fill;var r=e.chart;var n=r.getDatasetMeta(t);var i=n&&r.isDatasetVisible(t);var a=i&&n.dataset._children||[];var o=a.length||0;return!o?null:function(e,t){return t<o&&a[t]._view||null}},boundary:function(e){var r=e.boundary;var t=r?r.x:null;var n=r?r.y:null;if(ke.isArray(r)){return function(e,t){return r[t]}}return function(e){return{x:t===null?e.x:t,y:n===null?e.y:n}}}};function ta(e,t,r){var n=e._model||{};var i=n.fill;var a;if(i===undefined){i=!!n.backgroundColor}if(i===false||i===null){return false}if(i===true){return"origin"}a=parseFloat(i,10);if(isFinite(a)&&Math.floor(a)===a){if(i[0]==="-"||i[0]==="+"){a=t+a}if(a===t||a<0||a>=r){return false}return a}switch(i){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return i;default:return false}}function ra(e){var t=e.el._model||{};var r=e.el._scale||{};var n=e.fill;var i=null;var a;if(isFinite(n)){return null}if(n==="start"){i=t.scaleBottom===undefined?r.bottom:t.scaleBottom}else if(n==="end"){i=t.scaleTop===undefined?r.top:t.scaleTop}else if(t.scaleZero!==undefined){i=t.scaleZero}else if(r.getBasePixel){i=r.getBasePixel()}if(i!==undefined&&i!==null){if(i.x!==undefined&&i.y!==undefined){return i}if(ke.isFinite(i)){a=r.isHorizontal();return{x:a?i:null,y:a?null:i}}}return null}function na(e){var t=e.el._scale;var r=t.options;var n=t.chart.data.labels.length;var i=e.fill;var a=[];var o,s,l,u,f;if(!n){return null}o=r.ticks.reverse?t.max:t.min;s=r.ticks.reverse?t.min:t.max;l=t.getPointPositionForValue(0,o);for(u=0;u<n;++u){f=i==="start"||i==="end"?t.getPointPositionForValue(u,i==="start"?o:s):t.getBasePosition(u);if(r.gridLines.circular){f.cx=l.x;f.cy=l.y;f.angle=t.getIndexAngle(u)-Math.PI/2}a.push(f)}return a}function ia(e){var t=e.el._scale||{};if(t.getPointPositionForValue){return na(e)}return ra(e)}function aa(e,t,r){var n=e[t];var i=n.fill;var a=[t];var o;if(!r){return i}while(i!==false&&a.indexOf(i)===-1){if(!isFinite(i)){return i}o=e[i];if(!o){return false}if(o.visible){return i}a.push(i);i=o.fill}return false}function oa(e){var t=e.fill;var r="dataset";if(t===false){return null}if(!isFinite(t)){r="boundary"}return ea[r](e)}function sa(e){return e&&!e.skip}function la(e,t,r,n,i){var a,o,s,l;if(!n||!i){return}e.moveTo(t[0].x,t[0].y);for(a=1;a<n;++a){ke.canvas.lineTo(e,t[a-1],t[a])}if(r[0].angle!==undefined){o=r[0].cx;s=r[0].cy;l=Math.sqrt(Math.pow(r[0].x-o,2)+Math.pow(r[0].y-s,2));for(a=i-1;a>0;--a){e.arc(o,s,l,r[a].angle,r[a-1].angle,true)}return}e.lineTo(r[i-1].x,r[i-1].y);for(a=i-1;a>0;--a){ke.canvas.lineTo(e,r[a],r[a-1],true)}}function ua(e,t,r,n,i,a){var o=t.length;var s=n.spanGaps;var l=[];var u=[];var f=0;var c=0;var d,h,v,p,g,m,y,b;e.beginPath();for(d=0,h=o;d<h;++d){v=d%o;p=t[v]._view;g=r(p,v,n);m=sa(p);y=sa(g);if(a&&b===undefined&&m){b=d+1;h=o+b}if(m&&y){f=l.push(p);c=u.push(g)}else if(f&&c){if(!s){la(e,l,u,f,c);f=c=0;l=[];u=[]}else{if(m){l.push(p)}if(y){u.push(g)}}}}la(e,l,u,f,c);e.closePath();e.fillStyle=i;e.fill()}var fa={id:"filler",afterDatasetsUpdate:function(e,t){var r=(e.data.datasets||[]).length;var n=t.propagate;var i=[];var a,o,s,l;for(o=0;o<r;++o){a=e.getDatasetMeta(o);s=a.dataset;l=null;if(s&&s._model&&s instanceof ft.Line){l={visible:e.isDatasetVisible(o),fill:ta(s,o,r),chart:e,el:s}}a.$filler=l;i.push(l)}for(o=0;o<r;++o){l=i[o];if(!l){continue}l.fill=aa(i,o,n);l.boundary=ia(l);l.mapper=oa(l)}},beforeDatasetsDraw:function(e){var t=e._getSortedVisibleDatasetMetas();var r=e.ctx;var n,i,a,o,s,l,u;for(i=t.length-1;i>=0;--i){n=t[i].$filler;if(!n||!n.visible){continue}a=n.el;o=a._view;s=a._children||[];l=n.mapper;u=o.backgroundColor||de.global.defaultColor;if(l&&u&&s.length){ke.canvas.clipArea(r,e.chartArea);ua(r,s,l,o,u,a._loop);ke.canvas.unclipArea(r)}}}};var ca=ke.rtl.getRtlAdapter;var da=ke.noop;var ha=ke.valueOrDefault;de._set("global",{legend:{display:true,position:"top",align:"center",fullWidth:true,reverse:false,weight:1e3,onClick:function(e,t){var r=t.datasetIndex;var n=this.chart;var i=n.getDatasetMeta(r);i.hidden=i.hidden===null?!n.data.datasets[r].hidden:null;n.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(r){var n=r.data.datasets;var e=r.options.legend||{};var i=e.labels&&e.labels.usePointStyle;return r._getSortedDatasetMetas().map(function(e){var t=e.controller.getStyle(i?0:undefined);return{text:n[e.index].label,fillStyle:t.backgroundColor,hidden:!r.isDatasetVisible(e.index),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,pointStyle:t.pointStyle,rotation:t.rotation,datasetIndex:e.index}},this)}}},legendCallback:function(e){var t=document.createElement("ul");var r=e.data.datasets;var n,i,a,o;t.setAttribute("class",e.id+"-legend");for(n=0,i=r.length;n<i;n++){a=t.appendChild(document.createElement("li"));o=a.appendChild(document.createElement("span"));o.style.backgroundColor=r[n].backgroundColor;if(r[n].label){a.appendChild(document.createTextNode(r[n].label))}}return t.outerHTML}});function va(e,t){return e.usePointStyle&&e.boxWidth>t?t:e.boxWidth}var pa=Ae.extend({initialize:function(e){var t=this;ke.extend(t,e);t.legendHitBoxes=[];t._hoveredItem=null;t.doughnutMode=false},beforeUpdate:da,update:function(e,t,r){var n=this;n.beforeUpdate();n.maxWidth=e;n.maxHeight=t;n.margins=r;n.beforeSetDimensions();n.setDimensions();n.afterSetDimensions();n.beforeBuildLabels();n.buildLabels();n.afterBuildLabels();n.beforeFit();n.fit();n.afterFit();n.afterUpdate();return n.minSize},afterUpdate:da,beforeSetDimensions:da,setDimensions:function(){var e=this;if(e.isHorizontal()){e.width=e.maxWidth;e.left=0;e.right=e.width}else{e.height=e.maxHeight;e.top=0;e.bottom=e.height}e.paddingLeft=0;e.paddingTop=0;e.paddingRight=0;e.paddingBottom=0;e.minSize={width:0,height:0}},afterSetDimensions:da,beforeBuildLabels:da,buildLabels:function(){var t=this;var r=t.options.labels||{};var e=ke.callback(r.generateLabels,[t.chart],t)||[];if(r.filter){e=e.filter(function(e){return r.filter(e,t.chart.data)})}if(t.options.reverse){e.reverse()}t.legendItems=e},afterBuildLabels:da,beforeFit:da,fit:function(){var e=this;var t=e.options;var i=t.labels;var r=t.display;var a=e.ctx;var n=ke.options._parseFont(i);var o=n.size;var s=e.legendHitBoxes=[];var l=e.minSize;var u=e.isHorizontal();if(u){l.width=e.maxWidth;l.height=r?10:0}else{l.width=r?10:0;l.height=e.maxHeight}if(!r){e.width=l.width=e.height=l.height=0;return}a.font=n.string;if(u){var f=e.lineWidths=[0];var c=0;a.textAlign="left";a.textBaseline="middle";ke.each(e.legendItems,function(e,t){var r=va(i,o);var n=r+o/2+a.measureText(e.text).width;if(t===0||f[f.length-1]+n+2*i.padding>l.width){c+=o+i.padding;f[f.length-(t>0?0:1)]=0}s[t]={left:0,top:0,width:n,height:o};f[f.length-1]+=n+i.padding});l.height+=c}else{var d=i.padding;var h=e.columnWidths=[];var v=e.columnHeights=[];var p=i.padding;var g=0;var m=0;ke.each(e.legendItems,function(e,t){var r=va(i,o);var n=r+o/2+a.measureText(e.text).width;if(t>0&&m+o+2*d>l.height){p+=g+i.padding;h.push(g);v.push(m);g=0;m=0}g=Math.max(g,n);m+=o+d;s[t]={left:0,top:0,width:n,height:o}});p+=g;h.push(g);v.push(m);l.width+=p}e.width=l.width;e.height=l.height},afterFit:da,isHorizontal:function(){return this.options.position==="top"||this.options.position==="bottom"},draw:function(){var s=this;var r=s.options;var l=r.labels;var e=de.global;var u=e.defaultColor;var f=e.elements.line;var c=s.height;var d=s.columnHeights;var h=s.width;var v=s.lineWidths;if(!r.display){return}var p=ca(r.rtl,s.left,s.minSize.width);var g=s.ctx;var t=ha(l.fontColor,e.defaultFontColor);var n=ke.options._parseFont(l);var m=n.size;var y;g.textAlign=p.textAlign("left");g.textBaseline="middle";g.lineWidth=.5;g.strokeStyle=t;g.fillStyle=t;g.font=n.string;var b=va(l,m);var w=s.legendHitBoxes;var C=function(e,t,r){if(isNaN(b)||b<=0){return}g.save();var n=ha(r.lineWidth,f.borderWidth);g.fillStyle=ha(r.fillStyle,u);g.lineCap=ha(r.lineCap,f.borderCapStyle);g.lineDashOffset=ha(r.lineDashOffset,f.borderDashOffset);g.lineJoin=ha(r.lineJoin,f.borderJoinStyle);g.lineWidth=n;g.strokeStyle=ha(r.strokeStyle,u);if(g.setLineDash){g.setLineDash(ha(r.lineDash,f.borderDash))}if(l&&l.usePointStyle){var i=b*Math.SQRT2/2;var a=p.xPlus(e,b/2);var o=t+m/2;ke.canvas.drawPoint(g,r.pointStyle,i,a,o,r.rotation)}else{g.fillRect(p.leftForLtr(e,b),t,b,m);if(n!==0){g.strokeRect(p.leftForLtr(e,b),t,b,m)}}g.restore()};var S=function(e,t,r,n){var i=m/2;var a=p.xPlus(e,b+i);var o=t+i;g.fillText(r.text,a,o);if(r.hidden){g.beginPath();g.lineWidth=2;g.moveTo(a,o);g.lineTo(p.xPlus(a,n),o);g.stroke()}};var E=function(e,t){switch(r.align){case"start":return l.padding;case"end":return e-t;default:return(e-t+l.padding)/2}};var k=s.isHorizontal();if(k){y={x:s.left+E(h,v[0]),y:s.top+l.padding,line:0}}else{y={x:s.left+l.padding,y:s.top+E(c,d[0]),line:0}}ke.rtl.overrideTextDirection(s.ctx,r.textDirection);var T=m+l.padding;ke.each(s.legendItems,function(e,t){var r=g.measureText(e.text).width;var n=b+m/2+r;var i=y.x;var a=y.y;p.setWidth(s.minSize.width);if(k){if(t>0&&i+n+l.padding>s.left+s.minSize.width){a=y.y+=T;y.line++;i=y.x=s.left+E(h,v[y.line])}}else if(t>0&&a+T>s.top+s.minSize.height){i=y.x=i+s.columnWidths[y.line]+l.padding;y.line++;a=y.y=s.top+E(c,d[y.line])}var o=p.x(i);C(o,a,e);w[t].left=p.leftForLtr(o,w[t].width);w[t].top=a;S(o,a,e,r);if(k){y.x+=n+l.padding}else{y.y+=T}});ke.rtl.restoreTextDirection(s.ctx,r.textDirection)},_getLegendItemAt:function(e,t){var r=this;var n,i,a;if(e>=r.left&&e<=r.right&&t>=r.top&&t<=r.bottom){a=r.legendHitBoxes;for(n=0;n<a.length;++n){i=a[n];if(e>=i.left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height){return r.legendItems[n]}}}return null},handleEvent:function(e){var t=this;var r=t.options;var n=e.type==="mouseup"?"click":e.type;var i;if(n==="mousemove"){if(!r.onHover&&!r.onLeave){return}}else if(n==="click"){if(!r.onClick){return}}else{return}i=t._getLegendItemAt(e.x,e.y);if(n==="click"){if(i&&r.onClick){r.onClick.call(t,e.native,i)}}else{if(r.onLeave&&i!==t._hoveredItem){if(t._hoveredItem){r.onLeave.call(t,e.native,t._hoveredItem)}t._hoveredItem=i}if(r.onHover&&i){r.onHover.call(t,e.native,i)}}}});function ga(e,t){var r=new pa({ctx:e.ctx,options:t,chart:e});ur.configure(e,r,t);ur.addBox(e,r);e.legend=r}var ma={id:"legend",_element:pa,beforeInit:function(e){var t=e.options.legend;if(t){ga(e,t)}},beforeUpdate:function(e){var t=e.options.legend;var r=e.legend;if(t){ke.mergeIf(t,de.global.legend);if(r){ur.configure(e,r,t);r.options=t}else{ga(e,t)}}else if(r){ur.removeBox(e,r);delete e.legend}},afterEvent:function(e,t){var r=e.legend;if(r){r.handleEvent(t)}}};var ya=ke.noop;de._set("global",{title:{display:false,fontStyle:"bold",fullWidth:true,padding:10,position:"top",text:"",weight:2e3}});var ba=Ae.extend({initialize:function(e){var t=this;ke.extend(t,e);t.legendHitBoxes=[]},beforeUpdate:ya,update:function(e,t,r){var n=this;n.beforeUpdate();n.maxWidth=e;n.maxHeight=t;n.margins=r;n.beforeSetDimensions();n.setDimensions();n.afterSetDimensions();n.beforeBuildLabels();n.buildLabels();n.afterBuildLabels();n.beforeFit();n.fit();n.afterFit();n.afterUpdate();return n.minSize},afterUpdate:ya,beforeSetDimensions:ya,setDimensions:function(){var e=this;if(e.isHorizontal()){e.width=e.maxWidth;e.left=0;e.right=e.width}else{e.height=e.maxHeight;e.top=0;e.bottom=e.height}e.paddingLeft=0;e.paddingTop=0;e.paddingRight=0;e.paddingBottom=0;e.minSize={width:0,height:0}},afterSetDimensions:ya,beforeBuildLabels:ya,buildLabels:ya,afterBuildLabels:ya,beforeFit:ya,fit:function(){var e=this;var t=e.options;var r=e.minSize={};var n=e.isHorizontal();var i,a;if(!t.display){e.width=r.width=e.height=r.height=0;return}i=ke.isArray(t.text)?t.text.length:1;a=i*ke.options._parseFont(t).lineHeight+t.padding*2;e.width=r.width=n?e.maxWidth:a;e.height=r.height=n?a:e.maxHeight},afterFit:ya,isHorizontal:function(){var e=this.options.position;return e==="top"||e==="bottom"},draw:function(){var e=this;var t=e.ctx;var r=e.options;if(!r.display){return}var n=ke.options._parseFont(r);var i=n.lineHeight;var a=i/2+r.padding;var o=0;var s=e.top;var l=e.left;var u=e.bottom;var f=e.right;var c,d,h;t.fillStyle=ke.valueOrDefault(r.fontColor,de.global.defaultFontColor);t.font=n.string;if(e.isHorizontal()){d=l+(f-l)/2;h=s+a;c=f-l}else{d=r.position==="left"?l+a:f-a;h=s+(u-s)/2;c=u-s;o=Math.PI*(r.position==="left"?-.5:.5)}t.save();t.translate(d,h);t.rotate(o);t.textAlign="center";t.textBaseline="middle";var v=r.text;if(ke.isArray(v)){var p=0;for(var g=0;g<v.length;++g){t.fillText(v[g],0,p,c);p+=i}}else{t.fillText(v,0,0,c)}t.restore()}});function wa(e,t){var r=new ba({ctx:e.ctx,options:t,chart:e});ur.configure(e,r,t);ur.addBox(e,r);e.titleBlock=r}var Ca={id:"title",_element:ba,beforeInit:function(e){var t=e.options.title;if(t){wa(e,t)}},beforeUpdate:function(e){var t=e.options.title;var r=e.titleBlock;if(t){ke.mergeIf(t,de.global.title);if(r){ur.configure(e,r,t);r.options=t}else{wa(e,t)}}else if(r){ur.removeBox(e,r);delete e.titleBlock}}};var Sa={};var Ea=fa;var ka=ma;var Ta=Ca;Sa.filler=Ea;Sa.legend=ka;Sa.title=Ta;hn.helpers=ke;vn();hn._adapters=yn;hn.Animation=Me;hn.animationService=Le;hn.controllers=jt;hn.DatasetController=We;hn.defaults=de;hn.Element=Ae;hn.elements=ft;hn.Interaction=Kt;hn.layouts=ur;hn.platform=Hr;hn.plugins=$r;hn.Scale=Hn;hn.scaleService=Wr;hn.Ticks=bn;hn.Tooltip=rn;hn.helpers.each(Ji,function(e,t){hn.scaleService.registerScaleType(t,e,e._defaults)});for(var _a in Sa){if(Sa.hasOwnProperty(_a)){hn.plugins.register(Sa[_a])}}hn.platform.initialize();var xa=hn;if(typeof window!=="undefined"){window.Chart=hn}hn.Chart=hn;hn.Legend=Sa.legend._element;hn.Title=Sa.title._element;hn.pluginService=hn.plugins;hn.PluginBase=hn.Element.extend({});hn.canvasHelpers=hn.helpers.canvas;hn.layoutService=hn.layouts;hn.LinearScaleBase=Yn;hn.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(r){hn[r]=function(e,t){return new hn(e,hn.helpers.merge(t||{},{type:r.charAt(0).toLowerCase()+r.slice(1)}))}});return xa});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("chart.js")):typeof define==="function"&&define.amd?define(["chart.js"],t):(e=e||self,e.ChartColorSchemes=t(e.Chart))})(this,function(a){"use strict";a=a&&a.hasOwnProperty("default")?a["default"]:a;var e=["#f7fcb9","#addd8e","#31a354"],t=["#ffffcc","#c2e699","#78c679","#238443"],r=["#ffffcc","#c2e699","#78c679","#31a354","#006837"],n=["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],i=["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],o=["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],s=["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],l=["#edf8b1","#7fcdbb","#2c7fb8"],u=["#ffffcc","#a1dab4","#41b6c4","#225ea8"],f=["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],c=["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],d=["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],h=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],v=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],p=["#e0f3db","#a8ddb5","#43a2ca"],g=["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],m=["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],y=["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],b=["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],w=["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],C=["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],S=["#e5f5f9","#99d8c9","#2ca25f"],E=["#edf8fb","#b2e2e2","#66c2a4","#238b45"],k=["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],T=["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],_=["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],x=["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],D=["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],R=["#ece2f0","#a6bddb","#1c9099"],I=["#f6eff7","#bdc9e1","#67a9cf","#02818a"],O=["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],A=["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],N=["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],M=["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],L=["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],P=["#ece7f2","#a6bddb","#2b8cbe"],F=["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],B=["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],H=["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],$=["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],W=["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],U=["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],j=["#e0ecf4","#9ebcda","#8856a7"],V=["#edf8fb","#b3cde3","#8c96c6","#88419d"],z=["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],q=["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],Y=["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],G=["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],X=["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],K=["#fde0dd","#fa9fb5","#c51b8a"],J=["#feebe2","#fbb4b9","#f768a1","#ae017e"],Q=["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],Z=["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],ee=["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],te=["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],re=["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],ne=["#e7e1ef","#c994c7","#dd1c77"],ie=["#f1eef6","#d7b5d8","#df65b0","#ce1256"],ae=["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],oe=["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],se=["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],le=["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],ue=["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],fe=["#fee8c8","#fdbb84","#e34a33"],ce=["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],de=["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],he=["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],ve=["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],pe=["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],ge=["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],me=["#ffeda0","#feb24c","#f03b20"],ye=["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],be=["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],we=["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],Ce=["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],Se=["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],Ee=["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],ke=["#fff7bc","#fec44f","#d95f0e"],Te=["#ffffd4","#fed98e","#fe9929","#cc4c02"],_e=["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],xe=["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],De=["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],Re=["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],Ie=["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],Oe=["#efedf5","#bcbddc","#756bb1"],Ae=["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],Ne=["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],Me=["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],Le=["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],Pe=["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],Fe=["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],Be=["#deebf7","#9ecae1","#3182bd"],He=["#eff3ff","#bdd7e7","#6baed6","#2171b5"],$e=["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],We=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],Ue=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],je=["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],Ve=["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],ze=["#e5f5e0","#a1d99b","#31a354"],qe=["#edf8e9","#bae4b3","#74c476","#238b45"],Ye=["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],Ge=["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],Xe=["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],Ke=["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],Je=["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],Qe=["#fee6ce","#fdae6b","#e6550d"],Ze=["#feedde","#fdbe85","#fd8d3c","#d94701"],et=["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],tt=["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],rt=["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],nt=["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],it=["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],at=["#fee0d2","#fc9272","#de2d26"],ot=["#fee5d9","#fcae91","#fb6a4a","#cb181d"],st=["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],lt=["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],ut=["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],ft=["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],ct=["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],dt=["#f0f0f0","#bdbdbd","#636363"],ht=["#f7f7f7","#cccccc","#969696","#525252"],vt=["#f7f7f7","#cccccc","#969696","#636363","#252525"],pt=["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],gt=["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],mt=["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],yt=["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],bt=["#f1a340","#f7f7f7","#998ec3"],wt=["#e66101","#fdb863","#b2abd2","#5e3c99"],Ct=["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],St=["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],Et=["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],kt=["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],Tt=["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],_t=["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],xt=["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Dt=["#d8b365","#f5f5f5","#5ab4ac"],Rt=["#a6611a","#dfc27d","#80cdc1","#018571"],It=["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],Ot=["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],At=["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],Nt=["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],Mt=["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],Lt=["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],Pt=["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],Ft=["#af8dc3","#f7f7f7","#7fbf7b"],Bt=["#7b3294","#c2a5cf","#a6dba0","#008837"],Ht=["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],$t=["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],Wt=["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],Ut=["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],jt=["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],Vt=["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],zt=["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],qt=["#e9a3c9","#f7f7f7","#a1d76a"],Yt=["#d01c8b","#f1b6da","#b8e186","#4dac26"],Gt=["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],Xt=["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],Kt=["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],Jt=["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],Qt=["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],Zt=["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],er=["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],tr=["#ef8a62","#f7f7f7","#67a9cf"],rr=["#ca0020","#f4a582","#92c5de","#0571b0"],nr=["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],ir=["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],ar=["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],or=["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],sr=["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],lr=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],ur=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],fr=["#ef8a62","#ffffff","#999999"],cr=["#ca0020","#f4a582","#bababa","#404040"],dr=["#ca0020","#f4a582","#ffffff","#bababa","#404040"],hr=["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],vr=["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],pr=["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],gr=["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],mr=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],yr=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],br=["#fc8d59","#ffffbf","#91bfdb"],wr=["#d7191c","#fdae61","#abd9e9","#2c7bb6"],Cr=["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],Sr=["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],Er=["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],kr=["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],Tr=["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],_r=["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],xr=["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],Dr=["#fc8d59","#ffffbf","#99d594"],Rr=["#d7191c","#fdae61","#abdda4","#2b83ba"],Ir=["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],Or=["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],Ar=["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],Nr=["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],Mr=["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],Lr=["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],Pr=["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],Fr=["#fc8d59","#ffffbf","#91cf60"],Br=["#d7191c","#fdae61","#a6d96a","#1a9641"],Hr=["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],$r=["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],Wr=["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],Ur=["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],jr=["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],Vr=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],zr=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],qr=["#7fc97f","#beaed4","#fdc086"],Yr=["#7fc97f","#beaed4","#fdc086","#ffff99"],Gr=["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],Xr=["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],Kr=["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],Jr=["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Qr=["#1b9e77","#d95f02","#7570b3"],Zr=["#1b9e77","#d95f02","#7570b3","#e7298a"],en=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],tn=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],rn=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],nn=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],an=["#a6cee3","#1f78b4","#b2df8a"],on=["#a6cee3","#1f78b4","#b2df8a","#33a02c"],sn=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],ln=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],un=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],fn=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],cn=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],dn=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],hn=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],vn=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],pn=["#fbb4ae","#b3cde3","#ccebc5"],gn=["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],mn=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],yn=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],bn=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],wn=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],Cn=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],Sn=["#b3e2cd","#fdcdac","#cbd5e8"],En=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],kn=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],Tn=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],_n=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],xn=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Dn=["#e41a1c","#377eb8","#4daf4a"],Rn=["#e41a1c","#377eb8","#4daf4a","#984ea3"],In=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],On=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],An=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],Nn=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],Mn=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Ln=["#66c2a5","#fc8d62","#8da0cb"],Pn=["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],Fn=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],Bn=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],Hn=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],$n=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Wn=["#8dd3c7","#ffffb3","#bebada"],Un=["#8dd3c7","#ffffb3","#bebada","#fb8072"],jn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],Vn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],zn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],qn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],Yn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],Gn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],Xn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],Kn=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"];var Jn=Object.freeze({YlGn3:e,YlGn4:t,YlGn5:r,YlGn6:n,YlGn7:i,YlGn8:o,YlGn9:s,YlGnBu3:l,YlGnBu4:u,YlGnBu5:f,YlGnBu6:c,YlGnBu7:d,YlGnBu8:h,YlGnBu9:v,GnBu3:p,GnBu4:g,GnBu5:m,GnBu6:y,GnBu7:b,GnBu8:w,GnBu9:C,BuGn3:S,BuGn4:E,BuGn5:k,BuGn6:T,BuGn7:_,BuGn8:x,BuGn9:D,PuBuGn3:R,PuBuGn4:I,PuBuGn5:O,PuBuGn6:A,PuBuGn7:N,PuBuGn8:M,PuBuGn9:L,PuBu3:P,PuBu4:F,PuBu5:B,PuBu6:H,PuBu7:$,PuBu8:W,PuBu9:U,BuPu3:j,BuPu4:V,BuPu5:z,BuPu6:q,BuPu7:Y,BuPu8:G,BuPu9:X,RdPu3:K,RdPu4:J,RdPu5:Q,RdPu6:Z,RdPu7:ee,RdPu8:te,RdPu9:re,PuRd3:ne,PuRd4:ie,PuRd5:ae,PuRd6:oe,PuRd7:se,PuRd8:le,PuRd9:ue,OrRd3:fe,OrRd4:ce,OrRd5:de,OrRd6:he,OrRd7:ve,OrRd8:pe,OrRd9:ge,YlOrRd3:me,YlOrRd4:ye,YlOrRd5:be,YlOrRd6:we,YlOrRd7:Ce,YlOrRd8:Se,YlOrRd9:Ee,YlOrBr3:ke,YlOrBr4:Te,YlOrBr5:_e,YlOrBr6:xe,YlOrBr7:De,YlOrBr8:Re,YlOrBr9:Ie,Purples3:Oe,Purples4:Ae,Purples5:Ne,Purples6:Me,Purples7:Le,Purples8:Pe,Purples9:Fe,Blues3:Be,Blues4:He,Blues5:$e,Blues6:We,Blues7:Ue,Blues8:je,Blues9:Ve,Greens3:ze,Greens4:qe,Greens5:Ye,Greens6:Ge,Greens7:Xe,Greens8:Ke,Greens9:Je,Oranges3:Qe,Oranges4:Ze,Oranges5:et,Oranges6:tt,Oranges7:rt,Oranges8:nt,Oranges9:it,Reds3:at,Reds4:ot,Reds5:st,Reds6:lt,Reds7:ut,Reds8:ft,Reds9:ct,Greys3:dt,Greys4:ht,Greys5:vt,Greys6:pt,Greys7:gt,Greys8:mt,Greys9:yt,PuOr3:bt,PuOr4:wt,PuOr5:Ct,PuOr6:St,PuOr7:Et,PuOr8:kt,PuOr9:Tt,PuOr10:_t,PuOr11:xt,BrBG3:Dt,BrBG4:Rt,BrBG5:It,BrBG6:Ot,BrBG7:At,BrBG8:Nt,BrBG9:Mt,BrBG10:Lt,BrBG11:Pt,PRGn3:Ft,PRGn4:Bt,PRGn5:Ht,PRGn6:$t,PRGn7:Wt,PRGn8:Ut,PRGn9:jt,PRGn10:Vt,PRGn11:zt,PiYG3:qt,PiYG4:Yt,PiYG5:Gt,PiYG6:Xt,PiYG7:Kt,PiYG8:Jt,PiYG9:Qt,PiYG10:Zt,PiYG11:er,RdBu3:tr,RdBu4:rr,RdBu5:nr,RdBu6:ir,RdBu7:ar,RdBu8:or,RdBu9:sr,RdBu10:lr,RdBu11:ur,RdGy3:fr,RdGy4:cr,RdGy5:dr,RdGy6:hr,RdGy7:vr,RdGy8:pr,RdGy9:gr,RdGy10:mr,RdGy11:yr,RdYlBu3:br,RdYlBu4:wr,RdYlBu5:Cr,RdYlBu6:Sr,RdYlBu7:Er,RdYlBu8:kr,RdYlBu9:Tr,RdYlBu10:_r,RdYlBu11:xr,Spectral3:Dr,Spectral4:Rr,Spectral5:Ir,Spectral6:Or,Spectral7:Ar,Spectral8:Nr,Spectral9:Mr,Spectral10:Lr,Spectral11:Pr,RdYlGn3:Fr,RdYlGn4:Br,RdYlGn5:Hr,RdYlGn6:$r,RdYlGn7:Wr,RdYlGn8:Ur,RdYlGn9:jr,RdYlGn10:Vr,RdYlGn11:zr,Accent3:qr,Accent4:Yr,Accent5:Gr,Accent6:Xr,Accent7:Kr,Accent8:Jr,DarkTwo3:Qr,DarkTwo4:Zr,DarkTwo5:en,DarkTwo6:tn,DarkTwo7:rn,DarkTwo8:nn,Paired3:an,Paired4:on,Paired5:sn,Paired6:ln,Paired7:un,Paired8:fn,Paired9:cn,Paired10:dn,Paired11:hn,Paired12:vn,PastelOne3:pn,PastelOne4:gn,PastelOne5:mn,PastelOne6:yn,PastelOne7:bn,PastelOne8:wn,PastelOne9:Cn,PastelTwo3:Sn,PastelTwo4:En,PastelTwo5:kn,PastelTwo6:Tn,PastelTwo7:_n,PastelTwo8:xn,SetOne3:Dn,SetOne4:Rn,SetOne5:In,SetOne6:On,SetOne7:An,SetOne8:Nn,SetOne9:Mn,SetTwo3:Ln,SetTwo4:Pn,SetTwo5:Fn,SetTwo6:Bn,SetTwo7:Hn,SetTwo8:$n,SetThree3:Wn,SetThree4:Un,SetThree5:jn,SetThree6:Vn,SetThree7:zn,SetThree8:qn,SetThree9:Yn,SetThree10:Gn,SetThree11:Xn,SetThree12:Kn});var Qn=["#a9a57c","#9cbebd","#d2cb6c","#95a39d","#c89f5d","#b1a089"],Zn=["#663366","#330f42","#666699","#999966","#f7901e","#a3a101"],ei=["#797b7e","#f96a1b","#08a1d9","#7c984a","#c2ad8d","#506e94"],ti=["#ceb966","#9cb084","#6bb1c9","#6585cf","#7e6bc9","#a379bb"],ri=["#93a299","#cf543f","#b5ae53","#848058","#e8b54d","#786c71"],ni=["#f07f09","#9f2936","#1b587c","#4e8542","#604878","#c19859"],ii=["#f81b02","#fc7715","#afbf41","#50c49f","#3b95c4","#b560d4"],ai=["#94c600","#71685a","#ff6700","#909465","#956b43","#fea022"],oi=["#f8b323","#656a59","#46b2b5","#8caa7e","#d36f68","#826276"],si=["#ffc000","#a5d028","#08cc78","#f24099","#828288","#f56617"],li=["#f09415","#c1b56b","#4baf73","#5aa6c0","#d17df9","#fa7e5c"],ui=["#a6b727","#df5327","#fe9e00","#418ab3","#d7d447","#818183"],fi=["#6f6f74","#a7b789","#beae98","#92a9b9","#9c8265","#8d6974"],ci=["#0f6fc6","#009dd9","#0bd0d9","#10cf9b","#7cca62","#a5c249"],di=["#3494ba","#58b6c0","#75bda7","#7a8c8e","#84acb6","#2683c6"],hi=["#1cade4","#2683c6","#27ced7","#42ba97","#3e8853","#62a39f"],vi=["#4a66ac","#629dd1","#297fd5","#7f8fa9","#5aa2ae","#9d90a0"],pi=["#4a66ac","#629dd1","#297fd5","#7f8fa9","#5aa2ae","#9d90a0"],gi=["#2c7c9f","#244a58","#e2751d","#ffb400","#7eb606","#c00000"],mi=["#4b5a60","#9c5238","#504539","#c1ad79","#667559","#bad6ad"],yi=["#ac3ec1","#477bd1","#46b298","#90ba4c","#dd9d31","#e25247"],bi=["#9acd4c","#faa93a","#d35940","#b258d3","#63a0cc","#8ac4a7"],wi=["#d16349","#ccb400","#8cadae","#8c7b70","#8fb08c","#d19049"],Ci=["#93a299","#ad8f67","#726056","#4c5a6a","#808da0","#79463d"],Si=["#990000","#efab16","#78ac35","#35aca2","#4083cf","#0d335e"],Ei=["#98c723","#59b0b9","#deae00","#b77bb4","#e0773c","#a98d63"],ki=["#2da2bf","#da1f28","#eb641b","#39639d","#474b78","#7d3c4a"],Ti=["#9e8e5c","#a09781","#85776d","#aeafa9","#8d878b","#6b6149"],_i=["#8c8d86","#e6c069","#897b61","#8dab8e","#77a2bb","#e28394"],xi=["#9ec544","#50bea3","#4a9ccc","#9a66ca","#c54f71","#de9c3c"],Di=["#41aebd","#97e9d5","#a2cf49","#608f3d","#f4de3a","#fcb11c"],Ri=["#4d1434","#903163","#b2324b","#969fa7","#66b1ce","#40619d"],Ii=["#2fa3ee","#4bcaad","#86c157","#d99c3f","#ce6633","#a35dd1"],Oi=["#629dd1","#297fd5","#7f8fa9","#4a66ac","#5aa2ae","#9d90a0"],Ai=["#d34817","#9b2d1f","#a28e6a","#956251","#918485","#855d5d"],Ni=["#7a7a7a","#f5c201","#526db0","#989aac","#dc5924","#b4b392"],Mi=["#9999ff","#993366","#ffffcc","#ccffff","#660066","#ff8080","#0066cc","#ccccff","#000080","#ff00ff","#ffff00","#0000ff","#800080","#800000","#008080","#0000ff"],Li=["#6076b4","#9c5252","#e68422","#846648","#63891f","#758085"],Pi=["#3399ff","#69ffff","#ccff33","#3333ff","#9933ff","#ff33ff"],Fi=["#fbc01e","#efe1a2","#fa8716","#be0204","#640f10","#7e13e3"],Bi=["#90c226","#54a021","#e6b91e","#e76618","#c42f1a","#918655"],Hi=["#606372","#79a8a4","#b2ad8f","#ad8082","#dec18c","#92a185"],$i=["#0f6fc6","#009dd9","#0bd0d9","#10cf9b","#7cca62","#a5c249"],Wi=["#ffb91d","#f97817","#6de304","#ff0000","#732bea","#c913ad"],Ui=["#294171","#748cbc","#8e887c","#834736","#5a1705","#a0a16a"],ji=["#907f76","#a46645","#cd9c47","#9a92cd","#7d639b","#733678"],Vi=["#c70f0c","#dd6b0d","#faa700","#93e50d","#17c7ba","#0a96e4"],zi=["#72a376","#b0ccb0","#a8cdd7","#c0beaf","#cec597","#e8b7b7"],qi=["#40bad2","#fab900","#90bb23","#ee7008","#1ab39f","#d5393d"],Yi=["#b71e42","#de478e","#bc72f0","#795faf","#586ea6","#6892a0"],Gi=["#80b606","#e29f1d","#2397e2","#35aca2","#5430bb","#8d34e0"],Xi=["#dddddd","#b2b2b2","#969696","#808080","#5f5f5f","#4d4d4d"],Ki=["#549e39","#8ab833","#c0cf3a","#029676","#4ab5c4","#0989b1"],Ji=["#99cb38","#63a537","#37a76f","#44c1a3","#4eb3cf","#51c3f9"],Qi=["#c66951","#bf974d","#928b70","#87706b","#94734e","#6f777d"],Zi=["#f8c000","#f88600","#f83500","#8b723d","#818b3d","#586215"],ea=["#873624","#d6862d","#d0be40","#877f6c","#972109","#aeb795"],ta=["#439eb7","#e28b55","#dcb64d","#4ca198","#835b82","#645135"],ra=["#7e97ad","#cc8e60","#7a6a60","#b4936d","#67787b","#9d936f"],na=["#8c73d0","#c2e8c4","#c5a6e8","#b45ec7","#9fdafb","#95c5b0"],ia=["#860908","#4a0505","#7a500a","#c47810","#827752","#b5bb83"],aa=["#749805","#bacc82","#6e9ec2","#2046a5","#5039c6","#7411d0"],oa=["#1cade4","#2683c6","#27ced7","#42ba97","#3e8853","#62a39f"],sa=["#b01513","#ea6312","#e6b729","#6aac90","#5f9c9d","#9e5e9b"],la=["#b31166","#e33d6f","#e45f3c","#e9943a","#9b6bf2","#d53dd0"],ua=["#76c5ef","#fea022","#ff6700","#70a525","#a5d848","#20768c"],fa=["#a1d68b","#5ec795","#4dadcf","#cdb756","#e29c36","#8ec0c1"],ca=["#b80e0f","#a6987d","#7f9a71","#64969f","#9b75b2","#80737a"],da=["#418ab3","#a6b727","#f69200","#838383","#fec306","#df5327"],ha=["#94b6d2","#dd8047","#a5ab81","#d8b25c","#7ba79d","#968c8c"],va=["#6f6f6f","#bfbfa5","#dcd084","#e7bf5f","#e9a039","#cf7133"],pa=["#6283ad","#324966","#5b9ea4","#1d5b57","#1b4430","#2f3c35"],ga=["#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f"],ma=["#50b4c8","#a8b97f","#9b9256","#657689","#7a855d","#84ac9d"],ya=["#f0ad00","#60b5cc","#e66c7d","#6bb76d","#e88651","#c64847"],ba=["#ad0101","#726056","#ac956e","#808da9","#424e5b","#730e00"],wa=["#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"],Ca=["#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"],Sa=["#b83d68","#ac66bb","#de6c36","#f9b639","#cf6da4","#fa8d3d"],Ea=["#e48312","#bd582c","#865640","#9b8357","#c2bc80","#94a088"],ka=["#d34817","#9b2d1f","#a28e6a","#956251","#918485","#855d5d"],Ta=["#f2d908","#9de61e","#0d8be6","#c61b1b","#e26f08","#8d35d1"],_a=["#83992a","#3c9770","#44709d","#a23c33","#d97828","#deb340"],xa=["#fe8637","#7598d9","#b32c16","#f5cd2d","#aebad5","#777c84"],Da=["#727ca3","#9fb8cd","#d2da7a","#fada7a","#b88472","#8e736a"],Ra=["#a5b592","#f3a447","#e7bc29","#d092a7","#9c85c0","#809ec2"],Ia=["#30acec","#80c34f","#e29d3e","#d64a3b","#d64787","#a666e1"],Oa=["#f6a21d","#9bafb5","#c96731","#9ca383","#87795d","#a0988c"],Aa=["#a2c816","#e07602","#e4c402","#7dc1ef","#21449b","#a2b170"],Na=["#838d9b","#d2610c","#80716a","#94147c","#5d5ad2","#6f6c7d"],Ma=["#ff7f01","#f1b015","#fbec85","#d2c2f1","#da5af4","#9d09d1"],La=["#990000","#580101","#e94a00","#eb8f00","#a4a4a4","#666666"],Pa=["#993232","#9b6c34","#736c5d","#c9972b","#c95f2b","#8f7a05"],Fa=["#fda023","#aa2b1e","#71685c","#64a73b","#eb5605","#b9ca1a"],Ba=["#00c6bb","#6feba0","#b6df5e","#efb251","#ef755f","#ed515c"],Ha=["#a5300f","#d55816","#e19825","#b19c7d","#7f5f52","#b27d49"],$a=["#e84c22","#ffbd47","#b64926","#ff8427","#cc9900","#b22600"],Wa=["#e32d91","#c830cc","#4ea6dc","#4775e7","#8971e1","#d54773"],Ua=["#e48312","#bd582c","#865640","#9b8357","#c2bc80","#94a088"],ja=["#0c5986","#ddf53d","#508709","#bf5e00","#9c0001","#660075"],Va=["#c6b178","#9c5b14","#71b2bc","#78aa5d","#867099","#4c6f75"],za=["#1cade4","#2683c6","#27ced7","#42ba97","#3e8853","#62a39f"],qa=["#a63212","#e68230","#9bb05e","#6b9bc7","#4e66b2","#8976ac"],Ya=["#073779","#8fd9fb","#ffcc00","#eb6615","#c76402","#b523b4"],Ga=["#bc451b","#d3ba68","#bb8640","#ad9277","#a55a43","#ad9d7b"],Xa=["#052f61","#a50e82","#14967c","#6a9e1f","#e87d37","#c62324"],Ka=["#4e67c8","#5eccf3","#a7ea52","#5dceaf","#ff8021","#f14124"],Ja=["#61625e","#964d2c","#66553e","#848058","#afa14b","#ad7d4d"],Qa=["#3891a7","#feb80a","#c32d2e","#84aa33","#964305","#475a8d"],Za=["#990000","#ff6600","#ffba00","#99cc00","#528a02","#333333"],eo=["#1d86cd","#732e9a","#b50b1b","#e8950e","#55992b","#2c9c89"],to=["#f7901e","#fec60b","#9fe62f","#4ea5d1","#1c4596","#542d90"],ro=["#51a6c2","#51c2a9","#7ec251","#e1dc53","#b54721","#a16bb1"],no=["#6ea0b0","#ccaf0a","#8d89a4","#748560","#9e9273","#7e848d"],io=["#759aa5","#cfc60d","#99987f","#90ac97","#ffad1c","#b9ab6f"],ao=["#6b4a0b","#790a14","#908342","#423e5c","#641345","#748a2f"],oo=["#b74d21","#a32323","#4576a3","#615d9a","#67924b","#bf7b1b"],so=["#f0a22e","#a5644e","#b58b80","#c3986d","#a19574","#c17529"],lo=["#e8bc4a","#83c1c6","#e78d35","#909ce1","#839c41","#cc5439"],uo=["#53548a","#438086","#a04da3","#c4652d","#8b5d3d","#5c92b5"],fo=["#86ce24","#00a2e6","#fac810","#7d8f8c","#d06b20","#958b8b"],co=["#df2e28","#fe801a","#e9bf35","#81bb42","#32c7a9","#4a9bdc"],ho=["#9eb060","#d09a08","#f2ec86","#824f1c","#511818","#553876"],vo=["#ff388c","#e40059","#9c007f","#68007f","#005bd3","#00349e"],po=["#6f6f74","#92a9b9","#a7b789","#b9a489","#8d6374","#9b7362"],go=["#ad84c6","#8784c7","#5d739a","#6997af","#84acb6","#6f8183"],mo=["#92278f","#9b57d3","#755dd9","#665eb8","#45a5ed","#5982db"],yo=["#31b6fd","#4584d3","#5bd078","#a5d028","#f5c040","#05e0db"],bo=["#a53010","#de7e18","#9f8351","#728653","#92aa4c","#6aac91"],wo=["#d34817","#9b2d1f","#a28e6a","#956251","#918485","#855d5d"],Co=["#ffca08","#f8931d","#ce8d3e","#ec7016","#e64823","#9c6a6a"],So=["#f0a22e","#a5644e","#b58b80","#c3986d","#a19574","#c17529"];var Eo=Object.freeze({Adjacency6:Qn,Advantage6:Zn,Angles6:ei,Apex6:ti,Apothecary6:ri,Aspect6:ni,Atlas6:ii,Austin6:ai,Badge6:oi,Banded6:si,Basis6:li,Berlin6:ui,BlackTie6:fi,Blue6:ci,BlueGreen6:di,BlueII6:hi,BlueRed6:vi,BlueWarm6:pi,Breeze6:gi,Capital6:mi,Celestial6:yi,Circuit6:bi,Civic6:wi,Clarity6:Ci,Codex6:Si,Composite6:Ei,Concourse6:ki,Couture6:Ti,Crop6:_i,Damask6:xi,Depth6:Di,Dividend6:Ri,Droplet6:Ii,Elemental6:Oi,Equity6:Ai,Essential6:Ni,Excel16:Mi,Executive6:Li,Exhibit6:Pi,Expo6:Fi,Facet6:Bi,Feathered6:Hi,Flow6:$i,Focus6:Wi,Folio6:Ui,Formal6:ji,Forte6:Vi,Foundry6:zi,Frame6:qi,Gallery6:Yi,Genesis6:Gi,Grayscale6:Xi,Green6:Ki,GreenYellow6:Ji,Grid6:Qi,Habitat6:Zi,Hardcover6:ea,Headlines6:ta,Horizon6:ra,Infusion6:na,Inkwell6:ia,Inspiration6:aa,Integral6:oa,Ion6:sa,IonBoardroom6:la,Kilter6:ua,Madison6:fa,MainEvent6:ca,Marquee6:da,Median6:ha,Mesh6:va,Metail6:pa,Metro6:ga,Metropolitan6:ma,Module6:ya,NewsPrint6:ba,Office6:wa,OfficeClassic6:Ca,Opulent6:Sa,Orange6:Ea,OrangeRed6:ka,Orbit6:Ta,Organic6:_a,Oriel6:xa,Origin6:Da,Paper6:Ra,Parallax6:Ia,Parcel6:Oa,Perception6:Aa,Perspective6:Na,Pixel6:Ma,Plaza6:La,Precedent6:Pa,Pushpin6:Fa,Quotable6:Ba,Red6:Ha,RedOrange6:$a,RedViolet6:Wa,Retrospect6:Ua,Revolution6:ja,Saddle6:Va,Savon6:za,Sketchbook6:qa,Sky6:Ya,Slate6:Ga,Slice6:Xa,Slipstream6:Ka,SOHO6:Ja,Solstice6:Qa,Spectrum6:Za,Story6:eo,Studio6:to,Summer6:ro,Technic6:no,Thatch6:io,Tradition6:ao,Travelogue6:oo,Trek6:so,Twilight6:lo,Urban6:uo,UrbanPop6:fo,VaporTrail6:co,Venture6:ho,Verve6:vo,View6:po,Violet6:go,VioletII6:mo,Waveform6:yo,Wisp6:bo,WoodType6:wo,Yellow6:Co,YellowOrange6:So});var ko=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F","#EDC948","#B07AA1","#FF9DA7","#9C755F","#BAB0AC"],To=["#4E79A7","#A0CBE8","#F28E2B","#FFBE7D","#59A14F","#8CD17D","#B6992D","#F1CE63","#499894","#86BCB6","#E15759","#FF9D9A","#79706E","#BAB0AC","#D37295","#FABFD2","#B07AA1","#D4A6C8","#9D7660","#D7B5A6"],_o=["#1170aa","#fc7d0b","#a3acb9","#57606c","#5fa2ce","#c85200","#7b848f","#a3cce9","#ffbc79","#c8d0d9"],xo=["#767f8b","#b3b7b8","#5c6068","#d3d3d3","#989ca3"],Do=["#b60a1c","#e39802","#309143","#e03531","#f0bd27","#51b364","#ff684c","#ffda66","#8ace7e"],Ro=["#4f6980","#849db1","#a2ceaa","#638b66","#bfbb60","#f47942","#fbb04e","#b66353","#d7ce9f","#b9aa97","#7e756d"],Io=["#6388b4","#ffae34","#ef6f6a","#8cc2ca","#55ad89","#c3bc3f","#bb7693","#baa094","#a9b5ae","#767676"],Oo=["#8175aa","#6fb899","#31a1b3","#ccb22b","#a39fc9","#94d0c0","#959c9e","#027b8e","#9f8f12"],Ao=["#eb1e2c","#fd6f30","#f9a729","#f9d23c","#5fbb68","#64cdcc","#91dcea","#a4a4d5","#bbc9e5"],No=["#bfb202","#b9ca5d","#cf3e53","#f1788d","#00a2b3","#97cfd0","#f3a546","#f7c480"],Mo=["#90728f","#b9a0b4","#9d983d","#cecb76","#e15759","#ff9888","#6b6b6b","#bab2ae","#aa8780","#dab6af"],Lo=["#4e9f50","#87d180","#ef8a0c","#fcc66d","#3ca8bc","#98d9e4","#94a323","#c3ce3d","#a08400","#f7d42a","#26897e","#8dbfa8"],Po=["#466f9d","#91b3d7","#ed444a","#feb5a2","#9d7660","#d7b5a6","#3896c4","#a0d4ee","#ba7e45","#39b87f","#c8133b","#ea8783"],Fo=["#8074a8","#c6c1f0","#c46487","#ffbed1","#9c9290","#c5bfbe","#9b93c9","#ddb5d5","#7c7270","#f498b6","#b173a0","#c799bc"],Bo=["#1ba3c6","#2cb5c0","#30bcad","#21B087","#33a65c","#57a337","#a2b627","#d5bb21","#f8b620","#f89217","#f06719","#e03426","#f64971","#fc719e","#eb73b3","#ce69be","#a26dc2","#7873c0","#4f7cba"],Ho=["#9e3d22","#d45b21","#f69035","#d9d5c9","#77acd3","#4f81af","#2b5c8a"],$o=["#a3123a","#e33f43","#f8816b","#ced7c3","#73ba67","#44914e","#24693d"],Wo=["#24693d","#45934d","#75bc69","#c9dad2","#77a9cf","#4e7fab","#2a5783"],Uo=["#a90c38","#e03b42","#f87f69","#dfd4d1","#7eaed3","#5383af","#2e5a87"],jo=["#ae123a","#e33e43","#f8816b","#d9d9d9","#a0a7a8","#707c83","#49525e"],Vo=["#ad9024","#c1a33b","#d4b95e","#e3d8cf","#d4a3c3","#c189b0","#ac7299"],zo=["#be2a3e","#e25f48","#f88f4d","#f4d166","#90b960","#4b9b5f","#22763f"],qo=["#33608c","#9768a5","#e7718a","#f6ba57","#ed7846","#d54c45","#b81840"],Yo=["#9e3d22","#e36621","#fcad52","#ffffff","#95c5e1","#5b8fbc","#2b5c8a"],Go=["#ae123a","#ee574d","#fdac9e","#ffffff","#91d183","#539e52","#24693d"],Xo=["#24693d","#529c51","#8fd180","#ffffff","#95c1dd","#598ab5","#2a5783"],Ko=["#a90c38","#ec534b","#feaa9a","#ffffff","#9ac4e1","#5c8db8","#2e5a87"],Jo=["#ae123a","#ee574d","#fdac9d","#ffffff","#bdc0bf","#7d888d","#49525e"],Qo=["#ffcc9e","#f9d4b6","#f0dccd","#e5e5e5","#dae1ea","#cfdcef","#c4d8f3"],Zo=["#529985","#6c9e6e","#99b059","#dbcf47","#ebc24b","#e3a14f","#c26b51"],es=["#feffd9","#f2fabf","#dff3b2","#c4eab1","#94d6b7","#69c5be","#41b7c4"],ts=["#e5e5e5","#e0e3e8","#dbe1ea","#d5dfec","#d0dcef","#cadaf1","#c4d8f3"],rs=["#e5e5e5","#ebe1d9","#f0ddcd","#f5d9c2","#f9d4b6","#fdd0aa","#ffcc9e"],ns=["#b9ddf1","#afd6ed","#a5cfe9","#9bc7e4","#92c0df","#89b8da","#80b0d5","#79aacf","#72a3c9","#6a9bc3","#6394be","#5b8cb8","#5485b2","#4e7fac","#4878a6","#437a9f","#3d6a98","#376491","#305d8a","#2a5783"],is=["#ffc685","#fcbe75","#f9b665","#f7ae54","#f5a645","#f59c3c","#f49234","#f2882d","#f07e27","#ee7422","#e96b20","#e36420","#db5e20","#d25921","#ca5422","#c14f22","#b84b23","#af4623","#a64122","#9e3d22"],as=["#b3e0a6","#a5db96","#98d687","#8ed07f","#85ca77","#7dc370","#75bc69","#6eb663","#67af5c","#61a956","#59a253","#519c51","#49964f","#428f4d","#398949","#308344","#2b7c40","#27763d","#256f3d","#24693d"],os=["#ffbeb2","#feb4a6","#fdab9b","#fca290","#fb9984","#fa8f79","#f9856e","#f77b66","#f5715d","#f36754","#f05c4d","#ec5049","#e74545","#e13b42","#da323f","#d3293d","#ca223c","#c11a3b","#b8163a","#ae123a"],ss=["#eec9e5","#eac1df","#e6b9d9","#e0b2d2","#daabcb","#d5a4c4","#cf9dbe","#ca96b8","#c48fb2","#be89ac","#b882a6","#b27ba1","#aa759d","#a27099","#9a6a96","#926591","#8c5f86","#865986","#81537f","#7c4d79"],ls=["#eedbbd","#ecd2ad","#ebc994","#eac085","#e8b777","#e5ae6c","#e2a562","#de9d5a","#d99455","#d38c54","#ce8451","#c9784d","#c47247","#c16941","#bd6036","#b85636","#b34d34","#ad4433","#a63d32","#9f3632"],us=["#d5d5d5","#cdcecd","#c5c7c6","#bcbfbe","#b4b7b7","#acb0b1","#a4a9ab","#9ca3a4","#939c9e","#8b9598","#848e93","#7c878d","#758087","#6e7a81","#67737c","#616c77","#5b6570","#555f6a","#4f5864","#49525e"],fs=["#dcd4d0","#d4ccc8","#cdc4c0","#c5bdb9","#beb6b2","#b7afab","#b0a7a4","#a9a09d","#a29996","#9b938f","#948c88","#8d8481","#867e7b","#807774","#79706e","#736967","#6c6260","#665c51","#5f5654","#59504e"],cs=["#bce4d8","#aedcd5","#a1d5d2","#95cecf","#89c8cc","#7ec1ca","#72bac6","#66b2c2","#59acbe","#4ba5ba","#419eb6","#3b96b2","#358ead","#3586a7","#347ea1","#32779b","#316f96","#2f6790","#2d608a","#2c5985"],ds=["#f4d166","#f6c760","#f8bc58","#f8b252","#f7a84a","#f69e41","#f49538","#f38b2f","#f28026","#f0751e","#eb6c1c","#e4641e","#de5d1f","#d75521","#cf4f22","#c64a22","#bc4623","#b24223","#a83e24","#9e3a26"],hs=["#f4d166","#e3cd62","#d3c95f","#c3c55d","#b2c25b","#a3bd5a","#93b958","#84b457","#76af56","#67a956","#5aa355","#4f9e53","#479751","#40914f","#3a8a4d","#34844a","#2d7d45","#257740","#1c713b","#146c36"],vs=["#f4d166","#f5c75f","#f6bc58","#f7b254","#f9a750","#fa9d4f","#fa9d4f","#fb934d","#f7894b","#f47f4a","#f0774a","#eb6349","#e66549","#e15c48","#dc5447","#d64c45","#d04344","#ca3a42","#c43141","#bd273f","#b71d3e"],ps=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],gs=["#729ece","#ff9e4a","#67bf5c","#ed665d","#ad8bc9","#a8786e","#ed97ca","#a2a2a2","#cdcc5d","#6dccda"],ms=["#aec7e8","#ffbb78","#98df8a","#ff9896","#c5b0d5","#c49c94","#f7b6d2","#c7c7c7","#dbdb8d","#9edae5"],ys=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],bs=["#60636a","#a5acaf","#414451","#8f8782","#cfcfcf"],ws=["#006ba4","#ff800e","#ababab","#595959","#5f9ed1","#c85200","#898989","#a2c8ec","#ffbc79","#cfcfcf"],Cs=["#b10318","#dba13a","#309343","#d82526","#ffc156","#69b764","#f26c64","#ffdd71","#9fcd99"],Ss=["#7b66d2","#dc5fbd","#94917b","#995688","#d098ee","#d7d5c5"],Es=["#7b66d2","#a699e8","#dc5fbd","#ffc0da","#5f5a41","#b4b19b","#995688","#d898ba","#ab6ad5","#d098ee","#8b7c6e","#dbd4c5"],ks=["#32a251","#ff7f0f","#3cb7cc","#ffd94a","#39737c","#b85a0d"],Ts=["#32a251","#acd98d","#ff7f0f","#ffb977","#3cb7cc","#98d9e4","#b85a0d","#ffd94a","#39737c","#86b4a9","#82853b","#ccc94d"],_s=["#2c69b0","#f02720","#ac613c","#6ba3d6","#ea6b73","#e9c39b"],xs=["#2c69b0","#b5c8e2","#f02720","#ffb6b0","#ac613c","#e9c39b","#6ba3d6","#b5dffd","#ac8763","#ddc9b4","#bd0a36","#f4737a"],Ds=["#1f83b4","#12a2a8","#2ca030","#78a641","#bcbd22","#ffbf50","#ffaa0e","#ff7f0e","#d63a3a","#c7519c","#ba43b4","#8a60b0","#6f63bb"],Rs=["#bccfb4","#94bb83","#69a761","#339444","#27823b","#1a7232","#09622a"],Is=["#c3c3c3","#b2b2b2","#a2a2a2","#929292","#838383","#747474","#666666","#585858","#4b4b4b","#3f3f3f","#333333","#282828","#1e1e1e"],Os=["#b4d4da","#7bc8e2","#67add4","#3a87b7","#1c73b1","#1c5998","#26456e"],As=["#eac0bd","#f89a90","#f57667","#e35745","#d8392c","#cf1719","#c21417","#b10c1d","#9c0824"],Ns=["#f0c294","#fdab67","#fd8938","#f06511","#d74401","#a33202","#7b3014"],Ms=["#f5cac7","#fbb3ab","#fd9c8f","#fe8b7a","#fd7864","#f46b55","#ea5e45","#e04e35","#d43e25","#c92b14","#bd1100"],Ls=["#dbe8b4","#c3e394","#acdc7a","#9ad26d","#8ac765","#7abc5f","#6cae59","#60a24d","#569735","#4a8c1c","#3c8200"],Ps=["#f3e0c2","#f6d29c","#f7c577","#f0b763","#e4aa63","#d89c63","#cc8f63","#c08262","#bb7359","#bb6348","#bb5137"],Fs=["#9c0824","#bd1316","#d11719","#df513f","#fc8375","#cacaca","#a2c18f","#69a761","#2f8e41","#1e7735","#09622a"],Bs=["#9c0824","#bd1316","#d11719","#df513f","#fc8375","#cacaca","#67add4","#3a87b7","#1c73b1","#1c5998","#26456e"],Hs=["#9c0824","#bd1316","#d11719","#df513f","#fc8375","#cacaca","#9b9b9b","#777777","#565656","#383838","#1e1e1e"],$s=["#bd1100","#c82912","#d23a21","#dc4930","#e6583e","#ef654d","#f7705b","#fd7e6b","#fe8e7e","#fca294","#e9dabe","#c7e298","#b1de7f","#a0d571","#90cb68","#82c162","#75b65d","#69aa56","#5ea049","#559633","#4a8c1c"],Ws=["#7b3014","#a33202","#d74401","#f06511","#fd8938","#fdab67","#cacaca","#7bc8e2","#67add4","#3a87b7","#1c73b1","#1c5998","#26456e"],Us=["#09622a","#1e7735","#2f8e41","#69a761","#a2c18f","#cacaca","#67add4","#3a87b7","#1c73b1","#1c5998","#26456e"],js=["#9c0824","#b41f27","#cc312b","#e86753","#fcb4a5","#ffffff","#b9d7b7","#74af72","#428f49","#297839","#09622a"],Vs=["#9c0824","#b41f27","#cc312b","#e86753","#fcb4a5","#ffffff","#bfbfbf","#838383","#575757","#393939","#1e1e1e"],zs=["#7b3014","#a84415","#d85a13","#fb8547","#ffc2a1","#ffffff","#b7cde2","#6a9ec5","#3679a8","#2e5f8a","#26456e"],qs=["#ffc2c5","#ffd1d3","#ffe0e1","#fff0f0","#ffffff","#f3f3f3","#e8e8e8","#dddddd","#d1d1d1","#c6c6c6"],Ys=["#ffcc9e","#ffd6b1","#ffe0c5","#ffead8","#fff5eb","#ffffff","#f3f7fd","#e8effa","#dce8f8","#d0e0f6","#c4d8f3"],Gs=["#ffb2b6","#ffc2c5","#ffd1d3","#ffe0e1","#fff0f0","#ffffff","#f1faed","#e3f5db","#d5f0ca","#c6ebb8","#b7e6a7"],Xs=["#ffb2b6","#fcbdc0","#f8c7c9","#f2d1d2","#ecdbdc","#e5e5e5","#dde6d9","#d4e6cc","#cae6c0","#c1e6b4","#b7e6a7"];var Ks=Object.freeze({Tableau10:ko,Tableau20:To,ColorBlind10:_o,SeattleGrays5:xo,Traffic9:Do,MillerStone11:Ro,SuperfishelStone10:Io,NurielStone9:Oo,JewelBright9:Ao,Summer8:No,Winter10:Mo,GreenOrangeTeal12:Lo,RedBlueBrown12:Po,PurplePinkGray12:Fo,HueCircle19:Bo,OrangeBlue7:Ho,RedGreen7:$o,GreenBlue7:Wo,RedBlue7:Uo,RedBlack7:jo,GoldPurple7:Vo,RedGreenGold7:zo,SunsetSunrise7:qo,OrangeBlueWhite7:Yo,RedGreenWhite7:Go,GreenBlueWhite7:Xo,RedBlueWhite7:Ko,RedBlackWhite7:Jo,OrangeBlueLight7:Qo,Temperature7:Zo,BlueGreen7:es,BlueLight7:ts,OrangeLight7:rs,Blue20:ns,Orange20:is,Green20:as,Red20:os,Purple20:ss,Brown20:ls,Gray20:us,GrayWarm20:fs,BlueTeal20:cs,OrangeGold20:ds,GreenGold20:hs,RedGold21:vs,Classic10:ps,ClassicMedium10:gs,ClassicLight10:ms,Classic20:ys,ClassicGray5:bs,ClassicColorBlind10:ws,ClassicTrafficLight9:Cs,ClassicPurpleGray6:Ss,ClassicPurpleGray12:Es,ClassicGreenOrange6:ks,ClassicGreenOrange12:Ts,ClassicBlueRed6:_s,ClassicBlueRed12:xs,ClassicCyclic13:Ds,ClassicGreen7:Rs,ClassicGray13:Is,ClassicBlue7:Os,ClassicRed9:As,ClassicOrange7:Ns,ClassicAreaRed11:Ms,ClassicAreaGreen11:Ls,ClassicAreaBrown11:Ps,ClassicRedGreen11:Fs,ClassicRedBlue11:Bs,ClassicRedBlack11:Hs,ClassicAreaRedGreen21:$s,ClassicOrangeBlue13:Ws,ClassicGreenBlue11:Us,ClassicRedWhiteGreen11:js,ClassicRedWhiteBlack11:Vs,ClassicOrangeWhiteBlue11:zs,ClassicRedWhiteBlackLight10:qs,ClassicOrangeWhiteBlueLight11:Ys,ClassicRedWhiteGreenLight11:Gs,ClassicRedGreenLight11:Xs});var Js={brewer:Jn,office:Eo,tableau:Ks};var Qs=a.helpers;var Zs=a.DatasetController.prototype.removeHoverStyle.length===2;var el="$colorschemes";a.defaults.global.plugins.colorschemes={scheme:"brewer.Paired12",fillAlpha:.5,reverse:false,override:false};function tl(e){var t,r,n,i;if(Qs.isArray(e)){return e}else if(typeof e==="string"){t=a.colorschemes||{};r=e.match(/^(brewer\.\w+)([1-3])-(\d+)$/);if(r){e=r[1]+["One","Two","Three"][r[2]-1]+r[3]}else if(e==="office.Office2007-2010-6"){e="office.OfficeClassic6"}n=e.split(".");i=t[n[0]];if(i){return i[n[1]]}}}var rl={id:"colorschemes",beforeUpdate:function(r,e){var n=tl(e.scheme);var i=e.fillAlpha;var a=e.reverse;var o=e.override;var t=e.custom;var s,l,u,f,c;if(n){if(typeof t==="function"){s=n.slice();l=t(s);if(Qs.isArray(l)&&l.length){n=l}else if(Qs.isArray(s)&&s.length){n=s}}u=n.length;r.config.data.datasets.forEach(function(e,t){f=t%u;c=n[a?u-f-1:f];e[el]={};switch(e.type||r.config.type){case"line":case"radar":case"scatter":if(typeof e.backgroundColor==="undefined"||o){e[el].backgroundColor=e.backgroundColor;e.backgroundColor=Qs.color(c).alpha(i).rgbString()}if(typeof e.borderColor==="undefined"||o){e[el].borderColor=e.borderColor;e.borderColor=c}if(typeof e.pointBackgroundColor==="undefined"||o){e[el].pointBackgroundColor=e.pointBackgroundColor;e.pointBackgroundColor=Qs.color(c).alpha(i).rgbString()}if(typeof e.pointBorderColor==="undefined"||o){e[el].pointBorderColor=e.pointBorderColor;e.pointBorderColor=c}break;case"doughnut":case"pie":case"polarArea":if(typeof e.backgroundColor==="undefined"||o){e[el].backgroundColor=e.backgroundColor;e.backgroundColor=e.data.map(function(e,t){f=t%u;return n[a?u-f-1:f]})}break;default:if(typeof e.backgroundColor==="undefined"||o){e[el].backgroundColor=e.backgroundColor;e.backgroundColor=c}break}})}},afterUpdate:function(e){e.config.data.datasets.forEach(function(e){if(e[el]){if(e[el].hasOwnProperty("backgroundColor")){e.backgroundColor=e[el].backgroundColor}if(e[el].hasOwnProperty("borderColor")){e.borderColor=e[el].borderColor}if(e[el].hasOwnProperty("pointBackgroundColor")){e.pointBackgroundColor=e[el].pointBackgroundColor}if(e[el].hasOwnProperty("pointBorderColor")){e.pointBorderColor=e[el].pointBorderColor}delete e[el]}})},beforeEvent:function(e,t,r){if(Zs){this.beforeUpdate(e,r)}},afterEvent:function(e){if(Zs){this.afterUpdate(e)}}};a.plugins.register(rl);a.colorschemes=Js;return rl});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.Fuse=t())})(this,function(){"use strict";function t(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){t=function(e){return typeof e}}else{t=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return t(e)}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function e(e,t,r){if(t)n(e.prototype,t);if(r)n(e,r);return e}function i(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2){a(Object(r),true).forEach(function(e){i(t,e,r[e])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}else{a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}}return t}function b(e){return r(e)||s(e)||l(e)||f()}function r(e){if(Array.isArray(e))return u(e)}function s(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function l(e,t){if(!e)return;if(typeof e==="string")return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}function u(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return!Array.isArray?E(e)==="[object Array]":Array.isArray(e)}var c=1/0;function h(e){if(typeof e=="string"){return e}var t=e+"";return t=="0"&&1/e==-c?"-0":t}function v(e){return e==null?"":h(e)}function p(e){return typeof e==="string"}function g(e){return typeof e==="number"}function m(e){return e===true||e===false||w(e)&&E(e)=="[object Boolean]"}function y(e){return t(e)==="object"}function w(e){return y(e)&&e!==null}function C(e){return e!==undefined&&e!==null}function S(e){return!e.trim().length}function E(e){return e==null?e===undefined?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var k="Extended search is not available";var T="Logical search is not available";var x="Incorrect 'index' type";var D=function e(t){return"Invalid value for key ".concat(t)};var z=function e(t){return"Pattern length exceeds max of ".concat(t,".")};var R=function e(t){return"Missing ".concat(t," property in key")};var I=function e(t){return"Property 'weight' in key '".concat(t,"' must be a positive integer")};var O=Object.prototype.hasOwnProperty;var A=function(){function t(e){var r=this;_(this,t);this._keys=[];this._keyMap={};var n=0;e.forEach(function(e){var t=N(e);n+=t.weight;r._keys.push(t);r._keyMap[t.id]=t;n+=t.weight});this._keys.forEach(function(e){e.weight/=n})}e(t,[{key:"get",value:function e(t){return this._keyMap[t]}},{key:"keys",value:function e(){return this._keys}},{key:"toJson",value:function e(){return JSON.stringify(this._keys)}}]);return t}();function N(e){var t=null;var r=null;var n=null;var i=1;if(p(e)||d(e)){n=e;t=M(e);r=L(e)}else{if(!O.call(e,"name")){throw new Error(R("name"))}var a=e.name;n=a;if(O.call(e,"weight")){i=e.weight;if(i<=0){throw new Error(I(a))}}t=M(a);r=L(a)}return{path:t,id:r,weight:i,src:n}}function M(e){return d(e)?e:e.split(".")}function L(e){return d(e)?e.join("."):e}function P(e,t){var l=[];var u=false;var r=function e(t,r,n){if(!C(t)){return}if(!r[n]){l.push(t)}else{var i=r[n];var a=t[i];if(!C(a)){return}if(n===r.length-1&&(p(a)||g(a)||m(a))){l.push(v(a))}else if(d(a)){u=true;for(var o=0,s=a.length;o<s;o+=1){e(a[o],r,n+1)}}else if(r.length){e(a,r,n+1)}}};r(e,p(t)?t.split("."):t,0);return u?l:l[0]}var F={includeMatches:false,findAllMatches:false,minMatchCharLength:1};var B={isCaseSensitive:false,includeScore:false,keys:[],shouldSort:true,sortFn:function e(t,r){return t.score===r.score?t.idx<r.idx?-1:1:t.score<r.score?-1:1}};var H={location:0,threshold:.6,distance:100};var $={useExtendedSearch:false,getFn:P,ignoreLocation:false,ignoreFieldNorm:false};var q=o({},B,{},F,{},H,{},$);var W=/[^ ]+/g;function U(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:3;var a=new Map;var o=Math.pow(10,e);return{get:function e(t){var r=t.match(W).length;if(a.has(r)){return a.get(r)}var n=1/Math.sqrt(r);var i=parseFloat(Math.round(n*o)/o);a.set(r,i);return i},clear:function e(){a.clear()}}}var j=function(){function n(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.getFn,r=t===void 0?q.getFn:t;_(this,n);this.norm=U(3);this.getFn=r;this.isCreated=false;this.setIndexRecords()}e(n,[{key:"setSources",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.docs=t}},{key:"setIndexRecords",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.records=t}},{key:"setKeys",value:function e(){var r=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.keys=t;this._keysMap={};t.forEach(function(e,t){r._keysMap[e.id]=t})}},{key:"create",value:function e(){var r=this;if(this.isCreated||!this.docs.length){return}this.isCreated=true;if(p(this.docs[0])){this.docs.forEach(function(e,t){r._addString(e,t)})}else{this.docs.forEach(function(e,t){r._addObject(e,t)})}this.norm.clear()}},{key:"add",value:function e(t){var r=this.size();if(p(t)){this._addString(t,r)}else{this._addObject(t,r)}}},{key:"removeAt",value:function e(t){this.records.splice(t,1);for(var r=t,n=this.size();r<n;r+=1){this.records[r].i-=1}}},{key:"getValueForItemAtKeyId",value:function e(t,r){return t[this._keysMap[r]]}},{key:"size",value:function e(){return this.records.length}},{key:"_addString",value:function e(t,r){if(!C(t)||S(t)){return}var n={v:t,i:r,n:this.norm.get(t)};this.records.push(n)}},{key:"_addObject",value:function e(r,t){var l=this;var u={i:t,$:{}};this.keys.forEach(function(e,o){var s=l.getFn(r,e.path);if(!C(s)){return}if(d(s)){(function(){var e=[];var r=[{nestedArrIndex:-1,value:s}];while(r.length){var t=r.pop(),n=t.nestedArrIndex,i=t.value;if(!C(i)){continue}if(p(i)&&!S(i)){var a={v:i,i:n,n:l.norm.get(i)};e.push(a)}else if(d(i)){i.forEach(function(e,t){r.push({nestedArrIndex:t,value:e})})}}u.$[o]=e})()}else if(!S(s)){var t={v:s,n:l.norm.get(s)};u.$[o]=t}});this.records.push(u)}},{key:"toJson",value:function e(){return{keys:this.keys,records:this.records}}}]);return n}();function V(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},n=r.getFn,i=n===void 0?q.getFn:n;var a=new j({getFn:i});a.setKeys(e.map(N));a.setSources(t);a.create();return a}function Y(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},r=t.getFn,n=r===void 0?q.getFn:r;var i=e.keys,a=e.records;var o=new j({getFn:n});o.setKeys(i);o.setIndexRecords(a);return o}function G(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},r=t.errors,n=r===void 0?0:r,i=t.currentLocation,a=i===void 0?0:i,o=t.expectedLocation,s=o===void 0?0:o,l=t.distance,u=l===void 0?q.distance:l,f=t.ignoreLocation,c=f===void 0?q.ignoreLocation:f;var d=n/e.length;if(c){return d}var h=Math.abs(s-a);if(!u){return h?1:d}return d+h/u}function X(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:q.minMatchCharLength;var r=[];var n=-1;var i=-1;var a=0;for(var o=e.length;a<o;a+=1){var s=e[a];if(s&&n===-1){n=a}else if(!s&&n!==-1){i=a-1;if(i-n+1>=t){r.push([n,i])}n=-1}}if(e[a-1]&&a-n>=t){r.push([n,a-1])}return r}var K=32;function J(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},i=n.location,a=i===void 0?q.location:i,o=n.distance,s=o===void 0?q.distance:o,l=n.threshold,u=l===void 0?q.threshold:l,f=n.findAllMatches,c=f===void 0?q.findAllMatches:f,d=n.minMatchCharLength,h=d===void 0?q.minMatchCharLength:d,v=n.includeMatches,p=v===void 0?q.includeMatches:v,g=n.ignoreLocation,m=g===void 0?q.ignoreLocation:g;if(t.length>K){throw new Error(z(K))}var y=t.length;var b=e.length;var w=Math.max(0,Math.min(a,b));var C=u;var S=w;var E=h>1||p;var k=E?Array(b):[];var T;while((T=e.indexOf(t,S))>-1){var _=G(t,{currentLocation:T,expectedLocation:w,distance:s,ignoreLocation:m});C=Math.min(_,C);S=T+y;if(E){var x=0;while(x<y){k[T+x]=1;x+=1}}}S=-1;var D=[];var R=1;var I=y+b;var O=1<<y-1;for(var A=0;A<y;A+=1){var N=0;var M=I;while(N<M){var L=G(t,{errors:A,currentLocation:w+M,expectedLocation:w,distance:s,ignoreLocation:m});if(L<=C){N=M}else{I=M}M=Math.floor((I-N)/2+N)}I=M;var P=Math.max(1,w-M+1);var F=c?b:Math.min(w+M,b)+y;var B=Array(F+2);B[F+1]=(1<<A)-1;for(var H=F;H>=P;H-=1){var $=H-1;var W=r[e.charAt($)];if(E){k[$]=+!!W}B[H]=(B[H+1]<<1|1)&W;if(A){B[H]|=(D[H+1]|D[H])<<1|1|D[H+1]}if(B[H]&O){R=G(t,{errors:A,currentLocation:$,expectedLocation:w,distance:s,ignoreLocation:m});if(R<=C){C=R;S=$;if(S<=w){break}P=Math.max(1,2*w-S)}}}var U=G(t,{errors:A+1,currentLocation:w,expectedLocation:w,distance:s,ignoreLocation:m});if(U>C){break}D=B}var j={isMatch:S>=0,score:Math.max(.001,R)};if(E){var V=X(k,h);if(!V.length){j.isMatch=false}else if(p){j.indices=V}}return j}function Q(e){var t={};for(var r=0,n=e.length;r<n;r+=1){var i=e.charAt(r);t[i]=(t[i]||0)|1<<n-r-1}return t}var Z=function(){function T(e){var n=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},r=t.location,i=r===void 0?q.location:r,a=t.threshold,o=a===void 0?q.threshold:a,s=t.distance,l=s===void 0?q.distance:s,u=t.includeMatches,f=u===void 0?q.includeMatches:u,c=t.findAllMatches,d=c===void 0?q.findAllMatches:c,h=t.minMatchCharLength,v=h===void 0?q.minMatchCharLength:h,p=t.isCaseSensitive,g=p===void 0?q.isCaseSensitive:p,m=t.ignoreLocation,y=m===void 0?q.ignoreLocation:m;_(this,T);this.options={location:i,threshold:o,distance:l,includeMatches:f,findAllMatches:d,minMatchCharLength:v,isCaseSensitive:g,ignoreLocation:y};this.pattern=g?e:e.toLowerCase();this.chunks=[];if(!this.pattern.length){return}var b=function e(t,r){n.chunks.push({pattern:t,alphabet:Q(t),startIndex:r})};var w=this.pattern.length;if(w>K){var C=0;var S=w%K;var E=w-S;while(C<E){b(this.pattern.substr(C,K),C);C+=K}if(S){var k=w-K;b(this.pattern.substr(k),k)}}else{b(this.pattern,0)}}e(T,[{key:"searchIn",value:function e(l){var t=this.options,r=t.isCaseSensitive,u=t.includeMatches;if(!r){l=l.toLowerCase()}if(this.pattern===l){var n={isMatch:true,score:0};if(u){n.indices=[[0,l.length-1]]}return n}var i=this.options,f=i.location,c=i.distance,d=i.threshold,h=i.findAllMatches,v=i.minMatchCharLength,p=i.ignoreLocation;var g=[];var m=0;var y=false;this.chunks.forEach(function(e){var t=e.pattern,r=e.alphabet,n=e.startIndex;var i=J(l,t,r,{location:f+n,distance:c,threshold:d,findAllMatches:h,minMatchCharLength:v,includeMatches:u,ignoreLocation:p}),a=i.isMatch,o=i.score,s=i.indices;if(a){y=true}m+=o;if(a&&s){g=[].concat(b(g),b(s))}});var a={isMatch:y,score:y?m/this.chunks.length:1};if(y&&u){a.indices=g}return a}}]);return T}();var ee=[];function te(e,t){for(var r=0,n=ee.length;r<n;r+=1){var i=ee[r];if(i.condition(e,t)){return new i(e,t)}}return new Z(e,t)}var re={AND:"$and",OR:"$or"};var ne={PATH:"$path",PATTERN:"$val"};var ie=function e(t){return!!(t[re.AND]||t[re.OR])};var ae=function e(t){return!!t[ne.PATH]};var oe=function e(t){return!d(t)&&y(t)&&!ie(t)};var se=function e(t){return i({},re.AND,Object.keys(t).map(function(e){return i({},e,t[e])}))};function le(e,l){var t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},r=t.auto,u=r===void 0?true:r;var n=function r(n){var e=Object.keys(n);var t=ae(n);if(!t&&e.length>1&&!ie(n)){return r(se(n))}if(oe(n)){var i=t?n[ne.PATH]:e[0];var a=t?n[ne.PATTERN]:n[i];if(!p(a)){throw new Error(D(i))}var o={keyId:L(i),pattern:a};if(u){o.searcher=te(a,l)}return o}var s={children:[],operator:e[0]};e.forEach(function(e){var t=n[e];if(d(t)){t.forEach(function(e){s.children.push(r(e))})}});return s};if(!ie(e)){e=se(e)}return n(e)}function ue(e,t){var r=t.ignoreFieldNorm,o=r===void 0?q.ignoreFieldNorm:r;e.forEach(function(e){var a=1;e.matches.forEach(function(e){var t=e.key,r=e.norm,n=e.score;var i=t?t.weight:null;a*=Math.pow(n===0&&i?Number.EPSILON:n,(i||1)*(o?1:r))});e.score=a})}function fe(e,i){var t=e.matches;i.matches=[];if(!C(t)){return}t.forEach(function(e){if(!C(e.indices)||!e.indices.length){return}var t=e.indices,r=e.value;var n={indices:t,value:r};if(e.key){n.key=e.key.src}if(e.idx>-1){n.refIndex=e.idx}i.matches.push(n)})}function ce(e,t){t.score=e.score}function de(e,n){var t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},r=t.includeMatches,i=r===void 0?q.includeMatches:r,a=t.includeScore,o=a===void 0?q.includeScore:a;var s=[];if(i)s.push(fe);if(o)s.push(ce);return e.map(function(t){var e=t.idx;var r={item:n[e],refIndex:e};if(s.length){s.forEach(function(e){e(t,r)})}return r})}var he=function(){function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments.length>2?arguments[2]:undefined;_(this,n);this.options=o({},q,{},t);if(this.options.useExtendedSearch&&!false){throw new Error(k)}this._keyStore=new A(this.options.keys);this.setCollection(e,r)}e(n,[{key:"setCollection",value:function e(t,r){this._docs=t;if(r&&!(r instanceof j)){throw new Error(x)}this._myIndex=r||V(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function e(t){if(!C(t)){return}this._docs.push(t);this._myIndex.add(t)}},{key:"remove",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){return false};var r=[];for(var n=0,i=this._docs.length;n<i;n+=1){var a=this._docs[n];if(t(a,n)){this.removeAt(n);n-=1;i-=1;r.push(a)}}return r}},{key:"removeAt",value:function e(t){this._docs.splice(t,1);this._myIndex.removeAt(t)}},{key:"getIndex",value:function e(){return this._myIndex}},{key:"search",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},n=r.limit,i=n===void 0?-1:n;var a=this.options,o=a.includeMatches,s=a.includeScore,l=a.shouldSort,u=a.sortFn,f=a.ignoreFieldNorm;var c=p(t)?p(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);ue(c,{ignoreFieldNorm:f});if(l){c.sort(u)}if(g(i)&&i>-1){c=c.slice(0,i)}return de(c,this._docs,{includeMatches:o,includeScore:s})}},{key:"_searchStringList",value:function e(t){var l=te(t,this.options);var r=this._myIndex.records;var u=[];r.forEach(function(e){var t=e.v,r=e.i,n=e.n;if(!C(t)){return}var i=l.searchIn(t),a=i.isMatch,o=i.score,s=i.indices;if(a){u.push({item:t,idx:r,matches:[{score:o,value:t,norm:n,indices:s}]})}});return u}},{key:"_searchLogical",value:function e(t){{throw new Error(T)}}},{key:"_searchObjectList",value:function e(t){var i=this;var a=te(t,this.options);var r=this._myIndex,o=r.keys,n=r.records;var s=[];n.forEach(function(e){var r=e.$,t=e.i;if(!C(r)){return}var n=[];o.forEach(function(e,t){n.push.apply(n,b(i._findMatches({key:e,value:r[t],searcher:a})))});if(n.length){s.push({idx:t,item:r,matches:n})}});return s}},{key:"_findMatches",value:function e(t){var l=t.key,r=t.value,u=t.searcher;if(!C(r)){return[]}var f=[];if(d(r)){r.forEach(function(e){var t=e.v,r=e.i,n=e.n;if(!C(t)){return}var i=u.searchIn(t),a=i.isMatch,o=i.score,s=i.indices;if(a){f.push({score:o,key:l,value:t,idx:r,norm:n,indices:s})}})}else{var n=r.v,i=r.n;var a=u.searchIn(n),o=a.isMatch,s=a.score,c=a.indices;if(o){f.push({score:s,key:l,value:n,norm:i,indices:c})}}return f}}]);return n}();he.version="6.4.6";he.createIndex=V;he.parseIndex=Y;he.config=q;{he.parseQuery=le}return he});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.Mustache=t())})(this,function(){"use strict";var r=Object.prototype.toString;var k=Array.isArray||function e(t){return r.call(t)==="[object Array]"};function d(e){return typeof e==="function"}function a(e){return k(e)?"array":typeof e}function T(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function u(e,t){return e!=null&&typeof e==="object"&&t in e}function f(e,t){return e!=null&&typeof e!=="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var n=RegExp.prototype.test;function t(e,t){return n.call(e,t)}var i=/\S/;function _(e){return!t(i,e)}var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function e(e){return String(e).replace(/[&<>"'`=\/]/g,function e(t){return o[t]})}var x=/\s*/;var D=/\s+/;var R=/\s*=/;var I=/\s*\}/;var O=/#|\^|\/|>|\{|&|=|!/;function s(e,t){if(!e)return[];var r=false;var n=[];var i=[];var a=[];var o=false;var s=false;var l="";var u=0;function f(){if(o&&!s){while(a.length)delete i[a.pop()]}else{a=[]}o=false;s=false}var c,d,h;function v(e){if(typeof e==="string")e=e.split(D,2);if(!k(e)||e.length!==2)throw new Error("Invalid tags: "+e);c=new RegExp(T(e[0])+"\\s*");d=new RegExp("\\s*"+T(e[1]));h=new RegExp("\\s*"+T("}"+e[1]))}v(t||L.tags);var p=new M(e);var g,m,y,b,w,C;while(!p.eos()){g=p.pos;y=p.scanUntil(c);if(y){for(var S=0,E=y.length;S<E;++S){b=y.charAt(S);if(_(b)){a.push(i.length);l+=b}else{s=true;r=true;l+=" "}i.push(["text",b,g,g+1]);g+=1;if(b==="\n"){f();l="";u=0;r=false}}}if(!p.scan(c))break;o=true;m=p.scan(O)||"name";p.scan(x);if(m==="="){y=p.scanUntil(R);p.scan(R);p.scanUntil(d)}else if(m==="{"){y=p.scanUntil(h);p.scan(I);p.scanUntil(d);m="&"}else{y=p.scanUntil(d)}if(!p.scan(d))throw new Error("Unclosed tag at "+p.pos);if(m==">"){w=[m,y,g,p.pos,l,u,r]}else{w=[m,y,g,p.pos]}u++;i.push(w);if(m==="#"||m==="^"){n.push(w)}else if(m==="/"){C=n.pop();if(!C)throw new Error('Unopened section "'+y+'" at '+g);if(C[1]!==y)throw new Error('Unclosed section "'+C[1]+'" at '+g)}else if(m==="name"||m==="{"||m==="&"){s=true}else if(m==="="){v(y)}}f();C=n.pop();if(C)throw new Error('Unclosed section "'+C[1]+'" at '+p.pos);return N(A(i))}function A(e){var t=[];var r,n;for(var i=0,a=e.length;i<a;++i){r=e[i];if(r){if(r[0]==="text"&&n&&n[0]==="text"){n[1]+=r[1];n[3]=r[3]}else{t.push(r);n=r}}}return t}function N(e){var t=[];var r=t;var n=[];var i,a;for(var o=0,s=e.length;o<s;++o){i=e[o];switch(i[0]){case"#":case"^":r.push(i);n.push(i);r=i[4]=[];break;case"/":a=n.pop();a[5]=i[2];r=n.length>0?n[n.length-1][4]:t;break;default:r.push(i)}}return t}function M(e){this.string=e;this.tail=e;this.pos=0}M.prototype.eos=function e(){return this.tail===""};M.prototype.scan=function e(t){var r=this.tail.match(t);if(!r||r.index!==0)return"";var n=r[0];this.tail=this.tail.substring(n.length);this.pos+=n.length;return n};M.prototype.scanUntil=function e(t){var r=this.tail.search(t),n;switch(r){case-1:n=this.tail;this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r);this.tail=this.tail.substring(r)}this.pos+=n.length;return n};function l(e,t){this.view=e;this.cache={".":this.view};this.parent=t}l.prototype.push=function e(t){return new l(t,this)};l.prototype.lookup=function e(t){var r=this.cache;var n;if(r.hasOwnProperty(t)){n=r[t]}else{var i=this,a,o,s,l=false;while(i){if(t.indexOf(".")>0){a=i.view;o=t.split(".");s=0;while(a!=null&&s<o.length){if(s===o.length-1)l=u(a,o[s])||f(a,o[s]);a=a[o[s++]]}}else{a=i.view[t];l=u(i.view,t)}if(l){n=a;break}i=i.parent}r[t]=n}if(d(n))n=n.call(this.view);return n};function c(){this.templateCache={_cache:{},set:function e(t,r){this._cache[t]=r},get:function e(t){return this._cache[t]},clear:function e(){this._cache={}}}}c.prototype.clearCache=function e(){if(typeof this.templateCache!=="undefined"){this.templateCache.clear()}};c.prototype.parse=function e(t,r){var n=this.templateCache;var i=t+":"+(r||L.tags).join(":");var a=typeof n!=="undefined";var o=a?n.get(i):undefined;if(o==undefined){o=s(t,r);a&&n.set(i,o)}return o};c.prototype.render=function e(t,r,n,i){var a=this.getConfigTags(i);var o=this.parse(t,a);var s=r instanceof l?r:new l(r,undefined);return this.renderTokens(o,s,n,t,i)};c.prototype.renderTokens=function e(t,r,n,i,a){var o="";var s,l,u;for(var f=0,c=t.length;f<c;++f){u=undefined;s=t[f];l=s[0];if(l==="#")u=this.renderSection(s,r,n,i,a);else if(l==="^")u=this.renderInverted(s,r,n,i,a);else if(l===">")u=this.renderPartial(s,r,n,a);else if(l==="&")u=this.unescapedValue(s,r);else if(l==="name")u=this.escapedValue(s,r,a);else if(l==="text")u=this.rawValue(s);if(u!==undefined)o+=u}return o};c.prototype.renderSection=function e(t,r,n,i,a){var o=this;var s="";var l=r.lookup(t[1]);function u(e){return o.render(e,r,n,a)}if(!l)return;if(k(l)){for(var f=0,c=l.length;f<c;++f){s+=this.renderTokens(t[4],r.push(l[f]),n,i,a)}}else if(typeof l==="object"||typeof l==="string"||typeof l==="number"){s+=this.renderTokens(t[4],r.push(l),n,i,a)}else if(d(l)){if(typeof i!=="string")throw new Error("Cannot use higher-order sections without the original template");l=l.call(r.view,i.slice(t[3],t[5]),u);if(l!=null)s+=l}else{s+=this.renderTokens(t[4],r,n,i,a)}return s};c.prototype.renderInverted=function e(t,r,n,i,a){var o=r.lookup(t[1]);if(!o||k(o)&&o.length===0)return this.renderTokens(t[4],r,n,i,a)};c.prototype.indentPartial=function e(t,r,n){var i=r.replace(/[^ \t]/g,"");var a=t.split("\n");for(var o=0;o<a.length;o++){if(a[o].length&&(o>0||!n)){a[o]=i+a[o]}}return a.join("\n")};c.prototype.renderPartial=function e(t,r,n,i){if(!n)return;var a=this.getConfigTags(i);var o=d(n)?n(t[1]):n[t[1]];if(o!=null){var s=t[6];var l=t[5];var u=t[4];var f=o;if(l==0&&u){f=this.indentPartial(o,u,s)}var c=this.parse(f,a);return this.renderTokens(c,r,n,f,i)}};c.prototype.unescapedValue=function e(t,r){var n=r.lookup(t[1]);if(n!=null)return n};c.prototype.escapedValue=function e(t,r,n){var i=this.getConfigEscape(n)||L.escape;var a=r.lookup(t[1]);if(a!=null)return typeof a==="number"&&i===L.escape?String(a):i(a)};c.prototype.rawValue=function e(t){return t[1]};c.prototype.getConfigTags=function e(t){if(k(t)){return t}else if(t&&typeof t==="object"){return t.tags}else{return undefined}};c.prototype.getConfigEscape=function e(t){if(t&&typeof t==="object"&&!k(t)){return t.escape}else{return undefined}};var L={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:undefined,escape:undefined,parse:undefined,render:undefined,Scanner:undefined,Context:undefined,Writer:undefined,set templateCache(e){h.templateCache=e},get templateCache(){return h.templateCache}};var h=new c;L.clearCache=function e(){return h.clearCache()};L.parse=function e(t,r){return h.parse(t,r)};L.render=function e(t,r,n,i){if(typeof t!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+a(t)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return h.render(t,r,n,i)};L.escape=e;L.Scanner=M;L.Context=l;L.Writer=c;return L});(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof module==="object"&&module.exports){module.exports=t()}else{e.PDFObject=t()}})(this,function(){"use strict";if(typeof window==="undefined"||window.navigator===undefined||window.navigator.userAgent===undefined||window.navigator.mimeTypes===undefined){return false}var e="2.2.3";var t=window.navigator;var r=window.navigator.userAgent;var n="ActiveXObject"in window;var i=window.Promise!==undefined;var a=t.mimeTypes["application/pdf"]!==undefined;var o=t.platform!==undefined&&t.platform==="MacIntel"&&t.maxTouchPoints!==undefined&&t.maxTouchPoints>1;var E=o||/Mobi|Tablet|Android|iPad|iPhone/.test(r);var k=!E&&t.vendor!==undefined&&/Apple/.test(t.vendor)&&/Safari/.test(r);var s=!E&&/irefox/.test(r)&&r.split("rv:").length>1?parseInt(r.split("rv:")[1].split(".")[0],10)>18:false;var l=function(e){var t;try{t=new ActiveXObject(e)}catch(e){t=null}return t};var u=function(){return!!(l("AcroPDF.PDF")||l("PDF.PdfCtrl"))};var T=!E&&(i||s||a||n&&u());var _=function(e){var t="";var r;if(e){for(r in e){if(e.hasOwnProperty(r)){t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])+"&"}}if(t){t="#"+t;t=t.slice(0,t.length-1)}}return t};var x=function(e,t){if(!t){console.log("[PDFObject] "+e)}return false};var c=function(e){while(e.firstChild){e.removeChild(e.firstChild)}};var D=function(e){var t=document.body;if(typeof e==="string"){t=document.querySelector(e)}else if(window.jQuery!==undefined&&e instanceof jQuery&&e.length){t=e.get(0)}else if(e.nodeType!==undefined&&e.nodeType===1){t=e}return t};var R=function(e,t,r,n,i,a){c(e);var o=n+"?file="+encodeURIComponent(t)+r;var s=document.createElement("div");var l=document.createElement("iframe");l.src=o;l.className="pdfobject";l.type="application/pdf";l.frameborder="0";l.allow="fullscreen";if(i){l.id=i}if(!a){s.style.cssText="position: absolute; top: 0; right: 0; bottom: 0; left: 0;";l.style.cssText="border: none; width: 100%; height: 100%;";e.style.position="relative";e.style.overflow="auto"}s.appendChild(l);e.appendChild(s);e.classList.add("pdfobject-container");return e.getElementsByTagName("iframe")[0]};var I=function(e,t,r,n,i,a,o,s,l){c(t);var u=document.createElement(e);u.src=n+i;u.className="pdfobject";u.type="application/pdf";if(s){u.id=s}if(e==="iframe"){u.allow="fullscreen"}if(!l){var f=e==="embed"?"overflow: auto;":"border: none;";if(r&&r!==document.body){f+="width: "+a+"; height: "+o+";"}else{f+="position: absolute; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;"}u.style.cssText=f}t.classList.add("pdfobject-container");t.appendChild(u);return t.getElementsByTagName(e)[0]};var f=function(e,t,r){var n=t||false;var i=r||{};var a=typeof i.id==="string"?i.id:"";var o=i.page||false;var s=i.pdfOpenParams||{};var l=i.fallbackLink||true;var u=i.width||"100%";var f=i.height||"100%";var c=typeof i.assumptionMode==="boolean"?i.assumptionMode:true;var d=typeof i.forcePDFJS==="boolean"?i.forcePDFJS:false;var h=typeof i.supportRedirect==="boolean"?i.supportRedirect:false;var v=typeof i.omitInlineStyles==="boolean"?i.omitInlineStyles:false;var p=typeof i.suppressConsole==="boolean"?i.suppressConsole:false;var g=typeof i.forceIframe==="boolean"?i.forceIframe:false;var m=i.PDFJS_URL||false;var y=D(n);var b="";var w="";var C="<p>This browser does not support inline PDFs. Please download the PDF to view it: <a href='[url]'>Download PDF</a></p>";if(typeof e!=="string"){return x("URL is not valid",p)}if(!y){return x("Target element cannot be determined",p)}if(o){s.page=o}w=_(s);if(d&&m){return R(y,e,w,m,a,v)}if(T||c&&!E){var S=g||h&&k?"iframe":"embed";return I(S,y,t,e,w,u,f,a,v)}if(m){return R(y,e,w,m,a,v)}if(l){b=typeof l==="string"?l:C;y.innerHTML=b.replace(/\[url\]/g,e)}return x("This browser does not support embedded PDFs",p)};return{embed:function(e,t,r){return f(e,t,r)},pdfobjectversion:function(){return e}(),supportsPDFs:function(){return T}()}});!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.printJS=t():e.printJS=t()}(window,function(){return n={},i.m=r={"./src/index.js":function(e,t,r){"use strict";r.r(t);r("./src/sass/index.scss");r=r("./src/js/init.js").default.init;"undefined"!=typeof window&&(window.printJS=r),t.default=r},"./src/js/browser.js":function(e,t,r){"use strict";r.r(t);var n={isFirefox:function(){return"undefined"!=typeof InstallTrigger},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!n.isIE()&&!!window.StyleMedia},isChrome:function(e){return!!(0<arguments.length&&void 0!==e?e:window).chrome},isSafari:function(){return 0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}};t.default=n},"./src/js/functions.js":function(e,t,r){"use strict";r.r(t),r.d(t,"addWrapper",function(){return n}),r.d(t,"capitalizePrint",function(){return s}),r.d(t,"collectStyles",function(){return l}),r.d(t,"addHeader",function(){return u}),r.d(t,"cleanUp",function(){return f}),r.d(t,"isRawHTML",function(){return c});var i=r("./src/js/modal.js"),a=r("./src/js/browser.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){return'<div style="'+("font-family:"+t.font+" !important; font-size: "+t.font_size+" !important; width:100%;")+'">'+e+"</div>"}function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(e,t){for(var r="",n=(document.defaultView||window).getComputedStyle(e,""),i=0;i<n.length;i++)(-1!==t.targetStyles.indexOf("*")||-1!==t.targetStyle.indexOf(n[i])||function(e,t){for(var r=0;r<e.length;r++)if("object"===o(t)&&-1!==t.indexOf(e[r]))return!0;return!1}(t.targetStyles,n[i]))&&n.getPropertyValue(n[i])&&(r+=n[i]+":"+n.getPropertyValue(n[i])+";");return r+="max-width: "+t.maxWidth+"px !important; font-size: "+t.font_size+" !important;"}function u(e,t){var r,n,i=document.createElement("div");c(t.header)?i.innerHTML=t.header:(r=document.createElement("h1"),n=document.createTextNode(t.header),r.appendChild(n),r.setAttribute("style",t.headerStyle),i.appendChild(r)),e.insertBefore(i,e.childNodes[0])}function f(t){t.showModal&&i.default.close(),t.onLoadingEnd&&t.onLoadingEnd(),(t.showModal||t.onLoadingStart)&&window.URL.revokeObjectURL(t.printable);var r="mouseover";(a.default.isChrome()||a.default.isFirefox())&&(r="focus");function n(){window.removeEventListener(r,n),t.onPrintDialogClose();var e=document.getElementById(t.frameId);e&&e.remove()}window.addEventListener(r,n)}function c(e){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(e)}},"./src/js/html.js":function(e,t,r){"use strict";r.r(t);var s=r("./src/js/functions.js"),n=r("./src/js/print.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(e,t){var r,r="object"===i(r=e.printable)&&r&&(r instanceof HTMLElement||1===r.nodeType)?e.printable:document.getElementById(e.printable);r?(e.printableElement=function e(t,r){var n=t.cloneNode();var i=Array.prototype.slice.call(t.childNodes);for(var a=0;a<i.length;a++){var o;-1===r.ignoreElements.indexOf(i[a].id)&&(o=e(i[a],r),n.appendChild(o))}r.scanStyles&&1===t.nodeType&&n.setAttribute("style",Object(s.collectStyles)(t,r));switch(t.tagName){case"SELECT":n.value=t.value;break;case"CANVAS":n.getContext("2d").drawImage(t,0,0)}return n}(r,e),e.header&&Object(s.addHeader)(e.printableElement,e),n.default.send(e,t)):window.console.error("Invalid HTML element id: "+e.printable)}}},"./src/js/image.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/js/functions.js"),a=r("./src/js/print.js"),o=r("./src/js/browser.js");t.default={print:function(n,e){n.printable.constructor!==Array&&(n.printable=[n.printable]),n.printableElement=document.createElement("div"),n.printable.forEach(function(e){var t=document.createElement("img");t.setAttribute("style",n.imageStyle),t.src=e,o.default.isFirefox()&&(r=t.src,t.src=r);var r=document.createElement("div");r.appendChild(t),n.printableElement.appendChild(r)}),n.header&&Object(i.addHeader)(n.printableElement,n),a.default.send(n,e)}}},"./src/js/init.js":function(e,t,r){"use strict";r.r(t);var o=r("./src/js/browser.js"),s=r("./src/js/modal.js"),l=r("./src/js/pdf.js"),u=r("./src/js/html.js"),f=r("./src/js/raw-html.js"),c=r("./src/js/image.js"),d=r("./src/js/json.js");function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var v=["pdf","html","image","json","raw-html"];t.default={init:function(e,t){var r={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(e){throw e},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},n=e;if(void 0===n)throw new Error("printJS expects at least 1 attribute.");switch(h(n)){case"string":r.printable=encodeURI(n),r.fallbackPrintable=r.printable,r.type=t||r.type;break;case"object":for(var i in r.printable=n.printable,r.fallbackPrintable=void 0!==n.fallbackPrintable?n.fallbackPrintable:r.printable,r.fallbackPrintable=r.base64?"data:application/pdf;base64,".concat(r.fallbackPrintable):r.fallbackPrintable,r)"printable"!==i&&"fallbackPrintable"!==i&&(r[i]=(void 0!==n[i]?n:r)[i]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+h(n))}if(!r.printable)throw new Error("Missing printable information.");if(!r.type||"string"!=typeof r.type||-1===v.indexOf(r.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");r.showModal&&s.default.show(r),r.onLoadingStart&&r.onLoadingStart();t=document.getElementById(r.frameId);t&&t.parentNode.removeChild(t);var a=document.createElement("iframe");switch(o.default.isFirefox()?a.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):a.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),a.setAttribute("id",r.frameId),"pdf"!==r.type&&(a.srcdoc="<html><head><title>"+r.documentTitle+"</title>",r.css&&(Array.isArray(r.css)||(r.css=[r.css]),r.css.forEach(function(e){a.srcdoc+='<link rel="stylesheet" href="'+e+'">'})),a.srcdoc+="</head><body></body></html>"),r.type){case"pdf":if(o.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(r.fallbackPrintable,"_blank").focus(),r.onIncompatibleBrowser()}catch(e){r.onError(e)}finally{r.showModal&&s.default.close(),r.onLoadingEnd&&r.onLoadingEnd()}else l.default.print(r,a);break;case"image":c.default.print(r,a);break;case"html":u.default.print(r,a);break;case"raw-html":f.default.print(r,a);break;case"json":d.default.print(r,a)}}}},"./src/js/json.js":function(e,t,r){"use strict";r.r(t);var f=r("./src/js/functions.js"),n=r("./src/js/print.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(t,e){if("object"!==i(t.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof t.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!t.properties||!Array.isArray(t.properties))throw new Error("Invalid properties array for your JSON data.");t.properties=t.properties.map(function(e){return{field:"object"===i(e)?e.field:e,displayName:"object"===i(e)?e.displayName:e,columnSize:"object"===i(e)&&e.columnSize?e.columnSize+";":100/t.properties.length+"%;"}}),t.printableElement=document.createElement("div"),t.header&&Object(f.addHeader)(t.printableElement,t),t.printableElement.innerHTML+=function(e){var t=e.printable,r=e.properties,n='<table style="border-collapse: collapse; width: 100%;">';e.repeatTableHeader&&(n+="<thead>");n+="<tr>";for(var i=0;i<r.length;i++)n+='<th style="width:'+r[i].columnSize+";"+e.gridHeaderStyle+'">'+Object(f.capitalizePrint)(r[i].displayName)+"</th>";n+="</tr>",e.repeatTableHeader&&(n+="</thead>");n+="<tbody>";for(var a=0;a<t.length;a++){n+="<tr>";for(var o=0;o<r.length;o++){var s=t[a],l=r[o].field.split(".");if(1<l.length)for(var u=0;u<l.length;u++)s=s[l[u]];else s=s[r[o].field];n+='<td style="width:'+r[o].columnSize+e.gridStyle+'">'+s+"</td>"}n+="</tr>"}return n+="</tbody></table>"}(t),n.default.send(t,e)}}},"./src/js/modal.js":function(e,t,r){"use strict";r.r(t);var i={show:function(e){var t=document.createElement("div");t.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),t.setAttribute("id","printJS-Modal");var r=document.createElement("div");r.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var n=document.createElement("div");n.setAttribute("class","printClose"),n.setAttribute("id","printClose"),r.appendChild(n);n=document.createElement("span");n.setAttribute("class","printSpinner"),r.appendChild(n);e=document.createTextNode(e.modalMessage);r.appendChild(e),t.appendChild(r),document.getElementsByTagName("body")[0].appendChild(t),document.getElementById("printClose").addEventListener("click",function(){i.close()})},close:function(){var e=document.getElementById("printJS-Modal");e&&e.parentNode.removeChild(e)}};t.default=i},"./src/js/pdf.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/js/print.js"),i=r("./src/js/functions.js");function a(e,t,r){r=new window.Blob([r],{type:"application/pdf"}),r=window.URL.createObjectURL(r);t.setAttribute("src",r),n.default.send(e,t)}t.default={print:function(e,t){var r,n;e.base64?(r=Uint8Array.from(atob(e.printable),function(e){return e.charCodeAt(0)}),a(e,t,r)):(e.printable=/^(blob|http|\/\/)/i.test(e.printable)?e.printable:window.location.origin+("/"!==e.printable.charAt(0)?"/"+e.printable:e.printable),(n=new window.XMLHttpRequest).responseType="arraybuffer",n.addEventListener("error",function(){Object(i.cleanUp)(e),e.onError(n.statusText,n)}),n.addEventListener("load",function(){return-1===[200,201].indexOf(n.status)?(Object(i.cleanUp)(e),void e.onError(n.statusText,n)):void a(e,t,n.response)}),n.open("GET",e.printable,!0),n.send())}}},"./src/js/print.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/js/browser.js"),n=r("./src/js/functions.js"),r={send:function(r,e){document.getElementsByTagName("body")[0].appendChild(e);var n=document.getElementById(r.frameId);n.onload=function(){var e,t;"pdf"!==r.type?((t=n.contentWindow||n.contentDocument).document&&(t=t.document),t.body.appendChild(r.printableElement),"pdf"!==r.type&&r.style&&((e=document.createElement("style")).innerHTML=r.style,t.head.appendChild(e)),0<(t=t.getElementsByTagName("img")).length?function(e){e=e.map(function(e){if(e.src&&e.src!==window.location.href)return r=e,new Promise(function(t){(function e(){r&&void 0!==r.naturalWidth&&0!==r.naturalWidth&&r.complete?t():setTimeout(e,500)})()});var r});return Promise.all(e)}(Array.from(t)).then(function(){return a(n,r)}):a(n,r)):i.default.isFirefox()?setTimeout(function(){return a(n,r)},1e3):a(n,r)}}};function a(t,r){try{if(t.focus(),i.default.isEdge()||i.default.isIE())try{t.contentWindow.document.execCommand("print",!1,null)}catch(e){t.contentWindow.print()}else t.contentWindow.print()}catch(e){r.onError(e)}finally{i.default.isFirefox()&&(t.style.visibility="hidden",t.style.left="-1px"),Object(n.cleanUp)(r)}}t.default=r},"./src/js/raw-html.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/js/print.js");t.default={print:function(e,t){e.printableElement=document.createElement("div"),e.printableElement.setAttribute("style","width:100%"),e.printableElement.innerHTML=e.printable,n.default.send(e,t)}}},"./src/sass/index.scss":function(e,t,r){},0:function(e,t,r){e.exports=r("./src/index.js")}},i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0).default;function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var r,n});var getGlobal=function(){if(typeof globalThis!=="undefined")return globalThis;if(typeof self!=="undefined")return self;if(typeof window!=="undefined")return window;if(typeof global!=="undefined")return global;if(typeof this!=="undefined")return this;throw new Error("ì ì­ ê°ì²´ë¥¼ ì°¾ì ì ììµëë¤")};var agent="userAgent";var isIE=false;var globalThis=getGlobal();globalThis.isNodejs=false;if(globalThis.process&&typeof module==="object"){globalThis.isNodejs=true}else{agent=navigator.userAgent.toLowerCase();isIE=navigator.appName=="Netscape"&&agent.indexOf("trident")!=-1||agent.indexOf("msie")!=-1;if(window){if(isIE==true&&!window.Promise){!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ES6Promise=t()}(this,function(){"use strict";function n(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function l(e){return"function"==typeof e}function e(e){W=e}function t(e){U=e}function r(){return function(){return process.nextTick(u)}}function i(){return"undefined"!=typeof $?function(){$(u)}:s()}function a(){var e=0,t=new z(u),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function o(){var e=new MessageChannel;return e.port1.onmessage=u,function(){return e.port2.postMessage(0)}}function s(){var e=setTimeout;return function(){return e(u,1)}}function u(){for(var e=0;e<H;e+=2){var t=G[e],r=G[e+1];t(r),G[e]=void 0,G[e+1]=void 0}H=0}function f(){try{var e=Function("return this")().require("vertx");return $=e.runOnLoop||e.runOnContext,i()}catch(e){return s()}}function c(e,t){var r=this,n=new this.constructor(h);void 0===n[K]&&R(n);var i=r._state;if(i){var a=arguments[i-1];U(function(){return _(i,n,a,r._result)})}else k(r,n,e,t);return n}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(h);return w(r,e),r}function h(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function g(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function m(e,n,i){U(function(t){var r=!1,e=g(i,n,function(e){r||(r=!0,n!==e?w(t,e):S(t,e))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&e&&(r=!0,E(t,e))},e)}function y(t,e){e._state===Q?S(t,e._result):e._state===Z?E(t,e._result):k(e,void 0,function(e){return w(t,e)},function(e){return E(t,e)})}function b(e,t,r){t.constructor===e.constructor&&r===c&&t.constructor.resolve===d?y(e,t):void 0===r?S(e,t):l(r)?m(e,t,r):S(e,t)}function w(t,e){if(t===e)E(t,v());else if(n(e)){var r=void 0;try{r=e.then}catch(e){return void E(t,e)}b(t,e,r)}else S(t,e)}function C(e){e._onerror&&e._onerror(e._result),T(e)}function S(e,t){e._state===J&&(e._result=t,e._state=Q,0!==e._subscribers.length&&U(T,e))}function E(e,t){e._state===J&&(e._state=Z,e._result=t,U(C,e))}function k(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+Q]=r,i[a+Z]=n,0===a&&e._state&&U(T,e)}function T(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,a=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?_(r,n,i,a):i(a);e._subscribers.length=0}}function _(e,t,r,n){var i=l(r),a=void 0,o=void 0,s=!0;if(i){try{a=r(n)}catch(e){s=!1,o=e}if(t===a)return void E(t,p())}else a=n;t._state!==J||(i&&s?w(t,a):s===!1?E(t,o):e===Q?S(t,a):e===Z&&E(t,a))}function x(t,e){try{e(function(e){w(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}function D(){return ee++}function R(e){e[K]=ee++,e._state=void 0,e._result=void 0,e._subscribers=[]}function I(){return new Error("Array Methods must be provided an Array")}function O(e){return new te(this,e).promise}function A(i){var a=this;return new a(B(i)?function(e,t){for(var r=i.length,n=0;n<r;n++)a.resolve(i[n]).then(e,t)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function N(e){var t=this,r=new t(h);return E(r,e),r}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function P(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=re}var F=void 0;F=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var B=F,H=0,$=void 0,W=void 0,U=function(e,t){G[H]=e,G[H+1]=t,H+=2,2===H&&(W?W(u):X())},j="undefined"!=typeof window?window:void 0,V=j||{},z=V.MutationObserver||V.WebKitMutationObserver,q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,G=new Array(1e3),X=void 0;X=q?r():z?a():Y?o():void 0===j&&"function"==typeof require?f():s();var K=Math.random().toString(36).substring(2),J=void 0,Q=1,Z=2,ee=0,te=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(h),this.promise[K]||R(this.promise),B(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&S(this.promise,this._result))):E(this.promise,I())}return e.prototype._enumerate=function(e){for(var t=0;this._state===J&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===d){var i=void 0,a=void 0,o=!1;try{i=t.then}catch(e){o=!0,a=e}if(i===c&&t._state!==J)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(r===re){var s=new r(h);o?E(s,a):b(s,t,i),this._willSettleAt(s,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===J&&(this._remaining--,e===Z?E(n,r):this._result[t]=r),0===this._remaining&&S(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;k(e,void 0,function(e){return r._settledAt(Q,t,e)},function(e){return r._settledAt(Z,t,e)})},e}(),re=function(){function t(e){this[K]=D(),this._result=this._state=void 0,this._subscribers=[],h!==e&&("function"!=typeof e&&M(),this instanceof t?x(this,e):L())}return t.prototype["catch"]=function(e){return this.then(null,e)},t.prototype["finally"]=function(t){var e=this,r=e.constructor;return l(t)?e.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):e.then(t,t)},t}();return re.prototype.then=c,re.all=O,re.race=A,re.resolve=d,re.reject=N,re._setScheduler=e,re._setAsap=t,re._asap=U,re.polyfill=P,re.Promise=re,re});ES6Promise.polyfill()}}}var syn=syn||function(){};globalThis.syn=syn;var baseCore=function(){};baseCore.extend=function(e,t){var r=baseCore.prototype.extend;baseCore.prototyping=true;var n=new this;r.call(n,e);n.base=function(){};delete baseCore.prototyping;var i=n.constructor;var a=n.constructor=function(){if(!baseCore.prototyping){if(this.constructing||this.constructor==a){this.constructing=true;i.apply(this,arguments);delete this.constructing}else if(arguments[0]!=null){return(arguments[0].extend||r).call(arguments[0],n)}}};a.ancestor=this;a.extend=this.extend;a.each=this.each;a.implement=this.implement;a.prototype=n;a.toString=this.toString;a.valueOf=function(e){return e=="object"?a:i.valueOf()};r.call(a,t);if(typeof a.init=="function"){a.init()}return a};baseCore.prototype={extend:function(e,t){if(arguments.length>1){var r=this[e];if(r&&typeof t=="function"&&(!r.valueOf||r.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var n=t.valueOf();t=function(){var e=this.base||baseCore.prototype.base;this.base=r;var t=n.apply(this,arguments);this.base=e;return t};t.valueOf=function(e){return e=="object"?t:n};t.toString=baseCore.toString}this[e]=t}else if(e){var i=baseCore.prototype.extend;if(!baseCore.prototyping&&typeof this!="function"){i=this.extend||i}var a={toSource:null};var o=["constructor","toString","valueOf","concreate"];var s=baseCore.prototyping?0:1;while(l=o[s++]){if(e[l]!=a[l]){i.call(this,l,e[l])}}for(var l in e){if(!a[l]){i.call(this,l,e[l])}}var u=e["concreate"];if(u){u(e)}}return this}};baseCore=baseCore.extend({constructor:function(){this.extend(arguments[0])},concreate:function(){}},{ancestor:Object,version:"1.0",each:function(e,t,r){if(t==undefined||t.length==0){return}for(var n in e){if(typeof e[n]==="object"){t.apply(e[n],r)}}},implement:function(){for(var e=0,t=arguments.length;e<t;e++){if(typeof arguments[e]==="function"){arguments[e](this.prototype)}else{this.prototype.extend(arguments[e])}}return this},toString:function(){return String(this.valueOf())}});function purge(e){var t=e.attributes,r,n,i;if(t){for(r=t.length-1;r>=0;r-=1){i=t[r].name;if(typeof e[i]==="function"){e[i]=null}}}t=e.childNodes;if(t){n=t.length;for(r=0;r<n;r+=1){purge(e.childNodes[r])}}}(function(e){"use strict";var t=t||new syn.module;t.extend({version:"1.0",exceptions:[],add:function(e,t,r){var n=[];n["message"]=r;n["id"]=e;n["func"]=t;this.exceptions[e]=n;return this},remove:function(e){this.exceptions[e]=null;return this},actionHandler:function(e,t){this.exceptions[e].func(t);return this},exceptionHandler:function(){return this.exceptions[id].func}});(function(){function e(e,t){alert(e+t);return true}t.add("ApplicationException",e,"Exception Templete Message.","99999")})();e.$exception=e.$e=syn.$e=e.$exception||t})(globalThis);(function(context){"use strict";var $resource=$resource||new syn.module;var document=globalThis.document;$resource.extend({version:"1.0",localeID:"ko-KR",fullyQualifiedLocale:{ko:"ko-KR",en:"en-US",ja:"ja-JP",zh:"zh-CN"},translations:{},translateControls:[],concreate:function(){return;var els=document.querySelectorAll("[syn-i18n]");for(var i=0;i<els.length;i++){var el=els[i];var tagName=el.tagName.toUpperCase();var elID=el.getAttribute("id");var i18nOption=el.getAttribute("syn-i18n");if(i18nOption===undefined||i18nOption===null||i18nOption===""){continue}var options=null;if(i18nOption.startsWith("{")==true){try{options=eval("("+i18nOption+")");if(options.options.bindSource===undefined||options.options.bindSource===null){options.bindSource="content"}else{options.bindSource=options.options.bindSource}}catch(e){console.log('$resource.concreate, tagName: "'+tagName+'", elID: "'+elID+'" syn-i18n íì¸ íì, error: '+e.message)}}else{options={key:i18nOption,bindSource:"content"}}if(options&&(options.key===undefined||options.key===null||options.key==="")==false){el.setAttribute("i18n-key",options.key);var controlType="";var moduleName=null;if(tagName.indexOf("QAF_")>-1){moduleName=tagName.substring(4).toLowerCase();controlType=moduleName}else{switch(tagName){case"BUTTON":moduleName="button";controlType="button";break;case"INPUT":controlType=el.getAttribute("type").toLowerCase();switch(controlType){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":moduleName="textbox";break;case"submit":case"reset":case"button":moduleName="button";break;case"radio":moduleName="radio";break;case"checkbox":moduleName="checkbox";break}break;case"TEXTAREA":moduleName="textarea";controlType="textarea";break;case"SELECT":if(el.getAttribute("multiple")==null){moduleName="select";controlType="select"}else{moduleName="multiselect";controlType="multiselect"}break;default:break}}var key=options.key;var bindSource=options.bindSource;delete options.key;delete options.bindSource;$resource.translateControls.push({elID:elID,key:key,bindSource:bindSource,tag:tagName,module:moduleName,type:controlType,options:options})}else{console.log('$resource.concreate, tagName: "'+tagName+'", elID: "'+elID+'" key íì¸ íì')}}$resource.setLocale($resource.localeID)},add:function(e,t){this[e]=t},remove:function(e){this[e]=undefined},interpolate:function(e,r){return Object.keys(r).reduce(function(e,t){return e.replace(new RegExp("#{s*"+t+"s*}","g"),r[t])},e)},getControl:function(e){var t=null;if($object.isString(e)==true){e=$l.get(e)}if($object.isNullOrUndefined(e)==false){var r=e.id;var n=e.tagName;var i=e.getAttribute("i18n-key");if($string.isNullOrEmpty(r)==true){t=$resource.translateControls.find(function(e){return e.tag==n&&e.key==i})}else{t=$resource.translateControls.find(function(e){return e.elID==r&&e.tag==n&&e.key==i})}}return t},translatePage:function(){$resource.translateControls.forEach(function(e){$resource.translateControl(e)})},translateElement:function(e,t){var r=$resource.getControl(e);if($object.isNullOrUndefined(r)==false){$resource.translateControl(r,t)}},translateControl:function(e,t){if($object.isNullOrUndefined(e)==false){var r=null;if($string.isNullOrEmpty(e.elID)==false){r=$l.get(e.elID)}else{r=$l.querySelector('{0}[i18n-key="{1}"]'.format(e.tag,e.key))}if($object.isNullOrUndefined(e.module)==true){var n=$resource.getBindSource(e);r[n]=$resource.translateText(e,t)}else{var i=syn.uicontrols["$"+e.module];if(i&&i.setLocale){i.setLocale(e.elID,$resource.translations,e,t)}}}},translateText:function(e,t){var r="";if(e){var n=e.key;var i=$resource.translations[n];var a=null;if($ref.isString(i)==true){a=i}else if($ref.isArray(i)==true){a=i[0]}else if($ref.isObject(i)==true){a=i.Text}if(/#{s*\w+s*}/g.test(a)==true){var o=$w.getSSOInfo();if(o){if(t){o=$w.argumentsExtend(o,t)}}else{o=t}r=o?$resource.interpolate(a,o):a}else{r=a}}return r},getBindSource:function(e,t){var r=null;switch(e.bindSource){case"text":r="innerText";break;case"content":r="textContent";break;case"html":r="innerHTML";break;case"url":r="src";break;case"placeholder":r="placeholder";break;case"control":r="controlText";break}return r},fetchJSON:function(e,t){var r=new globalThis.XMLHttpRequest;r.open("GET",e,true);r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==200){if(r.status==0){$l.eventLog("$res.fetchJSON","X-Requested transfort error","Fatal")}else{$l.eventLog("$res.fetchJSON","response status - {0}".format(r.statusText)+r.responseText,"Error")}return}if(t){t(JSON.parse(r.responseText))}}};r.send()},setLocale:function(t){var e="/assets/shared/language/"+t+".json";$resource.fetchJSON(e,function(e){$resource.localeID=t;$resource.translations=e;document.documentElement.lang=t.substring(0,2);$resource.translatePage()})}});context.$resource=context.$res=syn.$res=context.$resource||$resource})(globalThis);(function(t){"use strict";var e=e||new syn.module;var r=t.document;e.extend({version:"1.0",appName:navigator.appName,appCodeName:navigator.appCodeName,appMajorVersion:navigator.appVersion.substring(0,4),appVersion:navigator.appVersion,platform:navigator.platform,javaEnabled:navigator.javaEnabled(),screenWidth:screen.width,screenHeight:screen.height,language:navigator.appName=="Netscape"?navigator.language:navigator.browserLanguage,isWebkit:navigator.userAgent.indexOf("AppleWebKit/")>-1,isGecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")==-1,isKHTML:navigator.userAgent.indexOf("KHTML")!=-1,isPresto:navigator.appName=="Opera",isMac:navigator.appVersion.indexOf("Mac")!=-1||navigator.userAgent.indexOf("Macintosh")!=-1,isLinux:navigator.appVersion.indexOf("Linux")!=-1||navigator.appVersion.indexOf("X11")!=-1,isWin:navigator.appVersion.indexOf("Win")!=-1||navigator.userAgent.indexOf("Windows")!=-1,isIE:!!r.documentMode||navigator.appName=="Netscape"&&agent.indexOf("trident")!=-1||agent.indexOf("msie")!=-1,isChrome:!!t.chrome&&(!!t.chrome.webstore||!!t.chrome.runtime),isEdge:!!t.chrome&&(!!t.chrome.webstore||!!t.chrome.runtime)&&navigator.userAgent.indexOf("Edg")!=-1,isFF:typeof InstallTrigger!=="undefined"||navigator.userAgent.indexOf("Firefox")!==-1,isSafari:/constructor/i.test(t.HTMLElement)||function(e){return e.toString()==="[object SafariRemoteNotification]"}(!t["safari"]||typeof safari!=="undefined"&&t["safari"].pushNotification),windowWidth:function(){var e=null;if(t.innerWidth){e=t.innerWidth}else if(r.documentElement&&r.documentElement.clientWidth){e=r.documentElement.clientWidth}else if(r.body){e=r.body.offsetWidth}return e},windowHeight:function(){var e=null;if(t.innerHeight){e=t.innerHeight}else if(r.documentElement&&r.documentElement.clientHeight){e=r.documentElement.clientHeight}else if(r.body){e=r.body.clientHeight}return e}});t.$browser=t.$b=syn.$b=t.$browser||e})(globalThis);(function(r){"use strict";var e=e||new syn.module;var o=r.document;e.extend({version:"1.0",body:function(){return o},documentElement:function(){return o.documentElement},childNodes:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.childNodes},firstChild:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.firstChild},lastChild:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.lastChild},nextSibling:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.nextSibling},previousSibling:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.previousSibling},siblings:function(t){t=$ref.isString(t)==true?$l.get(t):t;return[].slice.call(parent.children).filter(function(e){return e!==t})},parentNode:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.parentNode},innerText:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.innerText},nodeName:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.nodeName},nodeType:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.nodeType},nodeValue:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.nodeValue},className:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.className},removeAttribute:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;return e.removeAttribute(t)},getAttribute:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;return e.getAttribute(t)},setAttribute:function(e,t,r){e=$ref.isString(e)==true?$l.get(e):e;return e.setAttribute(t,r)},appendChild:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;return e.appendChild(t)},cloneNode:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;return e.cloneNode(t)},createElement:function(e){return o.createElement(e)},createTextNode:function(e){return o.createTextNode(e)},innerHTML:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.innerHTML},outerHTML:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.outerHTML},setStyle:function(e,t,r){e=$ref.isString(e)==true?$l.get(e):e;e.style[t]=r;return this},addCssText:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;if(e.style.cssText!=undefined){e.style.cssText=t}return this},addStyle:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;for(var r in t){this.setStyle(e,r,t[r])}return this},getStyle:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;return e.style[t]},hasHidden:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e==null||e.offsetParent==null||r.getComputedStyle(e)["display"]=="none"},getComputedStyle:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;return r.getComputedStyle(e)[t]},addClass:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;if(this.hasClass(e,t)==false){if(e.classList&&e.classList.add){e.classList.add(t)}else{e.className=(e.className+" "+t).replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}return this},hasClass:function(e,t){var r=false;e=$ref.isString(e)==true?$l.get(e):e;if(e){if(e.classList&&e.classList.contains){r=e.classList.contains(t)}else{r=$m.getClassRegEx(t).test(e.className)}}return r},toggleClass:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;if(e){if(e.classList&&e.classList.toggle){e.classList.toggle(t)}}return this},removeClass:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;if(e){if(t===undefined){e.className=""}else{if(e.classList&&e.classList.remove){e.classList.remove(t)}else{var r=$m.getClassRegEx(t);e.className=e.className.replace(r,"");r=null}}}return this},append:function(e,t,r,n,i){e=$ref.isString(e)==true?$l.get(e):e;var a=o.createElement(t);if(r){a.id=r}if(n){this.addStyle(a,n)}if(i){this.innerHTML(i)}e.appendChild(a);return a},prepend:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;t.insertBefore(e,t.firstChild)},copy:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.cloneNode(true)},empty:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(e){while(e.firstChild){purge(e.firstChild);e.removeChild(node.firstChild)}}return this},remove:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(e){purge(e);if(e.parentNode){e.parentNode.removeChild(e)}}return this},hasChild:function(e){e=$ref.isString(e)==true?$l.get(e):e;return e.hasChildNodes()},addControlStyles:function(e,t){if(!t){return}var r=null;for(var n=0;n<e.length;n++){r=e[n];if(r!=null){if(this.hasClass(r,t)==false){this.addClass(r,t)}}}return this},removeControlStyles:function(e,t){if(!t){return}var r=null;for(var n=0;n<e.length;n++){r=e[n];if(r!=null){if(this.hasClass(r,t)==true){this.removeClass(r,t)}}}return this},removeNode:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(e){e.parentNode.removeChild(e)}},insertAfter:function(e,t){var r=t.parentNode;if(t.nextElementSibling){r.insertBefore(e,t.nextElementSibling)}else{r.appendChild(e)}},hide:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(e){e.style.display="none"}},hideAll:function(e){for(var t=0;t<e.length;t++){this.hide(e[t])}},show:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(e){e.style.display="block"}},showAll:function(e){for(var t=0;t<e.length;t++){this.show(e[t])}},toggle:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(r.getComputedStyle(e).display==="block"){this.hide(e);return}this.show(e)},parent:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;var r=e.parentElement;while(r&&r.tagName!="BODY"){if(r.id==t){return r}r=r.parentElement}return null},create:function(e){var t=o.createElement(e.tag);if(e.id){t.id=e.id}if(e.className){t.className=e.className}if(e.style){for(var r in e.style){t.style[r]=e.style[r]}}if(e.attributes){for(var r in e.attributes){t.setAttribute(r,e.attributes[r])}}if(e.data){t.dataset=t.dataset?result.dataset:{};for(var r in e.data){t.dataset[r]=e.data[r]}}if(e.html){t.innerHTML=e.html}return t},div:function(e){if(!e){e=new Object}e.tag="div";return this.create(e)},label:function(e){if(!e){e=new Object}e.tag="label";return this.create(e)},textField:function(e){if(!e){e=new Object}e.tag="input";if(!e.attributes)e.attributes=new Object;e.attributes.type="text";return this.create(e)},checkbox:function(e){if(!e){e=new Object}e.tag="input";if(!e.attributes)e.attributes=new Object;e.attributes.type="checkbox";return this.create(e)},each:function(e,t){for(var r=0;r<e.length;r++){t(e[r],r)}},setActive:function(e){e=$ref.isString(e)==true?$l.get(e):e;e.classList.add("active")},setUnactive:function(e){e=$ref.isString(e)==true?$l.get(e):e;e.classList.remove("active")},select:function(e){e=$ref.isString(e)==true?$l.get(e):e;e.selected=true;e.setAttribute("selected","selected")},deselect:function(e){e=$ref.isString(e)==true?$l.get(e):e;e.selected=false;e.removeAttribute("selected")},check:function(e){e=$ref.isString(e)==true?$l.get(e):e;e.checked=true},uncheck:function(e){e=$ref.isString(e)==true?$l.get(e):e;e.checked=false},click:function(e){e=$ref.isString(e)==true?$l.get(e):e;if(e.fireEvent){e.fireEvent("onclick")}else{var t=o.createEvent("Events");t.initEvent("click",true,false);e.dispatchEvent(t)}},getClassRegEx:function(e){return new RegExp("(^|\\s)"+e+"(\\s|$)")}});r.$manipulation=r.$m=syn.$m=r.$manipulation||e})(globalThis);(function(a){"use strict";var e=e||new syn.module;var o=a.document;e.extend({version:"1.0",getDocumentSize:function(e){e=($ref.isString(e)==true?$l.get(e):e)||a;var t={width:e.scrollMaxX?e.innerWidth+e.scrollMaxX:o.documentElement.scrollWidth||o.body.scrollWidth||0,height:e.scrollMaxY?e.innerHeight+e.scrollMaxY:o.documentElement.scrollHeight||o.body.scrollHeight||0,fullWidth:Math.max(o.body.scrollWidth,o.documentElement.scrollWidth,o.body.offsetWidth,o.documentElement.offsetWidth,o.body.clientWidth,o.documentElement.clientWidth),fullHeight:Math.max(o.body.scrollHeight,o.documentElement.scrollHeight,o.body.offsetHeight,o.documentElement.offsetHeight,o.body.clientHeight,o.documentElement.clientHeight)};return t},getWindowSize:function(e){e=($ref.isString(e)==true?$l.get(e):e)||a;var t={width:e.innerWidth?e.innerWidth:o.documentElement.clientWidth||o.body.clientWidth||0,height:e.innerHeight?e.innerHeight:o.documentElement.clientHeight||o.body.clientHeight||0};return t},getScrollPosition:function(e){e=($ref.isString(e)==true?$l.get(e):e)||a;var t={left:e.pageXOffset||e.scrollLeft||o.documentElement.scrollLeft||o.body.scrollLeft||0,top:e.pageYOffset||e.scrollTop||o.documentElement.scrollTop||o.body.scrollTop||0};return t},getMousePosition:function(e){e=e||a.event||top.window.event;var t=$d.getScrollSize();var r={x:e.pageX||e.clientX+t.x||0,y:e.pageY||e.clientY+t.y||0,relativeX:e.layerX||e.offsetX||0,relativeY:e.layerY||e.offsetY||0};return r},offset:function(e){e=$ref.isString(e)==true?$l.get(e):e;var t=e.getBoundingClientRect();var r=a.pageXOffset||o.documentElement.scrollLeft;var n=a.pageYOffset||o.documentElement.scrollTop;return{top:t.top+n,left:t.left+r}},offsetLeft:function(e){var t=0;e=$ref.isString(e)==true?$l.get(e):e;while(typeof e!=="undefined"&&e&&e.parentNode!==a){if(e.offsetLeft){t+=e.offsetLeft}e=e.parentNode}return t},parentOffsetLeft:function(e){e=$ref.isString(e)==true?$l.get(e):e;e=e||top.document.documentElement||top.document.body;return e.parentNode===e.offsetParent?e.offsetLeft:$d.offsetLeft(e)-$d.offsetLeft(e.parentNode)},offsetTop:function(e){var t=0;e=$ref.isString(e)==true?$l.get(e):e;while(typeof e!=="undefined"&&e&&e.parentNode!==a){if(e.offsetTop){t+=e.offsetTop}e=e.parentNode}return t},parentOffsetTop:function(e){e=$ref.isString(e)==true?$l.get(e):e;e=e||top.document.documentElement||top.document.body;return e.parentNode===e.offsetParent?e.offsetTop:$d.offsetTop(e)-$d.offsetTop(e.parentNode)},getBounds:function(e){e=$ref.isString(e)==true?$l.get(e):e;var t=$d.offsetTop(e);var r=$d.offsetLeft(e);var n=t+e.offsetHeight;var i=r+e.offsetWidth;var a={top:t,left:t,parentTop:$d.parentOffsetTop(e),parentLeft:$d.parentOffsetLeft(e),bottom:n,right:i,center:{x:r+(i-r)/2,y:t+(n-t)/2}};return a},getCenter:function(e){e=$ref.isString(e)==true?$l.get(e):e;var t=$d.offsetTop(e);var r=$d.offsetLeft(e);var n=t+e.offsetHeight;var i=r+e.offsetWidth;var a={x:r+(i-r)/2,y:t+(n-t)/2};return a},getPosition:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;var r={top:$d.offsetTop(e),left:$d.offsetLeft(e)};var n=e.offsetParent;while(n){r.left+=$d.offsetLeft(n);r.top+=$d.offsetTop(n);n=n.offsetParent}if(t){r.left+=e.offsetWidth/2;r.top+=e.offsetHeight/2}return r},getSize:function(e){e=$ref.isString(e)==true?$l.get(e):e;var t=a.getComputedStyle(e);var r={width:e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),height:e.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom),clientWidth:e.clientWidth,clientHeight:e.clientHeight,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight,marginWidth:e.offsetWidth+parseFloat(t.marginLeft)+parseFloat(t.marginRight),marginHeight:e.offsetHeight+parseFloat(t.marginTop)+parseFloat(t.marginBottom)};return r},measureWidth:function(e,t){var r=o.createElement("div");r.style.position="absolute";r.style.visibility="hidden";r.style.whiteSpace="nowrap";r.style.left="-9999px";if(t){r.style.fontSize=t}r.innerText=e;o.body.appendChild(r);var n=a.getComputedStyle(r).width;o.body.removeChild(r);return n},measureHeight:function(e,t,r){var n=o.createElement("div");n.style.position="absolute";n.style.visibility="hidden";n.style.width=t;n.style.left="-9999px";if(r){n.style.fontSize=r}n.innerText=e;o.body.appendChild(n);var i=a.getComputedStyle(n).height;o.body.removeChild(n);return i},measureSize:function(e,t){if($object.isNullOrUndefined(e)==true){return null}var r=$d.measureWidth(e,t);return{width:r,height:$d.measureHeight(e,r,t)}}});a.$dimension=a.$d=syn.$d=a.$dimension||e})(globalThis);(function(context){"use strict";var $reflection=$reflection||new syn.module;$reflection.extend({version:"1.0",getType:function(e){var t=typeof e;if(t=="object"){if(e){if(e instanceof Array||(!(e instanceof Object)&&Object.prototype.toString.call(e)=="[object Array]"||typeof e.length=="number"&&typeof e.splice!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("splice"))){return"array"}if(!(e instanceof Object)&&(Object.prototype.toString.call(e)=="[object Function]"||typeof e.call!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("call"))){return"function"}}else{return"null"}}else if(t=="function"&&typeof e.call=="undefined"){return"object"}return t},defaultValue:function(type,isPrimitive){if(typeof type!=="string"){return""}if(isPrimitive&&isPrimitive==true){switch(type){case"boolean":return false;case"function":return function(){};case"null":return null;case"number":return 0;case"object":return{};case"string":return"";case"symbol":return Symbol();case"undefined":return void 0}try{var ctor=typeof this[type]==="function"?this[type]:eval(type);return new ctor}catch(e){return{}}}else{switch(type){case"bool":case"boolean":return false;case"int":case"number":return 0;default:return""}}},isDefined:function(e){return e!==undefined},isNull:function(e){return e===null},isArray:function(e){return this.getType(e)=="array"},isDate:function(e){var t=false;try{if($string.isNullOrEmpty(e)==true){t=true}else if(typeof e=="string"){if(e.includes("T")==true){var r=e.parseISOString();t=typeof r.getFullYear=="function"}else if($date.isDate(e)==true){t=true}}}catch(e){}return t},isString:function(e){return typeof e=="string"},isNumber:function(e){return typeof e=="number"},isFunction:function(e){return this.getType(e)=="function"},isObject:function(e){return typeof e=="object"},isObjectEmpty:function(e){if(typeof e=="object"){for(var t in e){if(e.hasOwnProperty(t)==true){return false}}}return true},isBoolean:function(e){return typeof e=="boolean"},isEmpty:function(e){return e==null||!(Object.keys(e)||e).length},clone:function(t,e){var n=null;if($object.isNullOrUndefined(e)==true){e=true}if(this.isArray(t)==true){n=JSON.parse(JSON.stringify(t))}else if(this.isObject(t)==true){if(t){var r=[Number,String,Boolean],n;r.forEach(function(e){if(t instanceof e){n=e(t)}});if(e==true&&Object.prototype.toString.call(t)==="[object Array]"){n=[];t.forEach(function(e,t,r){n[t]=this.clone(e)})}else if(typeof t=="object"){if(t.nodeType&&typeof t.cloneNode=="function"){n=t.cloneNode(true)}else if(!t.prototype){n={};for(var i in t){n[i]=this.clone(t[i])}}else{if(t.constructor){n=new t.constructor}else{n=t}}}else{n=t}}else{n=t}}else if(this.isFunction(t)==true){n=t.clone()}else{n=t}return n},cloneNode:function(e){return e.cloneNode(true)},method:function(e,t,r){e.prototype[t]=r;return this},extend:function(e,t,r){var n,i;for(n in t){i=e[n]!==undefined;if(i&&typeof t[n]==="object"&&t[n]!==null&&t[n].nodeName===undefined){if($ref.isDate(t[n])){if(r){e[n]=new Date(t[n].getTime())}}else if($ref.isArray(t[n])){if(r){e[n]=t[n].slice(0)}}else{e[n]=$ref.extend({},t[n],r)}}else if(r||!i){e[n]=t[n]}}return e},getCommentObject:function(e){}});context.$reflection=context.$ref=syn.$reflection=context.$reflection||$reflection})(globalThis);(function(e){"use strict";var t=t||new syn.module;t.extend({version:"1.0",base64Encode:function(e){if(isNodejs==true){return Buffer.from(e).toString("base64")}else{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}))}return null},base64Decode:function(e){if(isNodejs==true){return Buffer.from(e,"base64").toString()}else{return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}return null},utf8Encode:function(e){if(typeof e!="string"){throw new TypeError("parameter âunicodeStringâ is not a string")}var t=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|t&63)}).replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|t>>6&63,128|t&63)});return t},utf8Decode:function(e){if(typeof e!="string"){throw new TypeError("parameter âutf8Stringâ is not a string")}var t=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(e.charCodeAt(0)&15)<<12|(e.charCodeAt(1)&63)<<6|e.charCodeAt(2)&63;return String.fromCharCode(t)}).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(t)});return t},sha256:function(e){var i=8;var a=0;function m(e,t){var r=(e&65535)+(t&65535);var n=(e>>16)+(t>>16)+(r>>16);return n<<16|r&65535}function t(e,t){return e>>>t|e<<32-t}function r(e,t){return e>>>t}function y(e,t,r){return e&t^~e&r}function b(e,t,r){return e&t^e&r^t&r}function w(e){return t(e,2)^t(e,13)^t(e,22)}function C(e){return t(e,6)^t(e,11)^t(e,25)}function S(e){return t(e,7)^t(e,18)^r(e,3)}function E(e){return t(e,17)^t(e,19)^r(e,10)}function n(e,t){var r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);var n=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225);var i=new Array(64);var a,o,s,l,u,f,c,d,h,v;var p,g;e[t>>5]|=128<<24-t%32;e[(t+64>>9<<4)+15]=t;for(var h=0;h<e.length;h+=16){a=n[0];o=n[1];s=n[2];l=n[3];u=n[4];f=n[5];c=n[6];d=n[7];for(var v=0;v<64;v++){if(v<16)i[v]=e[v+h];else i[v]=m(m(m(E(i[v-2]),i[v-7]),S(i[v-15])),i[v-16]);p=m(m(m(m(d,C(u)),y(u,f,c)),r[v]),i[v]);g=m(w(a),b(a,o,s));d=c;c=f;f=u;u=m(l,p);l=s;s=o;o=a;a=m(p,g)}n[0]=m(a,n[0]);n[1]=m(o,n[1]);n[2]=m(s,n[2]);n[3]=m(l,n[3]);n[4]=m(u,n[4]);n[5]=m(f,n[5]);n[6]=m(c,n[6]);n[7]=m(d,n[7])}return n}function o(e){var t=Array();var r=(1<<i)-1;for(var n=0;n<e.length*i;n+=i){t[n>>5]|=(e.charCodeAt(n/i)&r)<<24-n%32}return t}function s(e){var t=a?"0123456789ABCDEF":"0123456789abcdef";var r="";for(var n=0;n<e.length*4;n++){r+=t.charAt(e[n>>2]>>(3-n%4)*8+4&15)+t.charAt(e[n>>2]>>(3-n%4)*8&15)}return r}e=$c.utf8Encode(e);return s(n(o(e),e.length*i))},encrypt:function(e,t){if($object.isNullOrUndefined(e)==true){return null}var r=6;if($object.isNullOrUndefined(t)==true){t=$c.sha256(e).substring(0,r)}else{r=t.length}var n=function(e,t){var r=[];var n=t.length;for(var i=0;i<e.length;i++){var a=i%n;var o=e.charCodeAt(i)+t.charCodeAt(a);r.push(o)}return JSON.stringify(r)};return escape(syn.$c.base64Encode(n(e,t)+"."+t))},decrypt:function(e){var t=null;if($object.isNullOrUndefined(e)==true){return t}try{e=$c.base64Decode(unescape(e));if(e.indexOf(".")===-1){return t}var r=e.split(".");var n=function(e,t){var r=[];var n="";var i=JSON.parse(e);var a=t.length;for(var o=0;o<i.length;o++){var s=o%a;var l=i[o]-t.charCodeAt(s);r.push(l)}for(var o=0;o<r.length;o++){var u=String.fromCharCode(r[o]);n+=u}return n};t=n(r[0],r[1])}catch(e){$l.eventLog("$c.decrypt",e,"Error")}return t},LZString:function(){var y=String.fromCharCode;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$";var i={};function a(e,t){if(!i[e]){i[e]={};for(var r=0;r<e.length;r++){i[e][e.charAt(r)]=r}}return i[e][t]}var o={compressToBase64:function(e){if(e==null)return"";var t=o._compress(e,6,function(e){return r.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){if(t==null)return"";if(t=="")return null;return o._decompress(t.length,32,function(e){return a(r,t.charAt(e))})},compressToUTF16:function(e){if(e==null)return"";return o._compress(e,15,function(e){return y(e+32)})+" "},decompressFromUTF16:function(t){if(t==null)return"";if(t=="")return null;return o._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){var t=o.compress(e);var r=new Uint8Array(t.length*2);for(var n=0,i=t.length;n<i;n++){var a=t.charCodeAt(n);r[n*2]=a>>>8;r[n*2+1]=a%256}return r},decompressFromUint8Array:function(e){if($object.isNullOrUndefined(e)==true){return o.decompress(e)}else{var t=new Array(e.length/2);for(var r=0,n=t.length;r<n;r++){t[r]=e[r*2]*256+e[r*2+1]}var i=[];t.forEach(function(e){i.push(y(e))});return o.decompress(i.join(""))}},compressToEncodedURIComponent:function(e){if(e==null)return"";return o._compress(e,6,function(e){return n.charAt(e)})},decompressFromEncodedURIComponent:function(t){if(t==null)return"";if(t=="")return null;t=t.replace(/ /g,"+");return o._decompress(t.length,32,function(e){return a(n,t.charAt(e))})},compress:function(e){return o._compress(e,16,function(e){return y(e)})},_compress:function(e,t,r){if(e==null)return"";var n,i,a={},o={},s="",l="",u="",f=2,c=3,d=2,h=[],v=0,p=0,g;for(g=0;g<e.length;g+=1){s=e.charAt(g);if(!Object.prototype.hasOwnProperty.call(a,s)){a[s]=c++;o[s]=true}l=u+s;if(Object.prototype.hasOwnProperty.call(a,l)){u=l}else{if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(n=0;n<d;n++){v=v<<1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}}i=u.charCodeAt(0);for(n=0;n<8;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}}else{i=1;for(n=0;n<d;n++){v=v<<1|i;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=0}i=u.charCodeAt(0);for(n=0;n<16;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}}f--;if(f==0){f=Math.pow(2,d);d++}delete o[u]}else{i=a[u];for(n=0;n<d;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}}f--;if(f==0){f=Math.pow(2,d);d++}a[l]=c++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(n=0;n<d;n++){v=v<<1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}}i=u.charCodeAt(0);for(n=0;n<8;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}}else{i=1;for(n=0;n<d;n++){v=v<<1|i;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=0}i=u.charCodeAt(0);for(n=0;n<16;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}}f--;if(f==0){f=Math.pow(2,d);d++}delete o[u]}else{i=a[u];for(n=0;n<d;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}}f--;if(f==0){f=Math.pow(2,d);d++}}i=2;for(n=0;n<d;n++){v=v<<1|i&1;if(p==t-1){p=0;h.push(r(v));v=0}else{p++}i=i>>1}while(true){v=v<<1;if(p==t-1){h.push(r(v));break}else p++}return h.join("")},decompress:function(t){if(t==null)return"";if(t=="")return null;return o._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,r){var n=[],i,a=4,o=4,s=3,l="",u=[],f,c,d,h,v,p,g,m={val:r(0),position:t,index:1};for(f=0;f<3;f+=1){n[f]=f}d=0;v=Math.pow(2,2);p=1;while(p!=v){h=m.val&m.position;m.position>>=1;if(m.position==0){m.position=t;m.val=r(m.index++)}d|=(h>0?1:0)*p;p<<=1}switch(i=d){case 0:d=0;v=Math.pow(2,8);p=1;while(p!=v){h=m.val&m.position;m.position>>=1;if(m.position==0){m.position=t;m.val=r(m.index++)}d|=(h>0?1:0)*p;p<<=1}g=y(d);break;case 1:d=0;v=Math.pow(2,16);p=1;while(p!=v){h=m.val&m.position;m.position>>=1;if(m.position==0){m.position=t;m.val=r(m.index++)}d|=(h>0?1:0)*p;p<<=1}g=y(d);break;case 2:return""}n[3]=g;c=g;u.push(g);while(true){if(m.index>e){return""}d=0;v=Math.pow(2,s);p=1;while(p!=v){h=m.val&m.position;m.position>>=1;if(m.position==0){m.position=t;m.val=r(m.index++)}d|=(h>0?1:0)*p;p<<=1}switch(g=d){case 0:d=0;v=Math.pow(2,8);p=1;while(p!=v){h=m.val&m.position;m.position>>=1;if(m.position==0){m.position=t;m.val=r(m.index++)}d|=(h>0?1:0)*p;p<<=1}n[o++]=y(d);g=o-1;a--;break;case 1:d=0;v=Math.pow(2,16);p=1;while(p!=v){h=m.val&m.position;m.position>>=1;if(m.position==0){m.position=t;m.val=r(m.index++)}d|=(h>0?1:0)*p;p<<=1}n[o++]=y(d);g=o-1;a--;break;case 2:return u.join("")}if(a==0){a=Math.pow(2,s);s++}if(n[g]){l=n[g]}else{if(g===o){l=c+c.charAt(0)}else{return null}}u.push(l);n[o++]=c+l.charAt(0);a--;c=l;if(a==0){a=Math.pow(2,s);s++}}}};return o}()});e.$crytography=e.$c=syn.$c=e.$crytography||t})(globalThis);(function(e){"use strict";var t=t||new syn.module;t.extend({version:"1.0",datas:[],append:function(e){this.datas.push(e)},appendFormat:function(e){var r=this.convertToArray(arguments).slice(1);this.datas[this.datas.length]=e.replace(/\{(\d+)\}/g,function(e,t){return r[t].toString()})},convertToArray:function(){if(!arguments){return[]}if(arguments.toArray){return arguments.toArray()}var e=arguments[0];var t=e.length;var r=new Array(t);while(t--){r[t]=e[t]}return r},clear:function(){this.datas=[]},toString:function(){return this.datas.join("")}});e.$stringbuilder=e.$sb=syn.$sb=e.$stringbuilder||t})(globalThis);(function(i){"use strict";var e=e||new syn.module;e.extend({version:"1.0",keyCodes:{backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,delete:46,semicolon:186,colon:186,equal:187,plus:187,comma:188,less:188,minus:189,underscore:189,period:190,greater:190,slash:191,questionmark:191,backtick:192,tilde:192,openingsquarebracket:219,openingcurlybracket:219,backslash:220,pipe:220,closingsquarebracket:221,closingcurlybracket:221,singlequote:222,doublequote:222,clear:12,meta:91,contextmenu:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},keyboardEL:null,setElement:function(e){this.keyboardEL=i.keyboardEL=e;keyboardEL.keyObject=[];keyboardEL.keyObject["keydown"]=[];keyboardEL.keyObject["keyup"]=[];keyboardEL.keyObject["keypress"]=[];function t(e){var t=e.type;var r=e.keyCode;i.keyboardEvent=arguments[0];i.documentEvent=e;if(keyboardEL.keyObject[t][r]!=null){var n=keyboardEL.keyObject[t][r](e);if(n===false){e.returnValue=false;e.cancel=true;if(e.preventDefault){e.preventDefault()}if(e.stopPropagation){e.stopPropagation()}return false}}}$l.addEvent(keyboardEL,"keypress",t);$l.addEvent(keyboardEL,"keydown",t);$l.addEvent(keyboardEL,"keyup",t);return this},addKeyDown:function(e,t){keyboardEL.keyObject["keydown"][e]=t;return this},removeKeyDown:function(e){keyboardEL.keyObject["keydown"][e]=null;return this},addKeyUp:function(e,t){keyboardEL.keyObject["keyup"][e]=t;return this},removeKeyUp:function(e){keyboardEL.keyObject["keyup"][e]=null;return this},addKeyPress:function(e,t){keyboardEL.keyObject["keypress"][e]=t;return this},removeKeyPress:function(e){keyboardEL.keyObject["keypress"][e]=null;return this}});i.$keyboard=i.$k=syn.$k=i.$keyboard||e})(globalThis);(function(window){"use strict";var $validation=$validation||new syn.module;var document=window.document;$validation.extend({version:"1.0",element:null,isContinue:true,invalidMessages:[],validations:[],setElement:function(e){this.element=e;if(!this.validations[e.id]){if(!e.validObject){this.clear()}this.validations[e.id]=e}return this},required:function(e,t){this.setElement(e);this.addRequired(true,t);return this},addRequired:function(e,t){this.element.required=e;this.element.invalidMessage=t;return this},addPattern:function(e,t){if(this.element.validObject){this.element.validObject["pattern"][e]=t}return this},addRange:function(e,t){if(this.element.validObject){this.element.validObject["range"][e]=t}return this},addCustom:function(e,t){if(this.element.validObject){this.element.validObject["custom"][e]=t}return this},remove:function(e){this.element.validObject["pattern"][e]=null;this.element.validObject["range"][e]=null;this.element.validObject["custom"][e]=null;return this},clear:function(){this.element.validObject=[];this.element.validObject["pattern"]=[];this.element.validObject["range"]=[];this.element.validObject["custom"]=[];this.element.required=false;this.element.invalidMessage="";this.invalidMessages=[];return this},validateControl:function(el){if(this.element!==el){this.element=el}var isValidate=true;var result=false;if(el.required){if(el.value.length>0){result=true}else{result=false;isValidate=false;this.invalidMessages[this.invalidMessages.length.toString()]=el.invalidMessage;if(this.isContinue==false){return isValidate}}}for(var valid in el.validObject){if(valid==="pattern"){var pattern=null;var expr=null;for(var validType in el.validObject[valid]){var pattern=el.validObject[valid][validType];var expr=pattern.expr;result=expr.test(el.value);if(result==false){isValidate=false;this.invalidMessages[this.invalidMessages.length.toString()]=pattern.invalidMessage;if(this.isContinue==false){break}}}}else if(valid==="range"){var range=null;var min=null;var max=null;var minOperator=null;var maxOperator=null;for(var validType in el.validObject[valid]){range=el.validObject[valid][validType];min=range.min;max=range.max;minOperator=range.minOperator;maxOperator=range.maxOperator;try{result=eval(min.toString()+" "+minOperator.toString()+" "+el.value+"&&"+max.toString()+" "+maxOperator.toString()+" "+el.value)}catch(e){$l.eventLog("$v.validateControl",'elID: "{0}" ì í¨ì± range ê²ì¬ ì¤ë¥ '.format(el.id)+e.message,"Warning")}if(result==false){isValidate=false;this.invalidMessages[this.invalidMessages.length.toString()]=range.invalidMessage;if(this.isContinue==false){break}}}}else if(valid==="custom"){var custom=null;var func=null;var parameters=null;for(var validType in el.validObject[valid]){custom=el.validObject[valid][validType];func=custom.func;parameters=[];for(var parameterName in custom){if(parameterName!=="func"){parameters[parameterName]=custom[parameterName]}}try{if($this){result=eval('window[syn.$w.pageScript]["'+func+'"]').call(parameters,custom)}else{result=eval(func).call(parameters,custom)}}catch(e){$l.eventLog("$v.validateControl",'elID: "{0}" ì í¨ì± custom ê²ì¬ ì¤ë¥ '.format(el.id)+e.message,"Warning")}if(result==false){isValidate=false;this.invalidMessages[this.invalidMessages.length.toString()]=custom.invalidMessage;if(this.isContinue==false){break}}}}}return isValidate},validateControls:function(e){var t=true;var r=true;var n=null;if(e.type){n=e;t=this.validateControl(n)}else if(e.length){for(var i=0,a=e.length;i<a;i++){n=e[i];r=this.validateControl(n);if(r==false){t=false}}}return t},validateForm:function(){var e=true;var t=false;for(var r in this.validations){t=this.validateControl(this.validations[r]);if(t==false){e=false}}return e},toInvalidMessages:function(){var e="";for(var t=0;t<this.invalidMessages.length;t++){e+=this.invalidMessages[t]+"\r\n"}this.invalidMessages=[];return e},init:function(){var e=null;for(var t in this.validations){this.element=this.validations[t];this.clear()}this.validations=[]},valueType:new function(){this.valid=0;this.valueMissing=1;this.typeMismatch=2;this.patternMismatch=3;this.tooLong=4;this.rangeUnderflow=5;this.rangeOverflow=6;this.stepMismatch=7},validType:new function(){this.required=0;this.pattern=1;this.range=2;this.custom=3},regexs:new function(){this.alphabet=/^[a-zA-Z]*$/;this.juminNo=/^(?:[0-9]{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[1,2][0-9]|3[0,1]))-?[1-4][0-9]{6}$/;this.numeric=/^-?[0-9]*(\.[0-9]+)?$/;this.email=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i;this.url=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i;this.ipAddress=/^(?:\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b|null)$/;this.date=/^\d{4}-\d{2}-\d{2}$/;this.mobilePhone=/^01([0|1|6|7|8|9])(\d{7,8})/;this.seoulPhone=/^02(\d{7,8})/;this.areaPhone=/^0([0|3|4|5|6|7|8|])([0|1|2|3|4|5|])(\d{7,8})/;this.onesPhone=/^050([2|5])(\d{7,8})/;this.float=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i;this.isoDate=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/}});window.$validation=window.$v=syn.$v=window.$validation||$validation})(globalThis);(function(e){"use strict";syn.lib=syn.lib||new syn.module;var w=w||new syn.module;var t=t||new syn.module;var p=p||new syn.module;var r=r||new syn.module;var d=d||new syn.module;(function(){var l={current:0,getNew:function(){this.current++;return this.current}};if(isNodejs==false){HTMLElement.prototype.pseudoStyle=function(e,t,r){var n=this;var i="pseudoStyles";var a=document.head||document.getElementsByTagName("head")[0];var o=document.getElementById(i)||document.createElement("style");o.id=i;var s="pseudoStyle"+l.getNew();n.className+=" "+s;o.innerHTML+=" ."+s+":"+e+"{"+t+":"+r+"}";a.appendChild(o);return this};HTMLElement.prototype.controlPseudoStyle=function(e,t){var r=this;var n="controlPseudoStyles";var i=document.head||document.getElementsByTagName("head")[0];var a=document.getElementById(n)||document.createElement("style");a.id=n;var o="controlPseudoStyle"+l.getNew();r.className+=" "+o;a.innerHTML+="#{0} {1} {2}".format(r.id,e,t);i.appendChild(a);return this}}if(!Function.prototype.clone){Function.prototype.clone=function(){var t=this;var e=function e(){return t.apply(this,arguments)};for(var r in this){e[r]=this[r]}return e}}if(!Object.assign){Object.assign=function e(t){if(t===null||typeof t!=="object")return t;var r=t.constructor();for(var n in t){if(t.hasOwnProperty(n)){r[n]=t[n]}}return r}}if(!Object.entries){Object.entries=function(e){var t=Object.keys(e),r=t.length,n=new Array(r);while(r--)n[r]=[t[r],e[t[r]]];return n}}if(!String.prototype.trim){String.prototype.trim=function(){var e=this.replace(/^\s+/,"");for(var t=e.length-1;t>0;t--){if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}}return e}}if(!String.prototype.includes){String.prototype.includes=function(e){return this.indexOf(e)!==-1}}if(!String.prototype.format){String.prototype.format=function(){var e=this;for(var t=0,r=arguments.length;t<r;t++){var n=new RegExp("{"+t.toString()+"+?}","g");e=e.replace(n,arguments[t])}return e}}if(!String.prototype.parseISOString){String.prototype.parseISOString=function(){var e=this;var t=null;if(e&&e.includes("T")==true){var r=e.split(/\D+/);t=new Date(Date.UTC(r[0],--r[1],r[2],r[3],r[4],r[5],r[6]))}return t}}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var n=r.length>>>0;if(n===0){return false}var i=t|0;var a=Math.max(i>=0?i:n-Math.abs(i),0);function o(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(a<n){if(o(r[a],e)){return true}a++}return false}})}if(!Array.prototype.filter){Array.prototype.filter=function(e,t){"use strict";if(!((typeof e==="Function"||typeof e==="function")&&this))throw new TypeError;var r=this.length>>>0,n=new Array(r),i=this,a=0,o=-1;if(t===undefined){while(++o!==r){if(o in this){if(e(i[o],o,i)){n[a++]=i[o]}}}}else{while(++o!==r){if(o in this){if(e.call(t,i[o],o,i)){n[a++]=i[o]}}}}n.length=a;return n}}if(!Array.prototype.map){Array.prototype.map=function(e,t){var r,n,i;if(this==null){throw new TypeError(" this is null or not defined")}var a=Object(this);var o=a.length>>>0;if(typeof e!=="function"){throw new TypeError(e+" is not a function")}if(arguments.length>1){r=t}n=new Array(o);i=0;while(i<o){var s,l;if(i in a){s=a[i];l=e.call(r,s,i,a);n[i]=l}i++}return n}}if(!Date.prototype.toISOString){Date.prototype.toISOString=function(){var e=this;function t(e){return(e<10?"0":"")+e}function r(e){return(e<100?"0":"")+t(e)}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+r(e.getMilliseconds())+"Z"}}if(isNodejs==true){}else{if(!Element.prototype.matches){Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector}if(!Element.prototype.closest){Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(t!==null&&t.nodeType===1);return null}}}})();w.extend({version:"1.0",interval:{yyyy:{units:1e3*60*60*24*365,measure:"year"},m:{units:1e3*60*60*24*30,measure:"month"},d:{units:1e3*60*60*24,measure:"day"},q:{units:1e3*60*60*24*30*3,measure:"quarter"},h:{units:6e4*60,measure:"hour"},n:{units:6e4,measure:"minute"},s:{units:1e3,measure:"second"}},minutes:6e4,weekNames:["ì¼","ì","í","ì","ëª©","ê¸","í "],yearName:"ë",monthName:"ì",dayName:"ì¼",toUTC:function(e){if(typeof e==="string"){var t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(e);if(t){return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],+t[6]))}}return null},clear:function(e,t){e.setYear(0);e.setMonth(0);e.setDate(0);if(t===true){e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0)}return e},now:function(e){e=new Date;return e},clone:function(e){return new Date(e.getTime())},isBetween:function(e,t,r){return e.getTime()>=t.getTime()&&e.getTime()<=r.getTime()},equals:function(e,t){return e.toDateString()==(t||new Date).toDateString()},isToday:function(e){return w.equals(e,new Date)},toString:function(e,t){var r="";var n=e.getFullYear();var i=e.getMonth()+1;var a=e.getDate().toString().length==1?"0"+e.getDate().toString():e.getDate().toString();var o=e.getHours().toString().length==1?"0"+e.getHours().toString():e.getHours().toString();var s=e.getMinutes().toString().length==1?"0"+e.getMinutes().toString():e.getMinutes().toString();var l=e.getSeconds().toString().length==1?"0"+e.getSeconds().toString():e.getSeconds().toString();var u=e.getMilliseconds().toString();i=i.toString().length==1?"0"+i.toString():i.toString();switch(t){case"d":r=n.toString().concat("-",i,"-",a);break;case"t":r=o.toString().concat(":",s,":",l);break;case"a":r=n.toString().concat("-",i,"-",a," ",o,":",s,":",l);break;case"f":r=n.toString().concat(i,a,o,s,l,u);break;case"w":var f=1;var c=w.weekOfMonth(n,i);var d=Number(w.toString(e,"d").replace(/-/g,""));for(var h=0;h<c.length;h++){var v=c[h];var p=Number(v.weekStartDate.replace(/-/g,""));var g=Number(v.weekEndDate.replace(/-/g,""));if(d>=p&&d<=g){f=h;break}}r=f;break;case"wn":r=w.weekNames[e.getDay()];break;case"wm":r=w.weekOfMonth(n,i);break;case"m":r=i;break;case"y":r=n.toString();break;case"ym":r=n.toString().concat("-",i);break;case"n":var m=week[e.getDay()];r=n.toString().concat(w.yearName,i,w.monthName,a,w.dayName,"(",m,")");break;default:r=e.getDate()}return r},addHour:function(e,t){return new Date(e.setTime(e.getTime()+t*60*60*1e3))},addDay:function(e,t){return new Date(e.setDate(e.getDate()+t))},addWeek:function(e,t){return new Date(e.setDate(e.getDate()+t*7))},addMonth:function(e,t){return new Date(e.setMonth(e.getMonth()+t))},addYear:function(e,t){return new Date(e.setFullYear(e.getFullYear()+t))},getFirstDate:function(e){return new Date(e.setDate(1))},getLastDate:function(e){e=w.addMonth(e,1);return w.addDay(new Date(e.setDate(1)),-1)},diff:function(e,t,r){if($ref.isString(t)==true){t=new Date(t)}if($ref.isString(r)==true){r=new Date(r)}var n=this.toString(t,"d");var i=n.split("-");var a=i[0];var o=i[1]-1;var s=i[2];var l=this.toString(r,"d");var u=l.split("-");var f=u[0];var c=u[1]-1;var d=u[2];var h=new Date(a,o,s);h.setHours(0);h.setMinutes(0);h.setSeconds(0);var v=h.getTime();var p=new Date(f,c,d);p.setHours(0);p.setMinutes(0);p.setSeconds(0);var g=p.getTime();var m=null;if(p>h){m=(p.getTimezoneOffset()-h.getTimezoneOffset())*w.minutes}else{m=(h.getTimezoneOffset()-p.getTimezoneOffset())*w.minutes}if(typeof w.interval[e]!="undefined"){var y=Math.ceil(g-v)-m;var b=Math.floor(y/w.interval[e].units);return parseInt(b)}else{return-1}},toTicks:function(e){return e.getTime()*1e4+621355968e9},isDate:function(e){var t=false;var r=null;r=new Date(e);if(r.toString()=="NaN"||r.toString()=="Invalid Date"){if(syn.$b.isSafari==true&&$b.isChrome==false){var n=e.match(/(\d+)/g);r=new Date(n[0],n[1]-1,n[2]);if(r.toString()=="NaN"||r.toString()=="Invalid Date"){t=false}else{t=true}}else{t=false}}else{t=true}return t},isISOString:function(e){var t=new Date(e);return!Number.isNaN(t.valueOf())&&t.toISOString()===e},weekOfMonth:function(e,t,r){var n=[];var i=new Date(e,t);var a=new Date(i.getFullYear(),i.getMonth()-1,1);var o=new Date(i.getFullYear(),i.getMonth(),0);var s=null;if(d.isNullOrUndefined(r)==true){r=8}var l=true;var u=a.getDay();var f=function(e,t){e=String(e);return e.length>=t?e:new Array(t-e.length+1).join("0")+e};for(var c=1;c<=6;c++){if(o.getMonth()!=a.getMonth()){break}s={};if(a.getDay()<=1){if(a.getDay()==0){a.setDate(a.getDate()+1)}s.weekStartDate=a.getFullYear().toString()+"-"+f((a.getMonth()+1).toString(),2)+"-"+f(a.getDate().toString(),2)}if(r>u){if(l){if(r-a.getDay()==1){a.setDate(a.getDate()+(r-a.getDay())-1)}if(r-a.getDay()>1){a.setDate(a.getDate()+(r-a.getDay())-1)}l=false}else{a.setDate(a.getDate()+6)}}else{a.setDate(a.getDate()+(6-a.getDay())+r)}if(typeof s.weekStartDate!=="undefined"){s.weekEndDate=a.getFullYear().toString()+"-"+f((a.getMonth()+1).toString(),2)+"-"+f(a.getDate().toString(),2);n.push(s)}a.setDate(a.getDate()+1)}return n}});e.$date=$date=w;p.extend({version:"1.0",toDate:function(e){return new Date((e-621355968e9)/1e4)},br:function(e){return e.replace(/(\r\n|\r|\n)/g,"<br />")},isBusinessNo:function(e){var t=false;var r=e.replace(/-/gi,"").split("").map(function(e){return parseInt(e,10)});if(r.length===10){try{var n=[1,3,7,1,3,7,1,3,5];var i=0;for(var a=0;a<n.length;++a){i+=n[a]*r[a]}i+=parseInt(n[8]*r[8]/10,10);t=Math.floor(r[9])===(10-i%10)%10}catch(e){t=false}}return t},isCorporateNo:function(e){var t=false;var r=e.replace(/-/gi,"");r=r.trim();var n=[1,2,1,2,1,2,1,2,1,2,1,2];var i,a=0;if(r.length!=13){return false}for(var i=0;i<12;i++){a+=n[i]*r.charAt(i)}if((10-a%10)%10!=r.charAt(12)){t=false}else{t=true}return t},isNullOrEmpty:function(e){if(e===undefined||e===null||e===""){return true}else{return false}},sanitizeHTML:function(e){var t=document.createElement("div");t.innerText=e;return t.innerHTML},toHtmlChar:function(e){return e.replace(/&/g,"&amp;").replace(/\'/g,"&quot;").replace(/\'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toCharHtml:function(e){return e.replace(/&amp;/g,"&").replace(/&quot;/g,"'").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")},toAscii:function(e){return e.trim().replace(/[^0-9a-zA-Z\value]/g,"")},isAscii:function(e){return/^[\x00-\x7F]*$/.test(e)},length:function(e){var t=0;for(var r=0,n=e.length;r<n;r++){if(e.charCodeAt(r)>127){t+=2}else{t++}}return t},substring:function(e,t){var r=0;if(d.isNullOrUndefined(t)==true){t=e.length}for(var n=0;n<e.length;n++){if(e.charCodeAt(n)>127){r+=2}else{r+=1}if(r>t){return e.substring(0,n)}}return e},split:function(e,t){var r=0;var n=[];while(r<e.length){var i=p.substring(e,t);if(i){n.push(i);e=e.replace(i,"")}else{break}}return n},isNumber:function(e,t){e=String(e).replace(/^\s+|\s+$/g,"");if(typeof t=="undefined"||t=="1"){var r=/^[+\-]?(([1-9][0-9]{0,2}(,[0-9]{3})*)|[0-9]+){1}(\.[0-9]+)?$/g}else if(t=="2"){var r=/^(([1-9][0-9]{0,2}(,[0-9]{3})*)|[0-9]+){1}(\.[0-9]+)?$/g}else if(t=="3"){var r=/^[0-9]+(\.[0-9]+)?$/g}else{var r=/^[0-9]$/g}if(r.test(e)){e=e.replace(/,/g,"");return isNaN(e)?false:true}else{return false}},capitalize:function(e){return e.replace(/\b([a-z])/g,function(e){return e.toUpperCase()})},toJson:function(e,t){t=t||{};var r=t.delimeter||",";var n=t.newline||"\n";var i=t.meta||{};var a,o,s=e.split(RegExp("{0}".format(n),"g"));var l=s[0].split(r);for(a=0;a<l.length;a++){l[a]=l[a].replace(/(^[\s"]+|[\s"]+$)/g,"")}var u=[];var f=s.length;var c=l.length;if($ref.isEmpty(i)==true){for(a=1;a<f;a++){o=s[a].split(r);var d={};for(var h=0;h<c;h++){d[l[h]]=p.toDynamic(o[h])}u.push(d)}}else{for(a=1;a<f;a++){o=s[a].split(r);var d={};for(var h=0;h<c;h++){var v=l[h];d[v]=p.toParseType(o[h],i[v])}u.push(d)}}return u},toParameterObject:function(e){return(e.match(/([^?:;]+)(:([^;]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf(":")).replace("@","")]=t.slice(t.indexOf(":")+1),e},{})},toNumber:function(e){var t=0;try{t=parseFloat((d.isNullOrUndefined(e)==true?0:e)===0||e===""?"0":e.toString().replace(/,/g,""))}catch(e){console.log(e)}return t},toBoolean:function(e){return e==="true"||e==="True"||e==="TRUE"||e==="Y"||e=="1"},toDynamic:function(e,t){var r;if(t==undefined){t=false}if(t==true&&e===""){r=null}else{if(e==="true"||e==="True"||e==="TRUE"){r=true}else if(e==="false"||e==="False"||e==="FALSE"){r=false}else if($validation.regexs.float.test(e)){r=p.toNumber(e)}else if($validation.regexs.isoDate.test(e)){r=new Date(e)}else{r=e}}return r},toParseType:function(e,t,r){var n;if(r==undefined){r=false}if(r==true&&e===""){n=null}else{switch(t){case"string":n=e;break;case"bool":n=p.toBoolean(e);break;case"number":case"int":n=d.isNullOrUndefined(e)==true?null:p.isNumber(e)==true?p.toNumber(e):null;break;case"date":if($validation.regexs.isoDate.test(e)){n=new Date(e)}break;default:n=e;break}}return n},toNumberString:function(e){return e.replace(/,/g,"")},toCurrency:function(e,t,r){var n=null;if(syn.lib.$string.isNumber(e)==false){return n}if(d.isNullOrUndefined(t)==true){var i=e.toString().split(".");var a=i[0];var o=i.length>1?"."+i[1]:"";var s=/(\d+)(\d{3})/;while(s.test(a)){a=a.replace(s,"$1"+","+"$2")}n=a+o}else{var l=$w.argumentsExtend({style:"currency",currency:"KRW"},r);n=Intl.NumberFormat(t,l).format(e)}return n},pad:function(e,t,r,n){var r=r||"0";var i="";if(d.isNullOrUndefined(n)==true){n=true}else{n=p.toBoolean(n)}e=e.toString();if(e.length<t){for(var a=0;a<t-e.length;a++){i+=r}}var o=null;if(n==true){o=i+e}else{o=e+i}return o},toClipboard:function(e){if(isNodejs==true){}else{var t=document.createElement("textarea");t.value=e;t.setAttribute("readonly","");t.style.position="absolute";t.style.left="-9999px";document.body.appendChild(t);var r=document.getSelection().rangeCount>0?document.getSelection().getRangeAt(0):false;t.select();document.execCommand("copy");document.body.removeChild(t);if(r){document.getSelection().removeAllRanges();document.getSelection().addRange(r)}}}});e.$string=syn.lib.$string=p;t.extend({version:"1.0",distinct:function(e){var t=[];for(var r=0,n=e.length;r<n;r++){if(this.contains(t,e[r])==false){t.push(e[r])}}return t},sort:function(e,t){var r=null;if(t){t=true}if(t==true){for(var n=0,i=e.length;n<i;n++){for(var a=0,o=e.length;a<o;a++){if(e[n]<e[a]){r=e[n];e[n]=e[a];e[a]=r}}}}else{for(var n=0,i=e.length;n<i;n++){for(var a=0,o=e.length;a<o;a++){if(e[n]>e[a]){r=e[n];e[n]=e[a];e[a]=r}}}}r=null},objectSort:function(e,i,t){if(d.isNullOrUndefined(t)==true){t=true}if(t==true){e.sort(function(e,t){var r=e[i];var n=t[i];if(r<n){return-1}if(r>n){return 1}return 0})}else{e.sort(function(e,t){var r=e[i];var n=t[i];if(r<n){return 1}if(r>n){return-1}return 0})}},shuffle:function(e){var t=e.length,r;var n=null;while(t--){r=Math.floor((t+1)*Math.random());n=e[t];e[t]=e[r];e[r]=n}},lastIndexOf:function(e,t){var r=e.length;while(r--){if(e[r]===t){return r}}return-1},clear:function(e){e.length=0},add:function(e,t){e.push(t)},addAt:function(e,t,r){if(e.length-1<=t){e.splice(t,0,r)}},remove:function(e){e.pop()},removeAt:function(e,t){if(t<=e.length-1){e.splice(t,1)}},removeID:function(e,t,r){var n=e.find(function(e){return e[t]==r});var i=e.indexOf(n);if(i>-1){e.splice(i,1)}},contains:function(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r]===t){return true}}return false},addProp:function(e,t,r){e.push({prop:t,val:r})},union:function(e,t){var r=[];var n={};for(var i=0;i<e.length;i++){n[e[i]]=1}for(var i=0;i<t.length;i++){n[t[i]]=1}for(var a in n){r.push(a)}return r},difference:function(e,t){return e.filter(function(e){return!t.includes(e)})},intersection:function(e,t){return e.filter(function(e){return t.includes(e)})},symmetryDifference:function(t,r){return t.filter(function(e){return!r.includes(e)}).concat(r.filter(function(e){return!t.includes(e)}))},getValue:function(e,t,r,n,i){var a=null;if(e&&e.length>0){var o=null;if(n){o=e.find(function(e){return e[n]==t})}else{o=e.find(function(e){return e.ParameterName==t})}if(o){if(i){a=o[i]}else{a=o.Value}}else{if(r===undefined){a=""}else{a=r}}}return a},ranks:function(e,t){var r=[];if(d.isNullOrUndefined(e)==false&&$ref.isArray(e)==true){if(d.isNullOrUndefined(t)==true){t=false}else{t=p.toBoolean(t)}if(t==true){for(var n=0;n<e.length;n++){e[n]=-+e[n]}}var i=e.slice().sort(function(e,t){return t-e});r=e.map(function(e){return i.indexOf(e)+1})}return r}});e.$array=syn.lib.$array=t;r.extend({version:"1.0",duration:function(e){if(e<0)e=-e;var t={year:0,week:0,day:Math.floor(e/864e5),hour:Math.floor(e/36e5)%24,minute:Math.floor(e/6e4)%60,second:Math.floor(e/1e3)%60,millisecond:Math.floor(e)%1e3};if(t.day>365){t.year=t.day%365;t.day=Math.floor(t.day/365)}if(t.day>7){t.week=t.day%7;t.day=Math.floor(t.day/7)}return t},toByte:function(e,t,r){if(t===void 0){t=3}if(r===void 0){r=true}var n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(Math.abs(e)<1)return e+(r?" ":"")+n[0];var i=Math.min(Math.floor(Math.log10(e<0?-e:e)/3),n.length-1);var a=Number(((e<0?-e:e)/Math.pow(1024,i)).toPrecision(t));return(e<0?"-":"")+a+(r?" ":"")+n[i]},isRange:function(e,t,r){return e>=t&&e<=r},limit:function(e,t,r){return e<t?t:e>r?r:e},limitAbove:function(e,t){return Math.min(t,e)},limitBelow:function(e,t){return Math.max(t,this)},mod:function(e,t){return e>=0?e%t:(e%t+Math.abs(t))%t},percent:function(e,t,r){var r=r||0;var n=Math.pow(10,r);return Math.round(e*100/t*n)/n},random:function(e,t){if(p.isNullOrEmpty(e)==true){e=0}if(p.isNullOrEmpty(t)==true){t=10}return Math.floor(Math.random()*(t-e+1)+e)}});e.$number=syn.lib.$number=r;d.extend({version:"1.0",isNullOrUndefined:function(e){if(e===undefined||e===null){return true}else{return false}},toCSV:function(e,t){if(typeof e!=="object")return null;t=t||{};var r=t.scopechar||"/";var n=t.delimeter||",";var i=t.newline||"\n";if(Array.isArray(e)===false)e=[e];var a,o,s,l,u,f=[],c=[],d={},h=[];for(s=0;s<e.length;s++){u=[e[s],""];c[s]={};while(u.length>0){o=u.pop();a=u.pop();if(a!==null&&typeof a==="object"){for(l in a){if(a.hasOwnProperty(l)){u.push(a[l]);u.push(o+(o?r:"")+l)}}}else{if(d[o]===undefined)d[o]=true;c[s][o]=a}}f[s]=[]}for(l in d){if(d.hasOwnProperty(l)){h.push(l);for(s=0;s<e.length;s++){f[s].push(c[s][l]===undefined?"":c[s][l])}}}for(s=0;s<e.length;s++){f[s]=f[s].join(n)}return h.join(n)+i+f.join(i)},toParameterString:function(e){return e?Object.entries(e).reduce(function(e,t,r){var n=t[0],i=t[1];if(n.indexOf("@")==-1){e+=typeof i==="string"?"@"+n+":"+i+";":""}return e},""):""}});e.$object=syn.lib.$object=d})(globalThis);(function(d){"use strict";var t=t||new syn.module;var h=null;if(isNodejs==true){}else{h=window.document;(function(){if(typeof d.CustomEvent!=="function"){var e=function(e,t){t=t||{bubbles:false,cancelable:false,detail:undefined};var r=h.createEvent("CustomEvent");r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail);return r};e.prototype=d.Event.prototype;d.CustomEvent=e}d["events"]=function(){var i=[];return{items:i,add:function(e,t,r){i.push(arguments)},remove:function(e,t,r){var n=i.indexOf(arguments);if(n>-1){delete i[n]}},flush:function(){var e,t;for(e=i.length-1;e>=0;e=e-1){t=i[e];if(t[0].removeEventListener){t[0].removeEventListener(t[1],t[2],t[3])}if(t[1].substring(0,2)!="on"){t[1]="on"+t[1]}if(t[0].detachEvent){t[0].detachEvent(t[1],t[2])}t[0][t[1]]=null}purge(h.body)}}}()})()}t.extend({version:"1.0",prefixs:["webkit","moz","ms","o",""],eventMap:{},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e=="x"?t:t&3|8;return r.toString(16)})},uuid:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})},stringToArrayBuffer:function(e,t){var r=1;if(t&&t===true){r=2}var n=new ArrayBuffer(e.length*r);var i=new Uint8Array(n);for(var a=0,o=e.length;a<o;a++){i[a]=e.charCodeAt(a)}return n},arrayBufferToString:function(e){var t=new Uint8Array(e);var r=String.fromCharCode.apply(null,t);return decodeURIComponent(r)},random:function(e){var e=e||8;var t="";while(t.length<e){t+=Math.random().toString(36).substr(2)}return t.substr(0,e)},execPrefixFunc:function(e,t){var r=$l.prefixs;var n=0,i,a;while(n<r.length&&!e[i]){i=t;if(r[n]==""){i=i.substr(0,1).toLowerCase()+i.substr(1)}i=r[n]+i;a=typeof e[i];if(a!="undefined"){r=[r[n]];return a=="function"?e[i]():e[i]}n++}},dispatchClick:function(e,t){try{e=$ref.isString(e)==true?$l.get(e):e;t=$w.argumentsExtend({canBubble:true,cancelable:true,view:window,detail:0,screenX:0,screenY:0,clientX:80,clientY:20,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:null},t);var r=h.createEvent("MouseEvents");r.initMouseEvent("click",t.canBubble,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget);e.dispatchEvent(r)}catch(e){$l.eventLog("$l.dispatchClick",e,"Warning")}},addEvent:function(e,t,r){e=$ref.isString(e)==true?$l.get(e):e;if(r&&$reflection.isFunction(r)==true){if(e.addEventListener){e.addEventListener(t,r,false)}else if(e.attachEvent){e.attachEvent("on"+t,r)}else{e["on"+t]=e["e"+t+r]}events.add(e,t,r);if($reflection.isString(t)==true&&t.toLowerCase()==="resize"){r()}}},addLive:function(n,e,i){t.addEvent(d||h,e,function(e){var t,r=e.target||e.srcElement;while(r&&!(t=r.id==n.id)){r=r.parentElement}if(t){i.call(r,e)}});return n},removeEvent:function(e,t,r){if(r&&$reflection.isFunction(r)==true){e=$ref.isString(e)==true?$l.get(e):e;if(e.removeEventListener){e.removeEventListener(t,r,false)}else if(e.detachEvent){e.detachEvent("on"+t,r)}else{e["on"+t]=null}events.remove(e,t,r)}},hasEvent:function(e,t){var r=null;var n=false;e=$ref.isString(e)==true?$l.get(e):e;for(var i=0,a=events.items.length;i<a;i++){r=events.items[i];if(r&&r[0]instanceof d.constructor||r[0]instanceof h.constructor){if(r[1]==t){n=true;break}}else{if(r&&r[0].id){if(r[0].id==e.id&&r[1]==t){n=true;break}}}}return n},trigger:function(e,t,r){var n=null;var i=null;e=$ref.isString(e)==true?$l.get(e):e;for(var a=0,o=events.items.length;a<o;a++){n=events.items[a];if(n[0]instanceof d.constructor||n[0]instanceof h.constructor){if(n[1]==t){i=n[2];break}}else{if(n[0].id){if(n[0].id==e.id&&n[1]==t){i=n[2];break}}}}if(i){if(r){i.call(e,r)}else{i.call(e)}}return this},triggerEvent:function(e,t,r){e=$ref.isString(e)==true?$l.get(e):e;if(d.CustomEvent){if(r){e.dispatchEvent(new CustomEvent(t,{detail:r}))}else{e.dispatchEvent(new CustomEvent(t))}}else if(h.createEvent){var n=h.createEvent("HTMLEvents");n.initEvent(t,false,true);if(r){e.dispatchEvent(n,r)}else{e.dispatchEvent(n)}}else if(e.fireEvent){var n=h.createEventObject();n.eventType=t;if(r){e.fireEvent("on"+n.eventType,r)}else{e.fireEvent("on"+n.eventType)}}return e},addBind:function(e,t,r){if(r&&$reflection.isFunction(r)==true){var n=h.querySelectorAll(e);var i=n.length;for(var a=0;a<i;a++){var o=n[a];$l.addEvent(o,t,r)}}},createEventHub:function(){return{hub:Object.create(null),emit:function e(t,r){(this.hub[t]||[]).forEach(function(e){return e(r)})},on:function e(t,r){if(!this.hub[t])this.hub[t]=[];this.hub[t].push(r)},off:function e(t,r){var n=(this.hub[t]||[]).findIndex(function(e){return e===r});if(n>-1)this.hub[t].splice(n,1);if(this.hub[t].length===0)delete this.hub[t]}}},get:function(){var e=[];var t=null;var r="";for(var n=0,i=arguments.length;n<i;n++){r=arguments[n];if($reflection.isString(r)==true){t=h.getElementById(r)}e.push(t)}if(e.length==1){return t}else{return e}},querySelector:function(){var e=[];var t=null;var r="";for(var n=0,i=arguments.length;n<i;n++){r=arguments[n];if(typeof r=="string"){t=h.querySelector(r)}e.push(t)}if(e.length==1){return t}else{return e}},getName:function(){var e=[];var t=[];var r="";for(var n=0,i=arguments.length;n<i;n++){r=arguments[n];if(typeof r=="string"){t=h.getElementsByTagName(r)}for(var a in t){if(typeof t[a]=="object"){e.push(t[a])}}}if(e.length==1){return t}else{return e}},querySelectorAll:function(){var e=[];var t=[];var r="";for(var n=0,i=arguments.length;n<i;n++){r=arguments[n];if(typeof r=="string"){t=h.querySelectorAll(r)}for(var a in t){if(typeof t[a]=="object"){e.push(t[a])}}}r=null;if(e.length==1){return t}else{return e}},getElementsById:function(){var e=[];var t=null;var r="";for(var n=0;n<arguments.length;n++){r=arguments[n];if(typeof r=="string"){t=h.getElementById(r)}if(arguments.length==1){return t}e.push(t)}return e},getElementsByClassName:function(){var e=[];var t=null;var r="";for(var n=0;n<arguments.length;n++){r=arguments[n];if(typeof r=="string"){t=h.getElementsByClassName(r)}if(arguments.length==1){return t}for(var n=0;n<t.length;n++){e.push(t[n])}}return e},getElementsByTagName:function(){var e=[];var t=[];var r="";for(var n=0;n<arguments.length;n++){r=arguments[n];if(typeof r=="string"){t=h.getElementsByTagName(r)}if(arguments.length==1){return t}for(var i in t){if(typeof t[i]=="object"){e.push(t[i])}}}return e},clone:function(e){function t(){}t.prototype=e;return new t},method:function(e,t,r){e.prototype[t]=r;return this},toEnumText:function(e,t){var r=null;for(var n in e){if(e[n]==t){r=n;break}}return r},prettyJSON:function(e,t){if(t===true){if(typeof e!="string"){e=JSON.stringify(e,undefined,2)}e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";if(/^"/.test(e)){if(/:$/.test(e)){t="key"}else{t="string"}}else if(/true|false/.test(e)){t="boolean"}else if(/null/.test(e)){t="null"}return'<span class="'+t+'">'+e+"</span>"})}else{return JSON.stringify(e,null,2)}},prettyTSD:function(e,t){var r=null;t=t==undefined?false:t;try{var n=e.split("ï¼¾");if(n.length>1){var i=$string.toParameterObject(n[0]);r=$string.toJson(n[1],{delimeter:"ï½",newline:"âµ",meta:i})}else{r=$string.toJson(n[0],{delimeter:"ï½",newline:"âµ"})}}catch(e){r=e}return t==true?r:$l.prettyJSON(r)},text2Json:function(e,t,r){if(t==undefined){t=","}if(r==undefined){r="\n"}var i=e.slice(0,e.indexOf(r)).split(t);return e.slice(e.indexOf(r)+1).split(r).map(function(e){var n=e.split(t);return i.reduce(function(e,t,r){return e[t]=n[r],e},{})})},json2Text:function(e,t,n,r){function i(e){return l(e)||s(e)||o(e)||a()}function a(){throw new TypeError("ì í¨íì§ ìì ë°ì´í° íì")}function o(e,t){if(!e)return;if(typeof e==="string")return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}function s(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function l(e){if(Array.isArray(e))return u(e)}function u(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}if(n==n){n=","}if(r==undefined){r="\n"}return[t.join(n)].concat(i(e.map(function(r){return t.reduce(function(e,t){return"".concat(e).concat(!e.length?"":n,'"').concat(!r[t]?"":r[t],'"')},"")}))).join(r)},nested2Flat:function(e,t,r,n){var i=[];if(e){if($object.isNullOrUndefined(n)==true){n="items"}var a=$ref.clone(e,false);delete a[n];a[r]=null;i.push(a);$l.parseNested2Flat(e,i,t,r,n)}else{$l.eventLog("$l.nested2Flat","íì ë°ì´í° íì¸ íì","Warning")}return i},parseNested2Flat:function(e,t,r,n,i){var a=null;if($object.isNullOrUndefined(i)==true){i="items"}var o=e[i];if(e&&o){for(var s=0;s<o.length;s++){var l=o[s];var u=$ref.clone(l,false);delete u[i];u[n]=e[r];t.push(u);if(l[i]&&l[i].length>0){$l.parseNested2Flat(l,t,r,n,i)}}}return a},flat2Nested:function(e,t,r,n){var i=null;if(e&&t&&r){if($object.isNullOrUndefined(n)==true){n="items"}var a=e.find(function(e){return e[r]==null});var o=$l.parseFlat2Nested(e,a,[],t,r,n);a[n]=o[n];i=a}else{$l.eventLog("$l.flat2Nested","íì ë°ì´í° íì¸ íì","Warning")}return i},parseFlat2Nested:function(e,t,r,n,i,a){if($object.isNullOrUndefined(a)==true){a="items"}var o=e.filter(function(e){return e[i]==t[n]});if(o.length>0){if(!r[a]){r[a]=[]}for(var s=0;s<o.length;s++){r[a].push($ref.clone(o[s]));$l.parseFlat2Nested(e,o[s],r[a][s],n,i,a)}}return r},findNestedByID:function(e,t,r,n){var i=null;if($object.isNullOrUndefined(n)==true){n="items"}var a=e[n];if(e&&a){if(e[r]==t){i=e;return i}for(var o=0;o<a.length;o++){var s=a[o];if(s[r]==t){i=s;return i}else if(s[n]&&s[n].length>0){i=$l.findNestedByID(s,t,r,n);if(i){return i}}}}return i},extend:function(e,t){if(arguments[2]){for(var r=2,n=arguments.length;r<n;r++){e.prototype[arguments[r]]=t.prototype[arguments[r]]}}else{for(var i in t.prototype){if(!e.prototype[i]){e.prototype[i]=t.prototype[i]}}}return this},logLevel:new function(){this.Verbose=0;this.Debug=1;this.Information=2;this.Warning=3;this.Error=4;this.Fatal=5},start:(new Date).getTime(),eventLogTimer:null,eventLogCount:0,eventLog:function(e,t,r){var n=typeof t=="object"?t.message:t;var i=typeof t=="object"?t.stack:t;if(r){if(syn.$reflection.isString(r)==true){r=$l.logLevel[r]}}else{r=0}if(syn.Config&&syn.Config.UIEventLogLevel){if(syn.$l.logLevel[syn.Config.UIEventLogLevel]>r){return}}var a=$l.toEnumText(syn.$l.logLevel,r);var o=(new Date).getTime(),s=o-$l.start,l,u,f;if(isNodejs==true){l=$l.eventLogCount.toString()+"@"+(s/1e3).toString().format("0.000")+" ["+e+"] "+(n===i?n:i);switch(a){case"Debug":globalThis.$logger.debug(l);break;case"Information":globalThis.$logger.info(l);break;case"Warning":globalThis.$logger.warn(l);break;case"Error":globalThis.$logger.error(l);break;case"Fatal":globalThis.$logger.fatal(l);break;default:globalThis.$logger.trace(l);break}}else{l=$l.eventLogCount.toString()+"@"+(s/1e3).toString().format("0.000")+" ["+a+"] "+"["+e+"] "+(n===i?n:i);if(d.console){console.log(l)}else{u=h.createElement("DIV");f=h.createTextNode(l);u.appendChild(f);var c=h.getElementById("eventlogs");if(c){c.appendChild(u);clearTimeout(syn.$l.eventLogTimer);$l.eventLogTimer=setTimeout(function(){c.scrollTop=c.scrollHeight},10)}else{h.body.appendChild(u)}}if(d.bound){bound.browserEvent("browser",{ID:"EventLog",Data:l},function(e,t){if(e){console.log("browser EventLog - {0}".format(e))}})}}$l.eventLogCount++},moduleEventLog:function(e,t,r,n){var i=typeof r=="object"?r.message:r;var a=typeof r=="object"?r.stack:r;if(n){if(syn.$reflection.isString(n)==true){n=$l.logLevel[n]}}else{n=0}if(syn.Config&&syn.Config.UIEventLogLevel){if(syn.$l.logLevel[syn.Config.UIEventLogLevel]>n){return}}var o=$l.toEnumText(syn.$l.logLevel,n);var s=(new Date).getTime(),l=s-$l.start,u;u=$l.eventLogCount.toString()+"@"+(l/1e3).toString().format("0.000")+" ["+t+"] "+(i===a?i:a);var f=syn.getModuleLibrary(e);if(f){var c=f.logger;switch(o){case"Debug":c.debug(u);break;case"Information":c.info(u);break;case"Warning":c.warn(u);break;case"Error":c.error(u);break;case"Fatal":c.fatal(u);break;default:c.trace(u);break}}else{console.log("ModuleID íì¸ íì - {0}".format(e))}$l.eventLogCount++}});d.$library=d.$l=syn.$l=d.$library||t;if(isNodejs==true){delete syn.$l.addEvent;delete syn.$l.addLive;delete syn.$l.removeEvent;delete syn.$l.hasEvent;delete syn.$l.trigger;delete syn.$l.triggerEvent;delete syn.$l.addBind;delete syn.$l.get;delete syn.$l.querySelector;delete syn.$l.getName;delete syn.$l.querySelectorAll;delete syn.$l.getElementsById;delete syn.$l.getElementsByClassName;delete syn.$l.getElementsByTagName}else{delete syn.$l.moduleEventLog;d.onevent=$l.addEvent;d.bind=$l.addBind;d.trigger=$l.trigger;$l.addEvent(d,"unload",events.flush)}})(globalThis);(function(e){"use strict";var t=t||new syn.module;var o=null;if(isNodejs==true){}else{o=window.document}t.extend({version:"1.0",params:[],path:isNodejs==true?"":location.pathname,query:function(e,t){if(t===undefined){t=location.href}return function(e){var e=e.split("?");var t=(e.length==1?e[0]:e[1]).split("&");var r=null;for(var n=0;n<t.length;n++){r=t[n].split("=");$r.params[r[0]]=r[1]}e=null;t=null;r=null;return syn.$r.params}(t)[e]},toQueryString:function(e){return e?Object.entries(e).reduce(function(e,t,r){var n=t[0],i=t[1];e+=typeof i==="string"?"&"+n+"="+i:"";return e},""):""},toUrlObject:function(e){return(e.match(/([^?=&]+)(=([^&]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf("="))]=t.slice(t.indexOf("=")+1),e},{})},isCorsEnabled:function(t,e){var r=new syn.$w.xmlHttp;r.timeout=200;if(e){r.open("HEAD",t,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(r)==false){return}}r.onload=function(){e(r.status>=200&&r.status<=299)};r.onerror=function(){e(false)};r.send()}else if(globalThis.Promise){return new Promise(function(e){r.open("HEAD",t,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(r)==false){return}}r.onload=function(){return e(r.status>=200&&r.status<=299)};r.onerror=function(){return e(false)};r.send()})}else{$l.eventLog("$w.isCorsEnabled","ì§ìíì§ ìë ê¸°ë¥. ë§¤ê°ë³ì íì¸ íì","Error")}},httpRequest:function(e,t,r,n,i){if($object.isNullOrUndefined(r)==true){r={}}var a="application/json";var o=null;if($object.isNullOrUndefined(r.body)==false){a=null;var s=r.body;if(e.toUpperCase()=="GET"){var l=t+(t.split("?").length>1?"&":"?");for(var u in s){l+=u+"="+s[u].toString()+"&"}t=encodeURI(l.substring(0,l.length-1))}else{o=new FormData;for(var u in s){o.append(u,s[u].toString())}}}if($object.isNullOrUndefined(n)==true){n=0}var f=new syn.$w.xmlHttp;f.timeout=n;f.open(e,t,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(f)==false){return}}if(i){f.onreadystatechange=function(){if(f.readyState===4){if(f.status!==200){if(f.status==0){$l.eventLog("$r.httpRequest","X-Requested transfort error","Fatal")}else{$l.eventLog("$r.httpRequest","response status - {0}".format(f.statusText)+f.responseText,"Error")}return}if(i){i({status:f.status,response:f.responseText})}}};if(o==null){if(r!={}){f.send(JSON.stringify(r))}else{f.send()}}else{f.send(o)}}else if(globalThis.Promise){return new Promise(function(e){f.onload=function(){return e({status:f.status,response:f.responseText})};f.onerror=function(){return e({status:f.status,response:f.responseText})};if(a!=null){f.setRequestHeader("Content-Type",a)}if(o==null){if(r!={}){f.send(JSON.stringify(r))}else{f.send()}}else{f.send(o)}})}else{$l.eventLog("$w.fetchJSON","ì§ìíì§ ìë ê¸°ë¥. ë§¤ê°ë³ì íì¸ íì","Error")}},httpSubmit:function(e,t,r){if($object.isNullOrUndefined(e)==true){return false}var n=$l.get(e);if(n){n.method=$object.isNullOrUndefined(r)==true?"POST":r;n.action=t;n.submit()}else{return false}},httpDataSubmit:function(t,e,r,n){if($object.isNullOrUndefined(r)==true){r=0}var i=new syn.$w.xmlHttp;i.open("POST",e,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(i)==false){return}}i.timeout=r;if(n){i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==200){if(i.status==0){$l.eventLog("$r.httpDataSubmit","X-Requested transfort error","Fatal")}else{$l.eventLog("$r.httpDataSubmit","response status - {0}".format(i.statusText)+i.responseText,"Error")}return}if(n){n({status:i.status,response:i.responseText})}}};i.send(t)}else if(globalThis.Promise){return new Promise(function(e){i.onload=function(){return e({status:i.status,response:i.responseText})};i.onerror=function(){return e({status:i.status,response:i.responseText})};i.send(t)})}else{$l.eventLog("$r.httpDataSubmit","ì§ìíì§ ìë ê¸°ë¥. ë§¤ê°ë³ì íì¸ íì","Error")}},createBlobUrl:globalThis.URL&&URL.createObjectURL&&URL.createObjectURL.bind(URL)||globalThis.webkitURL&&webkitURL.createObjectURL&&webkitURL.createObjectURL.bind(webkitURL)||globalThis.createObjectURL,revokeBlobUrl:globalThis.URL&&URL.revokeObjectURL&&URL.revokeObjectURL.bind(URL)||globalThis.webkitURL&&webkitURL.revokeObjectURL&&webkitURL.revokeObjectURL.bind(webkitURL)||globalThis.revokeObjectURL,blobToDataUri:function(e,t){if($object.isNullOrUndefined(t)==true){$l.eventLog("$r.blobToDataUri","blob ê²°ê³¼ callback íì¸ íì","Warning");return}var r=new FileReader;r.onloadend=function(){var e=r.result;t(e)};r.onerror=function(){$l.eventLog("$r.blobToDataUri",r.error,"Error");r.abort()};r.readAsDataURL(e)},blobToDownload:function(e,t){if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(e,t)}else{var r=$r.createBlobUrl(e);var n=o.createElement("a");n.href=r;n.download=t;$l.dispatchClick(n);setTimeout(function(){$r.revokeBlobUrl(r);if(n.remove){n.remove()}},100)}},blobUrlToData:function(e,t){if($object.isNullOrUndefined(t)==true){$l.eventLog("$r.blobUrlToData","blob ê²°ê³¼ callback íì¸ íì","Warning");return}var r=new syn.$w.xmlHttp;r.open("GET",e);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(r)==false){return}}r.responseType="blob";r.onload=function(){t(r.response)};r.onerror=function(){$l.eventLog("$r.blobUrlToData","url: {0}, status: {1}".format(e,r.statusText),"Warning")};r.send()},blobUrlToDataUri:function(r,n){if($object.isNullOrUndefined(n)==true){$l.eventLog("$r.blobUrlToDataUri","blob ê²°ê³¼ callback íì¸ íì","Warning");return}var e=new syn.$w.xmlHttp;e.open("GET",r);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(e)==false){return}}e.responseType="blob";e.onload=function(){var t=new FileReader;t.onloadend=function(){var e=t.result;setTimeout(function(){$r.revokeBlobUrl(r)},25);n(null,e)};t.onerror=function(){$l.eventLog("$r.blobUrlToDataUri",t.error,"Error");t.abort();n(t.error.message,null)};t.readAsDataURL(e.response)};e.onerror=function(){$l.eventLog("$r.blobUrlToDataUri","url: {0}, status: {1}".format(r,e.statusText),"Warning");n("url: {0}, status: {1}".format(r,e.statusText),null)};e.send()},url:function(){var e=$r.path.split("?");var t="";t=$r.path+(syn.$r.path.length>0&&e.length>1?"&":"?");for(var r in this.params){if(typeof syn.$r.params[r]=="string"){t+=r+"="+$r.params[r]+"&"}}if($b){if(syn.$b.isIE==true){t+="&noCache="+(new Date).getTime()}}else{if(navigator.appName==="Microsoft Internet Explorer"){t+="&noCache="+(new Date).getTime()}}this.params=[];return encodeURI(t.substring(0,t.length-1))},getCookie:function(e){var t=o.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):undefined},setCookie:function(e,t,r,n,i,a){if($object.isNullOrUndefined(r)==true){r=new Date((new Date).getTime()+1e3*60*60*24)}if($object.isNullOrUndefined(n)==true){n="/"}o.cookie=e+"="+encodeURI(t)+(r?";expires="+r.toGMTString():"")+(n?";path="+n:"")+(i?";domain="+i:"")+(a?";secure":"");return this},deleteCookie:function(e,t,r){if(syn.$r.getCookie(e)){o.cookie=e+"="+(t?";path="+t:"")+(r?";domain="+r:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}return this}});e.$request=e.$r=syn.$r=e.$request||t})(globalThis);(function(e){"use strict";if(e&&!e.$channel){e.$channel=function(){var d=Math.floor(Math.random()*1000001);var f={};function s(r,e,t,n){function i(e){for(var t=0;t<e.length;t++){if(e[t].channelWindow===r){return true}}return false}var a=false;if(e==="*"){for(var o in f){if(!f.hasOwnProperty(o)){continue}if(o==="*"){continue}if(typeof f[o][t]==="object"){a=i(f[o][t]);if(a){break}}}}else{if(f["*"]&&f["*"][t]){a=i(f["*"][t])}if(!a&&f[e]&&f[e][t]){a=i(f[e][t])}}if(a){$l.eventLog("$channel.addChannel","origin: "+e+", scope: "+t+"ì í´ë¹íë ì±ëì´ ì´ë¯¸ ììµëë¤","Warning");return}if(typeof f[e]!="object"){f[e]={}}if(typeof f[e][t]!="object"){f[e][t]=[]}f[e][t].push({channelWindow:r,handler:n})}function b(e,t,r){var n=f[t][r];for(var i=0;i<n.length;i++){if(n[i].channelWindow===e){n.splice(i,1)}}if(f[t][r].length===0){delete f[t][r]}}function w(e){if(Array.isArray){return Array.isArray(e)}else{return e.constructor.toString().indexOf("Array")!=-1}}var C={};var e=function(e){try{if($string.isNullOrEmpty(e.data)==true){return}var t=JSON.parse(e.data);if(typeof t!=="object"||t===null){$l.eventLog("$channel.onPostMessage","postMessage data íì¸ íì","Warning");return}}catch(e){return}var r=e.source;var n=e.origin;var i=null;var a=null;var o=null;if(typeof t.method==="string"){var s=t.method.split("::");if(s.length==2){i=s[0];o=s[1]}else{o=t.method}}if(typeof t.id!=="undefined"){a=t.id}if(typeof o==="string"){var l=false;if(f[n]&&f[n][i]){for(var u=0;u<f[n][i].length;u++){if(f[n][i][u].channelWindow===r){f[n][i][u].handler(n,o,t);l=true;break}}}if(!l&&f["*"]&&f["*"][i]){for(var u=0;u<f["*"][i].length;u++){if(f["*"][i][u].channelWindow===r){f["*"][i][u].handler(n,o,t);break}}}}else if(typeof a!="undefined"){if(C[a]){C[a](n,o,t)}}};if(window.addEventListener){window.addEventListener("message",e,false)}else if(window.attachEvent){window.attachEvent("onmessage",e)}return{connect:function(h){var r=function(){var e="";var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var r=0;r<5;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}();var v=function(e){if(h.debugOutput){try{if(typeof e!=="string"){e=JSON.stringify(e)}}catch(e){}$l.eventLog("$channel.debug","channelID: "+e,"Information")}};if(!window.postMessage){$l.eventLog("$channel.postMessage","postMessageë¥¼ ì§ìíì§ ìë ë¸ë¼ì°ì ","Error");return}if(!window.JSON||!window.JSON.stringify||!window.JSON.parse){$l.eventLog("$channel.JSON","JSONì ì§ìíì§ ìë ë¸ë¼ì°ì ","Error");return}if(typeof h!="object"){$l.eventLog("$channel.options","ì í¨í ë§¤ê°ë³ì ìì´ í¸ì¶ë ì±ë ë¹ë","Error");return}if(!h.window||!h.window.postMessage){$l.eventLog("$channel.window","íì ë§¤ê°ë³ì ìì´ í¸ì¶ë ì±ë ë¹ë","Error");return}if(window===h.window){$l.eventLog("$channel.window","ëì¼í íë©´ìì ê±°ëëë ì±ë ìì±ì íì©ëì§ ìì","Error");return}var e=false;if(typeof h.origin==="string"){var t;if(h.origin==="*"){e=true}else if(null!==(t=h.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))){h.origin=t[0].toLowerCase();e=true}}if(!e){$l.eventLog("$channel.origin","ì í¨í origin ìì´ í¸ì¶ë ì±ë ë¹ë","Error");return}if(typeof h.scope!=="undefined"){if(typeof h.scope!=="string"){$l.eventLog("$channel.scope","scopeë ë¬¸ìì´ì´ì´ì¼ í¨","Error");return}if(h.scope.split("::").length>1){$l.eventLog("$channel.scope",'scopeìë ì´ì¤ ì½ë¡  ("::")ì´ í¬í¨ë  ì ìì',"Error");return}}var p={};var g={};var m={};var n=false;var i=[];var y=function(i,e,a){var t=false;var r=false;return{origin:e,invoke:function(e,t){if(!m[i]){$l.eventLog("$channel.invoke","ì¡´ì¬íì§ ìë í¸ëì­ìì ì½ë°± í¸ì¶ ìë: "+i,"Warning");return}var r=false;for(var n=0;n<a.length;n++){if(e===a[n]){r=true;break}}if(!r){$l.eventLog("$channel.invoke","ì¡´ì¬íì§ ìë ì½ë°± í¸ì¶ ìë: "+e,"Warning");return}c({id:i,callback:e,params:t})},error:function(e,t){r=true;if(!m[i]){$l.eventLog("$channel.error","ì¡´ì¬íì§ ìë ë©ìì§ì í¸ì¶ ìë: "+i,"Warning");return}delete m[i];c({id:i,error:e,message:t})},complete:function(e){r=true;if(!m[i]){$l.eventLog("$channel.complete","ì¡´ì¬íì§ ìë ë©ìì§ì í¸ì¶ ìë: "+i,"Warning");return}delete m[i];c({id:i,result:e})},delayReturn:function(e){if(typeof e==="boolean"){t=e===true}return t},completed:function(){return r}}};var l=function(t,r,n){return window.setTimeout(function(){if(g[t]){var e='"'+n+'" íììì ('+r+"ms) ";(1,g[t].error)("timeout_error",e);delete g[t];delete C[t]}},r)};var u=function(e,t,r){if(typeof h.gotMessageObserver==="function"){try{h.gotMessageObserver(e,r)}catch(c){v("gotMessageObserver() ì¤ë¥: "+c.toString())}}if(r.id&&t){if(p[t]){var n=y(r.id,e,r.callbacks?r.callbacks:[]);m[r.id]={};try{if(r.callbacks&&w(r.callbacks)&&r.callbacks.length>0){for(var i=0;i<r.callbacks.length;i++){var a=r.callbacks[i];var o=r.params;var s=a.split("/");for(var l=0;l<s.length-1;l++){var u=s[l];if(typeof o[u]!=="object"){o[u]={}}o=o[u]}o[s[s.length-1]]=function(){var t=a;return function(e){return n.invoke(t,e)}}()}}var f=p[t](n,r.params);if(!n.delayReturn()&&!n.completed()){n.complete(f)}}catch(t){var c="runtime_error";var d=null;if(typeof t==="string"){d=t}else if(typeof t==="object"){if(t&&w(t)&&t.length==2){c=t[0];d=t[1]}else if(typeof t.error==="string"){c=t.error;if(!t.message){d=""}else if(typeof t.message==="string"){d=t.message}else{t=t.message}}}if(d===null){try{d=JSON.stringify(t);if(typeof d=="undefined"){d=t.toString()}}catch(e){d=t.toString()}}n.error(c,d)}}}else if(r.id&&r.callback){if(!g[r.id]||!g[r.id].callbacks||!g[r.id].callbacks[r.callback]){v("ì í¨íì§ ìë ì½ë°±, id:"+r.id+" ("+r.callback+")")}else{g[r.id].callbacks[r.callback](r.params)}}else if(r.id){if(!g[r.id]){v("ì í¨íì§ ìë ìëµ: "+r.id)}else{if(r.error){(1,g[r.id].error)(r.error,r.message)}else{if(r.result!==undefined){(1,g[r.id].success)(r.result)}else{(1,g[r.id].success)()}}delete g[r.id];delete C[r.id]}}else if(t){if(p[t]){p[t]({origin:e},r.params)}}};s(h.window,h.origin,typeof h.scope==="string"?h.scope:"",u);var f=function(e){if(typeof h.scope==="string"&&h.scope.length)e=[h.scope,e].join("::");return e};var c=function(e,t){if(!e){$l.eventLog("$channel.postMessage","null ë©ìì§ë¡ postMessage í¸ì¶","Error");return}var r=n?"post ":"queue ";v(r+" message: "+JSON.stringify(e));if(!t&&!n){i.push(e)}else{if(typeof h.postMessageObserver==="function"){try{h.postMessageObserver(h.origin,e)}catch(e){v("postMessageObserver() íì¸ íì: "+e.toString())}}h.window.postMessage(JSON.stringify(e),h.origin)}};var a=function(e,t){v("ready message received");if(n){$l.eventLog("$channel.onReady","ready ë©ìì§ íì¸ íì","Warning");return}if(t==="T"){r+="-R"}else{r+="-L"}o.unbind("__ready");n=true;v("ready message accepted");if(t==="T"){o.notify({method:"__ready",params:"A"})}while(i.length){c(i.pop())}if(typeof h.onReady==="function"){h.onReady(o)}};var o={unbind:function(e){if(p[e]){if(!delete p[e]){$l.eventLog("$channel.unbind","registrationMappingMethods ì­ì  íì¸ íì: "+e,"Warning");return}return true}return false},bind:function(e,t){if(!e||typeof e!=="string"){$l.eventLog("$channel.bind","method ë§¤ê°ë³ì íì¸ íì","Warning");return}if(!t||typeof t!=="function"){$l.eventLog("$channel.bind","callback ë§¤ê°ë³ì íì¸ íì","Warning");return}if(p[e]){$l.eventLog("$channel.bind",e+" method ì¤ë³µ íì¸ íì","Warning");return}p[e]=t;return this},call:function(e){if(!e){$l.eventLog("$channel.call","ë§¤ê°ë³ì íì¸ íì","Warning");return}if(!e.method||typeof e.method!=="string"){$l.eventLog("$channel.call","method ë§¤ê°ë³ì íì¸ íì","Warning");return}if(!e.success||typeof e.success!=="function"){$l.eventLog("$channel.call","callback ë§¤ê°ë³ì íì¸ íì","Warning");return}var i={};var a=[];var o=[];var s=function(e,t){if(o.indexOf(t)>=0){$l.eventLog("$channel.pruneFunctions","recursive params ë°ì´í° ìì","Warning");return}o.push(t);if(typeof t==="object"){for(var r in t){if(!t.hasOwnProperty(r)){continue}var n=e+(e.length?"/":"")+r;if(typeof t[r]==="function"){i[n]=t[r];a.push(n);delete t[r]}else if(typeof t[r]==="object"){s(n,t[r])}}}};s("",e.params);var t={id:d,method:f(e.method),params:e.params};if(a.length){t.callbacks=a}if(e.timeout){l(d,e.timeout,f(e.method))}g[d]={callbacks:i,error:e.error,success:e.success};C[d]=u;d++;c(t)},notify:function(e){if(!e){throw"missing arguments to notify function";$l.eventLog("$channel.notify","notify params ë°ì´í° ìì","Warning");return}if(!e.method||typeof e.method!=="string"){$l.eventLog("$channel.notify","method ë§¤ê°ë³ì íì¸ íì","Warning");return}c({method:f(e.method),params:e.params})},destroy:function(){b(h.window,h.origin,typeof h.scope==="string"?h.scope:"");if(window.removeEventListener){window.removeEventListener("message",u,false)}else if(window.detachEvent){window.detachEvent("onmessage",u)}n=false;p={};m={};g={};h.origin=null;i=[];r="";v("ì±ë ì­ì ")}};o.bind("__ready",a);setTimeout(function(){c({method:f("__ready"),params:"T"},true)},0);return o}}}()}})(syn);(function(context){"use strict";var $webform=$webform||new syn.module;var document=null;if(isNodejs==true){}else{$webform.context=context;$webform.document=context.document;document=context.document}$webform.extend({version:"1.0",localeID:"ko-KR",isPageLoad:false,transactionLoaderID:null,pageReadyTimeout:6e4,eventAddReady:isNodejs==true?null:new CustomEvent("addready"),eventRemoveReady:isNodejs==true?null:new CustomEvent("removeready"),mappingModule:true,moduleReadyIntervalID:null,remainingReadyIntervalID:null,remainingReadyCount:0,defaultControlOptions:{value:"",text:"",dataType:"string",bindingID:"",resourceKey:"",localeID:"ko-KR",required:false,tooltip:""},initializeFormScript:function(e){if(syn.$l.get("moduleScript")){$w.extend({pageScript:$l.get("moduleScript").value})}var t=context[syn.$w.pageScript]||new syn.module;if(e){t.extend(e);t.store={};context[syn.$w.pageScript]=t;context["$this"]=t;for(var r in syn.uicontrols){t[r]=syn.uicontrols[r]}}else{$l.eventLog("$w.initializeFormScript","íë©´ ì´ê¸°í ì¤ë¥, module ê°ì²´ê° ìì","Information")}},setStorage:function(e,t,r,n){if(r==undefined||r==null){r=false}if(isNodejs==true){if(r==true){localStorage.setItem(e,JSON.stringify(t))}else{if(n==undefined||n==null){n=12e5}var i=new Date;var a={value:t,expiry:i.getTime()+n,ttl:n};localStorage.setItem(e,JSON.stringify(a))}}else{if(r==true){localStorage.setItem(e,JSON.stringify(t))}else{sessionStorage.setItem(e,JSON.stringify(t))}}return this},getStorage:function(e,t){var r=null;var n=null;if(t==undefined||t==null){t=false}if(isNodejs==true){if(t==true){n=localStorage.getItem(e)}else{var i=localStorage.getItem(e);if(!i){return null}var a=JSON.parse(i);var o=new Date;if(o.getTime()>a.expiry){localStorage.removeItem(e);return null}r=a.value;var s=a.ttl;var o=new Date;var a={value:r,expiry:o.getTime()+s,ttl:s};localStorage.setItem(e,JSON.stringify(a))}}else{if(t==true){r=JSON.parse(localStorage.getItem(e))}else{r=JSON.parse(sessionStorage.getItem(e))}}return r},removeStorage:function(e,t){if(t==undefined||t==null){t=false}if(isNodejs==true){localStorage.removeItem(e)}else{if(t==true){localStorage.removeItem(e)}else{sessionStorage.removeItem(e)}}},storageLength:function(e){var t=0;if(e==undefined||e==null){e=false}if(isNodejs==true){t=localStorage.length}else{if(e==true){t=localStorage.length}else{t=sessionStorage.length}}return t},storageKey:function(e,t){var r=null;if(t==undefined||t==null){t=false}if(isNodejs==true){r=localStorage.key(e)}else{if(t==true){r=localStorage.key(e)}else{r=sessionStorage.key(e)}}return r},createBlob:function(t,r){try{return new Blob([t],{type:r})}catch(e){var n=globalThis.BlobBuilder||globalThis.WebKitBlobBuilder||globalThis.MozBlobBuilder||globalThis.MSBlobBuilder;var i=new n;i.append(t.buffer||t);return i.getBlob(r)}},dataUriToBlob:function(e){var t=null;try{var r=$c.base64Decode(e.split(",")[1]);var n=e.split(",")[0].split(":")[1].split(";")[0];var i=new ArrayBuffer(r.length);var a=new Uint8Array(i);for(var o=0;o<r.length;o++){a[o]=r.charCodeAt(o)}t=new Blob([i],{type:n})}catch(e){$l.eventLog("$w.dataUriToBlob",e,"Warning")}return t},dataUriToText:function(e){var t=null;try{t={value:$c.base64Decode(e.split(",")[1]),mime:e.split(",")[0].split(":")[1].split(";")[0]}}catch(e){$l.eventLog("$w.dataUriToText",e,"Warning")}return t},innerHTML:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;var r=e.cloneNode(false);r.innerHTML=t;e.parentNode.replaceChild(r,e)},innerText:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;var r=e.cloneNode(false);r.innerText=t;e.parentNode.replaceChild(r,e)},activeControl:function(){var e=null;var t=event||context.event;if(globalThis.$this){if(t){e=t&&t.target||t.srcElement||$this.context.focusControl||document.activeElement}else{e=$this.context.focusControl||document.activeElement}}return e},hasAutoFocus:function(){var e=document.createElement("input");return"autofocus"in e},createTouchEvent:function(e,t){var r=document.createEvent("MouseEvents");r.initMouseEvent(e,t.bubbles,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget);return r},contentLoaded:function(){$l.addEvent(document,"addready",function(){$w.remainingReadyCount++});$l.addEvent(document,"removeready",function(){$w.remainingReadyCount--});for(var name in syn.$l.eventMap){$l.addEvent(document.body,name,function(e){var t=$l.eventMap;var r=$w.createTouchEvent(t[e.type],e);e.target.dispatchEvent(r);var n=e.target["on"+t[e.type]];if(typeof n==="function"){n(e)}})}if(syn.$l.get("moduleScript")){$w.extend({pageScript:$l.get("moduleScript").value})}else{var pathname=location.pathname;if(pathname.split("/").length>0){var filename=pathname.split("/")[location.pathname.split("/").length-1];$w.extend({pageScript:"$"+(filename.indexOf(".")>-1?filename.substring(0,filename.indexOf(".")):filename)})}var input=document.createElement("input");input.id="moduleScript";input.type="text";input.style.display="none";input.value=$w.pageScript;document.body.appendChild(input);if(document.forms){for(var i=0;i<document.forms.length;i++){$l.addEvent(document.forms[i],"submit",function(e){var t=false;var r=e.target||e.srcElement;if($this&&$this.hook.frameEvent){t=$this.hook.frameEvent("beforeSubmit",{el:r,evt:e});if($object.isNullOrUndefined(t)==true||$string.toBoolean(t)==false){t=false}}if(t==false){e.returnValue=false;e.cancel=true;if(e.preventDefault){e.preventDefault()}if(e.stopPropagation){e.stopPropagation()}return false}})}}}var pageLoad=function(){if($object.isNullOrUndefined(syn.$w.SSO)==true){$w.SSO=$w.getSSOInfo()||{TokenID:"",UserID:"",UserName:"",BusinessTel:"",BusinessEMail:"",DepartmentID:"",DepartmentName:"",PositionID:"",PositionName:"",CompanyNo:"",CompanyName:"",Roles:[]}}var b=context[syn.$w.pageScript];if(b&&b.pageLoad){b.pageLoad()}if(context.domainPageLoad){domainPageLoad()}setTimeout(function(){if(b&&b.synControls&&($object.isNullOrUndefined(b.tabOrderControls)==true||b.tabOrderControls.length==0)){var e=[];var t=document.body.outerHTML.match(/<(qaf_).+?>/gi);if(t){var r=t.length;for(var n=0;n<r;n++){var i=t[n];var a=i.substring(1,i.indexOf(" ")).toUpperCase();e.push(a)}}e=$array.distinct(e);var o=document.querySelectorAll("input,select,textarea,button"+(e.length>0?","+e.join(","):""));var s=[];var l=o.length;for(var u=0;u<l;u++){var f=o[u];if(f&&f.style&&f.style.display=="none"||f.type=="hidden"){if(f.id&&f.tagName.toUpperCase()=="SELECT"&&(f.getAttribute("syn-datafield")!=null||f.getAttribute("syn-datafield")!=undefined)){s.push(f)}else{continue}}else{if(f.id&&f.id.includes("btn_qafeditor_")==false&&f.id.includes("chk_qafgrid_")==false&&f.id.includes("_hidden")==false){s.push(f)}else if(f.id&&f.tagName.toUpperCase()=="SELECT"&&(f.getAttribute("syn-datafield")!=null||f.getAttribute("syn-datafield")!=undefined)){s.push(f)}else if(f.id&&f.tagName.includes("QAF_")==true){s.push(f)}}}var c=[];var n=0;l=s.length;for(var u=0;u<l;u++){var f=s[u];if(f.id&&f.id.includes("btn_qafeditor_")==false&&f.id.includes("chk_qafgrid_")==false&&f.id.includes("_hidden")==false){var d=f.id;var h=$d.offset(f);var v=f.getAttribute("baseID");if(v){d=v}var p=b.synControls.find(function(e){return e.id==d});if(p){if(p.type=="datepicker"){h=$d.offset(f.parentElement)}else if(p.type=="colorpicker"){h=$d.offset(f.parentElement.parentElement)}c.push({elID:f.id,tagName:f.tagName,formID:p.formDataFieldID,type:p.type,top:h.top,left:h.left})}}else if(f.id&&f.tagName.toUpperCase()=="SELECT"&&(f.getAttribute("syn-datafield")!=null||f.getAttribute("syn-datafield")!=undefined)){var h=null;if(f.getAttribute("multiple")===false){var g=b.$select.getControl(f.id);if(g){h=$d.offset(g.picker.select)}}else{var g=b.$multiselect.getControl(f.id);if(g){h=$d.offset(g.picker.select)}}if(h){var p=b.synControls.find(function(e){return e.id==f.id});if(p){c.push({elID:f.id,tagName:f.tagName,formID:p.formDataFieldID,type:p.type,top:h.top,left:h.left})}}}else if(f.id&&f.tagName.includes("QAF_")==true){var d=f.id.replace("_hidden","");var h=null;if(f.tagName=="QAF_DATEPICKER"){}else if(f.tagName=="QAF_COLORPICKER"){}if(h){var p=b.synControls.find(function(e){return e.id==d});if(p){c.push({elID:d,tagName:f.tagName,formID:p.formDataFieldID,type:p.type,top:h.top,left:h.left})}}}n=n+1}b.focusControl=null;b.tabOrderFocusID=null;b.tabOrderControls=c;if(b&&b.frameEvent){b.frameEvent("tabOrderControls",b.tabOrderControls)}if(b.tabOrderControls.length>0){if(b.config){if($string.isNullOrEmpty(b.context.tapOrderFlow)==true){b.context.tapOrderFlow="html"}if(b.context.tapOrderFlow=="tdlr"){b.tabOrderControls.sort(function(e,t){if(e.top===t.top){return e.left-t.left}return e.top>t.top?1:-1})}else if(b.context.tapOrderFlow=="lrtd"){b.tabOrderControls.sort(function(e,t){if(e.left===t.left){return e.top-t.top}return e.left>t.left?1:-1})}}else{b.tabOrderControls.sort(function(e,t){if(e.top===t.top){return e.left-t.left}return e.top>t.top?1:-1})}}var m=$l.querySelector("[autofocus]");if(m&&m.id&&m.tagName){var a=m.tagName.toUpperCase();var y="input,select,textarea,button".toUpperCase().split(",");if(y.indexOf(a)>-1){b.focusControl=m;b.tabOrderFocusID=m.id;setTimeout(function(){m.focus()})}else if(a.indexOf("qaf_")>-1){}}}})};var pageFormInit=function(){var mod=context[syn.$w.pageScript];if(mod&&mod["pageFormInit"]){mod["pageFormInit"]()}var qafControlList=[];var synControls=document.querySelectorAll("[syn-datafield],[syn-options],[syn-events]");for(var i=0;i<synControls.length;i++){var qafControl=synControls[i];if(qafControl.tagName){var tagName=qafControl.tagName.toUpperCase();var dataField=qafControl.getAttribute("syn-datafield");var elementID=qafControl.getAttribute("id");var formDataField=qafControl.closest("form")?qafControl.closest("form").getAttribute("syn-datafield"):"";var controlType="";var controlOptions=qafControl.getAttribute("syn-options")||null;if(controlOptions!=null){try{controlOptions=eval("("+controlOptions+")")}catch(e){$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options íì¸ íì '.format(elementID)+e.message,"Warning")}}else{controlOptions={}}var controlModule=null;if(tagName.indexOf("QAF_")>-1){var moduleName=tagName.substring(4).toLowerCase();controlModule=syn.uicontrols["$"+moduleName];controlType=moduleName}else{switch(tagName){case"BUTTON":controlModule=syn.uicontrols.$button;controlType="button";break;case"INPUT":controlType=qafControl.getAttribute("type").toLowerCase();switch(controlType){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":controlModule=syn.uicontrols.$textbox;break;case"submit":case"reset":case"button":controlModule=syn.uicontrols.$button;break;case"radio":controlModule=syn.uicontrols.$radio;break;case"checkbox":controlModule=syn.uicontrols.$checkbox;break}break;case"TEXTAREA":controlModule=syn.uicontrols.$textarea;controlType="textarea";break;case"SELECT":if(qafControl.getAttribute("multiple")==null){controlModule=syn.uicontrols.$select;controlType="select"}else{controlModule=syn.uicontrols.$multiselect;controlType="multiselect"}break;default:break}}$l.addEvent(qafControl.id,"focus",function(e){$this.context.focusControl=e.target||e.currentTarget||e.srcElement;if($this.context.focusControl){$this.context.tabOrderFocusID=$this.context.focusControl.id}else{$this.context.tabOrderFocusID=null}});if(controlModule){if(controlModule.addModuleList){controlModule.addModuleList(qafControl,qafControlList,controlOptions,controlType)}controlModule.controlLoad(elementID,controlOptions)}else{if(elementID){qafControlList.push({id:elementID,formDataFieldID:formDataField,field:dataField,module:null,type:controlType?controlType:qafControl.tagName.toLowerCase()})}if($this&&$this.controlLoad){$this.controlLoad(elementID,controlOptions)}}}}var qafEventControls=document.querySelectorAll("[syn-events]");for(var i=0;i<qafEventControls.length;i++){var qafControl=qafEventControls[i];var events=null;try{events=eval("("+qafControl.getAttribute("syn-events")+")")}catch(e){$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-events íì¸ íì '.format(qafControl.id)+e.message,"Warning")}if(events){var length=events.length;for(var j=0;j<length;j++){var event=events[j];var func=$this[qafControl.id+"_"+event];if(func){$l.addEvent(qafControl.id,event,func)}}}}var qafOptionControls=document.querySelectorAll("[syn-options]");for(var i=0;i<qafOptionControls.length;i++){var qafControl=qafOptionControls[i];var elID=qafControl.id.replace("_hidden","");var options=null;try{var el=$l.get(qafControl.id+"_hidden")||$l.get(qafControl.id);options=eval("("+el.getAttribute("syn-options")+")")}catch(e){$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options íì¸ íì'.format(qafControl.id)+e.message,"Warning")}if(options&&options.transactConfig&&options.transactConfig.triggerEvent){if(syn.$reflection.isString(options.transactConfig.triggerEvent)==true){$l.addEvent(elID,options.transactConfig.triggerEvent,function(transactConfig){var el=this;if(transactConfig&&$object.isNullOrUndefined(transactConfig.triggerEvent)==true){var options=eval("("+el.getAttribute("syn-options")+")");transactConfig=options.transactConfig}else{var options=eval("("+el.getAttribute("syn-options")+")");if(options&&options.transactConfig){transactConfig=options.transactConfig}}if(transactConfig){$w.transactionAction(transactConfig)}})}else if(syn.$reflection.isArray(options.transactConfig.triggerEvent)==true){var triggerFunction=function(transactConfig){var el=this;if(transactConfig&&$object.isNullOrUndefined(transactConfig.triggerEvent)==true){var options=eval("("+el.getAttribute("syn-options")+")");transactConfig=options.transactConfig}else{var options=eval("("+el.getAttribute("syn-options")+")");if(options&&options.transactConfig){transactConfig=options.transactConfig}}if(transactConfig){$w.transactionAction(transactConfig)}};for(var key in options.transactConfig.triggerEvent){var eventName=options.transactConfig.triggerEvent[key];$l.addEvent(elID,eventName,triggerFunction)}}}if(options&&options.triggerConfig&&options.triggerConfig.triggerEvent){if(syn.$reflection.isString(options.triggerConfig.triggerEvent)==true){$l.addEvent(elID,options.triggerConfig.triggerEvent,function(triggerConfig){var el=this;if(triggerConfig&&$object.isNullOrUndefined(triggerConfig.triggerEvent)==true){var options=eval("("+el.getAttribute("syn-options")+")");triggerConfig=options.triggerConfig}else{var options=eval("("+el.getAttribute("syn-options")+")");if(options&&options.triggerConfig){triggerConfig=options.triggerConfig}}if(triggerConfig){$w.triggerAction(triggerConfig)}})}else if(syn.$reflection.isArray(options.triggerConfig.triggerEvent)==true){var triggerFunction=function(triggerConfig){var el=this;if(triggerConfig&&$object.isNullOrUndefined(triggerConfig.triggerEvent)==true){var options=eval("("+el.getAttribute("syn-options")+")");triggerConfig=options.triggerConfig}else{var options=eval("("+el.getAttribute("syn-options")+")");if(options&&options.triggerConfig){triggerConfig=options.triggerConfig}}if(triggerConfig){$w.triggerAction(triggerConfig)}};for(var key in options.triggerConfig.triggerEvent){var eventName=options.triggerConfig.triggerEvent[key];$l.addEvent(elID,eventName,triggerFunction)}}}}var elem=document.createElement("input");elem.type="hidden";elem.id="qafControlList";elem.textContent=JSON.stringify(qafControlList);document.body.appendChild(elem);if(document.body.style.display=="none"){document.body.style.display="block"}if(mod){mod.context.synControls=qafControlList}else{context.synControls=qafControlList}$w.remainingReadyIntervalID=setInterval(function(){if(syn.$w.remainingReadyCount==0&&$w.getSSOInfo){clearInterval(syn.$w.remainingReadyIntervalID);$w.remainingReadyIntervalID=null;pageLoad();$w.isPageLoad=true}},25);setTimeout(function(){if(syn.$w.remainingReadyIntervalID!=null){$w.remainingReadyCount=0}},$w.pageReadyTimeout)};if(syn.$w.mappingModule==true){$w.moduleReadyIntervalID=setInterval(function(){var e=context[syn.$w.pageScript];if(e&&e._pageInit==undefined&&context.domainLibraryLoad){clearInterval(syn.$w.moduleReadyIntervalID);$w.moduleReadyIntervalID=null;domainLibraryLoad();e._pageInit=true;if(syn.$w.AppInfo&&$w.AppInfo.config){var t=$r.getCookie("syn.iscache")=="true"?"":"?bust="+(new Date).getTime();var r=$w.pageScript.replace("$","")+".json";if(context.moduleJsonFile){r=context.moduleJsonFile}$w.loadJson(r+t,e,function(e,t){e.config=t},pageFormInit,true)}else{pageFormInit()}}},50);setTimeout(function(){if(syn.$w.moduleReadyIntervalID!=null){clearInterval(syn.$w.moduleReadyIntervalID);$w.moduleReadyIntervalID=null;$l.eventLog("$w.contentLoaded",'"{0}" ëª¨ë íì¸ íì'.format(syn.$w.pageScript),"Error")}},$w.pageReadyTimeout)}else{pageLoad();$w.isPageLoad=true}},addReadyCount:function(){if(syn.$w.eventAddReady&&$w.isPageLoad==false){document.dispatchEvent(syn.$w.eventAddReady)}},removeReadyCount:function(){if(syn.$w.eventRemoveReady&&$w.isPageLoad==false){document.dispatchEvent(syn.$w.eventRemoveReady)}},createSelection:function(e,t,r){e=$ref.isString(e)==true?$l.get(e):e;if(e.createTextRange){var n=r-t;var i=e.createTextRange();i.collapse(true);i.moveStart("character",t);i.moveEnd("character",n);i.select();n=null;i=null}else if(e.setSelectionRange){e.setSelectionRange(t,r)}e.focus()},argumentsExtend:function(){var e={};for(var t in arguments){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e},loadJson:function(e,t,r,n,i,a){if(i==undefined||i==null){i=true}if(a==undefined||a==null){a=false}var o=new XMLHttpRequest;if(i===true){o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE){if(o.status===200){if(r){r(t,JSON.parse(o.responseText))}if(n){n()}}else{$l.eventLog("$w.loadJson","async url: "+e+", status: "+o.status.toString()+", responseText: "+o.responseText,"Error")}if(o.status!==200&&n&&a==true){n()}}};o.open("GET",e,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(o)==false){return}}o.send()}else{o.open("GET",e,false);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(o)==false){return}}o.send();if(o.status===200){if(r){r(t,JSON.parse(o.responseText))}if(n){n()}}else{$l.eventLog("$w.loadJson","sync url: "+e+", status: "+o.status.toString()+", responseText: "+o.responseText,"Error")}if(n&&a==true){n()}}},getTriggerOptions:function(e){e=$ref.isString(e)==true?$l.get(e):e;return JSON.parse(e.getAttribute("triggerOptions"))},triggerAction:function(e){if($this){var t=true;var r={args:[],options:{}};e.params=$w.argumentsExtend(r,e.params);if($this.beforeTrigger){t=$this.beforeTrigger(e.triggerID,e.action,e.params)}if($object.isNullOrUndefined(t)==true||t==true){var n=$l.get(e.triggerID);var i=null;var a=null;if(e.action.indexOf("$")>-1){a=$this;var o=e.action.split(".");if(o.length>0){for(var s=0;s<o.length;s++){var l=o[s];if(a){a=a[l]}else{a=context[l]}}}else{a=context[e.action]}}else{a=$this[e.triggerID+"_"+e.action]}if(a){n.setAttribute("triggerOptions",JSON.stringify(e.params.options));if(e.action.indexOf("$")>-1){$array.addAt(e.params.args,0,e.triggerID)}i=a.apply(n,e.params.args);if($this.afterTrigger){$this.afterTrigger(null,e.action,{elID:e.triggerID,result:i})}}else{if($this.afterTrigger){$this.afterTrigger("{0} trigger íì¸ íì".format(e.action),e.action,null)}}}else{if($this.afterTrigger){$this.afterTrigger("beforeTrigger continue false",e.action,null)}}}},transactionAction:function(transactConfig){if(transactConfig&&$this&&$this.config){if($object.isNullOrUndefined(transactConfig.noProgress)==true){transactConfig.noProgress=false}if(syn.$w.progressMessage&&transactConfig.noProgress==false){$w.progressMessage($res.progress)}try{if($object.isNullOrUndefined($this.config.transactions)==true){$this.config.transactions=[]}var isContinue=true;if($this.beforeTransaction){isContinue=$this.beforeTransaction(transactConfig)}if($object.isNullOrUndefined(isContinue)==true||isContinue==true){var transactions=$this.config.transactions;for(var i=0;i<transactions.length;i++){if(transactConfig.functionID==transactions[i].FunctionID){transactions.splice(i,1);break}}var qafControlList=$this.context.synControls;var transactionObject={};transactionObject.FunctionID=transactConfig.functionID;transactionObject.transactionResult=$object.isNullOrUndefined(transactConfig.transactionResult)==true?true:transactConfig.transactionResult===true;transactionObject.Inputs=[];transactionObject.Outputs=[];if(transactConfig.inputs){var inputs=transactConfig.inputs;var inputsLength=inputs.length;for(var i=0;i<inputsLength;i++){var inputConfig=inputs[i];var input={RequestType:inputConfig.type,DataFieldID:inputConfig.dataFieldID?inputConfig.dataFieldID:document.forms.length>0?document.forms[0].getAttribute("syn-datafield"):"",Items:{}};var qafControlConfigs=null;if(inputConfig.type=="Row"){var qafControlConfigs=qafControlList.filter(function(e){return e.formDataFieldID==input.DataFieldID&&["grid","chart","chartjs"].indexOf(e.type)==-1});if(qafControlConfigs&&qafControlConfigs.length>0){for(var k=0;k<qafControlConfigs.length;k++){var qafControlConfig=qafControlConfigs[k];var el=$l.get(qafControlConfig.id+"_hidden")||$l.get(qafControlConfig.id);var options=el.getAttribute("syn-options");if(options==null){continue}var qafOptions=null;try{qafOptions=JSON.parse(options)}catch(e){qafOptions=eval("("+options+")")}if(qafOptions==null||qafControlConfig.field==""){continue}var isBelong=false;if(qafOptions.belongID){if(syn.$reflection.isString(qafOptions.belongID)==true){isBelong=transactConfig.functionID==qafOptions.belongID}else if(syn.$reflection.isArray(qafOptions.belongID)==true){isBelong=qafOptions.belongID.indexOf(transactConfig.functionID)>-1}}if(isBelong==true){input.Items[qafControlConfig.field]={FieldID:qafControlConfig.field,DataType:qafOptions.dataType}}}}else{var qafControlConfigs=qafControlList.filter(function(e){return e.field==input.DataFieldID&&e.type=="grid"});if(qafControlConfigs&&qafControlConfigs.length>0){for(var k=0;k<qafControlConfigs.length;k++){var qafControlConfig=qafControlConfigs[k];var el=$l.get(qafControlConfig.id+"_hidden")||$l.get(qafControlConfig.id);var qafOptions=JSON.parse(el.getAttribute("syn-options"));if(qafOptions==null){continue}for(var l=0;l<qafOptions.columns.length;l++){var column=qafOptions.columns[l];var dataType="string";switch(column.columnType){case"checkbox":dataType="bool";break;case"numeric":dataType="int";break}var isBelong=false;if(column.data=="Flag"){isBelong=true}else if(column.belongID){if(syn.$reflection.isString(column.belongID)==true){isBelong=transactConfig.functionID==column.belongID}else if(syn.$reflection.isArray(column.belongID)==true){isBelong=column.belongID.indexOf(transactConfig.functionID)>-1}}if(isBelong==true){input.Items[column.data]={FieldID:column.data,DataType:dataType}}}}}else{if($this.$data&&$this.$data.storeList.length>0){for(var k=0;k<$this.$data.storeList.length;k++){var store=$this.$data.storeList[k];if(store.storeType=="Form"&&store.dataSourceID==input.DataFieldID){for(var l=0;l<store.columns.length;l++){var column=store.columns[l];var isBelong=false;if(syn.$reflection.isString(column.belongID)==true){isBelong=transactConfig.functionID==column.belongID}else if(syn.$reflection.isArray(column.belongID)==true){isBelong=column.belongID.indexOf(transactConfig.functionID)>-1}if(isBelong==true){input.Items[column.data]={FieldID:column.data,DataType:column.dataType}}}break}}}}}}else if(inputConfig.type=="List"){var qafControlConfigs=qafControlList.filter(function(e){return e.field==input.DataFieldID&&e.type=="grid"});if(qafControlConfigs&&qafControlConfigs.length==1){var qafControlConfig=qafControlConfigs[0];var el=$l.get(qafControlConfig.id+"_hidden")||$l.get(qafControlConfig.id);var qafOptions=JSON.parse(el.getAttribute("syn-options"));if(qafOptions==null){continue}for(var k=0;k<qafOptions.columns.length;k++){var column=qafOptions.columns[k];var dataType="string";switch(column.columnType){case"checkbox":dataType="bool";break;case"numeric":dataType="int";break}var isBelong=false;if(column.data=="Flag"){isBelong=true}else if(column.belongID){if(syn.$reflection.isString(column.belongID)==true){isBelong=transactConfig.functionID==column.belongID}else if(syn.$reflection.isArray(column.belongID)==true){isBelong=column.belongID.indexOf(transactConfig.functionID)>-1}}if(isBelong==true){input.Items[column.data]={FieldID:column.data,DataType:dataType}}}}else{var isMapping=false;if($this.$data&&$this.$data.storeList.length>0){for(var k=0;k<$this.$data.storeList.length;k++){var store=$this.$data.storeList[k];if(store.storeType=="Grid"&&store.dataSourceID==input.DataFieldID){isMapping=true;for(var l=0;l<store.columns.length;l++){var column=store.columns[l];var isBelong=false;if(syn.$reflection.isString(column.belongID)==true){isBelong=transactConfig.functionID==column.belongID}else if(syn.$reflection.isArray(column.belongID)==true){isBelong=column.belongID.indexOf(transactConfig.functionID)>-1}if(isBelong==true){input.Items[column.data]={FieldID:column.data,DataType:column.dataType}}}break}}}if(isMapping==false){$l.eventLog("$w.transactionAction","{0} ì»¬ë¼ ID ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì".format(input.DataFieldID),"Warning")}}}transactionObject.Inputs.push(input)}}if(transactConfig.outputs){var outputs=transactConfig.outputs;var outputsLength=outputs.length;var synControls=$this.context.synControls;for(var i=0;i<outputsLength;i++){var outputConfig=outputs[i];var output={ResponseType:outputConfig.type,DataFieldID:outputConfig.dataFieldID?outputConfig.dataFieldID:"",Items:{}};var qafControlConfigs=null;if(outputConfig.type=="Form"){var qafControlConfigs=qafControlList.filter(function(e){return e.formDataFieldID==output.DataFieldID&&["grid","chart","chartjs"].indexOf(e.type)==-1});if(qafControlConfigs&&qafControlConfigs.length>0){for(var k=0;k<qafControlConfigs.length;k++){var qafControlConfig=qafControlConfigs[k];var el=$l.get(qafControlConfig.id+"_hidden")||$l.get(qafControlConfig.id);var options=el.getAttribute("syn-options");if(options==null){continue}var qafOptions=null;try{qafOptions=JSON.parse(options)}catch(e){qafOptions=eval("("+options+")")}if(qafOptions==null||qafControlConfig.field==""){continue}output.Items[qafControlConfig.field]={FieldID:qafControlConfig.field,DataType:qafOptions.dataType};if(outputConfig.clear==true){if(synControls&&synControls.length==1){var bindingControlInfos=synControls.filter(function(e){return e.field==outputConfig.dataFieldID});if(bindingControlInfos.length==1){var controlInfo=bindingControlInfos[0];if(controlInfo.module==null){continue}var controlID=controlInfo.id;var controlField=controlInfo.field;var controlModule=null;var currings=controlInfo.module.split(".");if(currings.length>0){for(var l=0;l<currings.length;l++){var curring=currings[l];if(controlModule){controlModule=controlModule[curring]}else{controlModule=context[curring]}}}else{controlModule=context[controlInfo.module]}if(controlModule.clear){controlModule.clear(controlID)}}else{$l.eventLog("$w.transactionAction","{0} DataFieldID ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì".format(outputConfig.dataFieldID),"Warning")}}}}}else{if($this.$data&&$this.$data.storeList.length>0){for(var k=0;k<$this.$data.storeList.length;k++){var store=$this.$data.storeList[k];if(store.storeType=="Form"&&store.dataSourceID==output.DataFieldID){for(var l=0;l<store.columns.length;l++){var column=store.columns[l];output.Items[column.data]={FieldID:column.data,DataType:column.dataType}}break}}}}}else if(outputConfig.type=="Grid"){var qafControlConfigs=qafControlList.filter(function(e){return e.field==output.DataFieldID&&e.type=="grid"});if(qafControlConfigs&&qafControlConfigs.length==1){var qafControlConfig=qafControlConfigs[0];var el=$l.get(qafControlConfig.id+"_hidden")||$l.get(qafControlConfig.id);var qafOptions=JSON.parse(el.getAttribute("syn-options"));if(qafOptions==null){continue}for(var k=0;k<qafOptions.columns.length;k++){var column=qafOptions.columns[k];var dataType="string";switch(column.type){case"checkbox":dataType="bool";break;case"numeric":dataType="int";break}output.Items[column.data]={FieldID:column.data,DataType:dataType}}if(outputConfig.clear==true){if(synControls&&synControls.length>0){var bindingControlInfos=synControls.filter(function(e){return e.field==output.DataFieldID});var controlInfo=bindingControlInfos[0];var controlModule=null;var currings=controlInfo.module.split(".");if(currings.length>0){for(var i=0;i<currings.length;i++){var curring=currings[i];if(controlModule){controlModule=controlModule[curring]}else{controlModule=context[curring]}}}else{controlModule=context[controlInfo.module]}if(controlModule.clear){controlModule.clear(controlInfo.id)}}}}else{qafControlConfigs=qafControlList.filter(function(e){return e.field==output.DataFieldID&&["chart","chartjs"].indexOf(e.type)>-1});if(qafControlConfigs&&qafControlConfigs.length==1){var qafControlConfig=qafControlConfigs[0];var el=$l.get(qafControlConfig.id+"_hidden")||$l.get(qafControlConfig.id);var qafOptions=JSON.parse(el.getAttribute("syn-options"));if(qafOptions==null){continue}for(var k=0;k<qafOptions.series.length;k++){var column=qafOptions.series[k];output.Items[column.columnID]={FieldID:column.columnID,DataType:column.dataType?column.dataType:"string"}}if(outputConfig.clear==true){if(synControls&&synControls.length==1){var bindingControlInfos=synControls.filter(function(e){return e.field==outputConfig.dataFieldID});if(bindingControlInfos.length==1){var controlInfo=bindingControlInfos[0];if(controlInfo.module==null){continue}var controlID=controlInfo.id;var controlField=controlInfo.field;var controlModule=null;var currings=controlInfo.module.split(".");if(currings.length>0){for(var l=0;l<currings.length;l++){var curring=currings[l];if(controlModule){controlModule=controlModule[curring]}else{controlModule=context[curring]}}}else{controlModule=context[controlInfo.module]}if(controlModule.clear){controlModule.clear(controlID)}}}}}else{var isMapping=false;if($this.$data&&$this.$data.storeList.length>0){for(var k=0;k<$this.$data.storeList.length;k++){var store=$this.$data.storeList[k];if(store.storeType=="Grid"&&store.dataSourceID==output.DataFieldID){isMapping=true;for(var l=0;l<store.columns.length;l++){var column=store.columns[l];output.Items[column.data]={FieldID:column.data,DataType:column.dataType}}break}}}if(isMapping==false){$l.eventLog("$w.transactionAction","{0} DataFieldID ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì".format(output.DataFieldID),"Warning")}}}}transactionObject.Outputs.push(output)}}$this.config.transactions.push(transactionObject);$w.transaction(transactConfig.functionID,function(t,r){var n=null;if(t&&t.errorText.length>0){n=t.errorText[0];$l.eventLog("$w.transaction.callback",n,"Error")}var e=null;if(transactConfig.callback&&$ref.isFunction(transactConfig.callback)==true){e=transactConfig.callback(n,t,r)}if(e==null||e===true){if($this.afterTransaction){$this.afterTransaction(null,transactConfig.functionID,t,r)}}else if(e===false){if($this.afterTransaction){$this.afterTransaction("callbackResult continue false",transactConfig.functionID,null,null)}}if(transactConfig.callback&&$ref.isArray(transactConfig.callback)==true){setTimeout(function(){var e={error:n,responseObject:t,addtionalData:r};$l.trigger(transactConfig.callback[0],transactConfig.callback[1],e)})}},transactConfig.triggerMessage)}else{if(syn.$w.closeProgressMessage){$w.closeProgressMessage()}if($this.afterTransaction){$this.afterTransaction("beforeTransaction continue false",transactConfig.functionID,null,null)}}}catch(e){$l.eventLog("$w.transactionAction",e,"Error");if(syn.$w.closeProgressMessage){$w.closeProgressMessage()}}}},transactionDirect:function(e,r){e.transactionResult=$object.isNullOrUndefined(e.transactionResult)==true?true:e.transactionResult===true;var t=$w.transactionObject(e.FunctionID,"Json");t.ProgramID=e.ProgramID;t.BusinessID=e.BusinessID;t.SystemID=e.SystemID;t.TransactionID=e.TransactionID;t.DataTransactionInterface=e.DataTransactionInterface||"Row|Form";t.transactionResult=$object.isNullOrUndefined(e.transactionResult)==true?true:e.transactionResult===true;if(isNodejs==true){t.ScreenID=e.ScreenID||e.TransactionID}else{t.ScreenID=$w.pageScript.replace("$","")}if(e.InputLists&&e.InputLists.length>0){for(var n in e.InputLists){t.Inputs.push(e.InputLists[n])}t.InputsItemCount.push(e.InputLists.length)}else{t.Inputs.push(e.InputObjects);t.InputsItemCount.push(1)}$w.executeTransaction(e,t,function(e,t){if(r){r(e,t)}})},transaction:function(R,I,e){try{if(syn.$w.domainTransactionLoaderStart){$w.domainTransactionLoaderStart()}if(e){if(syn.$w.progressMessage){$w.progressMessage(e)}}var O={errorText:[],outputStat:[]};if($this&&$this.config&&$this.config.transactions){var t=$this.config.transactions.filter(function(e){return e.FunctionID==R});if(t.length==1){var A=t[0];var r=$w.transactionObject(A.FunctionID,"Json");r.ProgramID=$this.config.programID;r.BusinessID=$this.config.businessID;r.SystemID=$this.config.systemID;r.TransactionID=$this.config.transactionID;r.ScreenID=$w.pageScript.replace("$","");var n=context[syn.$w.pageScript]["synControls"];var i=A.Inputs.length;for(var a=0;a<i;a++){var o=A.Inputs[a];var s=[];if(o.RequestType=="Row"){var l=n.filter(function(e){return e.field==o.DataFieldID});if(l.length==1){var u=l[0];if(["grid","chart"].indexOf(u.type)>-1){var f=o.DataFieldID;var c="";if(n&&n.length>0){l=n.filter(function(e){return e.field==f});if(l.length==1){var u=l[0];var d=null;var h=u.module.split(".");if(h.length>0){for(var v=0;v<h.length;v++){var p=h[v];if(d){d=d[p]}else{d=context[p]}}}else{d=context[u.module]}var g=$l.get(u.id+"_hidden")||$l.get(u.id);var m=JSON.parse(g.getAttribute("syn-options"));for(var y=0;y<m.columns.length;y++){var b=m.columns[y];if(b.validators&&$validation.transactionValidate){b.controlText=m.controlText||"";var w=$validation.transactionValidate(d,u,b,o.RequestType);if(w==false){if($this.afterTransaction){$this.afterTransaction("validators continue false",R,b,null)}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}return false}}}s=d.getValue(u.id,"Row",o.Items)[0]}else{$l.eventLog("$w.transaction",'"{0}" Row List Input Mapping íì¸ íì'.format(f),"Warning")}}}else{for(var C in o.Items){var S=o.Items[C];var f=C;var E=S.FieldID;var k=S.DataType;var T={prop:E,val:""};var c="";if(n.length>0){l=n.filter(function(e){return e.field==f&&e.formDataFieldID==o.DataFieldID});if(l.length==1){var u=l[0];var d=null;var h=u.module.split(".");if(h.length>0){for(var v=0;v<h.length;v++){var p=h[v];if(d){d=d[p]}else{d=context[p]}}}else{d=context[u.module]}var g=$l.get(u.id+"_hidden")||$l.get(u.id);var m=JSON.parse(g.getAttribute("syn-options"));if(m.validators&&$validation.transactionValidate){var w=$validation.transactionValidate(d,u,m,o.RequestType);if(w==false){if($this.afterTransaction){$this.afterTransaction("validators continue false",R,m,null)}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}return false}}c=d.getValue(u.id,S);if(!c&&k=="int"){c=0}}else{$l.eventLog("$w.transaction",'"{0}" Row Control Input Mapping íì¸ íì'.format(f),"Warning")}}T.val=c;s.push(T)}}}else{if($this.$data&&$this.$data.storeList.length>0){for(var C in o.Items){var _=false;var S=o.Items[C];var f=C;var E=S.FieldID;var k=S.DataType;var T={prop:E,val:""};var c="";for(var y=0;y<$this.$data.storeList.length;y++){var x=$this.$data.storeList[y];if(x.storeType=="Form"&&x.dataSourceID==o.DataFieldID){_=true;l=x.columns.filter(function(e){return e.data==f});if(l.length==1){var u=l[0];c=$this.store[x.dataSourceID][u.data];if(!c&&k=="int"){c=0}if($object.isNullOrUndefined(c)==true){c=""}}else{$l.eventLog("$w.transaction",'"{0}" Row Input Mapping íì¸ íì'.format(f),"Warning")}break}}if(_==true){T.val=c;s.push(T)}else{$l.eventLog("$w.transaction","{0} Row ì»¨í¸ë¡¤ ID ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì".format(o.DataFieldID),"Warning")}}}}r.Inputs.push(s);r.InputsItemCount.push(1)}else if(o.RequestType=="List"){var f=o.DataFieldID;var c="";if(n&&n.length>0){var l=n.filter(function(e){return e.field==f});if(l.length==1){var u=l[0];var d=null;var h=u.module.split(".");if(h.length>0){for(var v=0;v<h.length;v++){var p=h[v];if(d){d=d[p]}else{d=context[p]}}}else{d=context[u.module]}var g=$l.get(u.id+"_hidden")||$l.get(u.id);var m=JSON.parse(g.getAttribute("syn-options"));for(var y=0;y<m.columns.length;y++){var b=m.columns[y];b.controlText=m.controlText||"";if(b.validators&&$validation.transactionValidate){var w=$validation.transactionValidate(d,u,b,o.RequestType);if(w==false){if($this.afterTransaction){$this.afterTransaction("validators continue false",R,b,null)}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}return false}}}s=d.getValue(u.id,"List",o.Items)}else{var _=false;if($this.$data&&$this.$data.storeList.length>0){for(var y=0;y<$this.$data.storeList.length;y++){var x=$this.$data.storeList[y];if(x.storeType=="Grid"&&x.dataSourceID==f){_=true;var D=$this.$data.bindingList.find(function(e){return e.dataSourceID==x.dataSourceID&&e.controlType=="grid"});if(D){s=$this.store[x.dataSourceID][D.dataFieldID]}else{var c=[];var N=$this.store[x.dataSourceID];var M=N.length;for(var v=0;v<M;v++){var L=N[v];var P=[];for(var C in L){var T={prop:C,val:L[C]};P.push(T)}c.push(P)}s=c}break}}}if(_==false){$l.eventLog("$w.transaction",'"{0}" List Input Mapping íì¸ íì'.format(f),"Warning")}}}for(var C in s){r.Inputs.push(s[C])}r.InputsItemCount.push(s.length)}}$w.executeTransaction($this.config,r,function(e,t){var r="";var n=false;for(var i=0;i<A.Outputs.length;i++){if(A.Outputs[i].ResponseType=="Dynamic"){n=true;break}}if(n==true){O.outputStat.push({FieldID:"Dynamic",Count:1,DynamicData:e})}else{if(e.length==A.Outputs.length){var a=context[syn.$w.pageScript]["synControls"];var o=A.Outputs.length;for(var s=0;s<o;s++){var l=A.Outputs[s];var u=e[s];var f=u["ID"];var c=u["Value"];if($this.outputDataBinding){$this.outputDataBinding(R,f,c)}if(l.ResponseType=="Form"){if($object.isNullOrUndefined(c)==true||c.length){O.outputStat.push({FieldID:f,Count:0})}else{O.outputStat.push({FieldID:f,Count:1});for(var d in l.Items){var h=l.Items[d];var v=d;var p=h.FieldID;var g=c[p];if(g!=undefined&&a&&a.length>0){var m=a.filter(function(e){return e.field==v&&e.formDataFieldID==l.DataFieldID});if(m.length==1){var y=m[0];var b=null;var w=y.module.split(".");if(w.length>0){for(var i=0;i<w.length;i++){var C=w[i];if(b){b=b[C]}else{b=context[C]}}}else{b=context[y.module]}b.setValue(y.id,g,h)}else{var S=false;if($this.$data&&$this.$data.storeList.length>0){for(var E=0;E<$this.$data.storeList.length;E++){var k=$this.$data.storeList[E];if($object.isNullOrUndefined($this.store[k.dataSourceID])==true){$this.store[k.dataSourceID]={}}if(k.storeType=="Form"&&k.dataSourceID==l.DataFieldID){S=true;m=k.columns.filter(function(e){return e.data==v});if(m.length==1){$this.store[k.dataSourceID][v]=g}break}}}if(S==false){r='"{0}" Form Output Mapping íì¸ íì'.format(v);O.errorText.push(r);$l.eventLog("$w.transaction",r,"Error")}}}}}}else if(l.ResponseType=="Grid"){if(c.length&&c.length>0){O.outputStat.push({FieldID:f,Count:c.length});var v=l.DataFieldID;if(a&&a.length>0){var m=a.filter(function(e){return e.field==v});if(m.length==1){var y=m[0];var b=null;var w=y.module.split(".");if(w.length>0){for(var i=0;i<w.length;i++){var C=w[i];if(b){b=b[C]}else{b=context[C]}}}else{b=context[y.module]}b.setValue(y.id,c,l.Items)}else{var S=false;if($this.$data&&$this.$data.storeList.length>0){for(var E=0;E<$this.$data.storeList.length;E++){var k=$this.$data.storeList[E];if($object.isNullOrUndefined($this.store[k.dataSourceID])==true){$this.store[k.dataSourceID]=[]}if(k.storeType=="Grid"&&k.dataSourceID==l.DataFieldID){S=true;var T=$this.$data.bindingList.filter(function(e){return e.dataSourceID==k.dataSourceID&&e.controlType=="grid"});var _=c.length;for(var i=0;i<_;i++){c[i].Flag="R"}if(T.length>0){for(var x=0;x<T.length;x++){var D=T[x];$this.store[k.dataSourceID][D.dataFieldID]=c}}else{$this.store[k.dataSourceID]=c}break}}}if(S==false){r='"{0}" Grid Output Mapping íì¸ íì'.format(v);O.errorText.push(r);$l.eventLog("$w.transaction",r,"Error")}}}}else{O.outputStat.push({FieldID:f,Count:0})}}else if(l.ResponseType=="Chart"){if(c.length&&c.length>0){O.outputStat.push({FieldID:f,Count:c.length});var v=l.DataFieldID;if(a&&a.length>0){var m=a.filter(function(e){return e.field==v});if(m.length==1){var y=m[0];var b=null;var w=y.module.split(".");if(w.length>0){for(var i=0;i<w.length;i++){var C=w[i];if(b){b=b[C]}else{b=context[C]}}}else{b=context[y.module]}b.setValue(y.id,c,l.Items)}else{r='"{0}" Chart Output Mapping íì¸ íì'.format(v);O.errorText.push(r);$l.eventLog("$w.transaction",r,"Error")}}}else{O.outputStat.push({FieldID:f,Count:0})}}}}else{r='"{0}" ê¸°ë¥ì ê±°ë ìëµ ì ìì ë°ì´í° ê°¯ìê° ë¤ë¦ëë¤'.format(A.FunctionID);O.errorText.push(r);$l.eventLog("$w.transaction",r,"Error")}}if(I){I(O,t)}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}})}else{errorText='"{0}" ê±°ë ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì'.format(R);O.errorText.push(errorText);$l.eventLog("$w.transaction",errorText,"Error");if(I){I(O)}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}}}else{errorText="íë©´ ë§¤í ì ì ë°ì´í°ê° ììµëë¤";O.errorText.push(errorText);$l.eventLog("$w.transaction",errorText,"Error");if(I){I(O)}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}}}catch(e){$l.eventLog("$w.transaction",e,"Error");if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}}},scrollToTop:function(){var e=document.documentElement.scrollTop||document.body.scrollTop;if(e>0){context.requestAnimationFrame(syn.$w.scrollToTop);context.scrollTo(0,e-e/8)}},setFavicon:function(e){var t=document.querySelector('link[rel="icon"]');if(t){t.href=e}else{var r=document.createElement("link");r.rel="icon";r.href=e;document.head.appendChild(r)}},fileDownload:function(e,t){var r="";if(t){r=t}else{var n=e.toString().match(/.*\/(.+?)\./);if(n&&n.length>1){r=n[1]}}var i=document.createElement("a");i.setAttribute("href",e);i.setAttribute("download",r);document.body.appendChild(i);i.click();document.body.removeChild(i)},sleep:function(t,e){if(e){setTimeout(e,t)}else if(globalThis.Promise){return new Promise(function(e){return setTimeout(e,t)})}else{$l.eventLog("$w.sleep","ì§ìíì§ ìë ê¸°ë¥. ë§¤ê°ë³ì íì¸ íì","Error")}}});if(syn&&!syn.Config){syn.Config={}}context.$webform=context.$w=syn.$w=context.$webform||$webform;if(isNodejs==true){var fs=require("fs");var path=require("path");if(process.env.QAF_CONFIG){syn.Config=JSON.parse(process.env.QAF_CONFIG)}else{var qafConfigPath=path.join(path.dirname(require.main.filename),"syn.config.json");if(fs.existsSync(qafConfigPath)==true){syn.Config=JSON.parse(fs.readFileSync(qafConfigPath,"utf8"));process.env.QAF_LogMinimumLevel=syn.Config.LogMinimumLevel;process.env.QAF_FileLogBasePath=syn.Config.FileLogBasePath;process.env.QAF_LocalStoragePath=syn.Config.LocalStoragePath}}if(syn.Config&&$string.isNullOrEmpty(syn.Config.DataSourceFilePath)==true){syn.Config.DataSourceFilePath=path.join(process.cwd(),"BusinessContract/Database/DataSource.xml")}delete syn.$w.isPageLoad;delete syn.$w.pageReadyTimeout;delete syn.$w.eventAddReady;delete syn.$w.eventRemoveReady;delete syn.$w.moduleReadyIntervalID;delete syn.$w.remainingReadyIntervalID;delete syn.$w.remainingReadyCount;delete syn.$w.defaultControlOptions;delete syn.$w.initializeFormScript;delete syn.$w.innerHTML;delete syn.$w.innerText;delete syn.$w.activeControl;delete syn.$w.hasAutoFocus;delete syn.$w.createTouchEvent;delete syn.$w.contentLoaded;delete syn.$w.addReadyCount;delete syn.$w.removeReadyCount;delete syn.$w.createSelection;delete syn.$w.getTriggerOptions;delete syn.$w.triggerAction;delete syn.$w.transactionAction;delete syn.$w.transaction;delete syn.$w.scrollToTop;delete syn.$w.setFavicon;delete syn.$w.fileDownload;delete syn.$w.sleep}else{if(context.CefSharp){syn.bindObjects=syn.bindObjects||[];if(context.contextCreatedData){syn.Config=context.contextCreatedData.Config;var contextData=$webform.argumentsExtend(context.contextCreatedData,{});delete contextData.Config;syn.ContextData=contextData}if(CefSharp.IsObjectCached("bound")==true){var object={};object.BindID="bound";object.Success=true;object.TypeName=bound.toString();syn.bindObjects.push(object)}}else{var pathname=location.pathname;if(pathname.split("/").length>0){var filename=pathname.split("/")[location.pathname.split("/").length-1];$webform.extend({pageScript:"$"+(filename.indexOf(".")>-1?filename.substring(0,filename.indexOf(".")):filename)})}$l.addEvent(context,"load",function(){var e=context[syn.$w.pageScript];if(e&&e.windowLoad){e.windowLoad()}});var urlArgs=$r.getCookie("syn.iscache")=="true"?"":"?bust="+(new Date).getTime();var isAsyncLoad=!$b.isIE;globalThis.isLoadConfig=false;if(window.qafConfig){syn.Config=$w.argumentsExtend(qafConfig,syn.Config);window.qafConfig=undefined;globalThis.isLoadConfig=true;$webform.contentLoaded()}else{$webform.loadJson("/"+(window.qafConfigName||"syn.config.json")+urlArgs,null,function(e,t){syn.Config=$w.argumentsExtend(t,syn.Config);globalThis.isLoadConfig=true;$webform.contentLoaded()},null,isAsyncLoad)}}}})(globalThis);(function(E){"use strict";if(!E){E=new syn.module}var a=null;if(isNodejs==true){}else{a=window.document}E.extend({method:"POST",setServiceObjectHeader:function(e){return this},setServiceClientHeader:function(e){var t=true;e.setRequestHeader("User-CertKey","UUNOLkV4cGVydEFwcA==");try{return t}finally{t=null}return this},xmlParser:function(e){var t=null;if(!globalThis.DOMParser){var r=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];for(var n=0;n<r.length;n++){t=new ActiveXObject(r[n]);t.async=false;t.setProperty("SelectionLanguage","XPath");if(t.loadXML(e)==true){break}}return t}else{t=new globalThis.DOMParser;return t.parseFromString(e,"text/xml")}},xmlHttp:function(){var e=null;if(!globalThis.XMLHttpRequest){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(var r=0;r<t.length;r++){e=new ActiveXObject(t[r]);if(e){break}}return e}else{e=new globalThis.XMLHttpRequest;return e}},loadScript:function(e,t){var r;var n;if(a.getElementsByTagName("head")){r=a.getElementsByTagName("head")[0]}else{a.documentElement.insertBefore(a.createElement("head"),a.documentElement.firstChild);r=a.getElementsByTagName("head")[0]}n=t||"id_"+$l.random();var i=a.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("src",e+(e.indexOf("?")>-1?"&":"?")+"noCache="+(new Date).getTime());i.setAttribute("id",n);r.insertBefore(i,r.firstChild);return this},loadStyle:function(e,t){var r;var n;if(a.getElementsByTagName("head")){r=a.getElementsByTagName("head")[0]}else{a.documentElement.insertBefore(a.createElement("head"),a.documentElement.firstChild);r=a.getElementsByTagName("head")[0]}n=t||"id_"+$l.random();var i=a.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",e+(e.indexOf("?")>-1?"&":"?")+"noCache="+(new Date).getTime());i.setAttribute("id",n);r.appendChild(i);return this},loadText:function(e,t){var r=$w.xmlHttp();r.open("get",e+(e.indexOf("?")>-1?"&":"?")+"noCache="+(new Date).getTime(),true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(r)==false){return}}r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==200){if(r.status==0){$l.eventLog("$w.loadText","X-Requested transfort error","Fatal")}else{$l.eventLog("$w.loadText","response status - {0}".format(r.statusText)+r.responseText,"Error")}return}if(t){t(r.responseText)}}};r.send()},fetchScript:function(e,t){if(t){var r=new syn.$w.xmlHttp;r.open("GET",e,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(r)==false){return}}r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==200){if(r.status==0){$l.eventLog("$w.fetchScript","X-Requested transfort error","Fatal")}else{$l.eventLog("$w.fetchScript","response status - {0}".format(r.statusText)+r.responseText,"Error")}return}if(t){var e=new Function("return (function() {var module={};"+r.responseText+"; return module.exports;})();").call();t(e)}}};r.send()}else if(globalThis.Promise){var n={};if(syn.$w.getFetchClientOptions){n=$w.getFetchClientOptions(n)}return new Promise(function(t,r){fetch(e).then(function(e){return e.text()}).then(function(e){return new Function("return (function() {var module={};"+e+"; return module.exports;})();").call()}).then(function(e){return t(e)}).catch(function(e){return r(e)})})}else{$l.eventLog("$w.fetchScript","ì§ìíì§ ìë ê¸°ë¥. ë§¤ê°ë³ì íì¸ íì","Error")}},fetchJSON:function(e,t){if(t){var r=new syn.$w.xmlHttp;r.open("GET",e,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(r)==false){return}}r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==200){if(r.status==0){$l.eventLog("$w.fetchJSON","X-Requested transfort error","Fatal")}else{$l.eventLog("$w.fetchJSON","response status - {0}".format(r.statusText)+r.responseText,"Error")}return}if(t){t(JSON.parse(r.responseText))}}};r.send()}else if(globalThis.Promise){var n={};if(syn.$w.getFetchClientOptions){n=$w.getFetchClientOptions(n)}return new Promise(function(t,r){fetch(e,n).then(function(e){return e.json()}).then(function(e){return t(e)}).catch(function(e){return r(e)})})}else{$l.eventLog("$w.fetchJSON","ì§ìíì§ ìë ê¸°ë¥. ë§¤ê°ë³ì íì¸ íì","Error")}},serviceObject:function(e,t){var r="json";if(t){r=t}var n={};n.RequestID=$l.guid();n.ReturnType=r;n.ServiceID=e;n.NameValues=[];if(this.setServiceObjectHeader){this.setServiceObjectHeader(n)}r=null;return n},transactionObject:function(e,t){var r="Json";if(t){r=t}var n={};n.ProgramID="";n.BusinessID="";n.SystemID="";n.TransactionID="";n.DataTransactionInterface=null;n.transactionResult=true;n.FunctionID=e;n.ScreenID="";n.RequestID=$l.guid();n.ReturnType=r;n.ResultAlias=[];n.InputsItemCount=[];n.Inputs=[];if(this.setServiceObjectHeader){this.setServiceObjectHeader(n)}r=null;return n},basicServiceClient:function(e,t,i,r,n){if(!t){alert("ìë¹ì¤ í¸ì¶ì íìí jsonObjectê° êµ¬ì±ëì§ ìììµëë¤.");return}var a=JSON.stringify(t);var o=this.xmlHttp();o.open(E.method,e,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(o)==false){return}}o.setRequestHeader("Accept-Language",this.localeID);o.setRequestHeader("Accept-Charset","UTF-8");if(n!==undefined){o.setRequestHeader("User-Token",n)}if(r!==undefined&&o.async){o.async=r;if(o.async==false){o.setRequestHeader("X-Requested-With","QAF ServiceClient");o.setRequestHeader("Content-Type","application/json");o.send(a);return o}}o.onreadystatechange=function(){if(o.readyState===4){if(o.status!==200){if(o.status==0){$l.eventLog("$w.serviceClient","X-Requested transfort error","Fatal")}else{$l.eventLog("$w.serviceClient","response status - {0}".format(o.statusText)+o.responseText,"Error")}return}var t="text";var r="";var n="";try{var e=JSON.parse(o.responseText);t=e.ReturnType;n=e.FunctionID;if(t==="error"){r=e.ExceptionText}}catch(e){t="error";r=e.toString();if(n.length==0){n="Unknown FunctionID"}}if(t.indexOf("text")>-1||t.indexOf("json")>-1){if(i){i(o.responseText)}}else if(t.indexOf("xml")>-1){if(i){i(o.responseXML)}}else{alert("FunctionID : "+n+"\n"+r)}}};o.setRequestHeader("X-Requested-With","QAF ServiceClient");o.setRequestHeader("Content-Type","application/json");o.send(a)},serviceClient:function(i,e,a,t,r){if(!e){alert("ìë¹ì¤ í¸ì¶ì íìí ê±°ëì ë³´ê° êµ¬ì±ëì§ ìììµëë¤.");return}var n=JSON.stringify(e);var o=this.xmlHttp();o.open(E.method,i,true);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(o)==false){return}}o.setRequestHeader("Accept-Language",this.localeID);if(this.setServiceClientHeader){if(this.setServiceClientHeader(o)==false){return}}if(r!==undefined){o.setRequestHeader("User-Token",r)}if(t!==undefined&&o.async){o.async=t;if(o.async==false){o.setRequestHeader("X-Requested-With","QAF ServiceClient");o.setRequestHeader("Content-Type","application/json");o.send(n);return o}}o.onreadystatechange=function(){if(o.readyState===4){if(o.status!==200){if(o.status==0){$l.eventLog("$w.serviceClient","X-Requested transfort error","Fatal")}else{$l.eventLog("$w.serviceClient","response status - {0}".format(o.statusText)+o.responseText,"Error")}return}try{if(syn.$w.clientTag&&$w.clientTag=="ROQKFWKTLFGODZNJFL"&&$w.serviceClientInterceptor){if(syn.$w.serviceClientInterceptor(i,o)===false){return}}}catch(e){return}var t="text";var r="";var n="";try{var e=JSON.parse(o.responseText);t=e.ReturnType;n=e.FunctionID;if(t==="error"){r=e.ExceptionText}}catch(e){t="error";r=e.toString();if(n.length==0){n="Unknown FunctionID"}}if(t==="warning"){if($this.serviceClientException){$this.serviceClientException(i,e,o)}else{alert("FunctionID : "+n+"\n"+e.Result)}}else if(t.indexOf("text")>-1||t.indexOf("json")>-1){if(a){a(e)}}else if(t.indexOf("xml")>-1){if(a){a(o.responseXML)}}else{if(syn.$w.serviceClientException){if(syn.$w.serviceClientException(i,e,o)===false){alert("FunctionID : "+n+"\n"+r)}}else{alert("FunctionID : "+n+"\n"+r)}if($this.serviceClientException){$this.serviceClientException(i,e,o)}}}};o.setRequestHeader("X-Requested-With","QAF ServiceClient");o.setRequestHeader("Content-Type","application/json");o.send(n)},executeBindMethod:function(e,t,r,n){syn.bindObjects=syn.bindObjects||[];var i=null;var a="";var o=false;var s=syn.bindObjects.length;for(var l=0;l<s;l++){var u=syn.bindObjects[l];if(u.BindID==e){o=u.Success;a=u.Message;break}}if(o==true){var u=globalThis[e];if(u[t]){var f=u[t];i=f(r,n)}else{$l.eventLog("syn.bindObjects.{0} ë©ìë ì ë³´ ìì","{1}".format(e,t),"Error")}}else{$l.eventLog("syn.bindObjects ê°ì²´ ì ë³´ ìì","{0} - {1}".format(e,a),"Error")}return i},dynamicTypeObject:new function(){this.DataSet="0";this.Json="1";this.Scalar="2";this.NonQuery="3";this.SQLText="4";this.SchemeOnly="5";this.CodeHelp="6";this.Xml="7";this.DynamicJson="8"},executeTransaction:function(g,m,y,e,t){if(!g||!m){if(isNodejs==false){alert("ìë¹ì¤ í¸ì¶ì íìí ê±°ë ì ë³´ê° êµ¬ì±ëì§ ìììµëë¤")}$l.eventLog("$w.executeTransaction","ìë¹ì¤ í¸ì¶ì íìí ê±°ë ì ë³´ íì¸ íì","Error");return}var r=null;if(isNodejs==true){var n=$w.getStorage("apiServices",false);if(n){r=n[syn.Config.SystemID+syn.Config.DomainServerType];if($object.isNullOrUndefined(n.BearerToken)==true&&globalThis.bearerToken){n.BearerToken=globalThis.bearerToken;$w.setStorage("apiServices",n,false)}}else{if(syn.Config.DomainAPIServer!=null){r=syn.Config.DomainAPIServer;n={};if(t||globalThis.bearerToken){n.BearerToken=t||globalThis.bearerToken}n[syn.Config.SystemID+syn.Config.DomainServerType]=r;$w.setStorage("apiServices",n,false);$l.eventLog("$w.executeTransaction","apiService íì¸ íì systemApi: {0}".format(JSON.stringify(r)),"Debug")}else{$l.eventLog("$w.executeTransaction","ìë¹ì¤ í¸ì¶ì íìí BP ì ë³´ê° êµ¬ì±ëì§ íì¸ íì","Error")}}}else{if(location.href.indexOf("syn://")>-1){m.SystemID=g.SystemID;m.TransactionID=g.TransactionID;m.ScreenID=g.ScreenID;var i=$w.executeBindMethod("bound","executeTransaction",m,function(e){if(syn.$w.clientTag&&$w.serviceClientInterceptor){if(syn.$w.serviceClientInterceptor(syn.$w.clientTag,S)===false){return}}try{var t=JSON.parse(e);if(t.Acknowledge==1){var r=[];var n=t.MDO;if(t.Result.DataSet!=null&&t.Result.DataSet.length>0){var i=t.DAT.RES_TX_MAP_ID;var a=t.Result.DataSet;var o=a.length;for(var s=0;s<o;s++){var l=a[s];r.push({ID:l.ID,Value:l.Value})}}if(y){var u={};if(n.ADI_MSG){for(var s=0;s<n.ADI_MSG.length;s++){var f=n.ADI_MSG[s];if(u[f.ADI_MSG_CD]){if(isNaN(parseInt(u[f.ADI_MSG_CD]))==false){u[f.ADI_MSG_CD]=parseInt(u[f.ADI_MSG_CD])+parseInt(f.ADI_MSG_TXT)}else{$l.eventLog("$w.executeTransaction.addtionalData",'"{0}" ì¶ê° ë°ì´í° ì¤ë³µ íì¸ íì'.format(f.ADI_MSG_CD),"Warning")}}else{u[f.ADI_MSG_CD]=f.ADI_MSG_TXT}}}y(r,u)}}else{var c=t.ExceptionText;var d='ê±°ëID: "{0}"<br/>'.format(t.CorrelationID)+"ê±°ë: {0}, ê¸°ë¥: {1} ìíì¤ ìì¸ê° ë°ìíììµëë¤".format(m.TransactionID,m.FunctionID);if(syn.$w.serviceClientException){$w.serviceClientException("ìì²­ì¤ë¥",d,c)}$l.eventLog("$w.executeTransaction",c,"Error");if($this&&$this.hook.frameEvent){$this.hook.frameEvent("transactionException",{transactionID:m.TransactionID,functionID:m.FunctionID,errorText:c,errorMessage:d})}}}catch(e){var d='ê±°ëID: "{0}"<br/>'.format(t.CorrelationID)+"ê±°ë: {0}, ê¸°ë¥: {1} ìíì¤ ì¤ë¥ê° ë°ìíììµëë¤".format(m.TransactionID,m.FunctionID);if(syn.$w.serviceClientException){$w.serviceClientException("ì¤ë¥",d,e.stack)}$l.eventLog("$w.executeTransaction",e,"Error");if($this&&$this.hook.frameEvent){$this.hook.frameEvent("transactionError",{transactionID:m.TransactionID,functionID:m.FunctionID,errorText:e.message,errorMessage:d})}}});return}}var n=$w.getStorage("apiServices",false);if(n){r=n[syn.Config.SystemID+syn.Config.DomainServerType]}if(r==null){$l.eventLog("$w.executeTransaction","apiService íì¸ íì","Fatal")}else{if(r.ExceptionText){$l.eventLog("$w.executeTransaction","apiService íì¸ íì SystemID: {0}, ServerType: {1}, Message: {2}".format(g.SystemID,syn.Config.DomainServerType,r.ExceptionText),"Fatal");return}var a="";if(r.Port&&r.Port!=""){a="{0}://{1}:{2}{3}".format(r.Protocol,r.IP,r.Port,r.Path)}else{a="{0}://{1}{2}".format(r.Protocol,r.IP,r.Path)}var o=$date.toString(new Date,"f");var s="".concat(o,g.ProgramID,g.BusinessID,m.TransactionID,m.FunctionID,syn.Config.Transaction.RunningEnvironment,$l.random(3)).toUpperCase();var l="";if(r.RequestID){l=r.RequestID}else{l=s}var b={AccessTokenID:n.BearerToken,Action:"REPLY",ClientTag:"".concat(syn.Config.Transaction.SystemID,"|",syn.Config.Transaction.MachineName,"|",syn.Config.Program.ProgramVersion),LoadOptions:[],RequestID:s,Version:syn.Config.Transaction.ProtocolVersion,SH:{CLNT_IPAD:r.ClientIP,CLNT_MAC:"",ENV_INF_DSCD:syn.Config.Transaction.RunningEnvironment,FST_TLM_REQ_DTM:r.CreateDateTime||o,FST_TMS_SYS_CD:syn.Config.Transaction.SystemID,GLBL_ID:l,GLBL_ID_PRG_SRNO:1,INTF_ID:syn.Config.Transaction.SystemInterfaceID,LANG_DSCD:syn.Config.Program.LanguageID,MD_KDCD:syn.Config.Transaction.MachineTypeID,TLM_ENCY_DSCD:syn.Config.Transaction.DataEncryptionYN,TLM_REQ_DTM:o},TH:{BIZ_ID:g.BusinessID,EXNK_DSCD:isNodejs==true?"AP":navigator.connection==null?"":navigator.connection.effectiveType,FUNC_CD:m.FunctionID,DAT_FMT:syn.Config.Transaction.DataFormat,LQTY_DAT_PRC_DIS:"N",MSK_NTGT_TRN_YN:"Y",OPR_NO:isNodejs==true?"AP":$w.SSO?$w.SSO.UserID:"",PGM_ID:g.ProgramID,RLPE_SQCN:1,SMLT_TRN_DSCD:"N",TRM_BRNO:syn.Config.Program.BranchCode,TRN_CD:m.TransactionID,TRN_SCRN_CD:m.ScreenID,CRYPTO_DSCD:syn.Config.Transaction.CryptoCode||"P",CRYPTO_KEY:syn.Config.Transaction.CryptoCKey||""},TCI:[],DTI:null,DAT:{REQ_INPUT:[],REQ_INPUTDATA:[],REQ_INPUT_CNT:[],REQ_TX_MAP_ID:""}};if(g.Transactions){var u=g.Transactions.filter(function(e){return e.FunctionID==m.FunctionID});if(u.length==1){var f=u[0];var c=f.Inputs.map(function(e){return e.RequestType}).join(",");var d=f.Outputs.map(function(e){return e.ResponseType}).join(",");b.DTI="{0}|{1}".format(c,d)}}else if(m.DataTransactionInterface){b.DTI=m.DataTransactionInterface}if(b.TH.DAT_FMT=="J"||b.TH.DAT_FMT=="T"){}else{$l.eventLog("$w.executeTransaction","TH.DAT_FMT íì¸ íì: {0}".format(b.TH.DAT_FMT),"Error");throw new Error("TH.DAT_FMT íì¸ íì: {0}".format(b.TH.DAT_FMT))}b.DAT.REQ_INPUT_CNT=m.InputsItemCount;b.DAT.REQ_INPUT=[];b.DAT.REQ_INPUTDATA=[];var h=m.Inputs.length;for(var v=0;v<h;v++){var c=m.Inputs[v];var p=[];for(var w=0;w<c.length;w++){var C=c[w];p.push({REQ_FIELD_ID:C.prop,REQ_FIELD_DAT:C.val})}if(b.TH.CRYPTO_DSCD=="C"){if(b.TH.DAT_FMT=="J"){b.DAT.REQ_INPUTDATA.push(syn.$c.LZString.compressToBase64(JSON.stringify(p)))}else{b.DAT.REQ_INPUTDATA.push(syn.$c.LZString.compressToBase64($object.toCSV(p,{delimeter:"ï½",newline:"âµ"})))}}else{if(b.TH.DAT_FMT=="J"){b.DAT.REQ_INPUT.push(p)}else{b.DAT.REQ_INPUTDATA.push($object.toCSV(p,{delimeter:"ï½",newline:"âµ"}))}}}var S=$w.xmlHttp();S.open(E.method,a,true);S.setRequestHeader("Accept-Language",$w.localeID);S.setRequestHeader("Server-SystemID",g.SystemID);S.setRequestHeader("Server-BusinessID",g.BusinessID);if(syn.$w.setServiceClientHeader){if(syn.$w.setServiceClientHeader(S)==false){return}}if(e!==undefined&&S.async==true){S.async=e;if(S.async==false){S.setRequestHeader("X-Requested-With","QAF ServiceClient");S.setRequestHeader("Content-Type","qrame/json-transact");S.send(b);return S}}S.onreadystatechange=function(){if(S.readyState===4){if(S.status!==200){if(S.status==0){$l.eventLog("$w.executeTransaction","X-Requested transfort error","Fatal")}else{$l.eventLog("$w.executeTransaction","response status - {0}".format(S.statusText)+S.responseText,"Error")}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}return}if(syn.$w.clientTag&&$w.serviceClientInterceptor){if(syn.$w.serviceClientInterceptor(syn.$w.clientTag,S)===false){return}}try{var t=JSON.parse(S.responseText);if(m.transactionResult==true){if(t.Acknowledge==1){var e=[];var r=t.MDO;if(t.Result.DataSet!=null&&t.Result.DataSet.length>0){var n=t.DAT.RES_TX_MAP_ID;var i=t.Result.DataSet;var a=i.length;for(var o=0;o<a;o++){var s=i[o];if(t.TH.SMLT_TRN_DSCD==$w.dynamicTypeObject.CodeHelp){e.push({ID:s.ID,Value:s.Value});continue}if(t.TH.DAT_FMT=="J"){if(t.TH.CRYPTO_DSCD=="C"){e.push({ID:s.ID,Value:JSON.parse(syn.$c.LZString.decompressFromBase64(s.Value))})}else{e.push({ID:s.ID,Value:s.Value})}}else{if(g.Transactions){var l=g.Transactions.find(function(e){return e.FunctionID==m.FunctionID});if(l){var u=null;if($ref.isEmpty(s.Value)==false){u=t.TH.CRYPTO_DSCD=="C"?$c.LZString.decompressFromBase64(s.Value).split("ï¼¾"):s.Value.split("ï¼¾");var f=$string.toParameterObject(u[0]);u=$string.toJson(u[1],{delimeter:"ï½",newline:"âµ",meta:f});var c=l.Outputs[o];if(c.ResponseType=="Form"){u=u[0]}}e.push({ID:s.ID,Value:u})}}else{var u=t.TH.CRYPTO_DSCD=="C"?$c.LZString.decompressFromBase64(s.Value).split("ï¼¾"):s.Value.split("ï¼¾");var f=$string.toParameterObject(u[0]);u=$string.toJson(u[1],{delimeter:"ï½",newline:"âµ",meta:f});e.push({ID:s.ID,Value:u})}}}}if(y){var d={};if(r.ADI_MSG){for(var o=0;o<r.ADI_MSG.length;o++){var h=r.ADI_MSG[o];if(d[h.ADI_MSG_CD]){if(isNaN(parseInt(d[h.ADI_MSG_CD]))==false){d[h.ADI_MSG_CD]=parseInt(d[h.ADI_MSG_CD])+parseInt(h.ADI_MSG_TXT)}else{$l.eventLog("$w.executeTransaction.addtionalData",'"{0}" ì¶ê° ë°ì´í° ì¤ë³µ íì¸ íì'.format(h.ADI_MSG_CD))}}else{d[h.ADI_MSG_CD]=h.ADI_MSG_TXT}}}try{y(e,d)}catch(e){$l.eventLog("$w.executeTransaction callback",e,"Error")}}}else{var v=t.ExceptionText;var p='ê±°ëID: "{0}"<br/>'.format(t.CorrelationID)+"ê±°ë: {0}, ê¸°ë¥: {1} ìíì¤ ìì¸ê° ë°ìíììµëë¤".format(b.TH.TRN_CD,b.TH.FUNC_CD);if(syn.$w.serviceClientException){$w.serviceClientException("ìì²­ì¤ë¥",p,v)}$l.eventLog("$w.executeTransaction",v,"Warning");if(isNodejs==false){if($this&&$this.hook.frameEvent){$this.hook.frameEvent("transactionException",{transactionID:b.TH.TRN_CD,functionID:b.TH.FUNC_CD,errorText:v,errorMessage:p})}}else{if(y){try{y([],null)}catch(e){$l.eventLog("$w.executeTransaction callback",e,"Error")}}}}}else{if(y){if(t&&t.Acknowledge&&t.Acknowledge==1){try{var r=t.MDO;if(t.Result.DataSet!=null&&t.Result.DataSet.length>0){var n=t.DAT.RES_TX_MAP_ID;var i=t.Result.DataSet;var a=i.length;for(var o=0;o<a;o++){var s=i[o];if(t.TH.DAT_FMT=="J"){if(t.TH.CRYPTO_DSCD=="C"){s.Value=JSON.parse(syn.$c.LZString.decompressFromBase64(s.Value))}}else{s.Value=t.TH.CRYPTO_DSCD=="C"?$c.LZString.decompressFromBase64(s.Value):s.Value}}}}catch(e){$l.eventLog("$w.executeTransaction",e,"Error")}}try{y(t)}catch(e){$l.eventLog("$w.executeTransaction callback",e,"Error")}}}}catch(e){var p='ê±°ëID: "{0}"<br/>'.format(t.CorrelationID)+"ê±°ë: {0}, ê¸°ë¥: {1} ìíì¤ ì¤ë¥ê° ë°ìíììµëë¤".format(b.TH.TRN_CD,b.TH.FUNC_CD);if(syn.$w.serviceClientException){$w.serviceClientException("ì¤ë¥",p,e.stack)}$l.eventLog("$w.executeTransaction",e,"Error");if(isNodejs==false){if($this&&$this.hook.frameEvent){$this.hook.frameEvent("transactionError",{transactionID:b.TH.TRN_CD,functionID:b.TH.FUNC_CD,errorText:e.message,errorMessage:p})}}else{if(y){try{y([],null)}catch(e){$l.eventLog("$w.executeTransaction callback",e,"Error")}}}}if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}}};S.setRequestHeader("X-Requested-With","QAF ServiceClient");S.setRequestHeader("Content-Type","qrame/json-transact");S.timeout=syn.Config.TransactionTimeout;S.send(JSON.stringify(b))}}})})(syn.$webform||syn.$w);(function(e){"use strict";if(!e){e=new syn.module}var f=globalThis.document;e.extend({xmlFormData:null,jsonFormData:null,getUpdateData:function(e){var t={};t.pageUrl=$r.url();var r=[];if(e){r=$l.querySelectorAll(e+" *[bindingID]")}else{r=$l.querySelectorAll("input[type='text'], input[type='button'], input[type='checkbox'], input[type='hidden'], button, select, textarea")}var n=null;var i=null;for(var a=0;a<r.length;a++){n=r[a];i=n.getAttribute("bindingID");if(i){$w.updateValue(n,i)}}r=$l.querySelectorAll('input[type="radio"]');n=null;var o=[];var s="";for(var a=0;a<r.length;a++){n=r[a];i=n.getAttribute("bindingID");if(i){o.push(i)}}o=$array.distinct(o);for(var a=0;a<o.length;a++){s=o[a];if($radio){t[s]=$radio.getValue(s)}else{var l=f.getElementsByName(s);for(var u=0;u<l.length;u++){if(l[u].checked){t[s]=l[u].value;break}}}}return t},updateValue:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;switch(e.type.toLowerCase()){case"checkbox":result[t]=e.checked;break;case"text":result[t]=e.value;break;default:result[t]=e.value;break}return this},initializeForm:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;var r=null;var n=[];if(t){n=$l.querySelectorAll(t+" *[bindingID]")}else{n=$l.querySelectorAll("*[bindingID]")}for(var i=0;i<n.length;i++){r=n[i];$w.initializeValue(r)}if(e){e.focus()}return this},initializeValue:function(e){e=$ref.isString(e)==true?$l.get(e):e;switch(e.type.toLowerCase()){case"radio":e.checked=false;break;case"checkbox":e.checked=false;break;case"text":e.value="";break;default:e.value="";break}return this},formBinding:function(e,t){var r="";var n=null;for(var i in e){if(t){n=$l.querySelectorAll(t+" *[bindingID="+i+"]")}else{n=$l.querySelectorAll("*[bindingID="+i+"]")}if(n.length>0){r=e[i];if(n.length>1){for(var a=0;a<n.length;a++){$w.bindingValue(n[a],r)}}else{$w.bindingValue(n[0],r)}}}return this},bindingValue:function(e,t){e=$ref.isString(e)==true?$l.get(e):e;switch(e.type.toLowerCase()){case"checkbox":e.checked=t;break;case"radio":e.checked=t;break;case"text":e.value=t;break;case"select":e.value=t;break;default:e.value=t;break}return this}})})(globalThis.$webform);(function(e){if(!e){throw new Error("$res ë¦¬ìì¤ ê°ì²´ê° ììµëë¤.")}e.add("localeID","ko-KR");e.add("progress","ì§í ì¤ìëë¤.");e.add("appendTo","ì ê· ìë ¥ ìíìëë¤.");e.add("appendPre","íë©´ êµ¬ì± ì¤...");e.add("retrieve","ì ìì ì¼ë¡ ì¡°íëììµëë¤.");e.add("retrieveException","ë°ì´í°ë¥¼ ì¡°ííë ê³¼ì ìì ë¬¸ì ê° ë°ìíììµëë¤.");e.add("retrievePre","ë°ì´í° ì¡°í ì¤...");e.add("save","ì ìì ì¼ë¡ ì ì¥ëììµëë¤.");e.add("saveException","ë°ì´í°ë¥¼ ì ì¥íë ê³¼ì ìì ë¬¸ì ê° ë°ìíììµëë¤.");e.add("savePre","ì ì¥ ì¤...");e.add("update","ì ìì ì¼ë¡ ìì ëììµëë¤.");e.add("updateException","ë°ì´í°ë¥¼ ìì íë ê³¼ì ìì ë¬¸ì ê° ë°ìíììµëë¤.");e.add("updatePre","ìì  ì¤...");e.add("remove","ì ìì ì¼ë¡ ì­ì ëììµëë¤.");e.add("removeException","ë°ì´í°ë¥¼ ì­ì íë ê³¼ì ìì ë¬¸ì ê° ë°ìíììµëë¤.");e.add("removePre","ì­ì  ì¤...");e.add("copyAppend","ê¸°ì¡´ ë°ì´í°ë¥¼ ë³µì¬íì¬ ìë ¥ ìíë¡ ì ííìµëë¤.");e.add("userInfoNothing","ì¬ì©ì ì ë³´ì ë¬¸ì ê° ë°ìíìµëë¤.");e.add("isLogOut","ì ë§ë¡ ë¡ê·¸ìì íìê² ìµëê¹?");e.add("waiting","ì ìë§ ê¸°ë¤ë ¤ì£¼ì¸ì...");e.add("notElemnet","ì»¨í¸ë¡¤ì´ ë°ê²¬ëì§ ìììµëë¤. ì¿¼ë¦¬ë HTML ëìì¸ì ì´í´ë³´ì¸ì");e.add("dualElemnet",'"{0}"ì ìì´ëë íì¬ íì´ì§ìì ì¤ë³µë ì´ë¦ ëë ìì´ëì ì»¨í¸ë¡¤ë¡ ë°ê²¬ëììµëë¤.');e.add("requiredKeyData","íì ìë ¥ í­ëª© ì¤ë¥");e.add("requiredInsertData","ìë í­ëª©ì íì ìë ¥ í­ëª©ìëë¤.");e.add("errorMessage","ìë¬ê° ë°ìíìµëë¤.");e.add("serverErrorMessage","ìë²ìì ìë¬ê° ë°ìíìµëë¤.");e.add("initialComplete","íë©´ êµ¬ì± ìë£");e.add("initialException","íë©´ êµ¬ì± ì¤í¨");e.add("isDateTimeInsert",'"{0}" í¬ë§·ì ë ì§ì ìê°ì ìë ¥í´ì¼ í©ëë¤.');e.add("isDateInsert",'"{0}" í¬ë§·ì ë ì§ë¥¼ ìë ¥í´ì¼ í©ëë¤.');e.add("isTimeInsert",'"{0}" í¬ë§·ì ìê°ì ìë ¥í´ì¼ í©ëë¤.');e.add("isNumericInsert","ì«ìë¥¼ ìë ¥í´ì¼ í©ëë¤.");e.add("forceSave","í¸ì§ì¤ì¸ ë°ì´í°ë¥¼ ì ì¥íìê² ìµëê¹?");e.add("textMaxLength",'ìë ¥ ê°ë¥í "{0}"ìë¦¬ìë¥¼ ëììµëë¤');e.add("create","ìë ¥");e.add("read","ì¡°í");e.add("find","ê²ì");e.add("edit","ìì ");e.add("delele","ì­ì ");e.add("removeStatusNo","ì­ì  ê°ë¥í ìíê° ìëëë¤. ë°ì´í°ë¥¼ ì¡°íí í ì­ì  í´ì¼ í©ëë¤.");e.add("removeConfirm","ì ë§ë¡ ì­ì  íìê² ìµëê¹?");e.add("notData","ë°ì´í°ê° ììµëë¤.");e.add("notCondData","ìë ¥íì  ì¡°ê±´ì ë§ë ë°ì´í°ê° ììµëë¤.");e.add("notRetrieveCond","ì¡°íì íìí í­ëª©ì´ ìë ¥ëì§ ìììµëë¤.");e.add("notDateBetween","ê¸°ê°ì´ ì¬ë°ë¥´ê² ì¤ì ëì§ ìììµëë¤.");e.add("notDate","ì íí ë ì§ë¥¼ ìë ¥ íê±°ë ì íí´ì¼ í©ëë¤.");e.add("notFindCond","ê²ìì íìí ë¬¸ì¥ì ìë ¥í´ì¼ í©ëë¤. ì íí ê²ìì ìí´ ëê¸ì ì´ì ìë ¥í´ì¼ í©ëë¤.");e.add("selectData","ë°ì´í°ë¥¼ ì íí´ì¼ í©ëë¤.");e.add("selectAll","ì ì²´");e.add("saveExcel","ìì ë¤ì´ë¡ë ì¤ìëë¤.");e.add("saveExcelComplete","ìì íì¼ì ë¤ì´ë¡ë íìµëë¤.");e.add("saveExcelFail","ìì íì¼ ë¤ì´ë¡ëë¥¼ ì¤í¨ íìµëë¤");e.add("notSupportContent","ì§ì íì§ ìë ì»¨íì¸  íììëë¤.");e.add("notLoginID","ë¡ê·¸ì¸IDë ë°ëì ìë ¥í´ì¼ í©ëë¤.");e.add("notPassword","ë¹ë°ë²í¸ë ë°ëì ìë ¥í´ì¼ í©ëë¤.");e.add("notLogin","ìì´ë ëë ë¹ë°ë²í¸ê° ìëª»ëììµëë¤.");e.add("loginLockedOut",'ë¡ê·¸ì¸ ì¸ì¦ì´ ì§ì ë íì ì´ì ìëª» ëì´, "{0}" ê³ì ì ì ê¹ ìíë¡ ë³ê²½ëììµëë¤. ë´ë¹ììê² ë¬¸ìíì¸ì.');e.add("alreadyLogged","ìë ¥ íì  ê³ì ì ì´ë¯¸ ë¡ê·¸ì¸ ëì´ ììµëë¤. ê³ì ì§ííìë©´ ê¸°ì¡´ ë¡ê·¸ì¸ ê³ì ì ë¡ê·¸ììë©ëë¤. ê³ìíìê² ìµëê¹?")})(globalThis.$res||syn.$resource);(function(e){if(!e){e=new syn.module}e.extend({labels:[],messages:[],mimeType:{html:"text/html",htm:"text/html",css:"text/css",xml:"text/xml",mml:"text/mathml",txt:"text/plain",jad:"text/vnd.sun.j2me.app-descriptor",wml:"text/vnd.wap.wml",htc:"text/x-component",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",tif:"image/tiff",tiff:"image/tiff",wbmp:"image/vnd.wap.wbmp",ico:"image/x-icon",jng:"image/x-jng",bmp:"image/x-ms-bmp",svg:"image/svg+xml",webp:"image/webp",js:"application/x-javascript",atom:"application/atom+xml",rss:"application/rss+xml",jar:"application/java-archive",war:"application/java-archive",ear:"application/java-archive",hqx:"application/mac-binhex40",pdf:"application/pdf",ps:"application/postscript",eps:"application/postscript",ai:"application/postscript",rtf:"application/rtf",doc:"application/msword",docx:"application/msword",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.ms-powerpoint",wmlc:"application/vnd.wap.wmlc",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz","7z":"application/x-7z-compressed",cco:"application/x-cocoa",jardiff:"application/x-java-archive-diff",jnlp:"application/x-java-jnlp-file",run:"application/x-makeself",rar:"application/x-rar-compressed",rpm:"application/x-redhat-package-manager",sea:"application/x-sea",swf:"application/x-shockwave-flash",sit:"application/x-stuffit",tcl:"application/x-tcl",tk:"application/x-tcl",der:"application/x-x509-ca-cert",pem:"application/x-x509-ca-cert",crt:"application/x-x509-ca-cert",xpi:"application/x-xpinstall",xhtml:"application/xhtml+xml",zip:"application/zip",bin:"application/octet-stream",exe:"application/octet-stream",dll:"application/octet-stream",deb:"application/octet-stream",dmg:"application/octet-stream",eot:"application/octet-stream",iso:"application/octet-stream",img:"application/octet-stream",msi:"application/octet-stream",ewp:"application/octet-stream",msm:"application/octet-stream",mid:"audio/midi",midi:"audio/midi",mp3:"audio/mpeg",ogg:"audio/ogg",ra:"audio/x-realaudio","3gpp":"video/3gpp","3gp":"video/3gpp",mpeg:"video/mpeg",mpg:"video/mpeg",mov:"video/quicktime",flv:"video/x-flv",mng:"video/x-mng",asx:"video/x-ms-asf",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv",avi:"video/x-msvideo",m4v:"video/mp4",mp4:"video/mp4"},addStringResource:function(e,t){if($reflection.typeOf(t)==="object"){this.messages[e]=t;return this.messages}else{this.labels[e]=t;return this.labels}return this}})})($resource||window.$resource);(function(e){var r=r||new syn.module;r.extend({version:"1.0",max:10,actual:0,intervalID:0,message:0,status:0,isProgress:false,show:function(e,t){r.message=e;$l.querySelector(".ui_progressbar").style["display"]="block";r.isProgress=true;if(t){if(t>500){t=500}$(".progressBar").width(t);$l.querySelector(".progressBar").style.marginLeft=(-(t/2)).toString()+"px"}var e=$l.querySelector(".message");e.innerText=r.message;if(parent.$layout){parent.$layout.buttonAction=false}r.intervalID=setInterval(r.progress,1e3);e=null},clear:function(){$l.removeEvent(syn.$l.querySelector(".message"),"click",function(){r.close()});clearInterval(r.intervalID);r.actual=0;r.intervalID=0;r.message="";$l.querySelector(".message").innerText="";r.isProgress=false;if(parent.$layout){parent.$layout.buttonAction=true}},close:function(){this.clear();$m.setStyle(syn.$l.querySelector(".ui_progressbar"),"display","none")},progress:function(){if(r.actual>=r.max){$l.addEvent(syn.$l.querySelector(".message"),"click",function(){r.close()});clearInterval(r.intervalID)}r.actual++}});e.$progressBar=e.$progressBar||r})(window);(function(w){if(!w){w=new syn.module}w.extend({SSO:null,AppInfo:null,nanobar:new Nanobar,isPerformanceLog:false,dialogResult:null,alertResult:null,isShowDialog:false,isShowAlert:false,dialogOptions:{opacity:0,overlayId:"simplemodal-overlay",containerId:"simplemodal-container",closeHTML:'<a class="modalCloseImg icon-delete" title="Close"></a>',minWidth:320,minHeight:240,modal:true,escClose:false,overlayClose:false,persist:true,fixed:false,isHidden:false,scrolling:false,onOpen:null,onClose:function(e){w.isShowDialog=false;if(parent.$layout){parent.$layout.buttonAction=true}if($.modal.impl.o.isHidden){$.modal.impl.o.hide()}else{$.modal.close()}if($.modal.impl.o.onCallback){if(syn.$b.isIE){window.focus()}$.modal.impl.o.onCallback(syn.$w.dialogResult);$w.dialogResult=null}if(syn.$v.focusElement){$v.focusElement.focus();$v.focusElement=null}},onShow:function(e){},onCallback:null},alertOptions:{opacity:0,overlayId:"alertmodal-overlay",containerId:"alertmodal-container",dataId:"alertmodal-data",closeClass:"alertmodal-close",closeHTML:'<a class="modalCloseImg icon-delete" title="Close"></a>',minWidth:380,minHeight:240,dialogIcon:1,dialogButtons:1,textHeight:null,autoSize:false,modal:true,escClose:false,overlayClose:false,persist:true,fixed:false,isHidden:false,onOpen:null,onClose:function(e){w.isShowAlert=false;if(parent.$layout){parent.$layout.buttonAction=true}if($.alert.impl.o.isHidden){$.alert.impl.o.hide()}else{$.alert.close()}if($.alert.impl.o.onCallback){if(syn.$b.isIE){window.focus()}$.alert.impl.o.onCallback(syn.$w.alertResult);$w.alertResult=null}if(syn.$v.focusElement){$v.focusElement.focus();$v.focusElement=null}},onShow:function(e){},onCallback:null},iframeChannels:[],popupOptions:{target:null,debugOutput:false,isCloseHidden:false,isCloseButton:true,isModal:true,baseELID:"",title:null,projectID:"",itemID:"",src:"",origin:"*",scope:"default_channel",notifyActions:[],top:50,left:50,width:640,height:480},lagacyPrintPdfDocument:function(e){try{var t=$w.AppInfo.getWorkConcurrentValue(syn.$w.SSO.WorkCompanyNo,"User")||$w.SSO.UserNo;var r={strLoginCompanyNo:$w.SSO.WorkCompanyNo,strLoginUserNo:t,strPRINT_TYPE:""};if(syn.Config&&syn.Config.Environment){r.strENV=syn.Config.Environment.substring(0,1)}e=$w.argumentsExtend(r,e);var n="/api/PdfManager/ParseUrlToPdf?base64QueryString="+$c.base64Encode("?appID=HDS"+$r.toQueryString(e));printJS(n)}catch(e){$l.eventLog("$w.parsePdfUrl"," error: "+e.message,"Error")}},printPdfDocument:function(e){try{var t=$w.AppInfo.getWorkConcurrentValue(syn.$w.SSO.WorkCompanyNo,"User")||$w.SSO.UserNo;var r={REPORT_ID:"",COMPANY_NO:$w.SSO.WorkCompanyNo,DOCUMENT_FORM_ID:"",DOCUMENT_NO:"",EMPLOYEE_NO:t,PRINT_TYPE:"",ENV:"D"};if(syn.Config&&syn.Config.Environment){r.ENV=syn.Config.Environment.substring(0,1)}e=$w.argumentsExtend(r,e);var n="/api/PdfManager/CrownixPdfDownload?appID=HDS"+$r.toQueryString(e);printJS(n)}catch(e){$l.eventLog("$w.parsePdfUrl"," error: "+e.message,"Error")}},getPdfDocumentUrl:function(e){try{var t=$w.AppInfo.getWorkConcurrentValue(syn.$w.SSO.WorkCompanyNo,"User")||$w.SSO.UserNo;var r={strLoginCompanyNo:$w.SSO.WorkCompanyNo,strLoginUserNo:t};e=$w.argumentsExtend(r,e);return"/api/PdfManager/ParseUrlToPdf?base64QueryString="+$c.base64Encode("?appID=HDS"+$r.toQueryString(e))}catch(e){$l.eventLog("$w.getPdfDocumentUrl"," error: "+e.message,"Error")}},executeChannelMessage:function(e,r,t,n,i){var a=$w.iframeChannels.find(function(e){return e.id==(i||$this.channelID)});if($object.isNullOrUndefined(a)==false){a.channel[e]({method:r,params:t,error:function(e,t){$l.eventLog("$w.executeChannelMessage",r+" error: "+e+" ("+t+")","Error");if(n){n(e,t)}},success:function(e){$l.eventLog("$w.executeChannelMessage",r+" returns: "+e,"Debug");if(n){n(null,e)}}})}},serviceClientException:function(e,t,r){if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}if($.modal){$.modal.close()}if($progressBar){$progressBar.close()}if(syn.$w.alert&&$.alert){var n=$reflection.clone(syn.$w.alertOptions);n.minWidth=480;n.minHeight=285;n.stack=r;n.autoSize=true;$w.alert(t,e,n)}else{console.log(e,t)}return false},setServiceObjectHeader:function(e){$timeTracker.Init(e.RequestID);$timeTracker.recordSave(e.ServiceID,e.ServiceID+" prepare serviceObject")},serviceClientCallback:function(e){$timeTracker.Init(e.ResponseID);$timeTracker.recordSave(e.ServiceID,e.ServiceID+" serviceClient complete")},serviceClientInterceptor:function(e,t){if(syn.$w.domainTransactionLoaderEnd){$w.domainTransactionLoaderEnd()}if(e=="ROQKFWKTLFGODZNJFL"){if($&&$.modal){$.modal.close()}if($progressBar){$progressBar.close()}var r=$reflection.clone(syn.$w.alertOptions);r.minWidth=480;r.minHeight=320;$w.alert(JSON.parse(t.responseText).Result.replace(/â/g,"\n\n"),"Execute SQL",r);return false}else{if($progressBar){$progressBar.close()}try{var n=JSON.parse(t.responseText);var i=n.Acknowledge;var a=n.ExceptionText;if(i==0&&a.match(/(ORA-20[0-9]{3})/)!=null){if(a.indexOf("ORA-20999")>-1){var o=/ORA\-20999: (.*?)\n/.exec(a);if(o!=null&&o.length>1){var s=o[1];$w.statusMessage(s);$w.alert(s)}return false}var l=globalThis[$w.pageScript];if(l["afterTransaction"]){var u={};u.exceptionText=a;l["afterTransaction"](null,n.TH.FUNC_CD,null,u)}return false}else if(i==0&&a.match(/(QAF-20[0-9]{3})/)!=null){if(a.indexOf("QAF-20999")>-1){var o=/QAF\-20999: (.*?)\n/.exec(a);if(o!=null&&o.length>1){var s=o[1];$w.statusMessage(s);$w.alert(s)}return false}var l=globalThis[$w.pageScript];if(l["afterTransaction"]){var u={};u.exceptionText=a;l["afterTransaction"](null,n.TH.FUNC_CD,null,u)}return false}}catch(e){$l.eventLog("serviceClientInterceptor",e,"Error")}return true}},setServiceClientHeader:function(e){var t=true;var r=window.event||parent.event||parent.window.event;if(syn.$l.get("hdfExteriorLinkage")!=null&&$l.get("hdfExteriorLinkage").value=="false"){if(parent.$MainFrame){if(parent.$MainFrame.timerRunning==false){$w.alert($res.messages.SessionDestroyed.text);$progressBar.close();t=false}}}if(r&&r.ctrlKey==true&&r.altKey==true){$w.clientTag="ROQKFWKTLFGODZNJFL";e.setRequestHeader("ClientTag","ROQKFWKTLFGODZNJFL")}else{$w.clientTag="UUNOLkV4cGVydEFwcA==";e.setRequestHeader("ClientTag","UUNOLkV4cGVydEFwcA==");var n=$r.query("tabID");if(n){var i=$r.query("tabID").split("$");e.setRequestHeader("CategoryID",i[3]);e.setRequestHeader("MenuID",i[0])}}if(location.href.toLowerCase().indexOf("/views/ui/")>-1||location.href.toLowerCase().indexOf("/views/shared/")>-1||location.href.toLowerCase().indexOf("/sample/")>-1){var a=$w.getStorage("member");if($string.isNullOrEmpty(a)==false){e.setRequestHeader("EasyWork.Member",a)}}return t},getFetchClientOptions:function(e){var t=null;var r={method:"GET",headers:{}};t=$w.argumentsExtend(r,e);var n=window.event||parent.event||parent.window.event;if(syn.$l.get("hdfExteriorLinkage")!=null&&$l.get("hdfExteriorLinkage").value=="false"){if(parent.$MainFrame){if(parent.$MainFrame.timerRunning==false){$w.alert($res.messages.SessionDestroyed.text);$progressBar.close();isContinue=false}}}if(n&&n.ctrlKey==true&&n.altKey==true){t.headers["ClientTag"]="ROQKFWKTLFGODZNJFL"}else{t.headers["ClientTag"]="UUNOLkV4cGVydEFwcA==";var i=$r.query("tabID");if(i){var a=$r.query("tabID").split("$");t.headers["CategoryID"]=a[3];t.headers["MenuID"]=a[0]}}if(location.href.toLowerCase().indexOf("/views/ui/")>-1||location.href.toLowerCase().indexOf("/views/shared/")>-1||location.href.toLowerCase().indexOf("/sample/")>-1){var o=$w.getStorage("member");if($string.isNullOrEmpty(o)==false){t.headers["EasyWork.Member"]=o}}return t},serviceClient:function(a,e,o,t,r){if(!e){alert("ìë¹ì¤ í¸ì¶ì íìí jsonObjectê° êµ¬ì±ëì§ ìììµëë¤.");return}var n=JSON.stringify(e);var s=this.xmlHttp();if(a.split("?").length==1){a=a+"?noCacheIE="+(new Date).getTime()}else{a=a+"&noCacheIE="+(new Date).getTime()}if(!t){t=true}s.open(w.method,a,t);s.setRequestHeader("Accept-Language",this.localeID);if(this.setServiceClientHeader){if(this.setServiceClientHeader(s)==false){return}}if(r!==undefined){s.setRequestHeader("User-Token",r)}if(t===false){s.setRequestHeader("X-Requested-With","Qrame ServiceClient");s.setRequestHeader("content-type","application/json");s.send(n);return s}s.onreadystatechange=function(){if(s.readyState===4){if(s.status==0){return}else if(s.status!==200){if(s.responseText.length>0){alert(s.responseText||s.statusText)}}try{if(syn.$w.clientTag&&$w.clientTag=="ROQKFWKTLFGODZNJFL"&&$w.serviceClientInterceptor){if(syn.$w.serviceClientInterceptor(a,s)===false){return}}}catch(e){return}var e="text";var t="";var r="";try{var n=JSON.parse(s.responseText);e=n.ReturnType;r=n.ServiceID;$timeTracker.Init(n.ResponseID);if(e==="error"){t=n.ExceptionText}if(e==="warning"){var i=window[syn.$w.pageScript];if(i["serviceClientException"]){i["serviceClientException"](a,n,s)}else{alert("ServiceID : "+r+"\n"+n.Result)}}else if(e.indexOf("text")>-1||e.indexOf("json")>-1){if(o){o(n)}}else if(e.indexOf("xml")>-1){if(o){o(s.responseXML)}}else{if(syn.$w.serviceClientException){if(syn.$w.serviceClientException(a,n,s)===false){alert("ServiceID : "+r+"\n"+t)}}else{alert("ServiceID : "+r+"\n"+t)}var i=window[syn.$w.pageScript];if(i.serviceClientException){i.serviceClientException(a,n,s)}}if($progressBar.isProgress==true){$progressBar.close()}if(n.ServiceID){$timeTracker.recordSave(n.ServiceID,n.ServiceID+" serviceClient complete")}}catch(e){if($progressBar.isProgress==true){$progressBar.close()}return}i=null;e=null;t=null;r=null;pageScript=null;a=null;n=null;s=null;return}};s.setRequestHeader("X-Requested-With","Qrame ServiceClient");s.setRequestHeader("content-type","application/json");s.send(n)},getActiveTabInfo:function(){var e=null;if(parent.$layout){e=parent.$layout.getActiveTab()}else{$w.alert("getActiveTabInfo í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}try{return e}finally{e=null}},getCurrentTabInfo:function(){var e=null;var t=$r.query("tabID");if(t){var r=t.split("$");e={tabID:t,projectID:r[0],itemID:r[1],menuID:r[2],parentMenuID:r[3]}}return e},getTabInfo:function(e,t){var r=null;if(parent.$layout){r=parent.$layout.getTabInfo(e,t)}else{$w.alert("getTabInfo í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}return r},setTabTitleText:function(e){var t=$r.query("tabID");if(t&&e){if(parent.$layout){var r=parent.$l.get(t);if(r){r.querySelector("span").textContent=e}}else{$w.alert("setTabTitleText í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}}},getTabContentHeight:function(e,t){var r=null;if(parent.$layout){if(e&&t){r=parent.$layout.getActiveTabID(e,t)}else{r=$r.query("tabID")}}else{$l.eventLog("syn.domain","getTabContentHeight í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤","Warning");return}try{var n=0;n=$(parent.$l.get(r+"$i")).height();var i=$(document.body).height();if(n<i){n=i}return n}finally{r=null}},triggerUICommand:function(e,t,s,l){if(parent.$layout){var r=parent.$layout.getActiveTabID(e,t);if(r){parent.$layout.focusTabUI(r);var n=parent.$layout.getActiveTabContent(r);if(n){var i=n[n["$w"].pageScript];var a=i[s];if(a){a(l)}}}else{$w.addTabUI(e,t,function(i){if(parent&&parent.$MainFrame){var e=parent.document.querySelector('ul[class="mainTabUI"] > li[id="'+i+'"]');if(e){parent.$m.setStyle(e,"display","block")}}var a=0;var o=setInterval(function(){if(a>10){clearInterval(o);return}if(i){var e=parent.$layout.getActiveTabContent(i);if(e&&e["$w"]){clearInterval(o);var t=e["$w"];var r=e[t.pageScript];var n=setInterval(function(){clearInterval(n);if(t.isPageLoad==true){var e=r[s];if(e){e(l)}}},250)}}},600);return false})}}else{$w.alert("triggerUICommand í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}},setUIStorage:function(e,t,r,n){if(parent.$layout){var i="{0}${1}".format(e,t);if(n){$w.setStorage(i+"~"+r,n);var a=parent.$layout.getActiveTabID(e,t);var o=parent.$layout.getActiveTabContent(a);if(o){var s=o[o["$w"].pageScript];parent.$layout.layout_UIStoregeChanging(s,a,r)}}else{$w.removeStorage(i+"~"+r)}}else{$w.alert("setUIStorage í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}},getUIStorage:function(e){if(parent.$layout){var t=$w.getCurrentTabInfo();var r="{0}${1}".format(t.projectID,t.itemID);return syn.$w.getStorage(r+"~"+e)}else{$w.alert("getUIStorage í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}},domainTransactionLoaderStart:function(){$w.domainTransactionLoaderEnd();var e=window[syn.$w.pageScript];if(e&&$object.isNullOrUndefined(e.isTransactionLoader)==true){e.isTransactionLoader=true}if(e.isTransactionLoader==true&&location.pathname.substring(0,6)==="/views"){$w.nanobar.go(100);$w.transactionLoaderID=setInterval(function(){$w.nanobar.go(100)},1e3)}},domainTransactionLoaderEnd:function(){if(syn.$w.transactionLoaderID){clearInterval(syn.$w.transactionLoaderID);$w.transactionLoaderID=null}},progressMessage:function(e){if($progressBar){if($progressBar.isProgress==true){$progressBar.close()}$progressBar.show(e)}if(parent.$layout){var t=$w.getCurrentTabInfo();if(t){parent.$layout.setStatusMessage(t.tabID,e)}}},closeProgressMessage:function(){if($progressBar){if($progressBar.isProgress==true){$progressBar.close()}}},statusMessage:function(e){if(parent.$layout){var t=$w.getCurrentTabInfo();if(t){parent.$layout.setStatusMessage(t.tabID,e)}else{$l.eventLog("statusMessage",e,"Information")}}},addTabUI:function(t,r,e){if(parent.$layout){var n=$r.query("tabID");if(n!=""){var i=null;var a=parent.$layout.menus.filter(function(e){return e.ASSEMBLYNAME==t&&e.CLASSNAME==r});if(a.length>0){i=a[0]}else{$w.alert("ë©ë´ ì ë³´ê° ì¬ë°ë¥´ì§ ììµëë¤","ì ë³´");return}var o="";if(i.PROGRAMPATH){o=i.PROGRAMPATH}else{o="/views/{0}/{1}.html".format(i.ASSEMBLYNAME,i.CLASSNAME)}if(event&&event.ctrlKey==true){o=o.replace("views","designs")}parent.$layout.addTabUI(i.ASSEMBLYNAME,i.CLASSNAME,i.PROGRAMID,i.PARENTID,o,e)}else{$w.alert("addTabUI í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}}else{$w.alert("addTabUI í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}},closeTabID:function(e){if(parent.$layout){parent.$layout.closeTabID(e)}else{$w.alert("closeTabID í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}},closeTabUI:function(e,t){if(parent.$layout){var r=parent.$layout.getActiveTabID(e,t);parent.$layout.closeTabID(r)}else{$w.alert("closeTabUI í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}},isTabUI:function(e,t){var r=false;if(parent.$layout){var n=parent.$layout.getActiveTabID(e,t);if(n){r=true}}else{$w.alert("isTabUI í¨ìë UI íë©´ë´ììë§ í¸ì¶ í  ì ììµëë¤")}return r},closeDialog:function(e){$w.dialogResult=e;$.modal.close()},closeAlertDialog:function(e){$w.alertResult=e;$.alert.close()},notify:function(e,t,r){switch(r){case"info":Notifier.notify(e,t);break;case"warning":Notifier.notify(e,t);break;case"error":Notifier.notify(e,t);break;case"question":Notifier.notify(e,t);break;default:Notifier.notify(e,t);break}},alert:function(e,t,r,n){var i=document.createElement("div");var a=$m.append(i,"dl");var o=$m.append(a,"dt");var s=$m.append(a,"dd");var l=$m.append(s,"div");var u=$m.append(s,"p");if(r&&r.autoSize==true){var f=$d.measureSize(r.stack);if(f){var c=parseInt(f.width.replace("px",""))+35;var d=parseInt(f.height.replace("px",""));if(c>800){c=800}r.minWidth=c;if(d>r.minHeight-160){if(d>600){d=600}r.minHeight=d+160;r.textHeight=d}}}if(r&&r.stack){var h=$m.append(i,"div");var d=r.textHeight?r.textHeight:160;$m.addCssText(h,"margin: 15px; height: {0}px; overflow: auto; color: #000".format(d));h.innerHTML=r.stack.replace(/(\n|\r\n)/gm,"<br />")}var v=$m.append(i,"div");var p=$m.append(o,"span");$m.addCssText(p,"color: #434343; font-size: 72px; margin-top: 20px;");$m.addClass(v,"btn-area");$m.setStyle(i,"display","none");u.innerHTML=e.replace(/(\n|\r\n)/gm,"<br />");l.innerText=t?t:"";if(r){r.close=false}else{r=$reflection.clone(syn.$w.alertOptions);r.dialogIcon="1";r.dialogButtons="1";r.close=false}if(r.dialogIcon){switch(r.dialogIcon){case"1":$m.addClass(p,"ri-information-line");break;case"2":$m.addClass(p,"ri-error-warning-line");break;case"3":$m.addClass(p,"ri-question-line");break;case"4":$m.addClass(p,"ri-alarm-warning-line");break;default:$m.addClass(p,"ri-information-line");break}}if(r.dialogButtons){var g=null;var m=null;var y=null;switch(r.dialogButtons){case"1":g=$('<input type="button"/>').appendTo(v)[0];g.value=$res.labels.Confirm?$res.labels.Confirm:"íì¸";g.data="OK";break;case"2":g=$('<input type="button"/>').appendTo(v)[0];g.value=$res.labels.Confirm?$res.labels.Confirm:"íì¸";g.data="OK";m=$('<input type="button"/>').appendTo(v)[0];m.value=$res.labels.Cancel?$res.labels.Cancel:"ì·¨ì";m.data="Cancel";break;case"3":g=$('<input type="button"/>').appendTo(v)[0];g.value=$res.labels.Yes?$res.labels.Yes:"ì";g.data="Yes";m=$('<input type="button"/>').appendTo(v)[0];m.value=$res.labels.No?$res.labels.No:"ìëì¤";m.data="No";break;case"4":g=$('<input type="button"/>').appendTo(v)[0];g.value=$res.labels.Yes?$res.labels.Yes:"ì";g.data="Yes";m=$('<input type="button"/>').appendTo(v)[0];m.value=$res.labels.No?$res.labels.No:"ìëì¤";m.data="No";y=$('<input type="button"/>').appendTo(v)[0];y.value=$res.labels.Cancel?$res.labels.Cancel:"ì·¨ì";y.data="Cancel";break;default:g=$('<input type="button"/>').appendTo(v)[0];g.value=$res.labels.Confirm?$res.labels.Confirm:"íì¸";g.data="OK";break}var b=function(e){var t=e.target||e;$w.closeAlertDialog(t.data)};$m.addClass(g,"btn");$m.addClass(g,"btn-primary");$l.addEvent(g,"click",b);if(m){$m.addClass(m,"btn");$m.addClass(m,"btn-default");$l.addEvent(m,"click",b)}if(y){$m.addClass(y,"btn");$m.addClass(y,"btn-default");$l.addEvent(y,"click",b)}g=null;m=null;y=null}if(r){if(n){r.onCallback=n}$.alert(i,r)}else{if(n){$w.alertOptions.onCallback=n}$.alert(i,$w.alertOptions)}if(parent.$layout){w.isShowAlert=true;parent.$layout.buttonAction=false}i=null;l=null;u=null;p=null;v=null},showDialog:function(e,t,r){if(t){if(r){t.onCallback=r}$.modal(e,t)}else{if(r){$w.dialogOptions.onCallback=r}$.modal(e,$w.dialogOptions)}if(parent.$layout){w.isShowDialog=true;parent.$layout.buttonAction=false}var n=document.getElementById("simplemodal-container");var i=0,a=0,o=0,s=0;function l(e){e=e||window.event;e.preventDefault();i=o-e.clientX;a=s-e.clientY;o=e.clientX;s=e.clientY;n.style.top=n.offsetTop-a+"px";n.style.left=n.offsetLeft-i+"px"}function u(){$l.removeEvent(document,"mouseup",u);$l.removeEvent(document,"mousemove",l)}function f(e){e=e||window.event;e.preventDefault();o=e.clientX;s=e.clientY;$l.addEvent(document,"mouseup",u);$l.addEvent(document,"mousemove",l)}var c=$l.querySelector("#simplemodal-container .simplemodal-data h3");if(c){$l.addEvent(c,"mousedown",f)}else{$l.addEvent(n,"mousedown",f)}},showUIDialog:function(t,e,r){var n=document.createElement("div");$m.addClass(n,"simplemodal-data");$m.setStyle(n,"display","none");var i=$m.append(n,"h3");$m.addClass(i,"mt-0");$m.addClass(i,"mb-0");i.innerText=e.caption?e.caption:t;var a=$m.append(n,"iframe");$m.setStyle(a,"border","0px");a.setAttribute("name","syn-repository");e.onShow=function(e){a.setAttribute("src",t)};if(e.scrolling){a.scrolling="yes"}else{a.scrolling="no"}if(e){e.persist=false;if(r){e.onCallback=r}a.width="100%";a.height=(e.minHeight-40).toString();$.modal(n,e)}else{e.persist=false;if(r){$w.dialogOptions.onCallback=r}a.width="100%";a.height="320";$.modal(n,$w.dialogOptions)}if(parent.$layout){w.isShowDialog=true;parent.$layout.buttonAction=false}var o=document.getElementById("simplemodal-container");var s=0,l=0,u=0,f=0;function c(e){e=e||window.event;e.preventDefault();s=u-e.clientX;l=f-e.clientY;u=e.clientX;f=e.clientY;o.style.top=o.offsetTop-l+"px";o.style.left=o.offsetLeft-s+"px"}function d(){$l.removeEvent(document,"mouseup",d);$l.removeEvent(document,"mousemove",c)}function h(e){e=e||window.event;e.preventDefault();u=e.clientX;f=e.clientY;$l.addEvent(document,"mouseup",d);$l.addEvent(document,"mousemove",c)}var v=$l.querySelector("#simplemodal-container .simplemodal-data h3");if(v){$l.addEvent(v,"mousedown",h)}else{$l.addEvent(o,"mousedown",h)}},windowOpen:function(e,t,r){if(t.isCloseHidden==true){$.fn.WM_close=$w.windowHide}if(syn.$l.get(e)){$w.alert(e+"ë ì¬ì© ì¤ì¸ íì ID ìëë¤");return}if(window==top||window.parent.$w.pageScript=="$MainFrame"){var n=$w.argumentsExtend(syn.$w.popupOptions,t);if(n.projectID&&n.itemID&&(n.src==null||n.src==undefined||n.src.trim()=="")){if(parent.$layout&&parent.$layout.autocomplete_nodes){var i=parent.$layout.autocomplete_nodes.find(function(e){return e.ASSEMBLYNAME==n.projectID&&e.CLASSNAME==n.itemID});if(i){var a="";if(i.PROGRAMPATH){a=i.PROGRAMPATH}else{if(i.CLASSNAME.indexOf("|")>-1){var o=i.CLASSNAME.split("|")[0];var s=i.CLASSNAME.split("|")[1];if(o=="URL"){a=s}}else{a="/views/{0}/{1}.html".format(i.ASSEMBLYNAME,i.CLASSNAME)}}n.title=$object.isNullOrUndefined(n.title)==true?i.PROGRAMNAME:n.title;n.src=a}}}if(n.src==null||n.src==undefined||n.src.trim()==""){$l.eventLog("syn.domain.windowOpen","{0}ë©ë´ID ëë URL ìì± íì¸ íì".format(n.itemID?n.itemID:""),"Warning");return}if(n.notifyActions.length==0){$l.eventLog("syn.domain.windowOpen","notifyActions ìì± íì¸ íì","Warning");return}var l=n.channelID?n.channelID:null;n.title=$object.isNullOrUndefined(n.title)==false?n.title:e;if(n.title===""){n.title=" "}$r.path=n.src;$r.params=[];$r.params["baseELID"]=n.baseELID?n.baseELID:e;if(l){$r.params["channelID"]=l}var t=$r.toUrlObject(n.src);for(var u in t){$r.params[u]=t[u]}if($string.isNullOrEmpty(syn.$w.SSO.WorkCompanyNo)==false&&$r.params.hasOwnProperty("companyNo")==false){$r.params["companyNo"]=$w.SSO.WorkCompanyNo}n.src=$r.url();var f=$.WM_open(e,n.src,n.target,n);if(t.isCloseButton==false){f.find(".horizbuts").hide()}f.find(".closebut").addClass("ri-close-line");if(f){var c=f.offset();if(c.top<0){f.offset({top:0})}if(c.left<0){f.offset({left:0})}f.attr("channelID",l?l:"");f.attr("baseELID",n.baseELID);if(n.isModal==true){var d=$m.createElement("div");var h=f.css("zIndex");f.attr("overlayZIndex",h);d.id=e+"_overlay";$m.setStyle(d,"z-index",h-1);$m.addClass(d,"modal_overlay");$m.appendChild(document.body,d)}var v=f.find("iframe")[0].contentWindow;$l.addEvent(v,"load",function(){if(r){r(e)}});if(l){var p={elID:e,windowHandle:f,id:l,channel:syn.$channel.connect({debugOutput:n.debugOutput,window:v,origin:n.origin,scope:l})};for(var g=0;g<n.notifyActions.length;g++){var m=n.notifyActions[g];p.channel.bind(m.actionID,m.handler)}$w.iframeChannels.push(p)}}}else{if(window.parent){setTimeout(function(){window.parent.$w.windowOpen(e,t,r)})}else{$l.eventLog("windowOpen","Qrame íë©´ììë§ í¸ì¶ ê°ë¥","Error")}}},windowShow:function(e){var t=$l.get(e);if(t){$m.setStyle(t,"display","block")}$("#"+e).WM_raise()},windowHide:function(e){if(e){if(syn.$l.get(e)){$m.setStyle(syn.$l.get(e),"display","none")}}else{if(this.filter(".window").length>0){$m.setStyle(this.filter(".window")[0],"display","none")}}$("#"+e).WM_raise()},windowClose:function(t){if(window==top||window.parent.$w.pageScript=="$MainFrame"){var e=$w.iframeChannels.filter(function(e){return e.elID==t});if(e.length>0){var r=e[0];var n=r.windowHandle;var i=r.channel;i.destroy();var a=n.attr("baseELID");if(a!=""){$("#"+a).closest(".window").WM_raise()}var o=n.attr("id")+"_overlay";$("#"+o).remove();n.WM_close()}}else{if(window.parent){window.parent.$w.windowClose(t)}}},getUpdateParameters:function(e){var t=[];var r=[];if(e){r=$l.querySelectorAll(e+" *[bindingID]")}else{r=$l.querySelectorAll('input[type="text"], input[type="button"], input[type="checkbox"], input[type="hidden"], button, select, textarea')}var n=null;var i=null;for(var a=0;a<r.length;a++){n=r[a];i=n.getAttribute("bindingID");if(i){switch(n.type.toLowerCase()){case"checkbox":t.push({prop:i,val:n.checked});break;default:if(n.getAttribute("TextEditType")=="Numeric"){t.push({prop:i,val:n.value.toNumberString()})}else{t.push({prop:i,val:n.value})}break}}}r=$l.querySelectorAll('input[type="radio"]');n=null;var o=[];var s="";for(var a=0;a<r.length;a++){n=r[a];i=n.getAttribute("bindingID");if(i){o.push(i)}}o=syn.lib.$array.distinct(o);var l=null;for(var a=0;a<o.length;a++){s=o[a];if($radio){t.push({prop:s,val:$radio.getValue(s)})}else{l=document.getElementsByName(s);for(var u=0;u<l.length;u++){if(l[u].checked){t.push({prop:s,val:l[u].value});break}}}}return t},getSSOInfo:function(){var e=null;var t=$w.getStorage("member",false);if(t==null){if(syn.$r.getCookie("EasyWork.Member")){var r=$c.base64Decode(syn.$r.getCookie("EasyWork.Member"));e=JSON.parse(r)}}else{e=JSON.parse(syn.$c.base64Decode(t))}return e},getAppInfo:function(){var e=null;var t=$w.getStorage("addtional",false);if(t==null){if(syn.$r.getCookie("EasyWork.Addtional")){var r=$c.base64Decode(syn.$r.getCookie("EasyWork.Addtional"));e=JSON.parse(r)}}else{e=JSON.parse(syn.$c.base64Decode(t))}if($object.isNullOrUndefined(e)==false){var i=function(e,t,r){var n=null;if($object.isNullOrUndefined(r)==true){r="No"}if(syn.$w.AppInfo.CONCURRENTYN=="Y"){if($object.isNullOrUndefined(syn.$w.SSO.WorkUserNo)==false){var i=$w.AppInfo.CONCURRENTUSERNO.split(",").indexOf(syn.$w.SSO.WorkUserNo.toString());if(i>-1){var a=$w.AppInfo["CONCURRENT"+t.toUpperCase()+r.toUpperCase()];if($object.isNullOrUndefined(a)==false){var o=$w.AppInfo["CONCURRENTCOMPANYNO"];if($object.isNullOrUndefined(o)==false){var s=o.split(",").indexOf(e.toString());if(s>-1&&o.split(",")[s]==e){n=a.split(",")[i]}}}}}else{var i=$w.AppInfo.CONCURRENTCOMPANYNO.split(",").indexOf(e.toString());if(i>-1){var a=$w.AppInfo["CONCURRENT"+t.toUpperCase()+r.toUpperCase()];if($object.isNullOrUndefined(a)==true){n=null}else{n=a.split(",")[i]}}}}else if(syn.$w.AppInfo.CONCURRENTYN=="N"){var l=$w.SSO[t+r];if($object.isNullOrUndefined(l)==true){n=null}else{n=l}}return n};e.getWorkConcurrentValue=i;e.getWorkUserInfo=function(e,r){var t=i(e,"User");if($string.isNullOrEmpty(e)==false&&$string.isNullOrEmpty(t)==false&&r){var n={ProgramID:"SYN",BusinessID:"CMM",SystemID:"BP01",TransactionID:"CMM030",FunctionID:"GD01",DataTransactionInterface:"Row|Form",InputObjects:[{prop:"COMPANY_NO",val:e.toString()},{prop:"EMPLOYEE_NO",val:t}]};$w.transactionDirect(n,function(e){var t=null;if(e&&e.length>0){t=e[0].Value;if($string.isNullOrEmpty(t.ErrorMessage)==false){$l.eventLog("getWorkUserInfo","ê²¸ì§ ì¬ì©ì ì ë³´ ì¡°í ì¤ë¥, ErrorMessage: {0}".format(t.ErrorMessage),"Error")}else{r(Object.keys(t).length>0?t:null)}}else{$l.eventLog("getWorkUserInfo","ê²¸ì§ ì¬ì©ì ì ë³´ ì¡°í ì¤ë¥, directObject: {0}".format(JSON.stringify(n)),"Error")}})}}}return e},setAppInfo:function(e){var t=new Date;t.setTime(t.getTime());var r=1e3*60*60*24;var n=new Date(t.getTime()+r);var i=$c.base64Encode(escape(JSON.stringify(e)));document.cookie="EasyWork.Addtional=EasyWork.Addtional="+i+(r?";path=/;expires="+n.toGMTString():"")},execPrefixFunc:function(e,t){var r=["webkit","moz","ms","o",""];var n=0,i,a;while(n<r.length&&!e[i]){i=t;if(r[n]==""){i=i.substr(0,1).toLowerCase()+i.substr(1)}i=r[n]+i;a=typeof e[i];if(a!="undefined"){r=[r[n]];return a=="function"?e[i]():e[i]}n++}},updateValue:function(e,t){switch(e.type.toLowerCase()){case"checkbox":result[t]=control.checked;break;case"text":result[t]=control.value;break;default:result[t]=control.value;break}},initializeFormReset:function(e){$l.get("form1").reset();var t=$l.querySelectorAll("select,checkbox");for(var r=0;r<t.length;r++){switch(t[r].type.toLowerCase()){case"radio":t[r].checked=false;break;case"checkbox":t[r].checked=false;break;case"text":t[r].value="";case"select-one":t[r].selectedIndex=0;break;default:t[r].value="";break}}if(e){e.focus()}t=null;e=null;return this},initializeValue:function(e){if(e.type!==undefined){switch(e.type.toLowerCase()){case"radio":e.checked=e.getAttribute("IsDefaultChecked");break;case"checkbox":e.checked=false;break;case"text":case"textarea":e.value="";if(e.getAttribute("Booltoday")=="True"){e.value=(new Date).getNow("d")}break;case"select-one":e.selectedIndex=0;break}}else if(e.className=="grd_control"){$grid.dataClear(e.id.replace("_Box",""))}},bindingValue:function(e,t){switch(e.type.toLowerCase()){case"checkbox":e.checked=t=="1"?true:false;break;case"radio":e.checked=e.value==t?true:false;break;case"text":if(e.getAttribute("TextEditType")=="Numeric"){e.value=t.toCurrency()}else{e.value=t}break;case"select":e.value=t;break;default:e.value=t;break}},getPersonPicturePath:function(e,t){var r=Number(t)/1e3;var n="\\"+e+"\\";if(isNaN(r)){n+=(r*1e3).toString()+"\\"}else{n+=((Number(r.toString().substring(0,r.toString().indexOf("")))+1)*1e3).toString()+"\\"}return n},getPersonPictureNM:function(e){var t="0000000000"+e;return t.substring(t.length,t.length-10)},getAuth:function(e,t){var r={};r.RequestID=$l.guid();r.ReturnType="json";r.ServiceID="GetAuth";r.NameValues=[];if(!t){t="0"}r.NameValues.push({prop:"categoryID",val:e});r.NameValues.push({prop:"worshipDeptID",val:t});var n=$w.serviceClient("/RESTFul/ZZ/",r,"",false);var r=JSON.parse(n.responseText);var i=JSON.parse(r.Result);if(i.gridJson[0].rows.length>0){$w.Author={};for(var a=0;a<i.gridJson[0].rows.length;a++){$w.Author[i.gridJson[0].rows[a].cell[0]]=i.gridJson[0].rows[a].cell[1]}}},getMailBody:function(e){$sb.clear();$sb.append("<HTML><HEAD><TITLE></TITLE></HEAD>");$sb.append("<BODY vLink=#0048ff aLink=#0048ff link=#6666ff leftMargin=0  topMargin=30 marginheight=0 marginwidth=0>");$sb.append("<TABLE cellSpacing=0 cellPadding=0 width=666 align=center border=0>");$sb.append("<TBODY>");$sb.append("<TR>");$sb.append("<TD height=44 width=666></TD></TR>");$sb.append("<TR>");$sb.append("<TD></TD></TR>");$sb.append("<TR>");$sb.append("<TD>");$sb.append("<TABLE cellSpacing=0 cellPadding=0 width=530 align=center border=0>");$sb.append("<TBODY>");$sb.append("<TR>");$sb.append("<TD height=100>");$sb.append("<FONT style=FONT-SIZE: 9pt; PADDING-BOTTOM: 1px; LINE-HEIGHT: 140%;FONT-FAMILY: êµ´ë¦¼, arial, verdana color=#333333 size=2>");$sb.append("<BR>");$sb.append(e);$sb.append("</FONT>");$sb.append("</TD>");$sb.append("</TR>");$sb.append("</TBODY>");$sb.append("</TABLE>");$sb.append("</TD>");$sb.append("</TR>");$sb.append("<TR>");$sb.append("<TD height=40><BR>");$sb.append("</TD>");$sb.append("</TR>");$sb.append("<TR>");$sb.append('<TD style="PADDING-RIGHT: 15px; PADDING-LEFT: 12px; FONT-SIZE: 9pt; PADDING-BOTTOM: 5px; COLOR: gray; PADDING-TOP: 5px; FONT-FAMILY: êµ´ë¦¼ì²´" height=40 align=right>');$sb.append("â»ë³¸ ë©ì¼ì ë°ì  ì ì© ë©ì¼ìëë¤");$sb.append("</TD></TR></TBODY></TABLE></BODY></HTML>");return syn.$sb.toString()},fireResizeEvent:function(e){if(document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("resize",true,false);document.body.dispatchEvent(t)}else if(document.createEventObject){document.body.fireEvent("onresize")}},getDataSource:function(t,e,r){var n=null;if(t){var i=window[syn.$w.pageScript];if(i&&i["config"]){var a=$w.transactionObject("LD01","Json");a.ProgramID="SYN";a.BusinessID="SMP";a.SystemID="BOP01";a.TransactionID="SMP110";a.ScreenID=$w.pageScript.replace("$","");if(e==null||e==undefined){e=""}var o=/(\@ApplicationID)\s*:/;if(o.test(e)==false){e="@ApplicationID:{0};".format(1)+e}var s=/(\@CompanyNo)\s*:/;if(syn.$w.SSO&&$w.SSO.WorkCompanyNo&&s.test(e)==false){e="@CompanyNo:{0};".format(syn.$w.SSO.WorkCompanyNo)+e}var l=/(\@LocaleID)\s*:/;if(l.test(e)==false){e="@LocaleID:{0};".format(syn.Config.Program.LocaleID)+e}var u=[];u.push({prop:"ApplicationID",val:1});u.push({prop:"CodeHelpID",val:t});u.push({prop:"Parameters",val:e});if(syn.$w.SSO&&$w.SSO.WorkCompanyNo){u.push({prop:"CompanyNo",val:$w.SSO.WorkCompanyNo})}a.Inputs.push(u);a.InputsItemCount.push(1);var f={};f.ProgramID="SYN";f.BusinessID="SMP";f.SystemID="BOP01";f.TransactionID="SMP110";f.ScreenID=$w.pageScript.replace("$","");$w.executeTransaction(f,a,function(e){if(e.length>0){if(r&&e[0].Value&&e[0].Value.CodeColumnID!=null){r(e[0].Value)}else{r(null)}}else{$l.eventLog("getDataSource",'DataSourceID: "{0}" ë°ì´í° ìì'.format(t))}})}else{$l.eventLog("getDataSource","Qrame íë©´ììë§ í¸ì¶ ê°ë¥","Error")}}},sendAlarmTalk:function(e,t,r,n){var i={ProgramID:"SYN",BusinessID:"KKO",SystemID:"BP01",TransactionID:"KKO010",FunctionID:"IF01",DataTransactionInterface:"Row|Form",InputObjects:[{prop:"USER_ID",val:$w.AppInfo.getWorkConcurrentValue(syn.$w.SSO.WorkCompanyNo,"User")||$w.SSO.UserNo},{prop:"PHONE_NO",val:e},{prop:"MESSAGE_CONTENT",val:t},{prop:"MESSAGE_TEMPLATE_ID",val:r}]};$w.transactionDirect(i,function(e){var t=null;var r=null;if(e&&e.length>0){t=e[0].Value;if($string.isNullOrEmpty(t.ErrorMessage)==false){r=t.ErrorMessage;$l.eventLog("sendAlarmTalk","ìë¦¼í¡ ë°ì¡ ì¤ë¥, ErrorMessage: {0}".format(t.ErrorMessage),"Error")}}else{r="ìë¦¼í¡ ë°ì¡ ì¤ë¥";$l.eventLog("sendAlarmTalk","ìë¦¼í¡ ë°ì¡ ì¤ë¥, directObject: {0}".format(JSON.stringify(i)),"Error")}if(n){n(r,t)}})},sendMattermostPost:function(e,t,r,n){if($string.isNullOrEmpty(e)==false&&$string.isNullOrEmpty(t)==false&&$object.isNullOrUndefined(n)==false){var i=$w.AppInfo.getWorkConcurrentValue(e,"User");var a=$w.AppInfo.COMPANYCONFIG.find(function(e){return e.CODE=="MTM000"});if($object.isNullOrUndefined(a)==false&&a.VALUE4=="Y"&&$object.isNullOrUndefined(n.emailID)==false){var o=new FormData;o.append("companyNo",e);o.append("userNo",i);o.append("templateCode",t);o.append("emailID",n.emailID);o.append("parameters",$object.isNullOrUndefined(r)==true?"":JSON.stringify(r));$r.httpDataSubmit(o,"/api/MessageSender/SendMattermostPost")}}},sendAlarmMessage:function(e,t,r,n){if($string.isNullOrEmpty(e)==false&&$string.isNullOrEmpty(t)==false&&$object.isNullOrUndefined(n)==false){var i=$w.AppInfo.getWorkConcurrentValue(e,"User");var a=$w.AppInfo.COMPANYCONFIG.find(function(e){return e.CODE=="ART000"});if($object.isNullOrUndefined(a)==false&&a.VALUE4=="Y"&&$object.isNullOrUndefined(n.phoneNo)==false){var o=new FormData;o.append("companyNo",e);o.append("userNo",i);o.append("templateCode",t);o.append("phoneNo",n.phoneNo);o.append("parameters",$object.isNullOrUndefined(r)==true?"":JSON.stringify(r));$r.httpDataSubmit(o,"/api/MessageSender/SendAlarmTalk")}var s=$w.AppInfo.COMPANYCONFIG.find(function(e){return e.CODE=="MTM000"});if($object.isNullOrUndefined(s)==false&&s.VALUE4=="Y"&&$object.isNullOrUndefined(n.emailID)==false){var o=new FormData;o.append("companyNo",e);o.append("userNo",i);o.append("templateCode",t);o.append("emailID",n.emailID);o.append("parameters",$object.isNullOrUndefined(r)==true?"":JSON.stringify(r));$r.httpDataSubmit(o,"/api/MessageSender/SendMattermostPost")}}},documentMeta:function(e,t,r,n){if($object.isNullOrUndefined(e)==false&&$object.isNullOrUndefined(t)==false&&$object.isNullOrUndefined(r)==false&&(window==top||window.parent.$w.pageScript=="$MainFrame")){var i={ProgramID:"SYN",BusinessID:"CMM",TransactionID:"CMM070",FunctionID:"GD01",DataTransactionInterface:"Row|Form",InputObjects:[{prop:"COMPANY_NO",val:e},{prop:"CATEGORY_NO",val:t},{prop:"DOCUMENT_NO",val:r}]};$w.transactionDirect(i,function(e){if(e&&e.length>0){var t=e[0].Value;if(n){n(t)}else{$l.eventLog("documentMeta",JSON.stringify(t),"Debug")}}else{$w.alert("ë¬¸ì ë©í ì ë³´ë¥¼ ì¡°í í  ì ììµëë¤")}})}else{$w.alert("íì í­ëª© íì¸ íì")}},openReport:function(e,t,r){if(e){if(t==null||t==undefined){t={strDummy:"X"}}t=$w.argumentsExtend({strQueryID:e},t);var n=r?r:"http://pdf.qcnservice.co.kr/EPrint.aspx";if(n.indexOf("?")>-1){n=n+$r.toQueryString(t)}else{n=n+"?"+$r.toQueryString(t).substring(1)}if(syn.Config&&syn.Config.Environment){n=n+"&strENV="+syn.Config.Environment.substring(0,1)}window.open(n,t.strQueryID)}else{$w.alert("ë í¬í¸ ìì²­ ì ë³´ íì¸ íì")}},codeCacheClear:function(e){e=$w.argumentsExtend({url:null,callback:null},e);var t=null;if($string.isNullOrEmpty(e.url)==true){var r=syn.Config.DomainAPIServer;if(r.Port&&r.Port!=""){t="{0}://{1}:{2}{3}".format(r.Protocol,r.IP,r.Port,r.Path)}else{t="{0}://{1}{3}".format(r.Protocol,r.IP,r.Path)}t=t+"/CacheClear"}else{t=e.url}var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(n.status===200){if(e.callback){e.callback(n.responseText)}}else{$l.eventLog("$w.getCacheClearUrl","async url: "+t+", status: "+n.status.toString()+", responseText: "+n.responseText,"Error")}}};n.open("GET",t,true);n.send()}})})($webform||window.$webform);(function(e){var r=new syn.module;r.extend({serviceUrl:"/RESTFul/TimeLogger/",recordTimeID:$l.guid(),recordPosition:"UI",recordStartTime:$date.toTicks(new Date),recordEndTime:"",isLoggingResetTime:false,entryLog:{typeName:"",comment:"",machineName:"",osVersion:"",methodName:""},Init:function(e,t){r.recordTimeID=e?e:$l.guid();r.startDateTicks=t?t:$date.toTicks(new Date);r.endDateTicks=""},recordSave:function(e,t){var r=$l.get("moduleScript")?$l.get("moduleScript").value:"Untitle ModuleType";var n=$r.getCookie("isPerformanceLog");if(n==="true"||$w.isPerformanceLog){}}});e.$timeTracker=e.$timeTracker||r})(window);(function(e){var t=t||e.$validation||new syn.module;var r=e.document;t.extend({version:"1.0",focusElement:null,isContinue:true,clear:function(){var e=$l.querySelectorAll(".need");for(var t=0;t<e.length;t++){$m.removeClass(e[t],"need")}e=null;return this},validateControl:function(e){var t=true;var r=false;if(e.value.length>0){r=true;$m.removeClass(e,"need")}else{r=false;t=false;if(syn.$w.hasClass(e,"need")==false){$m.addClass(e,"need")}if(!this.focusElement){this.focusElement=e}if(this.isContinue==false){return t}}r=null;try{return t}finally{t=null}},validateControls:function(e){var t=true;var r=true;var n=null;if(!e){e=$l.querySelectorAll(".required")}if(e.type){n=e;t=this.validateControl(n)}else if(e.length){for(var i=0;i<e.length;i++){n=e[i];r=this.validateControl(n);if(r==false){t=false}}}n=null;r=null;try{return t}finally{t=null}},transactionValidate:function(e,t,r,n){if((t.module=="syn.uicontrols.$button"||t.module=="syn.uicontrols.$textbox"||t.module=="syn.uicontrols.$radio"||t.module=="syn.uicontrols.$select"||t.module=="syn.uicontrols.$multiselect"||t.module=="syn.uicontrols.$codepicker"||t.module=="syn.uicontrols.$colorpicker"||t.module=="syn.uicontrols.$datepicker"||t.module=="syn.uicontrols.$editor"||t.module=="syn.uicontrols.$jsoneditor"||t.module=="syn.uicontrols.$htmleditor"||t.module=="syn.uicontrols.$sourceeditor"||t.module=="syn.uicontrols.$files")&&r.validators&&r.validators.length>0){var i=function(e){$w.alert(e,null,null,function(){$l.get(t.id).focus()});$w.statusMessage(e);if($progressBar.isProgress==true){$progressBar.close()}return false};var a=r.controlText;var o=e.getValue(t.id);if(r.validators.indexOf("require")>-1){if(o==""||o==null){var s="{0} í­ëª©ì ë°ëì ìë ¥ í´ì¼í©ëë¤".format(a);return i(s)}if(r.validators.indexOf("numeric")>-1){if(isNaN(o)==true){var s="{0} í­ëª©ì ì«ìê°ë§ ìë ¥í  ì ììµëë¤".format(a);return i(s)}}if(r.validators.indexOf("ipaddress")>-1){if(regexs.ipaddress.test(o)==false){var s="{0} í­ëª©ì IP ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a);return i(s)}}if(r.validators.indexOf("email")>-1){if(regexs.email.test(o)==false){var s="{0} í­ëª©ì ì´ë©ì¼ ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a);return i(s)}}if(r.validators.indexOf("date")>-1){var l=true;if(regexs.date.test(o)==false){l=false}var u=new Date(o);var f=u.getTime();if(!f&&f!==0){l=false}l=u.toISOString().slice(0,10)===o;if(l==false){var s='{0} í­ëª©ì "YYYY-MM-DD" íìì ì¬ë°ë¥¸ ì¼ìë§ ìë ¥í  ì ììµëë¤'.format(a);return i(s)}}if(r.validators.indexOf("url")>-1){if(regexs.url.test(o)==false){var s="{0} í­ëª©ì ì¹ URL ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a);return i(s)}}}}else if(t.module=="syn.uicontrols.$grid"&&n=="Row"&&r.validators&&r.validators.length>0){var i=function(e){$w.alert(e);$w.statusMessage(e);if($progressBar.isProgress==true){$progressBar.close()}return false};var a=r.controlText;var c=e.getColHeader(t.id,e.propToCol(t.id,r.data));var d=e.getActiveRowIndex(t.id);var h=e.propToCol(t.id,r.data);var v=e.getDataAtCell(t.id,d,"Flag");if(v!="D"){return true}else{var o=e.getDataAtCell(t.id,d,h);if(r.validators.indexOf("require")>-1){if(o===""||o==null){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ë°ëì ìë ¥ í´ì¼ìëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("numeric")>-1){if(isNaN(o)==true){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì«ìê°ë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("ipaddress")>-1){if(regexs.ipaddress.test(o)==false){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì IP ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("email")>-1){if(regexs.email.test(o)==false){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì´ë©ì¼ ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("date")>-1){var l=true;if(regexs.date.test(o)==false){l=false}var u=new Date(o);var f=u.getTime();if(!f&&f!==0){l=false}l=u.toISOString().slice(0,10)===o;if(l==false){var s='{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì "YYYY-MM-DD" íìì ì¬ë°ë¥¸ ì¼ìë§ ìë ¥í  ì ììµëë¤'.format(a,c);return i(s)}}if(r.validators.indexOf("url")>-1){if(regexs.url.test(o)==false){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì¹ URL ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}}}else if(t.module=="syn.uicontrols.$grid"&&n=="List"&&r.validators&&r.validators.length>0){var i=function(e){$w.alert(e);$w.statusMessage(e);if($progressBar.isProgress==true){$progressBar.close()}return false};var a=r.controlText;var c=e.getColHeader(t.id,e.propToCol(t.id,r.data));var p=e.getSourceDataAtCol(t.id,"Flag");var g=e.getSourceDataAtCol(t.id,r.data);var m=[];var y=p.length;for(var b=0;b<y;b++){if(p[b]!="D"){m.push(g[b])}}if(r.validators.indexOf("require")>-1){if(m.filter(function(e){return e===""||e==null}).length>0){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ë°ëì ìë ¥ í´ì¼ìëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("unique")>-1){if(m.filter(function(e,t){return m.indexOf(e)!==t}).length>0){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì¤ë³µê°ì ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("numeric")>-1){if(m.filter(function(e){return isNaN(e)}).length>0){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì«ìê°ë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("ipaddress")>-1){if(m.filter(function(e){return!regexs.ipaddress.test(e)}).length>0){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì IP ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("email")>-1){if(m.filter(function(e){return!regexs.email.test(e)}).length>0){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì´ë©ì¼ ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}if(r.validators.indexOf("date")>-1){if(m.filter(function(e){if(regexs.date.test(e)==false){return true}var t=new Date(e);var r=t.getTime();if(!r&&r!==0){return true}return!(t.toISOString().slice(0,10)===e)}).length>0){var s='{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì "YYYY-MM-DD" íìì ì¬ë°ë¥¸ ì¼ìë§ ìë ¥í  ì ììµëë¤'.format(a,c);return i(s)}}if(r.validators.indexOf("url")>-1){if(m.filter(function(e){return!regexs.url.test(e)}).length>0){var s="{0} ê·¸ë¦¬ëì {1} ì»¬ë¼ì ì¹ URL ì£¼ìë§ ìë ¥í  ì ììµëë¤".format(a,c);return i(s)}}}return true}});e.$validation=e.$v=syn.$v=e.$validation||t})(window);function domainLibraryLoad(){if($reflection.isBoolean(syn.Config.IsClientCaching)==true){$r.setCookie("syn.iscache",syn.Config.IsClientCaching,null,"/")}if(syn.Config.IsDebugMode==false){}if(window["controlInit"]){controlInit()}if(syn.$w.getStorage("member")==null&&$r.getCookie("EasyWork.Member")){var e=$r.getCookie("EasyWork.Member");$w.setStorage("member",e,false)}if(syn.$w.getStorage("addtional")==null&&$r.getCookie("EasyWork.Addtional")){var t=$r.getCookie("EasyWork.Addtional");$w.setStorage("addtional",t,false)}if(syn.$w.getStorage("bearerToken")==null&&$r.getCookie("EasyWork.BearerToken")){var r=$r.getCookie("EasyWork.BearerToken");$w.setStorage("bearerToken",r,false)}window.bearerToken=null;if(syn.$r.getCookie("EasyWork.BearerToken")){window.bearerToken=$r.getCookie("EasyWork.BearerToken")}$w.SSO=$w.getSSOInfo()||{TokenID:"",UserID:"",UserName:"",BusinessTel:"",BusinessEMail:"",DepartmentID:"",DepartmentName:"",PositionID:"",PositionName:"",CompanyNo:"",CompanyName:"",Roles:[]};$w.SSO.WorkCompanyNo=$r.query("companyNo")||$r.query("CompanyNo")||$r.query("companyNO")||$r.query("CompanyNO")||$r.query("COMPANYNO")||$r.query("companyno")||$w.SSO.CompanyNo;$w.SSO.WorkUserNo=$r.query("employeeNo")||$r.query("EmployeeNo")||$r.query("employeeNO")||$r.query("EmployeeNO")||$r.query("EMPLOYEENO")||$r.query("employeeno")||null;$w.AppInfo=$w.getAppInfo()||{};$w.AppInfo.config=syn.Config.IsViewMappingModel;var n=window[syn.$w.pageScript];if(n&&n["pageInit"]){n["pageInit"]();if(syn.$w.AppInfo.config==false){n["config"]={ProgramID:"SYN",BusinessID:"DSO",SystemID:"MSPDSO01",TransactionID:"0000",ModifiedDate:"2099-01-01 00:00:00",DataSource:{},Transactions:[]}}}var i=document.createElement("div");i.id="ui_progressbar";$m.addClass(i,"ui_progressbar");var a=document.createElement("div");$m.addClass(a,"overlay");var o=document.createElement("span");$m.addClass(o,"progressBar");var s=document.createElement("span");$m.addClass(s,"loading");var l=document.createElement("span");$m.addClass(l,"message");i.appendChild(a);i.appendChild(o);o.appendChild(s);o.appendChild(l);document.body.appendChild(i);if(parent.$res){$res=parent.$res}var u=$l.get("SessionTokenDestroyed");if(u){if(parent.$MainFrame&&!window.$MainFrame){return;parent.$MainFrame.isConnectedSession()}}$k.setElement(document);if(window===parent&&parent.$MainFrame){$k.addKeyDown("121",frameKeyEventHandler);$k.addKeyDown("13",frameKeyEventHandler);$k.addKeyDown("27",frameKeyEventHandler);$k.addKeyDown("9",frameKeyEventHandler);$k.addKeyDown("8",frameKeyEventHandler);$k.addKeyDown("37",frameKeyEventHandler);$k.addKeyDown("38",frameKeyEventHandler);$k.addKeyDown("39",frameKeyEventHandler);$k.addKeyDown("40",frameKeyEventHandler)}if(window!==parent&&(parent.$MainFrame||$string.isNullOrEmpty(syn.$r.query("baseELID"))==false)){$k.addKeyDown("88",uiKeyEventHandler);$k.addKeyDown("37",uiKeyEventHandler);$k.addKeyDown("38",uiKeyEventHandler);$k.addKeyDown("39",uiKeyEventHandler);$k.addKeyDown("40",uiKeyEventHandler)}$k.addKeyDown("68",uiKeyEventHandler);$k.addKeyDown("70",uiKeyEventHandler);$k.addKeyDown("83",uiKeyEventHandler);$k.addKeyDown("80",uiKeyEventHandler);$k.addKeyDown("69",uiKeyEventHandler);$k.addKeyDown("13",uiKeyEventHandler);$k.addKeyDown("27",uiKeyEventHandler);$k.addKeyDown("9",uiKeyEventHandler);$k.addKeyDown("8",uiKeyEventHandler);var f=null;var c=$w.getStorage("apiServices",false);if(c){f=c[syn.Config.SystemID+syn.Config.DomainServerType];if((c.BearerToken==null||c.BearerToken==undefined)&&window.bearerToken){c.BearerToken=window.bearerToken;$w.setStorage("apiServices",c,false)}}else{if(syn.Config.DomainAPIServer!=null){f=syn.Config.DomainAPIServer;c={};if(window.bearerToken){c.BearerToken=window.bearerToken}c[syn.Config.SystemID+syn.Config.DomainServerType]=f;$w.setStorage("apiServices",c,false)}}if(f==null){var d=$w.xmlHttp();d.open("GET",syn.Config.ApiFindUrl+"?systemID={0}&serverType={1}".format(syn.Config.SystemID,syn.Config.DomainServerType),true);d.setRequestHeader("Accept-Language",$w.localeID);d.setRequestHeader("X-Requested-With","QAF ServiceClient");d.setRequestHeader("content-type","application/json");d.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var e=JSON.parse(d.responseText);if(e.ExceptionText){$l.eventLog("apiFind","SystemID: {0}, ServerType: {1}, Message: {2}".format(syn.Config.SystemID,syn.Config.DomainServerType,e.ExceptionText),"Verbose")}else{c={};if(window.bearerToken){c.BearerToken=window.bearerToken}c[syn.Config.SystemID+syn.Config.DomainServerType]=e;$w.setStorage("apiServices",c,false);$l.eventLog("apiFind","systemApi: {0}".format(JSON.stringify(e)),"Verbose")}}};d.send()}else{$l.eventLog("apiFind","systemApi: {0}".format(JSON.stringify(f)),"Verbose")}}function domainPageLoad(){var e=$l.get("pageLoader");if(e){e.parentNode.removeChild(e)}if(document.forms){for(var t=0;t<document.forms.length;t++){var r=document.forms[t];if(r.style.display.toUpperCase()=="NONE"&&$string.toBoolean(r.getAttribute("hidden"))==false){r.style.display=""}}}var n=window[syn.$w.pageScript];if(n&&n["$grid"]){for(var t=0;t<n.$grid.gridControls.length;t++){n.$grid.gridControls[t].hot.render()}}}function frameKeyEventHandler(){if(keyboardEvent&&documentEvent&&keyboardEvent===documentEvent){var e=documentEvent.target||documentEvent.srcElement||null;switch(documentEvent.keyCode){case 13:return true;break;case 9:return true;break;case 27:if(keyboardEvent&&keyboardEvent.view&&keyboardEvent.view.$w){if(keyboardEvent.view.$w.transactionLoaderID==null){var t=keyboardEvent.view;var e=t.$w.activeControl();if(e&&t.syn&&t.syn.uicontrols){if(e.id){var r=t.syn.uicontrols.$colorpicker.getControl(e.id);if(r){if(r.picker.visible==true){r.picker.exit()}}var n=syn.uicontrols.$datepicker.getControl(e.id);if(n){if(n.picker.isVisible()==true){n.picker.hide()}}}}if(t.$w.isShowDialog==true){t.$w.closeDialog();return false}if(t.parent.$w.isShowDialog==true){t.parent.$w.closeDialog();return false}if(t.$w.iframeChannels){var i=t.$w.iframeChannels;var a=i.length;if(a==0){for(var o=0;o<10;o++){t=t.parent;i=t.$w.iframeChannels;a=i.length;if(a>0){break}}}if(a>0){var s=t.$w.iframeChannels[a-1];var l=s.windowHandle.find(".horizbuts").length>0&&s.windowHandle.find(".horizbuts")[0].style.display!="none";if(l==true){var u=t.$w.iframeChannels[a-1].elID;if(a>1){var f=t.$w.iframeChannels[a-2].elID;t.$("#"+f).WM_raise()}t.$w.windowClose(u)}}}}}break;case 37:case 38:case 39:case 40:if(documentEvent.ctrlKey==true&&documentEvent.shiftKey==true){var c=null;if(documentEvent.keyCode==37){c="prev"}else if(documentEvent.keyCode==38){c="first"}else if(documentEvent.keyCode==39){c="next"}else if(documentEvent.keyCode==40){c="last"}if(c){$layout.moveTabUI(c)}}break;case 121:if(documentEvent.ctrlKey==true&&documentEvent.shiftKey==true){var d=$reflection.clone(syn.$w.alertOptions);d.minWidth=600;d.stack=JSON.stringify(syn.$w.SSO);$w.alert("ë¡ê·¸ì¸ ì¬ì©ì ì ë³´","ì ë³´",d)}break;case 8:if(e!=null){var h=e.tagName;if(h){h=h.toUpperCase();if(h=="INPUT"){return true}}}}return false}}function uiKeyEventHandler(){var t=null;if(keyboardEvent&&documentEvent&&keyboardEvent===documentEvent){parent.keyboardEvent=keyboardEvent;parent.documentEvent=documentEvent;var a=window[syn.$w.pageScript];if($number.isRange(documentEvent.keyCode,49,57)==true){t=parent.$MainFrame.numericUITrigger}else{switch(documentEvent.keyCode){case 68:case 70:case 83:case 80:case 69:if(parent&&parent.$MainFrame){t=parent.$MainFrame.shortcutUITrigger}else{if(syn.$w.transactionLoaderID==null&&documentEvent.ctrlKey==true&&documentEvent.shiftKey==false&&documentEvent.altKey==true){var r=null;switch(documentEvent.keyCode){case 68:r="delete";break;case 69:r="export";break;case 70:r="search";break;case 83:r="save";break;case 80:r="print";break}if(r){var a=window[syn.$w.pageScript];if(a&&a["frameEvent"]){a.frameEvent("buttonCommand",{actionID:r})}}}}break;case 88:if(parent&&parent.$MainFrame){if(syn.$w.transactionLoaderID==null&&documentEvent.ctrlKey==true&&documentEvent.shiftKey==true){var n=parent.$layout.getActiveTab();if(n){parent.$layout.closeTabID(n.tabID)}}}break;case 37:case 38:case 39:case 40:if(parent&&parent.$MainFrame&&documentEvent.ctrlKey==true&&documentEvent.shiftKey==true){var r=null;if(documentEvent.keyCode==37){r="prev"}else if(documentEvent.keyCode==38){r="first"}else if(documentEvent.keyCode==39){r="next"}else if(documentEvent.keyCode==40){r="last"}if(r){parent.$layout.moveTabUI(r)}}break;case 13:if(syn.$w.transactionLoaderID==null){var i=$w.activeControl();if(i&&i.tagName){var o=i.tagName.toUpperCase();if(o=="INPUT"||o=="SELECT"||o=="TEXTAREA"||o=="BUTTON"){return true}}}return false;break;case 9:if(syn.$w.transactionLoaderID==null&&a.tabOrderControls){var s=a.tabOrderControls.filter(function(e){var t=false;var r=$l.get(e.elID);if(r&&r.tagName.toUpperCase()=="SELECT"&&r.getAttribute("syn-datafield")!=null){var n=r.getAttribute("multiple");if(n==null||n===false){var i=a.$select.getControl(r.id)}else{var i=a.$multiselect.getControl(r.id)}if(i){t=$m.hasHidden(i.picker.select)==false}}else{t=$m.hasHidden(e.elID)==false}return t});if(s&&s.length>0){if(a.tabOrderFocusID==null){a.tabOrderFocusID=s[0].elID}var l=s.find(function(e){return e.elID==a.tabOrderFocusID});if(l!=null){var u=s.indexOf(l);if(u<s.length){u=u+1;if(u==s.length){u=0}}else{u=0}var f=null;var c=s[u];var i=$l.get(c.elID);if(i&&i.tagName.toUpperCase()=="SELECT"&&i.getAttribute("syn-datafield")!=null){var d=i.getAttribute("multiple");if(d==null||d===false){var h=a.$select.getControl(i.id)}else{var h=a.$multiselect.getControl(i.id)}if(h){f=h.picker.select}a.focusControl=i}else{f=i;a.focusControl=f}if(f){a.tabOrderFocusID=c.elID;setTimeout(function(){f.focus()})}}}return false}break;case 27:if(syn.$w.transactionLoaderID==null){var i=$w.activeControl();if(i&&syn&&syn.uicontrols){if(i.id){var v=syn.uicontrols.$colorpicker.getControl(i.id);if(v){if(v.picker.visible==true){v.picker.exit();return false}}var p=syn.uicontrols.$datepicker.getControl(i.id);if(p){if(p.picker.isVisible()==true){p.picker.hide();return false}}}}if(syn.$w.isShowDialog==true){$w.closeDialog();return false}if(parent.$w.isShowDialog==true){parent.$w.closeDialog();return false}var g=$w.context;var m=g.$w.iframeChannels;var y=m.length;if(y==0){for(var b=0;b<5;b++){g=g.parent;m=g.$w.iframeChannels;y=m.length;if(y>0){break}}}if(y>0){var w=g.$w.iframeChannels[y-1];if(w&&w.windowHandle){var C=w.windowHandle.find(".horizbuts").length>0&&w.windowHandle.find(".horizbuts")[0].style.display!="none";if(C==true){var S=w.elID;if(y>1){var E=g.$w.iframeChannels[y-2].elID;g.$("#"+E).WM_raise()}g.$w.windowClose(S)}}return false}}break;case 8:var k=event||e;var i=k.srcElement||k.target;var o=i.tagName;if(o){o=o.toUpperCase();if(o=="INPUT"||o=="TEXTAREA"||o=="IFRAME"){}else{return false}}}}}try{if(t){return t()}return true}catch(e){$l.eventLog("uiKeyEventHandler",e,"Error");return false}}(function(window){syn.uicontrols=syn.uicontrols||new syn.module;var $bfile=syn.uicontrols.$bfile||new syn.module;$bfile.extend({name:"syn.uicontrols.$bfile",version:"1.0",setting:{},clientID:"",fileUploadOptions:null,isLoad:false,defaultSetting:{elementID:null,repositoryID:"",dependencyID:"",fileUpdateCallback:"$bfile.doUpload_Callback",uploadCount:8,uploadExtensions:"*/*",uploadDependencyID:null,readonly:false},controlLoad:function(elID,setting){var el=$l.get(elID);$bfile.setting=$w.argumentsExtend($bfile.defaultSetting,setting);$bfile.setting.elementID=elID;$bfile.clientID=setting.clientID;var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,$bfile.setting);$bfile.setting=$w.argumentsExtend($bfile.setting,moduleSettings)}$bfile.setting.elID=elID;$bfile.fileUploadOptions=$w.argumentsExtend($bfile.defaultSetting,setting);$bfile.fileUploadOptions.elementID=$bfile.clientID;$bfile.fileUploadOptions.elID=$bfile.clientID;var el=$l.get($bfile.setting.elementID);el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify($bfile.setting));el.style.display="none";var dataFieldID=el.getAttribute("syn-datafield");var events=el.getAttribute("syn-events");var value=el.value?el.value:"";var name=el.name?el.name:"";var html="";if(events){html='<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}" syn-options="{4}" syn-events={5}>'.format(elID,name,dataFieldID,value,JSON.stringify($bfile.setting),"['"+eval(events).join("','")+"']")}else{html='<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}" syn-options="{4}">'.format(elID,name,dataFieldID,value,JSON.stringify($bfile.setting))}html+='<div class="buttonWrap" style="position: relative;border-top:0;">';html+='<h3 style="position: absolute;top:35px;margin-left:5px;margin-top:-6px;">';html+='ì²¨ë¶íì¼( <data id="bFileCount">0</data> / '+$bfile.setting.uploadCount+" )";html+="</h3 >";if($bfile.setting.readonly!=true){html+='<h4 style = "position:absolute;top:35px;margin-left:5px;margin-top:-6px;font-weight:600">';html+="ê° ì²¨ë¶íì¼ ë¹ ìµë 120MBê¹ì§ ìë¡ë ê°ë¥ í©ëë¤.";html+="</h4 >";html+='<button type="button" id="btnBFileUpload" class="txtBtn" >íì¼ì¶ê°</button>'}html+="</div >";html+='<div class="fileInfo" style="min-height:55px;">';html+='<ul id="divFileInfos" style="height:55px;overflow:scroll;">';html+="</ul>";html+="</div>";html+='<div id="'+$bfile.setting.elementID+'_ui_hiddden" style="display:none;">';html+="</div>";var parent=el.parentNode;var wrapper=document.createElement("div");wrapper.innerHTML=html;parent.appendChild(wrapper);setTimeout(function(){$bfile.clientInit()},100)},clientInit:function(){var e=syn.uicontrols.$fileclient.getFileSetting($bfile.fileUploadOptions.elementID);if(!e){setTimeout(function(){$bfile.clientInit()},100);return}$bfile.fileUploadOptions.repositoryID=e.repositoryID;e=$w.argumentsExtend(e,$bfile.fileUploadOptions);syn.uicontrols.$fileclient.init($bfile.fileUploadOptions.elementID,$l.get($bfile.setting.elementID+"_ui_hiddden"),e,$bfile.fileChangeHandler);if(document.forms.length>0){var t=document.forms[0];if(syn.$l.get("syn-repository")==null){var r=$m.append(t,"iframe","syn-repository",{display:"none"});r.name="syn-repository"}t.enctype="multipart/form-data";t.target="syn-repository";t.method="post";t.action=syn.Config.FileManagerServer+"/api/filemanager"}if($bfile.setting.readonly!=true){$l.addEvent(syn.$l.get("btnBFileUpload"),"click",function(e){$bfile.btnBFileUpload_click()});$bfile.initUploadUI()}},addUI:function(){if($bfile.setting.readonly==true){return}var e=syn.uicontrols.$fileclient.getFileSetting($bfile.fileUploadOptions.elementID);syn.uicontrols.$fileclient.addFileUI(e.elementID,e.accept)},btnBFileUpload_click:function(){var e=$l.get($bfile.setting.clientID+"_filesName_1");if(e){e.click()}},getValue:function(e,t){var r="";var n=$l.get(e);return r},setValue:function(e,t,r){var n=$l.get(e)},delete:function(e){var t=syn.uicontrols.$fileclient.getDependencyID(e);syn.uicontrols.$fileclient.deleteItems(e,t,function(e){$l.eventLog("file delete",JSON.stringify(e))})},clear:function(e,t){var r=$l.get(e)},fileChangeHandler:function(e,t){var r=syn.uicontrols.$fileclient.getFileSetting($bfile.fileUploadOptions.elementID);syn.uicontrols.$fileclient.doUpload($bfile.fileUploadOptions.elementID,r)},doUpload_Callback:function(e,t){$bfile.fileUploadUI()},setDependencyID:function(e){if($string.isNullOrEmpty(e)==true){$bfile.fileUploadUI();return}var t=syn.uicontrols.$fileclient.getDependencyID($bfile.fileUploadOptions.elementID);if(t==e)return;if($string.isNullOrEmpty(t)==true){setTimeout(function(){$bfile.setDependencyID(e)},200);return}syn.uicontrols.$fileclient.setDependencyID($bfile.fileUploadOptions.elementID,e);$bfile.fileUploadUI()},updateDependencyID:function(t){if($string.isNullOrEmpty(t)==true){$bfile.fileUploadUI();return}var e=syn.uicontrols.$fileclient.getDependencyID($bfile.fileUploadOptions.elementID);if(e==t)return;if($string.isNullOrEmpty(e)==true){setTimeout(function(){$bfile.updateDependencyID(t)},200);return}syn.uicontrols.$fileclient.updateDependencyID($bfile.fileUploadOptions.elementID,e,t,function(e){syn.uicontrols.$fileclient.setDependencyID($bfile.fileUploadOptions.elementID,t)})},fileUploadUI:function(){var e=syn.uicontrols.$fileclient.getFileSetting($bfile.fileUploadOptions.elementID);if(e==null){setTimeout(function(){$bfile.fileUploadUI()},100);return}$l.get("divFileInfos").innerHTML="";$l.get("bFileCount").innerHTML="0";$l.get($bfile.setting.elementID+"_ui_hiddden").innerHTML="";var t=syn.uicontrols.$fileclient.getDependencyID($bfile.fileUploadOptions.elementID);syn.uicontrols.$fileclient.getItems(e.elementID,t,function(e){$l.get("bFileCount").innerHTML=e.length;if($bfile.setting.uploadCount>e.length){$bfile.addUI()}if(e.length>0){for(var t=0;t<e.length;t++){repositoryItem=e[t];var r=$m.append(syn.$l.get("divFileInfos"),"li",repositoryItem.ItemID);var n=$m.append(r,"a",repositoryItem.ItemID+"_link");n.href="javascript: void(0)";n.downloadPath=repositoryItem.AbsolutePath;n.download=repositoryItem.FileName;$l.addEvent(n,"click",function(){var e=this.downloadPath;var t=this.download;$r.blobUrlToData(e,function(e){$r.blobToDownload(e,t)});return false});n.innerHTML='<i class="ri-attachment-2 grid_icon"></i>'+repositoryItem.FileName;if($bfile.setting.readonly!=true){var i=$m.append(r,"span",repositoryItem.ItemID+"_span");$l.addEvent(i,"click",$bfile.btnAttachFileDelete_click);i.innerText="ì­ì ";i.item=repositoryItem}}}})},initUploadUI:function(){$l.get("divFileInfos").innerHTML="";$l.get("bFileCount").innerHTML="0";$l.get($bfile.setting.elementID+"_ui_hiddden").innerHTML="";$bfile.addUI()},btnAttachFileDelete_click:function(i){var e=$reflection.clone(syn.$w.alertOptions);e.dialogIcon="2";e.dialogButtons="3";$w.alert($res.removeConfirm,$res.delete,e,function(e){if(e=="Yes"){var t=i.target||i;var r=$l.get(t.item.ItemID);var n=t.item.ItemID;if(n){syn.uicontrols.$fileclient.deleteItem($bfile.fileUploadOptions.elementID,n,function(e){if(e.Result==true){$bfile.initUploadUI();$bfile.fileUploadUI()}else{$w.alert(e.Message,"ê²½ê³ ")}})}}})}});syn.uicontrols.$bfile=$bfile})(window);(function(l){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var b=syn.uicontrols.$chartjs||new syn.module;if(l.Chart){Chart.defaults.global.defaultFontColor="#666";Chart.defaults.global.defaultFontFamily="Noto Sans KR, 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif";Chart.defaults.global.defaultFontSize=12;Chart.defaults.global.defaultFontStyle="normal";Chart.defaults.global.legend.position="bottom";Chart.defaults.global.legend.align="start";Chart.defaults.global.legend.onClick=function(e,t){var r=e.target||e.srcElement;var n=b.getChartControl(r.id);if(n){var i=l[$w.pageScript];var a="{0}_legendClick".format(r.id);if(i&&i[a]){i[a](r.id,n.chart,t)}}};Chart.defaults.global.elements.line.fill=false;Chart.plugins.register({beforeDraw:function(e){var t=e.chart.ctx;t.fillStyle=l.localStorage&&localStorage.getItem("isDarkMode")=="true"?"rgba(0, 0, 0, 0)":"#fff";t.fillRect(0,0,e.chart.width,e.chart.height)}});Chart.defaults.global.defaultTheme={maintainAspectRatio:false,responsiveAnimationDuration:0,showLines:true,layout:{padding:8},legend:{display:true,fontColor:"#ccc"},scales:{xAxes:[{gridLines:{color:"rgba(0, 0, 0, 0.2)",zeroLineColor:"rgba(0, 0, 0, 0.5)"},ticks:{fontColor:"#ccc"}}],yAxes:[{gridLines:{color:"rgba(0, 0, 0, 0.2)",zeroLineColor:"rgba(0, 0, 0, 0.5)"},ticks:{beginAtZero:true,fontColor:"#ccc"}}]},animation:{duration:0},hover:{animationDuration:0,intersect:false},title:{display:false,fontSize:16,text:""},tooltips:{position:"nearest",intersect:false,backgroundColor:"rgba(0, 0, 0, 0.8)",titleFontColor:"#fff",bodyFontColor:"#fff"},plugins:{colorschemes:{scheme:"brewer.Paired12"}}};Chart.defaults.global.darkTheme={maintainAspectRatio:false,responsiveAnimationDuration:0,showLines:true,layout:{padding:8},legend:{display:true,fontColor:"#ccc"},scales:{xAxes:[{gridLines:{color:"rgba(255, 255, 255, 0.2)",zeroLineColor:"rgba(255, 255, 255, 0.5)"},ticks:{fontColor:"#ccc"}}],yAxes:[{gridLines:{color:"rgba(255, 255, 255, 0.2)",zeroLineColor:"rgba(255, 255, 255, 0.5)"},ticks:{beginAtZero:true,fontColor:"#ccc"}}]},animation:{duration:0},hover:{animationDuration:0,intersect:false},title:{display:false,fontSize:16,text:""},tooltips:{position:"nearest",intersect:false,backgroundColor:"rgba(255, 255, 255, 0.8)",titleFontColor:"#000",bodyFontColor:"#000"},plugins:{colorschemes:{scheme:"brewer.Paired12"}}}}b.extend({name:"syn.uicontrols.$chartjs",version:"1.0",chartControls:[],randomSeed:Date.now(),defaultSetting:{labelID:"",series:[],type:"line",data:{},options:null,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){var r=$l.get(e);t=$w.argumentsExtend(b.defaultSetting,t);var n=l.localStorage&&localStorage.getItem("isDarkMode")=="true";if(n==false){t.options=$w.argumentsExtend($ref.clone(Chart.defaults.global.defaultTheme),t.options)}else{t.options=$w.argumentsExtend($ref.clone(Chart.defaults.global.darkTheme),t.options)}var i=l[$w.pageScript];if(i&&i["controlInit"]){var a=i["controlInit"](e,t);t=$w.argumentsExtend(t,a)}if($string.isNullOrEmpty(t.labelID)==true){$l.eventLog("$chartjs.controlLoad","labelID ì ë³´ íì¸ íì","Debug");return}t.width=r.style.width||320;t.height=r.style.height||240;r.setAttribute("id",r.id+"_hidden");r.setAttribute("syn-options",JSON.stringify(t));r.style.display="none";var o=r.parentNode;var s=document.createElement("div");s.style.width=t.width;s.style.height=t.height;s.style.position="relative";s.className="chart-container";s.innerHTML='<canvas id="{0}"></canvas>'.format(e);o.appendChild(s);$l.addEvent(syn.$l.get(e),"click",function(e){var t=e.target||e.srcElement;var r=b.getChartControl(t.id);if(r){var n=r.chart;var i=n.getElementsAtEventForMode(e,"point",r.config);if(i.length>0){var a=i[0];var o=n.data.labels[a._index];var s=n.data.datasets[a._datasetIndex].data[a._index];console.log(o+": "+s)}}});b.chartControls.push({id:e,chart:new Chart(e,t),config:t,value:null});if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},getValue:function(e,t){return""},setValue:function(e,t,r){var n="";var i=b.getChartControl(e);if(i){i.config.data.labels.length=0;i.config.data.datasets.length=0;if(t&&t.length>0){var a=t[0];for(var o in a){var s=false;var l=r[o];if(l){switch(l.DataType.toLowerCase()){case"string":s=a[o]==null||$ref.isString(a[o]);break;case"bool":if(a[o]==null||a[o]=="1"||a[o]=="0"){s=true}else{s=$ref.isBoolean(a[o])}break;case"number":case"int":s=a[o]==null||$string.isNumber(a[o])||$ref.isNumber(a[o]);break;case"date":s=a[o]==null||$ref.isDate(a[o]);break;default:s=false;break}if(s==false){n='ë°ì¸ë© ë°ì´í° íìê³¼ ë§¤í ì ìê° ë¤ë¦, ë°ì¸ë© ID - "{0}", íì - "{1}"'.format(o,l.DataType);break}}else{continue}}if(n==""){var u=[];for(var f in a){if(i.config.labelID!=f){u.push(f)}}var c=t.map(function(e){return e[i.config.labelID]});i.config.data.labels=c;var d=u.length;for(var h=0;h<d;h++){var v=u[h];if(i.config.series&&i.config.series.length>0){var p=i.config.series.find(function(e){return e.columnID==v});if(p){var g=p.label?p.label:p.columnID;var m=t.map(function(e){return e[v]});var y={label:g,data:m,fill:p.fill};i.config.data.datasets.push(y)}}else{var g=v;var m=t.map(function(e){return e[v]});var y={label:g,data:m,fill:false};i.config.data.datasets.push(y)}}}else{$l.eventLog("$chartjs.setValue",n,"Debug")}}i.chart.update()}},randomScalingFactor:function(e,t){e=e===undefined?0:e;t=t===undefined?100:t;return Math.round(b.rand(e,t))},rand:function(e,t){var r=b.randomSeed;e=e===undefined?0:e;t=t===undefined?1:t;b.randomSeed=(r*9301+49297)%233280;return e+b.randomSeed/233280*(t-e)},toImage:function(e,t){var r=b.getChartControl(e);if(r){var n="{0}.png".format(t||e);var i=r.chart.toBase64Image();if(download){download(i,n,"image/png")}else{var a=document.createElement("a");a.href=i;a.download=n;a.click()}}},getChartControl:function(e){var t=null;var r=b.chartControls.length;for(var n=0;n<r;n++){var i=b.chartControls[n];if(i.id==e){t=i;break}}return t},clear:function(e,t){var r=b.getChartControl(e);if(r){r.config.data.labels.length=0;r.config.data.datasets.length=0;r.chart.update()}},setLocale:function(e,t,r,n){}});syn.uicontrols.$chartjs=b})(window);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $checkbox=syn.uicontrols.$checkbox||new syn.module;$checkbox.extend({name:"syn.uicontrols.$checkbox",version:"1.0",defaultSetting:{contents:"",toQafControl:false,disabled:false,checkedValue:"1",uncheckedValue:"0",dataType:"string",belongID:null,getter:false,setter:false,controlText:null,textContent:"",validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($checkbox.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}if(setting.toQafControl==true){el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var dataFieldID=el.getAttribute("syn-datafield");var events=el.getAttribute("syn-events");var value=el.value;var checked=el.checked;var disabled=setting.disabled||el.disabled;var html="";if(events){html='<input class="ui_checkbox" id="{0}" name="{1}" type="checkbox" syn-datafield="{2}" value="{3}" {4} {5} syn-events={6}>'.format(elID,name,dataFieldID,value,checked==true?'checked="checked"':"",disabled==true?'disabled="disabled"':"","['"+eval(events).join("','")+"']")}else{html='<input class="ui_checkbox" id="{0}" name="{1}" type="checkbox" syn-datafield="{2}" value="{3}" {4} {5}>'.format(elID,name,dataFieldID,value,checked==true?'checked="checked"':"",disabled==true?'disabled="disabled"':"")}if($ref.isString(setting.textContent)==true){html=html+'<label class="ml-1" for="{0}">{1}</label>'.format(elID,setting.textContent)}var parent=el.parentNode;var wrapper=$m.create({tag:"span",className:"formControl"});wrapper.innerHTML=html;parent.appendChild(wrapper);$l.get(elID).setAttribute("syn-options",JSON.stringify(setting))}else{el.setAttribute("syn-options",JSON.stringify(setting))}if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e,t){var r=null;var n=$l.get(e);if(n){var i=n.getAttribute("syn-options");if(i){var a=JSON.parse(i);if(a.checkedValue&&a.uncheckedValue){if(n.checked==true){r=a.checkedValue}else{r=a.uncheckedValue}}}else{r=n.checked}}else{r=""}return r},setValue:function(e,t,r){var n=$l.get(e);if(t){t=t.toString().toUpperCase();n.checked=t=="TRUE"||t=="Y"||t=="1"}else{n.checked=false}},toggleValue:function(e){var t=$l.get(e);if(t.checked==false){t.checked=true}else{if(t.checked==true){t.checked=false}}},clear:function(e,t){var r=$l.get(e);r.checked=false},getGroupNames:function(){var e=[];var t=$l.querySelIDectorAll("input[type='checkbox']");for(var r=0;r<t.length;r++){e.push(t[r].name)}return $array.distinct(e)},setLocale:function(e,t,r,n){}});syn.uicontrols.$checkbox=$checkbox})(window);(function(window){"use strict";var $codepicker=$codepicker||new syn.module;$codepicker.extend({name:"syn.uicontrols.$codepicker",version:"1.0",defaultSetting:{dataSourceID:null,storeSourceID:null,local:true,parameters:"",label:"",labelWidth:"",codeElementID:"",codeElementWidth:"50%",textElementID:"",textElementWidth:"50%",required:false,readonly:false,textBelongID:null,textDataFieldID:null,searchValue:"",searchText:"",isMultiSelect:false,isAutoSearch:true,isOnlineData:false,viewType:"",dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n});t.push({id:i+"_Text",formDataFieldID:o,field:r.textDataFieldID,module:syn.uicontrols.$textbox.name,type:"text"})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($codepicker.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";mod[elID+"_Button_click"]=function(){if(event){var e=this&&this.id.indexOf("_Button")>-1?this:event.currentTarget;var n=e.id.replace("_Button","").replace("_Code","").replace("_Text","");var t=JSON.parse(syn.$l.get(n+"_hidden").getAttribute("syn-options"));t.elID=n;t.viewType="form";t.codeElementID=n+"_Code";t.textElementID=n+"_Text";t.searchValue=$l.get(t.codeElementID).value;t.searchText=$l.get(t.textElementID).value;var i=$l.get(t.codeElementID).value;var a=$l.get(t.textElementID).value;syn.uicontrols.$codepicker.find(t,function(e){if(e&&e.length>0){var t=mod[n+"_change"];if(t){t(i,a,e)}}var r=mod["frameEvent"];if(r){r.call(this,"codeReturn",{elID:n,result:e})}})}};mod[elID+"_Code_keydown"]=function(e){var t=event.currentTarget;var r=t.id.replace("_Code","");$l.get(r+"_Text").value="";if(e.keyCode==13){mod[r+"_Button_click"].apply(this,e)}};mod[elID+"_Text_keydown"]=function(e){var t=event.currentTarget;var r=t.id.replace("_Text","");$l.get(r+"_Code").value="";if(e.keyCode==13){mod[r+"_Button_click"].apply(this,e)}};var dataField=el.getAttribute("syn-datafield");var html='<span class="inGroup item" style="width:{0};">'.format(setting.codeElementWidth);if($reflection.isArray(setting.belongID)==true){html=html+'<input type="text" id="{0}_Code" syn-datafield="{1}" class="textBox" syn-options="{editType: \'text\', dataType: \'string\', belongID: {2}}" syn-events="[\'keydown\']" {3} {4} baseID="{5}" />'.format(elID,dataField,"['"+setting.belongID.join("','")+"']",setting.readonly==true?'readonly="readonly"':"",setting.required==true?'required="required"':"",elID)}else{html=html+'<input type="text" id="{0}_Code" syn-datafield="{1}" class="textBox" syn-options="{editType: \'text\', dataType: \'string\', belongID: \'{2}\'}" syn-events="[\'keydown\']" {3} {4} baseID="{5}" />'.format(elID,dataField,setting.belongID,setting.readonly==true?'readonly="readonly"':"",setting.required==true?'required="required"':"",elID)}html=html+'<button type="button" id="{0}_Button" type="button" syn-events="[\'click\']" class="icon-search" {1} baseID="{2}"></button></span>'.format(elID,setting.readonly==true?'disabled="disabled"':"",elID);if(setting.textDataFieldID){if($reflection.isArray(setting.textBelongID)==true){html=html+'<input type="text" id="{0}_Text" style="width:{1}" class="item textBox" syn-datafield="{2}" syn-options="{editType: \'text\', dataType: \'string\', belongID: {3}}" syn-events="[\'keydown\']" {4} {5} baseID="{6}" />'.format(elID,setting.textElementWidth,setting.textDataFieldID,"['"+setting.textBelongID.join("','")+"']",setting.readonly==true?'readonly="readonly"':"",setting.required==true?'required="required"':"",elID)}else{html=html+'<input type="text" id="{0}_Text" style="width:{1}" class="item textBox" syn-datafield="{2}" syn-options="{editType: \'text\', dataType: \'string\', belongID: \'{3}\'}" syn-events="[\'keydown\']" {4} {5} baseID="{6}" />'.format(elID,setting.textElementWidth,setting.textDataFieldID,setting.textBelongID,setting.readonly==true?'readonly="readonly"':"",setting.required==true?'required="required"':"",elID)}}else{if($reflection.isArray(setting.textBelongID)==true){html=html+'<input type="text" id="{0}_Text" style="width:{1}" class="item textBox" syn-options="{editType: \'text\', dataType: \'string\', belongID: {2}}" syn-events="[\'keydown\']" {3} {4} baseID="{5}" />'.format(elID,setting.textElementWidth,"['"+setting.textBelongID.join("','")+"']",setting.readonly==true?'readonly="readonly"':"",setting.required==true?'required="required"':"",elID)}else{html=html+'<input type="text" id="{0}_Text" style="width:{1}" class="item textBox" syn-options="{editType: \'text\', dataType: \'string\', belongID: \'{2}\'}" syn-events="[\'keydown\']" {3} {4} baseID="{5}" />'.format(elID,setting.textElementWidth,setting.textBelongID,setting.readonly==true?'readonly="readonly"':"",setting.required==true?'required="required"':"",elID)}}var parent=el.parentNode;var wrapper=$m.create({tag:"span",id:elID,className:"formControl codePicker"});wrapper.innerHTML=html;parent.appendChild(wrapper);var codeEL=$l.get(elID+"_Code");$l.addEvent(codeEL,"focus",function(e){var t=e.srcElement||e.target;var r=window[syn.$w.pageScript];if(r){r.focusControl=t}});syn.uicontrols.$textbox.controlLoad(codeEL.id,eval("("+codeEL.getAttribute("syn-options")+")"));var textEL=$l.get(elID+"_Text");$l.addEvent(textEL,"focus",function(e){var t=e.srcElement||e.target;var r=window[syn.$w.pageScript];if(r){r.focusControl=t}});syn.uicontrols.$textbox.controlLoad(textEL.id,eval("("+textEL.getAttribute("syn-options")+")"));var buttonEL=$l.get(elID+"_Button");$l.addEvent(buttonEL,"focus",function(e){var t=e.srcElement||e.target;var r=window[syn.$w.pageScript];if(r){r.focusControl=t}});if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},find:function(f,c){if($object.isNullOrUndefined(f.dataSourceID)==true){$l.eventLog("$codepicker.find","dataSourceID ì¤ì  ìì","Debug");return}f.storeSourceID=f.storeSourceID||f.dataSourceID;var e=f.elID+f.viewType+f.dataSourceID;var t=window[syn.$w.pageScript];if(t){if(t["frameEvent"]){var r=t["frameEvent"]("codeInit",f);f=$w.argumentsExtend(f,r)}var n=/(\@ApplicationID)\s*:/;if(n.test(f.parameters)==false){f.parameters="@ApplicationID:{0};".format(syn.Config.ApplicationID)+f.parameters}var i=/(\@CompanyNo)\s*:/;if(syn.$w.SSO&&$w.SSO.WorkCompanyNo&&i.test(f.parameters)==false){f.parameters="@CompanyNo:{0};".format(syn.$w.SSO.WorkCompanyNo)+f.parameters}var a=/(\@LocaleID)\s*:/;if(a.test(f.parameters)==false){f.parameters="@LocaleID:{0};".format(syn.Config.Program.LocaleID)+f.parameters}t.codePickerArguments=t.codePickerArguments||{};t.codePickerArguments[e]=f}var o=$reflection.clone(syn.$w.dialogOptions);o.minWidth=480;o.minHeight=360;o.caption=(f.controlText?f.controlText:f.dataSourceID)+" ì½ëëì";$w.showUIDialog(syn.Config.SharedAssetUrl+"codehelp/index.html?parameterID={0}".format(e),o,function(e){if(e&&e.length>0){var t="";var r="";if(f.isMultiSelect==false){var n=e[0];t=n.value;r=n.text}else{var i=[];var a=[];var o=e.length;for(var s=0;s<o;s++){var n=e[s];i.push(n.value);a.push(n.text)}t=i.join();r=a.join()}if(f.viewType=="form"){$l.get(f.codeElementID).value=t;if(f.textElementID){$l.get(f.textElementID).value=r}}else if(f.viewType=="grid"){var l=syn.uicontrols.$grid;var u=l.getActiveRowIndex(f.elID);l.setDataAtCell(f.elID,u,f.codeColumnID,t);if(f.textColumnID){l.setDataAtCell(f.elID,u,f.textColumnID,r)}}}if(c){c(e)}})},toParameterString:function(e){return e?Object.entries(e).reduce(function(e,t,r){var n=t[0],i=t[1];if(n.indexOf("@")==-1){e+=typeof i==="string"?"@"+n+":"+i+";":""}return e},""):""},toParameterObject:function(e){return(e.match(/([^?:;]+)(:([^;]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf(":")).replace("@","")]=t.slice(t.indexOf(":")+1),e},{})},getValue:function(e,t){var r=false;var n=$l.get(e+"_Code");r=n.value;return r},setValue:function(e,t,r){var n=$l.get(e+"_Code");n.value=t},setText:function(e,t,r){var n=$l.get(e+"_Text");n.value=t},clear:function(e,t){$l.get(e+"_Code").value="";$l.get(e+"_Text").value=""},open:function(e){$l.trigger(e+"_Button","click")},setLocale:function(e,t,r,n){}});syn.uicontrols.$codepicker=$codepicker})(window);(function(g){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var m=syn.uicontrols.$colorpicker||new syn.module;m.extend({name:"syn.uicontrols.$colorpicker",version:"1.0",colorControls:[],defaultSetting:{elID:"",defaultColor:null,defineColors:["FF0000","FF4000","FF8000","FFBF00","FFFF00","BFFF00","80FF00","40FF00","00FF00","00FFFF","00BFFF","0080FF","0040FF","8000FF","BF00FF","FF00FF","FF0080","FF0080","848484","000000"],dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){var r=$l.get(e);t=$w.argumentsExtend(m.defaultSetting,t);var n=g[$w.pageScript];if(n&&n["controlInit"]){var i=n["controlInit"](e,t);t=$w.argumentsExtend(t,i)}t.elID=e;r.setAttribute("id",r.id+"_hidden");r.setAttribute("syn-options",JSON.stringify(t));r.style.display="none";var a=r.getAttribute("syn-datafield");var o='<div class="control">'+'<input type="text" class="form-control" id="{0}" syn-datafield="{1}" syn-options="{editType: \'text\', maskPattern: \'#SSSSSS\', dataType: \'string\', belongID: \'{2}\'}" />'.format(e,a,t.belongID)+'<button type="button" id="{0}_Button" type="button" class="btn btn-default btn-code-search"></button>'.format(e)+"</div>";var s=r.parentNode;var l=$m.create({tag:"div",id:e+"_box",className:"control-set"});l.innerHTML=o;s.appendChild(l);syn.uicontrols.$textbox.controlLoad(e);t.field=$l.get(e);t.trigger=$l.get(e+"_Button");$l.addEvent(t.trigger,"click",function(e){u[u.visible?"exit":"enter"]()});var u=new CP(t.field);if($ref.isString(t.defaultColor)==true){u.set(t.defaultColor)}var f=document.createElement("span");f.className="color-pickers";u.self.appendChild(f);var c=null;for(var d=0,h=t.defineColors.length;d<h;++d){c=document.createElement("span");c.title="#"+t.defineColors[d];c.style.backgroundColor="#"+t.defineColors[d];$l.addEvent(c,"click",function(e){u.set(this.title);u.fire("change",[this.title.slice(1)],"main-change");e.stopPropagation()});f.appendChild(c)}var v=document.createElement("input");u.source.onclick=function(e){e.preventDefault()};v.className="color-picker-code";v.pattern="^#[A-Fa-f0-9]{6}$";v.type="text";u.on("enter",function(){v.value="#"+CP._HSV2HEX(this.get())});u.on("change",function(e){this.source.value="#"+e;v.value="#"+e;v.style.backgroundColor="#"+e});u.self.appendChild(v);function p(){if(this.value.length){u.set(this.value);u.fire("change",[this.value.slice(1)])}}v.oncut=p;v.onpaste=p;v.onkeyup=p;v.oninput=p;m.colorControls.push({id:e,picker:u,setting:$reflection.clone(t)});if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},getValue:function(e,t){var r=null;var n=m.getControl(e);if(n){r=n.picker.field.value}return r},setValue:function(e,t,r){var n=m.getControl(e);if(n){n.picker.field.value=t}},colorConvert:function(e,t){return CP[e](t)},clear:function(e,t){var r=m.getControl(e);if(r){r.picker.clear()}},getControl:function(e){var t=null;var r=m.colorControls.length;for(var n=0;n<r;n++){var i=m.colorControls[n];if(i.id==e){t=i;break}}return t},setLocale:function(e,t,r,n){}});syn.uicontrols.$colorpicker=m})(window);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $contextmenu=syn.uicontrols.$contextmenu||new syn.module;$contextmenu.extend({name:"syn.uicontrols.$contextmenu",version:"1.0",menuControls:[],eventHooks:["close","create","beforeOpen","open","select"],defaultSetting:{target:"targetCSSSelector",delegate:"delegateCSSSelector",autoFocus:true,closeOnWindowBlur:true,hide:false,show:false,menu:[{title:"Cut",cmd:"cut"},{title:"Copy",cmd:"copy",uiIcon:"ui-icon-copy"},{title:"---"},{title:"More",children:[{title:"Sub 1",cmd:"sub1"},{title:"Sub 2",cmd:"sub1"}]}],dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($contextmenu.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var hookEvents=el.getAttribute("syn-events");try{if(hookEvents){hookEvents=eval(hookEvents)}}catch(e){$l.eventLog("ContextMenu_controlLoad",e.toString(),"Debug")}for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];if($contextmenu.eventHooks.indexOf(hookEvent)>-1){if($object.isNullOrUndefined(setting[hookEvent])==true){setting[hookEvent]=function(t,e){var r=$contextmenu.eventHooks.find(function(e){return e.toLowerCase()==t.type.replace("contextmenu","")});var n=window[syn.$w.pageScript];if(n){var i=n["{0}_{1}".format(elID,r)];if(i){i.apply(syn.$l.get(elID),[t,e])}}}}}}$contextmenu.menuControls.push({id:elID,context:$(setting.target).contextmenu(setting),config:setting})},getValue:function(e,t){return null},setValue:function(e,t,r){},clear:function(e,t){},getControl:function(e){var t=null;var r=$contextmenu.menuControls.length;for(var n=0;n<r;n++){var i=$contextmenu.menuControls[n];if(i.id==e){t=i;break}}return t},close:function(e){var t=$contextmenu.getControl(e).context;if(t){t.contextmenu("close")}},enableEntry:function(e,t,r){var n=$contextmenu.getControl(e).context;if(n){n.contextmenu("enableEntry",t,r)}},getEntry:function(e,t){var r=null;var n=$contextmenu.getControl(e).context;if(n){r=n.contextmenu("getEntry",t)}return r},setEntry:function(e,t,r){var n=null;var i=$contextmenu.getControl(e).context;if(i){n=i.contextmenu("setEntry",t,r)}return n},updateEntry:function(e,t,r){var n=null;var i=$contextmenu.getControl(e).context;if(i){n=i.contextmenu("updateEntry",t,r)}return n},showEntry:function(e,t,r){var n=null;var i=$contextmenu.getControl(e).context;if(i){n=i.contextmenu("showEntry",t,r)}return n},getEntryWrapper:function(e,t){var r=null;var n=$contextmenu.getControl(e).context;if(n){r=n.contextmenu("getEntryWrapper",t)}return r},getMenu:function(e){var t=null;var r=$contextmenu.getControl(e).context;if(r){t=r.contextmenu("getMenu")}return t},isOpen:function(e){var t=null;var r=$contextmenu.getControl(e).context;if(r){t=r.contextmenu("isOpen")}return t},open:function(e,t,r){var n=$contextmenu.getControl(e).context;if(n){n.contextmenu("open",t,r)}},setIcon:function(e,t,r){var n=null;var i=$contextmenu.getControl(e).context;if(i){n=i.contextmenu("setIcon",t,r)}return n},setTitle:function(e,t,r){var n=null;var i=$contextmenu.getControl(e).context;if(i){n=i.contextmenu("setTitle",t,r)}return n},setLocale:function(e,t,r,n){}});syn.uicontrols.$contextmenu=$contextmenu})(window);(function(a){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var c=syn.uicontrols.$data||new syn.module;c.extend({name:"syn.uicontrols.$data",version:"1.0",bindingList:[],storeList:[],propertyEvent:true,defaultSetting:{dataSourceID:"",storeType:"Form",dataItems:[],dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad:function(e,t){var r=$l.get(e);t=$w.argumentsExtend(c.defaultSetting,t);var n=a[$w.pageScript];if(n&&n["controlInit"]){var i=n["controlInit"](e,t);t=$w.argumentsExtend(t,i)}r.setAttribute("syn-options",JSON.stringify(t));r.style.display="none";$this.store[t.dataSourceID]=t.storeType=="Form"?{}:[];c.storeList.push({id:e,dataSourceID:t.dataSourceID,storeType:t.storeType,columns:t.columns})},getValue:function(e,t){var r=null;c.propertyEvent=false;var n=c.getMetaStore(e);if(n){r=$this.store[n.dataSourceID]}c.propertyEvent=true;return r},setValue:function(e,t,r){},clear:function(e,t){},getMetaStore:function(e){var t=null;var r=c.storeList.length;for(var n=0;n<r;n++){var i=c.storeList[n];if(i.id==e){t=i;break}}return t},reactionGetValue:function(t,r,n){var e=null;var i=c.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==r&&e.dataFieldID==n});if(i){var a=c.storeList.find(function(e){return e.dataSourceID==i.dataSourceID});if(i.controlType=="grid"||i.controlType=="list"||i.controlType=="chart"){var o={};var s=a.columns.length;for(var l=0;l<s;l++){var u=a.columns[l];o[u.data]={FieldID:u.data,DataType:u.dataType}}var f=a.storeType=="Form"?"Row":"List";e=i.controlModule.getValue(t,f,o)}else{e=i.controlModule.getValue(t)}}return e},reactionSetValue:function(t,r,n,e){var i=c.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==r&&e.dataFieldID==n});if(i){var a=c.storeList.find(function(e){return e.dataSourceID==i.dataSourceID});if(i.controlType=="grid"||i.controlType=="list"||i.controlType=="chart"){var o={};var s=a.columns.length;for(var l=0;l<s;l++){var u=a.columns[l];o[u.data]={FieldID:u.data,DataType:u.dataType}}i.controlModule.setValue(t,e,o)}else{i.controlModule.setValue(t,e)}}},bindingSource:function(t,r){var e=$this.store[r];var n=$l.get(t+"_hidden")||$l.get(t);if(n){var i=n.tagName.toUpperCase();var a=null;var o=null;if(i.indexOf("QAF_")>-1){var s=i.substring(4).toLowerCase();a=syn.uicontrols["$"+s];o=s}else{switch(i){case"BUTTON":a=syn.uicontrols.$button;o="button";break;case"INPUT":o=n.getAttribute("type").toLowerCase();switch(o){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":a=syn.uicontrols.$textbox;break;case"submit":case"reset":case"button":a=syn.uicontrols.$button;break;case"radio":a=syn.uicontrols.$radio;break;case"checkbox":a=syn.uicontrols.$checkbox;break}break;case"TEXTAREA":a=syn.uicontrols.$textarea;o="textarea";break;case"SELECT":if(n.getAttribute("multiple")==null){a=syn.uicontrols.$select;o="select"}else{a=syn.uicontrols.$multiselect;o="multiselect"}break;default:break}}var l=n.getAttribute("syn-datafield");if(l){var u=null;if(o=="grid"||o=="list"||o=="chart"){u=c.bindingList.find(function(e){return e.dataSourceID==r})}else{u=c.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==r&&e.dataFieldID==l})}if(u==null){c.bindingList.push({elID:t,dataSourceID:r,dataFieldID:l,controlModule:a,controlType:o});Object.defineProperty(e,l,{get:function(){if(c.propertyEvent==true){return c.reactionGetValue(t,r,l)}},set:function(e){if(c.propertyEvent==true){c.reactionSetValue(t,r,l,e)}},configurable:true,enumerable:true})}else{$l.eventLog("$data.bindingSource","binding ì ë³´ íì¸ íì - elID: {0}, dataSourceID: {1}, dataFieldID: {2}, controlType: {3}, ".format(t,r,l,o),"Warning")}}else{$l.eventLog("$data.bindingSource","dataFieldID íì¸ íì","Warning")}}else{$l.eventLog("$data.bindingSource",'"{0}" elID íì¸ íì'.format(t),"Warning")}},setLocale:function(e,t,r,n){}});syn.uicontrols.$data=c})(window);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $datepicker=syn.uicontrols.$datepicker||new syn.module;$datepicker.extend({name:"syn.uicontrols.$datepicker",version:"1.0",dateControls:[],defaultSetting:{elID:"",width:"100%",defaultDate:null,setDefaultDate:false,minDate:null,maxDate:null,bound:true,format:"YYYY-MM-DD",ariaLabel:"ë ì§ë¥¼ ì ííì¸ì",i18n:{previousMonth:"ì´ì  ë¬",nextMonth:"ë¤ì ë¬",months:["1ì","2ì","3ì","4ì","5ì","6ì","7ì","8ì","9ì","10ì","11ì","12ì"],weekdays:["ì¼ìì¼","ììì¼","íìì¼","ììì¼","ëª©ìì¼","ê¸ìì¼","í ìì¼"],weekdaysShort:["ì¼","ì","í","ì","ëª©","ê¸","í "]},showWeekNumber:false,showMonthAfterYear:true,yearSuffix:"ë",firstDay:0,useRangeSelect:false,rangeStartControlID:null,rangeEndControlID:null,numberOfMonths:1,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($datepicker.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}if(setting.useRangeSelect===true){if($object.isNullOrUndefined(setting.rangeStartControlID)==true){setting.rangeStartControlID=elID}if($object.isNullOrUndefined(setting.rangeEndControlID)==true){setting.rangeEndControlID=elID}}setting.elID=elID;el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var dataField=el.getAttribute("syn-datafield");var events=el.getAttribute("syn-events");var html="";if(events){html='<input type="text" class="item textBox" id="{0}" syn-datafield="{1}" syn-options="{editType: \'date\', maskPattern: \'9999-99-99\', dataType: \'string\', belongID: \'{2}\'}" syn-events={3} />'.format(elID,dataField,setting.belongID,"['"+eval(events).join("','")+"']")+'<button type="button" id="{0}_Button" type="button" class="icon-calendar"></button>'.format(elID)}else{html='<input type="text" class="item textBox" id="{0}" syn-datafield="{1}" syn-options="{editType: \'date\', maskPattern: \'9999-99-99\', dataType: \'string\', belongID: \'{2}\'}" />'.format(elID,dataField,setting.belongID)+'<button type="button" id="{0}_Button" type="button" class="icon-calendar"></button>'.format(elID)}var parent=el.parentNode;var wrapper=$m.create({tag:"span",className:"formControl inputGroup",style:{width:setting.width}});wrapper.innerHTML=html;parent.appendChild(wrapper);syn.uicontrols.$textbox.controlLoad(elID,eval("("+$l.get(elID).getAttribute("syn-options")+")"));setting.field=$l.get(elID);setting=$w.argumentsExtend({onOpen:function(){var e=this._o.elID;var t=this.getDate();$datepicker.updateRangeDate(e,t);var r=window[syn.$w.pageScript];var n="{0}_onselect".format(e);if(r&&r[n]){r[n](e,t)}},onClose:function(){var e=this._o.elID;var t=this.getDate();$datepicker.updateRangeDate(e,t);var r=window[syn.$w.pageScript];var n="{0}_onselect".format(e);if(r&&r[n]){r[n](e,t)}},onSelect:function(e){if(!e){return}var t=this._o.elID;$datepicker.updateRangeDate(t,e);var r=window[syn.$w.pageScript];var n="{0}_onselect".format(t);if(r&&r[n]){r[n](t,e)}}},setting);var picker=new Pikaday(setting);$l.addEvent(syn.$l.get(elID+"_Button"),"click",function(e){picker[picker.isVisible()?"hide":"show"]()});$datepicker.dateControls.push({id:elID,picker:picker,setting:$reflection.clone(setting)});if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e,t){var r=null;var n=$datepicker.getControl(e);if(n){r=n.picker._o.field.value}return r},setValue:function(e,t,r){var n=$datepicker.getControl(e);if(n){n.picker._o.field.value=t}},clear:function(e,t){var r=$datepicker.getControl(e);if(r){r.picker.clear()}},getControl:function(e){var t=null;var r=$datepicker.dateControls.length;for(var n=0;n<r;n++){var i=$datepicker.dateControls[n];if(i.id==e){t=i;break}}return t},updateRangeDate:function(e,t){var r=$l.get(e);if(r){var n=$datepicker.getControl(e);if(n){if(n.setting.useRangeSelect===true){if(n.setting.rangeStartControlID==e){var i=n.picker;var a=null;var o=$datepicker.getControl(n.setting.rangeEndControlID);if(o){a=o.picker}if(i&&a){$datepicker.updateStartDate(i,a,t)}}else if(n.setting.rangeEndControlID==e){var i=null;var a=n.picker;var o=$datepicker.getControl(n.setting.rangeStartControlID);if(o){i=o.picker}if(i&&a){$datepicker.updateEndDate(i,a,t)}}}}}},updateStartDate:function(e,t,r){e.setStartRange(r);t.setStartRange(r);t.setMinDate(r)},updateEndDate:function(e,t,r){e.setEndRange(r);e.setMaxDate(r);t.setEndRange(r)},setLocale:function(e,t,r,n){}});syn.uicontrols.$datepicker=$datepicker})(window);(function(s){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var f=syn.uicontrols.$multiselect||new syn.module;f.extend({name:"syn.uicontrols.$multiselect",version:"1.0",selectControls:[],defaultSetting:{elID:"",required:false,animate:false,local:true,search:false,multiSelectAll:true,width:"100%",classNames:null,dataSourceID:null,storeSourceID:null,parameters:null,selectedValue:null,toQafControl:false,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){t=$w.argumentsExtend(f.defaultSetting,t);var r=s[$w.pageScript];if(r&&r["controlInit"]){var n=r["controlInit"](e,t);t=$w.argumentsExtend(t,n)}t.elID=e;t.storeSourceID=t.storeSourceID||t.dataSourceID;var i=$l.get(e);i.setAttribute("syn-options",JSON.stringify(t));f.addControlSetting(i,t);if(t.storeSourceID){$w.addReadyCount();var a=null;if(r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&t.local==true){a=r.config.dataSource[t.storeSourceID]}if(a){f.loadData(t.elID,a,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}$w.removeReadyCount()}else{if(t.local==true){$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.dataSourceID),t,function(e,t){if(t){r.config.dataSource[e.storeSourceID]=t;f.loadData(e.elID,t,e.required);if(e.selectedValue){f.setValue(e.elID,e.selectedValue)}}$w.removeReadyCount()},false)}else{$w.getDataSource(t.dataSourceID,t.parameters,function(e){if(e){r.config.dataSource[t.storeSourceID]=e;f.loadData(t.elID,e,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}}$w.removeReadyCount()})}}}if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},dataRefresh:function(e,t,r){t=$w.argumentsExtend(f.defaultSetting,t);t.elID=e;t.storeSourceID=t.storeSourceID||t.dataSourceID;var n=$l.get(e);n.setAttribute("syn-options",JSON.stringify(t));if(t.dataSourceID){var i=s[$w.pageScript];if(i.config&&i.config.dataSource&&i.config.dataSource[t.storeSourceID]){delete i.config.dataSource[t.storeSourceID]}if(i&&i["controlInit"]){var a=i["controlInit"](e,t);t=$w.argumentsExtend(t,a)}var o=null;if(i.config&&i.config.dataSource&&i.config.dataSource[t.storeSourceID]){o=i.config.dataSource[t.storeSourceID]}if(o){f.loadData(t.elID,o,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}if(r){r()}}else{if(t.local==true){$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.dataSourceID),t,function(e,t){i.config.dataSource[e.storeSourceID]=t;f.loadData(e.elID,t,e.required);if(e.selectedValue){f.setValue(e.elID,e.selectedValue)}if(r){r()}},false)}else{$w.getDataSource(t.dataSourceID,t.parameters,function(e){i.config.dataSource[t.storeSourceID]=e;f.loadData(t.elID,e,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}if(r){r()}})}}}},addControlSetting:function(e,t){var r=null;if(t.toQafControl==true){r=tail.select(e,t);r.on("open",function(){var e=f.getControl(this.e.id).picker;if($string.toBoolean(e.selectedDisabled)==true){e.selectValues=e.value();e.label.style.backgroundColor="#f2f2f2";e.label.style.color="#999"}else{e.label.style.backgroundColor="";e.label.style.color=""}var t=this.e.options;var r=t.length;var n=0;var i=0;if(r>0){for(var a=0;a<r;a++){var o=t[a];var s=o.textContent.length;if(n<s){n=s;i=a}}var l=$d.measureSize(t[i].textContent);if(l){var u=parseInt(l.width.replace("px",""))+50;if(u>600){u=600}if(syn.$d.getSize(this.dropdown).width<u){this.dropdown.style.width=u.toString()+"px"}}}});r.on("close",function(){var e=f.getControl(this.e.id).picker;if($string.toBoolean(e.selectedDisabled)==true){f.setValue(this.e.id,e.selectValues);e.label.style.backgroundColor="#f2f2f2";e.label.style.color="#999"}else{e.label.style.backgroundColor="";e.label.style.color=""}});setTimeout(function(){r.select.picker=r;$l.addEvent(r.select,"focus",function(e){$this.context.tabOrderFocusID=this.picker.e.id;$this.context.focusControl=this.picker.e})})}f.selectControls.push({id:e.id,picker:r,setting:$reflection.clone(t)})},getValue:function(e,t){var r=[];var n=$l.get(e);if(n){var i=n.options.length;for(var a=0;a<i;a++){var o=n.options[a];if(o.selected==true){r.push(o.value)}}}return r.join(",")},setValue:function(e,t,r){var n=$l.get(e);if(n){if($reflection.isBoolean(r)==false){r=true}var i=n.options.length;for(var a=0;a<i;a++){n.options[a].selected==false}if($object.isNullOrUndefined(t)==false){if($reflection.isArray(t)==false){t=t.split(",")}var o=t.length;for(var a=0;a<o;a++){var s=t[a];for(var l=0;l<i;l++){var u=n.options[l];if(u.value==s){u.selected=r;break}}}}f.controlReload(e)}},clear:function(e,t){var r=$l.get(e);if(r){var n=r.options.length;for(var i=0;i<n;i++){var a=r.options[i];a.selected=false}f.controlReload(e)}},loadData:function(e,t,r){var n=$l.get(e);if($object.isNullOrUndefined(r)==true){r=false}n.options.length=0;if(syn.$b.isIE==true){var i=n.options;if(r==false){n.add(document.createElement("option"))}var a=t.DataSource.length;for(var o=0;o<a;o++){var s=t.DataSource[o];var l=document.createElement("option");l.value=s[t.CodeColumnID];l.text=s[t.ValueColumnID];n.add(l)}}else{var i=[];if(r==false){i.push('<option value="">í­ëª© ì í...</option>')}var a=t.DataSource.length;for(var o=0;o<a;o++){var s=t.DataSource[o];i.push('<option value="'.concat(s[t.CodeColumnID],'">',s[t.ValueColumnID],"</option>"))}n.innerHTML=i.join("")}f.setSelectedDisabled(e,false);f.controlReload(e)},controlReload:function(e){var t=$l.get(e);if(t){var r=f.getControl(e);if(r){if(r.picker){r.picker.reload()}}}},getSelectedIndex:function(e){var t="";var r=$l.get(e);if(r){t=r.options.selectedIndex}return t},setSelectedIndex:function(e,t){var r=$l.get(e);if(r){r.options.selectedIndex=t}},getSelectedValue:function(e){var t="";var r=$l.get(e);if(r){if(r.options.selectedIndex>-1){t=r.options[r.options.selectedIndex].value}}return t},getSelectedText:function(e){var t="";var r=$l.get(e);if(r){if(r.options.selectedIndex>-1){t=r.options[r.options.selectedIndex].text}}return t},setSelectedValue:function(e,t){var r=$l.get(e);if(r){var n=r.options.length;for(var i=0;i<n;i++){var a=r.options[i];if($ref.isString(t)==true){if(a.value==t){a.selected=true}}else if($ref.isArray(t)==true){if(t.indexOf(a.value)>-1){a.selected=true}}}f.controlReload(e)}},setSelectedText:function(e,t){var r=$l.get(e);if(r){var n=r.options.length;for(var i=0;i<n;i++){var a=r.options[i];if($ref.isString(t)==true){if(a.text==t){a.selected=true}}else if($ref.isArray(t)==true){if(t.indexOf(a.text)>-1){a.selected=true}}}f.controlReload(e)}},disabled:function(e,t){if($object.isNullOrUndefined(t)==true){t=false}t=$string.toBoolean(t);$this.$multiselect.getControl(e).picker.config("disabled",t)},setSelectedDisabled:function(e,t){var r=$l.get(e);if(r){var n=f.getValue(e).split(",");var i=r.options.length;var a=$string.toBoolean(t);if(a==true){for(var o=0;o<i;o++){var s=r.options[o];if(n.indexOf(s.value)>-1){s.disabled=false}else{s.disabled=true}}}else{for(var o=0;o<i;o++){var s=r.options[o];s.disabled=false}}f.controlReload(e);var l=f.getControl(e).picker;l.selectedDisabled=a;if(a==true){l.label.style.backgroundColor="#f2f2f2";l.label.style.color="#999"}else{l.label.style.backgroundColor="";l.label.style.color=""}}},getControl:function(e){var t=null;var r=f.selectControls.length;for(var n=0;n<r;n++){var i=f.selectControls[n];if(i.id==e){t=i;break}}return t},setLocale:function(e,t,r,n){}});syn.uicontrols.$multiselect=f})(window);(function(s){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var f=syn.uicontrols.$select||new syn.module;f.extend({name:"syn.uicontrols.$select",version:"1.0",selectControls:[],defaultSetting:{elID:"",required:false,animate:false,local:true,search:false,multiSelectAll:false,width:"100%",classNames:null,dataSourceID:null,storeSourceID:null,parameters:null,selectedValue:null,toQafControl:true,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){t=$w.argumentsExtend(f.defaultSetting,t);var r=s[$w.pageScript];if(r&&r["controlInit"]){var n=r["controlInit"](e,t);t=$w.argumentsExtend(t,n)}t.elID=e;t.storeSourceID=t.storeSourceID||t.dataSourceID;var i=$l.get(e);i.setAttribute("syn-options",JSON.stringify(t));f.addControlSetting(i,t);if(t.storeSourceID){$w.addReadyCount();var a=null;if(r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&t.local==true){a=r.config.dataSource[t.storeSourceID]}if(a){f.loadData(t.elID,a,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}$w.removeReadyCount()}else{if(t.local==true){$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.dataSourceID),t,function(e,t){if(t){r.config.dataSource[e.storeSourceID]=t;f.loadData(e.elID,t,e.required);if(e.selectedValue){f.setValue(e.elID,e.selectedValue)}}$w.removeReadyCount()},false)}else{$w.getDataSource(t.dataSourceID,t.parameters,function(e){if(e){r.config.dataSource[t.storeSourceID]=e;f.loadData(t.elID,e,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}}$w.removeReadyCount()})}}}if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},dataRefresh:function(e,t,r){t=$w.argumentsExtend(f.defaultSetting,t);t.elID=e;t.storeSourceID=t.storeSourceID||t.dataSourceID;var n=$l.get(e);n.setAttribute("syn-options",JSON.stringify(t));if(t.dataSourceID){var i=s[$w.pageScript];if(i.config&&i.config.dataSource&&i.config.dataSource[t.storeSourceID]){delete i.config.dataSource[t.storeSourceID]}if(i&&i["controlInit"]){var a=i["controlInit"](e,t);t=$w.argumentsExtend(t,a)}var o=null;if(i.config&&i.config.dataSource&&i.config.dataSource[t.storeSourceID]){o=i.config.dataSource[t.storeSourceID]}if(o){f.loadData(t.elID,o,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}if(r){r()}}else{if(t.local==true){$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.dataSourceID),t,function(e,t){i.config.dataSource[e.storeSourceID]=t;f.loadData(e.elID,t,e.required);if(e.selectedValue){f.setValue(e.elID,e.selectedValue)}if(r){r()}},false)}else{$w.getDataSource(t.dataSourceID,t.parameters,function(e){i.config.dataSource[t.storeSourceID]=e;f.loadData(t.elID,e,t.required);if(t.selectedValue){f.setValue(t.elID,t.selectedValue)}if(r){r()}})}}}},addControlSetting:function(e,t){var r=null;if(t.toQafControl==true){r=tail.select(e,t);r.on("open",function(){var e=f.getControl(this.e.id).picker;if($string.toBoolean(e.selectedDisabled)==true){e.selectValue=e.value();e.label.style.backgroundColor="#f2f2f2";e.label.style.color="#999"}else{e.label.style.backgroundColor="";e.label.style.color=""}var t=this.e.options;var r=t.length;var n=0;var i=0;if(r>0){for(var a=0;a<r;a++){var o=t[a];var s=o.textContent.length;if(n<s){n=s;i=a}}var l=$d.measureSize(t[i].textContent);if(l){var u=parseInt(l.width.replace("px",""))+50;if(u>600){u=600}if(syn.$d.getSize(this.dropdown).width<u){this.dropdown.style.width=u.toString()+"px"}}}});r.on("close",function(){var e=f.getControl(this.e.id).picker;if($string.toBoolean(e.selectedDisabled)==true){f.setValue(this.e.id,e.selectValue);e.label.style.backgroundColor="#f2f2f2";e.label.style.color="#999"}else{e.label.style.backgroundColor="";e.label.style.color=""}});setTimeout(function(){r.select.picker=r;$l.addEvent(r.select,"focus",function(e){$this.context.tabOrderFocusID=this.picker.e.id;$this.context.focusControl=this.picker.e})})}f.selectControls.push({id:e.id,picker:r,setting:$reflection.clone(t)})},getValue:function(e,t){var r="";var n=$l.get(e);if(n){r=n.value}return r},setValue:function(e,t,r){var n=$l.get(e);if(n){n.value=t;f.controlReload(e)}},clear:function(e,t){var r=$l.get(e);if(r){r.value="";f.controlReload(e)}},loadData:function(e,t,r){var n=$l.get(e);if($object.isNullOrUndefined(r)==true){r=false}n.options.length=0;if(syn.$b.isIE==true){var i=n.options;if(r==false){n.add(document.createElement("option"))}var a=t.DataSource.length;for(var o=0;o<a;o++){var s=t.DataSource[o];var l=document.createElement("option");l.value=s[t.CodeColumnID];l.text=s[t.ValueColumnID];n.add(l)}}else{var i=[];if(r==false){i.push('<option value="">í­ëª© ì í...</option>')}var a=t.DataSource.length;for(var o=0;o<a;o++){var s=t.DataSource[o];i.push('<option value="'.concat(s[t.CodeColumnID],'">',s[t.ValueColumnID],"</option>"))}n.innerHTML=i.join("")}f.setSelectedDisabled(e,false);f.controlReload(e)},controlReload:function(e){var t=$l.get(e);if(t){var r=f.getControl(e);if(r){if(r.picker){r.picker.reload()}}}},getSelectedIndex:function(e){var t="";var r=$l.get(e);if(r){t=r.options.selectedIndex}return t},setSelectedIndex:function(e,t){var r=$l.get(e);if(r){if(r.options.length>t){r.selectedIndex=t;f.controlReload(e)}}},setSelectedValue:function(e,t){var r=$l.get(e);if(r){var n=r.options.length;for(var i=0;i<n;i++){var a=r.options[i];if(a.value==t){r.selectedIndex=i;f.controlReload(e);break}}}},setSelectedText:function(e,t){var r=$l.get(e);if(r){var n=r.options.length;for(var i=0;i<n;i++){var a=r.options[i];if(a.text==t){r.selectedIndex=i;f.controlReload(e);break}}}},getSelectedValue:function(e){var t="";var r=$l.get(e);if(r){if(r.options.selectedIndex>-1){t=r.options[r.options.selectedIndex].value}}return t},getSelectedText:function(e){var t="";var r=$l.get(e);if(r){if(r.options.selectedIndex>-1){t=r.options[r.options.selectedIndex].text}}return t},disabled:function(e,t){if($object.isNullOrUndefined(t)==true){t=false}t=$string.toBoolean(t);$this.$select.getControl(e).picker.config("disabled",t)},setSelectedDisabled:function(e,t){var r=$l.get(e);if(r){var n=f.getSelectedValue(e);var i=r.options.length;var a=$string.toBoolean(t);if(a==true){for(var o=0;o<i;o++){var s=r.options[o];if(s.value==n){s.disabled=false}else{s.disabled=true}}}else{for(var o=0;o<i;o++){var s=r.options[o];s.disabled=false}}f.controlReload(e);var l=f.getControl(e).picker;l.selectedDisabled=a;if(a==true){l.label.style.backgroundColor="#f2f2f2";l.label.style.color="#999"}else{l.label.style.backgroundColor="";l.label.style.color=""}}},getControl:function(e){var t=null;var r=f.selectControls.length;for(var n=0;n<r;n++){var i=f.selectControls[n];if(i.id==e){t=i;break}}return t},setLocale:function(e,t,r,n){}});syn.uicontrols.$select=f})(window);(function(window){"use strict";window.fileUploadOptions=null;var $fileclient=$fileclient||new syn.module;$fileclient.extend({name:"syn.uicontrols.$fileclient",version:"1.0",fileManagers:[],fileControls:[],businessID:"",mimeType:{html:"text/html",htm:"text/html",css:"text/css",xml:"text/xml",txt:"text/plain",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",tif:"image/tiff",ico:"image/x-icon",bmp:"image/x-ms-bmp",svg:"image/svg+xml",webp:"image/webp",js:"application/x-javascript",pdf:"application/pdf",rtf:"application/rtf",doc:"application/msword",docx:"application/msword",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.ms-powerpoint","7z":"application/x-7z-compressed",zip:"application/zip",bin:"application/octet-stream",exe:"application/octet-stream",dll:"application/octet-stream",iso:"application/octet-stream",msi:"application/octet-stream",mp3:"audio/mpeg",ogg:"audio/ogg",mp4:"video/mp4"},isFileAPIBrowser:false,defaultSetting:{elementID:null,dialogTitle:"íì¼ ìë¡ë",tokenID:"",repositoryID:"",dependencyID:"",businessID:"",isQafRepositoryID:true,fileUpdateCallback:null,accept:"*/*",uploadUrl:"",fileChangeHandler:undefined,custom1:undefined,custom2:undefined,custom3:undefined,minHeight:360,fileManagerServer:"",dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($fileclient.defaultSetting,setting);setting.elementID=elID;var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}setting.uploadType=null;setting.uploadUrl=null;if(syn.Config&&syn.Config.FileManagerServer){setting.fileManagerServer=syn.Config.FileManagerServer}if($string.isNullOrEmpty(setting.fileManagerServer)==true){$l.eventLog("$fileclient.controlLoad","íì¼ ì»¨í¸ë¡¤ ì´ê¸°í ì¤ë¥, íì¼ ìë² ì ë³´ íì¸ íì","Warning");return}if(syn.Config.FileBusinessIDSource&&syn.Config.FileBusinessIDSource!="None"){if(syn.Config.FileBusinessIDSource=="Cookie"){$fileclient.businessID=$r.getCookie("FileBusinessID")}else if(syn.Config.FileBusinessIDSource=="SessionStorage"){$fileclient.businessID=$w.getStorage("FileBusinessID")}}if($string.isNullOrEmpty($fileclient.businessID)==true){$fileclient.businessID=$w.SSO.WorkCompanyNo}if($string.isNullOrEmpty($fileclient.businessID)==true){$l.eventLog("$fileclient.controlLoad","íì¼ ì»¨í¸ë¡¤ ì´ê¸°í ì¤ë¥, íì¼ ìë¬´ ID ì ë³´ íì¸ íì","Warning");return}if(setting.isQafRepositoryID==true){if(setting.repositoryID&&setting.repositoryID.length>7){setting.repositoryID=syn.Config.ApplicationID+syn.Config.ProjectID+syn.Config.FileServerType+setting.repositoryID.substring(7)}}$w.loadJson(setting.fileManagerServer+"/api/filemanager/GetRepository?repositoryID={0}".format(setting.repositoryID),setting,function(setting,repositoryData){setting.dialogTitle=repositoryData.RepositoryName;setting.storageType=repositoryData.StorageType;setting.isMultiUpload=repositoryData.IsMultiUpload;setting.isAutoPath=repositoryData.IsAutoPath;setting.policyPathID=repositoryData.PolicyPathID;setting.uploadType=repositoryData.UploadType;setting.uploadExtensions=repositoryData.UploadExtensions;setting.accept=repositoryData.UploadExtensions;setting.uploadCount=repositoryData.UploadCount;setting.uploadSizeLimit=repositoryData.UploadSizeLimit;if(setting.uploadType=="Single"){setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/SingleFile.html"}else if(setting.uploadType=="Profile"){setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/ProfilePicture.html"}else if(setting.uploadType=="Multi"){setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/MultiFiles.html"}else if(setting.uploadType=="ImageLink"){setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/ImageLinkFiles.html"}setting.elID=elID;el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var dataFieldID=el.getAttribute("syn-datafield");var events=el.getAttribute("syn-events");var value=el.value?el.value:"";var name=el.name?el.name:"";var html="";if(events){html='<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}" syn-events={4}>'.format(elID,name,dataFieldID,value,"['"+eval(events).join("','")+"']")}else{html='<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}">'.format(elID,name,dataFieldID,value)}var parent=el.parentNode;var wrapper=document.createElement("div");wrapper.innerHTML=html;parent.appendChild(wrapper);$l.get(elID).setAttribute("syn-options",JSON.stringify(setting));$fileclient.fileControls.push({id:elID,setting:$ref.clone(setting)})},function(){if($string.isNullOrEmpty(setting.uploadUrl)==true){$w.alert("{0}ì ëí íì¼ ìë² ì ì¥ ì ë³´ íì¸ íì".format(setting.repositoryID))}},true,true);if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},moduleInit:function(){$l.addEvent(window,"message",function(e){var repositoryData=e.data;if((syn.Config.FileManagerServer+"/api/filemanager").indexOf(e.origin)>-1&&repositoryData&&repositoryData.action=="UploadFiles"){if(window.$progressBar){$progressBar.close()}if(repositoryData.callback){var mod=window[syn.$w.pageScript];if(mod){var clientCallback=null;clientCallback=mod[repositoryData.callback];if($object.isNullOrUndefined(clientCallback)==true){try{clientCallback=eval("$this."+repositoryData.callback)}catch(e){$l.eventLog("clientCallback",e,"Warning")}}if(clientCallback){var result={elID:repositoryData.elementID,repositoryID:repositoryData.repositoryID,items:repositoryData.repositoryItems};var items=[];for(var i=0;i<repositoryData.repositoryItems.length;i++){var item=repositoryData.repositoryItems[i];items.push(item.ItemID)}if(repositoryData.elementID){$l.get(repositoryData.elementID).value=items.join(",")}clientCallback("upload",result)}}}}$.modal.close()})},getFileSetting:function(e){var t=null;var r=$fileclient.fileControls.length;for(var n=0;n<r;n++){var i=$fileclient.fileControls[n];if(i.id==e){t=i.setting;break}}return t},getValue:function(e,t){return syn.$l.get(e).value},setValue:function(e,t,r){var n=$l.get(e);n.value=t?t:""},clear:function(e,t){var r=$l.get(e);r.value=""},init:function(e,t,r,n){var i=$fileclient.getTemporaryDependencyID(e);$fileclient.fileManagers.push({elID:e,container:t,datas:r,dependencyID:i,filechange:n});if(window.File&&window.FileList){$fileclient.isFileAPIBrowser=true}if(t!=null){if(document.forms.length>0){var a=document.forms[0];if(syn.$l.get("syn-repository")==null){var o=$m.append(a,"iframe","syn-repository",{display:"none"});o.name="syn-repository"}a.enctype="multipart/form-data";a.target="syn-repository";a.method="post";a.action=syn.Config.FileManagerServer+"/api/filemanager"}}},getRepositoryUrl:function(e){var t=null;var r=null;for(var n=0;n<$fileclient.fileManagers.length;n++){r=$fileclient.fileManagers[n];if(r.datas&&r.datas.repositoryID==e){t=r.datas.fileManagerServer+"/api/filemanager";break}}return t},getFileManager:function(e){var t=null;var r=null;for(var n=0;n<$fileclient.fileManagers.length;n++){r=$fileclient.fileManagers[n];if(r.elID==e){t=r;break}}return t},getFileMaxIndex:function(e){var t=1;var r=[];var n=$l.querySelectorAll('[id*="'+e+'_filesName"]');for(var i=1;i<=n.length;i++){r.push(i)}t=r[r.length-1];if(t==undefined){t=0}t++;return t},addFileUI:function(e,t){var r=$fileclient.getFileManager(e);if(r){var n=r.container;var i=document.createElement("li");var a=document.createElement("span");var o=document.createElement("input");var s=document.createElement("span");a.appendChild(o);i.appendChild(a);i.appendChild(s);n.appendChild(i);var l=$fileclient.getFileMaxIndex(e).toString();o.id=e+"_filesName_"+l;o.name="files";o.type="file";o.multiple=false;if(t){o.accept=t}$m.addClass(o,"ui_textbox");$m.addClass(o,"file");$m.addClass(s,"btn");$l.addEvent(o,"change",function(e){var t=e.target;var r=null;var n=null;var i=t.id.split("_");var a=$fileclient.getFileManager(i[0]);if(a&&a.filechange){n=i[i.length-1];if($fileclient.isFileAPIBrowser==true){var o=t.files[0];r={name:o.name,size:o.size,type:o.type,index:n}}else{var s=new Image;s.src=t.value;r={name:s.nameProp,size:undefined,type:$fileclient.getFileMimeType(s.nameProp),index:n}}a.filechange(t,r)}});s.id=e+"_filesRemove_"+l;s.name=e+"_filesRemove_"+l;s.type="button";s.index=l;s.value="ì­ì ";$l.addEvent(s,"click",function(e){var t=e.srcElement||e.target;var r=$l.get(t.id.replace("_filesRemove_","_filesName_"));r.value=""})}else{$w.alert(e+" íì¼ ê´ë¦¬ìê° ì§ì ëì§ ìììµëë¤.")}},getFileMimeType:function(e){var t="application/octet-stream";var r=e.substring(e.lastIndexOf(".")+1);if(r){if($resource&&$resource.mimeType){if($resource.mimeType.hasOwnProperty(r)==true){t=$resource.mimeType[r]}}else{if($fileclient.mimeType.hasOwnProperty(r)==true){t=$fileclient.mimeType[r]}}}return t},prependChild:function(e,t){var r=$fileclient.getFileManager(e);var n=r.container;var i=n.childNodes;var a=i.length-1;if(t){n.insertBefore(i[a],t)}},getRepositoryID:function(e){var t="";var r=$fileclient.getFileManager(e);if(r){t=r.datas.repositoryID}return t},getDependencyID:function(e){var t="";var r=$fileclient.getFileManager(e);if(r){t=r.dependencyID}return t},setDependencyID:function(e,t){var r=$fileclient.getFileManager(e);if(r){r.dependencyID=t}},doUpload:function(e,t){var r=$fileclient.getFileManager(e);var n=null;if(r){var i=false;if(r.datas.uploadExtensions.indexOf("*/*")==-1){var a=r.datas.uploadExtensions.split(";");var o=$l.querySelectorAll("[id*='_filesName_']");for(var s=0;s<r.datas.uploadCount;s++){n=o[s];if(n==undefined){break}for(var l=0;l<a.length;l++){if(n.value==""){i=true;break}else if(n.value.substring(n.value.lastIndexOf(".")+1,n.value.length).toLowerCase()===a[l].toLowerCase()){i=true;break}}if(i==false){break}}}else{var o=$l.querySelectorAll("[id*='_filesName_']");if(o.length>0){for(var s=0;s<o.length;s++){n=o[s];if($string.isNullOrEmpty(n.value)==false){i=true}}if(i==false){$w.alert("ìë¡ëí  íì¼ì ì íí´ì¼í©ëë¤");return}}}if(i==true&&document.forms.length>0){if(syn.$l.get("syn-repository")!=null){$r.params=[];var u=$fileclient.getRepositoryID(e);$r.path=$fileclient.getRepositoryUrl(u)+"/UploadFiles";$r.params["elementID"]=t.elementID;$r.params["repositoryID"]=u;$r.params["dependencyID"]=$fileclient.getDependencyID(e);$r.params["custompath1"]=t.custom1;$r.params["custompath2"]=t.custom2;$r.params["custompath3"]=t.custom3;if($string.isNullOrEmpty(t.profileFileName)==false){$r.params["fileName"]=t.profileFileName}if(r.datas.fileUpdateCallback){$r.params["callback"]=r.datas.fileUpdateCallback}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}var f=document.forms[0];f.action=$r.url();f.submit();if(window.$progressBar){$progressBar.show("íì¼ ìë¡ë ì¤ìëë¤...")}}else{$w.alert("doUpload ë©ìëë¥¼ ì§ìíì§ ìë íë©´ìëë¤.")}}else{if($object.isNullOrUndefined(n)==true){$w.alert("ì´ì ì ìë¡ë í íì¼ì ì­ì í´ì¼í©ëë¤")}else{$w.alert(r.datas.uploadExtensions+"íì¥ìë¥¼ ê°ì§ íì¼ì ìë¡ë í´ì¼í©ëë¤")}}}else{$w.alert(e+" íì¼ ê´ë¦¬ìê° ì§ì ëì§ ìììµëë¤.")}},getUploadUrl:function(e,t,r,n){if($object.isNullOrUndefined(r)==true){r=true}$r.path=syn.Config.FileManagerServer+"/api/filemanager/"+(r==true?"UploadFile":"UploadFiles");$r.params["repositoryID"]=e;$r.params["dependencyID"]=t;$r.params["responseType"]="json";if(r==true&&$string.isNullOrEmpty(n)==false){$r.params["fileName"]=n}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}return syn.$r.url()},getFileAction:function(e,t){if($object.isNullOrUndefined(e.action)==true){$l.eventLog("getFileAction","íì ìë ¥ ì ë³´ íì¸ íì","Warning");return}$r.path=syn.Config.FileManagerServer+"/api/filemanager/ActionHandler";var r=e.action;$r.params["action"]=r;switch(r){case"GetItem":$r.params["repositoryID"]=e.repositoryID;$r.params["itemID"]=e.itemID;break;case"GetItems":$r.params["repositoryID"]=e.repositoryID;$r.params["dependencyID"]=e.dependencyID;break;case"UpdateDependencyID":$r.params["repositoryID"]=e.repositoryID;$r.params["sourceDependencyID"]=e.sourceDependencyID;$r.params["targetDependencyID"]=e.targetDependencyID;break;case"UpdateFileName":$r.params["repositoryID"]=e.repositoryID;$r.params["itemID"]=e.itemID;$r.params["fileName"]=e.fileName;break;case"DeleteItem":$r.path=syn.Config.FileManagerServer+"/api/filemanager/RemoveItem";$r.params["repositoryID"]=e.repositoryID;$r.params["itemID"]=e.itemID;break;case"DeleteItems":$r.path=syn.Config.FileManagerServer+"/api/filemanager/RemoveItems";$r.params["repositoryID"]=e.repositoryID;$r.params["dependencyID"]=e.dependencyID;break;default:$l.eventLog("getFileAction","action íì¸ íì","Warning");return;break}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),t)},getItem:function(e,t,r){var n=$fileclient.getFileSetting(e);if(n==null){var i=$fileclient.getFileManager(e);if(i){n=i.datas}}if(n){$r.path=n.fileManagerServer+"/api/filemanager/ActionHandler";$r.params["action"]="GetItem";$r.params["repositoryID"]=n.repositoryID;$r.params["itemID"]=t}else{var a=$fileclient.getRepositoryID(e);$r.path=$fileclient.getRepositoryUrl(a)+"/ActionHandler";$r.params["action"]="GetItem";$r.params["repositoryID"]=a;$r.params["itemID"]=t}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),r)},getItems:function(e,t,r){var n=$fileclient.getFileSetting(e);if(n==null){var i=$fileclient.getFileManager(e);if(i){n=i.datas}}if(n){$r.path=n.fileManagerServer+"/api/filemanager/ActionHandler";$r.params["action"]="GetItems";$r.params["repositoryID"]=n.repositoryID;$r.params["dependencyID"]=t}else{var a=$fileclient.getRepositoryID(e);$r.path=$fileclient.getRepositoryUrl(a)+"/ActionHandler";$r.params["action"]="GetItems";$r.params["repositoryID"]=a;$r.params["dependencyID"]=t}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),r)},updateDependencyID:function(e,t,r,n){var i=$fileclient.getFileSetting(e);$r.path=i.fileManagerServer+"/api/filemanager/ActionHandler";$r.params["action"]="UpdateDependencyID";$r.params["repositoryID"]=i.repositoryID;$r.params["sourceDependencyID"]=t;$r.params["targetDependencyID"]=r;if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),n)},updateFileName:function(e,t,r,n){var i=$fileclient.getFileSetting(e);$r.path=i.fileManagerServer+"/api/filemanager/ActionHandler";$r.params["action"]="UpdateFileName";$r.params["repositoryID"]=i.repositoryID;$r.params["itemID"]=t;$r.params["fileName"]=r;if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),n)},fileUpload:function(e,t,r,n,i){var a=null;var o="";if($object.isNullOrUndefined(i)==true){o=syn.Config.FileManagerServer+"/api/filemanager/UploadFiles?repositoryID={0}&dependencyID={1}&responseType=json&callback=none".format(t,r)}else{o=i}if($string.isNullOrEmpty($this.$fileclient.businessID)==false){o=o+"&businessID="+$this.$fileclient.businessID}e=$ref.isString(e)==true?$l.get(e):e;if(e&&e.type.toUpperCase()=="FILE"){var s=new FormData;for(var l=0;l<e.files.length;l++){s.append("files",e.files[l])}var u=new syn.$w.xmlHttp;u.open("POST",o,true);u.onload=function(){if(n){n({status:u.status,response:u.responseText})}};u.onerror=function(){if(n){n({status:u.status,response:u.responseText})}};u.send(s)}},fileDownload:function(n){var e=null;if($ref.isString(n)==true){var t=n;var r=$fileclient.getFileSetting(t);var i=$l.get(t)?$l.get(t).value:null;if(r&&i){e=JSON.stringify({RepositoryID:r.repositoryID,ItemID:i,FileMD5:"",TokenID:r.tokenID,BusinessID:$fileclient.businessID})}else{$l.eventLog("fileDownload",'"{0}"ì ëí ìì²­ ì ë³´ íì¸ íì'.format(t),"Debug");return}}else{if(n.repositoryID&&n.itemID){e=JSON.stringify({RepositoryID:n.repositoryID,ItemID:n.itemID,FileMD5:n.fileMD5,TokenID:n.tokenID,BusinessID:$fileclient.businessID})}else{$l.eventLog("fileDownload",'"{0}"ì ëí ìì²­ ì ë³´ íì¸ íì'.format(t),"Debug");return}}$r.path=(n.fileManagerServer||syn.Config.FileManagerServer)+"/api/filemanager/DownloadFile";var a=$w.xmlHttp();a.open("POST",$r.url(),true);a.setRequestHeader("Content-type","qrame/json-message");a.responseType="blob";a.onload=function(e){if(a.status==200){if(a.getResponseHeader("Qrame_ModelType")=="DownloadResult"){var t=$c.base64Decode(a.getResponseHeader("Qrame_Result"));var r=JSON.parse(t);if(r.Result==true){$r.blobToDownload(a.response,r.FileName)}else{$l.eventLog("fileDownload",'íì¼ ë¤ì´ë¡ë ì¤í¨: "{0}"'.format(r.Message),"Debug")}}else{$l.eventLog("fileDownload",'itemID: "{0}" íì¼ ë¤ì´ë¡ë ìëµ ì¤ë¥'.format(JSON.stringify(n)),"Debug")}}else{$l.eventLog("fileDownload",'íì¼ ë¤ì´ë¡ë ì¤ë¥, status: "{0}"'.format(a.statusText),"Debug")}};a.send(e)},httpDownloadFile:function(e,t,r,n){if(document.forms.length>0&&$l.get("repositoryDownload")==null){var i=document.forms[0];var a=$m.append(i,"iframe","repositoryDownload",{display:"none"});a.name="repositoryDownload";a.width="100%"}$r.path=syn.Config.FileManagerServer+"/api/filemanager/HttpDownloadFile";$r.params["repositoryID"]=e;$r.params["itemID"]=t;$r.params["fileMD5"]=r;$r.params["tokenID"]=n;if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$l.get("repositoryDownload").src=$r.url()},virtualDownloadFile:function(e,t,r){if(document.forms.length>0&&$l.get("repositoryDownload")==null){var n=document.forms[0];var i=$m.append(n,"iframe","repositoryDownload",{display:"none"});i.name="repositoryDownload"}$r.path=syn.Config.FileManagerServer+"/api/filemanager/VirtualDownloadFile";$r.params["repositoryID"]=e;$r.params["fileName"]=t;$r.params["subDirectory"]=r;if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$l.get("repositoryDownload").src=$r.url()},virtualDeleteFile:function(e,t,r){$r.path=syn.Config.FileManagerServer+"/api/filemanager/virtualDeleteFile";$r.params["repositoryID"]=e;$r.params["fileName"]=t;$r.params["subDirectory"]=r;if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),function(e){if(e.Result==false){$l.eventLog("virtualDeleteFile",e.Message)}})},deleteItem:function(o,s,l){var u=$fileclient.getFileSetting(o);if(u==null){var e=$fileclient.getFileManager(o);if(e){u=e.datas}}if(u){$r.path=u.fileManagerServer+"/api/filemanager/RemoveItem";$r.params["repositoryID"]=u.repositoryID;$r.params["itemID"]=s}else{var t=$fileclient.getRepositoryID(o);$r.path=$fileclient.getRepositoryUrl(t)+"/RemoveItem";$r.params["repositoryID"]=t;$r.params["itemID"]=s}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),function(e){if(u.uploadType=="Single"||u.uploadType=="Profile"){if(e&&e.Result==true){var t=$l.get(o);if(t){t.value=""}}}else{if(e&&e.Result==true){var t=$l.get(o);if(t){var r=[];var n=t.value.split(",");for(var i=0;i<n.length;i++){var a=n[i];if(a!=s){r.push(a)}}t.value=r.join(",")}}}if(l){l(e)}})},deleteItems:function(r,e,n){var t=$fileclient.getFileSetting(r);if(t==null){var i=$fileclient.getFileManager(r);if(i){t=i.datas}}if(t){$r.path=t.fileManagerServer+"/api/filemanager/RemoveItems";$r.params["repositoryID"]=t.repositoryID;$r.params["dependencyID"]=e}else{var a=$fileclient.getRepositoryID(r);$r.path=$fileclient.getRepositoryUrl(a)+"/RemoveItems";$r.params["repositoryID"]=a;$r.params["dependencyID"]=e}if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}$fileclient.executeProxy(syn.$r.url(),function(e){if(e&&e.Result==true){var t=$l.get(r);if(t){t.value=""}}if(n){n(e)}})},uploadBlob:function(e,t){e=$w.argumentsExtend({repositoryID:null,dependencyID:null,blobInfo:null,mimeType:"application/octet-stream",fileName:null},e);if($string.isNullOrEmpty(e.repositoryID)==false&&$string.isNullOrEmpty(e.dependencyID)==false&&e.blobInfo){$r.path=syn.Config.FileManagerServer+"/api/filemanager/UploadFile";$r.params["repositoryID"]=e.repositoryID;$r.params["dependencyID"]=e.dependencyID;if($string.isNullOrEmpty($fileclient.businessID)==false){$r.params["businessID"]=$fileclient.businessID}var r=$w.xmlHttp();r.open("POST",$r.url());r.onload=function(){if(r.status!=200){$l.eventLog("$fileclient.uploadBlob","HTTP Error code: {0}, text: {1}".format(r.status,r.statusText),"Warning");return}try{if(t){t(JSON.parse(r.responseText))}}catch(e){$w.alert("Blob íì¼ ìë¡ë ì¤ë¥: {0}".format(e.message));$l.eventLog("$fileclient.uploadBlob",e,"Warning")}};r.onerror=function(){$l.eventLog("$fileclient.uploadBlob","HTTP Error code: {0}, text: {1}".format(r.status,r.statusText),"Warning")};var n=new FormData;var i=e.fileName||"blob-"+$l.random(24);n.append("file",e.blobInfo,i);r.send(n)}else{var a="Blob íì¼ ìë¡ë íì í­ëª© íì¸ íì";$w.alert(a);$l.eventLog("$fileclient.uploadBlob",a,"Warning")}},uploadDataUri:function(e,t){e=$w.argumentsExtend({repositoryID:null,dependencyID:null,dataUri:null,mimeType:null,fileName:null},e);if($string.isNullOrEmpty(e.repositoryID)==false&&$string.isNullOrEmpty(e.dependencyID)==false&&$string.isNullOrEmpty(e.dataUri)==false){e.blobInfo=$w.dataUriToBlob(e.dataUri);e.mimeType=e.blobInfo.type;$fileclient.uploadBlob(e,t)}else{var r="DataUri íì¼ ìë¡ë íì í­ëª© íì¸ íì";$w.alert(r);$l.eventLog("$fileclient.uploadDataUri",r,"Warning")}},uploadBlobUri:function(t,r){t=$w.argumentsExtend({repositoryID:null,dependencyID:null,blobUri:null,mimeType:null,fileName:null},t);if($string.isNullOrEmpty(t.repositoryID)==false&&$string.isNullOrEmpty(t.dependencyID)==false&&$string.isNullOrEmpty(t.blobUri)==false){$r.blobUrlToData(t.blobUri,function(e){t.blobInfo=e;t.mimeType=t.blobInfo.type;$fileclient.uploadBlob(t,r)})}else{var e="BlobUri íì¼ ìë¡ë íì í­ëª© íì¸ íì";$w.alert(e);$l.eventLog("$fileclient.uploadBlobUri",e,"Warning")}},uploadUI:function(e){var t=$reflection.clone(syn.$w.dialogOptions);t.minWidth=420;t.minHeight=320;e=$w.argumentsExtend(t,e);t.minWidth=e.minWidth;t.minHeight=e.minHeight;t.caption=e.dialogTitle;if(e.repositoryID==""||e.uploadUrl==""){$w.alert("uploadOptionsì repositoryID ëë uploadUrlì´ ìë ¥ëì§ ìììµëë¤.");return}if(e.uploadUrl.indexOf("?")>-1){e.uploadUrl+="&repositoryID="+e.repositoryID}else{e.uploadUrl+="?repositoryID="+e.repositoryID}e.uploadUrl+="&companyNo="+$w.SSO.WorkCompanyNo;fileUploadOptions=e;$w.showUIDialog(e.uploadUrl,t)},toFileLengthString:function(e){var t="0 KB";if(e<0){e=0}if(e<1048576){t=(e/1024).toString()+" KB"}if(e<1073741824){t=(e/1024/1024).toString()+" MB"}return t},executeProxy:function(e,t){var r=new syn.$w.xmlHttp;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE){if(r.status===200){if(t){t(JSON.parse(r.responseText))}}else{$l.eventLog("$fileclient.executeProxy","async url: "+e+", status: "+r.status.toString()+", responseText: "+r.responseText,"Error")}}};r.open("GET",e,true);r.send()},getTemporaryDependencyID:function(e){return e+$l.random(24)},setLocale:function(e,t,r,n){}});$fileclient.moduleInit();syn.uicontrols.$fileclient=$fileclient})(window);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $list=syn.uicontrols.$list||new syn.module;$list.extend({name:"syn.uicontrols.$list",version:"1.0",listControls:[],defaultSetting:{width:"100%",height:"300px",paging:true,ordering:true,info:true,searching:true,select:true,lengthChange:false,autoWidth:true,pageLength:50,orderCellsTop:true,fixedHeader:true,responsive:true,checkbox:false,order:[],sScrollY:"0px",footerCallback:function(){},fnDrawCallback:function(){var s=this.dataTable();var l=this.closest(".dataTables_wrapper");setTimeout(function(){if(typeof TableTools!="undefined"){var e=TableTools.fnGetInstance(table);if(e!=null&&e.fnResizeRequired()){e.fnResizeButtons()}}var t=l.parent().height();var r=l.find(".dataTables_paginate").height();var n=0;l.find(".fg-toolbar").each(function(e,t){n=n+$(t).height()});var i=0;l.find(".dataTables_scrollHead").each(function(e,t){i=i+$(t).height()});var a=t-n-i-r;var o=l.find(".dataTables_scrollBody");o.height(a);o.css({maxHeight:a.toString()+"px"});s._fnScrollDraw()},150)},language:{emptyTable:"ë°ì´í°ê° ììµëë¤",info:"_START_ - _END_ / _TOTAL_",infoEmpty:"0 - 0 / 0",infoFiltered:"(ì´ _MAX_ ê°)",infoThousands:",",lengthMenu:"íì´ì§ë¹ ì¤ì _MENU_",loadingRecords:"ì½ëì¤...",processing:"ì²ë¦¬ì¤...",search:"ê²ì:",zeroRecords:"ê²ì ê²°ê³¼ê° ììµëë¤",paginate:{first:"ì²ì",last:"ë§ì§ë§",next:"ë¤ì",previous:"ì´ì "}},dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($list.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}setting.width=el.style.width||setting.width;setting.height=el.style.height||setting.height;el.setAttribute("id",elID+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var parent=el.parentNode;var wrapper=document.createElement("div");wrapper.style.width=setting.width;wrapper.style.height=setting.height;wrapper.style.position="relative";wrapper.className="list-container";var headers=[];headers.push("<thead><tr>");if(setting.checkbox===true){setting.columnDefs=[{targets:0,checkboxes:{selectRow:true}}];setting.select={style:"multi"};delete setting.sScrollY;delete setting.fnDrawCallback}for(var i=0;i<setting.columns.length;i++){var column=setting.columns[i];headers.push("<th>{0}</th>".format(column.title));delete column.title}headers.push("</tr></thead>");wrapper.innerHTML='<table id="'+elID+'" class="display" style="width:100%">'+headers.join("")+"</table>";parent.appendChild(wrapper);if(setting.searching===true){$("#{0} thead tr".format(elID)).clone(true).appendTo("#{0} thead".format(elID));$("#{0} thead tr:eq(1) th".format(elID)).each(function(r){var e=$(this).text();$(this).html('<input type="text" class="dataTables_searchtext" />');$("input",this).on("keyup change",function(){var e=this.closest(".dataTables_wrapper").id.split("_")[0];var t=$this.$list.getControl(e).table;if(t.column(r).search()!==this.value){t.column(r).search(this.value).draw()}})});if(setting.checkbox===true){$("#lstDataTable thead tr:eq(1) th:first-child input").hide()}}var elDataTable=$("#"+elID);var table=elDataTable.DataTable(setting);var gridHookEvents=$l.get(elID+"_hidden").getAttribute("syn-events");try{if(gridHookEvents){gridHookEvents=eval(gridHookEvents)}}catch(e){$l.eventLog("GridList_controlLoad",e.toString(),"Debug")}if(gridHookEvents){for(var i=0;i<gridHookEvents.length;i++){var hook=gridHookEvents[i];var mod=window[syn.$w.pageScript];if(mod){var eventHandler=mod["{0}_{1}".format(elID,hook)];if(eventHandler){switch(hook){case"select":table.on("select",function(e,t,r,n){table[r](n).nodes().to$().addClass("custom-selected");if(r==="row"){var i=table.rows(n).data();var a=mod["{0}_{1}".format(elID,hook)];a.apply(syn.$l.get(elID),[i,e,t,r,n])}});break;case"deselect":table.on("deselect",function(e,t,r,n){var i=mod["{0}_{1}".format(elID,hook)];i.apply(syn.$l.get(elID),[e,t,r,n])});break;case"dblclick":$("#{0}_wrapper table tbody".format(elID)).on("dblclick","tr",function(){var e=table.row(this).data();var t=mod["{0}_{1}".format(elID,hook)];t.apply(syn.$l.get(elID),[this,e])});break}}}}}$list.listControls.push({id:elID,table:table,list:elDataTable.dataTable(),config:setting,value:null});if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e,t){var r=null;var n=$("#"+e).DataTable();if(n.context){r=n.data().toArray()}return r},setValue:function(e,t,r){var n=$list.getControl(e);if(n){n.list.fnClearTable();n.list.fnAddData(t)}},clear:function(e,t){var r=$list.getControl(e);if(r){r.list.fnClearTable();r.table.columns().search("").draw();var n=document.getElementById(e+"_wrapper").querySelectorAll(".dataTables_searchtext");for(var i=0;i<n.length;i++){var a=n[i];a.value=""}}},getControl:function(e){var t=null;var r=$list.listControls.length;for(var n=0;n<r;n++){var i=$list.listControls[n];if(i.id==e){t=i;break}}return t},setCellData:function(e,t,r,n){var i=$list.getControl(e);if(i){if($ref.isString(r)==true){r=$list.propToCol(e,r)}var a=i.table.cell(t,r);if(a.length>0){i.table.cell(t,r).data(n).draw()}}},propToCol:function(e,t){var r=-1;var n=$list.getControl(e);if(n){var i=n.table.settings().toArray()[0].aoColumns;for(var a=0;a<i.length;a++){if(i[a].data==t){r=a;break}}}return r},setLocale:function(e,t,r,n){}});syn.uicontrols.$list=$list})(window);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $organization=syn.uicontrols.$organization||new syn.module;$organization.extend({name:"syn.uicontrols.$organization",version:"1.0",organizationControls:[],eventHooks:["nodedrop","select","click"],defaultSetting:{width:"100%",height:"300px",itemID:"id",parentItemID:"parentID",childrenID:"children",reduceMap:{key:"id",title:"title",parentID:"parentID"},nodeTitle:"name",nodeContent:"title",direction:"t2b",pan:false,zoom:false,zoominLimit:2,zoomoutLimit:.8,draggable:false,className:"top-level",verticalLevel:4,nodeTemplate:null,createNode:null,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($organization.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}setting.width=el.style.width||setting.width;setting.height=el.style.height||setting.height;el.setAttribute("id",elID+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";if(setting.nodeTemplate!=null&&$ref.isString(setting.nodeTemplate)==true){setting.nodeTemplate=eval(setting.nodeTemplate)}if(setting.createNode!=null&&$ref.isString(setting.createNode)==true){setting.createNode=eval(setting.createNode)}var hookEvents=el.getAttribute("syn-events");try{if(hookEvents){hookEvents=eval(hookEvents)}}catch(e){$l.eventLog("OrganizationView_controlLoad",e.toString(),"Debug")}var parent=el.parentNode;var wrapper=document.createElement("div");wrapper.style.width=setting.width;wrapper.style.height=setting.height;wrapper.className="organization-container";wrapper.innerHTML='<div id="'+elID+'"></div>';parent.appendChild(wrapper);setting.data={};var orgchart=$("#"+elID).orgchart(setting);for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];if($organization.eventHooks.indexOf(hookEvent)>-1){if($object.isNullOrUndefined(setting[hookEvent])==true){switch(hookEvent){case"nodedrop":setting[hookEvent]=function(e,t){var r=window[syn.$w.pageScript];if(r){var n=r["{0}_{1}".format(elID,"nodedrop")];if(n){n.apply(syn.$l.get(elID),[e,t])}}};orgchart.$chart.on("nodedrop.orgchart",setting[hookEvent]);break;case"select":setting[hookEvent]=function(e){var t=window[syn.$w.pageScript];if(t){var r=$(this);var n=t["{0}_{1}".format(elID,"select")];if(n){n.apply(syn.$l.get(elID),[e,r])}}};orgchart.$chartContainer.on("click",".node",setting[hookEvent]);break;case"click":setting[hookEvent]=function(e){var t=window[syn.$w.pageScript];if(t){var r=t["{0}_{1}".format(elID,"click")];if(r){r.apply(syn.$l.get(elID),[e,$(e.target).closest(".node").length])}}};orgchart.$chartContainer.on("click",".orgchart",setting[hookEvent]);break}}}}$organization.organizationControls.push({id:elID,orgchart:orgchart,config:setting});if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e,t){var r=null;var n=$organization.getControl(e).orgchart;if(n){var i=$organization.getControl(e).config;var a=i.reduceMap;var o=n.getHierarchy();var s=$l.nested2Flat(o,i.itemID,i.parentItemID,i.childrenID);var l=[];var u=s.length;for(var f=0;f<u;f++){var c=s[f];var d=c.data;if(d){d[a.key]=c.key;d[a.title]=c.title;d[a.parentID]=c.parentID;l.push(d)}}r=l}return r},setValue:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n){var i=$organization.getControl(e).config;var a=i.reduceMap;var o=[];var s=t.length;for(var l=0;l<s;l++){var u=t[l];o.push({id:u[a.key],key:u[a.key],title:u[a.title],parentID:u[a.parentID],data:$ref.clone(u,false)})}var f=$l.flat2Nested(o,i.itemID,i.parentItemID,i.childrenID);n.init({data:f});var c=i["nodedrop"];if(c){n.$chart.on("nodedrop.orgchart",c)}}},clear:function(e,t){var r=$organization.getControl(e).orgchart;if(r){r.init({data:null})}},getControl:function(e){var t=null;var r=$organization.organizationControls.length;for(var n=0;n<r;n++){var i=$organization.organizationControls[n];if(i.id==e){t=i;break}}return t},init:function(e,t){var r=$organization.getControl(e).orgchart;if(r){r.init(t)}},addParent:function(e,t){var r=$organization.getControl(e).orgchart;if(r){r.addParent($("#"+e).find(".node:first"),t)}},addSiblings:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n&&t){n.addSiblings(t,r)}},addChildren:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n&&t){n.addChildren(t,r)}},removeNodes:function(e,t){var r=$organization.getControl(e).orgchart;if(r&&t){r.removeNodes(t)}},getHierarchy:function(e,t){var r=null;var n=$organization.getControl(e).orgchart;if(n){if($object.isNullOrUndefined(t)==true){t=false}r=n.getHierarchy(t)}return r},hideParent:function(e,t){var r=$organization.getControl(e).orgchart;if(r&&t){r.hideParent(t)}},showParent:function(e,t){var r=$organization.getControl(e).orgchart;if(r&&t){r.showParent(t)}},showChildren:function(e,t){var r=$organization.getControl(e).orgchart;if(r&&t){r.showChildren(t)}},hideSiblings:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n&&t){n.hideSiblings(t,r)}},showSiblings:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n&&t){n.showSiblings(t,r)}},getNodeState:function(e,t,r){var n=null;var i=$organization.getControl(e).orgchart;if(i&&t){if($object.isNullOrUndefined(r)==true){r="children"}n=i.getNodeState(t,r)}return n},getRelatedNodes:function(e,t,r){var n=null;var i=$organization.getControl(e).orgchart;if(i&&t){if($object.isNullOrUndefined(r)==true){r="children"}n=i.getRelatedNodes(t,r)}return n},setChartScale:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n&&t){n.setChartScale(t,r)}},export:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n){if($object.isNullOrUndefined(t)==true){t=$l.random()}n.export(t,r)}},setLocale:function(e,t,r,n){}});syn.uicontrols.$organization=$organization})(window);(function(window){"use strict";var $radio=$radio||new syn.module;$radio.extend({name:"syn.uicontrols.$radio",version:"1.0",defaultSetting:{contents:"",toQafControl:false,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($radio.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}if(setting.toQafControl==true){el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var dataFieldID=el.getAttribute("syn-datafield");var events=el.getAttribute("syn-events");var value=el.value;var checked=el.checked;var name=el.name;var html="";if(events){html='<input class="ui_radio" id="{0}" name="{1}" type="radio" syn-datafield="{2}" value="{3}" {4} syn-events={5}>'.format(elID,name,dataFieldID,value,checked==true?'checked="checked"':"","['"+eval(events).join("','")+"']")}else{html='<input class="ui_radio" id="{0}" name="{1}" type="radio" syn-datafield="{2}" value="{3}" {4}>'.format(elID,name,dataFieldID,value,checked==true?'checked="checked"':"")}if($ref.isString(setting.textContent)==true){html=html+'<label for="{0}">{1}</label>'.format(elID,setting.textContent)}var parent=el.parentNode;var wrapper=$m.create({tag:"span",className:"formControl"});wrapper.innerHTML=html;parent.appendChild(wrapper);$l.get(elID).setAttribute("syn-options",JSON.stringify(setting))}else{el.setAttribute("syn-options",JSON.stringify(setting))}if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e,t){var r=false;var n=$l.get(e);r=n.checked;return r},setValue:function(e,t,r){var n=$l.get(e);n.checked=t},clear:function(e,t){var r=$l.get(e);r.checked=false},getGroupNames:function(){var e=[];var t=$l.querySelectorAll("input[type='radio']");for(var r=0;r<t.length;r++){e.push(t[r].name)}return $array.distinct(e)},getGroupValue:function(e){var t=null;var r=$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e));for(var n=0;n<r.length;n++){var i=r[n];if(i.id.indexOf("_hidden")==-1&&i.checked==true){t=i.value;break}}return t},selectedValue:function(e,t){var r=$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e));for(var n=0;n<r.length;n++){var i=r[n];if(r[n].id.indexOf("_hidden")==-1&&r[n].value===t){r[n].checked=true;break}}},setLocale:function(e,t,r,n){}});syn.uicontrols.$radio=$radio})(window);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $textarea=syn.uicontrols.$textarea||new syn.module;$textarea.extend({name:"syn.uicontrols.$textarea",version:"1.0",textControls:[],defaultSetting:{width:"100%",height:"240px",indentUnit:4,lineNumbers:true,toQafControl:true,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($textarea.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}setting.elementID=elID;setting.width=el.style.width||setting.width;setting.height=el.style.height||setting.height;el.style.width=setting.width;el.style.height=setting.height;el.setAttribute("syn-options",JSON.stringify(setting));var events=el.getAttribute("syn-events");var editor=null;if(setting.toQafControl==true){if(el.getAttribute("maxlength")||el.getAttribute("maxlengthB")){if(el.getAttribute("maxlengthB")){el.setAttribute("maxlength",el.getAttribute("maxlengthB"))}setting.maxLength=el.getAttribute("maxlength")}editor=CodeMirror.fromTextArea(el,setting);if($object.isNullOrUndefined(setting.maxLength)==false){editor.on("blur",function(e,t){var r=$l.get(editor.options.elementID);var n=0;var i=r.getAttribute("maxlengthB");if($string.isNullOrEmpty(i)==false){n=parseInt(i)}else{n=e.getOption("maxLength")}var a=n;var o=$string.length(e.getValue());if(o>a){var s=$reflection.clone(syn.$w.alertOptions);$w.alert($res.textMaxLength.format($string.toCurrency(a)),"ì ë³´",s,function(e){editor.focus()})}return true})}if(events){events=eval(events);for(var i=0;i<events.length;i++){var editorEvent=events[i];var eventHandler=mod[el.id+"_"+editorEvent];if(eventHandler){editor.on(editorEvent,eventHandler)}}}editor.setSize(setting.width,setting.height);setTimeout(function(){editor.refresh()},30)}else{if(el.getAttribute("maxlength")||el.getAttribute("maxlengthB")){if(el.getAttribute("maxlengthB")){el.setAttribute("maxlength",el.getAttribute("maxlengthB"))}$l.addEvent(el,"blur",$textarea.event_blur)}}$textarea.textControls.push({id:elID,editor:editor,setting:$reflection.clone(setting)});if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e){var t=null;var r=$textarea.getControl(e);if(r&&r.editor){t=r.editor.getValue()}else{var n=$l.get(e);if(n){t=n.value}}return t},setValue:function(e,t){var r=$textarea.getControl(e);if(r&&r.editor){r.editor.setValue(t)}else{var n=$l.get(e);if(n){n.value=t}}},clear:function(e,t){var r=$textarea.getControl(e);if(r&&r.editor){r.editor.setValue("")}else{var n=$l.get(e);if(n){n.value=""}}},getControl:function(e){var t=null;var r=$textarea.textControls.length;for(var n=0;n<r;n++){var i=$textarea.textControls[n];if(i.id==e){t=i;break}}return t},event_blur:function(e){var t=e.target||e.srcElement||e;var r=t.getAttribute("maxlengthB");if($string.isNullOrEmpty(r)==false){var n=parseInt(r);var i=$string.length(t.value);if(i>n){var a=$reflection.clone(syn.$w.alertOptions);$w.alert($res.textMaxLength.format($string.toCurrency(n)),"ì ë³´",a);t.focus()}}else{var o=t.getAttribute("maxlength");if($string.isNullOrEmpty(o)==false){var n=parseInt(o);var i=t.value.length;if(i>n){var a=$reflection.clone(syn.$w.alertOptions);$w.alert($res.textMaxLength.format($string.toCurrency(n)),"ì ë³´",a);t.focus()}}}},setLocale:function(e,t,r,n){}});syn.uicontrols.$textarea=$textarea})(window);(function(s){"use strict";var l=l||new syn.module;l.extend({name:"syn.uicontrols.$textbox",version:"1.0",defaultSetting:{editType:"text",formatNumber:true,maskPattern:null,maxCount:null,minCount:0,placeText:[],defaultSetValue:"0",dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){var r=$l.get(e);t=$w.argumentsExtend(l.defaultSetting,t);var n=s[$w.pageScript];if(n&&n["controlInit"]){var i=n["controlInit"](e,t);t=$w.argumentsExtend(t,i)}r.setAttribute("syn-options",JSON.stringify(t));if($ref.isEmpty(t.placeText)==false){superplaceholder({el:r,sentences:$ref.isString(t.placeText)==true?[t.placeText]:t.placeText})}switch(t.editType){case"text":$l.addEvent(r,"focus",l.event_focus);break;case"english":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_english_blur);$l.addEvent(r,"keydown",l.event_english_keydown);$m.setStyle(r,"ime-mode","disabled");break;case"number":$l.addEvent(r,"focus",l.event_numeric_focus);$l.addEvent(r,"blur",l.event_number_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");VMasker(r).maskNumber();break;case"numeric":$l.addEvent(r,"focus",l.event_numeric_focus);$l.addEvent(r,"blur",l.event_numeric_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");VMasker(r).maskNumber();break;case"spinner":$l.addEvent(r,"focus",l.event_numeric_focus);$l.addEvent(r,"blur",l.event_numeric_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");if(r.offsetWidth){r.offsetWidth=r.offsetWidth<=28?0:r.offsetWidth-28}new ISpin(r,{wrapperClass:"ispin-wrapper",buttonsClass:"ispin-button",step:1,pageStep:10,disabled:false,repeatInterval:100,wrapOverflow:false,parse:Number,format:String});VMasker(r).maskNumber();break;case"year":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_year_blur);break;case"date":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_date_blur);break;case"hour":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_hour_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");break;case"minute":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_minute_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");break;case"yearmonth":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_yearmonth_blur);break;case"homephone":$l.addEvent(r,"focus",l.event_phone_focus);$l.addEvent(r,"blur",l.event_homephone_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");break;case"mobilephone":$l.addEvent(r,"focus",l.event_phone_focus);$l.addEvent(r,"blur",l.event_mobilephone_blur);$l.addEvent(r,"keypress",l.event_numeric_keypress);$m.setStyle(r,"ime-mode","disabled");break;case"email":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_email_blur);$m.setStyle(r,"ime-mode","inactive");break;case"juminno":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_juminno_blur);$m.setStyle(r,"ime-mode","disabled");if($string.isNullOrEmpty(t.maskPattern)==true){VMasker(r).maskPattern("999999-9999999")}break;case"businessno":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_businessno_blur);$m.setStyle(r,"ime-mode","disabled");if($string.isNullOrEmpty(t.maskPattern)==true){VMasker(r).maskPattern("999-99-99999")}break;case"corporateno":$l.addEvent(r,"focus",l.event_focus);$l.addEvent(r,"blur",l.event_corporateno_blur);$m.setStyle(r,"ime-mode","disabled");if($string.isNullOrEmpty(t.maskPattern)==true){VMasker(r).maskPattern("999999-9999999")}break}if(r.getAttribute("maxlength")||r.getAttribute("maxlengthB")){if(r.getAttribute("maxlengthB")){r.setAttribute("maxlength",r.getAttribute("maxlengthB"))}$l.addEvent(r,"blur",l.event_blur)}if($string.isNullOrEmpty(t.maskPattern)==false){VMasker(r).maskPattern(t.maskPattern)}if(t.contents){l.setValue(e,t.contents)}if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},event_english_keydown:function(e){var t=t||s.event;var r=t.which||event.keyCode;var n=false;if((r>7&&r<47)==true||(r>64&&r<91)==true||(r>47&&r<58)==true||(r>95&&r<123)==true){}else{var i=e.target||e.srcElement||e;i.value=i.value.replace(/[\ã±-ãã-ã£ê°-í£]/g,"");e.returnValue=false;e.cancel=true;if(e.preventDefault){e.preventDefault()}n=false}n=true;return n},event_numeric_keypress:function(e){var t=e||s.event;var r=e.target||e.srcElement||e;var n=t.which||event.keyCode;var i=false;if(n>31&&(n<48||n>57||n==45||n==109)){if(n==45||n==109){var a=r.value;if(a.startsWith("-")==true&&a.split("-").length<=2||a.split("-").length==1){return true}}e.returnValue=false;e.cancel=true;if(e.preventDefault){e.preventDefault()}i=false}i=true;return i},event_focus:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){l.rangeMoveCaret(t)}},event_phone_focus:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){t.value=t.value.replace(/-/g,"");l.rangeMoveCaret(t)}},event_numeric_focus:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){t.value=$string.toNumberString(t.value);l.rangeMoveCaret(t)}},event_blur:function(e){var t=e.target||e.srcElement||e;var r=t.getAttribute("maxlengthB");if($string.isNullOrEmpty(r)==false){var n=parseInt(t.getAttribute("maxLengthB"));var i=$string.length(t.value);if(i>n){var a=$reflection.clone(syn.$w.alertOptions);$w.alert($res.textMaxLength.format($string.toCurrency(n)),"ì ë³´",a);t.focus();l.event_focus(t)}}else{var o=t.getAttribute("maxlength");if($string.isNullOrEmpty(o)==false){var n=parseInt(t.getAttribute("maxlength"));var i=t.value.length;if(i>n){var a=$reflection.clone(syn.$w.alertOptions);$w.alert($res.textMaxLength.format($string.toCurrency(n)),"ì ë³´",a);t.focus();l.event_focus(t)}}}},event_hour_blur:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){if(parseInt(t.value)>23){t.value="23"}if(t.value.length==1){t.value=t.value.padStart(2,"0")}}},event_minute_blur:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){if(parseInt(t.value)>59){t.value="59"}if(t.value.length==1){t.value=t.value.padStart(2,"0")}}},event_english_blur:function(e){var t=e.target||e.srcElement||e;t.value=t.value.replace(/[^a-z0-9]/gi,"")},event_number_blur:function(e){var t=e.target||e.srcElement||e;var r=JSON.parse(t.getAttribute("syn-options"));if($object.isNullOrUndefined(r.maxCount)==false){if($string.toNumber(t.value)>r.maxCount){t.value=r.maxCount}}if($object.isNullOrUndefined(r.minCount)==false){if($string.toNumber(t.value)<r.minCount){t.value=r.minCount}}var n=t.value;if(n.startsWith("-")==true&&n.length==1||n.trim().length==0){t.value="0"}},event_numeric_blur:function(e){var t=e.target||e.srcElement||e;var r=JSON.parse(t.getAttribute("syn-options"));if($object.isNullOrUndefined(r.maxCount)==false){if($string.toNumber(t.value)>r.maxCount){t.value=r.maxCount}}if($object.isNullOrUndefined(r.minCount)==false){if($string.toNumber(t.value)<r.minCount){t.value=r.minCount}}if(t.value.length>0&&r.formatNumber===true){t.value=$string.toCurrency(t.value)}var n=t.value;if(n.startsWith("-")==true&&n.length==1||n.trim().length==0){t.value="0"}},event_homephone_blur:function(e){var t=e.target||e.srcElement||e;t.value=t.value.replace(/-/g,"");var r=t.value;if(r.length>0){t.setAttribute("placeholder","");if(r.length==12){if(syn.$v.regexs.onesPhone.test(r)==true){t.value=r.substr(0,4).concat("-",r.substr(4,4),"-",r.substr(8,4))}else{t.value=""}}else{if(r.length==9){if(syn.$v.regexs.seoulPhone.test(r)==true){t.value=r.substr(0,2).concat("-",r.substr(2,3),"-",r.substr(5,4))}else{t.value=""}}else if(r.length==10){if(r.substring(0,2)=="02"){if(syn.$v.regexs.seoulPhone.test(r)==true){t.value=r.substr(0,2).concat("-",r.substr(2,4),"-",r.substr(6,4))}else{t.value=""}}else{if(syn.$v.regexs.areaPhone.test(r)==true){t.value=r.substr(0,3).concat("-",r.substr(3,3),"-",r.substr(6,4))}else{t.value=""}}}else if(r.length==11){if(syn.$v.regexs.areaPhone.test(r)==true){t.value=r.substr(0,3).concat("-",r.substr(3,4),"-",r.substr(7,4))}else if(syn.$v.regexs.mobilePhone.test(r)==true){t.value=r.substr(0,3).concat("-",r.substr(3,4),"-",r.substr(7,4))}else{t.value=""}}else{t.value=""}}if(t.value==""){t.setAttribute("placeholder","ì íë²í¸ íì¸ íì")}}},event_mobilephone_blur:function(e){var t=e.target||e.srcElement||e;t.value=t.value.replace(/-/g,"");var r=t.value;if(r.length>0){t.setAttribute("placeholder","");if(syn.$v.regexs.mobilePhone.test(r)==true){if(r.length==10){t.value=r.substr(0,3).concat("-",r.substr(3,3),"-",r.substr(6,4))}else if(r.length==11){t.value=r.substr(0,3).concat("-",r.substr(3,4),"-",r.substr(7,4))}else{t.value=""}}else{t.value=""}if(t.value==""){t.setAttribute("placeholder","ì íë²í¸ íì¸ íì")}}},event_email_blur:function(e){var t=e.target||e.srcElement||e;var r=t.value;if(t.value.length>0){t.setAttribute("placeholder","");if(syn.$v.regexs.email.test(r)==false){t.setAttribute("placeholder","ì´ë©ì¼ íì¸ íì");t.value=""}}},event_year_blur:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){t.setAttribute("placeholder","");if(t.value=="0000"||$date.isDate(t.value)==false){t.setAttribute("placeholder","ëë íì¸ íì");t.value=""}}},event_yearmonth_blur:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){t.setAttribute("placeholder","");if(t.value=="0000-00"||$date.isDate(t.value+"-01")==false){t.setAttribute("placeholder","ëì íì¸ íì");t.value=""}}},event_date_blur:function(e){var t=e.target||e.srcElement||e;if(t.value.length>0){t.setAttribute("placeholder","");var r=t.value;if(r.length==8){r=r.substring(0,4)+"-"+r.substring(4,6)+"-"+r.substring(6,8)}if($date.isDate(r)==true){t.value=r}else{t.setAttribute("placeholder","ì¼ì íì¸ íì");t.value=""}}},event_juminno_blur:function(e){var t=e.target||e.srcElement||e;var r=t.value;if(r.length>0){t.setAttribute("placeholder","");if(syn.$v.regexs.juminNo.test(r)==false){t.setAttribute("placeholder","ì£¼ë¯¼ë±ë¡ë²í¸ íì¸ íì");t.value=""}else{if(r.length==13){r=r.substring(0,6)+"-"+r.substring(6,13)}t.value=r}}},event_businessno_blur:function(e){var t=e.target||e.srcElement||e;var r=t.value;if(r.length>0){t.setAttribute("placeholder","");if($string.isBusinessNo(r)==false){t.setAttribute("placeholder","ì¬ììë²í¸ íì¸ íì");t.value=""}else{if(r.length!=12){r=r.replace(/-/gi,"");r=r.substring(0,3)+"-"+r.substring(3,5)+"-"+r.substring(5)}t.value=r}}},event_corporateno_blur:function(e){var t=e.target||e.srcElement||e;var r=t.value;if(r.length>0){t.setAttribute("placeholder","");if($string.isCorporateNo(r)==false){t.setAttribute("placeholder","ë²ì¸ë²í¸ íì¸ íì");t.value=""}else{if(r.length!=14){r=r.replace(/-/gi,"");r=r.substring(0,6)+"-"+r.substring(6)}t.value=r}}},rangeMoveCaret:function(e){var t=0;var r=0;var n=e.target?e.target:e;r=n.value.length;var i=function(){if(n.setSelectionRange){n.setSelectionRange(t,r)}else if(n.createTextRange){var e=n.createTextRange();e.collapse(true);e.moveEnd("character",r);e.moveStart("character",t);e.select()}};(syn.$b.isIE?i:function(){setTimeout(i,0)})()},getValue:function(e){var t="";var r=$l.get(e);if(r){var n=JSON.parse(r.getAttribute("syn-options"));switch(n.editType){case"text":case"english":case"number":case"spinner":case"date":case"hour":case"minute":case"yearmonth":case"homephone":case"mobilephone":case"email":case"juminno":case"businessno":case"corporateno":var i=s[$w.pageScript];if(n.getter===true&&i["frameEvent"]){t=i.frameEvent("controlGetValue",{elID:e,value:r.value});if($object.isNullOrUndefined(t)==true){t=r.value}}else{t=r.value}break;case"numeric":t=r.value.replace(/,/g,"");break;default:t="";break}}return t},setValue:function(e,t){var r=$l.get(e);if(r){if(t!=undefined&&t!=null){var n="";var i=JSON.parse(r.getAttribute("syn-options"));switch(i.editType){case"text":case"english":case"number":case"spinner":case"date":case"hour":case"minute":case"yearmonth":case"homephone":case"mobilephone":case"email":case"juminno":case"businessno":case"corporateno":var a=s[$w.pageScript];if(i&&i.setter===true&&a["frameEvent"]){n=a.frameEvent("controlSetValue",{elID:e,value:t});if($object.isNullOrUndefined(n)==true){r.value=n}}else{r.value=t}break;case"numeric":if(t.indexOf(",")>-1){r.value=t}else{r.value=$string.isNumber(t)==true?$string.toCurrency(t):t}break;default:r.value="";break}}else{var o=$w.getTriggerOptions(e);if(o&&o.value){r.value=o.value}}}},clear:function(e,t){var r=$l.get(e);if(r){var n=JSON.parse(r.getAttribute("syn-options"));r.value=$ref.defaultValue(n.dataType)}},setLocale:function(e,t,r,n){var i=$l.get(e);debugger;var a=$resource.getBindSource(r,"placeholder");if(a!=null){var o=$resource.translateText(r,n);i[a]=o;if(a=="placeholder"){var s=JSON.parse(i.getAttribute("syn-options"));if(s){s.placeText=o;if($ref.isEmpty(s.placeText)==false){superplaceholder({el:i,sentences:$ref.isString(s.placeText)==true?[s.placeText]:s.placeText})}i.setAttribute("syn-options",JSON.stringify(s))}}else if(a=="controlText"){var s=JSON.parse(i.getAttribute("syn-options"));if(s){s.controlText=o;i.setAttribute("syn-options",JSON.stringify(s))}}}}});syn.uicontrols.$textbox=l})(window);(function(o){"use strict";var s=s||new syn.module;s.extend({name:"syn.uicontrols.$button",version:"1.0",defaultSetting:{color:"default",toQafControl:false,dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){var r=$l.get(e);t=$w.argumentsExtend(s.defaultSetting,t);var n=o[$w.pageScript];if(n&&n["controlInit"]){var i=n["controlInit"](e,t);t=$w.argumentsExtend(t,i)}if(t.toQafControl==true){var a="btn-{0}".format(t.color);if(syn.$m.hasClass(r,a)==false){$m.addClass(r,"btn");$m.addClass(r,a)}}r.setAttribute("syn-options",JSON.stringify(t));if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},getValue:function(e,t){var r=false;var n=$l.get(e);r=n.value;return r},setValue:function(e,t,r){var n=$l.get(e);n.value=t},clear:function(e,t){var r=$l.get(e);r.value=""},setLocale:function(e,t,r,n){}});syn.uicontrols.$button=s})(window);(function(c){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var d=syn.uicontrols.$editor||new syn.module;d.extend({name:"syn.uicontrols.$editor",version:"1.0",contentHtmlUrl:syn.Config.SharedAssetUrl+"html/content.html",defaultSetting:{width:"100%",height:"240px",contents:"",dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(e,t){var r=$l.get(e);t=$w.argumentsExtend(d.defaultSetting,t);var n=c[$w.pageScript];if(n&&n["controlInit"]){var i=n["controlInit"](e,t);t=$w.argumentsExtend(t,i)}r.setAttribute("id",e+"_hidden");r.setAttribute("syn-options",JSON.stringify(t));if(syn.$l.get("htmlEditorOption")==null){var a=[];a.push('<div id="textEditor_fontFamily" class="editorPop">');a.push('<ul class="textEditor_fontFamily" elID="{0}">'.format(e));a.push('<li style="font-family: êµ´ë¦¼;" role="íêµ­ì´" value="êµ´ë¦¼">êµ´ë¦¼</li>');a.push('<li style="font-family: ëì;" role="íêµ­ì´" value="ëì">ëì</li>');a.push('<li style="font-family: ë§ì ê³ ë;" role="íêµ­ì´" value="ë§ì ê³ ë">ë§ì ê³ ë</li>');a.push('<li style="font-family: ê¶ì;" role="íêµ­ì´" value="ê¶ì">ê¶ì</li>');a.push('<li style="font-family: Arial;" role="ìì´" value="Arial">Arial</li>');a.push('<li style="font-family: Verdana;" role="ìì´" value="Verdana">Verdana</li>');a.push('<li style="font-family: Meiryo;" role="ì¼ë³¸ì´" value="Meiryo">Meiryo</li>');a.push('<li style="font-family: MS Song;" role="ì¼ë³¸ì´" value="MS Song">MS Song</li>');a.push('<li style="font-family: Simplified Arabic;" role="ì¤êµ­ì´" value="Simplified Arabic">Simplified Arabic</li>');a.push('<li style="font-family: Mingliu;" role="ì¤êµ­ì´" value="Mingliu">Mingliu</li>');a.push("</ul>");a.push("</div>");a.push('<div id="textEditor_fontSize" class="editorPop">');a.push('<ul class="textEditor_fontSize" elID="{0}">'.format(e));a.push('<li style="font-size: 12px;" value="1">ê°ëë¤ë¼ (12px)</li>');a.push('<li style="font-size: 13px;" value="2">ê°ëë¤ë¼ (13px)</li>');a.push('<li style="font-size: 16px;" value="3">ê°ëë¤ë¼ (16px)</li>');a.push('<li style="font-size: 18px;" value="4">ê°ëë¤ë¼ (18px)</li>');a.push('<li style="font-size: 24px;" value="5">ê°ëë¤ë¼ (24px)</li>');a.push('<li style="font-size: 32px;" value="6">ê°ëë¤ë¼ (32px)</li>');a.push('<li style="font-size: 36px;" value="7">ê°ëë¤ë¼ (36px)</li>');a.push("</ul>");a.push("</div>");a.push('<div id="textEditor_colorScheme" class="editorPop">');a.push('<ul class="textEditor_colorScheme" elID="{0}">'.format(e));a.push('<li style="background: #000000;" value="#000000">#000000</li>');a.push('<li style="background: #008ace;" value="#008ace">#008ace</li>');a.push('<li style="background: #ff7700;" value="#ff7700">#ff7700</li>');a.push('<li style="background: #64b41a;" value="#64b41a">#64b41a</li>');a.push('<li style="background: #fee100;" value="#fee100">#fee100</li>');a.push('<li style="background: #cc0000;" value="#cc0000">#cc0000</li>');a.push('<li style="background: #ef4423;" value="#ef4423">#ef4423</li>');a.push('<li style="background: #34526f;" value="#34526f">#34526f</li>');a.push('<li style="background: #00a0d1;" value="#00a0d1">#00a0d1</li>');a.push('<li style="background: #21759b;" value="#21759b">#21759b</li>');a.push('<li style="background: #d54e21;" value="#d54e21">#d54e21</li>');a.push('<li style="background: #464646;" value="#464646">#464646</li>');a.push('<li style="background: #5e8b1d;" value="#5e8b1d">#5e8b1d</li>');a.push('<li style="background: #0060a3;" value="#0060a3">#0060a3</li>');a.push('<li style="background: #f7f7f7;" value="#f7f7f7">#f7f7f7</li>');a.push("</ul>");a.push("</div>");$m.append(document.body,"div","htmlEditorOption",{display:"none"});$l.get("htmlEditorOption").innerHTML=a.join("")}var o="btn_qafeditor_{0}".format(e);var s="<div>"+'<div class="buttonGroup">'+'<button type="button" class="txtBtn icon-save" id="{0}_fontfamily" value="font-family" command="fontname" option="fontFamily" class="textEditorIcon font" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_fontsize" value="font-size" command="fontsize" option="fontSize" class="textEditorIcon size" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_cut" value="Cut" command="cut" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_copy" value="Copy" command="copy" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_paste" value="Paste" command="paste" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_bold" value="Bold" command="bold" class="textEditorIcon bold" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_italic" value="Italic" command="italic" class="textEditorIcon italic" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_underline" value="Underline" command="underline" class="textEditorIcon underline" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_strike" value="&lt;s&gt;" command="strikethrough" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_hr" value="&lt;hr /&gt;" command="inserthorizontalrule" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_undo" value="Undo" command="undo" class="textEditorIcon undo" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_redo" value="Redo" command="redo" class="textEditorIcon redo" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_bgcolor" value="bgcolor" command="backcolor" option="colorScheme" class="textEditorIcon forecolor" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_fgcolor" value="fgcolor" command="forecolor" option="colorScheme" class="textEditorIcon backcolor" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_left" value="left" command="justifyleft" class="textEditorIcon jleft" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_right" value="right" command="justifyright" class="textEditorIcon jright" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_center" value="center" command="justifycenter" class="textEditorIcon jcenter" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_justify" value="justify" command="justifyfull" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_ol" value="&lt;ol&gt;" command="insertorderedlist" class="textEditorIcon ol" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_ul" value="&lt;ul&gt;" command="insertunorderedlist" class="textEditorIcon ul" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_p" value="&lt;p&gt;" command="insertparagraph" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_indent" value="indent" command="indent" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_outdent" value="outdent" command="outdent" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_del" value="del" command="delete" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_image" value="&lt;img /&gt;" command="insertimage" class="textEditorIcon image" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_link" value="&lt;a&gt;" command="createLink" />'.format(o)+'<button type="button" class="txtBtn icon-save" id="{0}_unlink" value="unlink" command="unlink" />'.format(o)+"</div>"+'<div class="qaf__texteditor__form">'+'<iframe id="{0}" class="ui_editor" style="overflow:auto; width:{1}; height: {2}" src="{3}" syn-options="{dataType: \'string\', belongID: \'{4}\'}" scrolling="yes">'.format(e,t.width,t.height,d.contentHtmlUrl,t.belongID)+"{0}".format(t.contents)+"</iframe>"+"</div>"+"</div>";r.innerHTML=s;var l=$l.querySelectorAll("[id*='"+e+"_editbutton']");for(var u=0;u<l.length;u++){$l.addEvent(l[u],"click",function(e){var t=e.target||e.srcElement||e;var r=$l.get(t.id.replace("_editbutton",""));var n=t.getAttribute("command");var i=false;var a=t.getAttribute("option")||null;d.execCommand(r.id,n,a);t=null;r=null;n=null;i=null;a=null})}var f=$l.querySelectorAll("#textEditor_fontFamily li","#textEditor_fontSize li","#textEditor_colorScheme li");for(var u=0;u<f.length;u++){$l.addEvent(f[u],"click",function(e){var t=e.target||e.srcElement||e;var r={};r.elID=t.parentElement.getAttribute("elID");r.option=t.getAttribute("value");$w.closeDialog(r)})}var r=$l.get(e);r.onload=function(){d.setValue(e,t.contents)};if(t.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(e,t.bindingID)}},execCommand:function(e,o,t){if($ref.isString(e)==true){e=$l.get(e)}var r=false;e.contentWindow.focus();if(o.toLowerCase()=="insertimage"){if(t){d.insertImage(e,t)}else{}}else{if(t){var n=$reflection.clone(syn.$w.dialogOptions);var i=true;switch(t){case"fontFamily":n.minWidth=160;n.minHeight=240;break;case"fontSize":n.minWidth=280;n.minHeight=200;break;case"colorScheme":n.minWidth=160;n.minHeight=81;break;default:i=false;break}if(i==true){d.selection=e.contentWindow.getSelection();if(d.selection){d.range=d.selection.getRangeAt(0)}else{d.range=e.contentDocument.createRange()}$w.showDialog(syn.$l.get("textEditor_"+t),n,function(e){if(e){if(d.range&&$b.isIE){if(d.selection){d.selection.removeAllRanges();d.selection.addRange(d.range)}}var t=$l.get(e.elID);t.contentDocument.execCommand(o,false,e.option);if(o.toLowerCase()=="fontsize"){var r={1:12,2:13,3:16,4:18,5:24,6:32,7:36};var n=t.contentDocument.getElementsByTagName("font");var i="";for(var a=0;a<n.length;a++){i=n[a].getAttribute("size");if(i){n[a].removeAttribute("size");n[a].style.fontSize=r[i]+"px"}}}}})}else{if(o.toLowerCase()=="backcolor"){if(syn.$b.isIE==true){e.contentDocument.execCommand("hilitecolor",false,t)}else{e.contentDocument.execCommand("backcolor",false,t)}}else{e.contentDocument.execCommand(o,r,t)}}}else{e.contentDocument.execCommand(o,r,t)}}},insertImage:function(e,t){if($ref.isString(e)==true){e=$l.get(e)}e.focus();var r=e.contentDocument.selection;if(r){var n=r.createRange();e.contentDocument.execCommand("insertImage",false,t);n.collapse(false);n.select();n=null}else{e.contentDocument.execCommand("insertImage",false,t)}},insertHTML:function(e,t){if($ref.isString(e)==true){e=$l.get(e)}e.focus();var r=e.contentDocument.selection;if(r){var n=r.createRange();e.contentDocument.execCommand("insertHTML",false,t);n.collapse(false);n.select();n=null}else{e.contentDocument.execCommand("insertHTML",false,t)}},stripScripts:function(e){var t=document.createElement("div");t.innerHTML=e;var r=t.getElementsByTagName("script");var n=r.length;while(n--){r[n].parentNode.removeChild(r[n])}return t.innerHTML},getValue:function(e){var t=$l.get(e);return d.stripScripts(t.contentDocument.body.innerHTML)},setValue:function(e,t){var r=$l.get(e);r.contentDocument.body.innerHTML=t},clear:function(e,t){var r=$l.get(e);r.contentDocument.body.innerHTML=""},setLocale:function(e,t,r,n){}});syn.uicontrols.$editor=d})(window);(function(e){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var h=syn.uicontrols.$htmleditor||new syn.module;h.extend({name:"syn.uicontrols.$htmleditor",version:"1.0",businessID:"",editorControls:[],defaultSetting:{businessID:"",selector:"",fileManagerServer:"",repositoryID:null,dependencyID:null,relative_urls:false,remove_script_host:false,convert_urls:false,isNumberTempDependency:true,isQafRepositoryID:true,height:300,imageFileSizeLimit:3e5,viewerHtml:'<html><head><base href="/"><style type="text/css">body { font-family: \'ë§ì ê³ ë\', ëìì²´; font-size: 12px; }</style><link type="text/css" rel="stylesheet" href="/assets/bundle/lib/tinymce-5.6.0/skins/ui/oxide/content.min.css"><link type="text/css" rel="stylesheet" href="/assets/bundle/lib/tinymce-5.6.0/skins/content/default/content.min.css"></head><body id="tinymce" class="mce-content-body">{0}<script>document.onselectstart = () => { return false; }; document.oncontextmenu = () => { return false; }; document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !(e.ctrlKey && !e.altKey)) {e.preventDefault();}}}, false);<\/script></body></html>',language:"ko_KR",plugins:["autolink link image lists print hr anchor pagebreak searchreplace visualblocks visualchars code insertdatetime media nonbreaking table paste advcode help"],toolbar:"styleselect | bold italic forecolor backcolor table | alignleft aligncenter alignright | link image | code help",menubar:false,content_style:"body { font-family: 'ë§ì ê³ ë', ëìì²´; font-size: 12px; }",powerpaste_word_import:"merge",powerpaste_googledocs_import:"merge",defaultHtmlContent:null,table_default_attributes:{border:"1",width:"100%"},table_default_styles:{"border-collapse":"collapse",width:"100%"},table_responsive_width:false,limitTableWidth:null,verify_html:false,table_sizing_mode:"fixed",images_file_types:"jpeg,jpg,png,gif,bmp,webp,JPEG,JPG,PNG,GIF,BMP,WEBP",paste_data_images:true,resize:false,allowExternalLink:false,prefixHtml:"",suffixHtml:"",limitGuideLineWidth:"",dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(c,d){var f=$l.get(c);d=$w.argumentsExtend(h.defaultSetting,d);var e=window[syn.$w.pageScript];if(e&&e["controlInit"]){var t=e["controlInit"](c,d);d=$w.argumentsExtend(d,t)}if($string.isNullOrEmpty(d.repositoryID)==false){if(syn.Config.FileBusinessIDSource&&syn.Config.FileBusinessIDSource!="None"){if(syn.Config.FileBusinessIDSource=="Cookie"){h.businessID=$r.getCookie("FileBusinessID")}else if(syn.Config.FileBusinessIDSource=="SessionStorage"){h.businessID=$w.getStorage("FileBusinessID")}}if($string.isNullOrEmpty(h.businessID)==true){h.businessID=$w.SSO.WorkCompanyNo}if($string.isNullOrEmpty(h.businessID)==true){$l.eventLog("$htmleditor.controlLoad","íì¼ ì»¨í¸ë¡¤ ì´ê¸°í ì¤ë¥, íì¼ ìë¬´ ID ì ë³´ íì¸ íì","Warning");return}if(d.isQafRepositoryID==true){if(d.repositoryID&&d.repositoryID.length>7){d.repositoryID=syn.Config.ApplicationID+syn.Config.ProjectID+syn.Config.FileServerType+d.repositoryID.substring(7)}}if(syn.Config&&syn.Config.FileManagerServer){d.fileManagerServer=syn.Config.FileManagerServer}if($string.isNullOrEmpty(d.fileManagerServer)==true){$l.eventLog("$htmleditor.fileManagerServer","HTML í¸ì§ê¸° ìë¡ë ì´ê¸°í ì¤ë¥, íì¼ ìë² ì ë³´ íì¸ íì","Debug");return}if($string.isNullOrEmpty(d.dependencyID)==true){if(d.isNumberTempDependency==true){d.dependencyID=$date.toTicks(new Date).toString()}else{d.dependencyID=syn.uicontrols.$fileclient.getTemporaryDependencyID(c)}}d.paste_preprocess=function(e,t){};d.paste_postprocess=function(e,t){if(t.node.firstElementChild&&t.node.firstElementChild.tagName=="TABLE"&&(t.mode&&t.mode=="merge")==false){var r=t.node.firstElementChild;r.border="1";r.cellspacing="0";r.cellpadding="0";$m.setStyle(r,"border-collapse","collapse");var n=r.querySelectorAll("thead tr:first-child td");var i=n.length;if(i>0){for(var a=0;a<i;a++){var o=n[a];$m.setStyle(o,"background-color","#ecf0f1")}}else{n=r.querySelectorAll("tr:first-child td");i=n.length;if(i>0){for(var a=0;a<i;a++){var o=n[a];$m.setStyle(o,"background-color","#ecf0f1")}}}}};d.images_upload_handler=function(r,n,i){var a=function(i,r,a){var o=$w.xmlHttp();o.withCredentials=false;var e=d.fileManagerServer+"/api/filemanager/UploadFile?RepositoryID={0}&DependencyID={1}".format(d.repositoryID,d.dependencyID);if($string.isNullOrEmpty(h.businessID)==false){e=e+"&businessID="+h.businessID}o.open("POST",e);o.onload=function(){if(o.status!=200){var e="HTTP Error code: {0}, text: {1}".format(o.status,o.statusText);$l.eventLog("$htmleditor.images_upload_handler",e,"Warning");a(e);return}try{var n=JSON.parse(o.responseText);if(n&&n.Result==true){$r.path=d.fileManagerServer+"/api/filemanager/ActionHandler";$r.params["action"]="GetItem";$r.params["repositoryID"]=d.repositoryID;$r.params["itemID"]=n.ItemID;if($string.isNullOrEmpty(h.businessID)==false){$r.params["businessID"]=h.businessID}var t=new syn.$w.xmlHttp;t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(t.status===200){var e=JSON.parse(t.responseText);n.location=e.AbsolutePath;r(n.location);setTimeout(function(){var e=tinymce.activeEditor.$('img[src$="'+n.location+'"]');if(e.length>0){var t=i.width;var r=i.height;tinymce.activeEditor.dom.setStyle(e,"width",t);tinymce.activeEditor.dom.setStyle(e,"height",r);e.attr("width",t);e.attr("height",r);e.after("&nbsp;")}},100)}else{$l.eventLog("$htmleditor.images_upload_handler","async url: "+url+", status: "+t.status.toString()+", responseText: "+t.responseText,"Error")}}};t.open("GET",$r.url(),true);t.send()}else{var e=n.Message;$w.alert("ì´ë¯¸ì§ ìë¡ë ì¤í¨: {0}".format(e));$l.eventLog("$htmleditor.images_upload_handler",e,"Warning");a(e);return}}catch(e){$w.alert("ì´ë¯¸ì§ ìë¡ë ì¤ë¥: {0}".format(e.message));$l.eventLog("$htmleditor.images_upload_handler",e,"Warning");a(e)}};o.onerror=function(){var e="HTTP Error code: {0}, text: {1}".format(o.status,o.statusText);$l.eventLog("$htmleditor.images_upload_handler",e,"Warning");a(e)};var t=new FormData;t.append("file",i.blob,i.fileName);o.send(t)};var e=r.blob().size;if(d.imageFileSizeLimit<e){var t="ìëí°ì íì ê°ë¥í ì´ë¯¸ì§ íì¼í¬ê¸°ë {0} ë¯¸ë§ìëë¤".format($number.toByte(d.imageFileSizeLimit));$w.alert(t);var o=r.blobUri();$r.revokeBlobUrl(o);i(t);var s=tinymce.activeEditor.$('img[src$="'+o+'"]');if(s.length>0){s.remove()}}else{try{var l=window[syn.$w.pageScript];var u=l["{0}_beforeUploadImageResize".format(c)];if(u){u.apply(f,[c,r,function(e){a({blob:e.blob,width:e.width,height:e.height,fileName:r.filename()},n,i)}])}else{h.resizeImage(r.blob(),0).then(function(e){a({blob:adjustBlobInfo.blob,width:adjustBlobInfo.width,height:adjustBlobInfo.height,fileName:r.filename()},n,i);var t=$this.$htmleditor.getHtmlEditor(c);t.execCommand("mceRepaint")})}}catch(e){$l.eventLog("$htmleditor.images_upload_handler",e.toString(),"Error")}}}}else{$l.eventLog("$htmleditor.fileManagerServer","HTML í¸ì§ê¸° íì¼ ìë¡ë ì´ê¸°í ì¤ë¥, repositoryID ì ë³´ íì¸ íì","Debug");return}d.width=f.style.width||320;d.height=f.style.height||240;f.setAttribute("id",f.id+"_hidden");f.setAttribute("syn-options",JSON.stringify(d));f.style.display="none";var r=f.parentNode;var n=document.createElement("div");n.style.width=d.width;n.style.height=d.height;n.id=c;n.innerHTML=$string.isNullOrEmpty(f.innerHTML)==true?"<div></div>":f.innerHTML;r.appendChild(n);d.selector="#"+c;d.init_instance_callback=function(u){var f=$l.get(c);var e=f.getAttribute("setInitValue");if(e){u.setContent(e)}u.on("keydown",function(e){var t=e.keyCode||e.which;if(t==9){u.execCommand("mceInsertContent",false,"&nbsp;&nbsp;&nbsp;&nbsp;");tinymce.dom.Event.cancel(e);e.preventDefault();return}});u.on("ObjectResized",function(e){if(e.target.nodeName=="TABLE"){var t=e.target;if($string.isNullOrEmpty(d.limitTableWidth)==false&&d.limitTableWidth<t.style.width){t.style.width=d.limitTableWidth}if($string.isNullOrEmpty(t.style.width)==false){t.setAttribute("width",t.style.width)}if($string.isNullOrEmpty(t.style.height)==false){t.setAttribute("height",t.style.height)}var r=e.target.querySelectorAll("td");var n=r.length;for(var i=0;i<n;i++){var a=r[i];if($string.isNullOrEmpty(a.style.width)==false){a.setAttribute("width",a.style.width)}if($string.isNullOrEmpty(a.style.height)==false){a.setAttribute("height",a.style.height)}}}if(e.target.nodeName=="IMG"){var o=tinymce.activeEditor.selection.getNode();var s=window[syn.$w.pageScript];var l=s["{0}_imageResized".format(c)];if(l){l.apply(f,[c,e,u,o])}}});if($string.isNullOrEmpty(d.defaultHtmlContent)==false){u.setContent(d.defaultHtmlContent)}h.editorControls.push({id:c,editor:u,setting:$reflection.clone(d)});if(d.readonly==true){Array.from(u.getDoc().querySelectorAll("a")).map(function(e){e.target="_blank"})}if(d.readonly==true&&d.allowExternalLink==true){Array.from(u.getDoc().querySelectorAll(".mce-object-iframe")).map(function(e){e.setAttribute("data-mce-selected","2")})}var t=window[syn.$w.pageScript];var r=t["{0}_documentReady".format(c)];if(r){r.apply(f,[c,u])}};tinymce.init(d);if($string.isNullOrEmpty(d.limitGuideLineWidth)==false){$l.get(c).controlPseudoStyle(" + div .tox-edit-area:after",'{content: "";width: 2px;height: 100%;background: #EF4444 repeat-y;top: 0px;left: {0};position: absolute;display: inline-block;}'.format(d.limitGuideLineWidth))}if(d.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(c,d.bindingID)}},resizeImage:function(n,i){var a=new FileReader;var o=new Image;var s=document.createElement("canvas");var l=function(e){var t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);var r=e.split(",")[0].split(":")[1].split(";")[0];var n=t.length;var i=new Uint8Array(n);for(var a=0;a<n;a++)i[a]=t.charCodeAt(a);return new Blob([i],{type:r||"image/jpeg"})};var u=function(){var e=o.width;var t=o.height;if(e>t){if(i<=0){i=600;if(e>i){t*=i/e;e=i}}else{if(e>i){t*=i/e;e=i}}}else{if(i<=0){i=600;if(t>i){e*=i/t;t=i}}else{if(t>i){e*=i/t;t=i}}}s.width=e;s.height=t;s.getContext("2d").drawImage(o,0,0,e,t);var r=s.toDataURL("image/jpeg");return{blob:l(r),width:e,height:t}};return new Promise(function(t,e){var r=n.blob();if(!r.type.match(/image.*/)){e(new Error("ì´ë¯¸ì§ íì¼ íì¸ íì"));return}a.onload=function(e){o.onload=function(){return t(u())};o.src=e.target.result};a.readAsDataURL(r)})},getHtmlEditor:function(e){var t=null;var r=h.editorControls.length;for(var n=0;n<r;n++){var i=h.editorControls[n];if(i.id==e){t=i.editor;break}}return t},getHtmlSetting:function(e){var t=null;var r=h.editorControls.length;for(var n=0;n<r;n++){var i=h.editorControls[n];if(i.id==e){t=i.setting;break}}return t},setMode:function(e,t){var r=h.getHtmlEditor(e);if(r){r.setMode(t)}},insertContent:function(e,t){var r=h.getHtmlEditor(e);if(r){r.insertContent(t)}},execCommand:function(e,t,r,n,i){var a=false;var o=h.getHtmlEditor(e);if(o){if($object.isNullOrUndefined(r)==true){r=false}a=o.execCommand(t,r,n,i)}return a},isDirty:function(e){var t=false;var r=h.getHtmlEditor(e);if(r){t=r.isDirty()}return t},updateDependencyID:function(e,t,r){var n=h.getHtmlSetting(e);$r.path=n.fileManagerServer+"/api/filemanager/ActionHandler";$r.params["action"]="UpdateDependencyID";$r.params["repositoryID"]=n.repositoryID;$r.params["sourceDependencyID"]=n.dependencyID;$r.params["targetDependencyID"]=t;syn.uicontrols.$fileclient.executeProxy(syn.$r.url(),r)},getDependencyID:function(e){var t="";var r=h.getHtmlSetting(e);if(r){t=r.dependencyID}return t},setDependencyID:function(e,t){var r=h.getHtmlSetting(e);if(r){r.dependencyID=t}},getValue:function(e,t){var r=null;var n=h.getHtmlEditor(e);if(n){r=n.getContent();var i=h.getHtmlSetting(e);if($string.isNullOrEmpty(i.limitTableWidth)==false){var a=r.match(/<table[^>]*>(.*?)/gim);if($string.isNullOrEmpty(a)==false){for(var o=0;o<a.length;o++){var s=a[o];if(s.indexOf("width=")==-1){r=r.replace(s,s.substring(0,s.length-1)+' width="{0}">'.format(i.limitTableWidth))}}}}if($string.isNullOrEmpty(i.prefixHtml)==false){r=i.prefixHtml+r}if($string.isNullOrEmpty(i.suffixHtml)==false){r=r+i.suffixHtml}}r=r.replace(/&amp;/gm,"&");r=r.replace(/\<p\>\<\/p\>/gm,"<p>&nbsp;</p>");r=r.replace(/\<p style="text-align: left;"\>\<\/p\>/gm,'<p style="text-align: left;">&nbsp;</p>');r=r.replace(/\<p style="text-align: center;"\>\<\/p\>/gm,'<p style="text-align: center;">&nbsp;</p>');r=r.replace(/\<p style="text-align: right;"\>\<\/p\>/gm,'<p style="text-align: right;">&nbsp;</p>');return r},setValue:function(e,t,r){var n=h.getHtmlEditor(e);var i=$l.get("{0}_hidden".format(e)).getAttribute("syn-options");if($object.isNullOrUndefined(i)==false){var a=JSON.parse(i);if($string.isNullOrEmpty(a.prefixHtml)==false){if($string.isNullOrEmpty(a.prefixHtml)==false&&t.startsWith(a.prefixHtml)==true){t=t.replace(a.prefixHtml,"")}}if($string.isNullOrEmpty(a.suffixHtml)==false){if($string.isNullOrEmpty(a.suffixHtml)==false&&t.endsWith(a.suffixHtml)==true){t=t.replace(a.suffixHtml,"")}}}if(n){n.setContent(t)}else{$l.get(e).setAttribute("setInitValue",t)}},clear:function(e,t){var r=h.getHtmlEditor(e);if(r){r.setContent("")}},setLocale:function(e,t,r,n){}});syn.uicontrols.$htmleditor=h})(globalThis);(function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $tree=syn.uicontrols.$tree||new syn.module;$tree.extend({name:"syn.uicontrols.$tree",version:"1.0",treeControls:[],eventHooks:["blurTree","focusTree","activate","beforeActivate","beforeExpand","beforeSelect","blur","click","collapse","createNode","dblclick","expand","focus","keydown","keypress","select"],defaultSetting:{width:"100%",height:"300px",itemID:"id",parentItemID:"parentID",childrenID:"children",reduceMap:{key:"key",title:"title",parentID:"parentID",folder:"folder",icon:false},toggleEffect:false,checkbox:false,extensions:["persist","multi","filter"],persist:{expandLazy:false,expandOpts:{noAnimation:false,noEvents:false},overrideSource:true,store:"session",types:"active expanded focus selected"},multi:{mode:"sameParent"},filter:{counter:false,mode:"hide"},source:[],dataType:"string",belongID:null,getter:false,setter:false,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);$tree.defaultSetting.persist=false;$tree.defaultSetting.multi=false;setting=$w.argumentsExtend($tree.defaultSetting,setting);var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleSettings)}setting.width=el.style.width||setting.width;setting.height=el.style.height||setting.height;el.setAttribute("id",elID+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var hookEvents=el.getAttribute("syn-events");try{if(hookEvents){hookEvents=eval(hookEvents)}}catch(e){$l.eventLog("TreeView_controlLoad",e.toString(),"Debug")}for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];if($tree.eventHooks.indexOf(hookEvent)>-1){if($object.isNullOrUndefined(setting[hookEvent])==true){setting[hookEvent]=function(t,e){var r=$tree.eventHooks.find(function(e){return e.toLowerCase()==t.type.replace("fancytree","")});var n=window[syn.$w.pageScript];if(n){var i=n["{0}_{1}".format(elID,r)];if(i){i.apply(syn.$l.get(elID),[t,e])}}}}}}var parent=el.parentNode;var wrapper=document.createElement("div");wrapper.style.width=setting.width;wrapper.style.height=setting.height;wrapper.className="tree-container border";wrapper.innerHTML='<div id="'+elID+'"></div>';parent.appendChild(wrapper);$tree.treeControls.push({id:elID,element:$("#"+elID).fancytree(setting),tree:$.ui.fancytree.getTree("#"+elID),config:setting});if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},getValue:function(e,t){var r=null;var n=$tree.getControl(e).tree;if(n){var i=$tree.getControl(e).config;var a=i.reduceMap;var o=n.toDict(true);var s=$l.nested2Flat(o,i.itemID,i.parentItemID,i.childrenID);var l=[];var u=s.length;for(var f=0;f<u;f++){var c=s[f];var d=c.data;if(d){d[a.key]=c.key;d[a.title]=c.title;d[a.parentID]=c.parentID;d[a.folder]=c.folder;l.push(d)}}r=l}return r},setValue:function(e,t,r){var n=$tree.getControl(e).tree;if(n){var i=$tree.getControl(e).config;var a=i.reduceMap;var o=[];var s=t.length;for(var l=0;l<s;l++){var u=t[l];o.push({key:u[a.key],title:u[a.title],parentID:u[a.parentID],folder:$string.toBoolean(u[a.folder]),icon:false,data:$ref.clone(u,false)})}var f=$l.flat2Nested(o,i.itemID,i.parentItemID,i.childrenID);n.reload([f])}},clear:function(e,t){var r=$tree.getControl(e).tree;if(r){r.reload([])}},getControl:function(e){var t=null;var r=$tree.treeControls.length;for(var n=0;n<r;n++){var i=$tree.treeControls[n];if(i.id==e){t=i;break}}return t},getActiveNode:function(e){var t=null;var r=$tree.getControl(e).tree;if(r){t=r.getActiveNode()}return t},toogleEnabled:function(e){var t=false;var r=$tree.getControl(e).tree;if(r){t=!r.options.disabled;r.enable(!t)}return t},getRootNodeID:function(e){var t=null;var r=$tree.getControl(e).tree;if(r){t=r.rootNode.key.replace("root_","")}return t},activateKey:function(e,t){if($object.isNullOrUndefined(t)==true){return}var r=$tree.getControl(e).tree;if(r){r.activateKey(t)}},expendLevel:function(e,t){if($object.isNullOrUndefined(t)==true){t=1}var r=$tree.getControl(e).tree;if(r){r.visit(function(e){if(e.getLevel()<t){e.setExpanded(true)}})}},collapseLevel:function(e,t){if($object.isNullOrUndefined(t)==true){t=1}var r=$tree.getControl(e).tree;if(r){r.visit(function(e){if(e.getLevel()<t){e.setExpanded(false)}})}},expandAll:function(e){var t=$tree.getControl(e).tree;if(t){t.expandAll()}},collapseAll:function(e){var t=$tree.getControl(e).tree;if(t){t.expandAll(false)}},getSelectedNodes:function(e){var t=[];var r=$tree.getControl(e).tree;if(r){t=r.getSelectedNodes()}return t},filterNodes:function(e,t){var r=[];var n=$tree.getControl(e).tree;if(n){n.filterNodes(t,{autoExpand:true})}return r},filterBranches:function(e,t){var r=[];var n=$tree.getControl(e).tree;if(n){n.filterBranches(t,{autoExpand:true,leavesOnly:true})}return r},clearFilter:function(e){var t=[];var r=$tree.getControl(e).tree;if(r){t=r.clearFilter()}return t},setSelectedAll:function(e,t){var r=[];var n=$tree.getControl(e).tree;if(n){var i=t.isSelected();t.visit(function(e){e.setSelected(i)})}return r},setLocale:function(e,t,r,n){}});syn.uicontrols.$tree=$tree})(window);(function(window){"use strict";if(window.Handsontable){var textEditor=Handsontable.editors.TextEditor.prototype.extend();Handsontable.validators.registerValidator("require",function(e,t){var r=false;if($string.isNullOrEmpty(e)==true){r=false}else{r=true}if(t){t(r)}return r});Handsontable.cellTypes.registerCellType("codehelp",{editor:textEditor,renderer:function(e,t,r,n,i,a,o){Handsontable.renderers.TextRenderer.apply(this,arguments);var s;var l;l=document.createElement("SPAN");l.textContent=a;s=document.createElement("BUTTON");s.classList.add("codehelp");s.classList.add("icon-search");s.tag=[e,t,r,n,i,a,o];Handsontable.dom.addEvent(s,"click",function(e){e.preventDefault();var t=e.currentTarget;var i=t.tag[0];var a=t.tag[2];var o=t.tag[3];var s=t.tag[4];var r=i.getSettings().columns;var l=r.filter(function(e){return e.data==s})[0];var u=i.rootElement.id;var n=$w.argumentsExtend(syn.uicontrols.$codepicker.defaultSetting,l);n.elID=u;n.controlType="grid";syn.uicontrols.$codepicker.find(n,function(e){if(e&&l.codeColumnID&&l.textColumnID){var t=[];t.push([a,i.propToCol(l.codeColumnID),e[0].value]);t.push([a,o,e[0].text]);i.setDataAtCell(t)}var r=window[syn.$w.pageScript];var n=r["frameEvent"];if(n){n.call(this,"codeReturn",{elID:u,row:a,col:o,columnName:s,result:e})}})});Handsontable.dom.empty(t);t.appendChild(s);t.appendChild(l);if(o&&o.className){var u=o.className.split(" ");for(var f=0;f<u.length;f++){var c=u[f];if(c!=""){$m.addClass(t,c)}}}return t},validator:function(e,t){t(true)},allowInvalid:true});Handsontable.cellTypes.registerCellType("button",{renderer:function(i,e,a,o,s,l,t){Handsontable.renderers.TextRenderer.apply(this,arguments);if($string.isNullOrEmpty(l)==false){var r=i.getSettings().columns[o].columnOptions;var n=document.createElement("BUTTON");n.classList.add("celltype");if(r){if(r.clearBorder==true){n.style.border="0px";n.style.backgroundColor="transparent";n.style.textDecoration="underline"}if(r.color){n.style.color=r.color}if(r.bold==true){n.style.fontWeight="900"}}if(l.indexOf&&l.indexOf("|")>-1){var u=l.split("|");n.classList.add(u[0]);l=u[1]}n.tag=[i,e,a,o,s,l,t];n.setAttribute("data",l);n.textContent=r&&$string.toBoolean(r.toCurrency)==true?$string.toCurrency(l):l;$l.addEvent(n,"click",function(e){e.preventDefault();var t=event.target||event.srcElement;var r=window[syn.$w.pageScript];var n=r["{0}_cellButtonClick".format(i.elID)];if(n){n.apply(t,[i.elID,a,o,s,l])}});Handsontable.dom.empty(e);e.appendChild(n);if(t&&t.className){var f=t.className.split(" ");for(var c=0;c<f.length;c++){var d=f[c];if(d!=""){$m.addClass(e,d)}}}}return e},validator:function(e,t){t(true)},allowInvalid:true});Handsontable.cellTypes.registerCellType("safehtml",{editor:textEditor,renderer:function(e,t,r,n,i,a,o){var s=Handsontable.helper.stringify(a);var l=function(e,r){var t=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,n=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;r=(((r||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(n,"").replace(t,function(e,t){return r.indexOf("<"+t.toLowerCase()+">")>-1?e:""})};s=l(s,"<em><p><br><b><u><strong><a><big><img>");t.innerHTML=s;if(o&&o.className){var u=o.className.split(" ");for(var f=0;f<u.length;f++){var c=u[f];if(c!=""){$m.addClass(t,c)}}}return t},validator:function(e,t){t(true)},allowInvalid:true});Handsontable.cellTypes.registerCellType("image",{editor:textEditor,renderer:function(e,t,r,n,i,a,o){Handsontable.renderers.TextRenderer.apply(this,arguments);var s=Handsontable.helper.stringify(a),l;if(s.indexOf("http")===0){l=document.createElement("IMG");l.src=a;Handsontable.dom.addEvent(l,"click",function(e){e.preventDefault()});Handsontable.dom.empty(t);t.appendChild(l)}else{Handsontable.renderers.TextRenderer.apply(this,arguments)}if(o&&o.className){var u=o.className.split(" ");for(var f=0;f<u.length;f++){var c=u[f];if(c!=""){$m.addClass(t,c)}}}return t},validator:function(e,t){t(true)},allowInvalid:true});Handsontable.cellTypes.registerCellType("radio",{renderer:function(c,e,d,h,v,t,r){Handsontable.renderers.TextRenderer.apply(this,arguments);var n="rdo_{0}_{1}_{2}".format(c.elID,d,h);var i=document.createElement("INPUT");i.id=n;i.type="radio";$m.addClass(i,"ui_radio");var a=document.createElement("LABEL");a.setAttribute("for",n);if(t){if($string.toBoolean(t)===true){i.checked=true}else{i.checked=false}}Handsontable.dom.addEvent(a,"click",function(e){e.preventDefault();var t=$l.get((event.target||event.srcElement).getAttribute("for"));var r=window[syn.$w.pageScript];var n=c.getSettings();var i=n.columns[h].readOnly;var a=c.getCellMeta(d,h);if(i===false&&a.readOnly==false){if(n.data&&n.data.length>0){var o=n.data;var s=o.length;for(var l=0;l<s;l++){if($string.toBoolean(o[l][v])==true){if(o[l]["Flag"]=="R"){o[l]["Flag"]="U"}o[l][v]=0;var u=$l.get("rdo_{0}_{1}_{2}".format(c.elID,l,h));if(u){u.checked=false}}}}t.checked=!t.checked;c.setDataAtCell(d,h,t.checked===true?1:0);var f=r["{0}_cellRadioClick".format(c.elID)];if(f){f.apply(t,[c.elID,d,h,v,t.checked===true?1:0])}c.render()}});Handsontable.dom.empty(e);e.appendChild(i);e.appendChild(a);if(r&&r.className){var o=r.className.split(" ");for(var s=0;s<o.length;s++){var l=o[s];if(l!=""){$m.addClass(e,l)}}}return e},validator:function(e,t){t(true)},allowInvalid:true});Handsontable.cellTypes.registerCellType("checkbox2",{renderer:function(o,e,s,l,u,t,r){Handsontable.renderers.TextRenderer.apply(this,arguments);var n="chk_qafgrid_{0}_{1}_{2}".format(o.elID,s,l);var i=document.createElement("INPUT");i.id=n;i.type="checkbox";$m.addClass(i,"ui_checkbox");var a=document.createElement("LABEL");a.setAttribute("for",n);if(t){if($string.toBoolean(t)===true){i.checked=true}else{i.checked=false}}Handsontable.dom.addEvent(a,"click",function(e){e.preventDefault();var t=$l.get((event.target||event.srcElement).getAttribute("for"));var r=window[syn.$w.pageScript];var n=o.getSettings().columns[l].readOnly;var i=o.getCellMeta(s,l);if(n==false||i.readOnly==false){t.checked=!t.checked;o.setDataAtCell(s,l,t.checked===true?1:0);var a=r["{0}_cellCheckboxClick".format(o.elID)];if(a){a.apply(t,[o.elID,s,l,u,t.checked===true?1:0])}}});Handsontable.dom.empty(e);e.appendChild(i);e.appendChild(a);if(r&&r.className){var f=r.className.split(" ");for(var c=0;c<f.length;c++){var d=f[c];if(d!=""){$m.addClass(e,d)}}}return e},validator:function(e,t){t(true)},allowInvalid:true})}syn.uicontrols=syn.uicontrols||new syn.module;var $grid=syn.uicontrols.$grid||new syn.module;$grid.extend({name:"syn.uicontrols.$grid",version:"1.0",defaultHotSettings:{licenseKey:"non-commercial-and-evaluation",language:"ko-KR",data:[],colWidths:120,rowHeaders:false,copyPaste:true,beforePaste:function(e,t){return false},autoColumnSize:false,stretchH:"none",undo:false,observeChanges:false,observeDOMVisibility:true,currentRowClassName:"currentRow",manualColumnResize:true,manualRowResize:false,manualColumnMove:false,manualRowMove:false,manualColumnFreeze:false,autoInsertRow:false,isRemoveRowHidden:true,autoWrapRow:true,outsideClickDeselects:true,selectionMode:"range",sortIndicator:false,columnSorting:true,wordWrap:false,dropdownMenu:false,filters:true,isContainFilterHeader:false,firstShowColIndex:null,lastShowColIndex:null,fillHandle:false,contextMenu:{items:{copy:{name:"ë´ì©ë³µì¬"},hidden_columns_hide:{name:"ì»¬ë¼ ì¨ê¹",callback:function(e,t,r){if(t&&t.length>0){var n=t[0];var i=n.start.col;var a=n.end.col;var o=[];for(i;i<=a;i++){o.push(i)}$grid.visibleColumns(this.elID,o,false);var s=window[syn.$w.pageScript];if(s){var l=s["{0}_{1}".format(this.elID,"afterHiddenColumns")];if(l){l.apply(syn.$l.get(this.elID),[o])}}}}},hidden_columns_show:{name:"ì»¬ë¼ íì",callback:function(e,t,r){if(t&&t.length>0){var n=t[0];var i=n.start.col;var a=n.end.col;var o=[];for(i;i<=a;i++){o.push(i)}$grid.visibleColumns(this.elID,o,true);var s=window[syn.$w.pageScript];if(s){var l=s["{0}_{1}".format(this.elID,"afterUnHiddenColumns")];if(l){l.apply(syn.$l.get(this.elID),o)}}}}},columns_chooser:{name:"ì»¬ë¼ íì ì í",callback:function(e,t,r){var n=this;var a=this.elID;var i=$reflection.clone(syn.$w.dialogOptions);i.minWidth=240;i.minHeight=240;var o=$l.get("columnChooserHtml");if(!o){var s=$m.create({tag:"div",id:"columnChooserHtml"});s.style.display="none";s.innerHTML='<h3 class="mt-0 mb-0">ì»¬ë¼ íì ì í</h3><div class="btn-area"><input type="button" id="btnColumnApply" class="btn btn-primary" value="ì»¬ë¼ íì ì ì©"></div><ul class="row" id="lstChooseColumns" style = "overflow: auto; height: 150px; width:360px; padding-top:10px; padding-left:10px;" > <li><input type="checkbox" id="a"><label for="a">ì»¬ë¼ëª</label></li></ul>';document.body.appendChild(s);o=$l.get("columnChooserHtml")}Handsontable.dom.addEvent(o.querySelector("#btnColumnApply"),"click",function(){var e=[];var t=$l.get("lstChooseColumns").children;for(var r=0;r<t.length;r++){var n=t[r];var i=n.children[0].id.split("_")[2];var a=!n.children[0].checked;e.push({col:r,colID:i,isHidden:a})}$w.closeDialog(e)});var l=o.querySelector("ul");l.innerHTML="";var u=n.getSettings();var f=n.getSettings().colHeaders;var c=u.columns;for(var d=1;d<c.length;d++){var h=f[d];var v=c[d];var p=$m.createElement("li");var p=$m.create({tag:"li",className:"col-12"});$m.setStyle(p,"padding-top","10px");var g="{0}_checkbox_{1}".format(a,v.data);var m=$grid.isColumnHidden(a,d);var y=$m.create({tag:"input",id:g,attributes:{type:"checkbox"}});y.checked=!m;var b=$m.create({tag:"label",id:"{0}_label_{1}".format(a,v.data),attributes:{for:g}});$m.setStyle(b,"padding-left","10px");b.textContent=h;$m.appendChild(p,y);$m.appendChild(p,b);$m.appendChild(l,p)}$w.showDialog(syn.$l.get("columnChooserHtml"),i,function(e){if(e){var t=[];var r=[];for(var n=1;n<c.length;n++){var i=e[n-1];if(i){if(i.isHidden==false){t.push(n)}else{r.push(n)}}}$grid.visibleColumns(a,t,true);$grid.visibleColumns(a,r,false)}})}}}},hiddenColumns:{columns:[0],indicators:false},deleteKeyColumns:[],keyLockedColumns:[],summarys:[],exportColumns:[],transactConfig:null,triggerConfig:null},gridControls:[],handsontableHooks:null,gridHooks:[],gridCodeDatas:[],addModuleList:function(e,t,r,n){var i=e.getAttribute("id");var a=e.getAttribute("syn-datafield");var o=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:o,field:a,module:this.name,type:n})},controlLoad:function(elID,setting){var el=$l.get(elID);setting=$w.argumentsExtend($grid.defaultHotSettings,setting);if(setting.columns){var moduleHotSettings=$grid.getInitializeColumns(setting,elID);setting=$w.argumentsExtend(setting,moduleHotSettings)}var mod=window[syn.$w.pageScript];if(mod&&mod["controlInit"]){var moduleHotSettings=mod["controlInit"](elID,setting);setting=$w.argumentsExtend(setting,moduleHotSettings)}setting.elementID=elID;setting.colHeaders=setting.colHeaders||["Flag","A","B","C"];if(setting.colHeaders.indexOf("Flag")==-1){setting.colHeaders.unshift("Flag");setting.colWidths.unshift(10)}setting.columns=setting.columns||[{data:0},{data:1},{data:2},{data:3}];var isFlagColumn=false;var columnCount=setting.columns.length;for(var i=0;i<columnCount;i++){var column=setting.columns[i];if(column.data=="Flag"){isFlagColumn=true;break}}if(isFlagColumn==false){setting.columns.unshift({data:"Flag",type:"text",readOnly:true})}if(setting.dropdownMenu===true){setting.dropdownMenu=["filter_by_condition","filter_operators","filter_by_condition2","filter_action_bar"]}else{setting.dropdownMenu=false}var debounceFn=Handsontable.helper.debounce(function(e,t){var r=t.target||t.srcElement;e=$grid.getActiveColIndex(r.gridID);var n=$grid.getGridControl(r.gridID);var i=n.getPlugin("filters");if(i.isEnabled()==false){i.enablePlugin()}i.clearConditions(e);if(t.target.value.length>0){i.addCondition(e,"contains",[t.target.value])}i.filter()},100);var isSummary=false;if(setting.summarys&&setting.summarys.length>0){isSummary=true;setting.fixedRowsBottom=1;setting.cells=function(e,t,r){var n=this.instance;var i=$grid.getGridValue(n.elID);if(i.applyCells==true){var a=n.getSettings();if(a.summarys&&a.summarys.length>0){var o=a.data.length-1;if(e===o){var s={};s.type="text";s.readOnly=true;s.className="summaryRow";var l=a.columns.find(function(e){return e.data==r});if(l&&l.className&&l.className.indexOf(s.className)==-1){s.className+=" "+l.className}return s}}}var u=window[syn.$w.pageScript];if(u){var f=u["{0}_applyCells".format(n.elID)];if(f){var s=f.apply(n,[n.elID,e,t,r]);if(s){return s}}}}}else{setting.cells=function(e,t,r){var n=window[syn.$w.pageScript];if(n){var i=this.instance;var a=n["{0}_applyCells".format(i.elID)];if(a){var o=a.apply(i,[i.elID,e,t,r]);if(o){return o}}}}}setting.beforeColumnSort=function(e,t){var r=this;var n=r.getSettings();if(n.summarys&&n.summarys.length>0){var i=$grid.getGridValue(r.elID);i.applyCells=false;var n=r.getSettings();var a=n.data.find(function(e){return e["Flag"]=="S"});if(a){var o=n.data.indexOf(a);if(o>-1){n.data.splice(o,1)}}}};setting.afterColumnSort=function(e,t){var r=this;var n=r.getSettings();if(n.summarys&&n.summarys.length>0){$grid.renderSummary(r)}};setting.afterGetColHeader=function(h,e){if(typeof h!=="number"){return h}if(h>=0&&setting.isContainFilterHeader==true&&e.childElementCount<2){var t=document.createElement("div");var v=document.createElement("input");t.className="filterHeader";v.gridID=elID;Handsontable.dom.addEvent(v,"contextmenu",function(e){Handsontable.dom.stopImmediatePropagation(e);if(e.preventDefault){e.preventDefault()}return false});Handsontable.dom.addEvent(v,"keydown",function(e){debounceFn(h,e)});Handsontable.dom.addEvent(v,"focus",function(e){var t=window[syn.$w.pageScript];if(t){t.focusControl=$l.get(v.gridID)}});t.appendChild(v);e.appendChild(t)}var r=$ref.isArray(setting.dropdownMenu)==true?3:2;var p=setting.columns[h];if(p&&p.isSelectAll===true){r=r+2}if(h>=0&&p&&(p.type=="checkbox"||p.type=="checkbox2")&&p.isSelectAll===true&&e.firstElementChild.childElementCount<r){if(e.firstElementChild.childElementCount!=3&&$m.hasClass(e,"hiddenHeader")==false){var n="chk_qafgrid_All_{0}_{1}".format(elID,h);if(syn.$l.get(n)!=null){$m.remove(syn.$l.get(n));$m.remove(syn.$l.querySelector('label[for="'+n+'"]'))}var v=document.createElement("input");v.id=n;v.type="checkbox";v.setAttribute("columnSelectAll","1");v.gridID=elID;v.checked=p.toogleChecked==1?true:false;$m.addClass(v,"ui_checkbox");var i=document.createElement("LABEL");i.setAttribute("for",n);if(v.checked==true){$m.addClass(i,"ui_checkbox")}else{$m.removeClass(i,"ui_checkbox")}Handsontable.dom.addEvent(i,"click",function(e){var t=$l.get((e.target||e.srcElement).getAttribute("for"));t.checked=!t.checked;var r=t.checked?1:0;p.toogleChecked=r;var n=e.target||e.srcElement;if(t.checked==true){$m.addClass(n,"ui_checkbox")}else{$m.removeClass(n,"ui_checkbox")}var i=window[syn.$w.pageScript];var a=i["{0}_selectAllCheck".format(v.gridID)];if(a){a.apply(t,[v.gridID,h,$string.toBoolean(p.toogleChecked.toString())]);var o=$grid.getGridControl(t.gridID);o.render()}else{var o=$grid.getGridControl(t.gridID);var s=$grid.getSettings(t.gridID);if(s.data&&s.data.length>0){var l=s.data;var u=l.length;var f=o.colToProp(h);for(var c=0;c<u;c++){var d=l[c]["Flag"];if(d=="R"){l[c]["Flag"]="U"}if(d!="S"){l[c][f]=r}}}o.render()}e.stopImmediatePropagation()});$m.prepend(i,e.firstElementChild);$m.prepend(v,e.firstElementChild)}}else{var a=e.querySelector('input[type="checkbox"]');if(h>=0&&p&&(p.type=="checkbox"||p.type=="checkbox2")&&a!=null){e.firstElementChild.removeChild(a);var i=e.querySelector("label[for]");e.firstElementChild.removeChild(i)}}};if(setting.isContainFilterHeader==true){setting.className="contain-filter-header"}setting.width=setting.width||"100%";setting.height=setting.height||240;el.setAttribute("id",el.id+"_hidden");el.setAttribute("syn-options",JSON.stringify(setting));el.style.display="none";var parent=el.parentNode;var wrapper=document.createElement("div");if(isSummary==true){$m.addClass(wrapper,"summaryRow")}wrapper.id=elID;parent.appendChild(wrapper);var fileEL=document.createElement("input");fileEL.id="{0}_ImportFile".format(elID);fileEL.type="file";fileEL.style.display="none";fileEL.accept=".csv, .xls, .xlsx";Handsontable.dom.addEvent(fileEL,"change",$grid.importFileLoad);parent.appendChild(fileEL);el=$l.get(elID);if(!$grid.handsontableHooks){$grid.handsontableHooks=Handsontable.hooks.getRegistered()}$grid.gridHooks=["afterChange","afterCreateRow","afterRemoveRow","hiddenRow","beforeOnCellMouseDown","afterSelectionEnd","beforeKeyDown"];var gridHookEvents=$l.get(el.id+"_hidden").getAttribute("syn-events");try{if(gridHookEvents){gridHookEvents=eval(gridHookEvents)}}catch(e){$l.eventLog("WebGrid_controlLoad",e.toString(),"Debug")}if(gridHookEvents){for(var i=0;i<gridHookEvents.length;i++){var hook=gridHookEvents[i];if($grid.gridHooks.indexOf(hook)==-1){$grid.gridHooks.push(hook)}}}$grid.gridHooks.forEach(function(hook){setting[hook]=function(){var elID=this.rootElement.id;var $grid=syn.uicontrols.$grid;var mod=window[syn.$w.pageScript];var hot=$grid.getGridControl(elID);var defaultGridHooks=["afterChange","afterCreateRow","afterRemoveRow","hiddenRow","beforeOnCellMouseDown","afterSelectionEnd","beforeKeyDown"];var gridValue=$grid.getGridValue(elID);if(defaultGridHooks.indexOf(hook)==-1){if(gridValue.passSelectCellEvent==true){}else{if(mod){var eventHandler=mod["{0}_{1}".format(elID,hook)];if(eventHandler){eventHandler.apply(syn.$l.get(elID),arguments)}}}return}if(gridValue){if(hook=="afterChange"&&(gridValue.eventName=="insertRow"||gridValue.eventName=="removeRow")){gridValue.eventName=="";return}}if(hook=="beforeKeyDown"){var evt=arguments[0];if(evt.keyCode==13){Handsontable.dom.stopImmediatePropagation(evt)}else if(evt.shiftKey==true&&evt.keyCode==9){var selected=hot.getSelected()[0];var currentRow=selected[0];var currentCol=selected[1];var firstCol=$grid.getFirstShowColIndex(elID);var lastCol=$grid.getLastShowColIndex(elID);if(currentRow>0&&currentCol==firstCol){Handsontable.dom.stopImmediatePropagation(evt);if(evt.preventDefault){evt.preventDefault()}hot.selectCell(currentRow-1,lastCol)}else if(currentRow==0&&currentCol==firstCol){Handsontable.dom.stopImmediatePropagation(evt);if(evt.preventDefault){evt.preventDefault()}var lastRow=hot.countRows()-1;if(lastRow>-1){hot.selectCell(lastRow,lastCol)}}}else if(evt.keyCode==9){var selected=hot.getSelected()[0];var currentRow=selected[0];var currentCol=selected[1];var firstCol=$grid.getFirstShowColIndex(elID);var lastCol=$grid.getLastShowColIndex(elID);var lastRow=hot.countRows()-1;if(currentRow<lastRow&&currentCol==lastCol){Handsontable.dom.stopImmediatePropagation(evt);if(evt.preventDefault){evt.preventDefault()}hot.selectCell(currentRow+1,firstCol)}else if(currentRow==lastRow&&currentCol==lastCol){Handsontable.dom.stopImmediatePropagation(evt);if(evt.preventDefault){evt.preventDefault()}if(setting.autoInsertRow==true){$grid.insertRow(elID,{amount:1},function(e){hot.selectCell(e,firstCol)});Handsontable.dom.stopImmediatePropagation(evt);if(evt.preventDefault){evt.preventDefault()}}else{hot.selectCell(0,firstCol)}}}}else if(hook=="afterChange"||hook=="afterCreateRow"||hook=="afterRemoveRow"||hook=="hiddenRow"){if(hook=="afterChange"&&arguments[1]=="loadData"){return}else if(hook=="afterChange"&&arguments[1]=="edit"&&arguments[0][0][1]=="Flag"){return}var rowIndex;if(hook=="afterCreateRow"){var method_index=arguments[0];var method_amount=arguments[1];var method_source=arguments[2];rowIndex=method_index}else if(hook=="afterChange"){var method_changes=arguments[0];var method_source=arguments[1];rowIndex=method_changes[0][0];var columnName=method_changes[0][1];var changeValue=method_changes[0][3];var columnInfos=hot.getSettings().columns;var columnInfo=columnInfos.filter(function(e){return e.data==columnName})[0];if(columnInfo.type=="dropdown"){var dataSource=columnInfo.dataSource;if(dataSource){if(columnInfo.required==false&&changeValue==""){method_changes[0][4]="";hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),"")}else{for(var j=0;j<dataSource.DataSource.length;j++){var item=dataSource.DataSource[j];if(item[dataSource.ValueColumnID]==changeValue){var code=item[dataSource.CodeColumnID];method_changes[0][4]=code;hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),code);break}}}}}}else if(hook=="afterRemoveRow"){var method_index=arguments[0];var method_amount=arguments[1];rowIndex=method_index}else if(hook=="hiddenRow"){var method_rows=arguments[0];rowIndex=method_rows[0]}if(rowIndex||rowIndex==0){}else{return}var physicalRowIndex=hot.toPhysicalRow(rowIndex);var rowData=hot.getSourceDataAtRow(physicalRowIndex);var rowFlag=rowData&&rowData.Flag?rowData.Flag:"C";if(hook=="afterCreateRow"){rowFlag="C"}else if(hook=="afterChange"){if(rowFlag=="R"&&method_changes[0][2]!=method_changes[0][3]){rowFlag="U"}}else if(hook=="hiddenRow"){if(rowFlag=="R"||rowFlag=="U"){rowFlag="D"}}if(hook=="afterRemoveRow"){}else{var cellRowFlag=hot.getDataAtCell(rowIndex,0);if(cellRowFlag!=rowFlag){hot.setDataAtCell(rowIndex,0,rowFlag);if(hook=="afterCreateRow"&&rowFlag=="C"){}}}}else if(hook=="beforeOnCellMouseDown"){var event=arguments[0];var coords=arguments[1];var td=arguments[2];if(coords.row===-1&&event.target.nodeName==="INPUT"){event.stopImmediatePropagation();this.deselectCell()}if(coords.row==-1){var gridValue=$grid.getGridValue(elID);gridValue.colHeaderClick=true;gridValue.previousRow=coords.row;gridValue.previousCol=coords.col}var now=(new Date).getTime();if(!(td.lastClick&&now-td.lastClick<200)){td.lastClick=now}else{hook="afterOnCellDoubleClick"}}if(mod){var el=$l.get(elID);var elHidden=$l.get(elID+"_hidden");var gridHookEvents=elHidden.getAttribute("syn-events");try{if(gridHookEvents){gridHookEvents=eval(gridHookEvents)}}catch(e){$l.eventLog("WebGrid_gridHookEvents",e.toString(),"Debug")}if(gridHookEvents){if(gridHookEvents.indexOf(hook)>-1){if(gridValue.passSelectCellEvent==true){}else{if(mod){var eventHandler=mod["{0}_{1}".format(elID,hook)];if(eventHandler){eventHandler.apply(el,arguments)}}}}}}if(hook=="afterOnCellDoubleClick"){hook="beforeOnCellMouseDown"}if(hook=="afterSelectionEnd"){var gridValue=$grid.getGridValue(elID);gridValue.colHeaderClick=false;gridValue.previousRow=arguments[0];gridValue.previousCol=arguments[1];if(mod){mod.context.focusControl=$l.get(elID)}}}});var handsontable=new Handsontable(el,setting);handsontable.elID=elID;var wtHolder=$l.get(elID).querySelector(".wtHolder");wtHolder.gridID=elID;Handsontable.dom.addEvent(wtHolder,"click",function(e){var t=window[syn.$w.pageScript];if(t){t.focusControl=$l.get(wtHolder.gridID)}});$grid.gridControls.push({id:elID,hot:handsontable,setting:$ref.clone(setting),value:{eventName:"",colHeaderClick:false,applyCells:false,previousRow:-1,previousCol:-1}});if($grid.gridCodeDatas.length>0){var length=$grid.gridCodeDatas.length;for(var i=0;i<length;i++){$w.addReadyCount();var codeData=$grid.gridCodeDatas[i];$grid.dataRefresh(codeData.elID,codeData.type)}}if(setting.bindingID&&syn.uicontrols.$data){syn.uicontrols.$data.bindingSource(elID,setting.bindingID)}},dataRefresh:function(d,t){var e={columnName:null,codeColumnID:null,required:true,local:true,dataSourceID:null,storeSourceID:null,dataSource:null,parameters:null,selectedValue:null};t=$w.argumentsExtend(e,t);t.elID=d;t.storeSourceID=t.storeSourceID||t.dataSourceID;if(t.columnName&&t.storeSourceID){var r=window[syn.$w.pageScript];if(r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]){delete r.config.dataSource[t.storeSourceID]}if(r&&r["controlInit"]){var n=r["controlInit"](d,t);t=$w.argumentsExtend(t,n)}var i=null;if(r.config&&r.config.dataSource&&r.config.dataSource[t.dataSourceID]){i=r.config.dataSource[t.storeSourceID]}var h=$grid.getGridControl(d);var v=h.getSettings();var a=v.columns;var p=h.propToCol(t.columnName);var o=a[p];if(o.type=="dropdown"){var s=function(e,t,r){e.dataSource=t;e.storeSourceID=r.storeSourceID;e.local=r.local;e.required=r.required;e.codeColumnID=r.codeColumnID||e.codeColumnID;var n=[];if(e.required==false){n.push("")}for(var i=0;i<t.DataSource.length;i++){var a=t.DataSource[i];n.push(a[t.ValueColumnID])}e.source=n;$grid.updateSettings(r.elID,v);if(r.selectedValue){var o=$grid.getActiveRowIndex(d);if(o>-1){var s=h.propToCol(e.codeColumnID);var l="";var u=e.dataSource.DataSource.length;for(var f=0;f<u;f++){var a=e.dataSource.DataSource[f];if(a.CodeID==r.selectedValue){l=a.CodeValue;break}}var c=[[o,s,r.selectedValue],[o,p,l]];h.setDataAtCell(c)}}};if(i){s(o,i,t);$w.removeReadyCount()}else{if(t.local==true){$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.dataSourceID),t,function(e,t){if(t){r.config.dataSource[e.storeSourceID]=t;s(o,t,e)}$w.removeReadyCount()},false)}else{$w.getDataSource(t.dataSourceID,t.parameters,function(e){if(e){r.config.dataSource[t.storeSourceID]=e;s(o,e,t)}$w.removeReadyCount()})}}}}},getInitializeColumns:function(e,t){var r=e.columns;var n={colHeaders:[],columns:[],colWidths:[],hiddenColumns:{columns:[0],indicators:false}};var i=r.length;for(var a=0;a<i;a++){var o=r[a];var s={data:o[0],type:"text",filter:true,isHidden:o[3],readOnly:o[5],className:"ht"+syn.lib.$string.capitalize(o[6]),belongID:o[7],validators:null};if(o.length>8&&o[8]){s.validators=o[8];if(s.validators.indexOf("require")>-1){s.className=s.className+" required"}}if(o.length>9&&o[9]){var l=o[9];if($string.isNullOrEmpty(l.placeholder)==false){s.placeholder=l.placeholder}if(l.sorting==true){}else{s.columnSorting={indicator:false,headerAction:false,compareFunctionFactory:function e(){return function e(){return 0}}}}if((s.type=="checkbox"||s.type=="checkbox2")&&l.isRadioTheme==true){s.className=s.className+" required"}s.columnOptions=l}if(o.length!=10&&e.columnSorting==false){s.columnSorting={indicator:false,headerAction:false,compareFunctionFactory:function e(){return function e(){return 0}}}}var u=null;var f=o[4];if($ref.isString(f)==true){s.type=f;if(s.type=="dropdown"||s.type=="codehelp"){$l.eventLog("getInitializeColumns",'"{0}" ì»¬ë¼ íìì ê°ì²´ë¡ ì ì¸ íì'.format(f),"Warning")}else if(s.type=="checkbox"||s.type=="checkbox2"){s.isSelectAll=false;s.checkedTemplate="1";s.uncheckedTemplate="0";s.allowInvalid=false}else if(s.type=="numeric"||s.type=="date"||s.type=="time"||s.type=="autocomplete"){s.allowInvalid=false;if(s.type=="numeric"){if(f.numericFormat){s.numericFormat=f.numericFormat}else if(f.numericFormat==false){}else{s.numericFormat={pattern:"0,00",culture:"ko-KR"}}}else if(s.type=="date"){s.dateFormat=f.timeFormat;s.correctFormat=f.correctFormat;s.defaultDate=f.defaultDate;s.datePickerConfig=f.datePickerConfig}else if(s.type=="time"){s.timeFormat=f.timeFormat;s.correctFormat=f.correctFormat}}}else{s.type=f.columnType;if(s.type=="dropdown"||s.type=="codehelp"){var c=f.storeSourceID||f.dataSourceID;if(c){var d=window[syn.$w.pageScript];if(d.config&&d.config.dataSource&&d.config.dataSource[c]){u=d.config.dataSource[c]}}}else if(s.type=="checkbox"||s.type=="checkbox2"){s.isSelectAll=$object.isNullOrUndefined(f.isSelectAll)==false&&f.isSelectAll===true?true:false;s.checkedTemplate=$object.isNullOrUndefined(f.checkedTemplate)==false?f.checkedTemplate:"1";s.uncheckedTemplate=$object.isNullOrUndefined(f.uncheckedTemplate)==false?f.uncheckedTemplate:"1";s.allowInvalid=$object.isNullOrUndefined(f.allowInvalid)==false&&f.allowInvalid===true?true:false}else if(s.type=="numeric"||s.type=="date"||s.type=="time"||s.type=="autocomplete"){s.allowInvalid=false;if(s.type=="numeric"){if(f.numericFormat){s.numericFormat=f.numericFormat}else if(f.numericFormat==false){}else{s.numericFormat={pattern:"0,00",culture:"ko-KR"}}}else if(s.type=="date"){s.dateFormat=f.timeFormat;s.correctFormat=f.correctFormat;s.defaultDate=f.defaultDate;s.datePickerConfig=f.datePickerConfig}else if(s.type=="time"){s.timeFormat=f.timeFormat;s.correctFormat=f.correctFormat}}}if(s.type=="dropdown"){var h=[];if(u){for(var v=0;v<u.DataSource.length;v++){var p=u.DataSource[v];h.push(p[u.ValueColumnID])}}else{if(t){f.columnName=o[0];if(f.local===true){$grid.dataRefresh(t,f)}else{$grid.gridCodeDatas.push({elID:t,type:f})}}}s.dataSource=u;s.dataSourceID=f.dataSourceID;s.storeSourceID=f.storeSourceID||f.dataSourceID;s.local=f.local===true;s.codeBelongID=f.codeBelongID;s.codeColumnID=f.codeColumnID;s.codeColumnType=f.codeColumnType?f.codeColumnType:"text";s.codeColumnHidden=f.codeColumnHidden==undefined?true:f.codeColumnHidden;s.source=h;s.strict=true;s.trimWhitespace=false;s.wordWrap=false;s.allowInvalid=false}else if(s.type=="codehelp"){s.dataSource=u;s.dataSourceID=f.dataSourceID;s.storeSourceID=f.storeSourceID||f.dataSourceID;s.local=f.local;s.codeColumnID=f.codeColumnID?f.codeColumnID:o[0];s.textColumnID=f.textColumnID?f.textColumnID:o[0];s.parameters=f.parameters?f.parameters:""}else if(s.type=="date"){s.dateFormat=f.dateFormat?f.dateFormat:"YYYY-MM-DD";s.correctFormat=true;s.datePickerConfig={format:s.dateFormat,ariaLabel:"ë ì§ë¥¼ ì ííì¸ì",i18n:{previousMonth:"ì´ì  ë¬",nextMonth:"ë¤ì ë¬",months:["1ì","2ì","3ì","4ì","5ì","6ì","7ì","8ì","9ì","10ì","11ì","12ì"],weekdays:["ì¼ìì¼","ììì¼","íìì¼","ììì¼","ëª©ìì¼","ê¸ìì¼","í ìì¼"],weekdaysShort:["ì¼","ì","í","ì","ëª©","ê¸","í "]},showWeekNumber:false,showMonthAfterYear:true,yearSuffix:"ë",firstDay:0,numberOfMonths:1}}if(s.type=="dropdown"){var g={data:s.codeColumnID,type:s.codeColumnType,filter:true,readOnly:true,className:"htLeft",belongID:s.codeBelongID?s.codeBelongID:$reflection.clone(o[7])};if(s.codeColumnHidden==true){n.colHeaders.push(o[1]+"_$HIDDEN");s.columnText=o[1]+"_$HIDDEN"}else{n.colHeaders.push(o[1]+"_ì½ë");s.columnText=o[1]+"_ì½ë"}n.columns.push(g);n.colWidths.push(o[2])}n.colHeaders.push(o[1]);s.columnText=o[1];n.columns.push(s);n.colWidths.push(o[2])}var m=n.colHeaders.length;for(var a=0;a<m;a++){var y=n.colHeaders[a];if(y.indexOf("_$HIDDEN")>-1){n.hiddenColumns.columns.push(a+1)}}for(var a=0;a<m;a++){var s=n.columns[a];if(s.isHidden==true){n.hiddenColumns.columns.push(a+1)}}return n},merge:function(e,t,r,n,i){var a=$grid.getGridControl(e);if(a){var o=a.getPlugin("mergeCells");if(o.isEnabled()==false){o.enablePlugin()}o.merge(t,r,n,i)}},unmerge:function(e,t,r,n,i){var a=$grid.getGridControl(e);if(a){var o=a.getPlugin("mergeCells");if(o.isEnabled()==false){o.enablePlugin()}o.unmerge(t,r,n,i)}},addCondition:function(e,t,r,n){var i=$grid.getGridControl(e);if(i){var a=i.getPlugin("filters");if(a.isEnabled()==false){a.enablePlugin()}if($ref.isString(t)==true){t=i.propToCol(t)}if($ref.isString(n)==true){n=[n]}a.addCondition(t,r,n);a.filter()}},removeCondition:function(e,t){var r=$grid.getGridControl(e);if(r){var n=r.getPlugin("filters");if(n.isEnabled()==false){n.enablePlugin()}if($ref.isString(t)==true){t=r.propToCol(t)}n.removeConditions(t);n.filter()}},clearConditions:function(e){var t=$grid.getGridControl(e);if(t){var r=t.getPlugin("filters");if(r.isEnabled()==false){r.enablePlugin()}r.clearConditions();r.filter()}},countRows:function(e,t){var r=0;var n=$grid.getGridControl(e);if(n){var i=0;if(t===true){var a=n.getPlugin("hiddenRows");if(a.isEnabled()==false){a.enablePlugin()}i=a?a.hiddenRows.length:0}var o=n.countSourceRows();r=o-i}return r},countRenderedRows:function(e){var t=-1;var r=$grid.getGridControl(e);if(r){t=r.countRenderedRows()}return t},countRenderedCols:function(e){var t=-1;var r=$grid.getGridControl(e);if(r){t=r.countRenderedCols()}return t},insertRow:function(e,t,r){var n=$grid.getGridControl(e);if(n){t=$w.argumentsExtend({index:n.countRows(),amount:1},t);n.alter("insert_row",t.index,t.amount);n.render()}var i=$grid.getGridValue(e);i.eventName="insertRow";var a=t&&t.index?t.index:0;var o=n.getSettings();if(o){var s=[];var l=o.columns;var u=l.length;for(var f=0;f<u;f++){var c=l[f];if(f>=0&&(c.type=="checkbox"||c.type=="checkbox2")){var d=false;if(c.uncheckedTemplate!=undefined||c.uncheckedTemplate!=null){d=c.uncheckedTemplate}s.push([a,f,d])}}if(s.length>0){n.setDataAtCell(s)}}var h=$w.getTriggerOptions(e);if(h){if(h.sourceValueID&&h.targetColumnID){var v=window[syn.$w.pageScript];if(v){var p=v["synControls"];if(p&&p.length>0){if($ref.isString(h.sourceValueID)==true&&$ref.isString(h.targetColumnID)==true){var g=h.sourceValueID.split("@");var m=g[0];var y=g[1];var b=p.filter(function(e){return e.field==m});if(b.length==1){var w=b[0];if(w.type=="grid"){var C=n.propToCol(h.targetColumnID);var S=w.id;var E=$grid.getActiveRowIndex(S);var k=$grid.propToCol(S,y);var T=$grid.getDataAtCell(S,E,k);n.setDataAtCell(a,C,T)}else{var f=n.propToCol(h.targetColumnID);var _=$l.querySelector('[syn-datafield="{0}"] #{1}'.format(m,y));if(_){n.setDataAtCell(a,f,_.value)}}}else{$l.eventLog("insertRow","{0} ì»¬ë¼ ID ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì".format(m),"Debug")}}else if($ref.isArray(h.sourceValueID)==true&&$ref.isArray(h.targetColumnID)==true){var u=h.sourceValueID.length;for(var x=0;x<u;x++){var D=h.sourceValueID[x];var g=D.split("@");var m=g[0];var y=g[1];var b=p.filter(function(e){return e.field==m});if(b.length==1){var w=b[0];if(w.type=="grid"){var C=n.propToCol(h.targetColumnID[x]);var S=w.id;var E=$grid.getActiveRowIndex(S);var k=$grid.propToCol(S,y);var T=$grid.getDataAtCell(S,E,k);n.setDataAtCell(a,C,T)}else{var f=n.propToCol(h.targetColumnID[x]);var _=$l.querySelector('[syn-datafield="{0}"] #{1}'.format(m,y));if(_){n.setDataAtCell(a,f,_.value)}}}else{$l.eventLog("insertRow","{0} ì»¬ë¼ ID ì¤ë³µ ëë ì¡´ì¬ì¬ë¶ íì¸ íì".format(m),"Debug")}}}}}}if(h.focusColumnID){var f=n.propToCol(h.focusColumnID);n.selectCell(a,f)}}if(r){r(a)}i.eventName=""},removeRow:function(e,t,r){var n=$grid.getGridControl(e);if(n){if($object.isNullOrUndefined(r)==true){var i=n.getSelected();if(i){r=i[0][0]}else{r=$grid.getActiveRowIndex(e)}}if($grid.isRowHidden(e,r)==true){return}if($object.isNullOrUndefined(r)==true){r=n.countSourceRows()-1}if(r>-1){var a=$grid.getGridValue(e);a.eventName="removeRow";var o=n.toPhysicalRow(r);var s=n.getSourceDataAtRow(o);var l=s&&s.Flag?s.Flag:"C";if(l=="D"){l="U";n.setDataAtCell(r,0,l);for(var u=0;u<n.countCols();u++){var f=n.getCellMeta(r,u)["className"];f=f.replace(" removeRow","");n.setCellMeta(r,u,"className",f)}n.render()}else{if(l=="R"||l=="U"){l="D"}if(l=="C"||l=="S"){}else{n.setDataAtCell(r,0,l)}if(l=="C"){n.alter("remove_row",r);var c=n.countSourceRows();var d=$w.getTriggerOptions(e);if(d&&d.focusColumnID){var h=n.propToCol(d.focusColumnID);if(r>0&&r>=c){r=c-1;n.selectCell(r,h)}else{n.selectCell(r-1,h)}}}else if(l!="S"){var v=n.getSettings();if(v.isRemoveRowHidden===true){$grid.visibleRows(e,r,false)}else{for(var u=0;u<n.countCols();u++){n.setCellMeta(r,u,"className",n.getCellMeta(r,u)["className"]+" removeRow")}}n.render()}}if(t){t(r)}a.eventName=""}}},loadData:function(e,t,r){var n=$grid.getGridControl(e);if(n){var i=$grid.getGridValue(e);i.applyCells=false;n.deselectCell();$grid.clearConditions(e);$grid.unHiddenRows(e);var a=$l.querySelectorAll("div.handsontable > div table input[type=checkbox][columnSelectAll]");for(var o=0;o<a.length;o++){var s=a[o];s.checked=false}var l=$l.querySelectorAll("div.handsontable > div table label.ui_checkbox");for(var o=0;o<l.length;o++){var u=l[o];$m.removeClass(u,"ui_checkbox")}var f=t.length;for(var o=0;o<f;o++){t[o].Flag="R"}n.loadData(t);var c=n.getSettings();for(var o=0;o<c.columns.length;o++){var d=c.columns[o];if(d.toogleChecked){d.toogleChecked=0}}i.colHeaderClick=false;i.previousRow=-1;i.previousCol=-1;if(c.columnSorting!=false){var h=n.getPlugin("columnSorting");if(h.isEnabled()==false){h.enablePlugin()}if(h.isSorted()==true){h.sort(h.sortColumn,h.sortOrder)}}i.applyCells=true}if(r){r()}},getFirstShowColIndex:function(e){var t=0;var r=$grid.getGridControl(e);if(r){var n=r.getSettings();if(n.firstShowColIndex){t=n.firstShowColIndex}else{var i=r.countCols()-1;var a=[];for(var o=0;o<=i;o++){a.push(o)}if(n.hiddenColumns&&n.hiddenColumns.columns&&n.hiddenColumns.columns.length>0){var s=n.hiddenColumns.columns.length;for(var o=0;o<s;o++){var l=n.hiddenColumns.columns[o];for(var u=a.length-1;u>-1;u--){if(l==a[u]){$array.removeAt(a,u);break}}}t=a[0]}}}return t},getLastShowColIndex:function(e){var t=0;var r=$grid.getGridControl(e);if(r){var n=r.getSettings();if(n.lastShowColIndex){t=n.lastShowColIndex}else{t=r.countCols()-1;var i=[];for(var a=0;a<=t;a++){i.push(a)}if(n.hiddenColumns&&n.hiddenColumns.columns&&n.hiddenColumns.columns.length>0){var o=n.hiddenColumns.columns.length;for(var a=0;a<o;a++){var s=n.hiddenColumns.columns[a];for(var l=i.length-1;l>-1;l--){if(s==i[l]){$array.removeAt(i,a);break}}}t=i[i.length-1]}}}return t},updateSettings:function(e,t,r){var n=$grid.getGridControl(e);if(n){if(r&&r==true){$grid.clear(e)}n.updateSettings(t);n.render()}},getSettings:function(e){var t=null;var r=$grid.getGridControl(e);if(r){t=r.getSettings()}return t},isUpdateData:function(e){var t=false;var r=$grid.getSettings(e);if(r){if(r.data&&r.data.length>0){var n=r.data.length;for(var i=0;i<n;i++){var a=r.data[i]["Flag"];if($string.isNullOrEmpty(a)==true||a=="R"||a=="S"){continue}else{t=true;break}}}}return t},getFlag:function(e,t){var r=$grid.getGridControl(e);if(r){return r.getDataAtCell(t,"Flag")}},setFlag:function(e,t,r){var n=$grid.getGridControl(e);if(n){var i=n.propToCol("Flag");var a=n.getDataAtCell(t,i);if(a!="S"){n.setDataAtCell(t,i,r)}}},getDataAtCell:function(e,t,r){var n=$grid.getGridControl(e);if(n){return n.getDataAtCell(t,r)}},scrollViewportTo:function(e,t,r,n,i){var a=null;var o=$grid.getGridControl(e);if(o){a=o.scrollViewportTo(t,r,n,i)}return a},isEmptyRow:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.isEmptyRow(t)}return r},isEmptyCol:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){if($ref.isString(t)==true){t=n.propToCol(t)}r=n.isEmptyCol(t)}return r},getDataAtRow:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.getDataAtRow(t)}return r},getSourceDataAtRow:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.getSourceDataAtRow(t)}return r},getDataAtCol:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){if($ref.isString(t)==true){t=n.propToCol(t)}r=n.getDataAtCol(t)}return r},getSourceDataAtCol:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){if($ref.isString(t)==true){t=n.propToCol(t)}r=n.getSourceDataAtCol(t)}return r},getRowHeader:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.getRowHeader(t)}return r},setDataAtCell:function(e,t,r,n,i){var a=$grid.getGridControl(e);if(a){if($ref.isString(r)==true){r=a.propToCol(r)}a.setDataAtCell(t,r,n,i)}},setDataAtRow:function(e,t){var r=$grid.getGridControl(e);if(r){r.setDataAtCell(t)}},isCellClassName:function(e,t,r,n){var i=false;var a=$grid.getGridControl(e);if(a){if($ref.isString(r)==true){r=a.propToCol(r)}var o=a.getCellMeta(t,r)["className"];i=o!=null&&o.indexOf(n)>-1}return i},setCellClassName:function(e,t,r,n,i){if($object.isNullOrUndefined(n)==true){$l.eventLog("$grid.setCellClassName","className íì¸ íì","Warning")}else{var a=$grid.getGridControl(e);if(a){if($ref.isString(r)==true){r=a.propToCol(r)}if($object.isNullOrUndefined(i)==true){i=false}var o=function(e,t,r,n){var i=a.getCellMeta(e,t)["className"];if(i){if(n===true){if(i.indexOf(r)==-1){a.setCellMeta(e,t,"className",a.getCellMeta(e,t)["className"]+" "+r)}}else{if(i.indexOf(r)>-1){i=i.replace(" "+r,"");a.setCellMeta(e,t,"className",i)}}}else{a.setCellMeta(e,t,"className",r)}};if(t==-1&&r==-1){var s=a.countRows();var l=a.countCols();for(var u=0;u<s;u++){for(var f=0;f<l;f++){o(u,f,n,i)}}}else if(t==-1&&r>-1){var s=a.countRows();for(var u=0;u<s;u++){o(u,r,n,i)}}else if(t>-1&&r==-1){var l=a.countCols();for(var u=0;u<l;u++){o(t,u,n,i)}}else{o(t,r,n,i)}a.render()}}},setCellMeta:function(e,t,r,n,i){var a=$grid.getGridControl(e);if(a){if($ref.isString(r)==true){r=a.propToCol(r)}a.setCellMeta(t,r,n,i)}},setDataAtRowProp:function(e,t,r,n,i){var a=$grid.getGridControl(e);if(a){if($ref.isString(r)==true){r=a.propToCol(r)}a.setDataAtRowProp(t,r,n,i)}},getCellMeta:function(e,t,r){var n=null;var i=$grid.getGridControl(e);if(i){if($ref.isString(r)==true){r=i.propToCol(r)}n=i.getCellMeta(t,r)}return n},getCellMetaAtRow:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.getCellMetaAtRow(t)}return r},getUpdateData:function(e,t,r){var n=[];var i=$grid.getGridControl(e);if(r){if(t=="Row"){var a=i.toPhysicalRow($grid.getActiveRowIndex(e));if(a!=null&&a>-1){var o=i.getSourceDataAtRow(a);var s=o.Flag?o.Flag:"C";var l=i.getCellMetaAtRow(a);if(s&&s!="S"){o=$ref.clone(o);var u={};u.Flag=s;for(var f in r){var c=r[f];var d=o[f];u[c.FieldID]=d;if(d===undefined){u[c.FieldID]=c.DataType=="number"?null:$ref.defaultValue(c.DataType)}else{u[c.FieldID]=d}}n.push(u)}}}else if(t=="List"){var h=i.countSourceRows();for(var v=0;v<h;v++){var a=i.toPhysicalRow(v);if(a==null){continue}var o=i.getSourceDataAtRow(a);var s=o.Flag?o.Flag:"C";var l=i.getCellMetaAtRow(a);if(s&&s!="S"){if(s!="R"){o=$ref.clone(o);var u={};u.Flag=s;for(var f in r){var c=r[f];var d=o[f];u[c.FieldID]=d;if(d===undefined){u[c.FieldID]=c.DataType=="number"?null:$ref.defaultValue(c.DataType)}else{u[c.FieldID]=d}}n.push(u)}}}}}else{$l.eventLog("getUpdateData","Input Mapping ì¤ì  ìì","Debug")}return n},validateColumns:function(e,t,r){var n=false;var i=$grid.getGridControl(e);if(i){n=i.validateColumns(t,r)}return n},validateRows:function(e,t,r){var n=false;var i=$grid.getGridControl(e);if(i){n=i.validateRows(t,r)}return n},getPhysicalRowIndex:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.toPhysicalRow(t)}return r},getPhysicalColIndex:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.toPhysicalColumn(t)}return r},getLogicalRowIndex:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.toVisualRow(t)}return r},getLogicalColIndex:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.toVisualColumn(t)}return r},unHiddenColumns:function(e){var t=$grid.getGridControl(e);if(t){var r=t.getPlugin("hiddenColumns");if(r.isEnabled()==false){r.enablePlugin()}var n=t.countCols();var i=[];for(var a=0;a<n;a++){if(t.colToProp(a)=="Flag"){continue}if(r.isHidden(a)==true){i.push(a)}}$grid.visibleColumns(e,i,true)}},isColumnHidden:function(e,t,r){var n=false;var i=$grid.getGridControl(e);if(i){var a=i.getPlugin("hiddenColumns");if(a.isEnabled()==false){a.enablePlugin()}n=a.isHidden(t,r)}return n},visibleColumns:function(e,t,r){var n=$grid.getGridControl(e);if(n){var i=n.getPlugin("hiddenColumns");if(i.isEnabled()==false){i.enablePlugin()}var a=n.getSettings();var o=a.columns;if(r==true){if($ref.isNumber(t)==true){o[t].isHidden=false;i.showColumn(t)}else{for(var s=0;s<t.length;s++){var l=o[t[s]];l.isHidden=false}i.showColumns(t)}}else{if($ref.isNumber(t)==true){o[t].isHidden=true;i.hideColumn(t)}else{for(var s=0;s<t.length;s++){var l=o[t[s]];l.isHidden=true}i.hideColumns(t)}}n.render()}},unHiddenRows:function(e){var t=$grid.getGridControl(e);if(t){var r=t.getPlugin("hiddenRows");if(r.isEnabled()==false){r.enablePlugin()}var n=t.countRows();var i=[];for(var a=0;a<n;a++){if(r.isHidden(a)==true){i.push(a)}}$grid.visibleRows(e,i,true)}},isRowHidden:function(e,t,r){var n=false;var i=$grid.getGridControl(e);if(i){var a=i.getPlugin("hiddenRows");if(a.isEnabled()==false){a.enablePlugin()}n=a.isHidden(t,r)}return n},visibleRows:function(e,t,r){var n=$grid.getGridControl(e);if(n){var i=n.getPlugin("hiddenRows");if(i.isEnabled()==false){i.enablePlugin()}if(r==true){if($ref.isNumber(t)==true){i.showRow(t)}else{i.showRows(t)}}else{if($ref.isNumber(t)==true){i.hideRow(t)}else{i.hideRows(t)}}n.render()}},propToCol:function(e,t){var r=-1;var n=$grid.getGridControl(e);if(n){r=n.propToCol(t)}return r},getColHeader:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.getColHeader(t)}return r},colToProp:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.colToProp(t)}return r},countCols:function(e){var t=null;var r=$grid.getGridControl(e);if(r){t=r.countCols()}return t},getSelected:function(e){var t=null;var r=$grid.getGridControl(e);if(r){t=r.getSelected()}return t},getActiveRowIndex:function(e){var t=-1;var r=$grid.getGridControl(e);if(r){var n=r.getSelected();if(n&&n.length>0){t=r.getSelected()[0][0]}else{var i=$grid.getGridValue(e);t=i.previousRow}}return t},getActiveColIndex:function(e){var t=-1;var r=$grid.getGridControl(e);if(r){var n=r.getSelected();if(n&&n.length>0){t=r.getSelected()[0][1]}else{var i=$grid.getGridValue(e);t=i.previousCol}}return t},selectCell:function(e,t,r,n,i,a,o){var s=$grid.getGridControl(e);if(s){if(t===-1){var l=0;var u=s.getPlugin("hiddenRows");if(u.isEnabled()==false){u.enablePlugin()}l=u?u.hiddenRows.length:0;var f=s.countSourceRows();t=f-l-1}s.selectCell(t,r,n,i,a,o)}},getExportPlugin:function(e,t){var r=null;var n=$grid.getGridControl(e);if(n){r=n.getPlugin("exportFile");if(r.isEnabled()==false){r.enablePlugin()}}return r},exportAsString:function(e,t){var r=null;var n=$grid.getExportPlugin(e,t);if(n){if($object.isNullOrUndefined(t)==true){t={}}var i=$grid.getGridControl(e);t=$w.argumentsExtend({exportHiddenRows:false,exportHiddenColumns:false,rowHeaders:false,bom:false,columnDelimiter:",",range:t.range?t.range:[0,1,i.countRows(),i.countCols()-1],filename:"{0}_{1}_{2}".format(syn.$w.pageScript,e,$date.toTicks(new Date))},t);t.columnHeaders=false;var a=i.getSettings().columns;var o=[];var s=t.range?t.range[1]:1;var l=t.range?t.range[3]:i.countCols()-1;for(var u=s;u<=l;u++){o.push(a[u])}var f=o.filter(function(e){return t.exportHiddenColumns==true||e.isHidden==false}).map(function(e){return e.columnText});var c=n.exportAsString("csv",t);r=f.join(",")+"\r\n"+c}return r},exportFile:function(e,t){var r=$grid.getExportPlugin(e,t);if(r){if($object.isNullOrUndefined(t)==true){t={}}t=$w.argumentsExtend({fileType:"excel",exportHiddenRows:false,exportHiddenColumns:false,columnHeaders:true,rowHeaders:false,bom:false,columnDelimiter:","},t);if(t.fileType=="excel"){var n=$grid.getGridControl(e);var i=n.getSettings();var a=i.columns;var o=[];var s=t.range?t.range[1]:1;var l=t.range?t.range[3]:n.countCols()-1;for(var u=s;u<=l;u++){o.push(a[u])}var f=o.filter(function(e){return t.exportHiddenColumns==true||e.isHidden==false}).map(function(e,t){return{index:n.propToCol(e.data),type:e.type}});var c=i.exportColumns.map(function(e,t){return{index:n.propToCol(e.columnID),type:e.type}});f=$ref.extend(f,c);var d=f.length;var h=i.colWidths;var v=[];for(var u=0;u<d;u++){var p=f[u].index;v.push({wpx:h[p]})}var g=$grid.exportAsString(e,t);var m=Papa.parse(g).data;var y=m.length;var b=document.createElement("DIV");for(var u=0;u<d;u++){if(f[u].type=="numeric"){for(var w=1;w<y;w++){m[w][u]=$string.toParseType(m[w][u],"number")}}else if(f[u].type.indexOf("html")>-1){for(var w=1;w<y;w++){b.innerHTML=m[w][u];m[w][u]=b.textContent||b.innerText||""}}}b=null;var C=XLSX.utils.book_new();var S=XLSX.utils.aoa_to_sheet(m);S["!cols"]=v;XLSX.utils.book_append_sheet(C,S,"Sheet1");var E=XLSX.write(C,{bookType:"xlsx",type:"binary"});$r.blobToDownload(new Blob([$l.stringToArrayBuffer(E)],{type:"application/octet-stream"}),t.filename+".xlsx")}else if(t.fileType=="csv"){var n=$grid.getGridControl(e);t=$w.argumentsExtend({range:t.range?t.range:[0,1,n.countRows(),n.countCols()],filename:"{0}_{1}_{2}".format(syn.$w.pageScript,e,$date.toTicks(new Date))},t);r.downloadFile("csv",t)}}},importFile:function(e,t){var r=$grid.getGridControl(e);if(r){var n=$l.get("{0}_ImportFile".format(e));n.callback=t;n.click()}},importFileLoad:function(e){var L=e.srcElement||e.target;var P=L.id.split("_")[0];var F=$grid.getSettings(P);var t=[".csv",".xls",".xlsx"];var B=L.files[0].name;var H=B.substring(B.lastIndexOf(".")==-1?B.length:B.lastIndexOf("."));if(H&&t.indexOf(H)<0){$w.alert("{0} íì¥ìë¥¼ ê°ì§ íì¼ë§ ê°ë¥í©ëë¤".format(t.toString()));return false}var r=new FileReader;r.onload=function(e){var t=",";L.value="";var r=e.target.result;var n=$grid.getGridControl(P);if(H==".csv"){var i=r.split(/\r\n|\n/);if(i.length==0){$grid.clear(P)}else if(i.length>0){var a=[];var o=i[0].split(t);var s=[];var l=F.columns.map(function(e){return e.data});var u=F.columns.map(function(e){return e.type});for(var f=0;f<o.length;f++){var c=o[f];c=c.replace(/^["]/,"");c=c.replace(/["]$/,"");o[f]=c;var d=F.colHeaders.indexOf(c);if(d==-1){$w.alert("ì¬ë°ë¥¸ íìì íì¼ì´ ìëëë¤.\níì¼ì íì¸í´ì£¼ì¸ì.".format(F.controlText));return false}var h=n.propToCol(l[d]);s.push({headerIndex:f,columnID:l[d],columnIndex:h,columnType:u[d]})}var v=i[1];var p=v.split(t);for(var f=0;f<s.length;f++){var g=s[f];var c=p[f];c=c.replace(/^["]/,"");c=c.replace(/["]$/,"");var m=true;switch(g.columnType){case"checkbox":case"checkbox2":m=$string.toBoolean(c);break;case"numeric":if(c==null){c=0}m=$ref.isNumber(c)==true?true:$string.isNumber(c);break;case"date":if(c==null){m=true}else{m=$ref.isDate(c)}break;default:if(c==null){c=""}m=$ref.isString(c);break}if(m==false){$w.alert("ì¬ë°ë¥¸ íìì íì¼ì´ ìëëë¤.\níì¼ì íì¸í´ì£¼ì¸ì.");return false}}for(var f=1;f<i.length;f++){v=i[f];if($string.isNullOrEmpty(v)==false){var y={};var p=i[f].split(t);for(var b=0;b<s.length;b++){var g=s[b];var c=p[b];if($object.isNullOrUndefined(c)==true){c=""}else{c=c.replace(/^["]/,"");c=c.replace(/["]$/,"")}if(g.columnType=="numeric"){if(c!=null){c=$ref.isNumber(c)==true?c:Number(c)}}y[g.columnID]=c}a.push(y)}}}}else{var l=F.columns.map(function(e){return e.data});var w=XLSX.read(r,{type:"binary"});var C=w.Sheets[w.SheetNames[0]];var S=XLSX.utils.decode_range(C["!ref"]);for(var E=S.s.c;E<=S.e.c;++E){var k=XLSX.utils.encode_cell({c:E,r:0});var T=C[k];if(T==undefined){break}var _=T.v;var d=F.colHeaders.indexOf(_);if(d==-1){$w.alert("ì¬ë°ë¥¸ íìì íì¼ì´ ìëëë¤.\níì¼ì íì¸í´ì£¼ì¸ì.".format(F.controlText));return false}var x=l[d];T.v=x;T.h=x;T.w=x}a=XLSX.utils.sheet_to_json(C)}var D={};for(var R=0;R<F.columns.length;R++){var I=F.columns[R];var O="string";switch(I.type){case"radio":case"checkbox":case"checkbox2":O="bool";break;case"numeric":O="int";break;case"date":O="string";break}D[I.data]={FieldID:I.data,DataType:O}}$grid.clear(P);$grid.setValue(P,a,D);var A=n.propToCol("Flag");var N=n.countRows(P);var M=[];for(var f=0;f<N;f++){M.push([f,A,"C"])}n.setDataAtCell(M);if(L.callback){L.callback(B)}};if(H==".csv"){r.readAsText(L.files[0])}else{r.readAsBinaryString(L.files[0])}},getGridControl:function(e){var t=null;var r=$grid.gridControls.length;for(var n=0;n<r;n++){var i=$grid.gridControls[n];if(i.id==e){t=i.hot;break}}return t},getGridValue:function(e){var t=null;var r=$grid.gridControls.length;for(var n=0;n<r;n++){var i=$grid.gridControls[n];if(i.id==e){t=i.value;break}}return t},getGridSetting:function(e){var t=null;var r=$grid.gridControls.length;for(var n=0;n<r;n++){var i=$grid.gridControls[n];if(i.id==e){t=i.setting;break}}return t},getColumnWidths:function(e){var t=[];var r=$grid.getGridControl(e);if(r){var n=r.countCols();for(var i=0;i<n;i++){t.push(r.getColWidth(i))}}return t},setColumnWidth:function(e,t,r){var n=$grid.getGridControl(e);if(n){var i=n.getPlugin("manualColumnResize");if(i.isEnabled()==false){i.enablePlugin()}if($ref.isString(t)==true){t=n.propToCol(t)}if($ref.isNumber(r)==true){i.setManualSize(t,r)}}},setControlSize:function(e,t){var r=$l.get(e);if(r&&t){if(t.width){r.style.width=t.width}if(t.height){r.style.height=t.height}$grid.getGridControl(e).render()}},getValue:function(e,t,r){var n=[];var i=$grid.getUpdateData(e,t,r);var a=i.length;for(var o=0;o<a;o++){var s=i[o];var l=[];for(var u in s){var f={prop:u,val:s[u]};l.push(f)}n.push(l)}return n},setValue:function(e,t,r){var n="";var i=$grid.getGridControl(e);if(i){var a=i.getSettings();if(a&&t&&t.length>0){var o=t[0];for(var s in o){var l=false;var u=r[s];if(u){switch(u.DataType.toLowerCase()){case"string":l=o[s]==null||$ref.isString(o[s])||$string.isNumber(o[s]);break;case"bool":l=$string.toBoolean(o[s]);break;case"number":case"int":l=o[s]==null||$string.isNumber(o[s])||$ref.isNumber(o[s]);break;case"date":l=o[s]==null||$ref.isDate(o[s]);break;default:l=false;break}if(l==false){n='ë°ì¸ë© ë°ì´í° íìê³¼ ë§¤í ì ìê° ë¤ë¦, ë°ì¸ë© ID - "{0}", íì - "{1}"'.format(s,u.DataType);break}}else{continue}}if(n==""){var f=a.columns;var c=[];for(var d=0;d<f.length;d++){var h=f[d];if(h.type=="dropdown"){c.push(h)}}if(c.length>0){for(var d=0;d<c.length;d++){var h=c[d];var v=h.dataSource;if(v){for(var p=0;p<t.length;p++){var g=t[p][h.codeColumnID];for(var m=0;m<v.DataSource.length;m++){var o=v.DataSource[m];if(o[v.CodeColumnID]==g){t[p][h.data]=o[v.ValueColumnID];break}}}}}}$grid.loadData(e,t);$grid.renderSummary(i)}else{$l.eventLog("syn.uicontrols.$grid",n,"Debug")}}else{$grid.loadData(e,[]);$grid.renderSummary(i)}}},renderSummary:function(e){var t=e.getSettings();if(t.summarys&&t.summarys.length>0){var r={index:e.countRows(),amount:1};e.alter("insert_row",r.index,r.amount);e.render();var n=$grid.getGridValue(e.elID);n.applyCells=true;$grid.refreshSummary(e.elID)}},refreshSummary:function(e){var t=$grid.getGridControl(e);var r=t.getSettings();if(r.summarys&&r.summarys.length>0){var n=r.data.length-1;var i=[];var a=r.summarys.length;var o=function(e){return $string.isNullOrEmpty(e)==true||$string.isNumber(e)==false?0:parseFloat($ref.isNumber(e)?e:$string.toNumber(e))};for(var s=0;s<a;s++){var l=0;var u=r.summarys[s];var f=t.propToCol(u.columnID);var c=r.data.map(function(e){return e.Flag&&e.Flag!="S"&&e[u.columnID]});if(c.length>0){var d=JSON.parse(JSON.stringify(c));switch(u.type){case"min":$array.sort(d,true);var h=d[0];l=o(h);break;case"max":$array.sort(d,false);var h=d[0];l=o(h);break;case"avg":for(var v=0;v<d.length;v++){var h=d[v];l+=o(h)}l=l/d.length;break;case"sum":for(var v=0;v<d.length;v++){var h=d[v];l+=o(h)}break;case"count":l=d.length-1;break;case"custom":var p=window[syn.$w.pageScript];if(p){var g=p["{0}_customSummary".format(t.elID)];if(g){l=g.apply(t,[t.elID,u.columnID,f,d])}}break}if(u.type!="custom"){if($object.isNullOrUndefined(u.fixed)==true){l=l.toFixed(u.type=="avg"?1:0)}else{l=l.toFixed(u.fixed)}if($object.isNullOrUndefined(u.format)==true){l=$string.toCurrency(l)}else{if(u.format===true){l=$string.toCurrency(l)}else{l=l.toString()}}}i.push([n,f,l])}}i.push([n,0,"S"]);t.setDataAtCell(i)}},clear:function(e,t){$grid.loadData(e,[])},setLocale:function(e,t,r,n){var i=$l.get(e);var a=$resource.getBindSource(r);if(a!=null){var o=$resource.translateText(r,n);if(o){i[a]=o}}}});syn.uicontrols.$grid=$grid})(window);